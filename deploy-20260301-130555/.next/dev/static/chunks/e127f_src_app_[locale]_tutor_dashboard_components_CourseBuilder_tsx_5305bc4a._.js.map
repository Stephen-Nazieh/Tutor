{
  "version": 3,
  "sources": [],
  "debugId": "3e1328ba-9fd2-0640-be2e-12a862f0710c",
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/components/CourseBuilder.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useCallback, useEffect, useRef, forwardRef, useImperativeHandle } from 'react'\nimport {\n  DndContext,\n  closestCenter,\n  KeyboardSensor,\n  PointerSensor,\n  useSensor,\n  useSensors,\n  DragOverlay,\n  DragStartEvent,\n  DragOverEvent,\n  DragEndEvent,\n  defaultDropAnimationSideEffects,\n  DropAnimation,\n} from '@dnd-kit/core'\nimport {\n  arrayMove,\n  SortableContext,\n  sortableKeyboardCoordinates,\n  verticalListSortingStrategy,\n  useSortable,\n} from '@dnd-kit/sortable'\nimport { CSS } from '@dnd-kit/utilities'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Badge } from '@/components/ui/badge'\nimport { Dialog, DialogContent, DialogFooter, DialogHeader, DialogTitle } from '@/components/ui/dialog'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { Switch } from '@/components/ui/switch'\nimport { ScrollArea } from '@/components/ui/scroll-area'\nimport { Separator } from '@/components/ui/separator'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { cn } from '@/lib/utils'\nimport { extractTextFromFile } from '@/lib/extract-file-text'\nimport { toast } from 'sonner'\n\nimport {\n  Plus,\n  Trash2,\n  Copy,\n  FileText,\n  Video,\n  Image as ImageIcon,\n  FileQuestion,\n  ChevronRight,\n  ChevronDown,\n  Save,\n  Wand2,\n  BookOpen,\n  Layers,\n  Upload,\n  CheckCircle,\n  Clock,\n  GraduationCap,\n  ListTodo,\n  Home,\n  BrainCircuit,\n  GripVertical,\n  MoreVertical,\n  X,\n  Lightbulb,\n  LayoutTemplate,\n  Sparkles,\n  History,\n  RotateCcw,\n  Check,\n  Zap,\n  PenTool,\n  Users,\n  MonitorPlay,\n  Gamepad2,\n  Code,\n  Send,\n  Paperclip,\n  Mic,\n  Play,\n  Lock,\n  Unlock,\n  Eye,\n  EyeOff,\n  Shield,\n  Loader2,\n  BarChart3,\n  Signal,\n  SignalHigh,\n  SignalLow,\n  Layers2\n} from 'lucide-react'\n\n// ============================================\n// ENHANCED TYPES - Hierarchical Structure\n// ============================================\n\nexport interface Video {\n  id: string\n  title: string\n  url: string\n  duration: number\n  thumbnail?: string\n}\n\nexport interface Image {\n  id: string\n  title: string\n  url: string\n  alt?: string\n}\n\nexport interface Document {\n  id: string\n  title: string\n  url: string\n  type: 'pdf' | 'doc' | 'ppt' | 'other'\n}\n\nexport interface ImportedLearningResource {\n  fileName: string\n  mimeType: string\n  fileUrl: string\n  extractedText: string\n  uploadedAt: string\n}\n\nexport interface VisibleDocumentPayload {\n  title: string\n  description?: string\n  itemType: 'task' | 'homework' | 'worksheet' | 'moduleQuiz'\n  sourceDocument?: ImportedLearningResource\n}\n\nexport interface Task extends WithDifficultyVariants {\n  id: string\n  title: string\n  description: string\n  instructions: string\n  estimatedMinutes: number\n  points: number\n  submissionType: 'text' | 'file' | 'link' | 'none' | 'questions'\n  isAiGraded: boolean\n  rubric?: string\n  /** @protected Instructor-only answer key */\n  answerKey?: string\n  /** @protected Whether answer key is encrypted/protected */\n  answerKeyProtected?: boolean\n  /** Questions for question-based tasks */\n  questions?: QuizQuestion[]\n  /** Whether questions are randomized */\n  randomizeQuestions?: boolean\n  /** When false, not visible to students (draft) */\n  isPublished?: boolean\n  sourceDocument?: ImportedLearningResource\n}\n\nexport interface Assessment extends WithDifficultyVariants {\n  id: string\n  title: string\n  description: string\n  instructions: string\n  dueDate?: string\n  estimatedMinutes: number\n  points: number\n  submissionType: 'text' | 'file' | 'link' | 'multiple' | 'questions'\n  allowLateSubmission: boolean\n  latePenalty?: number\n  /** @protected Instructor-only answer key */\n  answerKey?: string\n  /** @protected Whether answer key is encrypted/protected */\n  answerKeyProtected?: boolean\n  /** Questions for question-based homework */\n  questions?: QuizQuestion[]\n  /** Whether questions are randomized */\n  randomizeQuestions?: boolean\n  /** Time limit for completion (optional) */\n  timeLimit?: number\n  attemptsAllowed?: number\n  passingScore?: number\n  showCorrectAnswers?: boolean\n  answersNeverVisible?: boolean\n  /** When false, not visible to students (draft) */\n  isPublished?: boolean\n  sourceDocument?: ImportedLearningResource\n}\n\nexport interface QuizQuestion {\n  id: string\n  type: 'mcq' | 'truefalse' | 'shortanswer' | 'essay' | 'multiselect' | 'matching' | 'fillblank'\n  question: string\n  options?: string[]\n  correctAnswer?: string | string[]\n  points: number\n  explanation?: string\n}\n\nexport interface Quiz extends WithDifficultyVariants {\n  id: string\n  title: string\n  description: string\n  timeLimit?: number\n  attemptsAllowed: number\n  questions: QuizQuestion[]\n  passingScore?: number\n  showCorrectAnswers: boolean\n  randomizeQuestions: boolean\n  /** @protected When true, correct answers are never shown to students */\n  answersNeverVisible?: boolean\n  /** When false, not visible to students (draft) */\n  isPublished?: boolean\n  sourceDocument?: ImportedLearningResource\n  /** Allow late submissions */\n  allowLateSubmission?: boolean\n  /** Late penalty percentage */\n  latePenalty?: number\n  /** @protected Instructor-only answer key */\n  answerKey?: string\n  /** @protected Whether answer key is encrypted/protected */\n  answerKeyProtected?: boolean\n}\n\nexport interface Content {\n  id: string\n  title: string\n  type: 'text' | 'video' | 'audio' | 'interactive' | 'embed'\n  body?: string\n  url?: string\n  duration?: number\n  order: number\n  sourceDocument?: ImportedLearningResource\n}\n\n// ============================================\n// DIFFICULTY & ADAPTIVE CONTENT TYPES\n// ============================================\n\nexport type DifficultyLevel = 'beginner' | 'intermediate' | 'advanced'\n\nexport type DifficultyMode = 'fixed' | 'adaptive' | 'all'\n\n/** Partial variant for a specific difficulty level */\nexport interface DifficultyVariant {\n  title?: string\n  description?: string\n  duration?: number\n  instructions?: string\n  points?: number\n  /** Whether this variant is enabled */\n  enabled?: boolean\n}\n\n/** Mixin for content that supports difficulty variants */\nexport interface WithDifficultyVariants {\n  /** How this content handles difficulty levels */\n  difficultyMode: DifficultyMode\n  /** Fixed difficulty level (when mode is 'fixed') */\n  fixedDifficulty?: DifficultyLevel\n  /** Difficulty-specific overrides (when mode is 'adaptive') */\n  variants?: {\n    beginner?: DifficultyVariant\n    intermediate?: DifficultyVariant\n    advanced?: DifficultyVariant\n  }\n}\n\nexport interface Worksheet extends WithDifficultyVariants {\n  id: string\n  title: string\n  description: string\n  instructions: string\n  estimatedMinutes: number\n  points: number\n  questions: QuizQuestion[]\n  randomizeQuestions: boolean\n  timeLimit?: number\n  passingScore?: number\n  allowMultipleAttempts: boolean\n  maxAttempts?: number\n  showCorrectAnswers: boolean\n  /** @protected Instructor-only answer key */\n  answerKey?: string\n  /** @protected Whether answer key is encrypted/protected */\n  answerKeyProtected?: boolean\n  /** When false, not visible to students (draft) */\n  isPublished?: boolean\n  sourceDocument?: ImportedLearningResource\n}\n\nexport interface Lesson extends WithDifficultyVariants {\n  id: string\n  title: string\n  description?: string\n  duration: number\n  order: number\n  isPublished: boolean\n  prerequisites?: string[]\n  media: {\n    videos: Video[]\n    images: Image[]\n  }\n  docs: Document[]\n  content: Content[]\n  tasks: Task[]\n  homework: Assessment[]\n  worksheets: Worksheet[]\n  /** @deprecated legacy lesson quiz items are migrated into `homework` (Assessment) */\n  quizzes?: Quiz[]\n}\n\nexport interface ModuleQuiz extends Quiz, WithDifficultyVariants {\n  coverage: 'all_lessons' | 'selected_lessons'\n  coveredLessonIds?: string[]\n}\n\nexport interface Module extends WithDifficultyVariants {\n  id: string\n  title: string\n  description?: string\n  order: number\n  isPublished: boolean\n  lessons: Lesson[]\n  moduleQuizzes: ModuleQuiz[]\n}\n\n// ============================================\n// PROPS\n// ============================================\n\ninterface CourseBuilderProps {\n  courseId: string\n  courseName?: string\n  panelMode?: 'default' | 'live-class'\n  initialModules?: Module[]\n  onMakeVisibleToStudents?: (payload: VisibleDocumentPayload) => void\n  onSave?: (\n    modules: Module[],\n    options?: {\n      developmentMode: 'single' | 'multi'\n      previewDifficulty: 'all' | 'beginner' | 'intermediate' | 'advanced'\n    }\n  ) => void\n}\n\nexport interface CourseBuilderRef {\n  save: () => void\n}\n\n// ============================================\n// DEFAULT TEMPLATES\n// ============================================\n\nconst generateId = () => `${Date.now()}-${Math.random().toString(36).slice(2, 9)}`\n\nconst DEFAULT_CONTENT = (order: number): Content => ({\n  id: `content-${generateId()}`,\n  title: `Content ${order + 1}`,\n  type: 'text',\n  body: '',\n  order\n})\n\nconst DEFAULT_LESSON = (order: number): Lesson => ({\n  id: `lesson-${generateId()}`,\n  title: `Lesson ${order + 1}`,\n  description: '',\n  duration: 45,\n  order,\n  isPublished: false,\n  prerequisites: [],\n  media: { videos: [], images: [] },\n  docs: [],\n  content: [],\n  tasks: [],\n  homework: [],\n  worksheets: [],\n  quizzes: [],\n  difficultyMode: 'all',\n  variants: {}\n})\n\nconst DEFAULT_WORKSHEET = (order: number): Worksheet => ({\n  id: `worksheet-${generateId()}`,\n  title: `Worksheet ${order + 1}`,\n  description: '',\n  instructions: '',\n  estimatedMinutes: 20,\n  points: 15,\n  questions: [],\n  randomizeQuestions: false,\n  timeLimit: undefined,\n  passingScore: 70,\n  allowMultipleAttempts: true,\n  maxAttempts: 3,\n  showCorrectAnswers: true,\n  answerKey: '',\n  answerKeyProtected: true,\n  difficultyMode: 'all',\n  variants: {},\n  isPublished: false\n})\n\nconst DEFAULT_TASK = (order: number): Task => ({\n  id: `task-${generateId()}`,\n  title: `Task ${order + 1}`,\n  description: '',\n  instructions: '',\n  estimatedMinutes: 15,\n  points: 10,\n  submissionType: 'text',\n  isAiGraded: false,\n  answerKey: '',\n  answerKeyProtected: true,\n  questions: [],\n  randomizeQuestions: false,\n  difficultyMode: 'all',\n  variants: {},\n  isPublished: false\n})\n\nconst DEFAULT_HOMEWORK = (order: number): Assessment => ({\n  id: `homework-${generateId()}`,\n  title: `Assessment ${order + 1}`,\n  description: '',\n  instructions: '',\n  estimatedMinutes: 30,\n  points: 20,\n  submissionType: 'file',\n  allowLateSubmission: true,\n  questions: [],\n  randomizeQuestions: false,\n  timeLimit: undefined,\n  attemptsAllowed: 1,\n  passingScore: 70,\n  showCorrectAnswers: true,\n  answersNeverVisible: false,\n  latePenalty: 10,\n  answerKey: '',\n  answerKeyProtected: true,\n  difficultyMode: 'all',\n  variants: {},\n  isPublished: false\n})\n\nconst DEFAULT_QUIZ = (order: number): Quiz => ({\n  id: `quiz-${generateId()}`,\n  title: `Quiz ${order + 1}`,\n  description: '',\n  attemptsAllowed: 1,\n  questions: [],\n  passingScore: 70,\n  showCorrectAnswers: true,\n  randomizeQuestions: false,\n  answersNeverVisible: false,\n  difficultyMode: 'all',\n  variants: {},\n  isPublished: false,\n  allowLateSubmission: true,\n  latePenalty: 0,\n  answerKey: '',\n  answerKeyProtected: true\n})\n\nconst DEFAULT_MODULE_QUIZ = (order: number): ModuleQuiz => ({\n  ...DEFAULT_QUIZ(order),\n  coverage: 'all_lessons'\n})\n\nconst DEFAULT_MODULE = (order: number): Module => ({\n  id: `module-${generateId()}`,\n  title: `Module ${order + 1}`,\n  description: '',\n  order,\n  isPublished: false,\n  lessons: [],\n  moduleQuizzes: [],\n  difficultyMode: 'all',\n  variants: {}\n})\n\nfunction convertQuizToAssessment(quiz: Quiz): Assessment {\n  return {\n    id: `homework-${generateId()}`,\n    title: quiz.title?.replace(/quiz/gi, 'Assessment') || 'Assessment',\n    description: quiz.description || '',\n    instructions: quiz.description || '',\n    estimatedMinutes: quiz.timeLimit ?? 30,\n    points: quiz.questions?.reduce((sum, q) => sum + (q.points || 1), 0) || 20,\n    submissionType: 'questions',\n    allowLateSubmission: true,\n    latePenalty: 0,\n    questions: quiz.questions || [],\n    randomizeQuestions: quiz.randomizeQuestions || false,\n    timeLimit: quiz.timeLimit,\n    attemptsAllowed: quiz.attemptsAllowed || 1,\n    passingScore: quiz.passingScore,\n    showCorrectAnswers: quiz.showCorrectAnswers ?? true,\n    answersNeverVisible: quiz.answersNeverVisible ?? false,\n    answerKey: '',\n    answerKeyProtected: true,\n    difficultyMode: quiz.difficultyMode ?? 'all',\n    variants: quiz.variants ?? {},\n    isPublished: quiz.isPublished ?? false,\n    sourceDocument: quiz.sourceDocument,\n  }\n}\n\nfunction normalizeModulesForAssessments(rawModules: Module[]): Module[] {\n  return rawModules.map((module) => ({\n    ...module,\n    lessons: (module.lessons || []).map((lesson) => {\n      const existingAssessments = lesson.homework || []\n      const migratedAssessments = (lesson.quizzes || []).map(convertQuizToAssessment)\n      return {\n        ...lesson,\n        homework: [...existingAssessments, ...migratedAssessments],\n        quizzes: [],\n      }\n    }),\n  }))\n}\n\nfunction normalizeGeneratedQuestionType(rawType: unknown): QuizQuestion['type'] {\n  const type = typeof rawType === 'string' ? rawType.trim().toLowerCase() : ''\n  if (type === 'mcq' || type === 'multiple_choice') return 'mcq'\n  if (type === 'multiselect' || type === 'multi_select') return 'multiselect'\n  if (type === 'truefalse' || type === 'true_false') return 'truefalse'\n  if (type === 'matching') return 'matching'\n  if (type === 'fillblank' || type === 'fill_in_blank') return 'fillblank'\n  if (type === 'shortanswer' || type === 'short_answer') return 'shortanswer'\n  return 'essay'\n}\n\nfunction mapGeneratedModulesToBuilder(rawModules: unknown[]): Module[] {\n  if (!Array.isArray(rawModules)) return []\n\n  return rawModules.map((rawModule, moduleIdx) => {\n    const moduleObj = (rawModule ?? {}) as Record<string, any>\n    const rawLessons = Array.isArray(moduleObj.lessons) ? moduleObj.lessons : []\n    const rawExam = moduleObj.exam && typeof moduleObj.exam === 'object' ? moduleObj.exam : null\n\n    return {\n      ...DEFAULT_MODULE(moduleIdx),\n      title: String(moduleObj.title || `Module ${moduleIdx + 1}`),\n      description: String(moduleObj.description || ''),\n      lessons: rawLessons.map((rawLesson: Record<string, any>, lessonIdx: number) => {\n        const tasks = Array.isArray(rawLesson.tasks) ? rawLesson.tasks : []\n        const assessments = Array.isArray(rawLesson.assessments) ? rawLesson.assessments : []\n        const worksheets = Array.isArray(rawLesson.worksheets) ? rawLesson.worksheets : []\n\n        const mapQuestions = (rawQuestions: unknown[]): QuizQuestion[] =>\n          (Array.isArray(rawQuestions) ? rawQuestions : []).map((rawQuestion: unknown, questionIdx: number) => {\n            const questionObj = (rawQuestion ?? {}) as Record<string, any>\n            const qType = normalizeGeneratedQuestionType(questionObj.type)\n            return {\n              id: `q-${generateId()}`,\n              type: qType,\n              question: String(questionObj.question || `Question ${questionIdx + 1}`),\n              options: (qType === 'mcq' || qType === 'multiselect')\n                ? (Array.isArray(questionObj.options) && questionObj.options.length > 0\n                  ? questionObj.options.map((opt: unknown) => String(opt))\n                  : ['', '', '', ''])\n                : qType === 'truefalse'\n                  ? ['True', 'False']\n                  : undefined,\n              correctAnswer: questionObj.correctAnswer as string | string[] | undefined,\n              points: Math.max(1, Number(questionObj.points) || 1),\n              explanation: typeof questionObj.explanation === 'string' ? questionObj.explanation : '',\n            }\n          })\n\n        return {\n          ...DEFAULT_LESSON(lessonIdx),\n          title: String(rawLesson.title || `Lesson ${lessonIdx + 1}`),\n          description: String(rawLesson.description || ''),\n          duration: Math.max(15, Number(rawLesson.duration) || 45),\n          tasks: tasks.map((task: Record<string, any>, taskIdx: number) => ({\n            ...DEFAULT_TASK(taskIdx),\n            title: String(task.title || `Task ${taskIdx + 1}`),\n            description: String(task.description || ''),\n            instructions: String(task.instructions || ''),\n            estimatedMinutes: Math.max(5, Number(task.estimatedMinutes) || 15),\n            points: Math.max(1, Number(task.points) || 10),\n            submissionType: Array.isArray(task.questions) && task.questions.length > 0 ? 'questions' : 'text',\n            questions: mapQuestions(Array.isArray(task.questions) ? task.questions : []),\n          })),\n          homework: assessments.map((assessment: Record<string, any>, assessmentIdx: number) => ({\n            ...DEFAULT_HOMEWORK(assessmentIdx),\n            title: String(assessment.title || `Assessment ${assessmentIdx + 1}`),\n            description: String(assessment.description || ''),\n            instructions: String(assessment.instructions || ''),\n            estimatedMinutes: Math.max(10, Number(assessment.estimatedMinutes) || 30),\n            points: Math.max(1, Number(assessment.points) || 20),\n            submissionType: Array.isArray(assessment.questions) && assessment.questions.length > 0 ? 'questions' : 'text',\n            questions: mapQuestions(Array.isArray(assessment.questions) ? assessment.questions : []),\n          })),\n          worksheets: worksheets.map((worksheet: Record<string, any>, worksheetIdx: number) => ({\n            ...DEFAULT_WORKSHEET(worksheetIdx),\n            title: String(worksheet.title || `Worksheet ${worksheetIdx + 1}`),\n            description: String(worksheet.description || ''),\n            instructions: String(worksheet.instructions || ''),\n            estimatedMinutes: Math.max(10, Number(worksheet.estimatedMinutes) || 20),\n            points: Math.max(1, Number(worksheet.points) || 15),\n            questions: mapQuestions(Array.isArray(worksheet.questions) ? worksheet.questions : []),\n          })),\n        }\n      }),\n      moduleQuizzes: rawExam\n        ? [{\n          ...DEFAULT_MODULE_QUIZ(0),\n          title: String(rawExam.title || `Module ${moduleIdx + 1} Exam`),\n          description: String(rawExam.description || ''),\n          questions: (Array.isArray(rawExam.questions) ? rawExam.questions : []).map((rawQuestion: unknown, questionIdx: number) => {\n            const questionObj = (rawQuestion ?? {}) as Record<string, any>\n            const qType = normalizeGeneratedQuestionType(questionObj.type)\n            return {\n              id: `q-${generateId()}`,\n              type: qType,\n              question: String(questionObj.question || `Question ${questionIdx + 1}`),\n              options: (qType === 'mcq' || qType === 'multiselect')\n                ? (Array.isArray(questionObj.options) && questionObj.options.length > 0\n                  ? questionObj.options.map((opt: unknown) => String(opt))\n                  : ['', '', '', ''])\n                : qType === 'truefalse'\n                  ? ['True', 'False']\n                  : undefined,\n              correctAnswer: questionObj.correctAnswer as string | string[] | undefined,\n              points: Math.max(1, Number(questionObj.points) || 1),\n              explanation: typeof questionObj.explanation === 'string' ? questionObj.explanation : '',\n            }\n          }),\n        }]\n        : [],\n    }\n  })\n}\n\n// ============================================\n// AI SUGGESTIONS & TEMPLATES\n// ============================================\n\nconst AI_SUGGESTIONS = [\n  { id: 1, type: 'content', title: 'Add prerequisites section', description: 'Students often struggle without reviewing basics first', icon: Lightbulb },\n  { id: 2, type: 'quiz', title: 'Add checkpoint quiz', description: 'Insert a 5-question quiz after this module', icon: FileQuestion },\n  { id: 3, type: 'video', title: 'Replace with video', description: 'Convert this text section to a 5-min video', icon: Video },\n  { id: 4, type: 'activity', title: 'Add group activity', description: 'Collaborative exercise for peer learning', icon: Users },\n  { id: 5, type: 'assessment', title: 'Add practice problems', description: '3 similar problems with varying difficulty', icon: PenTool }\n]\n\nconst CONTENT_TEMPLATES = [\n  {\n    id: 'lesson-standard',\n    name: 'Standard Lesson',\n    category: 'lesson',\n    description: 'Title, content, and summary format',\n    icon: BookOpen\n  },\n  {\n    id: 'lesson-video',\n    name: 'Video Lesson',\n    category: 'lesson',\n    description: 'Video-based lesson with discussion questions',\n    icon: Video\n  },\n  {\n    id: 'quiz-mcq',\n    name: 'Multiple Choice Quiz',\n    category: 'quiz',\n    description: 'Standard multiple choice assessment',\n    icon: FileQuestion\n  },\n  {\n    id: 'activity-interactive',\n    name: 'Interactive Activity',\n    category: 'activity',\n    description: 'Drag-drop or interactive exercise',\n    icon: Gamepad2\n  },\n  {\n    id: 'assessment-project',\n    name: 'Project Assignment',\n    category: 'assessment',\n    description: 'Long-form project with rubric',\n    icon: PenTool\n  },\n  {\n    id: 'lesson-flipped',\n    name: 'Flipped Classroom',\n    category: 'lesson',\n    description: 'Pre-work video + in-class activity',\n    icon: MonitorPlay\n  }\n]\n\n// ============================================\n// BUILDER MODAL COMPONENTS\n// ============================================\n\ninterface BuilderModalProps {\n  isOpen: boolean\n  onClose: () => void\n  onSave: (data: any) => void\n  initialData?: any\n}\n\ntype ResourceTargetField = 'instructions' | 'body' | 'description'\n\ninterface ResourceImportPanelProps<T extends { sourceDocument?: ImportedLearningResource }> {\n  data: T\n  setData: (next: T) => void\n  targetField: ResourceTargetField\n}\n\ninterface QuestionBankItemLite {\n  id: string\n  type: string\n  question: string\n  options?: string[]\n  correctAnswer?: string | string[] | null\n  points?: number\n}\n\nfunction toBuilderQuestionType(type: string): QuizQuestion['type'] {\n  if (type === 'multiple_choice') return 'mcq'\n  if (type === 'multi_select') return 'multiselect'\n  if (type === 'true_false') return 'truefalse'\n  if (type === 'fill_in_blank') return 'fillblank'\n  if (type === 'matching') return 'matching'\n  if (type === 'short_answer') return 'shortanswer'\n  return 'essay'\n}\n\nfunction mapQuestionBankToBuilderQuestion(item: QuestionBankItemLite): QuizQuestion {\n  const builderType = toBuilderQuestionType(item.type)\n  const options = Array.isArray(item.options) ? item.options : undefined\n  const normalizedCorrect = (() => {\n    if (builderType === 'truefalse' && typeof item.correctAnswer === 'string') {\n      return item.correctAnswer.toLowerCase() === 'true' ? 'True' : 'False'\n    }\n    return item.correctAnswer ?? undefined\n  })()\n\n  return {\n    id: `q-${generateId()}`,\n    type: builderType,\n    question: item.question || '',\n    options: builderType === 'mcq' || builderType === 'multiselect'\n      ? (options && options.length > 0 ? options : ['', '', '', ''])\n      : (builderType === 'truefalse' ? ['True', 'False'] : undefined),\n    correctAnswer: normalizedCorrect as string | string[] | undefined,\n    points: Math.max(1, item.points ?? 1),\n  }\n}\n\n/**\n * Generate a PDF question paper from questions using jsPDF\n */\nfunction generateQuestionPaperPDF(title: string, description: string, questions: QuizQuestion[]): { blob: Blob; url: string; fileName: string } {\n  // Dynamic import jsPDF to avoid SSR issues\n  const jsPDF = require('jspdf')\n  const doc = new jsPDF()\n  \n  const pageWidth = doc.internal.pageSize.getWidth()\n  const margin = 15\n  const contentWidth = pageWidth - (margin * 2)\n  let y = 20\n  \n  // Title\n  doc.setFontSize(18)\n  doc.setFont('helvetica', 'bold')\n  doc.text(title.toUpperCase(), pageWidth / 2, y, { align: 'center' })\n  y += 12\n  \n  // Line under title\n  doc.setDrawColor(0)\n  doc.line(margin, y, pageWidth - margin, y)\n  y += 10\n  \n  // Instructions\n  if (description) {\n    doc.setFontSize(11)\n    doc.setFont('helvetica', 'bold')\n    doc.text('INSTRUCTIONS:', margin, y)\n    y += 6\n    \n    doc.setFont('helvetica', 'normal')\n    const descLines = doc.splitTextToSize(description, contentWidth)\n    doc.text(descLines, margin, y)\n    y += (descLines.length * 5) + 8\n  }\n  \n  // Summary box\n  doc.setFillColor(240, 240, 240)\n  doc.rect(margin, y - 5, contentWidth, 15, 'F')\n  doc.setFontSize(10)\n  doc.setFont('helvetica', 'bold')\n  const totalPoints = questions.reduce((sum, q) => sum + (q.points || 1), 0)\n  doc.text(`Total Questions: ${questions.length}    |    Total Points: ${totalPoints}`, margin + 5, y + 5)\n  y += 20\n  \n  // Questions\n  questions.forEach((q, idx) => {\n    // Check for page break\n    if (y > 260) {\n      doc.addPage()\n      y = 20\n    }\n    \n    // Question header\n    doc.setFontSize(11)\n    doc.setFont('helvetica', 'bold')\n    doc.text(`Question ${idx + 1}`, margin, y)\n    \n    // Points badge\n    doc.setFillColor(230, 230, 230)\n    doc.rect(pageWidth - margin - 30, y - 5, 30, 8, 'F')\n    doc.setFontSize(9)\n    doc.text(`${q.points || 1} pt${q.points !== 1 ? 's' : ''}`, pageWidth - margin - 15, y, { align: 'center' })\n    y += 8\n    \n    // Question text\n    doc.setFont('helvetica', 'normal')\n    doc.setFontSize(10)\n    const questionLines = doc.splitTextToSize(q.question, contentWidth)\n    doc.text(questionLines, margin, y)\n    y += (questionLines.length * 5) + 6\n    \n    // Options for MCQ/Multi-select\n    if (q.options && q.options.length > 0) {\n      q.options.forEach((opt, optIdx) => {\n        if (y > 270) {\n          doc.addPage()\n          y = 20\n        }\n        const letter = String.fromCharCode(65 + optIdx)\n        doc.setFontSize(10)\n        doc.text(`    ${letter}. ${opt}`, margin, y)\n        y += 6\n      })\n      y += 4\n    }\n    \n    // True/False\n    if (q.type === 'truefalse') {\n      doc.text('    [  ] True', margin + 5, y)\n      y += 6\n      doc.text('    [  ] False', margin + 5, y)\n      y += 10\n    }\n    \n    // Fill in blank\n    if (q.type === 'fillblank') {\n      doc.setDrawColor(180)\n      doc.line(margin + 5, y, margin + 100, y)\n      y += 10\n    }\n    \n    // Short answer\n    if (q.type === 'shortanswer') {\n      doc.setDrawColor(180)\n      doc.line(margin + 5, y, pageWidth - margin, y)\n      y += 12\n    }\n    \n    // Essay\n    if (q.type === 'essay') {\n      doc.setDrawColor(180)\n      for (let i = 0; i < 4; i++) {\n        doc.line(margin + 5, y + (i * 8), pageWidth - margin, y + (i * 8))\n      }\n      y += 40\n    }\n    \n    y += 8\n  })\n  \n  // Footer\n  const totalPages = doc.internal.getNumberOfPages()\n  for (let i = 1; i <= totalPages; i++) {\n    doc.setPage(i)\n    doc.setFontSize(8)\n    doc.setTextColor(128)\n    doc.text(`Page ${i} of ${totalPages}  |  ${title}`, pageWidth / 2, 285, { align: 'center' })\n  }\n  \n  const pdfBlob = doc.output('blob')\n  const pdfUrl = URL.createObjectURL(pdfBlob)\n  const fileName = `${title.replace(/[^a-z0-9]/gi, '_')}_Question_Paper.pdf`\n  \n  return { blob: pdfBlob, url: pdfUrl, fileName }\n}\n\nfunction QuestionBankQuickImport({ onImport }: { onImport: (questions: QuizQuestion[]) => void }) {\n  const [loading, setLoading] = useState(false)\n  const [items, setItems] = useState<QuestionBankItemLite[]>([])\n  const [selectedId, setSelectedId] = useState('')\n\n  useEffect(() => {\n    let active = true\n    const load = async () => {\n      setLoading(true)\n      try {\n        const res = await fetch('/api/tutor/question-bank?limit=100', { credentials: 'include' })\n        if (!res.ok) return\n        const data = await res.json()\n        const next = Array.isArray(data.questions) ? data.questions : []\n        if (active) setItems(next)\n      } catch {\n        // Non-fatal.\n      } finally {\n        if (active) setLoading(false)\n      }\n    }\n    load()\n    return () => {\n      active = false\n    }\n  }, [])\n\n  return (\n    <div className=\"rounded border border-dashed p-2.5 bg-background/80\">\n      <div className=\"flex flex-wrap gap-2 items-center\">\n        <Select value={selectedId} onValueChange={setSelectedId}>\n          <SelectTrigger className=\"min-w-[260px] h-8\">\n            <SelectValue placeholder={loading ? 'Loading question bank...' : 'Import from question bank'} />\n          </SelectTrigger>\n          <SelectContent>\n            {items.map((item) => (\n              <SelectItem key={item.id} value={item.id}>\n                {item.question.slice(0, 70)}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          size=\"sm\"\n          disabled={!selectedId}\n          onClick={() => {\n            const selected = items.find((item) => item.id === selectedId)\n            if (!selected) return\n            onImport([mapQuestionBankToBuilderQuestion(selected)])\n            toast.success('Question imported from question bank')\n            setSelectedId('')\n          }}\n        >\n          Import Selected\n        </Button>\n        <Button type=\"button\" variant=\"ghost\" size=\"sm\" asChild>\n          <a href=\"/tutor/question-bank\" target=\"_blank\" rel=\"noreferrer\">\n            Open Question Bank\n          </a>\n        </Button>\n      </div>\n    </div>\n  )\n}\n\nfunction ManualQuestionComposer({\n  onImport,\n}: {\n  onImport: (questions: QuizQuestion[]) => void\n}) {\n  const [questionText, setQuestionText] = useState('')\n  const [saving, setSaving] = useState(false)\n\n  const handleAdd = async () => {\n    const trimmed = questionText.trim()\n    if (!trimmed) return\n\n    const question: QuizQuestion = {\n      id: `q-${generateId()}`,\n      type: 'shortanswer',\n      question: trimmed,\n      points: 1,\n      explanation: '',\n    }\n    onImport([question])\n    setQuestionText('')\n    setSaving(true)\n\n    try {\n      const csrfRes = await fetch('/api/csrf', { credentials: 'include' })\n      const csrfData = await csrfRes.json().catch(() => ({}))\n      const csrfToken = csrfData?.token ?? null\n\n      const qbRes = await fetch('/api/tutor/question-bank', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(csrfToken ? { 'X-CSRF-Token': csrfToken } : {}),\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          type: 'short_answer',\n          question: trimmed,\n          correctAnswer: '',\n          explanation: '',\n          points: 1,\n          difficulty: 'medium',\n          tags: ['course-builder', 'manual-entry'],\n          isPublic: false,\n        }),\n      })\n\n      if (!qbRes.ok) {\n        toast.error('Question added locally, but failed to save in question bank')\n      } else {\n        toast.success('Question added and saved in question bank')\n      }\n    } catch {\n      toast.error('Question added locally, but failed to save in question bank')\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  return (\n    <div className=\"rounded border p-2.5 bg-muted/20 space-y-2\">\n      <Label className=\"text-xs font-medium\">Write a new question</Label>\n      <Textarea\n        value={questionText}\n        onChange={(e) => setQuestionText(e.target.value)}\n        placeholder=\"Type a question here to add it directly and save to question bank.\"\n        rows={2}\n      />\n      <div className=\"flex justify-end\">\n        <Button type=\"button\" size=\"sm\" variant=\"outline\" disabled={!questionText.trim() || saving} onClick={handleAdd}>\n          {saving ? 'Saving...' : 'Add Question'}\n        </Button>\n      </div>\n    </div>\n  )\n}\n\nfunction ResourceImportPanel<T extends { sourceDocument?: ImportedLearningResource }>({\n  data,\n  setData,\n  targetField,\n}: ResourceImportPanelProps<T>) {\n  const [extracting, setExtracting] = useState(false)\n  const [resources, setResources] = useState<Array<{ id: string; name: string; url: string; mimeType: string | null }>>([])\n  const [resourceId, setResourceId] = useState('')\n  const previousBlobUrlRef = useRef<string | null>(null)\n\n  useEffect(() => {\n    let active = true\n    const loadResources = async () => {\n      try {\n        const res = await fetch('/api/tutor/resources', { credentials: 'include' })\n        if (!res.ok) return\n        const payload = await res.json()\n        const items = Array.isArray(payload.resources) ? payload.resources : []\n        if (active) setResources(items)\n      } catch {\n        // Non-fatal.\n      }\n    }\n    loadResources()\n    return () => {\n      active = false\n    }\n  }, [])\n\n  useEffect(() => {\n    const nextUrl = data.sourceDocument?.fileUrl\n    const previousUrl = previousBlobUrlRef.current\n\n    if (previousUrl && previousUrl !== nextUrl && previousUrl.startsWith('blob:')) {\n      URL.revokeObjectURL(previousUrl)\n    }\n\n    previousBlobUrlRef.current =\n      typeof nextUrl === 'string' && nextUrl.startsWith('blob:') ? nextUrl : null\n\n    return () => {\n      const current = previousBlobUrlRef.current\n      if (current && current.startsWith('blob:')) {\n        URL.revokeObjectURL(current)\n      }\n      previousBlobUrlRef.current = null\n    }\n  }, [data.sourceDocument?.fileUrl])\n\n  const handleImport = async (fileList: FileList | null) => {\n    const file = fileList?.[0]\n    if (!file) return\n    setExtracting(true)\n    try {\n      const extractedText = await extractTextFromFile(file)\n      const localObjectUrl = URL.createObjectURL(file)\n      let fileUrl = localObjectUrl\n      try {\n        const formData = new FormData()\n        formData.append('file', file)\n        const uploadRes = await fetch('/api/uploads/documents', {\n          method: 'POST',\n          credentials: 'include',\n          body: formData,\n        })\n        if (uploadRes.ok) {\n          const uploadData = await uploadRes.json()\n          if (typeof uploadData?.url === 'string' && uploadData.url.length > 0) {\n            fileUrl = uploadData.url\n            URL.revokeObjectURL(localObjectUrl)\n          }\n        }\n      } catch {\n        // Fallback to local object URL if upload endpoint is unavailable.\n      }\n      const sourceDocument: ImportedLearningResource = {\n        fileName: file.name,\n        mimeType: file.type || 'application/octet-stream',\n        fileUrl,\n        extractedText: extractedText || '',\n        uploadedAt: new Date().toISOString(),\n      }\n      const currentTarget = (data as Record<string, unknown>)[targetField]\n      if (!String(currentTarget || '').trim() && extractedText) {\n        setData({ ...data, sourceDocument, [targetField]: extractedText.slice(0, 4000) } as T)\n      } else {\n        setData({ ...data, sourceDocument })\n      }\n      toast.success('Document imported. You can edit it in preview.')\n    } catch {\n      toast.error('Failed to extract text from file')\n    } finally {\n      setExtracting(false)\n    }\n  }\n\n  const handlePickExistingResource = async (selected: string) => {\n    setResourceId(selected)\n    const resource = resources.find((item) => item.id === selected)\n    if (!resource) return\n\n    setExtracting(true)\n    try {\n      let extractedText = ''\n      try {\n        const response = await fetch(resource.url)\n        if (response.ok) {\n          const blob = await response.blob()\n          const file = new File([blob], resource.name, { type: resource.mimeType || blob.type || 'application/octet-stream' })\n          extractedText = await extractTextFromFile(file)\n        }\n      } catch {\n        // Keep empty text if remote source cannot be parsed.\n      }\n\n      const sourceDocument: ImportedLearningResource = {\n        fileName: resource.name,\n        mimeType: resource.mimeType || 'application/octet-stream',\n        fileUrl: resource.url,\n        extractedText: extractedText || '',\n        uploadedAt: new Date().toISOString(),\n      }\n\n      const currentTarget = (data as Record<string, unknown>)[targetField]\n      if (!String(currentTarget || '').trim() && extractedText) {\n        setData({ ...data, sourceDocument, [targetField]: extractedText.slice(0, 4000) } as T)\n      } else {\n        setData({ ...data, sourceDocument } as T)\n      }\n      toast.success('Resource imported into this item.')\n    } catch {\n      toast.error('Failed to import selected resource')\n    } finally {\n      setExtracting(false)\n      setResourceId('')\n    }\n  }\n\n  const source = data.sourceDocument\n\n  return (\n    <div className=\"space-y-3 rounded-lg border border-dashed p-3\">\n      <div className=\"flex items-center gap-2\">\n        <Button variant=\"outline\" size=\"sm\" disabled={extracting} asChild>\n          <label className=\"cursor-pointer\">\n            {extracting ? <Loader2 className=\"mr-1 h-3 w-3 animate-spin\" /> : <Upload className=\"mr-1 h-3 w-3\" />}\n            Upload file\n            <input\n              type=\"file\"\n              className=\"hidden\"\n              accept=\".pdf,.txt,.md,.doc,.docx,image/*\"\n              onChange={(e) => {\n                handleImport(e.target.files)\n                e.currentTarget.value = ''\n              }}\n            />\n          </label>\n        </Button>\n        <Button type=\"button\" variant=\"outline\" size=\"sm\" asChild>\n          <a href=\"/tutor/resources\" target=\"_blank\" rel=\"noreferrer\">\n            Open Resources\n          </a>\n        </Button>\n      </div>\n      {source && (\n        <div className=\"space-y-2 rounded border bg-muted/20 p-3\">\n          <div className=\"text-xs text-muted-foreground\">\n            Imported: <span className=\"font-medium text-foreground\">{source.fileName}</span>\n          </div>\n          <Textarea\n            value={source.extractedText}\n            onChange={(e) =>\n              setData({\n                ...data,\n                sourceDocument: {\n                  ...source,\n                  extractedText: e.target.value,\n                },\n              } as T)\n            }\n            rows={6}\n            placeholder=\"Imported content text (editable)\"\n          />\n          {source.mimeType.startsWith('image/') && (\n            <a href={source.fileUrl} target=\"_blank\" rel=\"noreferrer\" className=\"text-xs text-blue-600 underline\">\n              Open image preview\n            </a>\n          )}\n          {source.mimeType === 'application/pdf' && (\n            <a href={source.fileUrl} target=\"_blank\" rel=\"noreferrer\" className=\"text-xs text-blue-600 underline\">\n              Open PDF preview\n            </a>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n\n// Module Builder Modal\nfunction ModuleBuilderModal({ isOpen, onClose, onSave, initialData }: BuilderModalProps) {\n  const [data, setData] = useState(initialData || { title: '', description: '' })\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Layers className=\"h-5 w-5 text-blue-500\" />\n            Module Builder\n          </DialogTitle>\n        </DialogHeader>\n        <div className=\"space-y-4 py-4\">\n          <div className=\"space-y-2\">\n            <Label>Module Title *</Label>\n            <Input\n              value={data.title}\n              onChange={(e) => setData({ ...data, title: e.target.value })}\n              placeholder=\"Enter module title\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label>Description</Label>\n            <Textarea\n              value={data.description}\n              onChange={(e) => setData({ ...data, description: e.target.value })}\n              placeholder=\"What will students learn in this module?\"\n              rows={3}\n            />\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Switch\n              checked={data.isPublished}\n              onCheckedChange={(checked) => setData({ ...data, isPublished: checked })}\n            />\n            <Label>Published (visible to students)</Label>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={onClose}>Cancel</Button>\n          <Button onClick={() => onSave(data)}>Save Module</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n// Lesson Builder Modal\nfunction LessonBuilderModal({ isOpen, onClose, onSave, initialData, allLessons = [] }: BuilderModalProps & { allLessons?: Lesson[] }) {\n  const [data, setData] = useState<Lesson>(initialData || DEFAULT_LESSON(0))\n  const [activeVariant, setActiveVariant] = useState<DifficultyLevel>('beginner')\n\n  const updateVariant = (level: DifficultyLevel, updates: Partial<DifficultyVariant>) => {\n    setData({\n      ...data,\n      variants: {\n        ...data.variants,\n        [level]: { ...data.variants?.[level], ...updates }\n      }\n    })\n  }\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <BookOpen className=\"h-5 w-5 text-green-500\" />\n            Lesson Builder\n          </DialogTitle>\n        </DialogHeader>\n        <div className=\"space-y-4 py-4\">\n          {/* Difficulty Mode Section */}\n          <div className=\"bg-blue-50 rounded-lg p-4 border border-blue-200 space-y-3\">\n            <Label className=\"text-sm font-medium flex items-center gap-2\">\n              <BarChart3 className=\"h-4 w-4 text-blue-500\" />\n              Difficulty Settings\n            </Label>\n\n            <Select\n              value={data.difficultyMode}\n              onValueChange={(v: DifficultyMode) => setData({ ...data, difficultyMode: v })}\n            >\n              <SelectTrigger className=\"bg-white\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">ðŸ“‹ All Levels (Same content for everyone)</SelectItem>\n                <SelectItem value=\"fixed\">ðŸŽ¯ Fixed Level (Only for specific level)</SelectItem>\n                <SelectItem value=\"adaptive\">ðŸ”„ Adaptive (Different content per level)</SelectItem>\n              </SelectContent>\n            </Select>\n\n            {/* Fixed Difficulty Selector */}\n            {data.difficultyMode === 'fixed' && (\n              <div className=\"space-y-2\">\n                <Label className=\"text-xs\">Select Fixed Level</Label>\n                <div className=\"flex gap-2\">\n                  {(['beginner', 'intermediate', 'advanced'] as const).map((level) => (\n                    <button\n                      key={level}\n                      onClick={() => setData({ ...data, fixedDifficulty: level })}\n                      className={cn(\n                        \"flex-1 py-2 px-3 rounded-lg border text-sm font-medium transition-all\",\n                        data.fixedDifficulty === level\n                          ? level === 'beginner'\n                            ? \"bg-green-500 text-white border-green-500\"\n                            : level === 'intermediate'\n                              ? \"bg-blue-500 text-white border-blue-500\"\n                              : \"bg-purple-500 text-white border-purple-500\"\n                          : \"bg-white text-gray-700 hover:bg-gray-50\"\n                      )}\n                    >\n                      {level === 'beginner' && <SignalLow className=\"h-4 w-4 inline mr-1\" />}\n                      {level === 'intermediate' && <Signal className=\"h-4 w-4 inline mr-1\" />}\n                      {level === 'advanced' && <SignalHigh className=\"h-4 w-4 inline mr-1\" />}\n                      {level.charAt(0).toUpperCase() + level.slice(1)}\n                    </button>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Variants Editor (Adaptive Mode) */}\n            {data.difficultyMode === 'adaptive' && (\n              <div className=\"space-y-3 pt-2\">\n                <Label className=\"text-xs\">Customize for each level:</Label>\n                <div className=\"flex gap-2\">\n                  {(['beginner', 'intermediate', 'advanced'] as const).map((level) => (\n                    <button\n                      key={level}\n                      onClick={() => setActiveVariant(level)}\n                      className={cn(\n                        \"flex-1 py-1.5 px-2 rounded text-xs font-medium transition-all border\",\n                        activeVariant === level\n                          ? level === 'beginner'\n                            ? \"bg-green-100 border-green-300 text-green-700\"\n                            : level === 'intermediate'\n                              ? \"bg-blue-100 border-blue-300 text-blue-700\"\n                              : \"bg-purple-100 border-purple-300 text-purple-700\"\n                          : \"bg-white border-gray-200 text-gray-600\"\n                      )}\n                    >\n                      {level.charAt(0).toUpperCase() + level.slice(1)}\n                      {data.variants?.[level]?.enabled && <Check className=\"h-3 w-3 inline ml-1\" />}\n                    </button>\n                  ))}\n                </div>\n\n                {/* Variant Editor for Active Level */}\n                <div className=\"bg-white rounded-lg p-3 border space-y-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className={cn(\n                      \"text-sm font-medium capitalize\",\n                      activeVariant === 'beginner' ? \"text-green-700\" :\n                        activeVariant === 'intermediate' ? \"text-blue-700\" : \"text-purple-700\"\n                    )}>\n                      {activeVariant} Version\n                    </span>\n                    <div className=\"flex items-center gap-2\">\n                      <Switch\n                        checked={data.variants?.[activeVariant]?.enabled ?? false}\n                        onCheckedChange={(checked) => updateVariant(activeVariant, { enabled: checked })}\n                      />\n                      <Label className=\"text-xs\">Enable variant</Label>\n                    </div>\n                  </div>\n\n                  {data.variants?.[activeVariant]?.enabled && (\n                    <div className=\"space-y-2\">\n                      <Input\n                        placeholder={`${activeVariant} title (optional)`}\n                        value={data.variants?.[activeVariant]?.title || ''}\n                        onChange={(e) => updateVariant(activeVariant, { title: e.target.value })}\n                      />\n                      <Textarea\n                        placeholder={`${activeVariant} description (optional)`}\n                        value={data.variants?.[activeVariant]?.description || ''}\n                        onChange={(e) => updateVariant(activeVariant, { description: e.target.value })}\n                        rows={2}\n                      />\n                      <Input\n                        type=\"number\"\n                        placeholder={`${activeVariant} duration in minutes`}\n                        value={data.variants?.[activeVariant]?.duration || ''}\n                        onChange={(e) => updateVariant(activeVariant, { duration: parseInt(e.target.value) || undefined })}\n                      />\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>Lesson Title *</Label>\n            <Input\n              value={data.title}\n              onChange={(e) => setData({ ...data, title: e.target.value })}\n              placeholder=\"Enter lesson title (base version)\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label>Description</Label>\n            <Textarea\n              value={data.description}\n              onChange={(e) => setData({ ...data, description: e.target.value })}\n              placeholder=\"Brief overview of this lesson (base version)\"\n              rows={2}\n            />\n          </div>\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>Duration (minutes)</Label>\n              <Input\n                type=\"number\"\n                value={data.duration}\n                onChange={(e) => setData({ ...data, duration: parseInt(e.target.value) || 45 })}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Status</Label>\n              <div className=\"flex items-center gap-2 pt-2\">\n                <Switch\n                  checked={data.isPublished}\n                  onCheckedChange={(checked) => setData({ ...data, isPublished: checked })}\n                />\n                <Label className=\"text-sm\">Published</Label>\n              </div>\n            </div>\n          </div>\n          {allLessons.length > 0 && (\n            <div className=\"space-y-2\">\n              <Label>Prerequisites (optional)</Label>\n              <p className=\"text-xs text-muted-foreground\">Students must complete selected lessons before accessing this one</p>\n              <div className=\"border rounded-lg p-3 space-y-2 max-h-40 overflow-y-auto\">\n                {allLessons.map((lesson) => (\n                  <label key={lesson.id} className=\"flex items-center gap-2 cursor-pointer\">\n                    <input\n                      type=\"checkbox\"\n                      checked={data.prerequisites?.includes(lesson.id)}\n                      onChange={(e) => {\n                        const prereqs = data.prerequisites || []\n                        if (e.target.checked) {\n                          setData({ ...data, prerequisites: [...prereqs, lesson.id] })\n                        } else {\n                          setData({ ...data, prerequisites: prereqs.filter((id: string) => id !== lesson.id) })\n                        }\n                      }}\n                      className=\"rounded\"\n                    />\n                    <span className=\"text-sm\">{lesson.title}</span>\n                  </label>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={onClose}>Cancel</Button>\n          <Button onClick={() => onSave(data)}>Save Lesson</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n// Task Builder Modal\nfunction TaskBuilderModal({ isOpen, onClose, onSave, initialData }: BuilderModalProps) {\n  const [data, setData] = useState<Task>(initialData || DEFAULT_TASK(0))\n  const [showAnswerKey, setShowAnswerKey] = useState(false)\n  const [taskManualQuestion, setTaskManualQuestion] = useState('')\n  const [savingManualQuestion, setSavingManualQuestion] = useState(false)\n\n  const addQuestion = (type: QuizQuestion['type']) => {\n    const newQuestion: QuizQuestion = {\n      id: `q-${Date.now()}`,\n      type,\n      question: '',\n      points: 1,\n      options: (type === 'mcq' || type === 'multiselect') ? ['', '', '', ''] : type === 'truefalse' ? ['True', 'False'] : undefined\n    }\n    setData({ ...data, questions: [...(data.questions || []), newQuestion] })\n  }\n\n  const updateQuestion = (index: number, updates: Partial<QuizQuestion>) => {\n    const newQuestions = [...(data.questions || [])]\n    newQuestions[index] = { ...newQuestions[index], ...updates }\n    setData({ ...data, questions: newQuestions })\n  }\n\n  const removeQuestion = (index: number) => {\n    setData({ ...data, questions: (data.questions || []).filter((_, i) => i !== index) })\n  }\n\n  const persistManualQuestionToBank = async () => {\n    const trimmed = taskManualQuestion.trim()\n    if (!trimmed) return\n\n    setSavingManualQuestion(true)\n    try {\n      const csrfRes = await fetch('/api/csrf', { credentials: 'include' })\n      const csrfData = await csrfRes.json().catch(() => ({}))\n      const csrfToken = csrfData?.token ?? null\n\n      const qbRes = await fetch('/api/tutor/question-bank', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(csrfToken ? { 'X-CSRF-Token': csrfToken } : {}),\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          type: 'short_answer',\n          question: trimmed,\n          correctAnswer: '',\n          explanation: '',\n          points: 1,\n          difficulty: 'medium',\n          tags: ['course-builder', 'task-manual-question'],\n          isPublic: false,\n        }),\n      })\n\n      if (!qbRes.ok) {\n        toast.error('Task saved, but manual question failed to save in question bank')\n      } else {\n        toast.success('Manual task question saved in question bank')\n      }\n    } catch {\n      toast.error('Task saved, but manual question failed to save in question bank')\n    } finally {\n      setSavingManualQuestion(false)\n    }\n  }\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <ListTodo className=\"h-5 w-5 text-orange-500\" />\n            Task Builder\n          </DialogTitle>\n        </DialogHeader>\n        <Tabs defaultValue=\"edit\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 mb-4\">\n            <TabsTrigger value=\"edit\">Edit</TabsTrigger>\n            <TabsTrigger value=\"preview\">Preview (student view)</TabsTrigger>\n          </TabsList>\n          <TabsContent value=\"edit\" className=\"space-y-4 py-2\">\n            <div className=\"space-y-4 py-4\">\n              <div className=\"space-y-2\">\n                <Label>Task Title *</Label>\n                <Input\n                  value={data.title}\n                  onChange={(e) => setData({ ...data, title: e.target.value })}\n                  placeholder=\"e.g., Complete the reading exercise\"\n                />\n              </div>\n              <ResourceImportPanel data={data} setData={setData} targetField=\"instructions\" />\n              <div className=\"space-y-2\">\n                <Label>Instructions *</Label>\n                <Textarea\n                  value={data.instructions}\n                  onChange={(e) => setData({ ...data, instructions: e.target.value })}\n                  placeholder=\"Detailed step-by-step instructions\"\n                  rows={4}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Optional: Add your own question (saved to Question Bank on Save)</Label>\n                <Textarea\n                  value={taskManualQuestion}\n                  onChange={(e) => setTaskManualQuestion(e.target.value)}\n                  placeholder=\"Type your own question if needed. If empty, no new question is added to Question Bank.\"\n                  rows={2}\n                />\n              </div>\n              <div className=\"grid grid-cols-3 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>Time (min)</Label>\n                  <Input\n                    type=\"number\"\n                    value={data.estimatedMinutes}\n                    onChange={(e) => setData({ ...data, estimatedMinutes: parseInt(e.target.value) || 15 })}\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Points</Label>\n                  <Input\n                    type=\"number\"\n                    value={data.points}\n                    onChange={(e) => setData({ ...data, points: parseInt(e.target.value) || 10 })}\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Submission</Label>\n                  <Select\n                    value={data.submissionType}\n                    onValueChange={(v: Task['submissionType']) => setData({ ...data, submissionType: v })}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"text\">Text</SelectItem>\n                      <SelectItem value=\"file\">File</SelectItem>\n                      <SelectItem value=\"link\">Link</SelectItem>\n                      <SelectItem value=\"questions\">Questions</SelectItem>\n                      <SelectItem value=\"none\">None</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              {/* Questions Section - Only when submissionType is 'questions' */}\n              {data.submissionType === 'questions' && (\n                <div className=\"border rounded-lg p-4 space-y-4 bg-orange-50/30\">\n                  <div className=\"flex items-center justify-between\">\n                    <h3 className=\"font-medium flex items-center gap-2\">\n                      <FileQuestion className=\"h-4 w-4 text-orange-500\" />\n                      Questions ({data.questions?.length || 0})\n                    </h3>\n                    <div className=\"flex gap-2\">\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('mcq')}>\n                        <Plus className=\"h-4 w-4 mr-1\" /> MCQ\n                      </Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('truefalse')}>\n                        <Plus className=\"h-4 w-4 mr-1\" /> T/F\n                      </Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('shortanswer')}>\n                        <Plus className=\"h-4 w-4 mr-1\" /> Short\n                      </Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('essay')}>\n                        <Plus className=\"h-4 w-4 mr-1\" /> Essay\n                      </Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('multiselect')}>\n                        <Plus className=\"h-4 w-4 mr-1\" /> Multi-select\n                      </Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('matching')}>\n                        <Plus className=\"h-4 w-4 mr-1\" /> Matching\n                      </Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('fillblank')}>\n                        <Plus className=\"h-4 w-4 mr-1\" /> Fill Blank\n                      </Button>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Switch\n                      checked={data.randomizeQuestions}\n                      onCheckedChange={(checked) => setData({ ...data, randomizeQuestions: checked })}\n                    />\n                    <Label className=\"text-sm\">Randomize question order</Label>\n                  </div>\n                  <QuestionBankQuickImport\n                    onImport={(incomingQuestions) =>\n                      setData({ ...data, questions: [...(data.questions || []), ...incomingQuestions] })\n                    }\n                  />\n                  <div className=\"space-y-3\">\n                    {(data.questions || []).map((q, idx) => (\n                      <div key={q.id} className=\"border rounded-lg p-4 space-y-3 bg-white\">\n                        <div className=\"flex items-center justify-between\">\n                          <Badge variant=\"secondary\">Q{idx + 1} - {q.type.toUpperCase()}</Badge>\n                          <div className=\"flex items-center gap-2\">\n                            <Input\n                              type=\"number\"\n                              className=\"w-20 h-8\"\n                              value={q.points}\n                              onChange={(e) => updateQuestion(idx, { points: parseInt(e.target.value) || 1 })}\n                            />\n                            <span className=\"text-sm text-muted-foreground\">pts</span>\n                            <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\" onClick={() => removeQuestion(idx)}>\n                              <X className=\"h-4 w-4\" />\n                            </Button>\n                          </div>\n                        </div>\n                        <Textarea\n                          value={q.question}\n                          onChange={(e) => updateQuestion(idx, { question: e.target.value })}\n                          placeholder=\"Enter question\"\n                          rows={2}\n                        />\n                        {q.type === 'mcq' && q.options && (\n                          <div className=\"space-y-2 pl-4\">\n                            {q.options.map((opt, optIdx) => (\n                              <div key={optIdx} className=\"flex items-center gap-2\">\n                                <input\n                                  type=\"radio\"\n                                  name={`correct-${q.id}`}\n                                  checked={q.correctAnswer === opt}\n                                  onChange={() => updateQuestion(idx, { correctAnswer: opt })}\n                                />\n                                <Input\n                                  value={opt}\n                                  onChange={(e) => {\n                                    const newOptions = [...q.options!]\n                                    newOptions[optIdx] = e.target.value\n                                    updateQuestion(idx, { options: newOptions })\n                                  }}\n                                  placeholder={`Option ${optIdx + 1}`}\n                                  className=\"flex-1\"\n                                />\n                              </div>\n                            ))}\n                          </div>\n                        )}\n                        {q.type === 'multiselect' && q.options && (\n                          <div className=\"space-y-2 pl-4\">\n                            {q.options.map((opt, optIdx) => {\n                              const selectedAnswers = Array.isArray(q.correctAnswer) ? q.correctAnswer : []\n                              const checked = selectedAnswers.includes(opt)\n                              return (\n                                <div key={optIdx} className=\"flex items-center gap-2\">\n                                  <input\n                                    type=\"checkbox\"\n                                    checked={checked}\n                                    onChange={(e) => {\n                                      const next = new Set(selectedAnswers)\n                                      if (e.target.checked) next.add(opt)\n                                      else next.delete(opt)\n                                      updateQuestion(idx, { correctAnswer: Array.from(next) })\n                                    }}\n                                  />\n                                  <Input\n                                    value={opt}\n                                    onChange={(e) => {\n                                      const newOptions = [...q.options!]\n                                      newOptions[optIdx] = e.target.value\n                                      updateQuestion(idx, { options: newOptions })\n                                    }}\n                                    placeholder={`Option ${optIdx + 1}`}\n                                    className=\"flex-1\"\n                                  />\n                                </div>\n                              )\n                            })}\n                          </div>\n                        )}\n                        {q.type === 'truefalse' && (\n                          <div className=\"flex gap-4 pl-4\">\n                            <label className=\"flex items-center gap-2\">\n                              <input\n                                type=\"radio\"\n                                name={`correct-${q.id}`}\n                                checked={q.correctAnswer === 'True'}\n                                onChange={() => updateQuestion(idx, { correctAnswer: 'True' })}\n                              />\n                              <span>True</span>\n                            </label>\n                            <label className=\"flex items-center gap-2\">\n                              <input\n                                type=\"radio\"\n                                name={`correct-${q.id}`}\n                                checked={q.correctAnswer === 'False'}\n                                onChange={() => updateQuestion(idx, { correctAnswer: 'False' })}\n                              />\n                              <span>False</span>\n                            </label>\n                          </div>\n                        )}\n                        <Textarea\n                          value={q.explanation || ''}\n                          onChange={(e) => updateQuestion(idx, { explanation: e.target.value })}\n                          placeholder=\"Explanation (shown after answering)\"\n                          rows={2}\n                          className=\"text-sm\"\n                        />\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              <div className=\"flex items-center gap-2\">\n                <Switch\n                  checked={data.isAiGraded}\n                  onCheckedChange={(checked) => setData({ ...data, isAiGraded: checked })}\n                />\n                <Label>Enable AI grading assistance</Label>\n              </div>\n\n              {/* Answer Key Section - Protected */}\n              <div className=\"border-t pt-4 mt-4\">\n                <div className=\"flex items-center justify-between mb-3\">\n                  <div className=\"flex items-center gap-2\">\n                    <Shield className=\"h-4 w-4 text-amber-500\" />\n                    <Label className=\"text-amber-700 font-medium\">Instructor Answer Key (Protected)</Label>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      className=\"h-7 text-xs gap-1\"\n                      onClick={() => setShowAnswerKey(!showAnswerKey)}\n                    >\n                      {showAnswerKey ? <EyeOff className=\"h-3 w-3\" /> : <Eye className=\"h-3 w-3\" />}\n                      {showAnswerKey ? 'Hide' : 'Show'}\n                    </Button>\n                  </div>\n                </div>\n                {showAnswerKey ? (\n                  <div className=\"space-y-3\">\n                    <Textarea\n                      value={data.answerKey || ''}\n                      onChange={(e) => setData({ ...data, answerKey: e.target.value })}\n                      placeholder=\"Enter the expected answer/solution here. This is ONLY visible to instructors.\"\n                      rows={4}\n                      className=\"border-amber-200 bg-amber-50/30\"\n                    />\n                    <div className=\"flex items-center gap-2\">\n                      <Switch\n                        checked={data.answerKeyProtected !== false}\n                        onCheckedChange={(checked) => setData({ ...data, answerKeyProtected: checked })}\n                      />\n                      <Label className=\"text-xs text-muted-foreground\">\n                        <Lock className=\"h-3 w-3 inline mr-1\" />\n                        Protect answer key (never visible to students)\n                      </Label>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"p-3 bg-gray-50 rounded border border-dashed border-gray-200 text-center\">\n                    <Lock className=\"h-4 w-4 mx-auto mb-1 text-gray-400\" />\n                    <span className=\"text-xs text-muted-foreground\">Answer key is hidden. Click \"Show\" to view/edit.</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </TabsContent>\n          <TabsContent value=\"preview\" className=\"space-y-4 py-2\">\n            <div className=\"rounded-lg border bg-muted/30 p-4 space-y-3\">\n              <h3 className=\"font-semibold\">{data.title}</h3>\n              {data.description && <p className=\"text-sm text-muted-foreground\">{data.description}</p>}\n              {data.instructions && (\n                <div className=\"text-sm\"><span className=\"font-medium text-muted-foreground\">Instructions: </span>{data.instructions}</div>\n              )}\n              {data.sourceDocument && (\n                <div className=\"space-y-2\">\n                  <p className=\"text-xs font-medium text-muted-foreground\">Imported material (editable)</p>\n                  <Textarea\n                    value={data.sourceDocument.extractedText}\n                    onChange={(e) => setData({\n                      ...data,\n                      sourceDocument: { ...data.sourceDocument!, extractedText: e.target.value }\n                    })}\n                    rows={6}\n                  />\n                </div>\n              )}\n              <p className=\"text-xs text-muted-foreground\">{data.estimatedMinutes} min Â· {data.points} pts Â· {data.submissionType}</p>\n              <h4 className=\"text-sm font-medium mt-4\">Questions</h4>\n              <QuestionsPreview questions={data.questions ?? []} />\n            </div>\n          </TabsContent>\n        </Tabs>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={onClose}>Cancel</Button>\n          <Button\n            onClick={async () => {\n              await persistManualQuestionToBank()\n              onSave({ ...data })\n            }}\n            disabled={savingManualQuestion}\n          >\n            {savingManualQuestion ? 'Saving...' : 'Save'}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n// Assessment Builder Modal\nfunction AssessmentBuilderModal({ isOpen, onClose, onSave, initialData }: BuilderModalProps) {\n  const [data, setData] = useState<Assessment>(initialData || DEFAULT_HOMEWORK(0))\n  const [showAnswerKey, setShowAnswerKey] = useState(false)\n\n  const addQuestion = (type: QuizQuestion['type']) => {\n    const newQuestion: QuizQuestion = {\n      id: `q-${Date.now()}`,\n      type,\n      question: '',\n      points: 1,\n      options: (type === 'mcq' || type === 'multiselect') ? ['', '', '', ''] : type === 'truefalse' ? ['True', 'False'] : undefined\n    }\n    setData({ ...data, questions: [...(data.questions || []), newQuestion] })\n  }\n\n  const updateQuestion = (index: number, updates: Partial<QuizQuestion>) => {\n    const newQuestions = [...(data.questions || [])]\n    newQuestions[index] = { ...newQuestions[index], ...updates }\n    setData({ ...data, questions: newQuestions })\n  }\n\n  const removeQuestion = (index: number) => {\n    setData({ ...data, questions: (data.questions || []).filter((_, i) => i !== index) })\n  }\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Home className=\"h-5 w-5 text-purple-500\" />\n            Assessment Builder\n          </DialogTitle>\n        </DialogHeader>\n        <Tabs defaultValue=\"edit\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 mb-4\">\n            <TabsTrigger value=\"edit\">Edit</TabsTrigger>\n            <TabsTrigger value=\"preview\">Preview (student view)</TabsTrigger>\n          </TabsList>\n          <TabsContent value=\"edit\" className=\"space-y-4 py-2\">\n            <div className=\"space-y-4 py-4\">\n              <div className=\"grid grid-cols-4 gap-4\">\n                <div className=\"col-span-3 space-y-2\">\n                  <Label>Assessment Title *</Label>\n                  <Input\n                    value={data.title}\n                    onChange={(e) => setData({ ...data, title: e.target.value })}\n                    placeholder=\"e.g., Assessment 1\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Points</Label>\n                  <Input\n                    type=\"number\"\n                    value={data.points}\n                    onChange={(e) => setData({ ...data, points: parseInt(e.target.value) || 20 })}\n                  />\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Instructions</Label>\n                <Textarea\n                  value={data.description}\n                  onChange={(e) => setData({ ...data, description: e.target.value })}\n                  placeholder=\"What should students know before starting this assessment?\"\n                  rows={2}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Question *</Label>\n                <Textarea\n                  value={data.instructions}\n                  onChange={(e) => setData({ ...data, instructions: e.target.value })}\n                  placeholder=\"Enter the question here\"\n                  rows={4}\n                />\n              </div>\n              <p className=\"text-sm text-muted-foreground\">Or upload materials</p>\n              <ResourceImportPanel data={data} setData={setData} targetField=\"instructions\" />\n              <div className=\"flex gap-4 flex-wrap\">\n                <div className=\"flex items-center gap-2\">\n                  <Switch\n                    checked={data.showCorrectAnswers ?? true}\n                    onCheckedChange={(checked) => setData({ ...data, showCorrectAnswers: checked })}\n                    disabled={data.answersNeverVisible}\n                  />\n                  <Label className=\"text-sm\">Show correct answers</Label>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Switch\n                    checked={data.answersNeverVisible ?? false}\n                    onCheckedChange={(checked) => setData({ ...data, answersNeverVisible: checked, showCorrectAnswers: checked ? false : data.showCorrectAnswers })}\n                  />\n                  <Label className=\"text-sm\">Never show answers</Label>\n                </div>\n              </div>\n\n              {/* Questions Section - Only when submissionType is 'questions' */}\n              {data.submissionType === 'questions' && (\n                <div className=\"border rounded-lg p-4 space-y-4 bg-purple-50/30\">\n                  <div className=\"flex items-center justify-between\">\n                    <h3 className=\"font-medium flex items-center gap-2\">\n                      <FileQuestion className=\"h-4 w-4 text-purple-500\" />\n                      Questions ({data.questions?.length || 0})\n                    </h3>\n                    <div className=\"flex gap-2\">\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('mcq')}>\n                        <Plus className=\"h-4 w-4 mr-1\" /> MCQ\n                      </Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('truefalse')}>\n                        <Plus className=\"h-4 w-4 mr-1\" /> T/F\n                      </Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('shortanswer')}>\n                        <Plus className=\"h-4 w-4 mr-1\" /> Short\n                      </Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('essay')}>\n                        <Plus className=\"h-4 w-4 mr-1\" /> Essay\n                      </Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('multiselect')}>\n                        <Plus className=\"h-4 w-4 mr-1\" /> Multi-select\n                      </Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('matching')}>\n                        <Plus className=\"h-4 w-4 mr-1\" /> Matching\n                      </Button>\n                      <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('fillblank')}>\n                        <Plus className=\"h-4 w-4 mr-1\" /> Fill Blank\n                      </Button>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Switch\n                      checked={data.randomizeQuestions}\n                      onCheckedChange={(checked) => setData({ ...data, randomizeQuestions: checked })}\n                    />\n                    <Label className=\"text-sm\">Randomize question order</Label>\n                  </div>\n                  <QuestionBankQuickImport\n                    onImport={(incomingQuestions) =>\n                      setData({ ...data, questions: [...(data.questions || []), ...incomingQuestions] })\n                    }\n                  />\n                  <ManualQuestionComposer\n                    onImport={(incomingQuestions) =>\n                      setData({ ...data, questions: [...(data.questions || []), ...incomingQuestions] })\n                    }\n                  />\n                  <div className=\"space-y-3\">\n                    {(data.questions || []).map((q, idx) => (\n                      <div key={q.id} className=\"border rounded-lg p-4 space-y-3 bg-white\">\n                        <div className=\"flex items-center justify-between\">\n                          <Badge variant=\"secondary\">Q{idx + 1} - {q.type.toUpperCase()}</Badge>\n                          <div className=\"flex items-center gap-2\">\n                            <Input\n                              type=\"number\"\n                              className=\"w-20 h-8\"\n                              value={q.points}\n                              onChange={(e) => updateQuestion(idx, { points: parseInt(e.target.value) || 1 })}\n                            />\n                            <span className=\"text-sm text-muted-foreground\">pts</span>\n                            <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\" onClick={() => removeQuestion(idx)}>\n                              <X className=\"h-4 w-4\" />\n                            </Button>\n                          </div>\n                        </div>\n                        <Textarea\n                          value={q.question}\n                          onChange={(e) => updateQuestion(idx, { question: e.target.value })}\n                          placeholder=\"Enter question\"\n                          rows={2}\n                        />\n                        {q.type === 'mcq' && q.options && (\n                          <div className=\"space-y-2 pl-4\">\n                            {q.options.map((opt, optIdx) => (\n                              <div key={optIdx} className=\"flex items-center gap-2\">\n                                <input\n                                  type=\"radio\"\n                                  name={`correct-${q.id}`}\n                                  checked={q.correctAnswer === opt}\n                                  onChange={() => updateQuestion(idx, { correctAnswer: opt })}\n                                />\n                                <Input\n                                  value={opt}\n                                  onChange={(e) => {\n                                    const newOptions = [...q.options!]\n                                    newOptions[optIdx] = e.target.value\n                                    updateQuestion(idx, { options: newOptions })\n                                  }}\n                                  placeholder={`Option ${optIdx + 1}`}\n                                  className=\"flex-1\"\n                                />\n                              </div>\n                            ))}\n                          </div>\n                        )}\n                        {q.type === 'multiselect' && q.options && (\n                          <div className=\"space-y-2 pl-4\">\n                            {q.options.map((opt, optIdx) => {\n                              const selectedAnswers = Array.isArray(q.correctAnswer) ? q.correctAnswer : []\n                              const checked = selectedAnswers.includes(opt)\n                              return (\n                                <div key={optIdx} className=\"flex items-center gap-2\">\n                                  <input\n                                    type=\"checkbox\"\n                                    checked={checked}\n                                    onChange={(e) => {\n                                      const next = new Set(selectedAnswers)\n                                      if (e.target.checked) next.add(opt)\n                                      else next.delete(opt)\n                                      updateQuestion(idx, { correctAnswer: Array.from(next) })\n                                    }}\n                                  />\n                                  <Input\n                                    value={opt}\n                                    onChange={(e) => {\n                                      const newOptions = [...q.options!]\n                                      newOptions[optIdx] = e.target.value\n                                      updateQuestion(idx, { options: newOptions })\n                                    }}\n                                    placeholder={`Option ${optIdx + 1}`}\n                                    className=\"flex-1\"\n                                  />\n                                </div>\n                              )\n                            })}\n                          </div>\n                        )}\n                        {q.type === 'truefalse' && (\n                          <div className=\"flex gap-4 pl-4\">\n                            <label className=\"flex items-center gap-2\">\n                              <input\n                                type=\"radio\"\n                                name={`correct-${q.id}`}\n                                checked={q.correctAnswer === 'True'}\n                                onChange={() => updateQuestion(idx, { correctAnswer: 'True' })}\n                              />\n                              <span>True</span>\n                            </label>\n                            <label className=\"flex items-center gap-2\">\n                              <input\n                                type=\"radio\"\n                                name={`correct-${q.id}`}\n                                checked={q.correctAnswer === 'False'}\n                                onChange={() => updateQuestion(idx, { correctAnswer: 'False' })}\n                              />\n                              <span>False</span>\n                            </label>\n                          </div>\n                        )}\n                        <Textarea\n                          value={q.explanation || ''}\n                          onChange={(e) => updateQuestion(idx, { explanation: e.target.value })}\n                          placeholder=\"Explanation (shown after answering)\"\n                          rows={2}\n                          className=\"text-sm\"\n                        />\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              <div className=\"space-y-3 border rounded-lg p-4\">\n                <div className=\"flex items-center gap-2\">\n                  <Switch\n                    checked={data.allowLateSubmission}\n                    onCheckedChange={(checked) => setData({ ...data, allowLateSubmission: checked })}\n                  />\n                  <Label>Allow late submission</Label>\n                </div>\n                {data.allowLateSubmission && (\n                  <div className=\"space-y-2\">\n                    <Label>Late Penalty (%)</Label>\n                    <Input\n                      type=\"number\"\n                      min={0}\n                      max={100}\n                      value={data.latePenalty}\n                      onChange={(e) => setData({ ...data, latePenalty: parseInt(e.target.value) || 0 })}\n                    />\n                    <p className=\"text-xs text-muted-foreground\">Percentage deducted for late submissions</p>\n                  </div>\n                )}\n              </div>\n\n              {/* Answer Key Section - Protected */}\n              <div className=\"border-t pt-4 mt-4\">\n                <div className=\"flex items-center justify-between mb-3\">\n                  <div className=\"flex items-center gap-2\">\n                    <Shield className=\"h-4 w-4 text-amber-500\" />\n                    <Label className=\"text-amber-700 font-medium\">Instructor Answer Key (Protected)</Label>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      className=\"h-7 text-xs gap-1\"\n                      onClick={() => setShowAnswerKey(!showAnswerKey)}\n                    >\n                      {showAnswerKey ? <EyeOff className=\"h-3 w-3\" /> : <Eye className=\"h-3 w-3\" />}\n                      {showAnswerKey ? 'Hide' : 'Show'}\n                    </Button>\n                  </div>\n                </div>\n                {showAnswerKey ? (\n                  <div className=\"space-y-3\">\n                    <Textarea\n                      value={data.answerKey || ''}\n                      onChange={(e) => setData({ ...data, answerKey: e.target.value })}\n                      placeholder=\"Enter the expected answer/solution here. This is ONLY visible to instructors.\"\n                      rows={4}\n                      className=\"border-amber-200 bg-amber-50/30\"\n                    />\n                    <div className=\"flex items-center gap-2\">\n                      <Switch\n                        checked={data.answerKeyProtected !== false}\n                        onCheckedChange={(checked) => setData({ ...data, answerKeyProtected: checked })}\n                      />\n                      <Label className=\"text-xs text-muted-foreground\">\n                        <Lock className=\"h-3 w-3 inline mr-1\" />\n                        Protect answer key (never visible to students)\n                      </Label>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"p-3 bg-gray-50 rounded border border-dashed border-gray-200 text-center\">\n                    <Lock className=\"h-4 w-4 mx-auto mb-1 text-gray-400\" />\n                    <span className=\"text-xs text-muted-foreground\">Answer key is hidden. Click \"Show\" to view/edit.</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </TabsContent>\n          <TabsContent value=\"preview\" className=\"space-y-4 py-2\">\n            <div className=\"rounded-lg border bg-muted/30 p-4 space-y-3\">\n              <h3 className=\"font-semibold\">{data.title}</h3>\n              {data.description && <p className=\"text-sm text-muted-foreground\">{data.description}</p>}\n              {data.instructions && (\n                <div className=\"text-sm\"><span className=\"font-medium text-muted-foreground\">Instructions: </span>{data.instructions}</div>\n              )}\n              {data.sourceDocument && (\n                <div className=\"space-y-2\">\n                  <p className=\"text-xs font-medium text-muted-foreground\">Imported material (editable)</p>\n                  <Textarea\n                    value={data.sourceDocument.extractedText}\n                    onChange={(e) => setData({\n                      ...data,\n                      sourceDocument: { ...data.sourceDocument!, extractedText: e.target.value }\n                    })}\n                    rows={6}\n                  />\n                </div>\n              )}\n              <p className=\"text-xs text-muted-foreground\">{data.estimatedMinutes} min Â· {data.points} pts Â· {data.submissionType}</p>\n              <h4 className=\"text-sm font-medium mt-4\">Questions</h4>\n              <QuestionsPreview questions={data.questions ?? []} />\n            </div>\n          </TabsContent>\n        </Tabs>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={onClose}>Cancel</Button>\n          <Button onClick={() => onSave({ ...data })}>Save</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n// Worksheet Builder Modal\nfunction WorksheetBuilderModal({ isOpen, onClose, onSave, initialData }: BuilderModalProps) {\n  const [data, setData] = useState<Worksheet>(initialData || DEFAULT_WORKSHEET(0))\n  const [showAnswerKey, setShowAnswerKey] = useState(false)\n\n  const addQuestion = (type: QuizQuestion['type']) => {\n    const newQuestion: QuizQuestion = {\n      id: `q-${Date.now()}`,\n      type,\n      question: '',\n      points: 1,\n      options: type === 'mcq' ? ['', '', '', ''] : type === 'truefalse' ? ['True', 'False'] : undefined\n    }\n    setData({ ...data, questions: [...data.questions, newQuestion] })\n  }\n\n  const updateQuestion = (index: number, updates: Partial<QuizQuestion>) => {\n    const newQuestions = [...data.questions]\n    newQuestions[index] = { ...newQuestions[index], ...updates }\n    setData({ ...data, questions: newQuestions })\n  }\n\n  const removeQuestion = (index: number) => {\n    setData({ ...data, questions: data.questions.filter((_, i) => i !== index) })\n  }\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <FileText className=\"h-5 w-5 text-cyan-500\" />\n            Worksheet Builder\n          </DialogTitle>\n        </DialogHeader>\n        <Tabs defaultValue=\"edit\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 mb-4\">\n            <TabsTrigger value=\"edit\">Edit</TabsTrigger>\n            <TabsTrigger value=\"preview\">Preview (student view)</TabsTrigger>\n          </TabsList>\n          <TabsContent value=\"edit\" className=\"space-y-4 py-2\">\n            <div className=\"space-y-4 py-4\">\n              <div className=\"space-y-2\">\n                <Label>Worksheet Title *</Label>\n                <Input\n                  value={data.title}\n                  onChange={(e) => setData({ ...data, title: e.target.value })}\n                  placeholder=\"e.g., Practice Problems - Chapter 3\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Instructions</Label>\n                <Textarea\n                  value={data.description}\n                  onChange={(e) => setData({ ...data, description: e.target.value })}\n                  placeholder=\"What should students know before starting this worksheet?\"\n                  rows={2}\n                />\n              </div>\n              <ResourceImportPanel data={data} setData={setData} targetField=\"instructions\" />\n              <div className=\"space-y-2\">\n                <Label>Instructions *</Label>\n                <Textarea\n                  value={data.instructions}\n                  onChange={(e) => setData({ ...data, instructions: e.target.value })}\n                  placeholder=\"Detailed instructions for students\"\n                  rows={3}\n                />\n              </div>\n              <div className=\"grid grid-cols-4 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>Time (min)</Label>\n                  <Input\n                    type=\"number\"\n                    value={data.estimatedMinutes}\n                    onChange={(e) => setData({ ...data, estimatedMinutes: parseInt(e.target.value) || 20 })}\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Points</Label>\n                  <Input\n                    type=\"number\"\n                    value={data.points}\n                    onChange={(e) => setData({ ...data, points: parseInt(e.target.value) || 15 })}\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Passing Score (%)</Label>\n                  <Input\n                    type=\"number\"\n                    min={0}\n                    max={100}\n                    value={data.passingScore}\n                    onChange={(e) => setData({ ...data, passingScore: parseInt(e.target.value) || 70 })}\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Max Attempts</Label>\n                  <Input\n                    type=\"number\"\n                    min={1}\n                    value={data.maxAttempts}\n                    onChange={(e) => setData({ ...data, maxAttempts: parseInt(e.target.value) || 3 })}\n                    disabled={!data.allowMultipleAttempts}\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-6\">\n                <div className=\"flex items-center gap-2\">\n                  <Switch\n                    checked={data.allowMultipleAttempts}\n                    onCheckedChange={(checked) => setData({ ...data, allowMultipleAttempts: checked })}\n                  />\n                  <Label className=\"text-sm\">Allow multiple attempts</Label>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Switch\n                    checked={data.showCorrectAnswers}\n                    onCheckedChange={(checked) => setData({ ...data, showCorrectAnswers: checked })}\n                  />\n                  <Label className=\"text-sm\">Show correct answers after submission</Label>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Switch\n                    checked={data.randomizeQuestions}\n                    onCheckedChange={(checked) => setData({ ...data, randomizeQuestions: checked })}\n                  />\n                  <Label className=\"text-sm\">Randomize questions</Label>\n                </div>\n              </div>\n\n              {/* Questions Section */}\n              <div className=\"border rounded-lg p-4 space-y-4 bg-cyan-50/30\">\n                <div className=\"flex items-center justify-between\">\n                  <h3 className=\"font-medium flex items-center gap-2\">\n                    <FileQuestion className=\"h-4 w-4 text-cyan-500\" />\n                    Questions ({data.questions?.length || 0})\n                  </h3>\n                  <div className=\"flex gap-2\">\n                    <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('mcq')}>\n                      <Plus className=\"h-4 w-4 mr-1\" /> MCQ\n                    </Button>\n                    <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('truefalse')}>\n                      <Plus className=\"h-4 w-4 mr-1\" /> T/F\n                    </Button>\n                    <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('shortanswer')}>\n                      <Plus className=\"h-4 w-4 mr-1\" /> Short\n                    </Button>\n                    <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('essay')}>\n                      <Plus className=\"h-4 w-4 mr-1\" /> Essay\n                    </Button>\n                  </div>\n                </div>\n                <QuestionBankQuickImport\n                  onImport={(incomingQuestions) =>\n                    setData({ ...data, questions: [...(data.questions || []), ...incomingQuestions] })\n                  }\n                />\n                <ManualQuestionComposer\n                  onImport={(incomingQuestions) =>\n                    setData({ ...data, questions: [...(data.questions || []), ...incomingQuestions] })\n                  }\n                />\n                <div className=\"space-y-3\">\n                  {(data.questions || []).map((q, idx) => (\n                    <div key={q.id} className=\"border rounded-lg p-4 space-y-3 bg-white\">\n                      <div className=\"flex items-center justify-between\">\n                        <Badge variant=\"secondary\">Q{idx + 1} - {q.type.toUpperCase()}</Badge>\n                        <div className=\"flex items-center gap-2\">\n                          <Input\n                            type=\"number\"\n                            className=\"w-20 h-8\"\n                            value={q.points}\n                            onChange={(e) => updateQuestion(idx, { points: parseInt(e.target.value) || 1 })}\n                          />\n                          <span className=\"text-sm text-muted-foreground\">pts</span>\n                          <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\" onClick={() => removeQuestion(idx)}>\n                            <X className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                      <Textarea\n                        value={q.question}\n                        onChange={(e) => updateQuestion(idx, { question: e.target.value })}\n                        placeholder=\"Enter question\"\n                        rows={2}\n                      />\n                      {q.type === 'mcq' && q.options && (\n                        <div className=\"space-y-2 pl-4\">\n                          {q.options.map((opt, optIdx) => (\n                            <div key={optIdx} className=\"flex items-center gap-2\">\n                              <input\n                                type=\"radio\"\n                                name={`correct-${q.id}`}\n                                checked={q.correctAnswer === opt}\n                                onChange={() => updateQuestion(idx, { correctAnswer: opt })}\n                              />\n                              <Input\n                                value={opt}\n                                onChange={(e) => {\n                                  const newOptions = [...q.options!]\n                                  newOptions[optIdx] = e.target.value\n                                  updateQuestion(idx, { options: newOptions })\n                                }}\n                                placeholder={`Option ${optIdx + 1}`}\n                                className=\"flex-1\"\n                              />\n                            </div>\n                          ))}\n                        </div>\n                      )}\n                      {q.type === 'truefalse' && (\n                        <div className=\"flex gap-4 pl-4\">\n                          <label className=\"flex items-center gap-2\">\n                            <input\n                              type=\"radio\"\n                              name={`correct-${q.id}`}\n                              checked={q.correctAnswer === 'True'}\n                              onChange={() => updateQuestion(idx, { correctAnswer: 'True' })}\n                            />\n                            <span>True</span>\n                          </label>\n                          <label className=\"flex items-center gap-2\">\n                            <input\n                              type=\"radio\"\n                              name={`correct-${q.id}`}\n                              checked={q.correctAnswer === 'False'}\n                              onChange={() => updateQuestion(idx, { correctAnswer: 'False' })}\n                            />\n                            <span>False</span>\n                          </label>\n                        </div>\n                      )}\n                      <Textarea\n                        value={q.explanation || ''}\n                        onChange={(e) => updateQuestion(idx, { explanation: e.target.value })}\n                        placeholder=\"Explanation (shown after answering)\"\n                        rows={2}\n                        className=\"text-sm\"\n                      />\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Answer Key Section - Protected */}\n              <div className=\"border-t pt-4 mt-4\">\n                <div className=\"flex items-center justify-between mb-3\">\n                  <div className=\"flex items-center gap-2\">\n                    <Shield className=\"h-4 w-4 text-amber-500\" />\n                    <Label className=\"text-amber-700 font-medium\">Instructor Answer Key (Protected)</Label>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      className=\"h-7 text-xs gap-1\"\n                      onClick={() => setShowAnswerKey(!showAnswerKey)}\n                    >\n                      {showAnswerKey ? <EyeOff className=\"h-3 w-3\" /> : <Eye className=\"h-3 w-3\" />}\n                      {showAnswerKey ? 'Hide' : 'Show'}\n                    </Button>\n                  </div>\n                </div>\n                {showAnswerKey ? (\n                  <div className=\"space-y-3\">\n                    <Textarea\n                      value={data.answerKey || ''}\n                      onChange={(e) => setData({ ...data, answerKey: e.target.value })}\n                      placeholder=\"Enter the complete answer key here. This is ONLY visible to instructors.\"\n                      rows={4}\n                      className=\"border-amber-200 bg-amber-50/30\"\n                    />\n                    <div className=\"flex items-center gap-2\">\n                      <Switch\n                        checked={data.answerKeyProtected !== false}\n                        onCheckedChange={(checked) => setData({ ...data, answerKeyProtected: checked })}\n                      />\n                      <Label className=\"text-xs text-muted-foreground\">\n                        <Lock className=\"h-3 w-3 inline mr-1\" />\n                        Protect answer key (never visible to students)\n                      </Label>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"p-3 bg-gray-50 rounded border border-dashed border-gray-200 text-center\">\n                    <Lock className=\"h-4 w-4 mx-auto mb-1 text-gray-400\" />\n                    <span className=\"text-xs text-muted-foreground\">Answer key is hidden. Click \"Show\" to view/edit.</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </TabsContent>\n          <TabsContent value=\"preview\" className=\"space-y-4 py-2\">\n            <div className=\"rounded-lg border bg-muted/30 p-4 space-y-3\">\n              <h3 className=\"font-semibold\">{data.title}</h3>\n              {data.description && <p className=\"text-sm text-muted-foreground\">{data.description}</p>}\n              {data.instructions && (\n                <div className=\"text-sm\"><span className=\"font-medium text-muted-foreground\">Instructions: </span>{data.instructions}</div>\n              )}\n              {data.sourceDocument && (\n                <div className=\"space-y-2\">\n                  <p className=\"text-xs font-medium text-muted-foreground\">Imported material (editable)</p>\n                  <Textarea\n                    value={data.sourceDocument.extractedText}\n                    onChange={(e) => setData({\n                      ...data,\n                      sourceDocument: { ...data.sourceDocument!, extractedText: e.target.value }\n                    })}\n                    rows={6}\n                  />\n                </div>\n              )}\n              <p className=\"text-xs text-muted-foreground\">{data.estimatedMinutes} min Â· {data.points} pts Â· Passing: {data.passingScore}%</p>\n              <h4 className=\"text-sm font-medium mt-4\">Questions</h4>\n              <QuestionsPreview questions={data.questions ?? []} />\n            </div>\n          </TabsContent>\n        </Tabs>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={onClose}>Cancel</Button>\n          <Button onClick={() => onSave({ ...data })}>Save</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n// Exam Builder Modal\nfunction QuizBuilderModal({ isOpen, onClose, onSave, initialData, isModuleQuiz = false }: BuilderModalProps & { isModuleQuiz?: boolean }) {\n  const [data, setData] = useState<Quiz | ModuleQuiz>(initialData || (isModuleQuiz ? DEFAULT_MODULE_QUIZ(0) : DEFAULT_QUIZ(0)))\n  const [showAnswerKey, setShowAnswerKey] = useState(false)\n  const [showQuestionBankModal, setShowQuestionBankModal] = useState(false)\n\n  const addQuestion = async (type: QuizQuestion['type']) => {\n    const newQuestion: QuizQuestion = {\n      id: `q-${Date.now()}`,\n      type,\n      question: '',\n      points: 1,\n      options: type === 'mcq' ? ['', '', '', ''] : type === 'truefalse' ? ['True', 'False'] : undefined\n    }\n    setData({ ...data, questions: [...data.questions, newQuestion] })\n    \n    // Auto-save to question bank\n    try {\n      const csrfRes = await fetch('/api/csrf', { credentials: 'include' })\n      const csrfData = await csrfRes.json().catch(() => ({}))\n      const csrfToken = csrfData?.token ?? null\n\n      await fetch('/api/tutor/question-bank', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(csrfToken ? { 'X-CSRF-Token': csrfToken } : {}),\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          question: newQuestion.question || '[Empty Question]',\n          type: newQuestion.type,\n          options: newQuestion.options,\n          correctAnswer: newQuestion.correctAnswer,\n          explanation: newQuestion.explanation || '',\n        }),\n      })\n    } catch {\n      // Silent fail - question is still added to the assessment\n    }\n  }\n\n  const updateQuestion = (index: number, updates: Partial<QuizQuestion>) => {\n    const newQuestions = [...data.questions]\n    newQuestions[index] = { ...newQuestions[index], ...updates }\n    setData({ ...data, questions: newQuestions })\n  }\n\n  const removeQuestion = (index: number) => {\n    setData({ ...data, questions: data.questions.filter((_, i) => i !== index) })\n  }\n\n  return (\n    <>\n      <Dialog open={isOpen} onOpenChange={onClose}>\n        <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <FileQuestion className=\"h-5 w-5 text-red-500\" />\n              {isModuleQuiz ? 'Exam Builder (Summative)' : 'Assessment Builder'}\n          </DialogTitle>\n        </DialogHeader>\n        <Tabs defaultValue=\"edit\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 mb-4\">\n            <TabsTrigger value=\"edit\">Edit</TabsTrigger>\n            <TabsTrigger value=\"preview\">Preview (student view)</TabsTrigger>\n          </TabsList>\n          <TabsContent value=\"edit\" className=\"space-y-4 py-2\">\n            <div className=\"space-y-4 py-4\">\n              <div className=\"space-y-2\">\n                <Label>{isModuleQuiz ? 'Exam Title *' : 'Assessment Title *'}</Label>\n                <Input\n                  value={data.title}\n                  onChange={(e) => setData({ ...data, title: e.target.value })}\n                  placeholder={isModuleQuiz ? \"e.g., Module 1 Comprehensive Exam\" : \"e.g., Lesson 1 Assessment\"}\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label>Instructions</Label>\n                <Textarea\n                  value={data.description}\n                  onChange={(e) => setData({ ...data, description: e.target.value })}\n                  placeholder=\"What should students know before starting this exam?\"\n                  rows={2}\n                />\n              </div>\n              <div className=\"flex gap-4 flex-wrap\">\n                <div className=\"flex items-center gap-2\">\n                  <Switch\n                    checked={data.showCorrectAnswers}\n                    onCheckedChange={(checked) => setData({ ...data, showCorrectAnswers: checked })}\n                    disabled={data.answersNeverVisible}\n                  />\n                  <Label className=\"text-sm\">Show correct answers</Label>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Switch\n                    checked={data.randomizeQuestions}\n                    onCheckedChange={(checked) => setData({ ...data, randomizeQuestions: checked })}\n                  />\n                  <Label className=\"text-sm\">Randomize questions</Label>\n                </div>\n                <div className=\"flex items-center gap-2 border-l pl-4 border-amber-200\">\n                  <Switch\n                    checked={data.answersNeverVisible}\n                    onCheckedChange={(checked) => setData({ ...data, answersNeverVisible: checked, showCorrectAnswers: checked ? false : data.showCorrectAnswers })}\n                  />\n                  <Label className=\"text-sm text-amber-700 font-medium flex items-center gap-1\">\n                    <Shield className=\"h-3 w-3\" />\n                    Never show answers to students\n                  </Label>\n                </div>\n              </div>\n\n              {isModuleQuiz && (\n                <div className=\"space-y-2 border rounded-lg p-4 bg-blue-50\">\n                  <Label>Coverage</Label>\n                  <Select\n                    value={(data as ModuleQuiz).coverage}\n                    onValueChange={(v) => setData({ ...data, coverage: v as 'all_lessons' | 'selected_lessons' })}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"all_lessons\">All lessons in module</SelectItem>\n                      <SelectItem value=\"selected_lessons\">Selected lessons only</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  <p className=\"text-xs text-muted-foreground\">\n                    This is a summative assessment covering knowledge from the entire module\n                  </p>\n                </div>\n              )}\n\n              <ResourceImportPanel data={data} setData={setData} targetField=\"description\" />\n\n              {/* Answer Key Section - Protected */}\n              <div className=\"space-y-3 border rounded-lg p-4 bg-amber-50/50\">\n                <div className=\"flex items-center justify-between\">\n                  <Label className=\"text-amber-700 font-medium\">Instructor Answer Key (Protected)</Label>\n                  <Button\n                    type=\"button\"\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => setShowAnswerKey(!showAnswerKey)}\n                  >\n                    {showAnswerKey ? <EyeOff className=\"h-3 w-3\" /> : <Eye className=\"h-3 w-3\" />}\n                    {showAnswerKey ? 'Hide' : 'Show'}\n                  </Button>\n                </div>\n                {showAnswerKey ? (\n                  <>\n                    <Textarea\n                      value={data.answerKey || ''}\n                      onChange={(e) => setData({ ...data, answerKey: e.target.value })}\n                      placeholder=\"Enter the complete answer key here. This is ONLY visible to instructors.\"\n                      rows={6}\n                    />\n                    <div className=\"flex items-center gap-2\">\n                      <Switch\n                        checked={data.answerKeyProtected !== false}\n                        onCheckedChange={(checked) => setData({ ...data, answerKeyProtected: checked })}\n                      />\n                      <Label className=\"text-sm\">Protect answer key (never visible to students)</Label>\n                    </div>\n                  </>\n                ) : (\n                  <span className=\"text-xs text-muted-foreground\">Answer key is hidden. Click &quot;Show&quot; to view/edit.</span>\n                )}\n              </div>\n\n              <Separator />\n\n              {/* Questions Section */}\n              <div className=\"space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <h3 className=\"font-medium\">Questions ({data.questions.length})</h3>\n                </div>\n\n                <div className=\"space-y-3\">\n                  {data.questions.map((q, idx) => (\n                    <div key={q.id} className=\"border rounded-lg p-4 space-y-3\">\n                      <div className=\"flex items-center justify-between\">\n                        <Badge variant=\"secondary\">Q{idx + 1} - {q.type.toUpperCase()}</Badge>\n                        <div className=\"flex items-center gap-2\">\n                          <Input\n                            type=\"number\"\n                            className=\"w-20 h-8\"\n                            value={q.points}\n                            onChange={(e) => updateQuestion(idx, { points: parseInt(e.target.value) || 1 })}\n                          />\n                          <span className=\"text-sm text-muted-foreground\">pts</span>\n                          <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\" onClick={() => removeQuestion(idx)}>\n                            <X className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                      <Textarea\n                        value={q.question}\n                        onChange={(e) => updateQuestion(idx, { question: e.target.value })}\n                        placeholder=\"Enter question\"\n                        rows={2}\n                      />\n                      {q.type === 'mcq' && q.options && (\n                        <div className=\"space-y-2 pl-4\">\n                          {q.options.map((opt, optIdx) => (\n                            <div key={optIdx} className=\"flex items-center gap-2\">\n                              <input\n                                type=\"radio\"\n                                name={`correct-${q.id}`}\n                                checked={q.correctAnswer === opt}\n                                onChange={() => updateQuestion(idx, { correctAnswer: opt })}\n                              />\n                              <Input\n                                value={opt}\n                                onChange={(e) => {\n                                  const newOptions = [...q.options!]\n                                  newOptions[optIdx] = e.target.value\n                                  updateQuestion(idx, { options: newOptions })\n                                }}\n                                placeholder={`Option ${optIdx + 1}`}\n                                className=\"flex-1\"\n                              />\n                            </div>\n                          ))}\n                        </div>\n                      )}\n                      {q.type === 'truefalse' && (\n                        <div className=\"flex gap-4 pl-4\">\n                          <label className=\"flex items-center gap-2\">\n                            <input\n                              type=\"radio\"\n                              name={`correct-${q.id}`}\n                              checked={q.correctAnswer === 'True'}\n                              onChange={() => updateQuestion(idx, { correctAnswer: 'True' })}\n                            />\n                            <span>True</span>\n                          </label>\n                          <label className=\"flex items-center gap-2\">\n                            <input\n                              type=\"radio\"\n                              name={`correct-${q.id}`}\n                              checked={q.correctAnswer === 'False'}\n                              onChange={() => updateQuestion(idx, { correctAnswer: 'False' })}\n                            />\n                            <span>False</span>\n                          </label>\n                        </div>\n                      )}\n                      <Textarea\n                        value={q.explanation || ''}\n                        onChange={(e) => updateQuestion(idx, { explanation: e.target.value })}\n                        placeholder=\"Explanation (shown after answering)\"\n                        rows={2}\n                        className=\"text-sm\"\n                      />\n                    </div>\n                  ))}\n                </div>\n\n                {/* Add Questions Bar */}\n                <div className=\"flex items-center gap-2 pt-4 border-t flex-wrap\">\n                  <Button variant=\"secondary\" size=\"sm\" onClick={() => setShowQuestionBankModal(true)}>\n                    <BookOpen className=\"h-4 w-4 mr-1\" /> Add from question bank\n                  </Button>\n                  <div className=\"h-6 w-px bg-border mx-1\" />\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('mcq')}>\n                    <Plus className=\"h-4 w-4 mr-1\" /> MCQ\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('truefalse')}>\n                    <Plus className=\"h-4 w-4 mr-1\" /> T/F\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('shortanswer')}>\n                    <Plus className=\"h-4 w-4 mr-1\" /> Short\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('essay')}>\n                    <Plus className=\"h-4 w-4 mr-1\" /> Essay\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('multiselect')}>\n                    <Plus className=\"h-4 w-4 mr-1\" /> Multi\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('matching')}>\n                    <Plus className=\"h-4 w-4 mr-1\" /> Match\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => addQuestion('fillblank')}>\n                    <Plus className=\"h-4 w-4 mr-1\" /> Fill\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </TabsContent>\n          <TabsContent value=\"preview\" className=\"space-y-4 py-2\">\n            <div className=\"rounded-lg border bg-muted/30 p-4 space-y-3\">\n              <h3 className=\"font-semibold\">{data.title}</h3>\n              {data.description && <p className=\"text-sm text-muted-foreground\">{data.description}</p>}\n              {data.sourceDocument && (\n                <div className=\"space-y-2\">\n                  <p className=\"text-xs font-medium text-muted-foreground\">Imported material (editable)</p>\n                  <Textarea\n                    value={data.sourceDocument.extractedText}\n                    onChange={(e) => setData({\n                      ...data,\n                      sourceDocument: { ...data.sourceDocument!, extractedText: e.target.value }\n                    })}\n                    rows={6}\n                  />\n                </div>\n              )}\n              <p className=\"text-xs text-muted-foreground\">\n                {data.timeLimit != null ? `${data.timeLimit} min limit Â· ` : ''}\n                {data.attemptsAllowed} attempt(s) Â· {data.questions.length} questions\n              </p>\n              <h4 className=\"text-sm font-medium mt-4\">Questions</h4>\n              <QuestionsPreview questions={data.questions ?? []} />\n            </div>\n          </TabsContent>\n        </Tabs>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={onClose}>Cancel</Button>\n          <Button onClick={() => onSave({ ...data })} disabled={data.questions.length === 0}>\n            Save ({data.questions.length} questions)\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n\n    {/* Question Bank Modal */}\n    <Dialog open={showQuestionBankModal} onOpenChange={setShowQuestionBankModal}>\n      <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <BookOpen className=\"h-5 w-5 text-blue-500\" />\n            Question Bank\n          </DialogTitle>\n        </DialogHeader>\n        <QuestionBankSelector\n          onSelect={(questions) => {\n            setData({ ...data, questions: [...data.questions, ...questions] })\n            setShowQuestionBankModal(false)\n            toast.success(`${questions.length} question(s) added`)\n          }}\n        />\n      </DialogContent>\n    </Dialog>\n  </>\n  )\n}\n\n// Question Bank Selector Component for Modal\nfunction QuestionBankSelector({ onSelect }: { onSelect: (questions: QuizQuestion[]) => void }) {\n  const [loading, setLoading] = useState(false)\n  const [items, setItems] = useState<QuestionBankItemLite[]>([])\n  const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set())\n  const [filter, setFilter] = useState('')\n\n  useEffect(() => {\n    let active = true\n    const load = async () => {\n      setLoading(true)\n      try {\n        const res = await fetch('/api/tutor/question-bank?limit=200', { credentials: 'include' })\n        if (!res.ok) return\n        const data = await res.json()\n        const next = Array.isArray(data.questions) ? data.questions : []\n        if (active) setItems(next)\n      } catch {\n        // Non-fatal.\n      } finally {\n        if (active) setLoading(false)\n      }\n    }\n    load()\n    return () => {\n      active = false\n    }\n  }, [])\n\n  const toggleSelection = (id: string) => {\n    const next = new Set(selectedIds)\n    if (next.has(id)) next.delete(id)\n    else next.add(id)\n    setSelectedIds(next)\n  }\n\n  const filteredItems = items.filter((item) =>\n    item.question.toLowerCase().includes(filter.toLowerCase()) ||\n    item.type.toLowerCase().includes(filter.toLowerCase())\n  )\n\n  return (\n    <div className=\"space-y-4\">\n      <Input\n        placeholder=\"Search questions...\"\n        value={filter}\n        onChange={(e) => setFilter(e.target.value)}\n        className=\"w-full\"\n      />\n      <div className=\"border rounded-lg max-h-[400px] overflow-y-auto\">\n        {loading ? (\n          <div className=\"p-8 text-center text-muted-foreground\">Loading...</div>\n        ) : filteredItems.length === 0 ? (\n          <div className=\"p-8 text-center text-muted-foreground\">No questions found</div>\n        ) : (\n          <div className=\"divide-y\">\n            {filteredItems.map((item) => (\n              <div\n                key={item.id}\n                className={`p-3 cursor-pointer hover:bg-muted/50 transition-colors ${\n                  selectedIds.has(item.id) ? 'bg-blue-50 hover:bg-blue-100' : ''\n                }`}\n                onClick={() => toggleSelection(item.id)}\n              >\n                <div className=\"flex items-start gap-3\">\n                  <div className={`mt-0.5 w-5 h-5 rounded border flex items-center justify-center ${\n                    selectedIds.has(item.id) ? 'bg-blue-500 border-blue-500' : 'border-gray-300'\n                  }`}>\n                    {selectedIds.has(item.id) && <CheckCircle className=\"h-3 w-3 text-white\" />}\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center gap-2 mb-1\">\n                      <Badge variant=\"secondary\" className=\"text-xs\">{item.type.toUpperCase()}</Badge>\n                      <span className=\"text-xs text-muted-foreground\">\n                        {item.options?.length || 0} options\n                      </span>\n                    </div>\n                    <p className=\"text-sm line-clamp-2\">{item.question}</p>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n      <div className=\"flex items-center justify-between pt-2\">\n        <span className=\"text-sm text-muted-foreground\">\n          {selectedIds.size} selected\n        </span>\n        <div className=\"flex gap-2\">\n          <Button variant=\"outline\" onClick={() => setSelectedIds(new Set())}>\n            Clear\n          </Button>\n          <Button\n            disabled={selectedIds.size === 0}\n            onClick={() => {\n              const selected = items.filter((item) => selectedIds.has(item.id))\n              onSelect(selected.map(mapQuestionBankToBuilderQuestion))\n            }}\n          >\n            Add Selected ({selectedIds.size})\n          </Button>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// Content Builder Modal\nfunction ContentBuilderModal({ isOpen, onClose, onSave, initialData }: BuilderModalProps) {\n  const [data, setData] = useState<Content>(initialData || DEFAULT_CONTENT(0))\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <BookOpen className=\"h-5 w-5 text-teal-500\" />\n            Content Builder\n          </DialogTitle>\n        </DialogHeader>\n        <div className=\"space-y-4 py-4\">\n          <div className=\"space-y-2\">\n            <Label>Content Title *</Label>\n            <Input\n              value={data.title}\n              onChange={(e) => setData({ ...data, title: e.target.value })}\n              placeholder=\"e.g., Introduction to the Topic\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label>Content Type</Label>\n            <Select value={data.type} onValueChange={(value: Content['type']) => setData({ ...data, type: value })}>\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"text\">Text / Article</SelectItem>\n                <SelectItem value=\"video\">Video</SelectItem>\n                <SelectItem value=\"audio\">Audio</SelectItem>\n                <SelectItem value=\"interactive\">Interactive</SelectItem>\n                <SelectItem value=\"embed\">Embed (iframe)</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n          {data.type === 'text' && (\n            <>\n              <ResourceImportPanel data={data} setData={setData} targetField=\"body\" />\n              <div className=\"space-y-2\">\n                <Label>Content Body</Label>\n                <Textarea\n                  value={data.body || ''}\n                  onChange={(e) => setData({ ...data, body: e.target.value })}\n                  placeholder=\"Enter your lesson content here...\"\n                  rows={10}\n                />\n              </div>\n            </>\n          )}\n          {data.type !== 'text' && (\n            <div className=\"space-y-2\">\n              <Label>URL / Embed Code</Label>\n              <Input\n                value={data.url || ''}\n                onChange={(e) => setData({ ...data, url: e.target.value })}\n                placeholder={data.type === 'embed' ? \"Paste iframe or embed code\" : \"https://...\"}\n              />\n            </div>\n          )}\n          <div className=\"space-y-2\">\n            <Label>Duration (minutes, optional)</Label>\n            <Input\n              type=\"number\"\n              value={data.duration || ''}\n              onChange={(e) => setData({ ...data, duration: parseInt(e.target.value) || undefined })}\n              placeholder=\"e.g., 15\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label>Order</Label>\n            <Input\n              type=\"number\"\n              value={data.order}\n              onChange={(e) => setData({ ...data, order: parseInt(e.target.value) || 0 })}\n              min={0}\n            />\n          </div>\n        </div>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={onClose}>Cancel</Button>\n          <Button onClick={() => onSave(data)} disabled={!data.title.trim()}>\n            Save Content\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n// ============================================\n// TREE VIEW COMPONENTS\n// ============================================\n\ninterface TreeItemProps {\n  children: React.ReactNode\n  depth: number\n  isLast?: boolean\n}\n\nfunction TreeItem({ children, depth, isLast }: TreeItemProps) {\n  return (\n    <div className=\"relative\" style={{ marginLeft: depth * 20 }}>\n      {depth > 0 && (\n        <>\n          <div\n            className=\"absolute border-l-2 border-dashed border-gray-300\"\n            style={{\n              left: -10,\n              top: 0,\n              bottom: isLast ? '50%' : 0,\n              height: isLast ? '50%' : '100%'\n            }}\n          />\n          <div\n            className=\"absolute border-t-2 border-dashed border-gray-300\"\n            style={{\n              left: -10,\n              top: '50%',\n              width: 10\n            }}\n          />\n        </>\n      )}\n      {children}\n    </div>\n  )\n}\n\n// Difficulty Badge Component\ninterface DifficultyBadgeProps {\n  mode: DifficultyMode\n  fixedDifficulty?: DifficultyLevel\n  showLabel?: boolean\n  size?: 'sm' | 'xs'\n}\n\nfunction DifficultyBadge({ mode, fixedDifficulty, showLabel = true, size = 'xs' }: DifficultyBadgeProps) {\n  if (mode === 'all') {\n    return (\n      <span className={cn(\n        \"inline-flex items-center gap-1 rounded-full bg-gray-100 text-gray-700 border border-gray-200\",\n        size === 'xs' ? \"px-1.5 py-0.5 text-[10px]\" : \"px-2 py-1 text-xs\"\n      )}>\n        <Layers2 className={cn(size === 'xs' ? \"h-3 w-3\" : \"h-3.5 w-3.5\")} />\n        {showLabel && \"All Levels\"}\n      </span>\n    )\n  }\n\n  if (mode === 'fixed' && fixedDifficulty) {\n    const colors = {\n      beginner: 'bg-green-100 text-green-700 border-green-200',\n      intermediate: 'bg-blue-100 text-blue-700 border-blue-200',\n      advanced: 'bg-purple-100 text-purple-700 border-purple-200'\n    }\n    const icons = {\n      beginner: SignalLow,\n      intermediate: Signal,\n      advanced: SignalHigh\n    }\n    const Icon = icons[fixedDifficulty]\n\n    return (\n      <span className={cn(\n        \"inline-flex items-center gap-1 rounded-full border\",\n        colors[fixedDifficulty],\n        size === 'xs' ? \"px-1.5 py-0.5 text-[10px]\" : \"px-2 py-1 text-xs\"\n      )} title={`Fixed: ${fixedDifficulty}`}>\n        <Icon className={cn(size === 'xs' ? \"h-3 w-3\" : \"h-3.5 w-3.5\")} />\n        {showLabel && (\n          <>\n            <span className=\"opacity-70\">ðŸŽ¯</span>\n            <span className=\"capitalize\">{fixedDifficulty}</span>\n          </>\n        )}\n      </span>\n    )\n  }\n\n  // Adaptive mode\n  return (\n    <span className={cn(\n      \"inline-flex items-center gap-1 rounded-full bg-amber-100 text-amber-700 border border-amber-200\",\n      size === 'xs' ? \"px-1.5 py-0.5 text-[10px]\" : \"px-2 py-1 text-xs\"\n    )} title=\"Adaptive - adjusts to group difficulty\">\n      <BarChart3 className={cn(size === 'xs' ? \"h-3 w-3\" : \"h-3.5 w-3.5\")} />\n      {showLabel && <span className=\"opacity-70\">ðŸ”„</span>}\n      {showLabel && \"Adaptive\"}\n    </span>\n  )\n}\n\n// Sortable Tree Item for Drag & Drop\ninterface SortableTreeItemProps extends TreeItemProps {\n  id: string\n  dragHandle?: boolean\n  onDragStart?: () => void\n}\n\nfunction SortableTreeItem({ id, children, depth, isLast, dragHandle = true }: SortableTreeItemProps) {\n  const {\n    attributes,\n    listeners,\n    setNodeRef,\n    transform,\n    transition,\n    isDragging,\n  } = useSortable({ id })\n\n  const style = {\n    transform: CSS.Transform.toString(transform),\n    transition,\n    opacity: isDragging ? 0.5 : 1,\n  }\n\n  return (\n    <div ref={setNodeRef} style={style} className=\"group relative\">\n      {dragHandle && (\n        <button\n          className=\"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-5 opacity-0 group-hover:opacity-100 cursor-grab active:cursor-grabbing p-1 hover:bg-gray-100 rounded\"\n          {...attributes}\n          {...listeners}\n        >\n          <GripVertical className=\"h-4 w-4 text-gray-400\" />\n        </button>\n      )}\n      <TreeItem depth={depth} isLast={isLast}>\n        {children}\n      </TreeItem>\n    </div>\n  )\n}\n\n// ============================================\n// PREVIEW CARD - Center panel preview for assessments/tasks\n// ============================================\n\nfunction resolveSelectedItem(\n  selectedItem: { type: string; id: string } | null,\n  modules: Module[]\n): { item: Task | Assessment | Worksheet | ModuleQuiz | Lesson | Module; moduleId: string; lessonId?: string } | null {\n  if (!selectedItem) return null\n  for (const mod of modules) {\n    if (selectedItem.type === 'module' && mod.id === selectedItem.id) {\n      return { item: mod, moduleId: mod.id }\n    }\n    if (selectedItem.type === 'moduleQuiz') {\n      const quiz = mod.moduleQuizzes?.find(q => q.id === selectedItem.id)\n      if (quiz) return { item: quiz, moduleId: mod.id }\n    }\n    for (const lesson of mod.lessons) {\n      if (selectedItem.type === 'lesson' && lesson.id === selectedItem.id) {\n        return { item: lesson, moduleId: mod.id, lessonId: lesson.id }\n      }\n      if (selectedItem.type === 'task') {\n        const task = lesson.tasks?.find(t => t.id === selectedItem.id)\n        if (task) return { item: task, moduleId: mod.id, lessonId: lesson.id }\n      }\n      if (selectedItem.type === 'homework') {\n        const hw = lesson.homework?.find(h => h.id === selectedItem.id)\n        if (hw) return { item: hw, moduleId: mod.id, lessonId: lesson.id }\n      }\n      if (selectedItem.type === 'worksheet') {\n        const worksheet = lesson.worksheets?.find(w => w.id === selectedItem.id)\n        if (worksheet) return { item: worksheet, moduleId: mod.id, lessonId: lesson.id }\n      }\n    }\n  }\n  return null\n}\n\nfunction QuestionsPreview({ questions }: { questions: QuizQuestion[] }) {\n  if (!questions?.length) return <p className=\"text-sm text-muted-foreground\">No questions yet.</p>\n  return (\n    <div className=\"space-y-3 mt-2\">\n      {questions.map((q, idx) => (\n        <div key={q.id} className=\"border rounded-lg p-3 bg-muted/30 space-y-2\">\n          <div className=\"flex items-center justify-between\">\n            <Badge variant=\"secondary\" className=\"text-xs\">Q{idx + 1} Â· {q.type.toUpperCase()}</Badge>\n            <span className=\"text-xs text-muted-foreground\">{q.points} pts</span>\n          </div>\n          <p className=\"text-sm font-medium\">{q.question || '(No question text)'}</p>\n          {q.type === 'mcq' && q.options?.length && (\n            <ul className=\"list-disc list-inside text-sm text-muted-foreground\">\n              {q.options.map((opt, i) => (\n                <li key={i}>{opt || `Option ${i + 1}`}</li>\n              ))}\n            </ul>\n          )}\n          {q.type === 'truefalse' && (\n            <p className=\"text-sm text-muted-foreground\">Options: True / False</p>\n          )}\n          {q.explanation && (\n            <p className=\"text-xs text-muted-foreground border-t pt-2 mt-2\">Explanation: {q.explanation}</p>\n          )}\n          <p className=\"text-xs text-amber-600\">Answer key hidden (instructor only)</p>\n        </div>\n      ))}\n    </div>\n  )\n}\n\n/** Student-like question preview (one at a time) */\nfunction StudentPreviewModal({ questions, onClose }: { questions: QuizQuestion[]; onClose: () => void }) {\n  const [currentIdx, setCurrentIdx] = useState(0)\n  const [answers, setAnswers] = useState<Record<string, string>>({})\n  const [showResults, setShowResults] = useState(false)\n  const q = questions[currentIdx]\n\n  if (!questions.length) return null\n\n  if (showResults) {\n    const correct = questions.filter(qq => {\n      const a = answers[qq.id]?.toLowerCase()\n      const ca = Array.isArray(qq.correctAnswer) ? qq.correctAnswer[0]?.toLowerCase() : (typeof qq.correctAnswer === 'string' ? qq.correctAnswer.toLowerCase() : '')\n      return a && ca && a === ca\n    }).length\n    return (\n      <div className=\"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4\">\n        <div className=\"bg-white rounded-xl shadow-2xl max-w-lg w-full p-6\">\n          <h3 className=\"text-xl font-bold mb-4\">Preview Results</h3>\n          <p className=\"text-3xl font-bold text-center mb-2\">{correct}/{questions.length}</p>\n          <p className=\"text-center text-muted-foreground mb-6\">This is how a student would see their results</p>\n          <div className=\"space-y-2 max-h-60 overflow-y-auto\">\n            {questions.map((qq, i) => {\n              const a = answers[qq.id]?.toLowerCase()\n              const ca = Array.isArray(qq.correctAnswer) ? qq.correctAnswer[0]?.toLowerCase() : (typeof qq.correctAnswer === 'string' ? qq.correctAnswer.toLowerCase() : '')\n              const isCorrect = !!(a && ca && a === ca)\n              return (\n                <div key={qq.id} className={`p-3 rounded-lg border text-sm ${isCorrect ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200'}`}>\n                  <span className=\"font-medium\">Q{i + 1}:</span> {qq.question.slice(0, 80)}\n                  <span className={`ml-2 font-bold ${isCorrect ? 'text-green-600' : 'text-red-600'}`}>\n                    {isCorrect ? '\\u2713' : '\\u2717'}\n                  </span>\n                </div>\n              )\n            })}\n          </div>\n          <Button onClick={onClose} className=\"w-full mt-4\">Close Preview</Button>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4\">\n      <div className=\"bg-white rounded-xl shadow-2xl max-w-lg w-full p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <Badge variant=\"secondary\">Question {currentIdx + 1} of {questions.length}</Badge>\n          <button onClick={onClose} className=\"text-gray-400 hover:text-gray-600\">\n            <X className=\"h-5 w-5\" />\n          </button>\n        </div>\n        <h3 className=\"text-lg font-semibold mb-4\">{q.question}</h3>\n        {q.type === 'mcq' && q.options && (\n          <div className=\"space-y-2\">\n            {q.options.map((opt, i) => (\n              <button\n                key={i}\n                onClick={() => setAnswers({ ...answers, [q.id]: opt })}\n                className={cn(\n                  \"w-full text-left p-3 rounded-lg border transition-all text-sm\",\n                  answers[q.id] === opt ? \"border-blue-500 bg-blue-50\" : \"hover:bg-gray-50\"\n                )}\n              >\n                {String.fromCharCode(65 + i)}. {opt}\n              </button>\n            ))}\n          </div>\n        )}\n        {q.type === 'truefalse' && (\n          <div className=\"flex gap-3\">\n            {['True', 'False'].map(opt => (\n              <button\n                key={opt}\n                onClick={() => setAnswers({ ...answers, [q.id]: opt })}\n                className={cn(\n                  \"flex-1 p-3 rounded-lg border transition-all font-medium\",\n                  answers[q.id] === opt ? \"border-blue-500 bg-blue-50\" : \"hover:bg-gray-50\"\n                )}\n              >\n                {opt}\n              </button>\n            ))}\n          </div>\n        )}\n        {(q.type === 'shortanswer' || q.type === 'essay') && (\n          <Textarea\n            value={answers[q.id] || ''}\n            onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => setAnswers({ ...answers, [q.id]: e.target.value })}\n            placeholder=\"Type your answer...\"\n            rows={q.type === 'essay' ? 5 : 2}\n          />\n        )}\n        <div className=\"flex justify-between mt-6\">\n          <Button\n            variant=\"outline\"\n            disabled={currentIdx === 0}\n            onClick={() => setCurrentIdx(currentIdx - 1)}\n          >\n            Previous\n          </Button>\n          {currentIdx < questions.length - 1 ? (\n            <Button onClick={() => setCurrentIdx(currentIdx + 1)}>Next</Button>\n          ) : (\n            <Button onClick={() => setShowResults(true)}>Finish</Button>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n\ninterface PreviewCardProps {\n  type: 'task' | 'homework' | 'worksheet' | 'moduleQuiz' | 'lesson' | 'module'\n  item: Task | Assessment | Worksheet | Quiz | Lesson | Module\n  onEdit: () => void\n  onDuplicate: () => void\n  onRemove: () => void\n  onUpdateItem?: (updates: { sourceDocument?: ImportedLearningResource }) => void\n  courseId?: string\n  lessonId?: string\n  showLiveShareAction?: boolean\n  onMakeVisibleToStudents?: (payload: VisibleDocumentPayload) => void\n}\n\nfunction PreviewCard({ type, item, onEdit, onDuplicate, onRemove, onUpdateItem, courseId, lessonId, showLiveShareAction, onMakeVisibleToStudents }: PreviewCardProps) {\n  const [studentPreviewOpen, setStudentPreviewOpen] = useState(false)\n  const [publishing, setPublishing] = useState(false)\n  const [resourceText, setResourceText] = useState('')\n  const [pdfPreviewOpen, setPdfPreviewOpen] = useState(false)\n  const [generatedPdf, setGeneratedPdf] = useState<{ url: string; fileName: string; blob: Blob } | null>(null)\n  const normalizedItem = item as (Task | Assessment | Worksheet | Quiz | ModuleQuiz | Lesson | Module) & {\n    description?: string\n    instructions?: string\n    points?: number\n    estimatedMinutes?: number\n    questions?: QuizQuestion[]\n    isPublished?: boolean\n    submissionType?: string\n    timeLimit?: number\n    attemptsAllowed?: number\n    sourceDocument?: ImportedLearningResource\n  }\n  const sourceDocument = normalizedItem.sourceDocument\n  const questions = normalizedItem.questions ?? []\n  const isDraft = normalizedItem.isPublished === false\n\n  useEffect(() => {\n    setResourceText(sourceDocument?.extractedText || '')\n  }, [sourceDocument?.extractedText, sourceDocument?.fileName])\n\n  // Lesson preview\n  if (type === 'lesson') {\n    const lesson = item as Lesson\n    return (\n      <div className=\"space-y-4 text-left\">\n        <div className=\"flex items-center justify-between flex-wrap gap-2\">\n          <div className=\"flex items-center gap-2\">\n            <BookOpen className=\"h-5 w-5 text-green-500\" />\n            <div>\n              <Badge variant=\"outline\" className=\"text-xs\">Lesson</Badge>\n              {!lesson.isPublished && <Badge variant=\"secondary\" className=\"text-xs ml-1\">Draft</Badge>}\n              <h3 className=\"font-semibold text-lg mt-1\">{lesson.title}</h3>\n            </div>\n          </div>\n          <Button variant=\"outline\" size=\"sm\" onClick={onEdit} className=\"gap-1\">\n            <PenTool className=\"h-3 w-3\" /> Edit\n          </Button>\n        </div>\n        {lesson.description && <p className=\"text-sm text-muted-foreground\">{lesson.description}</p>}\n        <div className=\"grid grid-cols-2 sm:grid-cols-5 gap-2 text-sm\">\n          <div><span className=\"text-muted-foreground\">Duration:</span> {lesson.duration} min</div>\n          <div><span className=\"text-muted-foreground\">Tasks:</span> {lesson.tasks.length}</div>\n          <div><span className=\"text-muted-foreground\">Assessment:</span> {lesson.homework.length}</div>\n          <div><span className=\"text-muted-foreground\">Worksheets:</span> {lesson.worksheets?.length || 0}</div>\n          <div><span className=\"text-muted-foreground\">Exams:</span> 0</div>\n        </div>\n        {lesson.content.length > 0 && (\n          <div>\n            <h4 className=\"text-sm font-medium mb-2\">Content ({lesson.content.length})</h4>\n            <div className=\"space-y-1\">\n              {lesson.content.map(c => (\n                <div key={c.id} className=\"flex items-center gap-2 text-sm border rounded p-2\">\n                  <Badge variant=\"secondary\" className=\"text-xs capitalize\">{c.type}</Badge>\n                  <span>{c.title}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n        {lesson.prerequisites && lesson.prerequisites.length > 0 && (\n          <div className=\"text-sm text-muted-foreground\">\n            Prerequisites: {lesson.prerequisites.length} lesson(s) required\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  // Module preview\n  if (type === 'module') {\n    const mod = item as Module\n    return (\n      <div className=\"space-y-4 text-left\">\n        <div className=\"flex items-center justify-between flex-wrap gap-2\">\n          <div className=\"flex items-center gap-2\">\n            <Layers className=\"h-5 w-5 text-blue-500\" />\n            <div>\n              <Badge variant=\"outline\" className=\"text-xs\">Module</Badge>\n              <h3 className=\"font-semibold text-lg mt-1\">{mod.title}</h3>\n            </div>\n          </div>\n          <Button variant=\"outline\" size=\"sm\" onClick={onEdit} className=\"gap-1\">\n            <PenTool className=\"h-3 w-3\" /> Edit\n          </Button>\n        </div>\n        {mod.description && <p className=\"text-sm text-muted-foreground\">{mod.description}</p>}\n        <div className=\"grid grid-cols-3 gap-2 text-sm\">\n          <div><span className=\"text-muted-foreground\">Lessons:</span> {mod.lessons.length}</div>\n          <div><span className=\"text-muted-foreground\">Exams:</span> {mod.moduleQuizzes.length}</div>\n          <div><span className=\"text-muted-foreground\">Total items:</span> {mod.lessons.reduce((s, l) => s + l.tasks.length + l.homework.length + (l.worksheets?.length || 0), 0)}</div>\n        </div>\n      </div>\n    )\n  }\n\n  const isQuiz = type === 'moduleQuiz'\n  const label = type === 'moduleQuiz' ? 'Exam' : type === 'task' ? 'Task' : type === 'homework' ? 'Assessment' : type === 'worksheet' ? 'Worksheet' : 'Assessment'\n\n  const handleGenerateAndPreviewPDF = () => {\n    if (questions.length === 0) {\n      toast.error('No questions to generate PDF')\n      return\n    }\n    \n    try {\n      // Generate PDF from questions\n      const pdf = generateQuestionPaperPDF(item.title, normalizedItem.description || '', questions)\n      setGeneratedPdf({ url: pdf.url, fileName: pdf.fileName, blob: pdf.blob })\n      setPdfPreviewOpen(true)\n    } catch (error) {\n      toast.error('Failed to generate PDF')\n      console.error(error)\n    }\n  }\n\n  const handleConfirmPublish = async () => {\n    if (!courseId) { toast.error('Course ID not available'); return }\n    if (!generatedPdf) return\n    \n    setPublishing(true)\n    try {\n      // Convert blob to base64 for storage\n      const blobToBase64 = (blob: Blob): Promise<string> => {\n        return new Promise((resolve, reject) => {\n          const reader = new FileReader()\n          reader.onloadend = () => resolve(reader.result as string)\n          reader.onerror = reject\n          reader.readAsDataURL(blob)\n        })\n      }\n      \n      const pdfBase64 = await blobToBase64(generatedPdf.blob)\n      \n      const generatedDocument: ImportedLearningResource = {\n        fileName: generatedPdf.fileName,\n        mimeType: 'application/pdf',\n        fileUrl: pdfBase64,\n        extractedText: `PDF Question Paper: ${item.title}\\nTotal Questions: ${questions.length}`,\n        uploadedAt: new Date().toISOString(),\n      }\n\n      const builderItem = {\n        type,\n        title: item.title,\n        description: normalizedItem.description || '',\n        questions: questions ?? [],\n        lessonId: lessonId || null,\n        difficulty: 'medium',\n        points: normalizedItem.points,\n        estimatedMinutes: normalizedItem.estimatedMinutes,\n        documentSource: generatedDocument\n          ? JSON.stringify({\n            fileName: generatedDocument.fileName,\n            mimeType: generatedDocument.mimeType,\n            fileUrl: generatedDocument.fileUrl,\n            extractedText: generatedDocument.extractedText,\n          })\n          : null,\n      }\n      const res = await fetch(`/api/tutor/courses/${courseId}/tasks/publish-from-builder`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({ items: [builderItem], assignTo: 'all' }),\n      })\n      if (res.ok) {\n        const data = await res.json()\n        toast.success(data.message)\n        setPdfPreviewOpen(false)\n        if (showLiveShareAction && onMakeVisibleToStudents) {\n          onMakeVisibleToStudents({\n            title: item.title,\n            description: normalizedItem.description,\n            itemType: type,\n            sourceDocument: generatedDocument || undefined,\n          })\n        }\n      } else {\n        toast.error('Failed to publish')\n      }\n    } catch {\n      toast.error('Failed to publish')\n    } finally {\n      setPublishing(false)\n    }\n  }\n\n  return (\n    <div className=\"space-y-4 text-left\">\n      <div className=\"flex items-center justify-between flex-wrap gap-2\">\n        <div className=\"flex items-center gap-2\">\n          {type === 'task' && <ListTodo className=\"h-5 w-5 text-orange-500\" />}\n          {type === 'homework' && <Home className=\"h-5 w-5 text-purple-500\" />}\n          {type === 'worksheet' && <FileText className=\"h-5 w-5 text-cyan-500\" />}\n          {type === 'moduleQuiz' && <FileQuestion className=\"h-5 w-5 text-red-500\" />}\n          <div>\n            <div className=\"flex items-center gap-2 flex-wrap\">\n              <Badge variant=\"outline\" className=\"text-xs\">{label}</Badge>\n              {isDraft && <Badge variant=\"secondary\" className=\"text-xs\">Draft</Badge>}\n            </div>\n            <h3 className=\"font-semibold text-lg mt-1\">{item.title}</h3>\n          </div>\n        </div>\n        <div className=\"flex items-center gap-2 flex-wrap\">\n          <Button variant=\"outline\" size=\"sm\" onClick={onEdit} className=\"gap-1\">\n            <PenTool className=\"h-3 w-3\" />\n            Edit\n          </Button>\n          <Button variant=\"outline\" size=\"sm\" onClick={onDuplicate} className=\"gap-1\">\n            <Copy className=\"h-3 w-3\" />\n            Duplicate\n          </Button>\n          {questions.length > 0 && (\n            <Button variant=\"outline\" size=\"sm\" onClick={() => setStudentPreviewOpen(true)} className=\"gap-1\">\n              <Eye className=\"h-3 w-3\" />\n              Preview as Student\n            </Button>\n          )}\n          {courseId && (\n            <Button size=\"sm\" onClick={handleGenerateAndPreviewPDF} disabled={publishing || questions.length === 0} className=\"gap-1\">\n              {publishing ? <Loader2 className=\"h-3 w-3 animate-spin\" /> : <Send className=\"h-3 w-3\" />}\n              {showLiveShareAction ? 'Assign Individual Copies to Students' : 'Publish & Assign'}\n            </Button>\n          )}\n          <Button variant=\"outline\" size=\"sm\" onClick={onRemove} className=\"gap-1 text-red-600 hover:text-red-700 hover:bg-red-50\">\n            <Trash2 className=\"h-3 w-3\" />\n            Remove\n          </Button>\n        </div>\n      </div>\n      {normalizedItem.description && (\n        <div className=\"rounded-lg bg-muted/40 p-3\">\n          <p className=\"text-xs font-medium text-muted-foreground mb-1\">Instructions</p>\n          <p className=\"text-sm whitespace-pre-wrap\">{normalizedItem.description}</p>\n        </div>\n      )}\n      {'instructions' in normalizedItem && normalizedItem.instructions && (\n        <div className=\"rounded-lg bg-muted/40 p-3\">\n          <p className=\"text-xs font-medium text-muted-foreground mb-1\">Instructions</p>\n          <p className=\"text-sm whitespace-pre-wrap\">{normalizedItem.instructions}</p>\n        </div>\n      )}\n      <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-2 text-sm\">\n        {typeof normalizedItem.estimatedMinutes === 'number' && (\n          <div><span className=\"text-muted-foreground\">Time:</span> {normalizedItem.estimatedMinutes} min</div>\n        )}\n        {typeof normalizedItem.points === 'number' && (\n          <div><span className=\"text-muted-foreground\">Points:</span> {normalizedItem.points}</div>\n        )}\n        {'submissionType' in normalizedItem && normalizedItem.submissionType && (\n          <div><span className=\"text-muted-foreground\">Submission:</span> {normalizedItem.submissionType}</div>\n        )}\n        {'timeLimit' in normalizedItem && normalizedItem.timeLimit != null && (\n          <div><span className=\"text-muted-foreground\">Time limit:</span> {normalizedItem.timeLimit} min</div>\n        )}\n        {'attemptsAllowed' in normalizedItem && typeof normalizedItem.attemptsAllowed === 'number' && (\n          <div><span className=\"text-muted-foreground\">Attempts:</span> {normalizedItem.attemptsAllowed}</div>\n        )}\n      </div>\n      <div>\n        <h4 className=\"text-sm font-medium mb-2\">Questions ({questions?.length ?? 0})</h4>\n        <QuestionsPreview questions={questions ?? []} />\n      </div>\n      {sourceDocument && (\n        <div className=\"space-y-2 rounded-lg border p-3\">\n          <div className=\"text-xs text-muted-foreground\">\n            Imported file: <span className=\"font-medium text-foreground\">{sourceDocument.fileName}</span>\n          </div>\n          <Textarea\n            value={resourceText}\n            onChange={(e) => setResourceText(e.target.value)}\n            rows={8}\n            placeholder=\"Edit imported content...\"\n          />\n          <div className=\"flex justify-end\">\n            <Button\n              size=\"sm\"\n              variant=\"outline\"\n              onClick={() => {\n                if (!onUpdateItem) return\n                onUpdateItem({\n                  sourceDocument: { ...sourceDocument, extractedText: resourceText }\n                })\n                toast.success('Imported content updated')\n              }}\n            >\n              Save Imported Content\n            </Button>\n          </div>\n        </div>\n      )}\n      {studentPreviewOpen && questions.length > 0 && (\n        <StudentPreviewModal\n          questions={questions}\n          onClose={() => setStudentPreviewOpen(false)}\n        />\n      )}\n      \n      {/* PDF Preview Modal */}\n      <Dialog open={pdfPreviewOpen} onOpenChange={setPdfPreviewOpen}>\n        <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <FileText className=\"h-5 w-5 text-blue-500\" />\n              Preview Question Paper PDF\n            </DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <p className=\"text-sm text-muted-foreground\">\n              Review the generated question paper before assigning to students. Each student will receive their own copy.\n            </p>\n            {generatedPdf && (\n              <div className=\"border rounded-lg overflow-hidden bg-gray-100\">\n                <iframe\n                  src={generatedPdf.url}\n                  className=\"w-full h-[500px]\"\n                  title=\"Question Paper Preview\"\n                />\n              </div>\n            )}\n            <div className=\"flex items-center justify-between pt-4 border-t\">\n              <div className=\"text-sm text-muted-foreground\">\n                {questions.length} questions â€¢ \n                {questions.reduce((sum, q) => sum + (q.points || 1), 0)} total points\n              </div>\n              <div className=\"flex gap-2\">\n                <Button variant=\"outline\" onClick={() => setPdfPreviewOpen(false)}>\n                  Cancel\n                </Button>\n                <Button \n                  onClick={handleConfirmPublish} \n                  disabled={publishing}\n                  className=\"gap-1\"\n                >\n                  {publishing ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Send className=\"h-4 w-4\" />}\n                  Assign to Students\n                </Button>\n              </div>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  )\n}\n\n// ============================================\n// MAIN COURSE BUILDER COMPONENT\n// ============================================\n\nexport const CourseBuilder = forwardRef<CourseBuilderRef, CourseBuilderProps>(function CourseBuilder(\n  { courseId, courseName, panelMode = 'default', initialModules = [], onSave, onMakeVisibleToStudents },\n  ref\n) {\n  const [modules, setModules] = useState<Module[]>(() => normalizeModulesForAssessments(initialModules))\n  const [expandedModules, setExpandedModules] = useState<Set<string>>(new Set())\n  const [expandedLessons, setExpandedLessons] = useState<Set<string>>(new Set())\n  const [selectedItem, setSelectedItem] = useState<{ type: string; id: string } | null>(null)\n  const [aiPanelOpen, setAiPanelOpen] = useState(false)\n\n  // AI Prompt state\n  const [aiPrompt, setAiPrompt] = useState('')\n  const [isGenerating, setIsGenerating] = useState(false)\n  const [attachedFiles, setAttachedFiles] = useState<File[]>([])\n  const objectUrlsRef = useRef<string[]>([])\n\n  // Dev mode state for saving (declared early for ref access)\n  const [devMode, setDevMode] = useState<'single' | 'multi'>('single')\n  const [previewDifficulty, setPreviewDifficulty] = useState<'all' | 'beginner' | 'intermediate' | 'advanced'>('all')\n\n  // Expose save method via ref\n  useImperativeHandle(ref, () => ({\n    save: () => {\n      if (onSave) {\n        onSave(modules, { developmentMode: devMode, previewDifficulty })\n      }\n    }\n  }))\n\n  const trackObjectUrl = useCallback((url: string) => {\n    if (url.startsWith('blob:')) {\n      objectUrlsRef.current.push(url)\n    }\n    return url\n  }, [])\n\n  const handleSendPrompt = async () => {\n    if (!aiPrompt.trim() && attachedFiles.length === 0) return\n    if (!courseId) {\n      toast.error('Course ID is required to generate structure')\n      return\n    }\n\n    setIsGenerating(true)\n    try {\n      const referenceTexts = await Promise.all(\n        attachedFiles.map(async (file) => {\n          try {\n            return await extractTextFromFile(file)\n          } catch {\n            return ''\n          }\n        })\n      )\n\n      const csrfRes = await fetch('/api/csrf', { credentials: 'include' })\n      const csrfData = await csrfRes.json().catch(() => ({}))\n      const csrfToken = csrfData?.token ?? null\n\n      const res = await fetch(`/api/tutor/courses/${courseId}/builder-generate`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(csrfToken ? { 'X-CSRF-Token': csrfToken } : {}),\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          prompt: aiPrompt,\n          references: referenceTexts.filter((text) => text.trim().length > 0),\n        }),\n      })\n\n      const payload = await res.json().catch(() => ({}))\n      if (!res.ok) {\n        throw new Error(payload?.error || 'Failed to generate course structure')\n      }\n\n      const generatedModules = mapGeneratedModulesToBuilder(payload.modules ?? [])\n      if (generatedModules.length === 0) {\n        throw new Error('AI generation returned empty modules')\n      }\n\n      setModules(normalizeModulesForAssessments(generatedModules))\n      toast.success('Complete course structure generated')\n      setAiPrompt('')\n      setAttachedFiles([])\n    } catch (error) {\n      toast.error(error instanceof Error ? error.message : 'Failed to generate course')\n    } finally {\n      setIsGenerating(false)\n    }\n  }\n\n  const handleFileAttach = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files\n    if (files) {\n      setAttachedFiles(prev => [...prev, ...Array.from(files)])\n    }\n    e.target.value = ''\n  }\n\n  const removeAttachedFile = (index: number) => {\n    setAttachedFiles(prev => prev.filter((_, i) => i !== index))\n  }\n\n  useEffect(() => {\n    return () => {\n      for (const url of objectUrlsRef.current) {\n        try {\n          URL.revokeObjectURL(url)\n        } catch {\n          // ignore\n        }\n      }\n      objectUrlsRef.current = []\n    }\n  }, [])\n\n\n  // Modal states\n  const [activeModal, setActiveModal] = useState<{\n    type: 'module' | 'lesson' | 'task' | 'homework' | 'worksheet' | 'moduleQuiz' | 'content'\n    isOpen: boolean\n    moduleId?: string\n    lessonId?: string\n    itemId?: string\n  }>({ type: 'module', isOpen: false })\n\n  const [editingData, setEditingData] = useState<any>(null)\n  const [activeDragId, setActiveDragId] = useState<string | null>(null)\n\n  useEffect(() => {\n    setModules(normalizeModulesForAssessments(initialModules))\n  }, [initialModules])\n\n  // Helper to get effective value based on difficulty mode and preview\n  const getEffectiveValue = <T extends WithDifficultyVariants>(\n    item: T,\n    field: keyof DifficultyVariant\n  ): any => {\n    if (devMode === 'single' || previewDifficulty === 'all' || item.difficultyMode === 'all') {\n      return item[field as keyof T]\n    }\n\n    if (item.difficultyMode === 'fixed' && item.fixedDifficulty) {\n      // If previewing a different difficulty than fixed, show base with warning indicator\n      return item[field as keyof T]\n    }\n\n    // Adaptive mode - show variant for previewed difficulty\n    const variant = item.variants?.[previewDifficulty]\n    return variant?.[field] ?? item[field as keyof T]\n  }\n\n  // Dnd-kit sensors\n  const sensors = useSensors(\n    useSensor(PointerSensor, {\n      activationConstraint: {\n        distance: 8,\n      },\n    }),\n    useSensor(KeyboardSensor, {\n      coordinateGetter: sortableKeyboardCoordinates,\n    })\n  )\n\n  const toggleModule = (moduleId: string) => {\n    const newSet = new Set(expandedModules)\n    if (newSet.has(moduleId)) {\n      newSet.delete(moduleId)\n    } else {\n      newSet.add(moduleId)\n    }\n    setExpandedModules(newSet)\n  }\n\n  const toggleLesson = (lessonId: string) => {\n    const newSet = new Set(expandedLessons)\n    if (newSet.has(lessonId)) {\n      newSet.delete(lessonId)\n    } else {\n      newSet.add(lessonId)\n    }\n    setExpandedLessons(newSet)\n  }\n\n  // Add handlers\n  const addModule = () => {\n    const newModule = DEFAULT_MODULE(modules.length)\n    setModules([...modules, newModule])\n    setExpandedModules(new Set([...expandedModules, newModule.id]))\n    setEditingData(newModule)\n    setActiveModal({ type: 'module', isOpen: true })\n  }\n\n  const addLesson = (moduleId: string) => {\n    const moduleIndex = modules.findIndex(m => m.id === moduleId)\n    if (moduleIndex === -1) return\n\n    const newLesson = DEFAULT_LESSON(modules[moduleIndex].lessons.length)\n    const newModules = [...modules]\n    newModules[moduleIndex].lessons.push(newLesson)\n    setModules(newModules)\n    setExpandedLessons(new Set([...expandedLessons, newLesson.id]))\n    setEditingData(newLesson)\n    setActiveModal({ type: 'lesson', isOpen: true, moduleId })\n  }\n\n  const addTask = (moduleId: string, lessonId: string) => {\n    const moduleIndex = modules.findIndex(m => m.id === moduleId)\n    if (moduleIndex === -1) return\n    const lessonIndex = modules[moduleIndex].lessons.findIndex(l => l.id === lessonId)\n    if (lessonIndex === -1) return\n\n    const newTask = DEFAULT_TASK(modules[moduleIndex].lessons[lessonIndex].tasks.length)\n    const newModules = [...modules]\n    newModules[moduleIndex].lessons[lessonIndex].tasks.push(newTask)\n    setModules(newModules)\n    setEditingData(newTask)\n    setActiveModal({ type: 'task', isOpen: true, moduleId, lessonId })\n  }\n\n  const addContent = (moduleId: string, lessonId: string) => {\n    const moduleIndex = modules.findIndex(m => m.id === moduleId)\n    if (moduleIndex === -1) return\n    const lessonIndex = modules[moduleIndex].lessons.findIndex(l => l.id === lessonId)\n    if (lessonIndex === -1) return\n\n    const newContent = DEFAULT_CONTENT(modules[moduleIndex].lessons[lessonIndex].content?.length || 0)\n    const newModules = [...modules]\n    if (!newModules[moduleIndex].lessons[lessonIndex].content) {\n      newModules[moduleIndex].lessons[lessonIndex].content = []\n    }\n    newModules[moduleIndex].lessons[lessonIndex].content.push(newContent)\n    setModules(newModules)\n    setEditingData(newContent)\n    setActiveModal({ type: 'content', isOpen: true, moduleId, lessonId })\n  }\n\n  const addAssessment = (moduleId: string, lessonId: string) => {\n    const moduleIndex = modules.findIndex(m => m.id === moduleId)\n    if (moduleIndex === -1) return\n    const lessonIndex = modules[moduleIndex].lessons.findIndex(l => l.id === lessonId)\n    if (lessonIndex === -1) return\n\n    const newAssessment = DEFAULT_HOMEWORK(modules[moduleIndex].lessons[lessonIndex].homework.length)\n    const newModules = [...modules]\n    newModules[moduleIndex].lessons[lessonIndex].homework.push(newAssessment)\n    setModules(newModules)\n    setEditingData(newAssessment)\n    setActiveModal({ type: 'homework', isOpen: true, moduleId, lessonId })\n  }\n\n  const addWorksheet = (moduleId: string, lessonId: string) => {\n    const moduleIndex = modules.findIndex(m => m.id === moduleId)\n    if (moduleIndex === -1) return\n    const lessonIndex = modules[moduleIndex].lessons.findIndex(l => l.id === lessonId)\n    if (lessonIndex === -1) return\n\n    const newWorksheet = DEFAULT_WORKSHEET(modules[moduleIndex].lessons[lessonIndex].worksheets?.length || 0)\n    const newModules = [...modules]\n    if (!newModules[moduleIndex].lessons[lessonIndex].worksheets) {\n      newModules[moduleIndex].lessons[lessonIndex].worksheets = []\n    }\n    newModules[moduleIndex].lessons[lessonIndex].worksheets.push(newWorksheet)\n    setModules(newModules)\n    setEditingData(newWorksheet)\n    setActiveModal({ type: 'worksheet', isOpen: true, moduleId, lessonId })\n  }\n\n  const addModuleQuiz = (moduleId: string) => {\n    const moduleIndex = modules.findIndex(m => m.id === moduleId)\n    if (moduleIndex === -1) return\n\n    const newQuiz = DEFAULT_MODULE_QUIZ(modules[moduleIndex].moduleQuizzes.length)\n    const newModules = [...modules]\n    newModules[moduleIndex].moduleQuizzes.push(newQuiz)\n    setModules(newModules)\n    setEditingData(newQuiz)\n    setActiveModal({ type: 'moduleQuiz', isOpen: true, moduleId })\n  }\n\n  const addCourseExam = () => {\n    const workingModules = modules.length > 0 ? [...modules] : [DEFAULT_MODULE(0)]\n    const lastModuleIndex = workingModules.length - 1\n    const lastModule = workingModules[lastModuleIndex]\n    const newExam = {\n      ...DEFAULT_MODULE_QUIZ(lastModule.moduleQuizzes.length),\n      title: 'Final Exam',\n      description: 'Comprehensive course-end assessment.',\n    }\n    workingModules[lastModuleIndex] = {\n      ...lastModule,\n      moduleQuizzes: [...(lastModule.moduleQuizzes || []), newExam],\n    }\n    setModules(workingModules)\n    setExpandedModules(new Set([...expandedModules, workingModules[lastModuleIndex].id]))\n    setEditingData(newExam)\n    setActiveModal({ type: 'moduleQuiz', isOpen: true, moduleId: workingModules[lastModuleIndex].id })\n    toast.success('Final exam added to end of course')\n  }\n\n  const ensureFirstLessonContext = useCallback(() => {\n    let nextModules = [...modules]\n    if (nextModules.length === 0) {\n      nextModules = [DEFAULT_MODULE(0)]\n    }\n    if (nextModules[0].lessons.length === 0) {\n      nextModules[0] = {\n        ...nextModules[0],\n        lessons: [DEFAULT_LESSON(0)],\n      }\n    }\n    setModules(nextModules)\n    setExpandedModules(new Set([...expandedModules, nextModules[0].id]))\n    setExpandedLessons(new Set([...expandedLessons, nextModules[0].lessons[0].id]))\n    return {\n      moduleId: nextModules[0].id,\n      lessonId: nextModules[0].lessons[0].id,\n    }\n  }, [expandedLessons, expandedModules, modules])\n\n  const applyAiSuggestion = useCallback((suggestion: (typeof AI_SUGGESTIONS)[number]) => {\n    setAiPrompt(`Suggestion: ${suggestion.title}. ${suggestion.description}`)\n    toast.success(`Applied suggestion: ${suggestion.title}`)\n  }, [])\n\n  const applyTemplate = useCallback((template: (typeof CONTENT_TEMPLATES)[number]) => {\n    const { moduleId, lessonId } = ensureFirstLessonContext()\n    if (template.category === 'lesson') {\n      addLesson(moduleId)\n      toast.success(`Template applied: ${template.name}`)\n      return\n    }\n    if (template.category === 'quiz') {\n      addAssessment(moduleId, lessonId)\n      toast.success(`Template applied: ${template.name}`)\n      return\n    }\n    if (template.category === 'assessment' || template.category === 'activity') {\n      addTask(moduleId, lessonId)\n      toast.success(`Template applied: ${template.name}`)\n      return\n    }\n    toast.success(`Template selected: ${template.name}`)\n  }, [addAssessment, addLesson, addTask, ensureFirstLessonContext])\n\n  // Drag & Drop handlers\n  const handleDragStart = (event: DragStartEvent) => {\n    setActiveDragId(event.active.id as string)\n  }\n\n  const handleDragEnd = (event: DragEndEvent) => {\n    const { active, over } = event\n    setActiveDragId(null)\n\n    if (!over || active.id === over.id) return\n\n    const activeId = active.id as string\n    const overId = over.id as string\n\n    // Check if dragging a module\n    const activeModuleIndex = modules.findIndex(m => m.id === activeId)\n    const overModuleIndex = modules.findIndex(m => m.id === overId)\n\n    if (activeModuleIndex !== -1 && overModuleIndex !== -1) {\n      setModules(arrayMove(modules, activeModuleIndex, overModuleIndex))\n      return\n    }\n\n    // Check if dragging a lesson\n    for (let mIdx = 0; mIdx < modules.length; mIdx++) {\n      const activeLessonIndex = modules[mIdx].lessons.findIndex(l => l.id === activeId)\n      const overLessonIndex = modules[mIdx].lessons.findIndex(l => l.id === overId)\n\n      if (activeLessonIndex !== -1 && overLessonIndex !== -1) {\n        const newModules = [...modules]\n        newModules[mIdx].lessons = arrayMove(\n          newModules[mIdx].lessons,\n          activeLessonIndex,\n          overLessonIndex\n        )\n        setModules(newModules)\n        return\n      }\n    }\n\n    // Check if dragging content within a lesson\n    for (let mIdx = 0; mIdx < modules.length; mIdx++) {\n      for (let lIdx = 0; lIdx < modules[mIdx].lessons.length; lIdx++) {\n        const lesson = modules[mIdx].lessons[lIdx]\n        const activeContentIndex = lesson.content?.findIndex(c => c.id === activeId) ?? -1\n        const overContentIndex = lesson.content?.findIndex(c => c.id === overId) ?? -1\n\n        if (activeContentIndex !== -1 && overContentIndex !== -1) {\n          const newModules = [...modules]\n          newModules[mIdx].lessons[lIdx].content = arrayMove(\n            newModules[mIdx].lessons[lIdx].content,\n            activeContentIndex,\n            overContentIndex\n          )\n          setModules(newModules)\n          return\n        }\n      }\n    }\n\n    // Check if dragging a task within a lesson\n    for (let mIdx = 0; mIdx < modules.length; mIdx++) {\n      for (let lIdx = 0; lIdx < modules[mIdx].lessons.length; lIdx++) {\n        const lesson = modules[mIdx].lessons[lIdx]\n        const activeTaskIndex = lesson.tasks?.findIndex(t => t.id === activeId) ?? -1\n        const overTaskIndex = lesson.tasks?.findIndex(t => t.id === overId) ?? -1\n\n        if (activeTaskIndex !== -1 && overTaskIndex !== -1) {\n          const newModules = [...modules]\n          newModules[mIdx].lessons[lIdx].tasks = arrayMove(\n            newModules[mIdx].lessons[lIdx].tasks,\n            activeTaskIndex,\n            overTaskIndex\n          )\n          setModules(newModules)\n          return\n        }\n      }\n    }\n\n    // Check if dragging homework within a lesson\n    for (let mIdx = 0; mIdx < modules.length; mIdx++) {\n      for (let lIdx = 0; lIdx < modules[mIdx].lessons.length; lIdx++) {\n        const lesson = modules[mIdx].lessons[lIdx]\n        const activeHwIndex = lesson.homework?.findIndex(h => h.id === activeId) ?? -1\n        const overHwIndex = lesson.homework?.findIndex(h => h.id === overId) ?? -1\n\n        if (activeHwIndex !== -1 && overHwIndex !== -1) {\n          const newModules = [...modules]\n          newModules[mIdx].lessons[lIdx].homework = arrayMove(\n            newModules[mIdx].lessons[lIdx].homework,\n            activeHwIndex,\n            overHwIndex\n          )\n          setModules(newModules)\n          return\n        }\n      }\n    }\n\n  }\n\n  // Save handlers\n  const handleSaveModule = (data: any) => {\n    if (activeModal.itemId) {\n      setModules(modules.map(m => m.id === activeModal.itemId ? { ...m, ...data } : m))\n    } else {\n      setModules(modules.map(m =>\n        m.id === editingData.id ? { ...m, ...data } : m\n      ))\n    }\n    setActiveModal({ type: 'module', isOpen: false })\n    toast.success('Module saved')\n  }\n\n  const handleSaveLesson = (data: any) => {\n    const moduleIndex = modules.findIndex(m => m.id === activeModal.moduleId)\n    if (moduleIndex === -1) return\n\n    const newModules = [...modules]\n    const lessonIndex = newModules[moduleIndex].lessons.findIndex(l => l.id === editingData.id)\n    if (lessonIndex !== -1) {\n      newModules[moduleIndex].lessons[lessonIndex] = {\n        ...newModules[moduleIndex].lessons[lessonIndex],\n        ...data\n      }\n    }\n    setModules(newModules)\n    setActiveModal({ type: 'lesson', isOpen: false })\n    toast.success('Lesson saved')\n  }\n\n  const handleSaveTask = (data: any) => {\n    const moduleIndex = modules.findIndex(m => m.id === activeModal.moduleId)\n    const lessonIndex = modules[moduleIndex]?.lessons.findIndex(l => l.id === activeModal.lessonId)\n    if (moduleIndex === -1 || lessonIndex === -1) return\n\n    const newModules = [...modules]\n    const taskIndex = newModules[moduleIndex].lessons[lessonIndex].tasks.findIndex(t => t.id === editingData.id)\n    if (taskIndex !== -1) {\n      newModules[moduleIndex].lessons[lessonIndex].tasks[taskIndex] = data\n    }\n    setModules(newModules)\n    setActiveModal({ type: 'task', isOpen: false })\n    toast.success('Task saved')\n  }\n\n  const handleSaveContent = (data: Content) => {\n    const moduleIndex = modules.findIndex(m => m.id === activeModal.moduleId)\n    const lessonIndex = modules[moduleIndex]?.lessons.findIndex(l => l.id === activeModal.lessonId)\n    if (moduleIndex === -1 || lessonIndex === -1) return\n\n    const newModules = [...modules]\n    const contentIndex = newModules[moduleIndex].lessons[lessonIndex].content?.findIndex(c => c.id === editingData?.id)\n    if (contentIndex !== undefined && contentIndex !== -1) {\n      newModules[moduleIndex].lessons[lessonIndex].content[contentIndex] = data\n    } else {\n      newModules[moduleIndex].lessons[lessonIndex].content.push(data)\n    }\n    setModules(newModules)\n    setActiveModal({ type: 'content', isOpen: false })\n    toast.success('Content saved')\n  }\n\n  const handleSaveAssessment = (data: any) => {\n    const moduleIndex = modules.findIndex(m => m.id === activeModal.moduleId)\n    const lessonIndex = modules[moduleIndex]?.lessons.findIndex(l => l.id === activeModal.lessonId)\n    if (moduleIndex === -1 || lessonIndex === -1) return\n\n    const newModules = [...modules]\n    const hwIndex = newModules[moduleIndex].lessons[lessonIndex].homework.findIndex(h => h.id === editingData.id)\n    if (hwIndex !== -1) {\n      newModules[moduleIndex].lessons[lessonIndex].homework[hwIndex] = data\n    }\n    setModules(newModules)\n    setActiveModal({ type: 'homework', isOpen: false })\n    toast.success('Assessment saved')\n  }\n\n  const handleSaveWorksheet = (data: Worksheet) => {\n    const moduleIndex = modules.findIndex(m => m.id === activeModal.moduleId)\n    const lessonIndex = modules[moduleIndex]?.lessons.findIndex(l => l.id === activeModal.lessonId)\n    if (moduleIndex === -1 || lessonIndex === -1) return\n\n    const newModules = [...modules]\n    if (!newModules[moduleIndex].lessons[lessonIndex].worksheets) {\n      newModules[moduleIndex].lessons[lessonIndex].worksheets = []\n    }\n    const worksheetIndex = newModules[moduleIndex].lessons[lessonIndex].worksheets.findIndex(w => w.id === editingData.id)\n    if (worksheetIndex !== -1) {\n      newModules[moduleIndex].lessons[lessonIndex].worksheets[worksheetIndex] = data\n    } else {\n      newModules[moduleIndex].lessons[lessonIndex].worksheets.push(data)\n    }\n    setModules(newModules)\n    setActiveModal({ type: 'worksheet', isOpen: false })\n    toast.success('Worksheet saved')\n  }\n\n  const handleSaveModuleQuiz = (data: any) => {\n    const moduleIndex = modules.findIndex(m => m.id === activeModal.moduleId)\n    if (moduleIndex === -1) return\n\n    const newModules = [...modules]\n    const quizIndex = newModules[moduleIndex].moduleQuizzes.findIndex(q => q.id === editingData.id)\n    if (quizIndex !== -1) {\n      newModules[moduleIndex].moduleQuizzes[quizIndex] = data\n    }\n    setModules(newModules)\n    setActiveModal({ type: 'moduleQuiz', isOpen: false })\n    toast.success('Exam saved')\n  }\n\n  const deleteModule = (moduleId: string) => {\n    setModules(modules.filter(m => m.id !== moduleId))\n    toast.success('Module deleted')\n  }\n\n  const deleteLesson = (moduleId: string, lessonId: string) => {\n    setModules(modules.map(m =>\n      m.id === moduleId\n        ? { ...m, lessons: m.lessons.filter(l => l.id !== lessonId) }\n        : m\n    ))\n    toast.success('Lesson deleted')\n  }\n\n  const deleteTask = (moduleId: string, lessonId: string, taskId: string) => {\n    setModules(modules.map(m =>\n      m.id === moduleId\n        ? {\n          ...m,\n          lessons: m.lessons.map(l =>\n            l.id === lessonId\n              ? { ...l, tasks: (l.tasks || []).filter(t => t.id !== taskId) }\n              : l\n          )\n        }\n        : m\n    ))\n    setSelectedItem(null)\n    toast.success('Task removed')\n  }\n\n  const deleteAssessment = (moduleId: string, lessonId: string, hwId: string) => {\n    setModules(modules.map(m =>\n      m.id === moduleId\n        ? {\n          ...m,\n          lessons: m.lessons.map(l =>\n            l.id === lessonId\n              ? { ...l, homework: (l.homework || []).filter(h => h.id !== hwId) }\n              : l\n          )\n        }\n        : m\n    ))\n    setSelectedItem(null)\n    toast.success('Assessment removed')\n  }\n\n  const deleteModuleQuiz = (moduleId: string, quizId: string) => {\n    setModules(modules.map(m =>\n      m.id === moduleId\n        ? { ...m, moduleQuizzes: (m.moduleQuizzes || []).filter(q => q.id !== quizId) }\n        : m\n    ))\n    setSelectedItem(null)\n    toast.success('Exam removed')\n  }\n\n  const duplicateTask = (moduleId: string, lessonId: string, task: Task) => {\n    const copy: Task = {\n      ...task,\n      id: `task-${generateId()}`,\n      title: `${task.title} (copy)`,\n      questions: task.questions?.map(q => ({ ...q, id: `q-${generateId()}` }))\n    }\n    const moduleIndex = modules.findIndex(m => m.id === moduleId)\n    if (moduleIndex === -1) return\n    const lessonIndex = modules[moduleIndex].lessons.findIndex(l => l.id === lessonId)\n    if (lessonIndex === -1) return\n    const newModules = [...modules]\n    newModules[moduleIndex].lessons[lessonIndex].tasks = [\n      ...(newModules[moduleIndex].lessons[lessonIndex].tasks || []),\n      copy\n    ]\n    setModules(newModules)\n    setSelectedItem({ type: 'task', id: copy.id })\n    toast.success('Task duplicated')\n  }\n\n  const duplicateAssessment = (moduleId: string, lessonId: string, hw: Assessment) => {\n    const copy: Assessment = {\n      ...hw,\n      id: `homework-${generateId()}`,\n      title: `${hw.title} (copy)`,\n      questions: hw.questions?.map(q => ({ ...q, id: `q-${generateId()}` }))\n    }\n    const moduleIndex = modules.findIndex(m => m.id === moduleId)\n    if (moduleIndex === -1) return\n    const lessonIndex = modules[moduleIndex].lessons.findIndex(l => l.id === lessonId)\n    if (lessonIndex === -1) return\n    const newModules = [...modules]\n    newModules[moduleIndex].lessons[lessonIndex].homework = [\n      ...(newModules[moduleIndex].lessons[lessonIndex].homework || []),\n      copy\n    ]\n    setModules(newModules)\n    setSelectedItem({ type: 'homework', id: copy.id })\n    toast.success('Assessment duplicated')\n  }\n\n  const duplicateModuleQuiz = (moduleId: string, quiz: ModuleQuiz) => {\n    const copy: ModuleQuiz = {\n      ...quiz,\n      id: `quiz-${generateId()}`,\n      title: `${quiz.title} (copy)`,\n      questions: quiz.questions?.map(q => ({ ...q, id: `q-${generateId()}` }))\n    }\n    const moduleIndex = modules.findIndex(m => m.id === moduleId)\n    if (moduleIndex === -1) return\n    const newModules = [...modules]\n    newModules[moduleIndex].moduleQuizzes = [\n      ...(newModules[moduleIndex].moduleQuizzes || []),\n      copy\n    ]\n    setModules(newModules)\n    setSelectedItem({ type: 'moduleQuiz', id: copy.id })\n    toast.success('Exam duplicated')\n  }\n\n  const deleteWorksheet = (moduleId: string, lessonId: string, worksheetId: string) => {\n    setModules(modules.map(m =>\n      m.id === moduleId\n        ? {\n          ...m,\n          lessons: m.lessons.map(l =>\n            l.id === lessonId\n              ? { ...l, worksheets: (l.worksheets || []).filter(w => w.id !== worksheetId) }\n              : l\n          )\n        }\n        : m\n    ))\n    setSelectedItem(null)\n    toast.success('Worksheet removed')\n  }\n\n  const duplicateWorksheet = (moduleId: string, lessonId: string, worksheet: Worksheet) => {\n    const copy: Worksheet = {\n      ...worksheet,\n      id: `worksheet-${generateId()}`,\n      title: `${worksheet.title} (copy)`,\n      questions: worksheet.questions?.map(q => ({ ...q, id: `q-${generateId()}` }))\n    }\n    const moduleIndex = modules.findIndex(m => m.id === moduleId)\n    if (moduleIndex === -1) return\n    const lessonIndex = modules[moduleIndex].lessons.findIndex(l => l.id === lessonId)\n    if (lessonIndex === -1) return\n    const newModules = [...modules]\n    if (!newModules[moduleIndex].lessons[lessonIndex].worksheets) {\n      newModules[moduleIndex].lessons[lessonIndex].worksheets = []\n    }\n    newModules[moduleIndex].lessons[lessonIndex].worksheets = [\n      ...newModules[moduleIndex].lessons[lessonIndex].worksheets,\n      copy\n    ]\n    setModules(newModules)\n    setSelectedItem({ type: 'worksheet', id: copy.id })\n    toast.success('Worksheet duplicated')\n  }\n\n  const getAllLessons = () => {\n    return modules.flatMap(m => m.lessons)\n  }\n\n  // File upload handlers for Media and Docs\n  const handleMediaUpload = (moduleId: string, lessonId: string, files: FileList | null, type: 'video' | 'image') => {\n    if (!files || files.length === 0) return\n\n    const moduleIndex = modules.findIndex(m => m.id === moduleId)\n    const lessonIndex = modules[moduleIndex]?.lessons.findIndex(l => l.id === lessonId)\n    if (moduleIndex === -1 || lessonIndex === -1) return\n\n    const newModules = [...modules]\n\n    Array.from(files).forEach(file => {\n      if (type === 'video') {\n        newModules[moduleIndex].lessons[lessonIndex].media.videos.push({\n          id: `video-${Date.now()}-${Math.random().toString(36).slice(2, 11)}`,\n          title: file.name,\n          url: trackObjectUrl(URL.createObjectURL(file)),\n          duration: 0\n        })\n      } else {\n        newModules[moduleIndex].lessons[lessonIndex].media.images.push({\n          id: `image-${Date.now()}-${Math.random().toString(36).slice(2, 11)}`,\n          title: file.name,\n          url: trackObjectUrl(URL.createObjectURL(file))\n        })\n      }\n    })\n\n    setModules(newModules)\n    toast.success(`${files.length} ${type}(s) uploaded`)\n  }\n\n  const handleDocUpload = (moduleId: string, lessonId: string, files: FileList | null) => {\n    if (!files || files.length === 0) return\n\n    const moduleIndex = modules.findIndex(m => m.id === moduleId)\n    const lessonIndex = modules[moduleIndex]?.lessons.findIndex(l => l.id === lessonId)\n    if (moduleIndex === -1 || lessonIndex === -1) return\n\n    const newModules = [...modules]\n\n    Array.from(files).forEach(file => {\n      const ext = file.name.split('.').pop()?.toLowerCase()\n      const docType = ext === 'pdf' ? 'pdf' : ext === 'doc' || ext === 'docx' ? 'doc' : ext === 'ppt' || ext === 'pptx' ? 'ppt' : 'other'\n\n      newModules[moduleIndex].lessons[lessonIndex].docs.push({\n        id: `doc-${Date.now()}-${Math.random().toString(36).slice(2, 11)}`,\n        title: file.name,\n        url: trackObjectUrl(URL.createObjectURL(file)),\n        type: docType\n      })\n    })\n\n    setModules(newModules)\n    toast.success(`${files.length} document(s) uploaded`)\n  }\n\n  const updateSelectedItem = (updates: { sourceDocument?: ImportedLearningResource }) => {\n    if (!selectedItem) return\n    const target = resolveSelectedItem(selectedItem, modules)\n    if (!target?.lessonId) return\n\n    setModules((prev) =>\n      prev.map((mod) => {\n        if (mod.id !== target.moduleId) return mod\n        return {\n          ...mod,\n          lessons: mod.lessons.map((lesson) => {\n            if (lesson.id !== target.lessonId) return lesson\n            if (selectedItem.type === 'task') {\n              return {\n                ...lesson,\n                tasks: lesson.tasks.map((task) => task.id === selectedItem.id ? { ...task, ...updates } : task),\n              }\n            }\n            if (selectedItem.type === 'homework') {\n              return {\n                ...lesson,\n                homework: lesson.homework.map((hw) => hw.id === selectedItem.id ? { ...hw, ...updates } : hw),\n              }\n            }\n            if (selectedItem.type === 'worksheet') {\n              return {\n                ...lesson,\n                worksheets: (lesson.worksheets || []).map((ws) => ws.id === selectedItem.id ? { ...ws, ...updates } : ws),\n              }\n            }\n            return lesson\n          }),\n        }\n      })\n    )\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* DIFFICULTY DEVELOPMENT MODE HEADER */}\n      <Card className=\"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200\">\n        <CardContent className=\"py-4\">\n          <div className=\"flex items-center justify-between flex-wrap gap-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 bg-blue-100 rounded-lg\">\n                <BarChart3 className=\"h-5 w-5 text-blue-600\" />\n              </div>\n              <div>\n                <h3 className=\"font-semibold text-gray-900\">Difficulty Development Mode</h3>\n                <p className=\"text-xs text-muted-foreground\">\n                  Choose how to develop content for different skill levels\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-4\">\n              {/* Development Mode Toggle */}\n              <div className=\"flex items-center gap-2 bg-white rounded-lg p-1 border\">\n                <button\n                  onClick={() => setDevMode('single')}\n                  className={cn(\n                    \"px-3 py-1.5 rounded-md text-sm font-medium transition-all\",\n                    devMode === 'single'\n                      ? \"bg-blue-500 text-white shadow-sm\"\n                      : \"text-gray-600 hover:bg-gray-100\"\n                  )}\n                >\n                  Single Level\n                </button>\n                <button\n                  onClick={() => setDevMode('multi')}\n                  className={cn(\n                    \"px-3 py-1.5 rounded-md text-sm font-medium transition-all\",\n                    devMode === 'multi'\n                      ? \"bg-blue-500 text-white shadow-sm\"\n                      : \"text-gray-600 hover:bg-gray-100\"\n                  )}\n                >\n                  Multi-Level (Adaptive)\n                </button>\n              </div>\n\n              {/* Preview Difficulty Selector (only in multi mode) */}\n              {devMode === 'multi' && (\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"text-sm text-muted-foreground\">Preview:</span>\n                  <div className=\"flex items-center gap-1 bg-white rounded-lg p-1 border\">\n                    {(['all', 'beginner', 'intermediate', 'advanced'] as const).map((level) => (\n                      <button\n                        key={level}\n                        onClick={() => setPreviewDifficulty(level)}\n                        className={cn(\n                          \"px-2 py-1 rounded text-xs font-medium transition-all capitalize\",\n                          previewDifficulty === level\n                            ? level === 'all'\n                              ? \"bg-gray-800 text-white\"\n                              : level === 'beginner'\n                                ? \"bg-green-500 text-white\"\n                                : level === 'intermediate'\n                                  ? \"bg-blue-500 text-white\"\n                                  : \"bg-purple-500 text-white\"\n                            : \"text-gray-600 hover:bg-gray-100\"\n                        )}\n                      >\n                        {level === 'all' ? 'All' : level}\n                      </button>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Info Text */}\n          <div className=\"mt-3 pt-3 border-t border-blue-200/50\">\n            <p className=\"text-xs text-blue-700\">\n              {devMode === 'single' ? (\n                <>\n                  <span className=\"font-medium\">Single Level Mode:</span> All content is created for one difficulty level.\n                  When assigned to groups, content adapts automatically based on each group's difficulty setting.\n                </>\n              ) : (\n                <>\n                  <span className=\"font-medium\">Multi-Level Mode:</span> Create customized versions for each difficulty level.\n                  Use the Preview buttons to see how content appears at different levels.\n                  Items marked with ðŸŽ¯ are fixed to specific levels, while ðŸ”„ adaptive items adjust automatically.\n                </>\n              )}\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n\n      <div className=\"grid grid-cols-12 gap-6\">\n        {/* LEFT PANEL - Course Structure */}\n        <div className=\"col-span-4\">\n          <Card className=\"h-full flex flex-col\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"flex items-center gap-2 text-base\">\n                  <Sparkles className=\"h-5 w-5 text-amber-500\" />\n                  Start here!\n                </CardTitle>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"gap-2\"\n                  onClick={() => setAiPanelOpen(!aiPanelOpen)}\n                >\n                  <Wand2 className=\"h-4 w-4\" />\n                  AI Assist\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent className=\"pt-0 flex-1 flex flex-col\">\n              {/* AI Prompt Input - LLM Style */}\n              <div className=\"mb-4 space-y-2\">\n                <div className=\"relative border rounded-xl bg-white shadow-sm\">\n                  {/* Attached Files */}\n                  {attachedFiles.length > 0 && (\n                    <div className=\"flex flex-wrap gap-2 p-2 border-b bg-gray-50 rounded-t-xl\">\n                      {attachedFiles.map((file, idx) => (\n                        <div key={idx} className=\"flex items-center gap-1 bg-white border rounded-lg px-2 py-1 text-xs\">\n                          <FileText className=\"h-3 w-3 text-blue-500\" />\n                          <span className=\"truncate max-w-[80px]\">{file.name}</span>\n                          <button\n                            onClick={() => removeAttachedFile(idx)}\n                            className=\"text-gray-400 hover:text-red-500\"\n                          >\n                            <X className=\"h-3 w-3\" />\n                          </button>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n\n                  <Textarea\n                    value={aiPrompt}\n                    onChange={(e) => setAiPrompt(e.target.value)}\n                    placeholder=\"Describe what you want to create... e.g., 'Create a 4-week Python course for beginners with hands-on projects'\"\n                    className=\"min-h-[80px] resize-none border-0 focus-visible:ring-0 focus-visible:ring-offset-0 text-sm\"\n                    onKeyDown={(e) => {\n                      if (e.key === 'Enter' && !e.shiftKey) {\n                        e.preventDefault()\n                        handleSendPrompt()\n                      }\n                    }}\n                  />\n\n                  <div className=\"flex items-center justify-between p-2 border-t\">\n                    <div className=\"flex items-center gap-1\">\n                      <label className=\"cursor-pointer\">\n                        <input\n                          type=\"file\"\n                          multiple\n                          className=\"hidden\"\n                          onChange={handleFileAttach}\n                          accept=\".pdf,.doc,.docx,.txt,.md,.ppt,.pptx,.xls,.xlsx,image/*,video/*\"\n                        />\n                        <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 p-0\" type=\"button\">\n                          <Paperclip className=\"h-4 w-4 text-gray-500\" />\n                        </Button>\n                      </label>\n                      <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 p-0\" type=\"button\">\n                        <Mic className=\"h-4 w-4 text-gray-500\" />\n                      </Button>\n                    </div>\n\n                    <Button\n                      size=\"sm\"\n                      onClick={handleSendPrompt}\n                      disabled={isGenerating || (!aiPrompt.trim() && attachedFiles.length === 0)}\n                      className=\"gap-1\"\n                    >\n                      {isGenerating ? (\n                        <Loader2 className=\"h-4 w-4 animate-spin\" />\n                      ) : (\n                        <Send className=\"h-4 w-4\" />\n                      )}\n                      {isGenerating ? 'Generating...' : 'Generate'}\n                    </Button>\n                  </div>\n                </div>\n\n                <p className=\"text-xs text-muted-foreground text-center\">\n                  AI will generate modules, lessons, and assessments based on your description\n                </p>\n              </div>\n\n              <ScrollArea className=\"flex-1\">\n                <DndContext\n                  sensors={sensors}\n                  collisionDetection={closestCenter}\n                  onDragStart={handleDragStart}\n                  onDragEnd={handleDragEnd}\n                >\n                  <div className=\"space-y-1\">\n                    {/* Course Root */}\n                    <div className=\"flex items-center justify-between py-2 font-semibold text-sm border-b mb-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <GraduationCap className=\"h-4 w-4 text-blue-600\" />\n                        <span className=\"truncate\">{courseName || 'Course'}</span>\n                      </div>\n                      <div className=\"flex items-center gap-1\">\n                        <Button size=\"sm\" variant=\"outline\" onClick={addCourseExam} className=\"gap-1 h-6 text-xs\">\n                          <FileQuestion className=\"h-3 w-3\" />\n                          Exam\n                        </Button>\n                        <Button size=\"sm\" onClick={addModule} className=\"gap-1 h-6 text-xs\">\n                          <Plus className=\"h-3 w-3\" />\n                          Module\n                        </Button>\n                      </div>\n                    </div>\n\n                    {/* Modules - with drag sorting */}\n                    <SortableContext\n                      items={modules.map(m => m.id)}\n                      strategy={verticalListSortingStrategy}\n                    >\n                      {modules.map((module, moduleIdx) => (\n                        <SortableTreeItem key={module.id} id={module.id} depth={1} isLast={moduleIdx === modules.length - 1}>\n                          <div className=\"group\">\n                            <div\n                              className={cn(\n                                \"flex items-center gap-1.5 py-1.5 px-2 rounded cursor-pointer transition-colors\",\n                                \"bg-blue-50 hover:bg-blue-100 border border-blue-200\"\n                              )}\n                              onClick={() => toggleModule(module.id)}\n                            >\n                              {expandedModules.has(module.id) ? (\n                                <ChevronDown className=\"h-3 w-3 text-blue-600\" />\n                              ) : (\n                                <ChevronRight className=\"h-3 w-3 text-blue-600\" />\n                              )}\n                              <Layers className=\"h-3 w-3 text-blue-600\" />\n                              <span className=\"text-sm font-medium flex-1 truncate\">{module.title}</span>\n                              <Badge variant=\"secondary\" className=\"text-[10px] h-4\">\n                                {module.lessons.length}\n                              </Badge>\n\n                              {/* Difficulty Badge */}\n                              <DifficultyBadge\n                                mode={module.difficultyMode}\n                                fixedDifficulty={module.fixedDifficulty}\n                                size=\"xs\"\n                              />\n\n                              <Button\n                                variant=\"ghost\"\n                                size=\"sm\"\n                                className=\"h-6 text-[10px] gap-1 opacity-0 group-hover:opacity-100 px-2\"\n                                onClick={(e) => {\n                                  e.stopPropagation()\n                                  setEditingData(module)\n                                  setActiveModal({ type: 'module', isOpen: true, itemId: module.id })\n                                }}\n                              >\n                                <Wand2 className=\"h-3 w-3\" />\n                                Builder\n                              </Button>\n\n                              <Button\n                                variant=\"ghost\"\n                                size=\"icon\"\n                                className=\"h-6 w-6 opacity-0 group-hover:opacity-100\"\n                                onClick={(e) => {\n                                  e.stopPropagation()\n                                  deleteModule(module.id)\n                                }}\n                              >\n                                <Trash2 className=\"h-3 w-3 text-red-500\" />\n                              </Button>\n                            </div>\n\n                            {expandedModules.has(module.id) && (\n                              <div className=\"mt-1 space-y-1\">\n                                <TreeItem depth={2} isLast={false}>\n                                  <Button\n                                    variant=\"ghost\"\n                                    size=\"sm\"\n                                    className=\"h-6 text-[10px] gap-1 text-muted-foreground hover:text-foreground px-2\"\n                                    onClick={() => addLesson(module.id)}\n                                  >\n                                    <Plus className=\"h-3 w-3\" />\n                                    Add Lesson\n                                  </Button>\n                                </TreeItem>\n\n                                {/* Lessons - with drag sorting */}\n                                <SortableContext\n                                  items={module.lessons.map(l => l.id)}\n                                  strategy={verticalListSortingStrategy}\n                                >\n                                  {module.lessons.map((lesson, lessonIdx) => (\n                                    <SortableTreeItem\n                                      key={lesson.id}\n                                      id={lesson.id}\n                                      depth={2}\n                                      isLast={lessonIdx === module.lessons.length - 1 && (module.moduleQuizzes?.length || 0) === 0}\n                                    >\n                                      <div className=\"group\">\n                                        <div\n                                          className={cn(\n                                            \"flex items-center gap-1.5 py-1 px-2 rounded cursor-pointer transition-colors\",\n                                            \"bg-green-50 hover:bg-green-100 border border-green-200\"\n                                          )}\n                                          onClick={() => toggleLesson(lesson.id)}\n                                        >\n                                          {expandedLessons.has(lesson.id) ? (\n                                            <ChevronDown className=\"h-3 w-3 text-green-600\" />\n                                          ) : (\n                                            <ChevronRight className=\"h-3 w-3 text-green-600\" />\n                                          )}\n                                          <BookOpen className=\"h-3 w-3 text-green-600\" />\n                                          <span className=\"text-xs flex-1 truncate\">{lesson.title}</span>\n                                          <span className=\"text-[10px] text-muted-foreground\">{lesson.duration}m</span>\n\n                                          {/* Difficulty Badge */}\n                                          <DifficultyBadge\n                                            mode={lesson.difficultyMode}\n                                            fixedDifficulty={lesson.fixedDifficulty}\n                                            size=\"xs\"\n                                          />\n\n                                          <Button\n                                            variant=\"ghost\"\n                                            size=\"sm\"\n                                            className=\"h-5 text-[10px] gap-1 opacity-0 group-hover:opacity-100 px-1.5\"\n                                            onClick={(e) => {\n                                              e.stopPropagation()\n                                              setEditingData(lesson)\n                                              setActiveModal({ type: 'lesson', isOpen: true, moduleId: module.id, itemId: lesson.id })\n                                            }}\n                                          >\n                                            <Wand2 className=\"h-3 w-3\" />\n                                            Builder\n                                          </Button>\n\n                                          <Button\n                                            variant=\"ghost\"\n                                            size=\"icon\"\n                                            className=\"h-5 w-5 opacity-0 group-hover:opacity-100\"\n                                            onClick={(e) => {\n                                              e.stopPropagation()\n                                              deleteLesson(module.id, lesson.id)\n                                            }}\n                                          >\n                                            <Trash2 className=\"h-3 w-3 text-red-500\" />\n                                          </Button>\n                                        </div>\n\n                                        {expandedLessons.has(lesson.id) && (\n                                          <div className=\"mt-1 space-y-1\">\n                                            {/* Media */}\n                                            <TreeItem depth={3} isLast={false}>\n                                              <div className=\"py-1 px-2 rounded bg-gray-50 border border-gray-200 group/media\">\n                                                <div className=\"flex items-center gap-1.5\">\n                                                  <Video className=\"h-3 w-3 text-gray-500\" />\n                                                  <span className=\"text-[10px] text-muted-foreground\">Media</span>\n                                                  <span className=\"text-[10px] text-muted-foreground\">\n                                                    ({lesson.media?.videos?.length || 0}v, {lesson.media?.images?.length || 0}i)\n                                                  </span>\n                                                  <div className=\"flex items-center gap-1 ml-auto opacity-0 group-hover/media:opacity-100\">\n                                                    <label className=\"cursor-pointer\">\n                                                      <input\n                                                        type=\"file\"\n                                                        accept=\"video/*\"\n                                                        multiple\n                                                        className=\"hidden\"\n                                                        onChange={(e) => handleMediaUpload(module.id, lesson.id, e.target.files, 'video')}\n                                                      />\n                                                      <span className=\"flex items-center gap-1 text-[10px] text-blue-600 hover:text-blue-700\">\n                                                        <Upload className=\"h-3 w-3\" /> Vid\n                                                      </span>\n                                                    </label>\n                                                    <label className=\"cursor-pointer\">\n                                                      <input\n                                                        type=\"file\"\n                                                        accept=\"image/*\"\n                                                        multiple\n                                                        className=\"hidden\"\n                                                        onChange={(e) => handleMediaUpload(module.id, lesson.id, e.target.files, 'image')}\n                                                      />\n                                                      <span className=\"flex items-center gap-1 text-[10px] text-green-600 hover:text-green-700\">\n                                                        <ImageIcon className=\"h-3 w-3\" /> Img\n                                                      </span>\n                                                    </label>\n                                                  </div>\n                                                </div>\n                                                {/* List uploaded media */}\n                                                {(lesson.media?.videos?.length > 0 || lesson.media?.images?.length > 0) && (\n                                                  <div className=\"mt-1.5 space-y-0.5 pl-4 border-l border-dashed border-gray-300 ml-1\">\n                                                    {lesson.media?.videos?.map((video, vIdx) => (\n                                                      <div key={video.id} className=\"flex items-center gap-1 text-[10px] text-gray-600\">\n                                                        <Play className=\"h-3 w-3\" />\n                                                        <span className=\"truncate flex-1\">{video.title}</span>\n                                                        <span className=\"text-gray-400\">{video.duration > 0 ? `${Math.floor(video.duration / 60)}m` : 'â€”'}</span>\n                                                      </div>\n                                                    ))}\n                                                    {lesson.media?.images?.map((img, iIdx) => (\n                                                      <div key={img.id} className=\"flex items-center gap-1 text-[10px] text-gray-600\">\n                                                        <ImageIcon className=\"h-3 w-3\" />\n                                                        <span className=\"truncate flex-1\">{img.title}</span>\n                                                      </div>\n                                                    ))}\n                                                  </div>\n                                                )}\n                                              </div>\n                                            </TreeItem>\n\n                                            {/* Docs */}\n                                            <TreeItem depth={3} isLast={false}>\n                                              <div className=\"py-1 px-2 rounded bg-gray-50 border border-gray-200 group/docs\">\n                                                <div className=\"flex items-center gap-1.5\">\n                                                  <FileText className=\"h-3 w-3 text-gray-500\" />\n                                                  <span className=\"text-[10px] text-muted-foreground\">Docs ({lesson.docs?.length || 0})</span>\n                                                  <label className=\"cursor-pointer ml-auto opacity-0 group-hover/docs:opacity-100\">\n                                                    <input\n                                                      type=\"file\"\n                                                      accept=\".pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.txt\"\n                                                      multiple\n                                                      className=\"hidden\"\n                                                      onChange={(e) => handleDocUpload(module.id, lesson.id, e.target.files)}\n                                                    />\n                                                    <span className=\"flex items-center gap-1 text-[10px] text-blue-600 hover:text-blue-700\">\n                                                      <Upload className=\"h-3 w-3\" /> Upload\n                                                    </span>\n                                                  </label>\n                                                </div>\n                                                {/* List uploaded docs */}\n                                                {lesson.docs?.length > 0 && (\n                                                  <div className=\"mt-1.5 space-y-0.5 pl-4 border-l border-dashed border-gray-300 ml-1\">\n                                                    {lesson.docs?.map((doc, dIdx) => (\n                                                      <div key={doc.id} className=\"flex items-center gap-1 text-[10px] text-gray-600\">\n                                                        <FileText className=\"h-3 w-3\" />\n                                                        <span className=\"truncate flex-1\">{doc.title}</span>\n                                                        <span className=\"text-gray-400 uppercase\">{doc.type}</span>\n                                                      </div>\n                                                    ))}\n                                                  </div>\n                                                )}\n                                              </div>\n                                            </TreeItem>\n\n                                            {/* Worksheets - with drag sorting */}\n                                            <SortableContext\n                                              items={lesson.worksheets?.map(w => w.id) || []}\n                                              strategy={verticalListSortingStrategy}\n                                            >\n                                              {(lesson.worksheets || []).map((worksheet, idx) => (\n                                                <SortableTreeItem key={worksheet.id} id={worksheet.id} depth={3} isLast={idx === (lesson.worksheets?.length || 0) - 1}>\n                                                  <div\n                                                    className=\"flex items-center gap-1.5 py-1 px-2 rounded bg-cyan-50 border border-cyan-200 group/item cursor-pointer hover:bg-cyan-100\"\n                                                    onClick={() => setSelectedItem({ type: 'worksheet', id: worksheet.id })}\n                                                  >\n                                                    <FileText className=\"h-3 w-3 text-cyan-500\" />\n                                                    <span className=\"text-[10px] flex-1 truncate\">{worksheet.title}</span>\n                                                    <span className=\"text-[10px] text-muted-foreground\">{worksheet.points}pts</span>\n                                                    <Button\n                                                      variant=\"ghost\"\n                                                      size=\"sm\"\n                                                      className=\"h-5 text-[10px] gap-1 opacity-0 group-hover/item:opacity-100 px-1\"\n                                                      onClick={(e) => {\n                                                        e.stopPropagation()\n                                                        setEditingData(worksheet)\n                                                        setActiveModal({ type: 'worksheet', isOpen: true, moduleId: module.id, lessonId: lesson.id, itemId: worksheet.id })\n                                                      }}\n                                                    >\n                                                      Edit\n                                                    </Button>\n                                                    <Button\n                                                      variant=\"ghost\"\n                                                      size=\"icon\"\n                                                      className=\"h-5 w-5 opacity-0 group-hover/item:opacity-100\"\n                                                      onClick={(e) => {\n                                                        e.stopPropagation()\n                                                        deleteWorksheet(module.id, lesson.id, worksheet.id)\n                                                      }}\n                                                    >\n                                                      <Trash2 className=\"h-3 w-3 text-red-500\" />\n                                                    </Button>\n                                                  </div>\n                                                </SortableTreeItem>\n                                              ))}\n                                            </SortableContext>\n                                            <TreeItem depth={3} isLast={false}>\n                                              <Button\n                                                variant=\"ghost\"\n                                                size=\"sm\"\n                                                className=\"h-5 text-[10px] gap-1 text-cyan-600 px-2\"\n                                                onClick={() => addWorksheet(module.id, lesson.id)}\n                                              >\n                                                <Plus className=\"h-3 w-3\" />\n                                                Worksheet\n                                              </Button>\n                                            </TreeItem>\n\n                                            {/* Tasks - with drag sorting */}\n                                            <SortableContext\n                                              items={lesson.tasks?.map(t => t.id) || []}\n                                              strategy={verticalListSortingStrategy}\n                                            >\n                                              {(lesson.tasks || []).map((task, idx) => (\n                                                <SortableTreeItem key={task.id} id={task.id} depth={3} isLast={idx === (lesson.tasks?.length || 0) - 1}>\n                                                  <div\n                                                    className=\"flex items-center gap-1.5 py-1 px-2 rounded bg-orange-50 border border-orange-200 group/item cursor-pointer hover:bg-orange-100\"\n                                                    onClick={() => setSelectedItem({ type: 'task', id: task.id })}\n                                                  >\n                                                    <ListTodo className=\"h-3 w-3 text-orange-500\" />\n                                                    <span className=\"text-[10px] flex-1 truncate\">{task.title}</span>\n                                                    <span className=\"text-[10px] text-muted-foreground\">{task.points}pts</span>\n                                                    <Button\n                                                      variant=\"ghost\"\n                                                      size=\"sm\"\n                                                      className=\"h-5 text-[10px] gap-1 opacity-0 group-hover/item:opacity-100 px-1\"\n                                                      onClick={(e) => {\n                                                        e.stopPropagation()\n                                                        setEditingData(task)\n                                                        setActiveModal({ type: 'task', isOpen: true, moduleId: module.id, lessonId: lesson.id, itemId: task.id })\n                                                      }}\n                                                    >\n                                                      Edit\n                                                    </Button>\n                                                    <Button\n                                                      variant=\"ghost\"\n                                                      size=\"icon\"\n                                                      className=\"h-5 w-5 opacity-0 group-hover/item:opacity-100\"\n                                                      onClick={(e) => {\n                                                        e.stopPropagation()\n                                                        deleteTask(module.id, lesson.id, task.id)\n                                                      }}\n                                                    >\n                                                      <Trash2 className=\"h-3 w-3 text-red-500\" />\n                                                    </Button>\n                                                  </div>\n                                                </SortableTreeItem>\n                                              ))}\n                                            </SortableContext>\n                                            <TreeItem depth={3} isLast={false}>\n                                              <Button\n                                                variant=\"ghost\"\n                                                size=\"sm\"\n                                                className=\"h-5 text-[10px] gap-1 text-orange-600 px-2\"\n                                                onClick={() => addTask(module.id, lesson.id)}\n                                              >\n                                                <Plus className=\"h-3 w-3\" />\n                                                Task\n                                              </Button>\n                                            </TreeItem>\n\n                                            {/* Assessment - with drag sorting */}\n                                            <SortableContext\n                                              items={lesson.homework?.map(h => h.id) || []}\n                                              strategy={verticalListSortingStrategy}\n                                            >\n                                              {(lesson.homework || []).map((hw, idx) => (\n                                                <SortableTreeItem key={hw.id} id={hw.id} depth={3} isLast={idx === (lesson.homework?.length || 0) - 1}>\n                                                  <div\n                                                    className=\"flex items-center gap-1.5 py-1 px-2 rounded bg-purple-50 border border-purple-200 group/item cursor-pointer hover:bg-purple-100\"\n                                                    onClick={() => setSelectedItem({ type: 'homework', id: hw.id })}\n                                                  >\n                                                    <Home className=\"h-3 w-3 text-purple-500\" />\n                                                    <span className=\"text-[10px] flex-1 truncate\">{hw.title}</span>\n                                                    <span className=\"text-[10px] text-muted-foreground\">{hw.points}pts</span>\n                                                    <Button\n                                                      variant=\"ghost\"\n                                                      size=\"sm\"\n                                                      className=\"h-5 text-[10px] gap-1 opacity-0 group-hover/item:opacity-100 px-1\"\n                                                      onClick={(e) => {\n                                                        e.stopPropagation()\n                                                        setEditingData(hw)\n                                                        setActiveModal({ type: 'homework', isOpen: true, moduleId: module.id, lessonId: lesson.id, itemId: hw.id })\n                                                      }}\n                                                    >\n                                                      Edit\n                                                    </Button>\n                                                    <Button\n                                                      variant=\"ghost\"\n                                                      size=\"icon\"\n                                                      className=\"h-5 w-5 opacity-0 group-hover/item:opacity-100\"\n                                                      onClick={(e) => {\n                                                        e.stopPropagation()\n                                                        deleteAssessment(module.id, lesson.id, hw.id)\n                                                      }}\n                                                    >\n                                                      <Trash2 className=\"h-3 w-3 text-red-500\" />\n                                                    </Button>\n                                                  </div>\n                                                </SortableTreeItem>\n                                              ))}\n                                            </SortableContext>\n                                            <TreeItem depth={3} isLast={false}>\n                                              <Button\n                                                variant=\"ghost\"\n                                                size=\"sm\"\n                                                className=\"h-5 text-[10px] gap-1 text-purple-600 px-2\"\n                                                onClick={() => addAssessment(module.id, lesson.id)}\n                                              >\n                                                <Plus className=\"h-3 w-3\" />\n                                                Assessment\n                                              </Button>\n                                            </TreeItem>\n\n                                          </div>\n                                        )}\n                                      </div>\n                                    </SortableTreeItem>\n                                  ))}\n                                </SortableContext>\n\n                                {/* End of Module Quizzes */}\n                                {(module.moduleQuizzes || []).map((quiz, quizIdx) => (\n                                  <TreeItem key={quiz.id} depth={2} isLast={quizIdx === (module.moduleQuizzes?.length || 0) - 1}>\n                                    <div\n                                      className=\"flex items-center gap-1.5 py-1 px-2 rounded bg-red-100 border border-red-300 group cursor-pointer hover:bg-red-200\"\n                                      onClick={() => setSelectedItem({ type: 'moduleQuiz', id: quiz.id })}\n                                    >\n                                      <FileQuestion className=\"h-3 w-3 text-red-600\" />\n                                      <span className=\"text-xs font-medium flex-1 truncate\">{quiz.title}</span>\n                                      <Badge variant=\"default\" className=\"text-[8px] h-4 px-1 bg-red-600\">Summative</Badge>\n                                      <Button\n                                        variant=\"ghost\"\n                                        size=\"sm\"\n                                        className=\"h-5 text-[10px] gap-1 opacity-0 group-hover:opacity-100 px-1\"\n                                        onClick={(e) => {\n                                          e.stopPropagation()\n                                          setEditingData(quiz)\n                                          setActiveModal({ type: 'moduleQuiz', isOpen: true, moduleId: module.id, itemId: quiz.id })\n                                        }}\n                                      >\n                                        Edit\n                                      </Button>\n                                      <Button\n                                        variant=\"ghost\"\n                                        size=\"icon\"\n                                        className=\"h-5 w-5 opacity-0 group-hover:opacity-100\"\n                                        onClick={(e) => {\n                                          e.stopPropagation()\n                                          deleteModuleQuiz(module.id, quiz.id)\n                                        }}\n                                      >\n                                        <Trash2 className=\"h-3 w-3 text-red-500\" />\n                                      </Button>\n                                    </div>\n                                  </TreeItem>\n                                ))}\n                                <TreeItem depth={2} isLast={true}>\n                                  <Button\n                                    variant=\"ghost\"\n                                    size=\"sm\"\n                                    className=\"h-6 text-[10px] gap-1 text-red-700 font-medium px-2\"\n                                    onClick={() => addModuleQuiz(module.id)}\n                                  >\n                                    <Plus className=\"h-3 w-3\" />\n                                    Exam\n                                  </Button>\n                                </TreeItem>\n                              </div>\n                            )}\n                          </div>\n                        </SortableTreeItem>\n                      ))}\n                    </SortableContext>\n\n                    {modules.length === 0 && (\n                      <div className=\"text-center py-8 text-muted-foreground\">\n                        <Layers className=\"h-8 w-8 mx-auto mb-2 opacity-30\" />\n                        <p className=\"text-sm\">No modules yet. Click \"Module\" to add one.</p>\n                      </div>\n                    )}\n                  </div>\n                </DndContext>\n              </ScrollArea>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* CENTER PANEL - Preview/Workspace */}\n        <div className={aiPanelOpen ? 'col-span-5' : 'col-span-8'}>\n          <Card className=\"h-full flex flex-col\">\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"text-base\">Preview</CardTitle>\n            </CardHeader>\n            <CardContent className=\"flex-1 overflow-auto\">\n              {(() => {\n                const resolved = resolveSelectedItem(selectedItem, modules)\n                if (!resolved) {\n                  return (\n                    <div className=\"flex items-center justify-center text-muted-foreground h-full min-h-[200px]\">\n                      <div className=\"text-center\">\n                        <BookOpen className=\"h-16 w-16 mx-auto mb-4 opacity-20\" />\n                        <p>Select an item from the left to preview</p>\n                        <p className=\"text-sm mt-2\">Click a lesson, task, assessment, worksheet, or exam</p>\n                      </div>\n                    </div>\n                  )\n                }\n                const { item, moduleId, lessonId } = resolved\n                const itemType = selectedItem?.type as 'task' | 'homework' | 'worksheet' | 'moduleQuiz' | 'lesson' | 'module'\n                const onEdit = () => {\n                  if (itemType === 'lesson') {\n                    setEditingData(item)\n                    setActiveModal({ type: 'lesson', isOpen: true, moduleId, lessonId })\n                    return\n                  }\n                  if (itemType === 'module') {\n                    setEditingData(item)\n                    setActiveModal({ type: 'module', isOpen: true, moduleId })\n                    return\n                  }\n                  setEditingData(item)\n                  setActiveModal({\n                    type: itemType || 'task',\n                    isOpen: true,\n                    moduleId,\n                    lessonId,\n                    itemId: item.id\n                  })\n                }\n                const onRemove = () => {\n                  if (!confirm(`Remove \"${item.title}\"? This cannot be undone.`)) return\n                  if (selectedItem?.type === 'task' && lessonId) deleteTask(moduleId, lessonId, item.id)\n                  else if (selectedItem?.type === 'homework' && lessonId) deleteAssessment(moduleId, lessonId, item.id)\n                  else if (selectedItem?.type === 'worksheet' && lessonId) deleteWorksheet(moduleId, lessonId, item.id)\n                  else if (selectedItem?.type === 'moduleQuiz') deleteModuleQuiz(moduleId, item.id)\n                }\n                const onDuplicate = () => {\n                  if (selectedItem?.type === 'task' && lessonId) duplicateTask(moduleId, lessonId, item as Task)\n                  else if (selectedItem?.type === 'homework' && lessonId) duplicateAssessment(moduleId, lessonId, item as Assessment)\n                  else if (selectedItem?.type === 'worksheet' && lessonId) duplicateWorksheet(moduleId, lessonId, item as Worksheet)\n                  else if (selectedItem?.type === 'moduleQuiz') duplicateModuleQuiz(moduleId, item as ModuleQuiz)\n                }\n                return (\n                  <PreviewCard\n                    type={itemType}\n                    item={item}\n                    onEdit={onEdit}\n                    onDuplicate={onDuplicate}\n                    onRemove={onRemove}\n                    onUpdateItem={updateSelectedItem}\n                    courseId={courseId}\n                    lessonId={lessonId}\n                    showLiveShareAction={panelMode === 'live-class'}\n                    onMakeVisibleToStudents={onMakeVisibleToStudents}\n                  />\n                )\n              })()}\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* RIGHT PANEL - AI Assistant & Templates (conditional) */}\n        {aiPanelOpen && (\n        <div className=\"col-span-3 space-y-4\">\n          {/* AI Suggestions */}\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"flex items-center gap-2 text-base\">\n                <Sparkles className=\"h-4 w-4 text-amber-500\" />\n                AI Assistant\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"pt-0 space-y-3\">\n              {AI_SUGGESTIONS.slice(0, 3).map((suggestion) => (\n                <div\n                  key={suggestion.id}\n                  className=\"flex items-start gap-2 p-2 rounded-lg border hover:bg-gray-50 cursor-pointer transition-colors\"\n                  onClick={() => applyAiSuggestion(suggestion)}\n                >\n                  <suggestion.icon className=\"h-4 w-4 text-amber-500 mt-0.5\" />\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"text-sm font-medium\">{suggestion.title}</p>\n                    <p className=\"text-xs text-muted-foreground line-clamp-2\">{suggestion.description}</p>\n                  </div>\n                </div>\n              ))}\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"w-full gap-2\"\n                onClick={() => {\n                  const nextSuggestion = AI_SUGGESTIONS[(Math.floor(Math.random() * AI_SUGGESTIONS.length))]\n                  applyAiSuggestion(nextSuggestion)\n                }}\n              >\n                <Zap className=\"h-3 w-3\" />\n                Generate More Ideas\n              </Button>\n            </CardContent>\n          </Card>\n\n          {/* Templates */}\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"flex items-center gap-2 text-base\">\n                <LayoutTemplate className=\"h-4 w-4 text-blue-500\" />\n                Templates\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"pt-0 space-y-2\">\n              {CONTENT_TEMPLATES.slice(0, 4).map((template) => (\n                <div\n                  key={template.id}\n                  className=\"flex items-center gap-2 p-2 rounded-lg border hover:bg-gray-50 cursor-pointer transition-colors\"\n                  onClick={() => applyTemplate(template)}\n                >\n                  <template.icon className=\"h-4 w-4 text-blue-500\" />\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"text-sm font-medium truncate\">{template.name}</p>\n                    <p className=\"text-xs text-muted-foreground line-clamp-1\">{template.description}</p>\n                  </div>\n                </div>\n              ))}\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"w-full\"\n                onClick={() => applyTemplate(CONTENT_TEMPLATES[0])}\n              >\n                View All Templates\n              </Button>\n            </CardContent>\n          </Card>\n\n          {/* Quick Stats */}\n          <Card>\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"text-base\">Course Stats</CardTitle>\n            </CardHeader>\n            <CardContent className=\"pt-0\">\n              <div className=\"grid grid-cols-2 gap-2 text-center\">\n                <div className=\"p-2 bg-gray-50 rounded\">\n                  <p className=\"text-lg font-bold\">{modules.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Modules</p>\n                </div>\n                <div className=\"p-2 bg-gray-50 rounded\">\n                  <p className=\"text-lg font-bold\">\n                    {modules.reduce((acc, m) => acc + m.lessons.length, 0)}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground\">Lessons</p>\n                </div>\n                <div className=\"p-2 bg-gray-50 rounded\">\n                  <p className=\"text-lg font-bold\">\n                    {modules.reduce((acc, m) => acc + m.moduleQuizzes.length, 0)}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground\">Exams</p>\n                </div>\n                <div className=\"p-2 bg-gray-50 rounded\">\n                  <p className=\"text-lg font-bold\">\n                    {modules.reduce((acc, m) => acc + m.lessons.reduce((lacc, l) => lacc + l.tasks.length + l.homework.length + (l.worksheets?.length || 0), 0), 0)}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground\">Activities</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n        )}\n\n        {/* Modals */}\n        <ModuleBuilderModal\n          isOpen={activeModal.type === 'module' && activeModal.isOpen}\n          onClose={() => setActiveModal({ type: 'module', isOpen: false })}\n          onSave={handleSaveModule}\n          initialData={editingData}\n        />\n\n        <LessonBuilderModal\n          isOpen={activeModal.type === 'lesson' && activeModal.isOpen}\n          onClose={() => setActiveModal({ type: 'lesson', isOpen: false })}\n          onSave={handleSaveLesson}\n          initialData={editingData}\n          allLessons={getAllLessons()}\n        />\n\n        <TaskBuilderModal\n          isOpen={activeModal.type === 'task' && activeModal.isOpen}\n          onClose={() => setActiveModal({ type: 'task', isOpen: false })}\n          onSave={handleSaveTask}\n          initialData={editingData}\n        />\n\n        <QuizBuilderModal\n          isOpen={activeModal.type === 'homework' && activeModal.isOpen}\n          onClose={() => setActiveModal({ type: 'homework', isOpen: false })}\n          onSave={handleSaveAssessment}\n          initialData={editingData}\n          isModuleQuiz={false}\n        />\n\n        <WorksheetBuilderModal\n          isOpen={activeModal.type === 'worksheet' && activeModal.isOpen}\n          onClose={() => setActiveModal({ type: 'worksheet', isOpen: false })}\n          onSave={handleSaveWorksheet}\n          initialData={editingData}\n        />\n\n        <QuizBuilderModal\n          isOpen={activeModal.type === 'moduleQuiz' && activeModal.isOpen}\n          onClose={() => setActiveModal({ type: 'moduleQuiz', isOpen: false })}\n          onSave={handleSaveModuleQuiz}\n          initialData={editingData}\n          isModuleQuiz={true}\n        />\n\n        <ContentBuilderModal\n          isOpen={activeModal.type === 'content' && activeModal.isOpen}\n          onClose={() => setActiveModal({ type: 'content', isOpen: false })}\n          onSave={handleSaveContent}\n          initialData={editingData}\n        />\n      </div>\n    </div>\n  )\n})\n"],"names":[],"mappings":"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"}}]
}