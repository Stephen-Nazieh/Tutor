;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="5f75161b-65db-4b70-7f9c-aa1e9a7e2da4")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,276362,e=>{"use strict";let s,t,a;var l,i=e.i(251474),r=e.i(800592),n=e.i(624842),d=e.i(536105),c=e.i(151651),o=e.i(870368),u=e.i(455103),m=e.i(800103),h=e.i(515692),g=e.i(828977),x=e.i(598320),p=e.i(725399),j=e.i(587604),b=e.i(538998),v=e.i(247583),f=e.i(230645),y=e.i(383918);let N=[{value:"math",label:"Mathematics"},{value:"physics",label:"Physics"},{value:"chemistry",label:"Chemistry"},{value:"biology",label:"Biology"},{value:"english",label:"English"},{value:"history",label:"History"},{value:"cs",label:"Computer Science"},{value:"ielts",label:"IELTS"},{value:"toefl",label:"TOEFL"}],w=[{value:"6",label:"Grade 6"},{value:"7",label:"Grade 7"},{value:"8",label:"Grade 8"},{value:"9",label:"Grade 9"},{value:"10",label:"Grade 10"},{value:"11",label:"Grade 11"},{value:"12",label:"Grade 12"},{value:"college",label:"College"}];function S({open:e,onOpenChange:s,onClassCreated:t,redirectToClass:a=!0}){let l=(0,d.useRouter)(),[n,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(null),[h,g]=(0,r.useState)({title:"",subject:"",description:"",gradeLevel:"",maxStudents:50,durationMinutes:60,scheduledAt:""}),S=async()=>{if(!h.title.trim())return void x.toast.error("Please enter a class title");if(!h.subject)return void x.toast.error("Please select a subject");if(!h.gradeLevel)return void x.toast.error("Please select a grade level");if(!h.scheduledAt)return void x.toast.error("Please select date and time");c(!0),m(null);try{let e=new Date(h.scheduledAt);if(Number.isNaN(e.getTime())){let e="Please provide a valid date and time.";m(e),x.toast.error(e);return}let i=await fetch("/api/csrf",{credentials:"include"}),r=await i.json().catch(()=>({})),n=r?.token??null,d=await fetch("/api/class/rooms",{method:"POST",headers:{"Content-Type":"application/json",...n&&{"X-CSRF-Token":n}},credentials:"include",body:JSON.stringify({title:h.title,subject:h.subject,gradeLevel:h.gradeLevel,description:h.description,maxStudents:h.maxStudents,durationMinutes:h.durationMinutes,scheduledAt:e.toISOString()})}),c=await d.text(),o={};if(c)try{o=JSON.parse(c)}catch{o={error:`Request failed (${d.status}): ${c.slice(0,180)}`}}if(d.ok)x.toast.success("Class created successfully!"),s(!1),t?.(o.session),a&&o.session?.id&&l.push(`/tutor/live-class/${o.session.id}`);else{let e=o.error||"Room creation failed. Please try again.";m(e),x.toast.error(e)}}catch(s){let e=s instanceof Error?s.message:"An error occurred. Please check your connection and try again.";m(e),x.toast.error(e)}finally{c(!1)}},C=e=>{n||(e||m(null),s(e))};return(0,i.jsx)(p.Dialog,{open:e,onOpenChange:C,children:(0,i.jsxs)(p.DialogContent,{className:"sm:max-w-[500px]","aria-busy":n,"aria-describedby":u?"create-class-api-error":void 0,children:[(0,i.jsxs)(p.DialogHeader,{children:[(0,i.jsx)(p.DialogTitle,{children:"Create New Class"}),(0,i.jsx)(p.DialogDescription,{children:"Schedule a new live class session for your students."})]}),(0,i.jsxs)("div",{className:"space-y-4 py-4",children:[u&&(0,i.jsx)("p",{id:"create-class-api-error",className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-md px-3 py-2",role:"alert",children:u}),(0,i.jsxs)("div",{children:[(0,i.jsx)(b.Label,{children:"Class Title *"}),(0,i.jsx)(j.Input,{value:h.title,onChange:e=>g({...h,title:e.target.value}),placeholder:"e.g., AP Calculus - Limits",disabled:n,"aria-invalid":!!u})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(b.Label,{children:"Subject *"}),(0,i.jsxs)(f.Select,{value:h.subject,onValueChange:e=>g({...h,subject:e}),children:[(0,i.jsx)(f.SelectTrigger,{disabled:n,children:(0,i.jsx)(f.SelectValue,{placeholder:"Select subject"})}),(0,i.jsx)(f.SelectContent,{children:N.map(e=>(0,i.jsx)(f.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(b.Label,{children:"Grade Level *"}),(0,i.jsxs)(f.Select,{value:h.gradeLevel,onValueChange:e=>g({...h,gradeLevel:e}),children:[(0,i.jsx)(f.SelectTrigger,{disabled:n,children:(0,i.jsx)(f.SelectValue,{placeholder:"Select grade"})}),(0,i.jsx)(f.SelectContent,{children:w.map(e=>(0,i.jsx)(f.SelectItem,{value:e.value,children:e.label},e.value))})]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(b.Label,{children:"Description"}),(0,i.jsx)(v.Textarea,{value:h.description,onChange:e=>g({...h,description:e.target.value}),placeholder:"What will you cover in this class?",disabled:n})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(b.Label,{children:"Date & Time *"}),(0,i.jsx)(j.Input,{type:"datetime-local",value:h.scheduledAt,onChange:e=>g({...h,scheduledAt:e.target.value}),disabled:n})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(b.Label,{children:"Duration (minutes)"}),(0,i.jsxs)(f.Select,{value:h.durationMinutes.toString(),onValueChange:e=>g({...h,durationMinutes:parseInt(e)}),children:[(0,i.jsx)(f.SelectTrigger,{disabled:n,children:(0,i.jsx)(f.SelectValue,{})}),(0,i.jsxs)(f.SelectContent,{children:[(0,i.jsx)(f.SelectItem,{value:"30",children:"30 minutes"}),(0,i.jsx)(f.SelectItem,{value:"60",children:"1 hour"}),(0,i.jsx)(f.SelectItem,{value:"90",children:"1.5 hours"}),(0,i.jsx)(f.SelectItem,{value:"120",children:"2 hours"})]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(b.Label,{children:"Max Students"}),(0,i.jsxs)(f.Select,{value:h.maxStudents.toString(),onValueChange:e=>g({...h,maxStudents:parseInt(e)}),children:[(0,i.jsx)(f.SelectTrigger,{disabled:n,children:(0,i.jsx)(f.SelectValue,{})}),(0,i.jsxs)(f.SelectContent,{children:[(0,i.jsx)(f.SelectItem,{value:"10",children:"10 students"}),(0,i.jsx)(f.SelectItem,{value:"25",children:"25 students"}),(0,i.jsx)(f.SelectItem,{value:"50",children:"50 students"}),(0,i.jsx)(f.SelectItem,{value:"100",children:"100 students"})]})]})]})]})]}),(0,i.jsxs)(p.DialogFooter,{children:[(0,i.jsx)(o.Button,{variant:"outline",onClick:()=>C(!1),disabled:n,children:"Cancel"}),(0,i.jsxs)(o.Button,{onClick:S,disabled:n,"aria-busy":n,children:[n&&(0,i.jsx)(y.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Create Class"]})]})]})})}var C=e.i(36808),k=e.i(196415),D=e.i(358469),T=e.i(462423),M=e.i(376194),A=e.i(53169),I=e.i(610570),R=e.i(715042),L=e.i(507168);function B({classes:e,formatDate:s,loading:t,onCreateClassClick:a,onRemoveClass:l}){return(0,i.jsxs)(k.Card,{children:[(0,i.jsxs)(k.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,i.jsxs)(k.CardTitle,{className:"flex items-center gap-2",title:"Scheduled and active classes",children:[(0,i.jsx)(D.Clock,{className:"w-5 h-5 text-blue-500"}),"My Classes"]}),(0,i.jsx)(c.default,{href:"/tutor/classes",children:(0,i.jsx)(o.Button,{variant:"ghost",size:"sm",children:"View All"})})]}),(0,i.jsx)(k.CardContent,{children:t?(0,i.jsx)("div",{className:"space-y-4","aria-busy":"true",children:[1,2,3].map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[(0,i.jsx)("div",{className:"w-12 h-12 bg-gray-200 rounded-lg animate-pulse"}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"h-4 w-48 bg-gray-200 rounded animate-pulse"}),(0,i.jsx)("div",{className:"h-3 w-36 bg-gray-200 rounded animate-pulse"}),(0,i.jsx)("div",{className:"h-3 w-24 bg-gray-200 rounded animate-pulse"})]})]}),(0,i.jsx)("div",{className:"h-9 w-24 bg-gray-200 rounded animate-pulse"})]},e))}):0===e.length?(0,i.jsxs)("div",{className:"text-center py-8 px-4 border rounded-lg border-dashed border-gray-300 bg-gray-50/50",children:[(0,i.jsx)("p",{className:"text-gray-600 mb-3",children:"No upcoming classes"}),a&&(0,i.jsxs)(o.Button,{onClick:a,children:[(0,i.jsx)(A.Plus,{className:"w-4 h-4 mr-2"})," Schedule a class"]})]}):(0,i.jsx)("div",{className:"space-y-4",children:e.map(e=>{let s=(0,L.formatClassTime)(e.scheduledAt);return(0,i.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[(0,i.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,i.jsx)(T.BookOpen,{className:"w-6 h-6 text-blue-600"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"font-medium",children:e.title}),(0,i.jsxs)("p",{className:"text-sm text-gray-500",children:[e.subject," • ",s.formatted,s.relative&&(0,i.jsxs)("span",{className:"text-blue-600 font-medium",children:[" • ",s.relative]})]}),(0,i.jsxs)("p",{className:"text-xs text-gray-400",children:[e.enrolledStudents,"/",e.maxStudents," students enrolled"]})]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>{var s;let t;return s=e.id,t=`${window.location.origin}/tutor/live-class/${s}`,void("u">typeof navigator&&navigator.clipboard?.writeText&&navigator.clipboard.writeText(t).then(()=>x.toast.success("Join link copied to clipboard")))},title:"Copy join link",children:(0,i.jsx)(M.Copy,{className:"w-4 h-4"})}),(0,i.jsx)(c.default,{href:`/tutor/live-class/${e.id}`,title:"Enter Live Class",children:(0,i.jsxs)(o.Button,{size:"sm",className:"bg-gradient-to-r from-purple-600 to-blue-600",children:[(0,i.jsx)(I.Video,{className:"w-4 h-4 mr-1"}),"Enter Room"]})}),l&&(0,i.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>l(e.id),title:"Remove class",className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:(0,i.jsx)(R.Trash2,{className:"w-4 h-4"})})]})]},e.id)})})})]})}function O({students:e,loading:s}){let t=(0,d.useRouter)();return(0,i.jsxs)(k.Card,{children:[(0,i.jsx)(k.CardHeader,{children:(0,i.jsx)(k.CardTitle,{children:"Students Needing Attention"})}),(0,i.jsx)(k.CardContent,{children:s?(0,i.jsx)("div",{className:"space-y-3","aria-busy":"true",children:[1,2,3].map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-200 animate-pulse"}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}),(0,i.jsx)("div",{className:"h-3 w-40 bg-gray-200 rounded animate-pulse"})]})]}),(0,i.jsx)("div",{className:"h-8 w-20 bg-gray-200 rounded animate-pulse"})]},e))}):0===e.length?(0,i.jsx)("p",{className:"text-sm text-gray-500 py-4 text-center",children:"No students need attention right now."}):(0,i.jsx)("div",{className:"space-y-3",children:e.map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-semibold bg-gray-100 text-gray-700",children:e.initial}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-medium",children:e.name}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:e.issue})]})]}),(0,i.jsx)(o.Button,{size:"sm",variant:"outline",onClick:()=>t.push(`/tutor/reports/${e.id}`),children:"View Details"})]},e.id))})})]})}var E=e.i(785784);e.i(674339);var P=e.i(591768),$=e.i(476319),F=e.i(102955),V=e.i(277193),H=e.i(336566);function z({students:e=[],loading:s}){let t=(0,d.useRouter)(),[a,l]=(0,r.useState)(""),[n,c]=(0,r.useState)({}),[u,m]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let s=!0;return(async()=>{if(0===e.length)return c({});m(!0);try{let e=await fetch("/api/tutor/dashboard/student-progress",{credentials:"include"});if(!e.ok)return;let t=await e.json(),a=Array.isArray(t.students)?t.students:[];if(!s)return;let l={};for(let e of a)"string"==typeof e?.studentId&&(l[e.studentId]=e);c(l)}catch{}finally{s&&m(!1)}})(),()=>{s=!1}},[e]);let h=(0,r.useMemo)(()=>{let s=a.trim().toLowerCase();return s?e.filter(e=>e.name.toLowerCase().includes(s)||e.email.toLowerCase().includes(s)):e},[a,e]),g=(0,r.useMemo)(()=>{let s=e.map(e=>n[e.id]).filter(e=>!!e);return 0===s.length?{avgProgress:0,avgEngagement:0,riskCount:0}:{avgProgress:Math.round(s.reduce((e,s)=>e+s.overallProgress,0)/s.length),avgEngagement:Math.round(s.reduce((e,s)=>e+s.engagementRate,0)/s.length),riskCount:s.filter(e=>"high"===e.recentRisk).length}},[e,n]);return s?(0,i.jsx)(k.Card,{children:(0,i.jsx)(k.CardContent,{className:"p-6",children:(0,i.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,i.jsx)("div",{className:"h-20 bg-gray-100 rounded animate-pulse"},e))})})}):(0,i.jsxs)(k.Card,{children:[(0,i.jsxs)(k.CardHeader,{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)(k.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,i.jsx)($.TrendingUp,{className:"w-5 h-5 text-blue-500"}),"Student Progress"]}),g.riskCount>0&&(0,i.jsxs)(E.Badge,{variant:"destructive",className:"gap-1",children:[(0,i.jsx)(H.AlertTriangle,{className:"w-3 h-3"}),g.riskCount," at risk"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center",children:[(0,i.jsxs)("div",{className:"rounded-lg bg-blue-50 p-2",children:[(0,i.jsxs)("p",{className:"text-lg font-bold text-blue-700",children:[g.avgProgress,"%"]}),(0,i.jsx)("p",{className:"text-xs text-blue-600",children:"Avg progress"})]}),(0,i.jsxs)("div",{className:"rounded-lg bg-green-50 p-2",children:[(0,i.jsxs)("p",{className:"text-lg font-bold text-green-700",children:[g.avgEngagement,"%"]}),(0,i.jsx)("p",{className:"text-xs text-green-600",children:"Engagement"})]}),(0,i.jsxs)("div",{className:"rounded-lg bg-purple-50 p-2",children:[(0,i.jsx)("p",{className:"text-lg font-bold text-purple-700",children:e.length}),(0,i.jsx)("p",{className:"text-xs text-purple-600",children:"Students"})]})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(F.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,i.jsx)(j.Input,{value:a,onChange:e=>l(e.target.value),placeholder:"Search students",className:"pl-9"})]})]}),(0,i.jsxs)(k.CardContent,{className:"space-y-3",children:[0===h.length?(0,i.jsx)("p",{className:"text-sm text-muted-foreground py-6 text-center",children:"No students found."}):h.map(e=>{var s;let a=n[e.id];return(0,i.jsxs)("div",{className:"rounded-lg border p-3 space-y-2",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,i.jsxs)("div",{className:"min-w-0",children:[(0,i.jsx)("p",{className:"font-medium truncate",children:e.name}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.email})]}),a?"high"===(s=a.recentRisk)?(0,i.jsx)(E.Badge,{variant:"destructive",children:"Needs attention"}):"medium"===s?(0,i.jsx)(E.Badge,{variant:"secondary",children:"Watch"}):(0,i.jsx)(E.Badge,{variant:"outline",children:"Stable"}):(0,i.jsx)(E.Badge,{variant:"outline",children:"No metrics yet"})]}),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,i.jsx)("span",{children:"Progress"}),(0,i.jsxs)("span",{children:[a?.overallProgress??0,"%"]})]}),(0,i.jsx)(P.Progress,{value:a?.overallProgress??0,className:"h-2"})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,i.jsxs)("span",{children:["Courses: ",e.courseCount]}),(0,i.jsxs)("span",{children:["Classes: ",e.classCount]}),(0,i.jsxs)("span",{children:["Score: ",a?.averageScore??0,"%"]})]}),(0,i.jsx)("div",{className:"flex justify-end",children:(0,i.jsxs)(o.Button,{size:"sm",variant:"outline",onClick:()=>t.push(`/tutor/reports/${e.id}`),children:[(0,i.jsx)(V.ExternalLink,{className:"h-3.5 w-3.5 mr-1"}),"Open Report"]})})]},e.id)}),u&&(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"Refreshing metrics…"})]})]})}e.i(156155);var W=e.i(390553),U=e.i(214371),G=e.i(980014);let J={messages:[{id:"1",studentId:"s1",studentName:"Alice Zhang",subject:"Question about homework",content:"Hi, I'm having trouble understanding problem 3 from yesterday's assignment. Could you explain the concept of derivatives again?",timestamp:new Date(Date.now()-18e5).toISOString(),isRead:!1,isStarred:!0,priority:"high",course:"Advanced Mathematics",type:"message",labels:["homework","urgent"],replyCount:2,attachments:[]},{id:"2",studentId:"s2",studentName:"Bob Li",subject:"Missed class notification",content:"I won't be able to attend tomorrow's class due to a family event. Will there be a recording available?",timestamp:new Date(Date.now()-72e5).toISOString(),isRead:!1,isStarred:!1,priority:"normal",course:"Physics 101",type:"message",labels:["attendance"],attachments:[]},{id:"3",studentId:"s3",studentName:"Carol Wang",subject:"Thank you!",content:"Just wanted to say thanks for the extra help yesterday. I finally understood the concept!",timestamp:new Date(Date.now()-18e6).toISOString(),isRead:!0,isStarred:!1,priority:"low",course:"English Literature",type:"message",readAt:new Date(Date.now()-144e5).toISOString(),labels:["feedback"],attachments:[]},{id:"4",studentId:"system",studentName:"System",subject:"New student enrolled",content:"A new student has enrolled in your Advanced Mathematics course.",timestamp:new Date(Date.now()-864e5).toISOString(),isRead:!0,isStarred:!1,priority:"normal",type:"system",attachments:[]},{id:"5",studentId:"s4",studentName:"David Chen",subject:"Assignment extension request",content:"I'm facing some technical issues with my laptop. Could I get a 2-day extension for the upcoming assignment?",timestamp:new Date(Date.now()-1728e5).toISOString(),isRead:!0,isStarred:!0,priority:"high",course:"Advanced Mathematics",type:"message",labels:["extension","technical"],attachments:[{id:"a1",name:"error-screenshot.png",type:"image",url:"#",size:1024e3}]},{id:"6",studentId:"s5",studentName:"Emma Liu",subject:"Voice message",content:"[Voice message]",timestamp:new Date(Date.now()-9e5).toISOString(),isRead:!1,isStarred:!1,priority:"normal",course:"Physics 101",type:"message",voiceUrl:"#",voiceDuration:45,attachments:[]}],templates:[{id:"1",title:"Welcome Message",content:"Welcome to the course! I'm excited to have you join us. If you have any questions, feel free to reach out.",category:"general"},{id:"2",title:"Assignment Reminder",content:"Just a friendly reminder that the assignment is due tomorrow. Let me know if you need any help!",category:"reminder"},{id:"3",title:"Great Work!",content:"Excellent work on the recent assignment! Your understanding of the concepts has really improved.",category:"feedback"},{id:"4",title:"Class Cancellation",content:"Unfortunately, tomorrow's class is cancelled due to unforeseen circumstances. We'll reschedule soon.",category:"course"},{id:"5",title:"Technical Support",content:"I understand you're experiencing technical difficulties. Let's troubleshoot this together.",category:"technical"}],quickReplies:[{id:"1",title:"Thank you",content:"Thank you for reaching out!",shortcut:"/ty"},{id:"2",title:"Will check",content:"I'll look into this and get back to you shortly.",shortcut:"/check"},{id:"3",title:"Great job",content:"Great work! Keep it up!",shortcut:"/great"},{id:"4",title:"See you in class",content:"Looking forward to seeing you in class!",shortcut:"/class"}],labels:[{id:"homework",name:"Homework",color:"bg-blue-100 text-blue-700 border-blue-200"},{id:"urgent",name:"Urgent",color:"bg-red-100 text-red-700 border-red-200"},{id:"feedback",name:"Feedback",color:"bg-green-100 text-green-700 border-green-200"},{id:"technical",name:"Technical",color:"bg-purple-100 text-purple-700 border-purple-200"},{id:"attendance",name:"Attendance",color:"bg-yellow-100 text-yellow-700 border-yellow-200"},{id:"extension",name:"Extension",color:"bg-orange-100 text-orange-700 border-orange-200"}],searchQuery:"",filter:"all",selectedMessage:null,selectedMessages:new Set,showMultiSelect:!1,showCompose:!1,showTemplates:!1,showAnnouncement:!1,showQuickRepliesManager:!1,showAnalytics:!1,showFilters:!1,replyText:"",showAIReplies:!1,aiReplies:[],isRecordingVoice:!1,voiceRecordingDuration:0,isScheduling:!1,scheduledDate:void 0,scheduledTime:"09:00",showThread:!1,threadMessages:[],typingIndicators:[],presenceStatus:{},isWebSocketConnected:!1,composeTo:"",composeSubject:"",composeMessage:"",composeAttachments:[],selectedLabels:[],composePriority:"normal"};l=(s=(e,s)=>({...J,setMessages:s=>e(e=>{e.messages=s}),addMessage:s=>e(e=>{e.messages.unshift(s)}),updateMessage:(s,t)=>e(e=>{let a=e.messages.findIndex(e=>e.id===s);-1!==a&&(e.messages[a]={...e.messages[a],...t})}),deleteMessage:s=>e(e=>{e.messages=e.messages.filter(e=>e.id!==s)}),setTemplates:s=>e(e=>{e.templates=s}),setQuickReplies:s=>e(e=>{e.quickReplies=s}),setSearchQuery:s=>e(e=>{e.searchQuery=s}),setFilter:s=>e(e=>{e.filter=s}),setSelectedMessage:s=>e(e=>{e.selectedMessage=s}),toggleMessageSelection:s=>e(e=>{let t=new Set(e.selectedMessages);t.has(s)?t.delete(s):t.add(s),e.selectedMessages=t}),setSelectedMessages:s=>e(e=>{e.selectedMessages=s}),setShowMultiSelect:s=>e(e=>{e.showMultiSelect=s}),setShowCompose:s=>e(e=>{e.showCompose=s}),setShowTemplates:s=>e(e=>{e.showTemplates=s}),setShowAnnouncement:s=>e(e=>{e.showAnnouncement=s}),setShowQuickRepliesManager:s=>e(e=>{e.showQuickRepliesManager=s}),setShowAnalytics:s=>e(e=>{e.showAnalytics=s}),setShowFilters:s=>e(e=>{e.showFilters=s}),setReplyText:s=>e(e=>{e.replyText=s}),setShowAIReplies:s=>e(e=>{e.showAIReplies=s}),setAiReplies:s=>e(e=>{e.aiReplies=s}),setIsRecordingVoice:s=>e(e=>{e.isRecordingVoice=s}),setVoiceRecordingDuration:s=>e(e=>{e.voiceRecordingDuration=s}),incrementVoiceDuration:()=>e(e=>{e.voiceRecordingDuration+=1}),setIsScheduling:s=>e(e=>{e.isScheduling=s}),setScheduledDate:s=>e(e=>{e.scheduledDate=s}),setScheduledTime:s=>e(e=>{e.scheduledTime=s}),setShowThread:s=>e(e=>{e.showThread=s}),setThreadMessages:s=>e(e=>{e.threadMessages=s}),addTypingIndicator:s=>e(e=>{e.typingIndicators.push(s)}),removeTypingIndicator:s=>e(e=>{e.typingIndicators=e.typingIndicators.filter(e=>e.userId!==s)}),clearExpiredTypingIndicators:()=>e(e=>{let s=Date.now();e.typingIndicators=e.typingIndicators.filter(e=>s-e.timestamp<3e3)}),setPresenceStatus:s=>e(e=>{e.presenceStatus=s}),updatePresenceStatus:(s,t)=>e(e=>{e.presenceStatus[s]=t}),setIsWebSocketConnected:s=>e(e=>{e.isWebSocketConnected=s}),setComposeTo:s=>e(e=>{e.composeTo=s}),setComposeSubject:s=>e(e=>{e.composeSubject=s}),setComposeMessage:s=>e(e=>{e.composeMessage=s}),addComposeAttachment:s=>e(e=>{e.composeAttachments.push(s)}),removeComposeAttachment:s=>e(e=>{e.composeAttachments=e.composeAttachments.filter(e=>e.id!==s)}),clearComposeAttachments:()=>e(e=>{e.composeAttachments=[]}),toggleSelectedLabel:s=>e(e=>{e.selectedLabels.includes(s)?e.selectedLabels=e.selectedLabels.filter(e=>e!==s):e.selectedLabels.push(s)}),setSelectedLabels:s=>e(e=>{e.selectedLabels=s}),setComposePriority:s=>e(e=>{e.composePriority=s}),resetComposeForm:()=>e(e=>{e.composeTo="",e.composeSubject="",e.composeMessage="",e.composeAttachments=[],e.selectedLabels=[],e.composePriority="normal"}),bulkMarkAsRead:s=>e(e=>{e.messages.forEach(e=>{s.has(e.id)&&(e.isRead=!0,e.readAt=new Date().toISOString())})}),bulkMarkAsUnread:s=>e(e=>{e.messages.forEach(e=>{s.has(e.id)&&(e.isRead=!1,e.readAt=void 0)})}),bulkToggleStar:s=>e(e=>{e.messages.forEach(e=>{s.has(e.id)&&(e.isStarred=!e.isStarred)})}),bulkDelete:s=>e(e=>{e.messages=e.messages.filter(e=>!s.has(e.id))}),bulkArchive:s=>e(e=>{e.messages.forEach(e=>{s.has(e.id)&&(e.type="message")})}),toggleMessageStar:s=>e(e=>{let t=e.messages.find(e=>e.id===s);t&&(t.isStarred=!t.isStarred),e.selectedMessage?.id===s&&(e.selectedMessage.isStarred=!e.selectedMessage.isStarred)}),markMessageAsRead:s=>e(e=>{let t=e.messages.find(e=>e.id===s);t&&(t.isRead=!0,t.readAt=new Date().toISOString()),e.selectedMessage?.id===s&&(e.selectedMessage.isRead=!0,e.selectedMessage.readAt=new Date().toISOString())}),addLabelToMessage:(s,t)=>e(e=>{let a=e.messages.find(e=>e.id===s);if(a){let e=a.labels||[];e.includes(t)||(a.labels=[...e,t])}if(e.selectedMessage?.id===s){let s=e.selectedMessage.labels||[];s.includes(t)||(e.selectedMessage.labels=[...s,t])}}),removeLabelFromMessage:(s,t)=>e(e=>{let a=e.messages.find(e=>e.id===s);a&&a.labels&&(a.labels=a.labels.filter(e=>e!==t)),e.selectedMessage?.id===s&&e.selectedMessage.labels&&(e.selectedMessage.labels=e.selectedMessage.labels.filter(e=>e!==t))}),translateMessage:(s,t,a)=>e(e=>{let l=e.messages.find(e=>e.id===s);l&&(l.translatedContent=t,l.translatedFrom=a),e.selectedMessage?.id===s&&(e.selectedMessage.translatedContent=t,e.selectedMessage.translatedFrom=a)}),reset:()=>e(()=>({...J}))}),(e,t,a)=>(a.setState=(s,t,...a)=>e("function"==typeof s?(0,G.produce)(s):s,t,...a),s(a.setState,t,a))),t=(0,U.createStore)(l),Object.assign(a=e=>(function(e,s=e=>e){let t=r.default.useSyncExternalStore(e.subscribe,r.default.useCallback(()=>s(e.getState()),[e,s]),r.default.useCallback(()=>s(e.getInitialState()),[e,s]));return r.default.useDebugValue(t),t})(t,e),t),e.i(671869),e.i(182126);var Q=e.i(1115);Q.Root,Q.Trigger,r.forwardRef(({className:e,align:s="center",sideOffset:t=4,...a},l)=>(0,i.jsx)(Q.Portal,{children:(0,i.jsx)(Q.Content,{ref:l,align:s,sideOffset:t,className:(0,W.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})})).displayName=Q.Content.displayName,e.i(871764);var q=e.i(311679),X=e.i(396233),Y=e.i(924383),K=e.i(755142),Z=e.i(621053),_=e.i(642304),ee=e.i(855437);function es({stats:e,loading:s,onScheduleClass:t,onCreateCourse:a}){let[l,n]=(0,r.useState)("Good morning"),[d,c]=(0,r.useState)(new Date);return((0,r.useEffect)(()=>{let e=new Date().getHours();e<12?n("Good morning"):e<18?n("Good afternoon"):n("Good evening");let s=setInterval(()=>c(new Date),6e4);return()=>clearInterval(s)},[]),s)?(0,i.jsx)("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-8",children:(0,i.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,i.jsx)("div",{className:"h-8 bg-white/10 rounded w-1/3"}),(0,i.jsx)("div",{className:"h-4 bg-white/10 rounded w-1/4"}),(0,i.jsx)("div",{className:"grid grid-cols-4 gap-4 mt-8",children:[1,2,3,4].map(e=>(0,i.jsx)("div",{className:"h-24 bg-white/10 rounded-xl"},e))})]})}):(0,i.jsxs)("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-8",children:[(0,i.jsxs)("div",{className:"absolute inset-0 opacity-30",children:[(0,i.jsx)("div",{className:"absolute top-0 left-0 w-96 h-96 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl animate-pulse"}),(0,i.jsx)("div",{className:"absolute top-0 right-0 w-96 h-96 bg-blue-500 rounded-full mix-blend-multiply filter blur-3xl animate-pulse delay-1000"}),(0,i.jsx)("div",{className:"absolute bottom-0 left-1/2 w-96 h-96 bg-pink-500 rounded-full mix-blend-multiply filter blur-3xl animate-pulse delay-2000"})]}),(0,i.jsxs)("div",{className:"relative z-10",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between mb-8",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,i.jsx)(K.Sparkles,{className:"w-5 h-5 text-yellow-400"}),(0,i.jsxs)("span",{className:"text-purple-300 text-sm font-medium",children:[l,", Tutor"]})]}),(0,i.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"Welcome Back!"}),(0,i.jsxs)("p",{className:"text-slate-400",children:[d.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})," • ",d.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})]})]}),(0,i.jsx)("div",{className:"flex items-center gap-3",children:(0,i.jsxs)(E.Badge,{className:"bg-white/10 text-white border-white/20 backdrop-blur-sm",children:[(0,i.jsx)(_.Activity,{className:"w-3 h-3 mr-1"}),"Live"]})})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[(0,i.jsx)(et,{icon:T.BookOpen,label:"Total Classes",value:e?.totalClasses||0,trend:"+12%",trendUp:!0,color:"from-blue-500 to-cyan-500"}),(0,i.jsx)(et,{icon:X.Users,label:"Active Students",value:e?.totalStudents||0,trend:"+8%",trendUp:!0,color:"from-purple-500 to-pink-500"}),(0,i.jsx)(et,{icon:q.Calendar,label:"Upcoming",value:e?.upcomingClasses||0,sublabel:"This week",color:"from-orange-500 to-red-500"}),(0,i.jsx)(et,{icon:Y.DollarSign,label:"Earnings",value:`${e?.currency||"SGD"} ${(e?.earnings||0).toLocaleString()}`,trend:"+23%",trendUp:!0,color:"from-green-500 to-emerald-500"})]}),(0,i.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,i.jsxs)(o.Button,{className:"bg-white text-slate-900 hover:bg-white/90 font-medium shadow-lg",onClick:t,children:[(0,i.jsx)(q.Calendar,{className:"w-4 h-4 mr-2"}),"Schedule Class",(0,i.jsx)(Z.ArrowRight,{className:"w-4 h-4 ml-2"})]}),(0,i.jsxs)(o.Button,{className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600 font-medium shadow-lg border-0",onClick:a,children:[(0,i.jsx)(ee.Award,{className:"w-4 h-4 mr-2"}),"Create Course"]}),(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[(0,i.jsx)(D.Clock,{className:"w-4 h-4"}),(0,i.jsx)("span",{children:"Next class in 2h 15m"})]})]})]})]})}function et({icon:e,label:s,value:t,sublabel:a,trend:l,trendUp:r,color:n}){return(0,i.jsxs)("div",{className:"group relative overflow-hidden rounded-2xl bg-white/5 backdrop-blur-sm border border-white/10 p-4 hover:bg-white/10 transition-all cursor-pointer",children:[(0,i.jsx)("div",{className:(0,W.cn)("absolute top-0 right-0 w-20 h-20 bg-gradient-to-br opacity-20 rounded-bl-full",n)}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("div",{className:(0,W.cn)("w-10 h-10 rounded-xl bg-gradient-to-br flex items-center justify-center mb-3",n),children:(0,i.jsx)(e,{className:"w-5 h-5 text-white"})}),(0,i.jsx)("p",{className:"text-slate-400 text-xs font-medium mb-1",children:s}),(0,i.jsxs)("div",{className:"flex items-end justify-between",children:[(0,i.jsx)("p",{className:"text-2xl font-bold text-white",children:t}),a&&(0,i.jsx)("p",{className:"text-slate-400 text-xs",children:a}),l&&(0,i.jsxs)("div",{className:(0,W.cn)("flex items-center text-xs font-medium",r?"text-green-400":"text-red-400"),children:[(0,i.jsx)($.TrendingUp,{className:(0,W.cn)("w-3 h-3 mr-0.5",!r&&"rotate-180")}),l]})]})]})]})}function ea({children:e,title:s,icon:t,className:a,headerClassName:l,gradient:r="none",badge:n,action:d}){return(0,i.jsxs)(k.Card,{className:(0,W.cn)("overflow-hidden bg-white/80 backdrop-blur-xl border","none"!==r&&`bg-gradient-to-br ${({purple:"from-purple-500/10 to-pink-500/10 border-purple-200/50",blue:"from-blue-500/10 to-cyan-500/10 border-blue-200/50",green:"from-green-500/10 to-emerald-500/10 border-green-200/50",orange:"from-orange-500/10 to-amber-500/10 border-orange-200/50",pink:"from-pink-500/10 to-rose-500/10 border-pink-200/50",none:"border-gray-200"})[r]}`,a),children:[s&&(0,i.jsx)(k.CardHeader,{className:(0,W.cn)("pb-3",l),children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[t&&(0,i.jsx)("div",{className:(0,W.cn)("w-8 h-8 rounded-lg flex items-center justify-center","purple"===r?"bg-purple-100 text-purple-600":"blue"===r?"bg-blue-100 text-blue-600":"green"===r?"bg-green-100 text-green-600":"orange"===r?"bg-orange-100 text-orange-600":"pink"===r?"bg-pink-100 text-pink-600":"bg-gray-100 text-gray-600"),children:(0,i.jsx)(t,{className:"w-4 h-4"})}),(0,i.jsx)(k.CardTitle,{className:"text-base font-semibold",children:s}),void 0!==n&&(0,i.jsx)("span",{className:(0,W.cn)("px-2 py-0.5 rounded-full text-xs font-medium","purple"===r?"bg-purple-100 text-purple-700":"blue"===r?"bg-blue-100 text-blue-700":"green"===r?"bg-green-100 text-green-700":"orange"===r?"bg-orange-100 text-orange-700":"pink"===r?"bg-pink-100 text-pink-700":"bg-gray-100 text-gray-700"),children:n})]}),d&&(0,i.jsx)("div",{children:d})]})}),(0,i.jsx)(k.CardContent,{className:(0,W.cn)("pt-0",!s&&"pt-6"),children:e})]})}var el=e.i(913674),ei=e.i(849862),er=e.i(20478),en=e.i(409455),ed=e.i(143794),ec=e.i(194765),eo=e.i(956208);let eu=(0,e.i(879191).default)("repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);var em=e.i(25125),eh=e.i(298861),eg=e.i(63963),ex=e.i(145451),ep=e.i(751918),ej=e.i(455693);let eb=[{name:"Mathematics",color:"bg-blue-500"},{name:"Physics",color:"bg-purple-500"},{name:"English",color:"bg-green-500"},{name:"Chemistry",color:"bg-orange-500"},{name:"Biology",color:"bg-pink-500"},{name:"History",color:"bg-red-500"},{name:"Office Hours",color:"bg-gray-500"}];function ev({event:e,onClick:s,hasConflict:t,style:a={}}){let{attributes:l,listeners:r,setNodeRef:n,transform:d,isDragging:c}=(0,ei.useDraggable)({id:e.id,data:{event:e}}),o=er.CSS.Transform.toString(d);return(0,i.jsxs)("div",{ref:n,...r,...l,style:{...a,transform:o,opacity:c?.5:1,cursor:"grab"},className:(0,W.cn)("absolute left-1 right-1 rounded p-2 cursor-pointer text-xs overflow-hidden group",e.color||"bg-blue-500","cancelled"===e.status&&"opacity-50",t&&"ring-2 ring-red-500 ring-offset-1"),onClick:e=>{e.stopPropagation(),s()},children:[(0,i.jsxs)("div",{className:"flex items-start justify-between",children:[(0,i.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,i.jsx)("p",{className:"font-medium text-white truncate",children:e.title}),(0,i.jsx)("p",{className:"text-white/80",children:e.date.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),(0,i.jsx)(eh.GripVertical,{className:"w-3 h-3 text-white/50 opacity-0 group-hover:opacity-100 transition-opacity"})]}),t&&(0,i.jsx)(H.AlertTriangle,{className:"w-3 h-3 text-white absolute top-1 right-1"})]})}function ef({events:e,onEventClick:s,onDateClick:t,onCreateClass:a,onEventUpdate:l,loading:n}){let[d,c]=(0,r.useState)(e||(()=>{let e=new Date,s=[],t=[{title:"Advanced Mathematics",subject:"Mathematics",duration:60,students:12,max:20,day:1,time:14,color:"bg-blue-500",isRecurring:!0,pattern:"weekly"},{title:"Physics 101",subject:"Physics",duration:90,students:8,max:15,day:2,time:16,color:"bg-purple-500",isRecurring:!0,pattern:"weekly"},{title:"English Literature",subject:"English",duration:60,students:15,max:25,day:3,time:14,color:"bg-green-500",isRecurring:!0,pattern:"weekly"},{title:"Chemistry Lab",subject:"Chemistry",duration:120,students:6,max:10,day:4,time:15,color:"bg-orange-500",isRecurring:!0,pattern:"weekly"},{title:"Office Hours",subject:"Office Hours",duration:60,students:0,max:5,day:5,time:17,color:"bg-gray-500",type:"office_hours",isRecurring:!0,pattern:"weekly"}];for(let a=0;a<4;a++)t.forEach((t,l)=>{let i=new Date(e);i.setDate(e.getDate()-e.getDay()+t.day+7*a),i.setHours(t.time,0,0,0),i>=new Date(e.getTime()-6048e5)&&s.push({id:`recurring-${a}-${l}`,title:t.title,date:i,duration:t.duration,type:t.type||"class",status:i<e?"completed":"scheduled",studentCount:t.students,maxStudents:t.max,subject:t.subject,isOnline:Math.random()>.3,description:`Regular ${t.pattern} class session`,color:t.color,isRecurring:t.isRecurring,recurringPattern:t.pattern})});return s.push({id:"special-1",title:"Parent-Teacher Meeting",date:new Date(e.getTime()+1728e5),duration:60,type:"personal",status:"scheduled",subject:"Office Hours",color:"bg-red-500"}),s})()),[u,h]=(0,r.useState)([{id:"1",dayOfWeek:1,startTime:"09:00",endTime:"12:00",isAvailable:!0},{id:"2",dayOfWeek:1,startTime:"14:00",endTime:"18:00",isAvailable:!0},{id:"3",dayOfWeek:2,startTime:"09:00",endTime:"12:00",isAvailable:!0},{id:"4",dayOfWeek:2,startTime:"14:00",endTime:"18:00",isAvailable:!0},{id:"5",dayOfWeek:3,startTime:"09:00",endTime:"12:00",isAvailable:!0},{id:"6",dayOfWeek:3,startTime:"14:00",endTime:"18:00",isAvailable:!0},{id:"7",dayOfWeek:4,startTime:"09:00",endTime:"12:00",isAvailable:!0},{id:"8",dayOfWeek:4,startTime:"14:00",endTime:"18:00",isAvailable:!0},{id:"9",dayOfWeek:5,startTime:"09:00",endTime:"12:00",isAvailable:!0},{id:"10",dayOfWeek:5,startTime:"14:00",endTime:"17:00",isAvailable:!0}]),[j,b]=(0,r.useState)(new Date),[v,y]=(0,r.useState)("month"),[N,w]=(0,r.useState)(null),[S,C]=(0,r.useState)(null),[T,M]=(0,r.useState)("all"),[R,L]=(0,r.useState)("all"),[B,O]=(0,r.useState)([]),[P,$]=(0,r.useState)([]),[F,z]=(0,r.useState)(!1),[U,G]=(0,r.useState)(!1),[J,Q]=(0,r.useState)(null),[Y,K]=(0,r.useState)([{id:"1",provider:"google",connected:!1,syncEnabled:!0},{id:"2",provider:"outlook",connected:!1,syncEnabled:!0},{id:"3",provider:"apple",connected:!1,syncEnabled:!1}]),Z=(0,ei.useSensors)((0,ei.useSensor)(ei.PointerSensor,{activationConstraint:{distance:8}}),(0,ei.useSensor)(ei.KeyboardSensor,{coordinateGetter:e=>{let{active:s}=e,t=s?.rect?.current?.translated;return t?{x:t.left,y:t.top}:{x:0,y:0}}}));(0,r.useEffect)(()=>{let e=[];d.forEach((s,t)=>{d.forEach((a,l)=>{if(!(t>=l)&&s.date.toDateString()===a.date.toDateString()){let t=s.date.getTime(),l=t+6e4*s.duration,i=a.date.getTime();t<i+6e4*a.duration&&l>i&&e.push(s,a)}})});let s=Array.from(new Set(e));s.length>0&&O(s)},[d]),(0,r.useEffect)(()=>{let e=d.filter(e=>{let s=e.date.getTime()-new Date().getTime();return s>0&&s<864e5&&"scheduled"===e.status});e.length>0&&$(e.map(e=>`${e.title} at ${e.date.toLocaleTimeString()}`))},[d]);let _=(0,r.useMemo)(()=>d.filter(e=>{let s="all"===T||e.subject===T,t="all"===R||e.type===R;return s&&t}),[d,T,R]),ee=(0,r.useMemo)(()=>{let e=j.getFullYear(),s=j.getMonth(),t=new Date(e,s,1),a=new Date(e,s+1,0).getDate(),l=t.getDay(),i=[];for(let e=0;e<l;e++)i.push(null);for(let t=1;t<=a;t++)i.push(new Date(e,s,t));return i},[j]),es=e=>_.filter(s=>new Date(s.date).toDateString()===e.toDateString()).sort((e,s)=>e.date.getTime()-s.date.getTime()),et=e=>{b(new Date(j.getFullYear(),j.getMonth()+e,1))},ea=e=>{C(e),t?.(e)},er=e=>{w(e),s?.(e)},eh=(0,r.useCallback)(e=>{let{active:s}=e,t=d.find(e=>e.id===s.id);t&&Q(t)},[d]),eg=(0,r.useCallback)(e=>{let{active:s,over:t}=e;if(t&&s.id!==t.id){let e=d.find(e=>e.id===s.id),a=t.data.current;if(e&&a?.date){let s=new Date(a.date);void 0!==a.hour?s.setHours(a.hour,e.date.getMinutes(),0,0):s.setHours(e.date.getHours(),e.date.getMinutes(),0,0);let t={...e,date:s};c(s=>s.map(s=>s.id===e.id?t:s)),l?.(t),x.toast.success(`Rescheduled: ${e.title} to ${(0,ej.format)(s,"MMM d, h:mm a")}`)}}Q(null)},[d,l]);return n?(0,i.jsx)(k.Card,{className:"h-[600px]",children:(0,i.jsx)(k.CardContent,{className:"flex items-center justify-center h-full",children:(0,i.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full"})})}):(0,i.jsx)(ei.DndContext,{sensors:Z,collisionDetection:ei.closestCorners,onDragStart:eh,onDragEnd:eg,children:(0,i.jsxs)(k.Card,{className:"h-full",children:[(0,i.jsxs)(k.CardHeader,{className:"pb-3",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[(0,i.jsxs)(k.CardTitle,{className:"text-xl flex items-center gap-2",children:[(0,i.jsx)(q.Calendar,{className:"w-5 h-5 text-blue-500"}),"Calendar",P.length>0&&(0,i.jsxs)(E.Badge,{variant:"destructive",className:"text-xs",children:[(0,i.jsx)(eo.Bell,{className:"w-3 h-3 mr-1"}),P.length]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(o.Button,{variant:"outline",size:"icon",onClick:()=>et(-1),children:(0,i.jsx)(en.ChevronLeft,{className:"w-4 h-4"})}),(0,i.jsxs)("h2",{className:"text-lg font-semibold min-w-[150px] text-center",children:[["January","February","March","April","May","June","July","August","September","October","November","December"][j.getMonth()]," ",j.getFullYear()]}),(0,i.jsx)(o.Button,{variant:"outline",size:"icon",onClick:()=>et(1),children:(0,i.jsx)(m.ChevronRight,{className:"w-4 h-4"})})]}),(0,i.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>{b(new Date)},children:"Today"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>G(!0),children:[(0,i.jsx)(ex.RefreshCw,{className:(0,W.cn)("w-4 h-4 mr-2",Y.some(e=>e.connected)&&"text-green-500")}),"Sync"]}),(0,i.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>z(!0),children:[(0,i.jsx)(ep.Layers,{className:"w-4 h-4 mr-2"}),"Batch"]}),(0,i.jsxs)(f.Select,{value:T,onValueChange:M,children:[(0,i.jsxs)(f.SelectTrigger,{className:"w-36",children:[(0,i.jsx)(ec.Filter,{className:"w-4 h-4 mr-2"}),(0,i.jsx)(f.SelectValue,{placeholder:"Filter"})]}),(0,i.jsxs)(f.SelectContent,{children:[(0,i.jsx)(f.SelectItem,{value:"all",children:"All Subjects"}),eb.map(e=>(0,i.jsx)(f.SelectItem,{value:e.name,children:e.name},e.name))]})]}),(0,i.jsx)("div",{className:"flex bg-gray-100 rounded-lg p-1",children:["month","week","day","availability"].map(e=>(0,i.jsx)("button",{onClick:()=>y(e),className:(0,W.cn)("px-3 py-1 rounded-md text-sm font-medium transition-colors capitalize",v===e?"bg-white shadow-sm":"text-gray-600 hover:text-gray-900"),children:"availability"===e?"My Availability":e},e))}),(0,i.jsxs)(o.Button,{onClick:()=>a?.(S||new Date),children:[(0,i.jsx)(A.Plus,{className:"w-4 h-4 mr-2"}),"Add"]})]})]}),B.length>0&&(0,i.jsxs)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3",children:[(0,i.jsx)(H.AlertTriangle,{className:"w-5 h-5 text-red-500"}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsxs)("p",{className:"text-sm font-medium text-red-800",children:[B.length/2," scheduling conflicts detected"]}),(0,i.jsx)("p",{className:"text-xs text-red-600",children:'Some classes overlap in time. Drag events to reschedule or click "View" to see conflicts.'})]}),(0,i.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>y("week"),children:"View"}),(0,i.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>O([]),children:(0,i.jsx)(g.X,{className:"w-4 h-4"})})]}),(0,i.jsxs)("div",{className:"flex items-center gap-4 mt-4 text-sm flex-wrap",children:[eb.map(e=>(0,i.jsxs)("button",{onClick:()=>M(T===e.name?"all":e.name),className:(0,W.cn)("flex items-center gap-1 px-2 py-1 rounded-full transition-colors",T===e.name?"bg-gray-200":"hover:bg-gray-100"),children:[(0,i.jsx)("div",{className:(0,W.cn)("w-3 h-3 rounded-full",e.color)}),(0,i.jsx)("span",{children:e.name})]},e.name)),"all"!==T&&(0,i.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>M("all"),children:"Clear Filter"})]})]}),(0,i.jsxs)(k.CardContent,{className:"pt-0",children:["month"===v&&(0,i.jsx)(ew,{days:ee,events:_,onDateClick:ea,onEventClick:er,isToday:e=>e.toDateString()===new Date().toDateString(),getEventsForDate:es,conflicts:B}),"week"===v&&(0,i.jsx)(eS,{currentDate:j,events:_,onEventClick:er,onDateClick:ea,conflicts:B}),"day"===v&&(0,i.jsx)(eC,{currentDate:j,events:_,onEventClick:er,conflicts:B}),"availability"===v&&(0,i.jsx)(ek,{availability:u,onToggle:e=>{h(s=>s.map(s=>s.id===e?{...s,isAvailable:!s.isAvailable}:s))},onSave:()=>{x.toast.success("Availability updated!"),y("month")}})]}),(0,i.jsx)(p.Dialog,{open:!!N,onOpenChange:()=>w(null),children:(0,i.jsx)(p.DialogContent,{className:"sm:max-w-lg",children:N&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.DialogHeader,{children:(0,i.jsxs)("div",{className:"flex items-start justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(p.DialogTitle,{className:"text-xl",children:N.title}),(0,i.jsxs)(p.DialogDescription,{className:"mt-1",children:[N.subject," • ",N.duration," minutes"]})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(E.Badge,{className:(0,W.cn)(N.color||"bg-blue-500"),children:N.type}),N.isRecurring&&(0,i.jsxs)(E.Badge,{variant:"outline",className:"gap-1",children:[(0,i.jsx)(eu,{className:"w-3 h-3"}),N.recurringPattern]})]})]})}),(0,i.jsxs)("div",{className:"space-y-4 py-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,i.jsx)(D.Clock,{className:"w-5 h-5 text-gray-500"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"font-medium",children:N.date.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),(0,i.jsxs)("p",{className:"text-sm text-gray-500",children:[N.date.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})," -",new Date(N.date.getTime()+6e4*N.duration).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})]})]})]}),"class"===N.type&&(0,i.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,i.jsx)(X.Users,{className:"w-5 h-5 text-gray-500"}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"font-medium",children:[N.studentCount," / ",N.maxStudents," students enrolled"]}),(0,i.jsxs)("p",{className:"text-sm text-gray-500",children:[N.maxStudents&&N.studentCount&&N.maxStudents-N.studentCount," spots remaining"]})]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[N.isOnline?(0,i.jsx)(I.Video,{className:"w-5 h-5 text-gray-500"}):(0,i.jsx)(ed.MapPin,{className:"w-5 h-5 text-gray-500"}),(0,i.jsx)("p",{className:"font-medium",children:N.isOnline?"Online Class":"In-Person"})]}),B.find(e=>e.id===N.id)&&(0,i.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 text-red-700 rounded-lg",children:[(0,i.jsx)(H.AlertTriangle,{className:"w-5 h-5"}),(0,i.jsx)("span",{children:"This class has a scheduling conflict!"})]})]}),(0,i.jsxs)(p.DialogFooter,{className:"gap-2",children:[(0,i.jsx)(o.Button,{variant:"outline",onClick:()=>w(null),children:"Close"}),N.isRecurring&&(0,i.jsxs)(o.Button,{variant:"outline",children:[(0,i.jsx)(eu,{className:"w-4 h-4 mr-2"}),"Edit Series"]}),(0,i.jsxs)(o.Button,{className:"bg-gradient-to-r from-purple-600 to-blue-600",onClick:()=>{x.toast.success("Joining class..."),w(null)},children:[(0,i.jsx)(I.Video,{className:"w-4 h-4 mr-2"}),"Join Class"]})]})]})})}),(0,i.jsx)(p.Dialog,{open:!!S&&!N,onOpenChange:()=>C(null),children:(0,i.jsxs)(p.DialogContent,{className:"sm:max-w-md",children:[(0,i.jsxs)(p.DialogHeader,{children:[(0,i.jsx)(p.DialogTitle,{children:S?.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),(0,i.jsxs)(p.DialogDescription,{children:[es(S||new Date).length," events scheduled"]})]}),(0,i.jsxs)("div",{className:"space-y-3 py-4",children:[es(S||new Date).map(e=>(0,i.jsx)("div",{className:"p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>{C(null),er(e)},children:(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:(0,W.cn)("w-3 h-3 rounded-full",e.color||"bg-blue-500")}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("p",{className:"font-medium",children:e.title}),(0,i.jsx)("p",{className:"text-sm text-gray-500",children:e.date.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),B.find(s=>s.id===e.id)&&(0,i.jsx)(H.AlertTriangle,{className:"w-4 h-4 text-red-500"}),(0,i.jsx)(m.ChevronRight,{className:"w-4 h-4 text-gray-400"})]})},e.id)),0===es(S||new Date).length&&(0,i.jsx)("p",{className:"text-center text-gray-500 py-4",children:"No events scheduled for this day"})]}),(0,i.jsxs)(p.DialogFooter,{children:[(0,i.jsx)(o.Button,{variant:"outline",onClick:()=>C(null),children:"Close"}),(0,i.jsxs)(o.Button,{onClick:()=>{a?.(S||new Date),C(null)},children:[(0,i.jsx)(A.Plus,{className:"w-4 h-4 mr-2"}),"Schedule Class"]})]})]})}),(0,i.jsx)(p.Dialog,{open:U,onOpenChange:G,children:(0,i.jsxs)(p.DialogContent,{className:"sm:max-w-md",children:[(0,i.jsxs)(p.DialogHeader,{children:[(0,i.jsxs)(p.DialogTitle,{className:"flex items-center gap-2",children:[(0,i.jsx)(ex.RefreshCw,{className:"w-5 h-5"}),"Calendar Integrations"]}),(0,i.jsx)(p.DialogDescription,{children:"Sync your schedule with external calendars"})]}),(0,i.jsx)("div",{className:"space-y-4 py-4",children:Y.map(e=>(0,i.jsxs)("div",{className:(0,W.cn)("p-4 border rounded-lg transition-colors",e.connected?"border-green-200 bg-green-50/50":"border-gray-200"),children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsxs)("div",{className:(0,W.cn)("w-10 h-10 rounded-lg flex items-center justify-center","google"===e.provider&&"bg-blue-100 text-blue-600","outlook"===e.provider&&"bg-blue-600 text-white","apple"===e.provider&&"bg-gray-900 text-white"),children:["google"===e.provider&&(0,i.jsx)(q.Calendar,{className:"w-5 h-5"}),"outlook"===e.provider&&(0,i.jsx)(V.ExternalLink,{className:"w-5 h-5"}),"apple"===e.provider&&(0,i.jsx)(q.Calendar,{className:"w-5 h-5"})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"font-medium capitalize",children:[e.provider," Calendar"]}),e.connected?(0,i.jsxs)("p",{className:"text-xs text-green-600 flex items-center gap-1",children:[(0,i.jsx)(em.CheckCircle2,{className:"w-3 h-3"}),"Connected",e.email&&` • ${e.email}`]}):(0,i.jsx)("p",{className:"text-xs text-gray-500",children:"Not connected"})]})]}),(0,i.jsx)("div",{className:"flex items-center gap-2",children:e.connected?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(el.Switch,{checked:e.syncEnabled,onCheckedChange:s=>{K(t=>t.map(t=>t.id===e.id?{...t,syncEnabled:s}:t))}}),(0,i.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>{var s;return s=e.provider,void(K(e=>e.map(e=>e.provider===s?{...e,connected:!1,email:void 0,lastSynced:void 0}:e)),x.toast.success(`Disconnected from ${s}`))},children:(0,i.jsx)(g.X,{className:"w-4 h-4"})})]}):(0,i.jsx)(o.Button,{size:"sm",onClick:()=>{var s;return s=e.provider,void(x.toast.loading(`Connecting to ${s} calendar...`),setTimeout(()=>{K(e=>e.map(e=>e.provider===s?{...e,connected:!0,email:`tutor@${s}.com`,lastSynced:new Date}:e)),x.toast.success(`Connected to ${s} calendar!`)},1500))},children:"Connect"})})]}),e.connected&&e.lastSynced&&(0,i.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Last synced: ",(0,ej.format)(e.lastSynced,"MMM d, h:mm a")]})]},e.id))}),(0,i.jsxs)(p.DialogFooter,{className:"gap-2",children:[(0,i.jsx)(o.Button,{variant:"outline",onClick:()=>G(!1),children:"Close"}),(0,i.jsxs)(o.Button,{onClick:()=>{x.toast.loading("Syncing calendars..."),setTimeout(()=>{K(e=>e.map(e=>e.connected?{...e,lastSynced:new Date}:e)),x.toast.success("Calendars synced!")},2e3)},className:"gap-2",children:[(0,i.jsx)(ex.RefreshCw,{className:"w-4 h-4"}),"Sync All"]})]})]})}),(0,i.jsx)(eD,{open:F,onClose:()=>z(!1),onCreate:e=>{c(s=>[...s,...e]),x.toast.success(`Created ${e.length} classes!`)}}),(0,i.jsx)(ei.DragOverlay,{children:J?(0,i.jsx)("div",{className:(0,W.cn)("p-2 rounded text-xs opacity-90 shadow-lg",J.color||"bg-blue-500"),children:(0,i.jsx)("p",{className:"font-medium text-white",children:J.title})}):null})]})})}function ey({date:e,children:s,className:t}){let{setNodeRef:a,isOver:l}=(0,ei.useDroppable)({id:`day-${(0,ej.format)(e,"yyyy-MM-dd")}`,data:{date:e}});return(0,i.jsx)("div",{ref:a,className:(0,W.cn)(t,l&&"bg-blue-50 ring-2 ring-blue-400 ring-inset"),children:s})}function eN({date:e,hour:s,children:t,className:a}){let{setNodeRef:l,isOver:r}=(0,ei.useDroppable)({id:`hour-${(0,ej.format)(e,"yyyy-MM-dd")}-${s}`,data:{date:e,hour:s}});return(0,i.jsx)("div",{ref:l,className:(0,W.cn)(a,r&&"bg-blue-50/50"),children:t})}function ew({days:e,events:s,onDateClick:t,onEventClick:a,isToday:l,getEventsForDate:r,conflicts:n}){return(0,i.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,i.jsx)("div",{className:"grid grid-cols-7 bg-gray-50 border-b",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,i.jsx)("div",{className:"p-2 text-center text-sm font-medium text-gray-600",children:e},e))}),(0,i.jsx)("div",{className:"grid grid-cols-7",children:e.map((e,s)=>(0,i.jsx)(ey,{date:e||new Date,className:(0,W.cn)("min-h-[100px] p-2 border-r border-b last:border-r-0",!e&&"bg-gray-50/50",e&&"hover:bg-gray-50 cursor-pointer"),children:e&&(0,i.jsxs)("div",{onClick:()=>t(e),children:[(0,i.jsx)("div",{className:(0,W.cn)("text-sm font-medium mb-1 w-7 h-7 flex items-center justify-center rounded-full",l(e)&&"bg-blue-600 text-white"),children:e.getDate()}),(0,i.jsxs)("div",{className:"space-y-1",children:[r(e).slice(0,3).map(e=>{let s=n.find(s=>s.id===e.id);return(0,i.jsx)("div",{className:(0,W.cn)("text-xs p-1.5 rounded cursor-pointer truncate",e.color||"bg-blue-100","cancelled"===e.status&&"opacity-50 line-through",s&&"ring-1 ring-red-400"),onClick:s=>{s.stopPropagation(),a(e)},children:(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)("div",{className:(0,W.cn)("w-1.5 h-1.5 rounded-full",e.color?.replace("bg-","bg-opacity-100 ")||"bg-blue-500")}),(0,i.jsxs)("span",{className:"font-medium truncate",children:[e.date.getHours(),":",e.date.getMinutes().toString().padStart(2,"0")," ",e.title]})]})},e.id)}),r(e).length>3&&(0,i.jsxs)("p",{className:"text-xs text-gray-500 pl-1",children:["+",r(e).length-3," more"]})]})]})},s))})]})}function eS({currentDate:e,events:s,onEventClick:t,onDateClick:a,conflicts:l}){let r=new Date(e);r.setDate(e.getDate()-e.getDay());let n=Array.from({length:7},(e,s)=>{let t=new Date(r);return t.setDate(r.getDate()+s),t}),d=Array.from({length:12},(e,s)=>s+8);return(0,i.jsxs)("div",{className:"flex border rounded-lg overflow-hidden",children:[(0,i.jsxs)("div",{className:"w-16 border-r bg-gray-50",children:[(0,i.jsx)("div",{className:"h-12 border-b"}),d.map(e=>(0,i.jsxs)("div",{className:"h-16 border-b text-xs text-gray-500 text-center pt-2",children:[e,":00"]},e))]}),(0,i.jsx)("div",{className:"flex-1 grid grid-cols-7",children:n.map((e,r)=>(0,i.jsxs)("div",{className:"border-r last:border-r-0",children:[(0,i.jsxs)("div",{className:"h-12 border-b p-2 text-center cursor-pointer hover:bg-gray-50",onClick:()=>a(e),children:[(0,i.jsx)("p",{className:"text-xs text-gray-500",children:e.toLocaleDateString("en-US",{weekday:"short"})}),(0,i.jsx)("p",{className:(0,W.cn)("text-sm font-medium",e.toDateString()===new Date().toDateString()&&"text-blue-600"),children:e.getDate()})]}),(0,i.jsxs)("div",{className:"relative",children:[d.map(s=>(0,i.jsx)(eN,{date:e,hour:s,className:"h-16 border-b"},s)),s.filter(s=>s.date.toDateString()===e.toDateString()).map(e=>{let s=e.date.getHours(),a=e.date.getMinutes(),r=e.duration/60*64,n=l.find(s=>s.id===e.id);return(0,i.jsx)(ev,{event:e,onClick:()=>t(e),hasConflict:n,style:{top:`${(s-8)*64+a/60*64}px`,height:`${Math.max(r,32)}px`,position:"absolute"}},e.id)})]})]},r))})]})}function eC({currentDate:e,events:s,onEventClick:t,conflicts:a}){let l=Array.from({length:14},(e,s)=>s+7),r=s.filter(s=>s.date.toDateString()===e.toDateString()).sort((e,s)=>e.date.getTime()-s.date.getTime());return(0,i.jsxs)("div",{className:"flex border rounded-lg overflow-hidden",children:[(0,i.jsx)("div",{className:"w-20 border-r bg-gray-50",children:l.map(e=>(0,i.jsxs)("div",{className:"h-20 border-b px-2 py-2 text-sm text-gray-600 text-right",children:[e,":00"]},e))}),(0,i.jsxs)("div",{className:"flex-1 relative",children:[l.map(s=>(0,i.jsx)(eN,{date:e,hour:s,className:"h-20 border-b"},s)),r.map(e=>{let s=e.date.getHours(),l=e.date.getMinutes(),r=e.duration/60*80,n=a.find(s=>s.id===e.id);return(0,i.jsx)(ev,{event:e,onClick:()=>t(e),hasConflict:n,style:{top:`${(s-7)*80+l/60*80}px`,height:`${Math.max(r,40)}px`,position:"absolute",left:"8px",right:"8px"}},e.id)}),0===r.length&&(0,i.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400",children:(0,i.jsx)("p",{children:"No events scheduled for this day"})})]})]})}function ek({availability:e,onToggle:s,onSave:t}){return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,i.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"Set Your Availability"}),(0,i.jsx)("p",{className:"text-sm text-blue-700",children:"Mark when you're available for classes. Students will only be able to book during these times."})]}),(0,i.jsx)("div",{className:"space-y-4",children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map((t,a)=>(0,i.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,i.jsx)("h4",{className:"font-medium mb-3",children:t}),(0,i.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:e.filter(e=>e.dayOfWeek===a+1).map(e=>(0,i.jsx)("div",{className:(0,W.cn)("p-3 rounded-lg border cursor-pointer transition-all",e.isAvailable?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200 opacity-50"),onClick:()=>s(e.id),children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("span",{className:"font-medium",children:[e.startTime," - ",e.endTime]}),e.isAvailable?(0,i.jsx)(em.CheckCircle2,{className:"w-5 h-5 text-green-500"}):(0,i.jsx)(g.X,{className:"w-5 h-5 text-gray-400"})]})},e.id))})]},t))}),(0,i.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,i.jsx)(o.Button,{variant:"outline",children:"Cancel"}),(0,i.jsx)(o.Button,{onClick:t,className:"bg-gradient-to-r from-green-600 to-emerald-600",children:"Save Availability"})]})]})}function eD({open:e,onClose:s,onCreate:t}){let[a,l]=(0,r.useState)(""),[n,d]=(0,r.useState)("Mathematics"),[c,u]=(0,r.useState)((0,ej.format)(new Date,"yyyy-MM-dd")),[m,h]=(0,r.useState)("14:00"),[g,x]=(0,r.useState)(60),[v,y]=(0,r.useState)("weekly"),[N,w]=(0,r.useState)(4),[S,C]=(0,r.useState)(20),[k,D]=(0,r.useState)(!0);return(0,i.jsx)(p.Dialog,{open:e,onOpenChange:s,children:(0,i.jsxs)(p.DialogContent,{className:"sm:max-w-lg",children:[(0,i.jsxs)(p.DialogHeader,{children:[(0,i.jsxs)(p.DialogTitle,{className:"flex items-center gap-2",children:[(0,i.jsx)(eg.CalendarPlus,{className:"w-5 h-5"}),"Batch Create Classes"]}),(0,i.jsx)(p.DialogDescription,{children:"Create multiple recurring classes at once"})]}),(0,i.jsxs)("div",{className:"space-y-4 py-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(b.Label,{children:"Class Title"}),(0,i.jsx)(j.Input,{value:a,onChange:e=>l(e.target.value),placeholder:"e.g., Advanced Math"})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(b.Label,{children:"Subject"}),(0,i.jsxs)(f.Select,{value:n,onValueChange:d,children:[(0,i.jsx)(f.SelectTrigger,{children:(0,i.jsx)(f.SelectValue,{})}),(0,i.jsx)(f.SelectContent,{children:eb.filter(e=>"Office Hours"!==e.name).map(e=>(0,i.jsx)(f.SelectItem,{value:e.name,children:e.name},e.name))})]})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(b.Label,{children:"Start Date"}),(0,i.jsx)(j.Input,{type:"date",value:c,onChange:e=>u(e.target.value)})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(b.Label,{children:"Start Time"}),(0,i.jsx)(j.Input,{type:"time",value:m,onChange:e=>h(e.target.value)})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(b.Label,{children:"Duration (min)"}),(0,i.jsx)(j.Input,{type:"number",value:g,onChange:e=>x(Number(e.target.value)),min:15,step:15})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(b.Label,{children:"Max Students"}),(0,i.jsx)(j.Input,{type:"number",value:S,onChange:e=>C(Number(e.target.value)),min:1})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(b.Label,{children:"Occurrences"}),(0,i.jsx)(j.Input,{type:"number",value:N,onChange:e=>w(Number(e.target.value)),min:1,max:52})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(b.Label,{children:"Recurring Pattern"}),(0,i.jsx)("div",{className:"flex gap-2",children:["weekly","biweekly","daily"].map(e=>(0,i.jsx)(o.Button,{type:"button",variant:v===e?"default":"outline",size:"sm",onClick:()=>y(e),className:"flex-1 capitalize",children:"biweekly"===e?"Bi-weekly":e},e))})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(I.Video,{className:"w-4 h-4 text-gray-500"}),(0,i.jsx)("span",{className:"text-sm",children:"Online Class"})]}),(0,i.jsx)(el.Switch,{checked:k,onCheckedChange:D})]}),(0,i.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg text-sm",children:[(0,i.jsx)("p",{className:"font-medium text-blue-900",children:"Preview"}),(0,i.jsxs)("p",{className:"text-blue-700",children:["Will create ",(0,i.jsx)("strong",{children:N})," ",v," classes starting ",(0,i.jsx)("strong",{children:(0,ej.format)(new Date(c),"MMM d, yyyy")})]})]})]}),(0,i.jsxs)(p.DialogFooter,{className:"gap-2",children:[(0,i.jsx)(o.Button,{variant:"outline",onClick:s,children:"Cancel"}),(0,i.jsxs)(o.Button,{onClick:()=>{let e=[],i=new Date(c),[r,d]=m.split(":").map(Number);for(let s=0;s<N;s++){let t=new Date(i);"daily"===v?t.setDate(i.getDate()+s):"weekly"===v?t.setDate(i.getDate()+7*s):"biweekly"===v&&t.setDate(i.getDate()+14*s),t.setHours(r,d,0,0);let l=eb.find(e=>e.name===n)?.color||"bg-blue-500";e.push({id:`batch-${Date.now()}-${s}`,title:a||`${n} Class`,date:t,duration:g,type:"class",status:"scheduled",subject:n,maxStudents:S,studentCount:0,isOnline:k,color:l,isRecurring:N>1,recurringPattern:N>1?v:void 0})}t(e),s(),l(""),w(4)},className:"gap-2",children:[(0,i.jsx)(M.Copy,{className:"w-4 h-4"}),"Create ",N," Classes"]})]})]})})}function eT(){return(0,i.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,i.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,i.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/3 animate-pulse"}),(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>(0,i.jsx)("div",{className:"h-24 bg-gray-200 rounded animate-pulse"},e))}),(0,i.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,i.jsx)("div",{className:"lg:col-span-2 space-y-6",children:(0,i.jsx)("div",{className:"h-64 bg-gray-200 rounded animate-pulse"})}),(0,i.jsx)("div",{className:"space-y-6",children:(0,i.jsx)("div",{className:"h-48 bg-gray-200 rounded animate-pulse"})})]})]})})}let eM={totalClasses:0,totalStudents:0,upcomingClasses:0,earnings:0,currency:"SGD"};function eA(){let{data:e}=(0,n.useSession)(),s=(0,d.useSearchParams)(),[t,a]=(0,r.useState)(!1),[l,p]=(0,r.useState)(!1);(0,r.useEffect)(()=>{"1"===s.get("create")&&a(!0),"1"===s.get("course")&&p(!0)},[s]);let[j,b]=(0,r.useState)(eM),[v,f]=(0,r.useState)([]),[y,N]=(0,r.useState)([]),[w,k]=(0,r.useState)([]),[D,T]=(0,r.useState)(!0),[M,A]=(0,r.useState)(null),[I,R]=(0,r.useState)(!0);(0,r.useEffect)(()=>{try{R("1"===localStorage.getItem("tutor-dashboard-one-account-tip-dismissed"))}catch{R(!1)}},[]);let L=(0,r.useCallback)(async()=>{if(e?.user?.id){A(null);try{let[e,s,t,a]=await Promise.allSettled([fetch("/api/tutor/stats",{credentials:"include"}),fetch("/api/tutor/classes",{credentials:"include"}),fetch("/api/tutor/students-needing-attention",{credentials:"include"}),fetch("/api/tutor/students",{credentials:"include"})]),l=[];if("fulfilled"===e.status&&e.value.ok){let s=await e.value.json();b({totalClasses:s.totalClasses??0,totalStudents:s.totalStudents??0,upcomingClasses:s.upcomingClasses??0,earnings:s.earnings??0,currency:s.currency??"SGD"})}else l.push("stats");if("fulfilled"===s.status&&s.value.ok){let e=await s.value.json();f(e.classes??[])}else l.push("classes");if("fulfilled"===t.status&&t.value.ok){let e=await t.value.json();N(e.students??[])}else l.push("students-needing-attention");if("fulfilled"===a.status&&a.value.ok){let e=await a.value.json();k(e.students??[])}else l.push("students");l.length>=2&&A("Failed to load dashboard data")}catch{A("Failed to load dashboard data")}finally{T(!1)}}},[e?.user?.id]);(0,r.useEffect)(()=>{e?.user?.id?(T(!0),L()):T(!1)},[e?.user?.id,L]);let E=(0,r.useCallback)(e=>{if(e){let s={id:e.id,title:e.title||"New Class",subject:e.subject||"",scheduledAt:e.scheduledAt||new Date().toISOString(),duration:e.durationMinutes||60,maxStudents:e.maxStudents||50,enrolledStudents:0,status:e.status||"scheduled"};f(e=>[s,...e]),b(e=>({...e,totalClasses:e.totalClasses+1,upcomingClasses:e.upcomingClasses+1}))}else L()},[L]),P=(0,r.useCallback)(async e=>{try{let s=await fetch("/api/csrf",{credentials:"include"}),t=await s.json().catch(()=>({})),a=t?.token??null,l=await fetch(`/api/tutor/classes/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json",...a&&{"X-CSRF-Token":a}},credentials:"include"});if(l.ok)f(s=>s.filter(s=>s.id!==e)),b(e=>({...e,totalClasses:Math.max(0,e.totalClasses-1),upcomingClasses:Math.max(0,e.upcomingClasses-1)})),x.toast.success("Class removed successfully");else{let e=await l.json().catch(()=>({}));x.toast.error(e.error||"Failed to remove class")}}catch{x.toast.error("Failed to remove class")}},[]);return(0,i.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[!I&&(0,i.jsxs)("div",{className:"mb-4 p-3 rounded-lg bg-slate-50 border border-slate-200 flex items-start gap-2",children:[(0,i.jsx)(h.Info,{className:"w-4 h-4 text-slate-500 shrink-0 mt-0.5"}),(0,i.jsx)("p",{className:"text-sm text-slate-600 flex-1",children:"Only one account is logged in per browser. Logging in as a different user in another tab will switch the account in all tabs. To use a student account at the same time, use another browser or an incognito window."}),(0,i.jsx)("button",{type:"button",onClick:()=>{R(!0);try{localStorage.setItem("tutor-dashboard-one-account-tip-dismissed","1")}catch{}},className:"p-1 rounded hover:bg-slate-200 text-slate-500","aria-label":"Dismiss",children:(0,i.jsx)(g.X,{className:"w-4 h-4"})})]}),(0,i.jsx)("div",{className:"mb-8",children:(0,i.jsx)(es,{stats:j,loading:D,onScheduleClass:()=>a(!0),onCreateCourse:()=>p(!0)})}),M&&(0,i.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl text-red-800 text-sm",children:[M,(0,i.jsx)(o.Button,{variant:"outline",size:"sm",className:"ml-2",onClick:()=>{T(!0),L()},children:"Retry"})]}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)(B,{classes:v,formatDate:e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),loading:D,onCreateClassClick:()=>a(!0),onRemoveClass:P}),(0,i.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,i.jsx)("div",{className:"lg:col-span-2",children:(0,i.jsxs)(ea,{title:"Course Catalogue",icon:u.Library,gradient:"blue",action:(0,i.jsx)(c.default,{href:"/curriculum",children:(0,i.jsxs)(o.Button,{variant:"ghost",size:"sm",children:["View",(0,i.jsx)(m.ChevronRight,{className:"w-4 h-4 ml-1"})]})}),children:[(0,i.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Browse and manage your courses. Create new courses, then configure curriculum, groups, and schedule for each."}),(0,i.jsx)(c.default,{href:"/curriculum",children:(0,i.jsxs)(o.Button,{variant:"outline",className:"w-full",children:[(0,i.jsx)(u.Library,{className:"w-4 h-4 mr-2"}),"Open Course Catalogue"]})})]})}),(0,i.jsx)("div",{className:"lg:col-span-2",children:(0,i.jsx)(O,{students:y,loading:D})})]}),(0,i.jsx)(z,{loading:D,students:w}),(0,i.jsx)(ef,{onEventClick:e=>console.log("Event clicked:",e),onDateClick:e=>console.log("Date clicked:",e),onCreateClass:e=>a(!0),loading:D}),(0,i.jsx)(S,{open:t,onOpenChange:a,onClassCreated:E,redirectToClass:!1}),(0,i.jsx)(C.CreateCourseDialog,{open:l,onOpenChange:p})]})]})}function eI(){return(0,i.jsx)(r.Suspense,{fallback:(0,i.jsx)(eT,{}),children:(0,i.jsx)(eA,{})})}e.s(["default",()=>eI],276362)}]);

//# debugId=5f75161b-65db-4b70-7f9c-aa1e9a7e2da4
//# sourceMappingURL=e214ebac1ebc8413.js.map