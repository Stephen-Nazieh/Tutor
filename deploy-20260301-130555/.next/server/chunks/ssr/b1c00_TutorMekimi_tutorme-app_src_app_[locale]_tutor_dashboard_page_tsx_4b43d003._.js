;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="76fbb956-0503-5242-a908-3f500c9dffd2")}catch(e){}}();
module.exports=[915704,a=>{"use strict";let b,c,d;var e,f=a.i(260576),g=a.i(741510),h=a.i(326684),i=a.i(454069),j=a.i(52028),k=a.i(88684),l=a.i(318153),m=a.i(892094),n=a.i(118459),o=a.i(656247),p=a.i(846438),q=a.i(263805),r=a.i(981354),s=a.i(529004),t=a.i(763485),u=a.i(206209),v=a.i(479680);let w=[{value:"math",label:"Mathematics"},{value:"physics",label:"Physics"},{value:"chemistry",label:"Chemistry"},{value:"biology",label:"Biology"},{value:"english",label:"English"},{value:"history",label:"History"},{value:"cs",label:"Computer Science"},{value:"ielts",label:"IELTS"},{value:"toefl",label:"TOEFL"}],x=[{value:"6",label:"Grade 6"},{value:"7",label:"Grade 7"},{value:"8",label:"Grade 8"},{value:"9",label:"Grade 9"},{value:"10",label:"Grade 10"},{value:"11",label:"Grade 11"},{value:"12",label:"Grade 12"},{value:"college",label:"College"}];function y({open:a,onOpenChange:b,onClassCreated:c,redirectToClass:d=!0}){let e=(0,i.useRouter)(),[h,j]=(0,g.useState)(!1),[l,m]=(0,g.useState)(null),[n,o]=(0,g.useState)({title:"",subject:"",description:"",gradeLevel:"",maxStudents:50,durationMinutes:60,scheduledAt:""}),y=async()=>{if(!n.title.trim())return void p.toast.error("Please enter a class title");if(!n.subject)return void p.toast.error("Please select a subject");if(!n.gradeLevel)return void p.toast.error("Please select a grade level");if(!n.scheduledAt)return void p.toast.error("Please select date and time");j(!0),m(null);try{let a=new Date(n.scheduledAt);if(Number.isNaN(a.getTime())){let a="Please provide a valid date and time.";m(a),p.toast.error(a);return}let f=await fetch("/api/csrf",{credentials:"include"}),g=await f.json().catch(()=>({})),h=g?.token??null,i=await fetch("/api/class/rooms",{method:"POST",headers:{"Content-Type":"application/json",...h&&{"X-CSRF-Token":h}},credentials:"include",body:JSON.stringify({title:n.title,subject:n.subject,gradeLevel:n.gradeLevel,description:n.description,maxStudents:n.maxStudents,durationMinutes:n.durationMinutes,scheduledAt:a.toISOString()})}),j=await i.text(),k={};if(j)try{k=JSON.parse(j)}catch{k={error:`Request failed (${i.status}): ${j.slice(0,180)}`}}if(i.ok)p.toast.success("Class created successfully!"),b(!1),c?.(k.session),d&&k.session?.id&&e.push(`/tutor/live-class/${k.session.id}`);else{let a=k.error||"Room creation failed. Please try again.";m(a),p.toast.error(a)}}catch(b){let a=b instanceof Error?b.message:"An error occurred. Please check your connection and try again.";m(a),p.toast.error(a)}finally{j(!1)}},z=a=>{h||(a||m(null),b(a))};return(0,f.jsx)(q.Dialog,{open:a,onOpenChange:z,children:(0,f.jsxs)(q.DialogContent,{className:"sm:max-w-[500px]","aria-busy":h,"aria-describedby":l?"create-class-api-error":void 0,children:[(0,f.jsxs)(q.DialogHeader,{children:[(0,f.jsx)(q.DialogTitle,{children:"Create New Class"}),(0,f.jsx)(q.DialogDescription,{children:"Schedule a new live class session for your students."})]}),(0,f.jsxs)("div",{className:"space-y-4 py-4",children:[l&&(0,f.jsx)("p",{id:"create-class-api-error",className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-md px-3 py-2",role:"alert",children:l}),(0,f.jsxs)("div",{children:[(0,f.jsx)(s.Label,{children:"Class Title *"}),(0,f.jsx)(r.Input,{value:n.title,onChange:a=>o({...n,title:a.target.value}),placeholder:"e.g., AP Calculus - Limits",disabled:h,"aria-invalid":!!l})]}),(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)(s.Label,{children:"Subject *"}),(0,f.jsxs)(u.Select,{value:n.subject,onValueChange:a=>o({...n,subject:a}),children:[(0,f.jsx)(u.SelectTrigger,{disabled:h,children:(0,f.jsx)(u.SelectValue,{placeholder:"Select subject"})}),(0,f.jsx)(u.SelectContent,{children:w.map(a=>(0,f.jsx)(u.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)(s.Label,{children:"Grade Level *"}),(0,f.jsxs)(u.Select,{value:n.gradeLevel,onValueChange:a=>o({...n,gradeLevel:a}),children:[(0,f.jsx)(u.SelectTrigger,{disabled:h,children:(0,f.jsx)(u.SelectValue,{placeholder:"Select grade"})}),(0,f.jsx)(u.SelectContent,{children:x.map(a=>(0,f.jsx)(u.SelectItem,{value:a.value,children:a.label},a.value))})]})]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)(s.Label,{children:"Description"}),(0,f.jsx)(t.Textarea,{value:n.description,onChange:a=>o({...n,description:a.target.value}),placeholder:"What will you cover in this class?",disabled:h})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)(s.Label,{children:"Date & Time *"}),(0,f.jsx)(r.Input,{type:"datetime-local",value:n.scheduledAt,onChange:a=>o({...n,scheduledAt:a.target.value}),disabled:h})]}),(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)(s.Label,{children:"Duration (minutes)"}),(0,f.jsxs)(u.Select,{value:n.durationMinutes.toString(),onValueChange:a=>o({...n,durationMinutes:parseInt(a)}),children:[(0,f.jsx)(u.SelectTrigger,{disabled:h,children:(0,f.jsx)(u.SelectValue,{})}),(0,f.jsxs)(u.SelectContent,{children:[(0,f.jsx)(u.SelectItem,{value:"30",children:"30 minutes"}),(0,f.jsx)(u.SelectItem,{value:"60",children:"1 hour"}),(0,f.jsx)(u.SelectItem,{value:"90",children:"1.5 hours"}),(0,f.jsx)(u.SelectItem,{value:"120",children:"2 hours"})]})]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)(s.Label,{children:"Max Students"}),(0,f.jsxs)(u.Select,{value:n.maxStudents.toString(),onValueChange:a=>o({...n,maxStudents:parseInt(a)}),children:[(0,f.jsx)(u.SelectTrigger,{disabled:h,children:(0,f.jsx)(u.SelectValue,{})}),(0,f.jsxs)(u.SelectContent,{children:[(0,f.jsx)(u.SelectItem,{value:"10",children:"10 students"}),(0,f.jsx)(u.SelectItem,{value:"25",children:"25 students"}),(0,f.jsx)(u.SelectItem,{value:"50",children:"50 students"}),(0,f.jsx)(u.SelectItem,{value:"100",children:"100 students"})]})]})]})]})]}),(0,f.jsxs)(q.DialogFooter,{children:[(0,f.jsx)(k.Button,{variant:"outline",onClick:()=>z(!1),disabled:h,children:"Cancel"}),(0,f.jsxs)(k.Button,{onClick:y,disabled:h,"aria-busy":h,children:[h&&(0,f.jsx)(v.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Create Class"]})]})]})})}var z=a.i(708751),A=a.i(113098),B=a.i(50730),C=a.i(342621),D=a.i(36094),E=a.i(595484),F=a.i(927910),G=a.i(143650),H=a.i(709176);function I({classes:a,formatDate:b,loading:c,onCreateClassClick:d,onRemoveClass:e}){return(0,f.jsxs)(A.Card,{children:[(0,f.jsxs)(A.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,f.jsxs)(A.CardTitle,{className:"flex items-center gap-2",title:"Scheduled and active classes",children:[(0,f.jsx)(B.Clock,{className:"w-5 h-5 text-blue-500"}),"My Classes"]}),(0,f.jsx)(j.default,{href:"/tutor/classes",children:(0,f.jsx)(k.Button,{variant:"ghost",size:"sm",children:"View All"})})]}),(0,f.jsx)(A.CardContent,{children:c?(0,f.jsx)("div",{className:"space-y-4","aria-busy":"true",children:[1,2,3].map(a=>(0,f.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,f.jsxs)("div",{className:"flex items-center gap-4",children:[(0,f.jsx)("div",{className:"w-12 h-12 bg-gray-200 rounded-lg animate-pulse"}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)("div",{className:"h-4 w-48 bg-gray-200 rounded animate-pulse"}),(0,f.jsx)("div",{className:"h-3 w-36 bg-gray-200 rounded animate-pulse"}),(0,f.jsx)("div",{className:"h-3 w-24 bg-gray-200 rounded animate-pulse"})]})]}),(0,f.jsx)("div",{className:"h-9 w-24 bg-gray-200 rounded animate-pulse"})]},a))}):0===a.length?(0,f.jsxs)("div",{className:"text-center py-8 px-4 border rounded-lg border-dashed border-gray-300 bg-gray-50/50",children:[(0,f.jsx)("p",{className:"text-gray-600 mb-3",children:"No upcoming classes"}),d&&(0,f.jsxs)(k.Button,{onClick:d,children:[(0,f.jsx)(E.Plus,{className:"w-4 h-4 mr-2"})," Schedule a class"]})]}):(0,f.jsx)("div",{className:"space-y-4",children:a.map(a=>{let b=(0,H.formatClassTime)(a.scheduledAt);return(0,f.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[(0,f.jsxs)("div",{className:"flex items-center gap-4",children:[(0,f.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,f.jsx)(C.BookOpen,{className:"w-6 h-6 text-blue-600"})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("h3",{className:"font-medium",children:a.title}),(0,f.jsxs)("p",{className:"text-sm text-gray-500",children:[a.subject," • ",b.formatted,b.relative&&(0,f.jsxs)("span",{className:"text-blue-600 font-medium",children:[" • ",b.relative]})]}),(0,f.jsxs)("p",{className:"text-xs text-gray-400",children:[a.enrolledStudents,"/",a.maxStudents," students enrolled"]})]})]}),(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)(k.Button,{variant:"outline",size:"sm",onClick:()=>(a.id,void("u">typeof navigator&&navigator.clipboard?.writeText&&navigator.clipboard.writeText("").then(()=>p.toast.success("Join link copied to clipboard")))),title:"Copy join link",children:(0,f.jsx)(D.Copy,{className:"w-4 h-4"})}),(0,f.jsx)(j.default,{href:`/tutor/live-class/${a.id}`,title:"Enter Live Class",children:(0,f.jsxs)(k.Button,{size:"sm",className:"bg-gradient-to-r from-purple-600 to-blue-600",children:[(0,f.jsx)(F.Video,{className:"w-4 h-4 mr-1"}),"Enter Room"]})}),e&&(0,f.jsx)(k.Button,{variant:"ghost",size:"sm",onClick:()=>e(a.id),title:"Remove class",className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:(0,f.jsx)(G.Trash2,{className:"w-4 h-4"})})]})]},a.id)})})})]})}function J({students:a,loading:b}){let c=(0,i.useRouter)();return(0,f.jsxs)(A.Card,{children:[(0,f.jsx)(A.CardHeader,{children:(0,f.jsx)(A.CardTitle,{children:"Students Needing Attention"})}),(0,f.jsx)(A.CardContent,{children:b?(0,f.jsx)("div",{className:"space-y-3","aria-busy":"true",children:[1,2,3].map(a=>(0,f.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-200 animate-pulse"}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}),(0,f.jsx)("div",{className:"h-3 w-40 bg-gray-200 rounded animate-pulse"})]})]}),(0,f.jsx)("div",{className:"h-8 w-20 bg-gray-200 rounded animate-pulse"})]},a))}):0===a.length?(0,f.jsx)("p",{className:"text-sm text-gray-500 py-4 text-center",children:"No students need attention right now."}):(0,f.jsx)("div",{className:"space-y-3",children:a.map(a=>(0,f.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-semibold bg-gray-100 text-gray-700",children:a.initial}),(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"font-medium",children:a.name}),(0,f.jsx)("p",{className:"text-sm text-gray-600",children:a.issue})]})]}),(0,f.jsx)(k.Button,{size:"sm",variant:"outline",onClick:()=>c.push(`/tutor/reports/${a.id}`),children:"View Details"})]},a.id))})})]})}var K=a.i(333340);a.i(185407);var L=a.i(724403),M=a.i(844194),N=a.i(458588),O=a.i(393890),P=a.i(121538);function Q({students:a=[],loading:b}){let c=(0,i.useRouter)(),[d,e]=(0,g.useState)(""),[h,j]=(0,g.useState)({}),[l,m]=(0,g.useState)(!1);(0,g.useEffect)(()=>{let b=!0;return(async()=>{if(0===a.length)return j({});m(!0);try{let a=await fetch("/api/tutor/dashboard/student-progress",{credentials:"include"});if(!a.ok)return;let c=await a.json(),d=Array.isArray(c.students)?c.students:[];if(!b)return;let e={};for(let a of d)"string"==typeof a?.studentId&&(e[a.studentId]=a);j(e)}catch{}finally{b&&m(!1)}})(),()=>{b=!1}},[a]);let n=(0,g.useMemo)(()=>{let b=d.trim().toLowerCase();return b?a.filter(a=>a.name.toLowerCase().includes(b)||a.email.toLowerCase().includes(b)):a},[d,a]),o=(0,g.useMemo)(()=>{let b=a.map(a=>h[a.id]).filter(a=>!!a);return 0===b.length?{avgProgress:0,avgEngagement:0,riskCount:0}:{avgProgress:Math.round(b.reduce((a,b)=>a+b.overallProgress,0)/b.length),avgEngagement:Math.round(b.reduce((a,b)=>a+b.engagementRate,0)/b.length),riskCount:b.filter(a=>"high"===a.recentRisk).length}},[a,h]);return b?(0,f.jsx)(A.Card,{children:(0,f.jsx)(A.CardContent,{className:"p-6",children:(0,f.jsx)("div",{className:"space-y-4",children:[1,2,3].map(a=>(0,f.jsx)("div",{className:"h-20 bg-gray-100 rounded animate-pulse"},a))})})}):(0,f.jsxs)(A.Card,{children:[(0,f.jsxs)(A.CardHeader,{className:"space-y-3",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)(A.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,f.jsx)(M.TrendingUp,{className:"w-5 h-5 text-blue-500"}),"Student Progress"]}),o.riskCount>0&&(0,f.jsxs)(K.Badge,{variant:"destructive",className:"gap-1",children:[(0,f.jsx)(P.AlertTriangle,{className:"w-3 h-3"}),o.riskCount," at risk"]})]}),(0,f.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center",children:[(0,f.jsxs)("div",{className:"rounded-lg bg-blue-50 p-2",children:[(0,f.jsxs)("p",{className:"text-lg font-bold text-blue-700",children:[o.avgProgress,"%"]}),(0,f.jsx)("p",{className:"text-xs text-blue-600",children:"Avg progress"})]}),(0,f.jsxs)("div",{className:"rounded-lg bg-green-50 p-2",children:[(0,f.jsxs)("p",{className:"text-lg font-bold text-green-700",children:[o.avgEngagement,"%"]}),(0,f.jsx)("p",{className:"text-xs text-green-600",children:"Engagement"})]}),(0,f.jsxs)("div",{className:"rounded-lg bg-purple-50 p-2",children:[(0,f.jsx)("p",{className:"text-lg font-bold text-purple-700",children:a.length}),(0,f.jsx)("p",{className:"text-xs text-purple-600",children:"Students"})]})]}),(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsx)(N.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,f.jsx)(r.Input,{value:d,onChange:a=>e(a.target.value),placeholder:"Search students",className:"pl-9"})]})]}),(0,f.jsxs)(A.CardContent,{className:"space-y-3",children:[0===n.length?(0,f.jsx)("p",{className:"text-sm text-muted-foreground py-6 text-center",children:"No students found."}):n.map(a=>{var b;let d=h[a.id];return(0,f.jsxs)("div",{className:"rounded-lg border p-3 space-y-2",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,f.jsxs)("div",{className:"min-w-0",children:[(0,f.jsx)("p",{className:"font-medium truncate",children:a.name}),(0,f.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:a.email})]}),d?"high"===(b=d.recentRisk)?(0,f.jsx)(K.Badge,{variant:"destructive",children:"Needs attention"}):"medium"===b?(0,f.jsx)(K.Badge,{variant:"secondary",children:"Watch"}):(0,f.jsx)(K.Badge,{variant:"outline",children:"Stable"}):(0,f.jsx)(K.Badge,{variant:"outline",children:"No metrics yet"})]}),(0,f.jsxs)("div",{className:"space-y-1",children:[(0,f.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,f.jsx)("span",{children:"Progress"}),(0,f.jsxs)("span",{children:[d?.overallProgress??0,"%"]})]}),(0,f.jsx)(L.Progress,{value:d?.overallProgress??0,className:"h-2"})]}),(0,f.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,f.jsxs)("span",{children:["Courses: ",a.courseCount]}),(0,f.jsxs)("span",{children:["Classes: ",a.classCount]}),(0,f.jsxs)("span",{children:["Score: ",d?.averageScore??0,"%"]})]}),(0,f.jsx)("div",{className:"flex justify-end",children:(0,f.jsxs)(k.Button,{size:"sm",variant:"outline",onClick:()=>c.push(`/tutor/reports/${a.id}`),children:[(0,f.jsx)(O.ExternalLink,{className:"h-3.5 w-3.5 mr-1"}),"Open Report"]})})]},a.id)}),l&&(0,f.jsx)("p",{className:"text-xs text-muted-foreground",children:"Refreshing metrics…"})]})]})}a.i(868606);var R=a.i(494176);let S=a=>{let b,c=new Set,d=(a,d)=>{let e="function"==typeof a?a(b):a;if(!Object.is(e,b)){let a=b;b=(null!=d?d:"object"!=typeof e||null===e)?e:Object.assign({},b,e),c.forEach(c=>c(b,a))}},e=()=>b,f={setState:d,getState:e,getInitialState:()=>g,subscribe:a=>(c.add(a),()=>c.delete(a))},g=b=a(d,e,f);return f};var T=a.i(804352);let U={messages:[{id:"1",studentId:"s1",studentName:"Alice Zhang",subject:"Question about homework",content:"Hi, I'm having trouble understanding problem 3 from yesterday's assignment. Could you explain the concept of derivatives again?",timestamp:new Date(Date.now()-18e5).toISOString(),isRead:!1,isStarred:!0,priority:"high",course:"Advanced Mathematics",type:"message",labels:["homework","urgent"],replyCount:2,attachments:[]},{id:"2",studentId:"s2",studentName:"Bob Li",subject:"Missed class notification",content:"I won't be able to attend tomorrow's class due to a family event. Will there be a recording available?",timestamp:new Date(Date.now()-72e5).toISOString(),isRead:!1,isStarred:!1,priority:"normal",course:"Physics 101",type:"message",labels:["attendance"],attachments:[]},{id:"3",studentId:"s3",studentName:"Carol Wang",subject:"Thank you!",content:"Just wanted to say thanks for the extra help yesterday. I finally understood the concept!",timestamp:new Date(Date.now()-18e6).toISOString(),isRead:!0,isStarred:!1,priority:"low",course:"English Literature",type:"message",readAt:new Date(Date.now()-144e5).toISOString(),labels:["feedback"],attachments:[]},{id:"4",studentId:"system",studentName:"System",subject:"New student enrolled",content:"A new student has enrolled in your Advanced Mathematics course.",timestamp:new Date(Date.now()-864e5).toISOString(),isRead:!0,isStarred:!1,priority:"normal",type:"system",attachments:[]},{id:"5",studentId:"s4",studentName:"David Chen",subject:"Assignment extension request",content:"I'm facing some technical issues with my laptop. Could I get a 2-day extension for the upcoming assignment?",timestamp:new Date(Date.now()-1728e5).toISOString(),isRead:!0,isStarred:!0,priority:"high",course:"Advanced Mathematics",type:"message",labels:["extension","technical"],attachments:[{id:"a1",name:"error-screenshot.png",type:"image",url:"#",size:1024e3}]},{id:"6",studentId:"s5",studentName:"Emma Liu",subject:"Voice message",content:"[Voice message]",timestamp:new Date(Date.now()-9e5).toISOString(),isRead:!1,isStarred:!1,priority:"normal",course:"Physics 101",type:"message",voiceUrl:"#",voiceDuration:45,attachments:[]}],templates:[{id:"1",title:"Welcome Message",content:"Welcome to the course! I'm excited to have you join us. If you have any questions, feel free to reach out.",category:"general"},{id:"2",title:"Assignment Reminder",content:"Just a friendly reminder that the assignment is due tomorrow. Let me know if you need any help!",category:"reminder"},{id:"3",title:"Great Work!",content:"Excellent work on the recent assignment! Your understanding of the concepts has really improved.",category:"feedback"},{id:"4",title:"Class Cancellation",content:"Unfortunately, tomorrow's class is cancelled due to unforeseen circumstances. We'll reschedule soon.",category:"course"},{id:"5",title:"Technical Support",content:"I understand you're experiencing technical difficulties. Let's troubleshoot this together.",category:"technical"}],quickReplies:[{id:"1",title:"Thank you",content:"Thank you for reaching out!",shortcut:"/ty"},{id:"2",title:"Will check",content:"I'll look into this and get back to you shortly.",shortcut:"/check"},{id:"3",title:"Great job",content:"Great work! Keep it up!",shortcut:"/great"},{id:"4",title:"See you in class",content:"Looking forward to seeing you in class!",shortcut:"/class"}],labels:[{id:"homework",name:"Homework",color:"bg-blue-100 text-blue-700 border-blue-200"},{id:"urgent",name:"Urgent",color:"bg-red-100 text-red-700 border-red-200"},{id:"feedback",name:"Feedback",color:"bg-green-100 text-green-700 border-green-200"},{id:"technical",name:"Technical",color:"bg-purple-100 text-purple-700 border-purple-200"},{id:"attendance",name:"Attendance",color:"bg-yellow-100 text-yellow-700 border-yellow-200"},{id:"extension",name:"Extension",color:"bg-orange-100 text-orange-700 border-orange-200"}],searchQuery:"",filter:"all",selectedMessage:null,selectedMessages:new Set,showMultiSelect:!1,showCompose:!1,showTemplates:!1,showAnnouncement:!1,showQuickRepliesManager:!1,showAnalytics:!1,showFilters:!1,replyText:"",showAIReplies:!1,aiReplies:[],isRecordingVoice:!1,voiceRecordingDuration:0,isScheduling:!1,scheduledDate:void 0,scheduledTime:"09:00",showThread:!1,threadMessages:[],typingIndicators:[],presenceStatus:{},isWebSocketConnected:!1,composeTo:"",composeSubject:"",composeMessage:"",composeAttachments:[],selectedLabels:[],composePriority:"normal"};c=(e=(b=(a,b)=>({...U,setMessages:b=>a(a=>{a.messages=b}),addMessage:b=>a(a=>{a.messages.unshift(b)}),updateMessage:(b,c)=>a(a=>{let d=a.messages.findIndex(a=>a.id===b);-1!==d&&(a.messages[d]={...a.messages[d],...c})}),deleteMessage:b=>a(a=>{a.messages=a.messages.filter(a=>a.id!==b)}),setTemplates:b=>a(a=>{a.templates=b}),setQuickReplies:b=>a(a=>{a.quickReplies=b}),setSearchQuery:b=>a(a=>{a.searchQuery=b}),setFilter:b=>a(a=>{a.filter=b}),setSelectedMessage:b=>a(a=>{a.selectedMessage=b}),toggleMessageSelection:b=>a(a=>{let c=new Set(a.selectedMessages);c.has(b)?c.delete(b):c.add(b),a.selectedMessages=c}),setSelectedMessages:b=>a(a=>{a.selectedMessages=b}),setShowMultiSelect:b=>a(a=>{a.showMultiSelect=b}),setShowCompose:b=>a(a=>{a.showCompose=b}),setShowTemplates:b=>a(a=>{a.showTemplates=b}),setShowAnnouncement:b=>a(a=>{a.showAnnouncement=b}),setShowQuickRepliesManager:b=>a(a=>{a.showQuickRepliesManager=b}),setShowAnalytics:b=>a(a=>{a.showAnalytics=b}),setShowFilters:b=>a(a=>{a.showFilters=b}),setReplyText:b=>a(a=>{a.replyText=b}),setShowAIReplies:b=>a(a=>{a.showAIReplies=b}),setAiReplies:b=>a(a=>{a.aiReplies=b}),setIsRecordingVoice:b=>a(a=>{a.isRecordingVoice=b}),setVoiceRecordingDuration:b=>a(a=>{a.voiceRecordingDuration=b}),incrementVoiceDuration:()=>a(a=>{a.voiceRecordingDuration+=1}),setIsScheduling:b=>a(a=>{a.isScheduling=b}),setScheduledDate:b=>a(a=>{a.scheduledDate=b}),setScheduledTime:b=>a(a=>{a.scheduledTime=b}),setShowThread:b=>a(a=>{a.showThread=b}),setThreadMessages:b=>a(a=>{a.threadMessages=b}),addTypingIndicator:b=>a(a=>{a.typingIndicators.push(b)}),removeTypingIndicator:b=>a(a=>{a.typingIndicators=a.typingIndicators.filter(a=>a.userId!==b)}),clearExpiredTypingIndicators:()=>a(a=>{let b=Date.now();a.typingIndicators=a.typingIndicators.filter(a=>b-a.timestamp<3e3)}),setPresenceStatus:b=>a(a=>{a.presenceStatus=b}),updatePresenceStatus:(b,c)=>a(a=>{a.presenceStatus[b]=c}),setIsWebSocketConnected:b=>a(a=>{a.isWebSocketConnected=b}),setComposeTo:b=>a(a=>{a.composeTo=b}),setComposeSubject:b=>a(a=>{a.composeSubject=b}),setComposeMessage:b=>a(a=>{a.composeMessage=b}),addComposeAttachment:b=>a(a=>{a.composeAttachments.push(b)}),removeComposeAttachment:b=>a(a=>{a.composeAttachments=a.composeAttachments.filter(a=>a.id!==b)}),clearComposeAttachments:()=>a(a=>{a.composeAttachments=[]}),toggleSelectedLabel:b=>a(a=>{a.selectedLabels.includes(b)?a.selectedLabels=a.selectedLabels.filter(a=>a!==b):a.selectedLabels.push(b)}),setSelectedLabels:b=>a(a=>{a.selectedLabels=b}),setComposePriority:b=>a(a=>{a.composePriority=b}),resetComposeForm:()=>a(a=>{a.composeTo="",a.composeSubject="",a.composeMessage="",a.composeAttachments=[],a.selectedLabels=[],a.composePriority="normal"}),bulkMarkAsRead:b=>a(a=>{a.messages.forEach(a=>{b.has(a.id)&&(a.isRead=!0,a.readAt=new Date().toISOString())})}),bulkMarkAsUnread:b=>a(a=>{a.messages.forEach(a=>{b.has(a.id)&&(a.isRead=!1,a.readAt=void 0)})}),bulkToggleStar:b=>a(a=>{a.messages.forEach(a=>{b.has(a.id)&&(a.isStarred=!a.isStarred)})}),bulkDelete:b=>a(a=>{a.messages=a.messages.filter(a=>!b.has(a.id))}),bulkArchive:b=>a(a=>{a.messages.forEach(a=>{b.has(a.id)&&(a.type="message")})}),toggleMessageStar:b=>a(a=>{let c=a.messages.find(a=>a.id===b);c&&(c.isStarred=!c.isStarred),a.selectedMessage?.id===b&&(a.selectedMessage.isStarred=!a.selectedMessage.isStarred)}),markMessageAsRead:b=>a(a=>{let c=a.messages.find(a=>a.id===b);c&&(c.isRead=!0,c.readAt=new Date().toISOString()),a.selectedMessage?.id===b&&(a.selectedMessage.isRead=!0,a.selectedMessage.readAt=new Date().toISOString())}),addLabelToMessage:(b,c)=>a(a=>{let d=a.messages.find(a=>a.id===b);if(d){let a=d.labels||[];a.includes(c)||(d.labels=[...a,c])}if(a.selectedMessage?.id===b){let b=a.selectedMessage.labels||[];b.includes(c)||(a.selectedMessage.labels=[...b,c])}}),removeLabelFromMessage:(b,c)=>a(a=>{let d=a.messages.find(a=>a.id===b);d&&d.labels&&(d.labels=d.labels.filter(a=>a!==c)),a.selectedMessage?.id===b&&a.selectedMessage.labels&&(a.selectedMessage.labels=a.selectedMessage.labels.filter(a=>a!==c))}),translateMessage:(b,c,d)=>a(a=>{let e=a.messages.find(a=>a.id===b);e&&(e.translatedContent=c,e.translatedFrom=d),a.selectedMessage?.id===b&&(a.selectedMessage.translatedContent=c,a.selectedMessage.translatedFrom=d)}),reset:()=>a(()=>({...U}))}),(a,c,d)=>(d.setState=(b,c,...d)=>a("function"==typeof b?(0,T.produce)(b):b,c,...d),b(d.setState,c,d))))?S(e):S,Object.assign(d=a=>(function(a,b=a=>a){let c=g.default.useSyncExternalStore(a.subscribe,g.default.useCallback(()=>b(a.getState()),[a,b]),g.default.useCallback(()=>b(a.getInitialState()),[a,b]));return g.default.useDebugValue(c),c})(c,a),c),a.i(164504),a.i(384076);var V=a.i(723376);V.Root,V.Trigger,g.forwardRef(({className:a,align:b="center",sideOffset:c=4,...d},e)=>(0,f.jsx)(V.Portal,{children:(0,f.jsx)(V.Content,{ref:e,align:b,sideOffset:c,className:(0,R.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...d})})).displayName=V.Content.displayName,a.i(945347);var W=a.i(141617),X=a.i(147779),Y=a.i(858901),Z=a.i(226886),$=a.i(987386),_=a.i(253583),aa=a.i(618349);function ab({stats:a,loading:b,onScheduleClass:c,onCreateCourse:d}){let[e,h]=(0,g.useState)("Good morning"),[i,j]=(0,g.useState)(new Date);return((0,g.useEffect)(()=>{let a=new Date().getHours();a<12?h("Good morning"):a<18?h("Good afternoon"):h("Good evening");let b=setInterval(()=>j(new Date),6e4);return()=>clearInterval(b)},[]),b)?(0,f.jsx)("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-8",children:(0,f.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,f.jsx)("div",{className:"h-8 bg-white/10 rounded w-1/3"}),(0,f.jsx)("div",{className:"h-4 bg-white/10 rounded w-1/4"}),(0,f.jsx)("div",{className:"grid grid-cols-4 gap-4 mt-8",children:[1,2,3,4].map(a=>(0,f.jsx)("div",{className:"h-24 bg-white/10 rounded-xl"},a))})]})}):(0,f.jsxs)("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-8",children:[(0,f.jsxs)("div",{className:"absolute inset-0 opacity-30",children:[(0,f.jsx)("div",{className:"absolute top-0 left-0 w-96 h-96 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl animate-pulse"}),(0,f.jsx)("div",{className:"absolute top-0 right-0 w-96 h-96 bg-blue-500 rounded-full mix-blend-multiply filter blur-3xl animate-pulse delay-1000"}),(0,f.jsx)("div",{className:"absolute bottom-0 left-1/2 w-96 h-96 bg-pink-500 rounded-full mix-blend-multiply filter blur-3xl animate-pulse delay-2000"})]}),(0,f.jsxs)("div",{className:"relative z-10",children:[(0,f.jsxs)("div",{className:"flex items-start justify-between mb-8",children:[(0,f.jsxs)("div",{children:[(0,f.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,f.jsx)(Z.Sparkles,{className:"w-5 h-5 text-yellow-400"}),(0,f.jsxs)("span",{className:"text-purple-300 text-sm font-medium",children:[e,", Tutor"]})]}),(0,f.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"Welcome Back!"}),(0,f.jsxs)("p",{className:"text-slate-400",children:[i.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})," • ",i.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})]})]}),(0,f.jsx)("div",{className:"flex items-center gap-3",children:(0,f.jsxs)(K.Badge,{className:"bg-white/10 text-white border-white/20 backdrop-blur-sm",children:[(0,f.jsx)(_.Activity,{className:"w-3 h-3 mr-1"}),"Live"]})})]}),(0,f.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[(0,f.jsx)(ac,{icon:C.BookOpen,label:"Total Classes",value:a?.totalClasses||0,trend:"+12%",trendUp:!0,color:"from-blue-500 to-cyan-500"}),(0,f.jsx)(ac,{icon:X.Users,label:"Active Students",value:a?.totalStudents||0,trend:"+8%",trendUp:!0,color:"from-purple-500 to-pink-500"}),(0,f.jsx)(ac,{icon:W.Calendar,label:"Upcoming",value:a?.upcomingClasses||0,sublabel:"This week",color:"from-orange-500 to-red-500"}),(0,f.jsx)(ac,{icon:Y.DollarSign,label:"Earnings",value:`${a?.currency||"SGD"} ${(a?.earnings||0).toLocaleString()}`,trend:"+23%",trendUp:!0,color:"from-green-500 to-emerald-500"})]}),(0,f.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,f.jsxs)(k.Button,{className:"bg-white text-slate-900 hover:bg-white/90 font-medium shadow-lg",onClick:c,children:[(0,f.jsx)(W.Calendar,{className:"w-4 h-4 mr-2"}),"Schedule Class",(0,f.jsx)($.ArrowRight,{className:"w-4 h-4 ml-2"})]}),(0,f.jsxs)(k.Button,{className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600 font-medium shadow-lg border-0",onClick:d,children:[(0,f.jsx)(aa.Award,{className:"w-4 h-4 mr-2"}),"Create Course"]}),(0,f.jsx)("div",{className:"flex-1"}),(0,f.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[(0,f.jsx)(B.Clock,{className:"w-4 h-4"}),(0,f.jsx)("span",{children:"Next class in 2h 15m"})]})]})]})]})}function ac({icon:a,label:b,value:c,sublabel:d,trend:e,trendUp:g,color:h}){return(0,f.jsxs)("div",{className:"group relative overflow-hidden rounded-2xl bg-white/5 backdrop-blur-sm border border-white/10 p-4 hover:bg-white/10 transition-all cursor-pointer",children:[(0,f.jsx)("div",{className:(0,R.cn)("absolute top-0 right-0 w-20 h-20 bg-gradient-to-br opacity-20 rounded-bl-full",h)}),(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsx)("div",{className:(0,R.cn)("w-10 h-10 rounded-xl bg-gradient-to-br flex items-center justify-center mb-3",h),children:(0,f.jsx)(a,{className:"w-5 h-5 text-white"})}),(0,f.jsx)("p",{className:"text-slate-400 text-xs font-medium mb-1",children:b}),(0,f.jsxs)("div",{className:"flex items-end justify-between",children:[(0,f.jsx)("p",{className:"text-2xl font-bold text-white",children:c}),d&&(0,f.jsx)("p",{className:"text-slate-400 text-xs",children:d}),e&&(0,f.jsxs)("div",{className:(0,R.cn)("flex items-center text-xs font-medium",g?"text-green-400":"text-red-400"),children:[(0,f.jsx)(M.TrendingUp,{className:(0,R.cn)("w-3 h-3 mr-0.5",!g&&"rotate-180")}),e]})]})]})]})}function ad({children:a,title:b,icon:c,className:d,headerClassName:e,gradient:g="none",badge:h,action:i}){return(0,f.jsxs)(A.Card,{className:(0,R.cn)("overflow-hidden bg-white/80 backdrop-blur-xl border","none"!==g&&`bg-gradient-to-br ${({purple:"from-purple-500/10 to-pink-500/10 border-purple-200/50",blue:"from-blue-500/10 to-cyan-500/10 border-blue-200/50",green:"from-green-500/10 to-emerald-500/10 border-green-200/50",orange:"from-orange-500/10 to-amber-500/10 border-orange-200/50",pink:"from-pink-500/10 to-rose-500/10 border-pink-200/50",none:"border-gray-200"})[g]}`,d),children:[b&&(0,f.jsx)(A.CardHeader,{className:(0,R.cn)("pb-3",e),children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[c&&(0,f.jsx)("div",{className:(0,R.cn)("w-8 h-8 rounded-lg flex items-center justify-center","purple"===g?"bg-purple-100 text-purple-600":"blue"===g?"bg-blue-100 text-blue-600":"green"===g?"bg-green-100 text-green-600":"orange"===g?"bg-orange-100 text-orange-600":"pink"===g?"bg-pink-100 text-pink-600":"bg-gray-100 text-gray-600"),children:(0,f.jsx)(c,{className:"w-4 h-4"})}),(0,f.jsx)(A.CardTitle,{className:"text-base font-semibold",children:b}),void 0!==h&&(0,f.jsx)("span",{className:(0,R.cn)("px-2 py-0.5 rounded-full text-xs font-medium","purple"===g?"bg-purple-100 text-purple-700":"blue"===g?"bg-blue-100 text-blue-700":"green"===g?"bg-green-100 text-green-700":"orange"===g?"bg-orange-100 text-orange-700":"pink"===g?"bg-pink-100 text-pink-700":"bg-gray-100 text-gray-700"),children:h})]}),i&&(0,f.jsx)("div",{children:i})]})}),(0,f.jsx)(A.CardContent,{className:(0,R.cn)("pt-0",!b&&"pt-6"),children:a})]})}var ae=a.i(354248),af=a.i(60719),ag=a.i(831912),ah=a.i(706562),ai=a.i(378232),aj=a.i(934469),ak=a.i(324666);let al=(0,a.i(293357).default)("repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);var am=a.i(748151),an=a.i(318498),ao=a.i(522528),ap=a.i(450331),aq=a.i(923266),ar=a.i(780340);let as=[{name:"Mathematics",color:"bg-blue-500"},{name:"Physics",color:"bg-purple-500"},{name:"English",color:"bg-green-500"},{name:"Chemistry",color:"bg-orange-500"},{name:"Biology",color:"bg-pink-500"},{name:"History",color:"bg-red-500"},{name:"Office Hours",color:"bg-gray-500"}];function at({event:a,onClick:b,hasConflict:c,style:d={}}){let{attributes:e,listeners:g,setNodeRef:h,transform:i,isDragging:j}=(0,af.useDraggable)({id:a.id,data:{event:a}}),k=ag.CSS.Transform.toString(i);return(0,f.jsxs)("div",{ref:h,...g,...e,style:{...d,transform:k,opacity:j?.5:1,cursor:"grab"},className:(0,R.cn)("absolute left-1 right-1 rounded p-2 cursor-pointer text-xs overflow-hidden group",a.color||"bg-blue-500","cancelled"===a.status&&"opacity-50",c&&"ring-2 ring-red-500 ring-offset-1"),onClick:a=>{a.stopPropagation(),b()},children:[(0,f.jsxs)("div",{className:"flex items-start justify-between",children:[(0,f.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,f.jsx)("p",{className:"font-medium text-white truncate",children:a.title}),(0,f.jsx)("p",{className:"text-white/80",children:a.date.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),(0,f.jsx)(an.GripVertical,{className:"w-3 h-3 text-white/50 opacity-0 group-hover:opacity-100 transition-opacity"})]}),c&&(0,f.jsx)(P.AlertTriangle,{className:"w-3 h-3 text-white absolute top-1 right-1"})]})}function au({events:a,onEventClick:b,onDateClick:c,onCreateClass:d,onEventUpdate:e,loading:h}){let[i,j]=(0,g.useState)(a||(()=>{let a=new Date,b=[],c=[{title:"Advanced Mathematics",subject:"Mathematics",duration:60,students:12,max:20,day:1,time:14,color:"bg-blue-500",isRecurring:!0,pattern:"weekly"},{title:"Physics 101",subject:"Physics",duration:90,students:8,max:15,day:2,time:16,color:"bg-purple-500",isRecurring:!0,pattern:"weekly"},{title:"English Literature",subject:"English",duration:60,students:15,max:25,day:3,time:14,color:"bg-green-500",isRecurring:!0,pattern:"weekly"},{title:"Chemistry Lab",subject:"Chemistry",duration:120,students:6,max:10,day:4,time:15,color:"bg-orange-500",isRecurring:!0,pattern:"weekly"},{title:"Office Hours",subject:"Office Hours",duration:60,students:0,max:5,day:5,time:17,color:"bg-gray-500",type:"office_hours",isRecurring:!0,pattern:"weekly"}];for(let d=0;d<4;d++)c.forEach((c,e)=>{let f=new Date(a);f.setDate(a.getDate()-a.getDay()+c.day+7*d),f.setHours(c.time,0,0,0),f>=new Date(a.getTime()-6048e5)&&b.push({id:`recurring-${d}-${e}`,title:c.title,date:f,duration:c.duration,type:c.type||"class",status:f<a?"completed":"scheduled",studentCount:c.students,maxStudents:c.max,subject:c.subject,isOnline:Math.random()>.3,description:`Regular ${c.pattern} class session`,color:c.color,isRecurring:c.isRecurring,recurringPattern:c.pattern})});return b.push({id:"special-1",title:"Parent-Teacher Meeting",date:new Date(a.getTime()+1728e5),duration:60,type:"personal",status:"scheduled",subject:"Office Hours",color:"bg-red-500"}),b})()),[l,n]=(0,g.useState)([{id:"1",dayOfWeek:1,startTime:"09:00",endTime:"12:00",isAvailable:!0},{id:"2",dayOfWeek:1,startTime:"14:00",endTime:"18:00",isAvailable:!0},{id:"3",dayOfWeek:2,startTime:"09:00",endTime:"12:00",isAvailable:!0},{id:"4",dayOfWeek:2,startTime:"14:00",endTime:"18:00",isAvailable:!0},{id:"5",dayOfWeek:3,startTime:"09:00",endTime:"12:00",isAvailable:!0},{id:"6",dayOfWeek:3,startTime:"14:00",endTime:"18:00",isAvailable:!0},{id:"7",dayOfWeek:4,startTime:"09:00",endTime:"12:00",isAvailable:!0},{id:"8",dayOfWeek:4,startTime:"14:00",endTime:"18:00",isAvailable:!0},{id:"9",dayOfWeek:5,startTime:"09:00",endTime:"12:00",isAvailable:!0},{id:"10",dayOfWeek:5,startTime:"14:00",endTime:"17:00",isAvailable:!0}]),[r,s]=(0,g.useState)(new Date),[t,v]=(0,g.useState)("month"),[w,x]=(0,g.useState)(null),[y,z]=(0,g.useState)(null),[C,D]=(0,g.useState)("all"),[G,H]=(0,g.useState)("all"),[I,J]=(0,g.useState)([]),[L,M]=(0,g.useState)([]),[N,Q]=(0,g.useState)(!1),[S,T]=(0,g.useState)(!1),[U,V]=(0,g.useState)(null),[Y,Z]=(0,g.useState)([{id:"1",provider:"google",connected:!1,syncEnabled:!0},{id:"2",provider:"outlook",connected:!1,syncEnabled:!0},{id:"3",provider:"apple",connected:!1,syncEnabled:!1}]),$=(0,af.useSensors)((0,af.useSensor)(af.PointerSensor,{activationConstraint:{distance:8}}),(0,af.useSensor)(af.KeyboardSensor,{coordinateGetter:a=>{let{active:b}=a,c=b?.rect?.current?.translated;return c?{x:c.left,y:c.top}:{x:0,y:0}}}));(0,g.useEffect)(()=>{let a=[];i.forEach((b,c)=>{i.forEach((d,e)=>{if(!(c>=e)&&b.date.toDateString()===d.date.toDateString()){let c=b.date.getTime(),e=c+6e4*b.duration,f=d.date.getTime();c<f+6e4*d.duration&&e>f&&a.push(b,d)}})});let b=Array.from(new Set(a));b.length>0&&J(b)},[i]),(0,g.useEffect)(()=>{let a=i.filter(a=>{let b=a.date.getTime()-new Date().getTime();return b>0&&b<864e5&&"scheduled"===a.status});a.length>0&&M(a.map(a=>`${a.title} at ${a.date.toLocaleTimeString()}`))},[i]);let _=(0,g.useMemo)(()=>i.filter(a=>{let b="all"===C||a.subject===C,c="all"===G||a.type===G;return b&&c}),[i,C,G]),aa=(0,g.useMemo)(()=>{let a=r.getFullYear(),b=r.getMonth(),c=new Date(a,b,1),d=new Date(a,b+1,0).getDate(),e=c.getDay(),f=[];for(let a=0;a<e;a++)f.push(null);for(let c=1;c<=d;c++)f.push(new Date(a,b,c));return f},[r]),ab=a=>_.filter(b=>new Date(b.date).toDateString()===a.toDateString()).sort((a,b)=>a.date.getTime()-b.date.getTime()),ac=a=>{s(new Date(r.getFullYear(),r.getMonth()+a,1))},ad=a=>{z(a),c?.(a)},ag=a=>{x(a),b?.(a)},an=(0,g.useCallback)(a=>{let{active:b}=a,c=i.find(a=>a.id===b.id);c&&V(c)},[i]),ao=(0,g.useCallback)(a=>{let{active:b,over:c}=a;if(c&&b.id!==c.id){let a=i.find(a=>a.id===b.id),d=c.data.current;if(a&&d?.date){let b=new Date(d.date);void 0!==d.hour?b.setHours(d.hour,a.date.getMinutes(),0,0):b.setHours(a.date.getHours(),a.date.getMinutes(),0,0);let c={...a,date:b};j(b=>b.map(b=>b.id===a.id?c:b)),e?.(c),p.toast.success(`Rescheduled: ${a.title} to ${(0,ar.format)(b,"MMM d, h:mm a")}`)}}V(null)},[i,e]);return h?(0,f.jsx)(A.Card,{className:"h-[600px]",children:(0,f.jsx)(A.CardContent,{className:"flex items-center justify-center h-full",children:(0,f.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full"})})}):(0,f.jsx)(af.DndContext,{sensors:$,collisionDetection:af.closestCorners,onDragStart:an,onDragEnd:ao,children:(0,f.jsxs)(A.Card,{className:"h-full",children:[(0,f.jsxs)(A.CardHeader,{className:"pb-3",children:[(0,f.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,f.jsxs)("div",{className:"flex items-center gap-4",children:[(0,f.jsxs)(A.CardTitle,{className:"text-xl flex items-center gap-2",children:[(0,f.jsx)(W.Calendar,{className:"w-5 h-5 text-blue-500"}),"Calendar",L.length>0&&(0,f.jsxs)(K.Badge,{variant:"destructive",className:"text-xs",children:[(0,f.jsx)(ak.Bell,{className:"w-3 h-3 mr-1"}),L.length]})]}),(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)(k.Button,{variant:"outline",size:"icon",onClick:()=>ac(-1),children:(0,f.jsx)(ah.ChevronLeft,{className:"w-4 h-4"})}),(0,f.jsxs)("h2",{className:"text-lg font-semibold min-w-[150px] text-center",children:[["January","February","March","April","May","June","July","August","September","October","November","December"][r.getMonth()]," ",r.getFullYear()]}),(0,f.jsx)(k.Button,{variant:"outline",size:"icon",onClick:()=>ac(1),children:(0,f.jsx)(m.ChevronRight,{className:"w-4 h-4"})})]}),(0,f.jsx)(k.Button,{variant:"outline",size:"sm",onClick:()=>{s(new Date)},children:"Today"})]}),(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsxs)(k.Button,{variant:"outline",size:"sm",onClick:()=>T(!0),children:[(0,f.jsx)(ap.RefreshCw,{className:(0,R.cn)("w-4 h-4 mr-2",Y.some(a=>a.connected)&&"text-green-500")}),"Sync"]}),(0,f.jsxs)(k.Button,{variant:"outline",size:"sm",onClick:()=>Q(!0),children:[(0,f.jsx)(aq.Layers,{className:"w-4 h-4 mr-2"}),"Batch"]}),(0,f.jsxs)(u.Select,{value:C,onValueChange:D,children:[(0,f.jsxs)(u.SelectTrigger,{className:"w-36",children:[(0,f.jsx)(aj.Filter,{className:"w-4 h-4 mr-2"}),(0,f.jsx)(u.SelectValue,{placeholder:"Filter"})]}),(0,f.jsxs)(u.SelectContent,{children:[(0,f.jsx)(u.SelectItem,{value:"all",children:"All Subjects"}),as.map(a=>(0,f.jsx)(u.SelectItem,{value:a.name,children:a.name},a.name))]})]}),(0,f.jsx)("div",{className:"flex bg-gray-100 rounded-lg p-1",children:["month","week","day","availability"].map(a=>(0,f.jsx)("button",{onClick:()=>v(a),className:(0,R.cn)("px-3 py-1 rounded-md text-sm font-medium transition-colors capitalize",t===a?"bg-white shadow-sm":"text-gray-600 hover:text-gray-900"),children:"availability"===a?"My Availability":a},a))}),(0,f.jsxs)(k.Button,{onClick:()=>d?.(y||new Date),children:[(0,f.jsx)(E.Plus,{className:"w-4 h-4 mr-2"}),"Add"]})]})]}),I.length>0&&(0,f.jsxs)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3",children:[(0,f.jsx)(P.AlertTriangle,{className:"w-5 h-5 text-red-500"}),(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsxs)("p",{className:"text-sm font-medium text-red-800",children:[I.length/2," scheduling conflicts detected"]}),(0,f.jsx)("p",{className:"text-xs text-red-600",children:'Some classes overlap in time. Drag events to reschedule or click "View" to see conflicts.'})]}),(0,f.jsx)(k.Button,{variant:"outline",size:"sm",onClick:()=>v("week"),children:"View"}),(0,f.jsx)(k.Button,{variant:"ghost",size:"sm",onClick:()=>J([]),children:(0,f.jsx)(o.X,{className:"w-4 h-4"})})]}),(0,f.jsxs)("div",{className:"flex items-center gap-4 mt-4 text-sm flex-wrap",children:[as.map(a=>(0,f.jsxs)("button",{onClick:()=>D(C===a.name?"all":a.name),className:(0,R.cn)("flex items-center gap-1 px-2 py-1 rounded-full transition-colors",C===a.name?"bg-gray-200":"hover:bg-gray-100"),children:[(0,f.jsx)("div",{className:(0,R.cn)("w-3 h-3 rounded-full",a.color)}),(0,f.jsx)("span",{children:a.name})]},a.name)),"all"!==C&&(0,f.jsx)(k.Button,{variant:"ghost",size:"sm",onClick:()=>D("all"),children:"Clear Filter"})]})]}),(0,f.jsxs)(A.CardContent,{className:"pt-0",children:["month"===t&&(0,f.jsx)(ax,{days:aa,events:_,onDateClick:ad,onEventClick:ag,isToday:a=>a.toDateString()===new Date().toDateString(),getEventsForDate:ab,conflicts:I}),"week"===t&&(0,f.jsx)(ay,{currentDate:r,events:_,onEventClick:ag,onDateClick:ad,conflicts:I}),"day"===t&&(0,f.jsx)(az,{currentDate:r,events:_,onEventClick:ag,conflicts:I}),"availability"===t&&(0,f.jsx)(aA,{availability:l,onToggle:a=>{n(b=>b.map(b=>b.id===a?{...b,isAvailable:!b.isAvailable}:b))},onSave:()=>{p.toast.success("Availability updated!"),v("month")}})]}),(0,f.jsx)(q.Dialog,{open:!!w,onOpenChange:()=>x(null),children:(0,f.jsx)(q.DialogContent,{className:"sm:max-w-lg",children:w&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(q.DialogHeader,{children:(0,f.jsxs)("div",{className:"flex items-start justify-between",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)(q.DialogTitle,{className:"text-xl",children:w.title}),(0,f.jsxs)(q.DialogDescription,{className:"mt-1",children:[w.subject," • ",w.duration," minutes"]})]}),(0,f.jsxs)("div",{className:"flex gap-2",children:[(0,f.jsx)(K.Badge,{className:(0,R.cn)(w.color||"bg-blue-500"),children:w.type}),w.isRecurring&&(0,f.jsxs)(K.Badge,{variant:"outline",className:"gap-1",children:[(0,f.jsx)(al,{className:"w-3 h-3"}),w.recurringPattern]})]})]})}),(0,f.jsxs)("div",{className:"space-y-4 py-4",children:[(0,f.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,f.jsx)(B.Clock,{className:"w-5 h-5 text-gray-500"}),(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"font-medium",children:w.date.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),(0,f.jsxs)("p",{className:"text-sm text-gray-500",children:[w.date.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})," -",new Date(w.date.getTime()+6e4*w.duration).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})]})]})]}),"class"===w.type&&(0,f.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,f.jsx)(X.Users,{className:"w-5 h-5 text-gray-500"}),(0,f.jsxs)("div",{children:[(0,f.jsxs)("p",{className:"font-medium",children:[w.studentCount," / ",w.maxStudents," students enrolled"]}),(0,f.jsxs)("p",{className:"text-sm text-gray-500",children:[w.maxStudents&&w.studentCount&&w.maxStudents-w.studentCount," spots remaining"]})]})]}),(0,f.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[w.isOnline?(0,f.jsx)(F.Video,{className:"w-5 h-5 text-gray-500"}):(0,f.jsx)(ai.MapPin,{className:"w-5 h-5 text-gray-500"}),(0,f.jsx)("p",{className:"font-medium",children:w.isOnline?"Online Class":"In-Person"})]}),I.find(a=>a.id===w.id)&&(0,f.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 text-red-700 rounded-lg",children:[(0,f.jsx)(P.AlertTriangle,{className:"w-5 h-5"}),(0,f.jsx)("span",{children:"This class has a scheduling conflict!"})]})]}),(0,f.jsxs)(q.DialogFooter,{className:"gap-2",children:[(0,f.jsx)(k.Button,{variant:"outline",onClick:()=>x(null),children:"Close"}),w.isRecurring&&(0,f.jsxs)(k.Button,{variant:"outline",children:[(0,f.jsx)(al,{className:"w-4 h-4 mr-2"}),"Edit Series"]}),(0,f.jsxs)(k.Button,{className:"bg-gradient-to-r from-purple-600 to-blue-600",onClick:()=>{p.toast.success("Joining class..."),x(null)},children:[(0,f.jsx)(F.Video,{className:"w-4 h-4 mr-2"}),"Join Class"]})]})]})})}),(0,f.jsx)(q.Dialog,{open:!!y&&!w,onOpenChange:()=>z(null),children:(0,f.jsxs)(q.DialogContent,{className:"sm:max-w-md",children:[(0,f.jsxs)(q.DialogHeader,{children:[(0,f.jsx)(q.DialogTitle,{children:y?.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),(0,f.jsxs)(q.DialogDescription,{children:[ab(y||new Date).length," events scheduled"]})]}),(0,f.jsxs)("div",{className:"space-y-3 py-4",children:[ab(y||new Date).map(a=>(0,f.jsx)("div",{className:"p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>{z(null),ag(a)},children:(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsx)("div",{className:(0,R.cn)("w-3 h-3 rounded-full",a.color||"bg-blue-500")}),(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsx)("p",{className:"font-medium",children:a.title}),(0,f.jsx)("p",{className:"text-sm text-gray-500",children:a.date.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),I.find(b=>b.id===a.id)&&(0,f.jsx)(P.AlertTriangle,{className:"w-4 h-4 text-red-500"}),(0,f.jsx)(m.ChevronRight,{className:"w-4 h-4 text-gray-400"})]})},a.id)),0===ab(y||new Date).length&&(0,f.jsx)("p",{className:"text-center text-gray-500 py-4",children:"No events scheduled for this day"})]}),(0,f.jsxs)(q.DialogFooter,{children:[(0,f.jsx)(k.Button,{variant:"outline",onClick:()=>z(null),children:"Close"}),(0,f.jsxs)(k.Button,{onClick:()=>{d?.(y||new Date),z(null)},children:[(0,f.jsx)(E.Plus,{className:"w-4 h-4 mr-2"}),"Schedule Class"]})]})]})}),(0,f.jsx)(q.Dialog,{open:S,onOpenChange:T,children:(0,f.jsxs)(q.DialogContent,{className:"sm:max-w-md",children:[(0,f.jsxs)(q.DialogHeader,{children:[(0,f.jsxs)(q.DialogTitle,{className:"flex items-center gap-2",children:[(0,f.jsx)(ap.RefreshCw,{className:"w-5 h-5"}),"Calendar Integrations"]}),(0,f.jsx)(q.DialogDescription,{children:"Sync your schedule with external calendars"})]}),(0,f.jsx)("div",{className:"space-y-4 py-4",children:Y.map(a=>(0,f.jsxs)("div",{className:(0,R.cn)("p-4 border rounded-lg transition-colors",a.connected?"border-green-200 bg-green-50/50":"border-gray-200"),children:[(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsxs)("div",{className:(0,R.cn)("w-10 h-10 rounded-lg flex items-center justify-center","google"===a.provider&&"bg-blue-100 text-blue-600","outlook"===a.provider&&"bg-blue-600 text-white","apple"===a.provider&&"bg-gray-900 text-white"),children:["google"===a.provider&&(0,f.jsx)(W.Calendar,{className:"w-5 h-5"}),"outlook"===a.provider&&(0,f.jsx)(O.ExternalLink,{className:"w-5 h-5"}),"apple"===a.provider&&(0,f.jsx)(W.Calendar,{className:"w-5 h-5"})]}),(0,f.jsxs)("div",{children:[(0,f.jsxs)("p",{className:"font-medium capitalize",children:[a.provider," Calendar"]}),a.connected?(0,f.jsxs)("p",{className:"text-xs text-green-600 flex items-center gap-1",children:[(0,f.jsx)(am.CheckCircle2,{className:"w-3 h-3"}),"Connected",a.email&&` • ${a.email}`]}):(0,f.jsx)("p",{className:"text-xs text-gray-500",children:"Not connected"})]})]}),(0,f.jsx)("div",{className:"flex items-center gap-2",children:a.connected?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(ae.Switch,{checked:a.syncEnabled,onCheckedChange:b=>{Z(c=>c.map(c=>c.id===a.id?{...c,syncEnabled:b}:c))}}),(0,f.jsx)(k.Button,{variant:"ghost",size:"sm",onClick:()=>{var b;return b=a.provider,void(Z(a=>a.map(a=>a.provider===b?{...a,connected:!1,email:void 0,lastSynced:void 0}:a)),p.toast.success(`Disconnected from ${b}`))},children:(0,f.jsx)(o.X,{className:"w-4 h-4"})})]}):(0,f.jsx)(k.Button,{size:"sm",onClick:()=>{var b;return b=a.provider,void(p.toast.loading(`Connecting to ${b} calendar...`),setTimeout(()=>{Z(a=>a.map(a=>a.provider===b?{...a,connected:!0,email:`tutor@${b}.com`,lastSynced:new Date}:a)),p.toast.success(`Connected to ${b} calendar!`)},1500))},children:"Connect"})})]}),a.connected&&a.lastSynced&&(0,f.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Last synced: ",(0,ar.format)(a.lastSynced,"MMM d, h:mm a")]})]},a.id))}),(0,f.jsxs)(q.DialogFooter,{className:"gap-2",children:[(0,f.jsx)(k.Button,{variant:"outline",onClick:()=>T(!1),children:"Close"}),(0,f.jsxs)(k.Button,{onClick:()=>{p.toast.loading("Syncing calendars..."),setTimeout(()=>{Z(a=>a.map(a=>a.connected?{...a,lastSynced:new Date}:a)),p.toast.success("Calendars synced!")},2e3)},className:"gap-2",children:[(0,f.jsx)(ap.RefreshCw,{className:"w-4 h-4"}),"Sync All"]})]})]})}),(0,f.jsx)(aB,{open:N,onClose:()=>Q(!1),onCreate:a=>{j(b=>[...b,...a]),p.toast.success(`Created ${a.length} classes!`)}}),(0,f.jsx)(af.DragOverlay,{children:U?(0,f.jsx)("div",{className:(0,R.cn)("p-2 rounded text-xs opacity-90 shadow-lg",U.color||"bg-blue-500"),children:(0,f.jsx)("p",{className:"font-medium text-white",children:U.title})}):null})]})})}function av({date:a,children:b,className:c}){let{setNodeRef:d,isOver:e}=(0,af.useDroppable)({id:`day-${(0,ar.format)(a,"yyyy-MM-dd")}`,data:{date:a}});return(0,f.jsx)("div",{ref:d,className:(0,R.cn)(c,e&&"bg-blue-50 ring-2 ring-blue-400 ring-inset"),children:b})}function aw({date:a,hour:b,children:c,className:d}){let{setNodeRef:e,isOver:g}=(0,af.useDroppable)({id:`hour-${(0,ar.format)(a,"yyyy-MM-dd")}-${b}`,data:{date:a,hour:b}});return(0,f.jsx)("div",{ref:e,className:(0,R.cn)(d,g&&"bg-blue-50/50"),children:c})}function ax({days:a,events:b,onDateClick:c,onEventClick:d,isToday:e,getEventsForDate:g,conflicts:h}){return(0,f.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,f.jsx)("div",{className:"grid grid-cols-7 bg-gray-50 border-b",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(a=>(0,f.jsx)("div",{className:"p-2 text-center text-sm font-medium text-gray-600",children:a},a))}),(0,f.jsx)("div",{className:"grid grid-cols-7",children:a.map((a,b)=>(0,f.jsx)(av,{date:a||new Date,className:(0,R.cn)("min-h-[100px] p-2 border-r border-b last:border-r-0",!a&&"bg-gray-50/50",a&&"hover:bg-gray-50 cursor-pointer"),children:a&&(0,f.jsxs)("div",{onClick:()=>c(a),children:[(0,f.jsx)("div",{className:(0,R.cn)("text-sm font-medium mb-1 w-7 h-7 flex items-center justify-center rounded-full",e(a)&&"bg-blue-600 text-white"),children:a.getDate()}),(0,f.jsxs)("div",{className:"space-y-1",children:[g(a).slice(0,3).map(a=>{let b=h.find(b=>b.id===a.id);return(0,f.jsx)("div",{className:(0,R.cn)("text-xs p-1.5 rounded cursor-pointer truncate",a.color||"bg-blue-100","cancelled"===a.status&&"opacity-50 line-through",b&&"ring-1 ring-red-400"),onClick:b=>{b.stopPropagation(),d(a)},children:(0,f.jsxs)("div",{className:"flex items-center gap-1",children:[(0,f.jsx)("div",{className:(0,R.cn)("w-1.5 h-1.5 rounded-full",a.color?.replace("bg-","bg-opacity-100 ")||"bg-blue-500")}),(0,f.jsxs)("span",{className:"font-medium truncate",children:[a.date.getHours(),":",a.date.getMinutes().toString().padStart(2,"0")," ",a.title]})]})},a.id)}),g(a).length>3&&(0,f.jsxs)("p",{className:"text-xs text-gray-500 pl-1",children:["+",g(a).length-3," more"]})]})]})},b))})]})}function ay({currentDate:a,events:b,onEventClick:c,onDateClick:d,conflicts:e}){let g=new Date(a);g.setDate(a.getDate()-a.getDay());let h=Array.from({length:7},(a,b)=>{let c=new Date(g);return c.setDate(g.getDate()+b),c}),i=Array.from({length:12},(a,b)=>b+8);return(0,f.jsxs)("div",{className:"flex border rounded-lg overflow-hidden",children:[(0,f.jsxs)("div",{className:"w-16 border-r bg-gray-50",children:[(0,f.jsx)("div",{className:"h-12 border-b"}),i.map(a=>(0,f.jsxs)("div",{className:"h-16 border-b text-xs text-gray-500 text-center pt-2",children:[a,":00"]},a))]}),(0,f.jsx)("div",{className:"flex-1 grid grid-cols-7",children:h.map((a,g)=>(0,f.jsxs)("div",{className:"border-r last:border-r-0",children:[(0,f.jsxs)("div",{className:"h-12 border-b p-2 text-center cursor-pointer hover:bg-gray-50",onClick:()=>d(a),children:[(0,f.jsx)("p",{className:"text-xs text-gray-500",children:a.toLocaleDateString("en-US",{weekday:"short"})}),(0,f.jsx)("p",{className:(0,R.cn)("text-sm font-medium",a.toDateString()===new Date().toDateString()&&"text-blue-600"),children:a.getDate()})]}),(0,f.jsxs)("div",{className:"relative",children:[i.map(b=>(0,f.jsx)(aw,{date:a,hour:b,className:"h-16 border-b"},b)),b.filter(b=>b.date.toDateString()===a.toDateString()).map(a=>{let b=a.date.getHours(),d=a.date.getMinutes(),g=a.duration/60*64,h=e.find(b=>b.id===a.id);return(0,f.jsx)(at,{event:a,onClick:()=>c(a),hasConflict:h,style:{top:`${(b-8)*64+d/60*64}px`,height:`${Math.max(g,32)}px`,position:"absolute"}},a.id)})]})]},g))})]})}function az({currentDate:a,events:b,onEventClick:c,conflicts:d}){let e=Array.from({length:14},(a,b)=>b+7),g=b.filter(b=>b.date.toDateString()===a.toDateString()).sort((a,b)=>a.date.getTime()-b.date.getTime());return(0,f.jsxs)("div",{className:"flex border rounded-lg overflow-hidden",children:[(0,f.jsx)("div",{className:"w-20 border-r bg-gray-50",children:e.map(a=>(0,f.jsxs)("div",{className:"h-20 border-b px-2 py-2 text-sm text-gray-600 text-right",children:[a,":00"]},a))}),(0,f.jsxs)("div",{className:"flex-1 relative",children:[e.map(b=>(0,f.jsx)(aw,{date:a,hour:b,className:"h-20 border-b"},b)),g.map(a=>{let b=a.date.getHours(),e=a.date.getMinutes(),g=a.duration/60*80,h=d.find(b=>b.id===a.id);return(0,f.jsx)(at,{event:a,onClick:()=>c(a),hasConflict:h,style:{top:`${(b-7)*80+e/60*80}px`,height:`${Math.max(g,40)}px`,position:"absolute",left:"8px",right:"8px"}},a.id)}),0===g.length&&(0,f.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400",children:(0,f.jsx)("p",{children:"No events scheduled for this day"})})]})]})}function aA({availability:a,onToggle:b,onSave:c}){return(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,f.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"Set Your Availability"}),(0,f.jsx)("p",{className:"text-sm text-blue-700",children:"Mark when you're available for classes. Students will only be able to book during these times."})]}),(0,f.jsx)("div",{className:"space-y-4",children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map((c,d)=>(0,f.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,f.jsx)("h4",{className:"font-medium mb-3",children:c}),(0,f.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:a.filter(a=>a.dayOfWeek===d+1).map(a=>(0,f.jsx)("div",{className:(0,R.cn)("p-3 rounded-lg border cursor-pointer transition-all",a.isAvailable?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200 opacity-50"),onClick:()=>b(a.id),children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("span",{className:"font-medium",children:[a.startTime," - ",a.endTime]}),a.isAvailable?(0,f.jsx)(am.CheckCircle2,{className:"w-5 h-5 text-green-500"}):(0,f.jsx)(o.X,{className:"w-5 h-5 text-gray-400"})]})},a.id))})]},c))}),(0,f.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,f.jsx)(k.Button,{variant:"outline",children:"Cancel"}),(0,f.jsx)(k.Button,{onClick:c,className:"bg-gradient-to-r from-green-600 to-emerald-600",children:"Save Availability"})]})]})}function aB({open:a,onClose:b,onCreate:c}){let[d,e]=(0,g.useState)(""),[h,i]=(0,g.useState)("Mathematics"),[j,l]=(0,g.useState)((0,ar.format)(new Date,"yyyy-MM-dd")),[m,n]=(0,g.useState)("14:00"),[o,p]=(0,g.useState)(60),[t,v]=(0,g.useState)("weekly"),[w,x]=(0,g.useState)(4),[y,z]=(0,g.useState)(20),[A,B]=(0,g.useState)(!0);return(0,f.jsx)(q.Dialog,{open:a,onOpenChange:b,children:(0,f.jsxs)(q.DialogContent,{className:"sm:max-w-lg",children:[(0,f.jsxs)(q.DialogHeader,{children:[(0,f.jsxs)(q.DialogTitle,{className:"flex items-center gap-2",children:[(0,f.jsx)(ao.CalendarPlus,{className:"w-5 h-5"}),"Batch Create Classes"]}),(0,f.jsx)(q.DialogDescription,{children:"Create multiple recurring classes at once"})]}),(0,f.jsxs)("div",{className:"space-y-4 py-4",children:[(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)(s.Label,{children:"Class Title"}),(0,f.jsx)(r.Input,{value:d,onChange:a=>e(a.target.value),placeholder:"e.g., Advanced Math"})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)(s.Label,{children:"Subject"}),(0,f.jsxs)(u.Select,{value:h,onValueChange:i,children:[(0,f.jsx)(u.SelectTrigger,{children:(0,f.jsx)(u.SelectValue,{})}),(0,f.jsx)(u.SelectContent,{children:as.filter(a=>"Office Hours"!==a.name).map(a=>(0,f.jsx)(u.SelectItem,{value:a.name,children:a.name},a.name))})]})]})]}),(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)(s.Label,{children:"Start Date"}),(0,f.jsx)(r.Input,{type:"date",value:j,onChange:a=>l(a.target.value)})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)(s.Label,{children:"Start Time"}),(0,f.jsx)(r.Input,{type:"time",value:m,onChange:a=>n(a.target.value)})]})]}),(0,f.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)(s.Label,{children:"Duration (min)"}),(0,f.jsx)(r.Input,{type:"number",value:o,onChange:a=>p(Number(a.target.value)),min:15,step:15})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)(s.Label,{children:"Max Students"}),(0,f.jsx)(r.Input,{type:"number",value:y,onChange:a=>z(Number(a.target.value)),min:1})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)(s.Label,{children:"Occurrences"}),(0,f.jsx)(r.Input,{type:"number",value:w,onChange:a=>x(Number(a.target.value)),min:1,max:52})]})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)(s.Label,{children:"Recurring Pattern"}),(0,f.jsx)("div",{className:"flex gap-2",children:["weekly","biweekly","daily"].map(a=>(0,f.jsx)(k.Button,{type:"button",variant:t===a?"default":"outline",size:"sm",onClick:()=>v(a),className:"flex-1 capitalize",children:"biweekly"===a?"Bi-weekly":a},a))})]}),(0,f.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)(F.Video,{className:"w-4 h-4 text-gray-500"}),(0,f.jsx)("span",{className:"text-sm",children:"Online Class"})]}),(0,f.jsx)(ae.Switch,{checked:A,onCheckedChange:B})]}),(0,f.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg text-sm",children:[(0,f.jsx)("p",{className:"font-medium text-blue-900",children:"Preview"}),(0,f.jsxs)("p",{className:"text-blue-700",children:["Will create ",(0,f.jsx)("strong",{children:w})," ",t," classes starting ",(0,f.jsx)("strong",{children:(0,ar.format)(new Date(j),"MMM d, yyyy")})]})]})]}),(0,f.jsxs)(q.DialogFooter,{className:"gap-2",children:[(0,f.jsx)(k.Button,{variant:"outline",onClick:b,children:"Cancel"}),(0,f.jsxs)(k.Button,{onClick:()=>{let a=[],f=new Date(j),[g,i]=m.split(":").map(Number);for(let b=0;b<w;b++){let c=new Date(f);"daily"===t?c.setDate(f.getDate()+b):"weekly"===t?c.setDate(f.getDate()+7*b):"biweekly"===t&&c.setDate(f.getDate()+14*b),c.setHours(g,i,0,0);let e=as.find(a=>a.name===h)?.color||"bg-blue-500";a.push({id:`batch-${Date.now()}-${b}`,title:d||`${h} Class`,date:c,duration:o,type:"class",status:"scheduled",subject:h,maxStudents:y,studentCount:0,isOnline:A,color:e,isRecurring:w>1,recurringPattern:w>1?t:void 0})}c(a),b(),e(""),x(4)},className:"gap-2",children:[(0,f.jsx)(D.Copy,{className:"w-4 h-4"}),"Create ",w," Classes"]})]})]})})}function aC(){return(0,f.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,f.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,f.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/3 animate-pulse"}),(0,f.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[1,2,3,4].map(a=>(0,f.jsx)("div",{className:"h-24 bg-gray-200 rounded animate-pulse"},a))}),(0,f.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,f.jsx)("div",{className:"lg:col-span-2 space-y-6",children:(0,f.jsx)("div",{className:"h-64 bg-gray-200 rounded animate-pulse"})}),(0,f.jsx)("div",{className:"space-y-6",children:(0,f.jsx)("div",{className:"h-48 bg-gray-200 rounded animate-pulse"})})]})]})})}let aD={totalClasses:0,totalStudents:0,upcomingClasses:0,earnings:0,currency:"SGD"};function aE(){let{data:a}=(0,h.useSession)(),b=(0,i.useSearchParams)(),[c,d]=(0,g.useState)(!1),[e,q]=(0,g.useState)(!1);(0,g.useEffect)(()=>{"1"===b.get("create")&&d(!0),"1"===b.get("course")&&q(!0)},[b]);let[r,s]=(0,g.useState)(aD),[t,u]=(0,g.useState)([]),[v,w]=(0,g.useState)([]),[x,A]=(0,g.useState)([]),[B,C]=(0,g.useState)(!0),[D,E]=(0,g.useState)(null),[F,G]=(0,g.useState)(!0);(0,g.useEffect)(()=>{try{G("1"===localStorage.getItem("tutor-dashboard-one-account-tip-dismissed"))}catch{G(!1)}},[]);let H=(0,g.useCallback)(async()=>{if(a?.user?.id){E(null);try{let[a,b,c,d]=await Promise.allSettled([fetch("/api/tutor/stats",{credentials:"include"}),fetch("/api/tutor/classes",{credentials:"include"}),fetch("/api/tutor/students-needing-attention",{credentials:"include"}),fetch("/api/tutor/students",{credentials:"include"})]),e=[];if("fulfilled"===a.status&&a.value.ok){let b=await a.value.json();s({totalClasses:b.totalClasses??0,totalStudents:b.totalStudents??0,upcomingClasses:b.upcomingClasses??0,earnings:b.earnings??0,currency:b.currency??"SGD"})}else e.push("stats");if("fulfilled"===b.status&&b.value.ok){let a=await b.value.json();u(a.classes??[])}else e.push("classes");if("fulfilled"===c.status&&c.value.ok){let a=await c.value.json();w(a.students??[])}else e.push("students-needing-attention");if("fulfilled"===d.status&&d.value.ok){let a=await d.value.json();A(a.students??[])}else e.push("students");e.length>=2&&E("Failed to load dashboard data")}catch{E("Failed to load dashboard data")}finally{C(!1)}}},[a?.user?.id]);(0,g.useEffect)(()=>{a?.user?.id?(C(!0),H()):C(!1)},[a?.user?.id,H]);let K=(0,g.useCallback)(a=>{if(a){let b={id:a.id,title:a.title||"New Class",subject:a.subject||"",scheduledAt:a.scheduledAt||new Date().toISOString(),duration:a.durationMinutes||60,maxStudents:a.maxStudents||50,enrolledStudents:0,status:a.status||"scheduled"};u(a=>[b,...a]),s(a=>({...a,totalClasses:a.totalClasses+1,upcomingClasses:a.upcomingClasses+1}))}else H()},[H]),L=(0,g.useCallback)(async a=>{try{let b=await fetch("/api/csrf",{credentials:"include"}),c=await b.json().catch(()=>({})),d=c?.token??null,e=await fetch(`/api/tutor/classes/${a}`,{method:"DELETE",headers:{"Content-Type":"application/json",...d&&{"X-CSRF-Token":d}},credentials:"include"});if(e.ok)u(b=>b.filter(b=>b.id!==a)),s(a=>({...a,totalClasses:Math.max(0,a.totalClasses-1),upcomingClasses:Math.max(0,a.upcomingClasses-1)})),p.toast.success("Class removed successfully");else{let a=await e.json().catch(()=>({}));p.toast.error(a.error||"Failed to remove class")}}catch{p.toast.error("Failed to remove class")}},[]);return(0,f.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[!F&&(0,f.jsxs)("div",{className:"mb-4 p-3 rounded-lg bg-slate-50 border border-slate-200 flex items-start gap-2",children:[(0,f.jsx)(n.Info,{className:"w-4 h-4 text-slate-500 shrink-0 mt-0.5"}),(0,f.jsx)("p",{className:"text-sm text-slate-600 flex-1",children:"Only one account is logged in per browser. Logging in as a different user in another tab will switch the account in all tabs. To use a student account at the same time, use another browser or an incognito window."}),(0,f.jsx)("button",{type:"button",onClick:()=>{G(!0);try{localStorage.setItem("tutor-dashboard-one-account-tip-dismissed","1")}catch{}},className:"p-1 rounded hover:bg-slate-200 text-slate-500","aria-label":"Dismiss",children:(0,f.jsx)(o.X,{className:"w-4 h-4"})})]}),(0,f.jsx)("div",{className:"mb-8",children:(0,f.jsx)(ab,{stats:r,loading:B,onScheduleClass:()=>d(!0),onCreateCourse:()=>q(!0)})}),D&&(0,f.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl text-red-800 text-sm",children:[D,(0,f.jsx)(k.Button,{variant:"outline",size:"sm",className:"ml-2",onClick:()=>{C(!0),H()},children:"Retry"})]}),(0,f.jsxs)("div",{className:"space-y-6",children:[(0,f.jsx)(I,{classes:t,formatDate:a=>new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),loading:B,onCreateClassClick:()=>d(!0),onRemoveClass:L}),(0,f.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,f.jsx)("div",{className:"lg:col-span-2",children:(0,f.jsxs)(ad,{title:"Course Catalogue",icon:l.Library,gradient:"blue",action:(0,f.jsx)(j.default,{href:"/curriculum",children:(0,f.jsxs)(k.Button,{variant:"ghost",size:"sm",children:["View",(0,f.jsx)(m.ChevronRight,{className:"w-4 h-4 ml-1"})]})}),children:[(0,f.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Browse and manage your courses. Create new courses, then configure curriculum, groups, and schedule for each."}),(0,f.jsx)(j.default,{href:"/curriculum",children:(0,f.jsxs)(k.Button,{variant:"outline",className:"w-full",children:[(0,f.jsx)(l.Library,{className:"w-4 h-4 mr-2"}),"Open Course Catalogue"]})})]})}),(0,f.jsx)("div",{className:"lg:col-span-2",children:(0,f.jsx)(J,{students:v,loading:B})})]}),(0,f.jsx)(Q,{loading:B,students:x}),(0,f.jsx)(au,{onEventClick:a=>console.log("Event clicked:",a),onDateClick:a=>console.log("Date clicked:",a),onCreateClass:a=>d(!0),loading:B}),(0,f.jsx)(y,{open:c,onOpenChange:d,onClassCreated:K,redirectToClass:!1}),(0,f.jsx)(z.CreateCourseDialog,{open:e,onOpenChange:q})]})]})}function aF(){return(0,f.jsx)(g.Suspense,{fallback:(0,f.jsx)(aC,{}),children:(0,f.jsx)(aE,{})})}a.s(["default",()=>aF],915704)}];

//# debugId=76fbb956-0503-5242-a908-3f500c9dffd2
//# sourceMappingURL=b1c00_TutorMekimi_tutorme-app_src_app_%5Blocale%5D_tutor_dashboard_page_tsx_4b43d003._.js.map