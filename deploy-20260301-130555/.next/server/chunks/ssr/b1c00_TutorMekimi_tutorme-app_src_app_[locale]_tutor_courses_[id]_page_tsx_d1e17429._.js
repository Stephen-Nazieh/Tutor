;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="5521a1b3-c141-aabc-4a83-fed403bbadc4")}catch(e){}}();
module.exports=[824632,a=>{"use strict";var b=a.i(260576),c=a.i(741510),d=a.i(454069),e=a.i(52028),f=a.i(113098),g=a.i(88684),h=a.i(981354),i=a.i(529004),j=a.i(206209),k=a.i(763485),l=a.i(414030),m=a.i(342621),n=a.i(479680),o=a.i(957512),p=a.i(858901),q=a.i(899622),r=a.i(846438);let s=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],t=[{value:"Grade 1",label:"Grade 1"},{value:"Grade 2",label:"Grade 2"},{value:"Grade 3",label:"Grade 3"},{value:"Grade 4",label:"Grade 4"},{value:"Grade 5",label:"Grade 5"},{value:"Grade 6",label:"Grade 6"},{value:"Grade 7",label:"Grade 7"},{value:"Grade 8",label:"Grade 8"},{value:"Grade 9",label:"Grade 9"},{value:"Grade 10",label:"Grade 10"},{value:"Grade 11",label:"Grade 11"},{value:"Grade 12",label:"Grade 12"},{value:"College",label:"College"},{value:"Adult Education",label:"Adult Education"}];function u({slot:a,index:c,onUpdate:d,onRemove:e}){return(0,b.jsxs)("div",{className:"flex flex-wrap items-end gap-2 p-3 rounded-lg border bg-muted/30",children:[(0,b.jsxs)("div",{className:"space-y-1 min-w-[120px]",children:[(0,b.jsx)(i.Label,{className:"text-xs",children:"Day"}),(0,b.jsxs)(j.Select,{value:a.dayOfWeek,onValueChange:a=>d(c,"dayOfWeek",a),children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{})}),(0,b.jsx)(j.SelectContent,{children:s.map(a=>(0,b.jsx)(j.SelectItem,{value:a,children:a},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-1 w-[90px]",children:[(0,b.jsx)(i.Label,{className:"text-xs",children:"Start"}),(0,b.jsx)(h.Input,{type:"time",value:a.startTime,onChange:a=>d(c,"startTime",a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-1 w-[100px]",children:[(0,b.jsx)(i.Label,{className:"text-xs",children:"Duration (min)"}),(0,b.jsx)(h.Input,{type:"number",min:5,max:480,value:a.durationMinutes,onChange:a=>d(c,"durationMinutes",parseInt(a.target.value,10)||60)})]}),(0,b.jsx)(g.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>e(c),className:"text-destructive hover:text-destructive","aria-label":"Remove slot",children:"Remove"})]})}var v=a.i(141617);function w({schedule:a,onScheduleChange:c,subtitle:d}){let e=(a,b,d)=>{c(c=>{let e=[...c];return e[a]={...e[a],[b]:d},e})},h=a=>{c(b=>b.filter((b,c)=>c!==a))};return(0,b.jsxs)(f.Card,{id:"course-schedule",children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(v.Calendar,{className:"h-5 w-5"}),"Class schedule",d&&(0,b.jsxs)("span",{className:"text-sm font-normal text-muted-foreground",children:["(",d,")"]})]}),(0,b.jsx)(f.CardDescription,{children:'Set recurring slots for this course. Save with "Save settings only" or "Save all" below.'})]}),(0,b.jsxs)(f.CardContent,{className:"space-y-4",children:[a.map((a,c)=>(0,b.jsx)(u,{slot:a,index:c,onUpdate:e,onRemove:h},c)),(0,b.jsx)(g.Button,{type:"button",variant:"outline",onClick:()=>{c(a=>[...a,{dayOfWeek:s[0],startTime:"09:00",durationMinutes:60}])},children:"Add class slot"})]})]})}function x(){let a=(0,d.useParams)(),s=(0,d.useRouter)(),u=a.id,[v,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(!0),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)("intermediate"),[K,L]=(0,c.useState)(""),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)("SGD"),[Q,R]=(0,c.useState)("PLATFORM"),[S,T]=(0,c.useState)([]),[U,V]=(0,c.useState)(!1),[W,X]=(0,c.useState)("SELF"),[Y,Z]=(0,c.useState)([]),[$,_]=(0,c.useState)({}),[aa,ab]=(0,c.useState)({curriculum:"",notes:"",topics:""}),[ac,ad]=(0,c.useState)(!1),[ae,af]=(0,c.useState)(!1),[ag,ah]=(0,c.useState)(!1),[ai,aj]=(0,c.useState)(!1),[ak,al]=(0,c.useState)(""),[am,an]=(0,c.useState)(""),[ao,ap]=(0,c.useState)(""),[aq,ar]=(0,c.useState)([]),[as,at]=(0,c.useState)([]),[au,av]=(0,c.useState)(!1),[aw,ax]=(0,c.useState)(45),[ay,az]=(0,c.useState)(null),aA=(0,c.useCallback)(async()=>{z(!0);try{let a=await fetch(`/api/tutor/courses/${u}`,{credentials:"include"});if(a.ok){let b=await a.json();x(b.course)}else r.toast.error("Course not found"),s.push("/curriculum")}catch{r.toast.error("Failed to load course"),s.push("/curriculum")}finally{z(!1)}},[u,s]);(0,c.useEffect)(()=>{aA()},[aA]),(0,c.useEffect)(()=>{fetch("/api/user/profile",{credentials:"include"}).then(a=>a.ok?a.json():null).then(a=>a?.profile&&az(a.profile)).catch(()=>{})},[]),(0,c.useEffect)(()=>{if(!v)return;D(v.name??""),F(v.description??""),H(v.gradeLevel??""),J(v.difficulty??"intermediate"),L(v.languageOfInstruction??""),N(null!=v.price?String(v.price):""),P(v.currency??ay?.currency??"SGD"),R(v.curriculumSource??"PLATFORM"),X(v.outlineSource??"SELF"),Z(Array.isArray(v.schedule)?[...v.schedule]:[]);let a=v.courseMaterials;a&&(_(a),al(a.editableCurriculum??""),an(a.editableNotes??""),ap(a.editableTopics??""),ar(a.outline??[]),at(a.outlineModules?.modules??[]))},[v,ay]),(0,c.useEffect)(()=>{let a=v?.subject;a?(V(!0),fetch(`/api/curriculums/catalog?subject=${encodeURIComponent(a)}`,{credentials:"include"}).then(a=>a.json()).then(a=>T(a.curriculums??[])).catch(()=>T([])).finally(()=>V(!1))):T([])},[v?.subject]),aa.curriculum.trim()||aa.notes.trim()||aa.topics.trim()||$.curriculumText||$.editableCurriculum;let aB=async()=>{if(v){aj(!0);try{let a=await fetch("/api/csrf",{credentials:"include"}),b=await a.json().catch(()=>({})),c=b?.token??null,d=Array.isArray(Y)&&Y.length>0&&Number(Y[0]?.durationMinutes)||60,e=(E?.trim()||v.description||"").trim(),f=(G||v.gradeLevel||"").trim(),g={title:(C||v.name||"").trim(),subject:v.subject||"General",curriculumId:v.id,maxStudents:50,durationMinutes:Math.max(15,Math.min(480,d)),enableRecording:!1};e&&(g.description=e),f&&(g.gradeLevel=f);let h=await fetch("/api/class/rooms",{method:"POST",headers:{"Content-Type":"application/json",...c&&{"X-CSRF-Token":c}},credentials:"include",body:JSON.stringify(g)});if(!h.ok){let a=await h.json().catch(()=>({}));throw Error(a?.error||"Failed to create live class")}let i=await h.json(),j=i?.session?.id;if(!j)throw Error("Live class created but session ID is missing");r.toast.success("Live class created. Redirecting…"),s.push(`/tutor/live-class/${j}`)}catch(a){r.toast.error(a instanceof Error?a.message:"Failed to open live class")}finally{aj(!1)}}},aC=async()=>{B(!0);try{let a=await aE(),b=await fetch(`/api/tutor/courses/${u}`,{method:"PATCH",headers:{"Content-Type":"application/json",...a&&{"X-CSRF-Token":a}},credentials:"include",body:JSON.stringify({name:C.trim()||null,description:E.trim()||null,gradeLevel:G||null,difficulty:I||null,languageOfInstruction:K||null,price:""===M?null:Number(M),currency:O||null,curriculumSource:Q,outlineSource:"UPLOADED"===Q?W:null,schedule:Y.length?Y:null})}),c=await b.json();if(!b.ok)return void r.toast.error(c.error??"Failed to save");x(a=>a?{...a,name:C.trim()||a.name,description:E.trim()||a.description,gradeLevel:G||a.gradeLevel,difficulty:I||a.difficulty,languageOfInstruction:K||null,price:""===M?null:Number(M),currency:O||null,curriculumSource:Q,outlineSource:"UPLOADED"===Q?W:null,schedule:Y}:null),"UPLOADED"===Q&&(ak||am||ao||aq.length>0)&&(await fetch(`/api/tutor/courses/${u}/materials`,{method:"PATCH",headers:{"Content-Type":"application/json",...a&&{"X-CSRF-Token":a}},credentials:"include",body:JSON.stringify({editableCurriculum:ak||void 0,editableNotes:am||void 0,editableTopics:ao||void 0,outline:aq.length?aq:void 0})})).ok&&aA(),r.toast.success("All changes saved"),aA()}catch{r.toast.error("Failed to save")}finally{B(!1)}},aD=async a=>{D(a);try{let b=await aE(),c=await fetch(`/api/tutor/courses/${u}`,{method:"PATCH",headers:{"Content-Type":"application/json",...b&&{"X-CSRF-Token":b}},credentials:"include",body:JSON.stringify({name:a})});if(c.ok)x(b=>b?{...b,name:a}:null),r.toast.success("Curriculum name updated");else{let a=await c.json().catch(()=>({}));r.toast.error(a.error??"Failed to update name")}}catch{r.toast.error("Failed to update curriculum name")}},aE=async()=>{let a=await fetch("/api/csrf",{credentials:"include"}),b=await a.json().catch(()=>({}));return b?.token??null},[aF,aG]=(0,c.useState)(!1);return y||!v?(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"Loading course…"})}):(0,b.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,b.jsxs)("div",{className:"max-w-6xl mx-auto p-4 sm:p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",asChild:!0,children:(0,b.jsx)(e.default,{href:"/curriculum",children:(0,b.jsx)(l.ArrowLeft,{className:"h-4 w-4"})})}),(0,b.jsx)("h1",{className:"text-xl font-semibold truncate",children:v.name}),G&&(0,b.jsxs)("span",{className:"text-sm text-muted-foreground font-normal",children:["(",G,")"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(q.PublishStatusBadge,{isPublished:v.isPublished}),(0,b.jsx)(q.PublishButton,{course:{id:v.id,name:v.name,description:v.description,subject:v.subject,price:v.price,currency:v.currency,isPublished:v.isPublished,modules:v.modules},onPublishChange:a=>{x(b=>b?{...b,isPublished:a}:null)},size:"sm"}),(0,b.jsx)(g.Button,{variant:"default",size:"sm",onClick:aB,disabled:ai,children:ai?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Opening…"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Radio,{className:"h-4 w-4 mr-2"}),"Open in Live Class"]})}),(0,b.jsx)(g.Button,{variant:"outline",size:"sm",asChild:!0,children:(0,b.jsx)(e.default,{href:"/tutor/dashboard",children:"Back to dashboard"})})]})]}),0===Y.length&&(0,b.jsxs)(f.Card,{className:"border-dashed",children:[(0,b.jsxs)(f.CardHeader,{className:"py-3",children:[(0,b.jsx)(f.CardTitle,{className:"text-sm font-medium",children:"Quick setup"}),(0,b.jsx)(f.CardDescription,{className:"text-xs",children:"Complete this to finish setting up your course."})]}),(0,b.jsx)(f.CardContent,{className:"py-2",children:(0,b.jsx)("ul",{className:"text-sm space-y-1 list-disc list-inside text-muted-foreground",children:(0,b.jsx)("li",{children:(0,b.jsx)("a",{href:"#course-schedule",className:"text-primary underline",children:"Add schedule (or populate from content/outline above)"})})})})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(m.BookOpen,{className:"h-5 w-5"}),"Course Details"]}),(0,b.jsx)(f.CardDescription,{children:"Basic information about your course."})]}),(0,b.jsxs)(f.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Course Name"}),S.length>0?(0,b.jsxs)(j.Select,{value:C,onValueChange:aD,disabled:U,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:U?"Loading…":"Select curriculum"})}),(0,b.jsxs)(j.SelectContent,{children:[C&&!S.some(a=>a.name===C)&&(0,b.jsxs)(j.SelectItem,{value:C,children:["Current: ",C]}),S.map(a=>(0,b.jsx)(j.SelectItem,{value:a.name,children:a.name},a.id))]})]}):(0,b.jsx)(h.Input,{value:C,onChange:a=>D(a.target.value),placeholder:"Course name"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Description"}),(0,b.jsx)(k.Textarea,{value:E,onChange:a=>F(a.target.value),placeholder:"What will students learn in this course?",rows:3,className:"resize-y"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Grade Level"}),(0,b.jsxs)(j.Select,{value:G,onValueChange:H,children:[(0,b.jsx)(j.SelectTrigger,{children:(0,b.jsx)(j.SelectValue,{placeholder:"Select grade"})}),(0,b.jsx)(j.SelectContent,{children:t.map(a=>(0,b.jsx)(j.SelectItem,{value:a.value,children:a.label},a.value))})]})]})]})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(p.DollarSign,{className:"h-5 w-5"}),"Pricing"]}),(0,b.jsx)(f.CardDescription,{children:"Set the price for your course. You need to set a price before publishing."})]}),(0,b.jsxs)(f.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"price",children:"Price"}),(0,b.jsx)(h.Input,{id:"price",type:"number",min:"0",step:"0.01",value:M,onChange:a=>N(a.target.value),placeholder:"e.g. 99"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Leave empty for free courses"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"currency",children:"Currency"}),(0,b.jsxs)(j.Select,{value:O,onValueChange:P,children:[(0,b.jsx)(j.SelectTrigger,{id:"currency",children:(0,b.jsx)(j.SelectValue,{placeholder:"Select currency"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"USD",children:"USD - US Dollar"}),(0,b.jsx)(j.SelectItem,{value:"SGD",children:"SGD - Singapore Dollar"}),(0,b.jsx)(j.SelectItem,{value:"EUR",children:"EUR - Euro"}),(0,b.jsx)(j.SelectItem,{value:"GBP",children:"GBP - British Pound"}),(0,b.jsx)(j.SelectItem,{value:"CNY",children:"CNY - Chinese Yuan"})]})]})]})]}),M&&Number(M)>0&&(0,b.jsx)("div",{className:"rounded-lg border bg-muted/30 p-3",children:(0,b.jsxs)("p",{className:"text-sm",children:[(0,b.jsx)("span",{className:"font-medium",children:"Price preview:"})," ",O," ",Number(M).toFixed(2)]})})]})]}),(0,b.jsx)(w,{schedule:Y,onScheduleChange:Z}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)(g.Button,{size:"sm",variant:"outline",onClick:aC,disabled:A,children:[A?(0,b.jsx)(n.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):null,A?"Saving…":"Save Changes"]})})]})})}a.s(["default",()=>x],824632)}];

//# debugId=5521a1b3-c141-aabc-4a83-fed403bbadc4
//# sourceMappingURL=b1c00_TutorMekimi_tutorme-app_src_app_%5Blocale%5D_tutor_courses_%5Bid%5D_page_tsx_d1e17429._.js.map