;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="920aba67-c632-e57e-889b-cbb121b0016b")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,587604,e=>{"use strict";var t=e.i(251474),r=e.i(800592),a=e.i(390553);let n=r.forwardRef(({className:e,type:r,...n},i)=>(0,t.jsx)("input",{type:r,className:(0,a.cn)("flex h-10 min-h-[44px] sm:min-h-0 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:i,...n}));n.displayName="Input",e.s(["Input",()=>n])},825627,e=>{"use strict";let t=(0,e.i(879191).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],825627)},145451,e=>{"use strict";let t=(0,e.i(879191).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],145451)},249453,e=>{"use strict";let t=(0,e.i(879191).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>t],249453)},896098,e=>{"use strict";let t=(0,e.i(879191).default)("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);e.s(["Unlock",()=>t],896098)},252186,102037,e=>{"use strict";var t=e.i(251474),r=e.i(800592),a=e.i(624842),n=e.i(870368),i=e.i(785784),s=e.i(156155),l=e.i(587604),o=e.i(825627),c=e.i(896098),u=e.i(249453),d=e.i(145451),f=e.i(783393);function h(t,a={}){let n=(0,r.useRef)(null),[i,s]=(0,r.useState)(null),[l,o]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{if(t)return(async()=>{let r=await e.A(913435).then(e=>e.getSocketToken());if(!r)return;let i=(0,f.io)({path:"/api/socket",transports:["websocket","polling"],timeout:2e4,reconnection:!0,reconnectionAttempts:10,reconnectionDelay:500,auth:{token:r}});n.current=i,i.on("connect",()=>{o(!0),s(i),t&&a.userId&&a.role&&i.emit("join_class",{roomId:t,userId:a.userId,name:a.name||a.role,role:a.role})}),i.on("disconnect",()=>{o(!1),s(null)}),i.on("connect_error",e=>{console.warn("Socket connection error:",e?.message||e),o(!1)})})(),()=>{n.current?.disconnect(),n.current=null}},[t,a.name,a.role,a.userId]),{socket:i,isConnected:l}}function p(e,t){return Number.isFinite(e)&&Number.isFinite(t)&&!(t<=0)?Math.max(0,Math.min(100,e/t*100)):0}function m(e,t){return Number.isFinite(e)&&Number.isFinite(t)&&!(t<=0)?e/100*t:0}async function g(e){try{let t=Function("name","return import(name)");return await t(e)}catch{return null}}function b({roomId:f,role:b="tutor",initialPdfUrl:w,forceLocked:y,showLockControl:x,showCollabStatus:k=!0,showAiActions:v=!0,capabilities:j}){let{data:C}=(0,a.useSession)(),S=(0,r.useRef)(null),A=(0,r.useRef)(null),N=(0,r.useRef)(null),B=(0,r.useRef)(null),D=(0,r.useRef)(0),T=(0,r.useRef)(!1),[I,M]=(0,r.useState)("original"),[O,z]=(0,r.useState)(null),[_,P]=(0,r.useState)(null),[R,W]=(0,r.useState)(1),[U,E]=(0,r.useState)(1),[F,L]=(0,r.useState)(""),[H,$]=(0,r.useState)(""),[V,J]=(0,r.useState)(!1),[q,G]=(0,r.useState)("draw"),[K,X]=(0,r.useState)("#ef4444"),[Y,Q]=(0,r.useState)(2),Z=C?.user?.id,ee=C?.user?.name||"Tutor",et=(0,r.useMemo)(()=>({draw:j?.draw??!0,erase:j?.erase??!0,select:j?.select??!0,text:j?.text??!0,shapes:j?.shapes??!0,clear:j?.clear??!0,flatten:j?.flatten??!0}),[j]),er=(0,r.useCallback)((e,t,r)=>{let a={...e,..."number"==typeof e.left?{left:m(e.left,t)}:{},..."number"==typeof e.top?{top:m(e.top,r)}:{},..."number"==typeof e.width?{width:m(e.width,t)}:{},..."number"==typeof e.height?{height:m(e.height,r)}:{},..."number"==typeof e.radius?{radius:m(e.radius,Math.min(t,r))}:{},..."number"==typeof e.strokeWidth?{strokeWidth:m(e.strokeWidth,Math.min(t,r))}:{},..."number"==typeof e.fontSize?{fontSize:m(e.fontSize,r)}:{}};return Array.isArray(a.points)&&(a.points=a.points.map(e=>({x:m(e.x,t),y:m(e.y,r)}))),Array.isArray(a.path)&&(a.path=a.path.map(e=>{if(!Array.isArray(e)||e.length<3)return e;let[a,...n]=e,i=[String(a)];for(let e=0;e<n.length;e+=2){let a=Number(n[e]),s=Number(n[e+1]);i.push(m(a,t),m(s,r))}return i})),a},[]),ea=(0,r.useCallback)((e,t,r)=>{let a=e.toObject(["id","type","left","top","width","height","radius","scaleX","scaleY","strokeWidth","fontSize","angle","fill","stroke","text","path","points"]),n={...a,id:a.id||`${Date.now()}-${Math.random().toString(16).slice(2)}`,..."number"==typeof a.left?{left:p(a.left,t)}:{},..."number"==typeof a.top?{top:p(a.top,r)}:{},..."number"==typeof a.width?{width:p(a.width,t)}:{},..."number"==typeof a.height?{height:p(a.height,r)}:{},..."number"==typeof a.radius?{radius:p(a.radius,Math.min(t,r))}:{},..."number"==typeof a.strokeWidth?{strokeWidth:p(a.strokeWidth,Math.min(t,r))}:{},..."number"==typeof a.fontSize?{fontSize:p(a.fontSize,r)}:{}};return Array.isArray(n.points)&&(n.points=n.points.map(e=>({x:p(e.x,t),y:p(e.y,r)}))),Array.isArray(n.path)&&(n.path=n.path.map(e=>{if(!Array.isArray(e)||e.length<3)return e;let[a,...n]=e,i=[String(a)];for(let e=0;e<n.length;e+=2){let a=Number(n[e]),s=Number(n[e+1]);i.push(p(a,t),p(s,r))}return i})),n},[]),en=(0,r.useCallback)(async e=>{if(e.page!==R)return;let t=N.current;if(t&&e.actorId!==Z){T.current=!0;try{if("removed"===e.action&&e.objectId){let r=t.getObjects().find(t=>t.id===e.objectId);r&&(t.remove(r),t.renderAll());return}if(!e.object)return;let r=t.getWidth(),a=t.getHeight(),n=er(e.object,r,a);if(!n.id)return;let i=t.getObjects().find(e=>e.id===n.id);if(i){i.set(n),i.setCoords(),t.renderAll();return}let s=await g("fabric"),l=s?.fabric||s,o=l?.util?.enlivenObjects;"function"==typeof o&&o([n],e=>{e?.[0]&&(t.add(e[0]),t.renderAll())})}finally{setTimeout(()=>{T.current=!1},16)}}},[er,R,Z]),{isConnected:ei,isLocked:es,latencyMs:el,participants:eo,emitCanvasEvent:ec,setLock:eu}=function({roomId:e,userId:t,name:a,role:n="tutor",onCanvasEvent:i,onCanvasState:s,onPresenceState:l}){let{socket:o,isConnected:c}=h(e,{userId:t,name:a,role:n}),[u,d]=(0,r.useState)(!1),[f,p]=(0,r.useState)(null),[m,g]=(0,r.useState)([]);(0,r.useEffect)(()=>{if(!o||!e)return;o.emit("pdf_join_room",{roomId:e,userId:t,name:a,role:n});let r=e=>{"number"==typeof e.sentAt&&p(Math.max(0,Date.now()-e.sentAt)),i?.(e)},c=t=>{t.roomId===e&&d(t.locked)},u=t=>{t.roomId===e&&s?.(t)},f=t=>{t.roomId===e&&(g(t.participants||[]),l?.(t))};return o.on("pdf_canvas_event",r),o.on("pdf_lock_state",c),o.on("pdf_canvas_state",u),o.on("pdf_presence_state",f),o.emit("pdf_request_state",{roomId:e}),()=>{o.off("pdf_canvas_event",r),o.off("pdf_lock_state",c),o.off("pdf_canvas_state",u),o.off("pdf_presence_state",f)}},[o,e,t,a,n,i,s,l]);let b=(0,r.useCallback)(r=>{o&&e&&o.emit("pdf_canvas_event",{roomId:e,actorId:t,sentAt:Date.now(),...r})},[o,e,t]),w=(0,r.useCallback)(t=>{o&&e&&o.emit("pdf_lock_toggle",{roomId:e,locked:t})},[o,e]);return(0,r.useMemo)(()=>({socket:o,isConnected:c,isLocked:u,latencyMs:f,participants:m,emitCanvasEvent:b,setLock:w}),[o,c,u,f,m,b,w])}({roomId:f,userId:Z,name:ee,role:b,onCanvasEvent:en,onCanvasState:(0,r.useCallback)(async e=>{let t=N.current;if(!t)return;let r=new Map;for(let t of e.events)if(t.page===R&&t.objectId){if("removed"===t.action){r.delete(t.objectId);continue}r.set(t.objectId,t)}T.current=!0;try{t.clear();let e=t.getWidth(),a=t.getHeight(),n=await g("fabric"),i=n?.fabric||n,s=i?.util?.enlivenObjects;if("function"!=typeof s)return;let l=Array.from(r.values()).map(e=>e.object).filter(e=>!!e).map(t=>er(t,e,a));s(l,e=>{e.forEach(e=>t.add(e)),t.renderAll()})}finally{setTimeout(()=>{T.current=!1},16)}},[er,R])}),ed="boolean"==typeof y?y:es,ef=et.draw&&!ed,eh=et.erase&&!ed,ep=et.select&&!ed;(0,r.useEffect)(()=>{"draw"!==q||et.draw?"erase"!==q||et.erase?"select"!==q||et.select||G(et.draw?"draw":"erase"):G(et.draw?"draw":"select"):G(et.erase?"erase":"select")},[et.draw,et.erase,et.select,q]);let em=(0,r.useCallback)(async(e,t)=>{let r=S.current;if(!r||!e)return;let a=++D.current;if(B.current){try{B.current.cancel?.()}catch{}B.current=null}let n=await e.getPage(t),i=n.getViewport({scale:1.35});r.width=i.width,r.height=i.height;let s=r.getContext("2d");if(!s)return;let l=n.render({canvasContext:s,viewport:i});B.current=l;try{await l.promise}catch(e){if(e?.name==="RenderingCancelledException")return;throw e}finally{B.current===l&&(B.current=null)}if(D.current!==a)return;let o=A.current;o&&(o.width=i.width,o.height=i.height,o.style.width=`${i.width}px`,o.style.height=`${i.height}px`),N.current&&(N.current.setDimensions({width:i.width,height:i.height}),N.current.renderAll())},[]),eg=(0,r.useCallback)(async()=>{if(A.current&&!N.current)try{let e=await g("fabric"),t=e?.fabric||e;if(!t?.Canvas){console.error("[PDFCollaborativeViewer] fabric library not found. Please run: npm install fabric"),J(!1);return}let r=new t.Canvas(A.current,{isDrawingMode:!0,selection:!0});r.freeDrawingBrush.width=2,r.freeDrawingBrush.color="#ef4444",N.current=r,J(!0);let a=(e,t)=>{if(!t||T.current)return;let a=r.getWidth(),n=r.getHeight(),i=ea(t,a,n);t.id=i.id,ec({page:R,action:e,object:i,objectId:i.id})};return r.on("path:created",e=>{e?.path&&a("created",e.path)}),r.on("object:modified",e=>a("modified",e?.target)),r.on("object:removed",e=>a("removed",e?.target)),()=>{r.dispose(),N.current=null,J(!1)}}catch(e){console.error("[PDFCollaborativeViewer] Error initializing fabric:",e),J(!1)}},[ec,R,ea]);(0,r.useEffect)(()=>{let e;return eg().then(t=>{"function"==typeof t&&(e=t)}).catch(()=>{J(!1)}),()=>{if(B.current){try{B.current.cancel?.()}catch{}B.current=null}e?.()}},[eg]),(0,r.useEffect)(()=>{if(N.current){let e="draw"===q&&ef||"erase"===q&&eh;N.current.isDrawingMode=e,N.current.selection=ep,N.current.freeDrawingBrush&&(N.current.freeDrawingBrush.width=Y,N.current.freeDrawingBrush.color="erase"===q?"#ffffff":K)}},[ef,eh,ep,K,Y,q]),(0,r.useEffect)(()=>{_&&em(_,R)},[_,R,em]);let eb=async t=>{let r=t.target.files?.[0];if(!r)return;let a=await r.arrayBuffer();z(a);let n=await e.A(212496),i=n.GlobalWorkerOptions;i&&!i.workerSrc&&(i.workerSrc="/pdf.worker.min.mjs");let s=await n.getDocument({data:a}).promise;P(s),E(s.numPages),W(1),await em(s,1)};(0,r.useEffect)(()=>{if(!w)return;let t=!1;return(async()=>{try{let r=await fetch(w,{credentials:"include"});if(!r.ok)return;let a=await r.arrayBuffer();if(t)return;z(a);let n=await e.A(212496),i=n.GlobalWorkerOptions;i&&!i.workerSrc&&(i.workerSrc="/pdf.worker.min.mjs");let s=await n.getDocument({data:a}).promise;if(t)return;P(s),E(s.numPages),W(1),await em(s,1)}catch{}})(),()=>{t=!0}},[w,em]);let ew=async()=>{let e=S.current?.toDataURL("image/png");if(!e)return;let t=await fetch("/api/pdf-tutoring/read",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageDataUrl:e})}),r=await t.json();L(r.markdown||r.content||""),M("cleaned")},ey=async()=>{let e=S.current?.toDataURL("image/png");if(!e)return;let t=await fetch("/api/pdf-tutoring/mark",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageDataUrl:e,rubric:"Award partial credit for correct setup and intermediate algebraic transformations."})}),r=await t.json();$(JSON.stringify(r.result||r,null,2)),M("marked")},ex=async()=>{let e=N.current;if(!e||!H)return;let t=null;try{t=JSON.parse(H)}catch{return}let r=Array.isArray(t?.mistakeLocations)?t.mistakeLocations:[];if(0===r.length)return;let a=await g("fabric"),n=a?.fabric||a;if(!n?.Circle)return;let i=e.getWidth(),s=e.getHeight();r.forEach((t,r)=>{let a="number"==typeof t?.x?t.x:40+30*r,l="number"==typeof t?.y?t.y:40+22*r,o=a<=100?m(a,i):a,c=l<=100?m(l,s):l,u=new n.Circle({id:`ai-mistake-${Date.now()}-${r}`,left:Math.max(8,o-18),top:Math.max(8,c-18),radius:18,fill:"rgba(239,68,68,0.06)",stroke:"#ef4444",strokeWidth:2,selectable:!0});e.add(u)}),e.renderAll()},ek=async()=>{if(!O||!N.current)return;let e=new Uint8Array(O),t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);let r=btoa(t),a=N.current,n={originalPdfBase64:r,fabric:{page:R,width:a.getWidth(),height:a.getHeight(),objects:a.getObjects().map(e=>ea(e,a.getWidth(),a.getHeight()))}},i=await fetch("/api/pdf-tutoring/flatten",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!i.ok)return;let s=await i.blob(),l=URL.createObjectURL(s);window.open(l,"_blank","noopener,noreferrer")},ev=async()=>{let e=N.current;if(!e||ed||!et.text)return;let t=await g("fabric"),r=t?.fabric||t;if(!r?.IText)return;let a=new r.IText("Type here",{id:`text-${Date.now()}`,left:48,top:48,fill:"#ef4444",fontSize:20,editable:!0});e.add(a),e.setActiveObject(a),a.enterEditing?.(),e.renderAll()},ej=async()=>{let e=N.current;if(!e||ed||!et.shapes)return;let t=await g("fabric"),r=t?.fabric||t;if(!r?.Rect)return;let a=new r.Rect({id:`rect-${Date.now()}`,left:48,top:48,width:140,height:90,fill:"transparent",stroke:K,strokeWidth:Y});e.add(a),e.setActiveObject(a),e.renderAll()},eC=async()=>{let e=N.current;if(!e||ed||!et.shapes)return;let t=await g("fabric"),r=t?.fabric||t;if(!r?.Circle)return;let a=new r.Circle({id:`circle-${Date.now()}`,left:48,top:48,radius:55,fill:"transparent",stroke:K,strokeWidth:Y});e.add(a),e.setActiveObject(a),e.renderAll()},eS=(0,r.useCallback)(async()=>{let e=N.current;e&&await fetch("/api/pdf-tutoring/snapshots",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:f,page:R,width:e.getWidth(),height:e.getHeight(),objects:e.getObjects().map(t=>ea(t,e.getWidth(),e.getHeight()))})})},[f,R,ea]);(0,r.useEffect)(()=>{if("tutor"!==b)return;let e=setInterval(()=>{let e=N.current;e&&0!==(e.getObjects?.()||[]).length&&eS()},6e4);return()=>clearInterval(e)},[b,eS]);let eA=async()=>{let e=N.current;if(!e)return;let t=await fetch(`/api/pdf-tutoring/snapshots?roomId=${encodeURIComponent(f)}&limit=1`,{credentials:"include"});if(!t.ok)return;let r=await t.json(),a=r?.snapshots?.[0],n=a?.pages?.[0];if(!n?.objects||!Array.isArray(n.objects))return;e.clear();let i=e.getWidth(),s=e.getHeight(),l=await g("fabric"),o=l?.fabric||l,c=o?.util?.enlivenObjects;"function"!=typeof c||c(n.objects.map(e=>er(e,i,s)),t=>{t.forEach(t=>e.add(t)),e.renderAll()})},eN=(0,r.useMemo)(()=>ei?null!==el&&el>50?(0,t.jsxs)(i.Badge,{variant:"secondary",children:["Sync ",el,"ms"]}):(0,t.jsx)(i.Badge,{variant:"default",children:"Sync <50ms"}):(0,t.jsx)(i.Badge,{variant:"destructive",children:"Offline"}),[ei,el]),eB=(0,r.useMemo)(()=>{let e=eo.length,t=eo.filter(e=>"tutor"===e.role).length;return{total:e,tutors:t,students:e-t}},[eo]);return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsx)(l.Input,{type:"file",accept:"application/pdf",onChange:eb,className:"max-w-sm"}),k&&eN,k&&(0,t.jsxs)(i.Badge,{variant:"outline",children:["Live: ",eB.total," (",eB.tutors," tutor, ",eB.students," students)"]}),k&&(0,t.jsx)(i.Badge,{variant:es?"destructive":"secondary",children:ed?"Canvas Locked":"Canvas Unlocked"}),(x??"tutor"===b)&&(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:()=>eu(!ed),children:[ed?(0,t.jsx)(c.Unlock,{className:"w-4 h-4 mr-2"}):(0,t.jsx)(o.Lock,{className:"w-4 h-4 mr-2"}),ed?"Unlock Canvas":"Lock Canvas"]}),v&&(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:ew,children:[(0,t.jsx)(d.RefreshCw,{className:"w-4 h-4 mr-2"}),"AI Cleaned Text"]}),v&&(0,t.jsx)(n.Button,{variant:"outline",size:"sm",onClick:ey,children:"Run AI Marking"}),v&&(0,t.jsx)(n.Button,{variant:"outline",size:"sm",onClick:ex,children:"Apply AI Error Circles"}),et.text&&(0,t.jsx)(n.Button,{variant:"outline",size:"sm",onClick:ev,disabled:ed,children:"Add Text"}),et.shapes&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.Button,{variant:"outline",size:"sm",onClick:ej,disabled:ed,children:"Rectangle"}),(0,t.jsx)(n.Button,{variant:"outline",size:"sm",onClick:eC,disabled:ed,children:"Circle"})]}),(0,t.jsx)(n.Button,{variant:"draw"===q?"default":"outline",size:"sm",onClick:()=>G("draw"),disabled:!ef,children:"Draw"}),(0,t.jsx)(n.Button,{variant:"erase"===q?"default":"outline",size:"sm",onClick:()=>G("erase"),disabled:!eh,children:"Erase"}),(0,t.jsx)(n.Button,{variant:"select"===q?"default":"outline",size:"sm",onClick:()=>G("select"),disabled:!ep,children:"Select"}),(0,t.jsxs)("label",{className:"flex items-center gap-1 text-xs",children:["Color",(0,t.jsx)("input",{type:"color",value:K,onChange:e=>X(e.target.value),disabled:ed||!ef&&!eh,className:"h-7 w-10 rounded border"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-1 text-xs",children:["Width",(0,t.jsx)("input",{type:"range",min:1,max:10,step:1,value:Y,onChange:e=>Q(Number(e.target.value)),disabled:ed||!ef&&!eh}),(0,t.jsx)("span",{children:Y})]}),et.clear&&(0,t.jsx)(n.Button,{variant:"outline",size:"sm",onClick:()=>{let e=N.current;e&&!ed&&et.clear&&(e.clear(),e.renderAll())},disabled:ed,children:"Clear"}),"tutor"===b&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.Button,{variant:"outline",size:"sm",onClick:eS,children:"Save Snapshot"}),(0,t.jsx)(n.Button,{variant:"outline",size:"sm",onClick:eA,children:"Load Latest Snapshot"})]}),et.flatten&&(0,t.jsx)(n.Button,{size:"sm",onClick:ek,children:"Flatten PDF"})]}),(0,t.jsx)(s.Tabs,{value:I,onValueChange:e=>M(e),children:(0,t.jsxs)(s.TabsList,{children:[(0,t.jsx)(s.TabsTrigger,{value:"original",children:"Original View"}),v&&(0,t.jsx)(s.TabsTrigger,{value:"cleaned",children:"AI Cleaned Text"}),(0,t.jsx)(s.TabsTrigger,{value:"marked",children:"Marked Feedback"})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(n.Button,{variant:"outline",size:"sm",disabled:R<=1,onClick:()=>W(e=>e-1),children:"Prev"}),(0,t.jsxs)("span",{className:"text-sm",children:["Page ",R," / ",U]}),(0,t.jsx)(n.Button,{variant:"outline",size:"sm",disabled:R>=U,onClick:()=>W(e=>e+1),children:"Next"}),!V&&(0,t.jsx)(i.Badge,{variant:"secondary",children:"Install `fabric` package to enable drawing sync"})]}),"original"===I&&(0,t.jsxs)("div",{className:"relative inline-block border rounded-md overflow-hidden bg-white",children:[(0,t.jsx)("canvas",{ref:S,className:"block"}),(0,t.jsx)("canvas",{ref:A,className:"absolute inset-0"})]}),"cleaned"===I&&v&&(0,t.jsx)("pre",{className:"rounded-md border bg-muted p-4 text-xs whitespace-pre-wrap",children:F||"No cleaned text generated yet."}),"marked"===I&&(0,t.jsx)("pre",{className:"rounded-md border bg-muted p-4 text-xs whitespace-pre-wrap",children:H||"No marking feedback generated yet."}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[(0,t.jsx)(u.Upload,{className:"w-3.5 h-3.5"}),"Coordinates are normalized as 0-100 percentages before sync for cross-device consistency."]})]})}e.s(["useSimpleSocket",()=>h],102037),e.s(["PDFCollaborativeViewer",()=>b],252186)},984728,e=>{"use strict";var t=e.i(251474),r=e.i(800592),a=e.i(624842),n=e.i(536105),i=e.i(252186);function s(){let{data:e}=(0,a.useSession)(),s=(0,n.useSearchParams)(),l=(0,r.useMemo)(()=>{let t=s.get("room");if(t)return t;let r=e?.user?.id||"anonymous-student";return`pdf-student-${r}`},[s,e?.user?.id]),o=(0,r.useMemo)(()=>s.get("doc")||void 0,[s]);return(0,t.jsxs)("div",{className:"space-y-6 p-4 md:p-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold",children:"Student PDF Tutoring"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Join tutor-led PDF sessions. Drawing lock state is controlled by tutor."})]}),(0,t.jsx)(i.PDFCollaborativeViewer,{roomId:l,role:"student",initialPdfUrl:o})]})}e.s(["default",()=>s])},913435,e=>{e.v(t=>Promise.all(["static/chunks/4d93f04943f3834f.js"].map(t=>e.l(t))).then(()=>t(978800)))},212496,e=>{e.v(t=>Promise.all(["static/chunks/eeae240ce306ce61.js","static/chunks/532fd208a40af2fb.js"].map(t=>e.l(t))).then(()=>t(885687)))}]);

//# debugId=920aba67-c632-e57e-889b-cbb121b0016b
//# sourceMappingURL=5fac5dd9c3d82f30.js.map