{
  "version": 3,
  "sources": [],
  "debugId": "f224838e-7c93-2f6b-1da2-9643f81a0a40",
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <p\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,qQAAgB,CAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC;QACC,KAAK;QACL,WAAW,IAAA,2KAAE,EACX,4DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,qQAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC;QACC,KAAK;QACL,WAAW,IAAA,2KAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,qQAAgB,CAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC;QACC,KAAK;QACL,WAAW,IAAA,2KAAE,EACX,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,qQAAgB,CAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC;QACC,KAAK;QACL,WAAW,IAAA,2KAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,qQAAgB,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC;QAAI,KAAK;QAAK,WAAW,IAAA,2KAAE,EAAC,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,qQAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC;QACC,KAAK;QACL,WAAW,IAAA,2KAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 90, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AAEA;;;;AAEA,MAAM,gBAAgB,IAAA,yNAAG,EACvB,0KACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SAAS;QACX;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAOF,SAAS,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAmB;IACzD,qBACE,gSAAC;QAAI,WAAW,IAAA,2KAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QAAa,GAAG,KAAK;;;;;;AAExE"}},
    {"offset": {"line": 132, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/tabs.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n"],"names":[],"mappings":";;;;;;;;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,OAAO,0NAAkB;AAE/B,MAAM,yBAAW,qQAAgB,CAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC,0NAAkB;QACjB,KAAK;QACL,WAAW,IAAA,2KAAE,EACX,8FACA;QAED,GAAG,KAAK;;;;;;AAGb,SAAS,WAAW,GAAG,0NAAkB,CAAC,WAAW;AAErD,MAAM,4BAAc,qQAAgB,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC,6NAAqB;QACpB,KAAK;QACL,WAAW,IAAA,2KAAE,EACX,uYACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,6NAAqB,CAAC,WAAW;AAE3D,MAAM,4BAAc,qQAAgB,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC,6NAAqB;QACpB,KAAK;QACL,WAAW,IAAA,2KAAE,EACX,mIACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,6NAAqB,CAAC,WAAW"}},
    {"offset": {"line": 187, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/dialog.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,SAAS,4NAAoB;AAEnC,MAAM,gBAAgB,+NAAuB;AAE7C,MAAM,eAAe,8NAAsB;AAE3C,MAAM,cAAc,6NAAqB;AAEzC,MAAM,8BAAgB,qQAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC,+NAAuB;QACtB,KAAK;QACL,WAAW,IAAA,2KAAE,EACX,0JACA;QAED,GAAG,KAAK;;;;;;AAGb,cAAc,WAAW,GAAG,+NAAuB,CAAC,WAAW;AAE/D,MAAM,8BAAgB,qQAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,gSAAC;;0BACC,gSAAC;;;;;0BACD,gSAAC,+NAAuB;gBACtB,KAAK;gBACL,WAAW,IAAA,2KAAE,EACX,+fACA;gBAED,GAAG,KAAK;;oBAER;kCACD,gSAAC,6NAAqB;wBAAC,WAAU;;0CAC/B,gSAAC,mPAAC;gCAAC,WAAU;;;;;;0CACb,gSAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAKlC,cAAc,WAAW,GAAG,+NAAuB,CAAC,WAAW;AAE/D,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,gSAAC;QACC,WAAW,IAAA,2KAAE,EACX,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,aAAa,WAAW,GAAG;AAE3B,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,gSAAC;QACC,WAAW,IAAA,2KAAE,EACX,iEACA;QAED,GAAG,KAAK;;;;;;AAGb,aAAa,WAAW,GAAG;AAE3B,MAAM,4BAAc,qQAAgB,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC,6NAAqB;QACpB,KAAK;QACL,WAAW,IAAA,2KAAE,EACX,qDACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,6NAAqB,CAAC,WAAW;AAE3D,MAAM,kCAAoB,qQAAgB,CAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC,mOAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,2KAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG,mOAA2B,CAAC,WAAW"}},
    {"offset": {"line": 327, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/slider.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as SliderPrimitive from '@radix-ui/react-slider'\n\nimport { cn } from '@/lib/utils'\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      'relative flex w-full touch-none select-none items-center',\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,uBAAS,qQAAgB,CAG7B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC,4NAAoB;QACnB,KAAK;QACL,WAAW,IAAA,2KAAE,EACX,4DACA;QAED,GAAG,KAAK;;0BAET,gSAAC,6NAAqB;gBAAC,WAAU;0BAC/B,cAAA,gSAAC,6NAAqB;oBAAC,WAAU;;;;;;;;;;;0BAEnC,gSAAC,6NAAqB;gBAAC,WAAU;;;;;;;;;;;;AAGrC,OAAO,WAAW,GAAG,4NAAoB,CAAC,WAAW"}},
    {"offset": {"line": 378, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/scroll-area.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,2BAAa,qQAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,gSAAC,oOAAwB;QACvB,KAAK;QACL,WAAW,IAAA,2KAAE,EAAC,4BAA4B;QACzC,GAAG,KAAK;;0BAET,gSAAC,wOAA4B;gBAAC,WAAU;0BACrC;;;;;;0BAEH,gSAAC;;;;;0BACD,gSAAC,sOAA0B;;;;;;;;;;;AAG/B,WAAW,WAAW,GAAG,oOAAwB,CAAC,WAAW;AAE7D,MAAM,0BAAY,qQAAgB,CAGhC,CAAC,EAAE,SAAS,EAAE,cAAc,UAAU,EAAE,GAAG,OAAO,EAAE,oBACpD,gSAAC,mPAAuC;QACtC,KAAK;QACL,aAAa;QACb,WAAW,IAAA,2KAAE,EACX,iDACA,gBAAgB,cACd,sDACF,gBAAgB,gBACd,wDACF;QAED,GAAG,KAAK;kBAET,cAAA,gSAAC,+OAAmC;YAAC,WAAU;;;;;;;;;;;AAGnD,UAAU,WAAW,GAAG,mPAAuC,CAAC,WAAW"}},
    {"offset": {"line": 446, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/select.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectItem,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAEA;AACA;AACA;AAAA;AAEA;AANA;;;;;;AAQA,MAAM,SAAS,4NAAoB;AAEnC,MAAM,cAAc,6NAAqB;AAEzC,MAAM,cAAc,6NAAqB;AAEzC,MAAM,8BAAgB,qQAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,gSAAC,+NAAuB;QACtB,KAAK;QACL,WAAW,IAAA,2KAAE,EACX,mTACA;QAED,GAAG,KAAK;;YAER;0BACD,gSAAC,4NAAoB;gBAAC,OAAO;0BAC3B,cAAA,gSAAC,qRAAW;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAI7B,cAAc,WAAW,GAAG,+NAAuB,CAAC,WAAW;AAE/D,MAAM,8BAAgB,qQAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,WAAW,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACzD,gSAAC,8NAAsB;kBACrB,cAAA,gSAAC,+NAAuB;YACtB,KAAK;YACL,WAAW,IAAA,2KAAE,EACX,ucACA,aAAa,YACX,mIACF;YAEF,UAAU;YACT,GAAG,KAAK;sBAET,cAAA,gSAAC,gOAAwB;gBACvB,WAAW,IAAA,2KAAE,EACX,OACA,aAAa,YACX;0BAGH;;;;;;;;;;;;;;;;AAKT,cAAc,WAAW,GAAG,+NAAuB,CAAC,WAAW;AAE/D,MAAM,2BAAa,qQAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,gSAAC,4NAAoB;QACnB,KAAK;QACL,WAAW,IAAA,2KAAE,EACX,6NACA;QAED,GAAG,KAAK;;0BAET,gSAAC;gBAAK,WAAU;0BACd,cAAA,gSAAC,qOAA6B;8BAC5B,cAAA,gSAAC,+PAAK;wBAAC,WAAU;;;;;;;;;;;;;;;;0BAIrB,gSAAC,gOAAwB;0BAAE;;;;;;;;;;;;AAG/B,WAAW,WAAW,GAAG,4NAAoB,CAAC,WAAW"}},
    {"offset": {"line": 571, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nexport interface InputProps\n  extends React.InputHTMLAttributes<HTMLInputElement> {}\n\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 min-h-[44px] sm:min-h-0 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAKA,MAAM,sBAAQ,qQAAgB,CAC5B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,gSAAC;QACC,MAAM;QACN,WAAW,IAAA,2KAAE,EACX,wXACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,MAAM,WAAW,GAAG"}},
    {"offset": {"line": 599, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,gBAAgB,IAAA,yNAAG,EACvB;AAGF,MAAM,sBAAQ,qQAAgB,CAI5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC,2NAAmB;QAClB,KAAK;QACL,WAAW,IAAA,2KAAE,EAAC,iBAAiB;QAC9B,GAAG,KAAK;;;;;;AAGb,MAAM,WAAW,GAAG,2NAAmB,CAAC,WAAW"}},
    {"offset": {"line": 630, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nexport interface TextareaProps\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\n  ({ className, ...props }, ref) => {\n    return (\n      <textarea\n        className={cn(\n          \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAKA,MAAM,yBAAW,qQAAgB,CAC/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IACxB,qBACE,gSAAC;QACC,WAAW,IAAA,2KAAE,EACX,wSACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,SAAS,WAAW,GAAG"}},
    {"offset": {"line": 657, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/switch.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,uBAAS,qQAAgB,CAG7B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC,4NAAqB;QACpB,WAAW,IAAA,2KAAE,EACX,sXACA;QAED,GAAG,KAAK;QACT,KAAK;kBAEL,cAAA,gSAAC,6NAAsB;YACrB,WAAW,IAAA,2KAAE,EACX;;;;;;;;;;;AAKR,OAAO,WAAW,GAAG,4NAAqB,CAAC,WAAW"}},
    {"offset": {"line": 692, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/separator.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\n\ninterface SeparatorProps extends React.HTMLAttributes<HTMLDivElement> {\n  orientation?: \"horizontal\" | \"vertical\"\n  decorative?: boolean\n}\n\nconst Separator = React.forwardRef<HTMLDivElement, SeparatorProps>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <div\n      ref={ref}\n      role={decorative ? \"none\" : \"separator\"}\n      aria-orientation={decorative ? undefined : orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = \"Separator\"\n\nexport { Separator }\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAOA,MAAM,0BAAY,qQAAgB,CAChC,CACE,EAAE,SAAS,EAAE,cAAc,YAAY,EAAE,aAAa,IAAI,EAAE,GAAG,OAAO,EACtE,oBAEA,gSAAC;QACC,KAAK;QACL,MAAM,aAAa,SAAS;QAC5B,oBAAkB,aAAa,YAAY;QAC3C,WAAW,IAAA,2KAAE,EACX,sBACA,gBAAgB,eAAe,mBAAmB,kBAClD;QAED,GAAG,KAAK;;;;;;AAIf,UAAU,WAAW,GAAG"}},
    {"offset": {"line": 719, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/pdf-tutoring/PDFCollaborativeViewer.tsx"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\n'use client'\n\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react'\nimport { useSession } from 'next-auth/react'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Tabs, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { Input } from '@/components/ui/input'\nimport { Lock, Unlock, Upload, RefreshCw } from 'lucide-react'\nimport { usePdfCollabSocket } from '@/hooks/use-pdf-collab-socket'\nimport { percentToPx, pxToPercent } from '@/lib/pdf-tutoring/coordinates'\nimport type { PdfCanvasEventPayload, PdfViewMode, PercentFabricObject } from '@/lib/pdf-tutoring/types'\n\nasync function loadOptionalModule(moduleName: string): Promise<any | null> {\n  try {\n    const importer = new Function('name', 'return import(name)') as (name: string) => Promise<any>\n    return await importer(moduleName)\n  } catch {\n    return null\n  }\n}\n\ninterface PDFCollaborativeViewerProps {\n  roomId: string\n  role?: 'tutor' | 'student'\n  initialPdfUrl?: string\n  forceLocked?: boolean\n  showLockControl?: boolean\n  showCollabStatus?: boolean\n  showAiActions?: boolean\n  capabilities?: {\n    draw?: boolean\n    erase?: boolean\n    select?: boolean\n    text?: boolean\n    shapes?: boolean\n    clear?: boolean\n    flatten?: boolean\n  }\n}\n\nexport function PDFCollaborativeViewer({\n  roomId,\n  role = 'tutor',\n  initialPdfUrl,\n  forceLocked,\n  showLockControl,\n  showCollabStatus = true,\n  showAiActions = true,\n  capabilities,\n}: PDFCollaborativeViewerProps) {\n  const { data: session } = useSession()\n  const pdfCanvasRef = useRef<HTMLCanvasElement>(null)\n  const fabricCanvasElementRef = useRef<HTMLCanvasElement>(null)\n  const fabricInstanceRef = useRef<any>(null)\n  const renderTaskRef = useRef<any>(null)\n  const renderSeqRef = useRef(0)\n  const suppressBroadcastRef = useRef(false)\n\n  const [mode, setMode] = useState<PdfViewMode>('original')\n  const [pdfBytes, setPdfBytes] = useState<ArrayBuffer | null>(null)\n  const [pdfDoc, setPdfDoc] = useState<any>(null)\n  const [pageNum, setPageNum] = useState(1)\n  const [pageCount, setPageCount] = useState(1)\n  const [cleanedText, setCleanedText] = useState('')\n  const [markedFeedback, setMarkedFeedback] = useState('')\n  const [fabricReady, setFabricReady] = useState(false)\n  const [tool, setTool] = useState<'draw' | 'erase' | 'select'>('draw')\n  const [strokeColor, setStrokeColor] = useState('#ef4444')\n  const [strokeWidth, setStrokeWidth] = useState(2)\n\n  const userId = session?.user?.id\n  const userName = session?.user?.name || 'Tutor'\n  const effectiveCapabilities = useMemo(() => ({\n    draw: capabilities?.draw ?? true,\n    erase: capabilities?.erase ?? true,\n    select: capabilities?.select ?? true,\n    text: capabilities?.text ?? true,\n    shapes: capabilities?.shapes ?? true,\n    clear: capabilities?.clear ?? true,\n    flatten: capabilities?.flatten ?? true,\n  }), [capabilities])\n\n  const applyObjectPercentToPx = useCallback((object: PercentFabricObject, width: number, height: number) => {\n    const next: PercentFabricObject = {\n      ...object,\n      ...(typeof object.left === 'number' ? { left: percentToPx(object.left, width) } : {}),\n      ...(typeof object.top === 'number' ? { top: percentToPx(object.top, height) } : {}),\n      ...(typeof object.width === 'number' ? { width: percentToPx(object.width, width) } : {}),\n      ...(typeof object.height === 'number' ? { height: percentToPx(object.height, height) } : {}),\n      ...(typeof object.radius === 'number' ? { radius: percentToPx(object.radius, Math.min(width, height)) } : {}),\n      ...(typeof object.strokeWidth === 'number' ? { strokeWidth: percentToPx(object.strokeWidth, Math.min(width, height)) } : {}),\n      ...(typeof object.fontSize === 'number' ? { fontSize: percentToPx(object.fontSize, height) } : {}),\n    }\n\n    if (Array.isArray(next.points)) {\n      next.points = next.points.map((p) => ({\n        x: percentToPx(p.x, width),\n        y: percentToPx(p.y, height),\n      }))\n    }\n\n    if (Array.isArray(next.path)) {\n      next.path = next.path.map((segment) => {\n        if (!Array.isArray(segment) || segment.length < 3) return segment\n        const [cmd, ...nums] = segment\n        const converted: Array<string | number> = [String(cmd)]\n        for (let i = 0; i < nums.length; i += 2) {\n          const x = Number(nums[i])\n          const y = Number(nums[i + 1])\n          converted.push(percentToPx(x, width), percentToPx(y, height))\n        }\n        return converted\n      })\n    }\n\n    return next\n  }, [])\n\n  const serializeObjectToPercent = useCallback((obj: any, width: number, height: number): PercentFabricObject => {\n    const raw = obj.toObject([\n      'id', 'type', 'left', 'top', 'width', 'height', 'radius', 'scaleX', 'scaleY', 'strokeWidth',\n      'fontSize', 'angle', 'fill', 'stroke', 'text', 'path', 'points',\n    ]) as PercentFabricObject\n\n    const next: PercentFabricObject = {\n      ...raw,\n      id: raw.id || `${Date.now()}-${Math.random().toString(16).slice(2)}`,\n      ...(typeof raw.left === 'number' ? { left: pxToPercent(raw.left, width) } : {}),\n      ...(typeof raw.top === 'number' ? { top: pxToPercent(raw.top, height) } : {}),\n      ...(typeof raw.width === 'number' ? { width: pxToPercent(raw.width, width) } : {}),\n      ...(typeof raw.height === 'number' ? { height: pxToPercent(raw.height, height) } : {}),\n      ...(typeof raw.radius === 'number' ? { radius: pxToPercent(raw.radius, Math.min(width, height)) } : {}),\n      ...(typeof raw.strokeWidth === 'number' ? { strokeWidth: pxToPercent(raw.strokeWidth, Math.min(width, height)) } : {}),\n      ...(typeof raw.fontSize === 'number' ? { fontSize: pxToPercent(raw.fontSize, height) } : {}),\n    }\n\n    if (Array.isArray(next.points)) {\n      next.points = next.points.map((p) => ({\n        x: pxToPercent(p.x, width),\n        y: pxToPercent(p.y, height),\n      }))\n    }\n\n    if (Array.isArray(next.path)) {\n      next.path = next.path.map((segment) => {\n        if (!Array.isArray(segment) || segment.length < 3) return segment\n        const [cmd, ...nums] = segment\n        const converted: Array<string | number> = [String(cmd)]\n        for (let i = 0; i < nums.length; i += 2) {\n          const x = Number(nums[i])\n          const y = Number(nums[i + 1])\n          converted.push(pxToPercent(x, width), pxToPercent(y, height))\n        }\n        return converted\n      })\n    }\n\n    return next\n  }, [])\n\n  const onCanvasEvent = useCallback(async (payload: PdfCanvasEventPayload) => {\n    if (payload.page !== pageNum) return\n    const fabricCanvas = fabricInstanceRef.current\n    if (!fabricCanvas || payload.actorId === userId) return\n\n    suppressBroadcastRef.current = true\n    try {\n      if (payload.action === 'removed' && payload.objectId) {\n        const target = fabricCanvas.getObjects().find((obj: any) => obj.id === payload.objectId)\n        if (target) {\n          fabricCanvas.remove(target)\n          fabricCanvas.renderAll()\n        }\n        return\n      }\n\n      if (!payload.object) return\n      const width = fabricCanvas.getWidth()\n      const height = fabricCanvas.getHeight()\n      const objectData = applyObjectPercentToPx(payload.object, width, height)\n\n      if (!objectData.id) return\n      const existing = fabricCanvas.getObjects().find((obj: any) => obj.id === objectData.id)\n      if (existing) {\n        existing.set(objectData)\n        existing.setCoords()\n        fabricCanvas.renderAll()\n        return\n      }\n\n      const fabricMod = await loadOptionalModule('fabric')\n      const fabricApi = fabricMod?.fabric || fabricMod\n      const enliven = fabricApi?.util?.enlivenObjects\n      if (typeof enliven === 'function') {\n        enliven([objectData], (objects: any[]) => {\n          if (!objects?.[0]) return\n          fabricCanvas.add(objects[0])\n          fabricCanvas.renderAll()\n        })\n      }\n    } finally {\n      setTimeout(() => {\n        suppressBroadcastRef.current = false\n      }, 16)\n    }\n  }, [applyObjectPercentToPx, pageNum, userId])\n\n  const onCanvasState = useCallback(async (payload: { roomId: string; events: PdfCanvasEventPayload[] }) => {\n    const fabricCanvas = fabricInstanceRef.current\n    if (!fabricCanvas) return\n\n    // Rebuild last known state from event stream for late joiners.\n    const byId = new Map<string, PdfCanvasEventPayload>()\n    for (const evt of payload.events) {\n      if (evt.page !== pageNum || !evt.objectId) continue\n      if (evt.action === 'removed') {\n        byId.delete(evt.objectId)\n        continue\n      }\n      byId.set(evt.objectId, evt)\n    }\n\n    suppressBroadcastRef.current = true\n    try {\n      fabricCanvas.clear()\n      const width = fabricCanvas.getWidth()\n      const height = fabricCanvas.getHeight()\n      const fabricMod = await loadOptionalModule('fabric')\n      const fabricApi = fabricMod?.fabric || fabricMod\n      const enliven = fabricApi?.util?.enlivenObjects\n      if (typeof enliven !== 'function') return\n      const objects = Array.from(byId.values())\n        .map((evt) => evt.object)\n        .filter((obj): obj is PercentFabricObject => Boolean(obj))\n        .map((obj) => applyObjectPercentToPx(obj, width, height))\n      enliven(objects, (liveObjects: any[]) => {\n        liveObjects.forEach((obj) => fabricCanvas.add(obj))\n        fabricCanvas.renderAll()\n      })\n    } finally {\n      setTimeout(() => {\n        suppressBroadcastRef.current = false\n      }, 16)\n    }\n  }, [applyObjectPercentToPx, pageNum])\n\n  const { isConnected, isLocked, latencyMs, participants, emitCanvasEvent, setLock } = usePdfCollabSocket({\n    roomId,\n    userId,\n    name: userName,\n    role,\n    onCanvasEvent,\n    onCanvasState,\n  })\n  const effectiveLocked = typeof forceLocked === 'boolean' ? forceLocked : isLocked\n  const canDraw = effectiveCapabilities.draw && !effectiveLocked\n  const canErase = effectiveCapabilities.erase && !effectiveLocked\n  const canSelect = effectiveCapabilities.select && !effectiveLocked\n\n  useEffect(() => {\n    if (tool === 'draw' && !effectiveCapabilities.draw) {\n      setTool(effectiveCapabilities.erase ? 'erase' : 'select')\n      return\n    }\n    if (tool === 'erase' && !effectiveCapabilities.erase) {\n      setTool(effectiveCapabilities.draw ? 'draw' : 'select')\n      return\n    }\n    if (tool === 'select' && !effectiveCapabilities.select) {\n      setTool(effectiveCapabilities.draw ? 'draw' : 'erase')\n    }\n  }, [effectiveCapabilities.draw, effectiveCapabilities.erase, effectiveCapabilities.select, tool])\n\n  const renderPdfPage = useCallback(async (doc: any, pageIndex: number) => {\n    const canvas = pdfCanvasRef.current\n    if (!canvas || !doc) return\n    const renderToken = ++renderSeqRef.current\n    if (renderTaskRef.current) {\n      try {\n        renderTaskRef.current.cancel?.()\n      } catch {\n        // Ignore cancellation failures; we'll continue with latest render request.\n      }\n      renderTaskRef.current = null\n    }\n    const page = await doc.getPage(pageIndex)\n    const viewport = page.getViewport({ scale: 1.35 })\n    canvas.width = viewport.width\n    canvas.height = viewport.height\n\n    const ctx = canvas.getContext('2d')\n    if (!ctx) return\n    const task = page.render({ canvasContext: ctx, viewport })\n    renderTaskRef.current = task\n    try {\n      await task.promise\n    } catch (error) {\n      if ((error as { name?: string })?.name === 'RenderingCancelledException') return\n      throw error\n    } finally {\n      if (renderTaskRef.current === task) {\n        renderTaskRef.current = null\n      }\n    }\n    if (renderSeqRef.current !== renderToken) return\n\n    const overlay = fabricCanvasElementRef.current\n    if (overlay) {\n      overlay.width = viewport.width\n      overlay.height = viewport.height\n      overlay.style.width = `${viewport.width}px`\n      overlay.style.height = `${viewport.height}px`\n    }\n\n    if (fabricInstanceRef.current) {\n      fabricInstanceRef.current.setDimensions({ width: viewport.width, height: viewport.height })\n      fabricInstanceRef.current.renderAll()\n    }\n  }, [])\n\n  const initializeFabric = useCallback(async () => {\n    if (!fabricCanvasElementRef.current || fabricInstanceRef.current) return\n    try {\n      const fabricMod = await loadOptionalModule('fabric')\n      const fabricApi = fabricMod?.fabric || fabricMod\n      if (!fabricApi?.Canvas) {\n        console.error('[PDFCollaborativeViewer] fabric library not found. Please run: npm install fabric')\n        setFabricReady(false)\n        return\n      }\n\n      const fabricCanvas = new fabricApi.Canvas(fabricCanvasElementRef.current, {\n        isDrawingMode: true,\n        selection: true,\n      })\n\n      fabricCanvas.freeDrawingBrush.width = 2\n      fabricCanvas.freeDrawingBrush.color = '#ef4444'\n      fabricInstanceRef.current = fabricCanvas\n      setFabricReady(true)\n\n      const broadcast = (action: 'created' | 'modified' | 'removed', target?: any) => {\n        if (!target || suppressBroadcastRef.current) return\n        const width = fabricCanvas.getWidth()\n        const height = fabricCanvas.getHeight()\n        const objectData = serializeObjectToPercent(target, width, height)\n        target.id = objectData.id\n        emitCanvasEvent({\n          page: pageNum,\n          action,\n          object: objectData,\n          objectId: objectData.id,\n        })\n      }\n\n      fabricCanvas.on('path:created', (evt: any) => {\n        if (!evt?.path) return\n        broadcast('created', evt.path)\n      })\n      fabricCanvas.on('object:modified', (evt: any) => broadcast('modified', evt?.target))\n      fabricCanvas.on('object:removed', (evt: any) => broadcast('removed', evt?.target))\n\n      return () => {\n        fabricCanvas.dispose()\n        fabricInstanceRef.current = null\n        setFabricReady(false)\n      }\n    } catch (err) {\n      console.error('[PDFCollaborativeViewer] Error initializing fabric:', err)\n      setFabricReady(false)\n    }\n  }, [emitCanvasEvent, pageNum, serializeObjectToPercent])\n\n  useEffect(() => {\n    let dispose: (() => void) | undefined\n    initializeFabric().then((fn) => {\n      if (typeof fn === 'function') dispose = fn\n    }).catch(() => {\n      setFabricReady(false)\n    })\n    return () => {\n      if (renderTaskRef.current) {\n        try {\n          renderTaskRef.current.cancel?.()\n        } catch {\n          // no-op\n        }\n        renderTaskRef.current = null\n      }\n      dispose?.()\n    }\n  }, [initializeFabric])\n\n  useEffect(() => {\n    if (fabricInstanceRef.current) {\n      const canUseCurrentDrawTool = (tool === 'draw' && canDraw) || (tool === 'erase' && canErase)\n      fabricInstanceRef.current.isDrawingMode = canUseCurrentDrawTool\n      fabricInstanceRef.current.selection = canSelect\n      if (fabricInstanceRef.current.freeDrawingBrush) {\n        fabricInstanceRef.current.freeDrawingBrush.width = strokeWidth\n        fabricInstanceRef.current.freeDrawingBrush.color = tool === 'erase' ? '#ffffff' : strokeColor\n      }\n    }\n  }, [canDraw, canErase, canSelect, strokeColor, strokeWidth, tool])\n\n  useEffect(() => {\n    if (!pdfDoc) return\n    renderPdfPage(pdfDoc, pageNum)\n  }, [pdfDoc, pageNum, renderPdfPage])\n\n  const onFileSelected = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0]\n    if (!file) return\n    const bytes = await file.arrayBuffer()\n    setPdfBytes(bytes)\n\n    const pdfjs = await import('pdfjs-dist')\n    const opts = (pdfjs as any).GlobalWorkerOptions\n    if (opts && !opts.workerSrc) opts.workerSrc = '/pdf.worker.min.mjs'\n\n    const doc = await (pdfjs as any).getDocument({ data: bytes }).promise\n    setPdfDoc(doc)\n    setPageCount(doc.numPages)\n    setPageNum(1)\n    await renderPdfPage(doc, 1)\n  }\n\n  useEffect(() => {\n    if (!initialPdfUrl) return\n    let cancelled = false\n    const loadInitialPdf = async () => {\n      try {\n        const res = await fetch(initialPdfUrl, { credentials: 'include' })\n        if (!res.ok) return\n        const bytes = await res.arrayBuffer()\n        if (cancelled) return\n        setPdfBytes(bytes)\n        const pdfjs = await import('pdfjs-dist')\n        const opts = (pdfjs as any).GlobalWorkerOptions\n        if (opts && !opts.workerSrc) opts.workerSrc = '/pdf.worker.min.mjs'\n        const doc = await (pdfjs as any).getDocument({ data: bytes }).promise\n        if (cancelled) return\n        setPdfDoc(doc)\n        setPageCount(doc.numPages)\n        setPageNum(1)\n        await renderPdfPage(doc, 1)\n      } catch {\n        // Keep component usable even if initial URL fails to load.\n      }\n    }\n    void loadInitialPdf()\n    return () => {\n      cancelled = true\n    }\n  }, [initialPdfUrl, renderPdfPage])\n\n  const callReadService = async () => {\n    const png = pdfCanvasRef.current?.toDataURL('image/png')\n    if (!png) return\n    const res = await fetch('/api/pdf-tutoring/read', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ imageDataUrl: png }),\n    })\n    const data = await res.json()\n    setCleanedText(data.markdown || data.content || '')\n    setMode('cleaned')\n  }\n\n  const callMarkService = async () => {\n    const png = pdfCanvasRef.current?.toDataURL('image/png')\n    if (!png) return\n    const res = await fetch('/api/pdf-tutoring/mark', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        imageDataUrl: png,\n        rubric: 'Award partial credit for correct setup and intermediate algebraic transformations.',\n      }),\n    })\n    const data = await res.json()\n    setMarkedFeedback(JSON.stringify(data.result || data, null, 2))\n    setMode('marked')\n  }\n\n  const applyAiErrorCircles = async () => {\n    const canvas = fabricInstanceRef.current\n    if (!canvas || !markedFeedback) return\n\n    let parsed: any = null\n    try {\n      parsed = JSON.parse(markedFeedback)\n    } catch {\n      return\n    }\n\n    const mistakes = Array.isArray(parsed?.mistakeLocations) ? parsed.mistakeLocations : []\n    if (mistakes.length === 0) return\n\n    const fabricMod = await loadOptionalModule('fabric')\n    const fabricApi = fabricMod?.fabric || fabricMod\n    if (!fabricApi?.Circle) return\n\n    const width = canvas.getWidth()\n    const height = canvas.getHeight()\n\n    mistakes.forEach((mistake: any, idx: number) => {\n      const rawX = typeof mistake?.x === 'number' ? mistake.x : 40 + idx * 30\n      const rawY = typeof mistake?.y === 'number' ? mistake.y : 40 + idx * 22\n      const x = rawX <= 100 ? percentToPx(rawX, width) : rawX\n      const y = rawY <= 100 ? percentToPx(rawY, height) : rawY\n\n      const circle = new fabricApi.Circle({\n        id: `ai-mistake-${Date.now()}-${idx}`,\n        left: Math.max(8, x - 18),\n        top: Math.max(8, y - 18),\n        radius: 18,\n        fill: 'rgba(239,68,68,0.06)',\n        stroke: '#ef4444',\n        strokeWidth: 2,\n        selectable: true,\n      })\n      canvas.add(circle)\n    })\n\n    canvas.renderAll()\n  }\n\n  const callFlattenService = async () => {\n    if (!pdfBytes || !fabricInstanceRef.current) return\n\n    const bytes = new Uint8Array(pdfBytes)\n    let binary = ''\n    for (let i = 0; i < bytes.length; i++) binary += String.fromCharCode(bytes[i])\n    const originalPdfBase64 = btoa(binary)\n    const canvas = fabricInstanceRef.current\n    const payload = {\n      originalPdfBase64,\n      fabric: {\n        page: pageNum,\n        width: canvas.getWidth(),\n        height: canvas.getHeight(),\n        objects: canvas.getObjects().map((obj: any) => serializeObjectToPercent(obj, canvas.getWidth(), canvas.getHeight())),\n      },\n    }\n\n    const res = await fetch('/api/pdf-tutoring/flatten', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(payload),\n    })\n\n    if (!res.ok) return\n    const blob = await res.blob()\n    const url = URL.createObjectURL(blob)\n    window.open(url, '_blank', 'noopener,noreferrer')\n  }\n\n  const addTextBox = async () => {\n    const canvas = fabricInstanceRef.current\n    if (!canvas || effectiveLocked || !effectiveCapabilities.text) return\n    const fabricMod = await loadOptionalModule('fabric')\n    const fabricApi = fabricMod?.fabric || fabricMod\n    if (!fabricApi?.IText) return\n    const text = new fabricApi.IText('Type here', {\n      id: `text-${Date.now()}`,\n      left: 48,\n      top: 48,\n      fill: '#ef4444',\n      fontSize: 20,\n      editable: true,\n    })\n    canvas.add(text)\n    canvas.setActiveObject(text)\n    text.enterEditing?.()\n    canvas.renderAll()\n  }\n\n  const addRectangle = async () => {\n    const canvas = fabricInstanceRef.current\n    if (!canvas || effectiveLocked || !effectiveCapabilities.shapes) return\n    const fabricMod = await loadOptionalModule('fabric')\n    const fabricApi = fabricMod?.fabric || fabricMod\n    if (!fabricApi?.Rect) return\n    const rect = new fabricApi.Rect({\n      id: `rect-${Date.now()}`,\n      left: 48,\n      top: 48,\n      width: 140,\n      height: 90,\n      fill: 'transparent',\n      stroke: strokeColor,\n      strokeWidth,\n    })\n    canvas.add(rect)\n    canvas.setActiveObject(rect)\n    canvas.renderAll()\n  }\n\n  const addCircle = async () => {\n    const canvas = fabricInstanceRef.current\n    if (!canvas || effectiveLocked || !effectiveCapabilities.shapes) return\n    const fabricMod = await loadOptionalModule('fabric')\n    const fabricApi = fabricMod?.fabric || fabricMod\n    if (!fabricApi?.Circle) return\n    const circle = new fabricApi.Circle({\n      id: `circle-${Date.now()}`,\n      left: 48,\n      top: 48,\n      radius: 55,\n      fill: 'transparent',\n      stroke: strokeColor,\n      strokeWidth,\n    })\n    canvas.add(circle)\n    canvas.setActiveObject(circle)\n    canvas.renderAll()\n  }\n\n  const clearCurrentPage = () => {\n    const canvas = fabricInstanceRef.current\n    if (!canvas || effectiveLocked || !effectiveCapabilities.clear) return\n    canvas.clear()\n    canvas.renderAll()\n  }\n\n  const saveSnapshot = useCallback(async () => {\n    const canvas = fabricInstanceRef.current\n    if (!canvas) return\n    await fetch('/api/pdf-tutoring/snapshots', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        roomId,\n        page: pageNum,\n        width: canvas.getWidth(),\n        height: canvas.getHeight(),\n        objects: canvas.getObjects().map((obj: any) => serializeObjectToPercent(obj, canvas.getWidth(), canvas.getHeight())),\n      }),\n    })\n  }, [roomId, pageNum, serializeObjectToPercent])\n\n  useEffect(() => {\n    if (role !== 'tutor') return\n    const interval = setInterval(() => {\n      const canvas = fabricInstanceRef.current\n      if (!canvas) return\n      if ((canvas.getObjects?.() || []).length === 0) return\n      void saveSnapshot()\n    }, 60 * 1000)\n\n    return () => clearInterval(interval)\n  }, [role, saveSnapshot])\n\n  const loadLatestSnapshot = async () => {\n    const canvas = fabricInstanceRef.current\n    if (!canvas) return\n\n    const res = await fetch(`/api/pdf-tutoring/snapshots?roomId=${encodeURIComponent(roomId)}&limit=1`, {\n      credentials: 'include',\n    })\n    if (!res.ok) return\n    const data = await res.json()\n    const latest = data?.snapshots?.[0]\n    const payload = latest?.pages?.[0]\n    if (!payload?.objects || !Array.isArray(payload.objects)) return\n\n    canvas.clear()\n    const width = canvas.getWidth()\n    const height = canvas.getHeight()\n    const fabricMod = await loadOptionalModule('fabric')\n    const fabricApi = fabricMod?.fabric || fabricMod\n    const enliven = fabricApi?.util?.enlivenObjects\n    if (typeof enliven !== 'function') return\n\n    const mapped = payload.objects.map((obj: PercentFabricObject) => applyObjectPercentToPx(obj, width, height))\n    enliven(mapped, (objects: any[]) => {\n      objects.forEach((obj) => canvas.add(obj))\n      canvas.renderAll()\n    })\n  }\n\n  const connectionBadge = useMemo(() => {\n    if (!isConnected) return <Badge variant=\"destructive\">Offline</Badge>\n    if (latencyMs !== null && latencyMs > 50) return <Badge variant=\"secondary\">Sync {latencyMs}ms</Badge>\n    return <Badge variant=\"default\">Sync &lt;50ms</Badge>\n  }, [isConnected, latencyMs])\n  const participantSummary = useMemo(() => {\n    const total = participants.length\n    const tutors = participants.filter((participant) => participant.role === 'tutor').length\n    const students = total - tutors\n    return { total, tutors, students }\n  }, [participants])\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex flex-wrap items-center gap-2\">\n        <Input type=\"file\" accept=\"application/pdf\" onChange={onFileSelected} className=\"max-w-sm\" />\n        {showCollabStatus && connectionBadge}\n        {showCollabStatus && (\n          <Badge variant=\"outline\">\n            Live: {participantSummary.total} ({participantSummary.tutors} tutor, {participantSummary.students} students)\n          </Badge>\n        )}\n        {showCollabStatus && (\n          <Badge variant={isLocked ? 'destructive' : 'secondary'}>\n            {effectiveLocked ? 'Canvas Locked' : 'Canvas Unlocked'}\n          </Badge>\n        )}\n        {(showLockControl ?? role === 'tutor') && (\n          <Button variant=\"outline\" size=\"sm\" onClick={() => setLock(!effectiveLocked)}>\n            {effectiveLocked ? <Unlock className=\"w-4 h-4 mr-2\" /> : <Lock className=\"w-4 h-4 mr-2\" />}\n            {effectiveLocked ? 'Unlock Canvas' : 'Lock Canvas'}\n          </Button>\n        )}\n        {showAiActions && (\n          <Button variant=\"outline\" size=\"sm\" onClick={callReadService}>\n            <RefreshCw className=\"w-4 h-4 mr-2\" />\n            AI Cleaned Text\n          </Button>\n        )}\n        {showAiActions && <Button variant=\"outline\" size=\"sm\" onClick={callMarkService}>Run AI Marking</Button>}\n        {showAiActions && <Button variant=\"outline\" size=\"sm\" onClick={applyAiErrorCircles}>Apply AI Error Circles</Button>}\n        {effectiveCapabilities.text && (\n          <Button variant=\"outline\" size=\"sm\" onClick={addTextBox} disabled={effectiveLocked}>\n            Add Text\n          </Button>\n        )}\n        {effectiveCapabilities.shapes && (\n          <>\n            <Button variant=\"outline\" size=\"sm\" onClick={addRectangle} disabled={effectiveLocked}>\n              Rectangle\n            </Button>\n            <Button variant=\"outline\" size=\"sm\" onClick={addCircle} disabled={effectiveLocked}>\n              Circle\n            </Button>\n          </>\n        )}\n        <Button variant={tool === 'draw' ? 'default' : 'outline'} size=\"sm\" onClick={() => setTool('draw')} disabled={!canDraw}>\n          Draw\n        </Button>\n        <Button variant={tool === 'erase' ? 'default' : 'outline'} size=\"sm\" onClick={() => setTool('erase')} disabled={!canErase}>\n          Erase\n        </Button>\n        <Button variant={tool === 'select' ? 'default' : 'outline'} size=\"sm\" onClick={() => setTool('select')} disabled={!canSelect}>\n          Select\n        </Button>\n        <label className=\"flex items-center gap-1 text-xs\">\n          Color\n          <input\n            type=\"color\"\n            value={strokeColor}\n            onChange={(e) => setStrokeColor(e.target.value)}\n            disabled={effectiveLocked || (!canDraw && !canErase)}\n            className=\"h-7 w-10 rounded border\"\n          />\n        </label>\n        <label className=\"flex items-center gap-1 text-xs\">\n          Width\n          <input\n            type=\"range\"\n            min={1}\n            max={10}\n            step={1}\n            value={strokeWidth}\n            onChange={(e) => setStrokeWidth(Number(e.target.value))}\n            disabled={effectiveLocked || (!canDraw && !canErase)}\n          />\n          <span>{strokeWidth}</span>\n        </label>\n        {effectiveCapabilities.clear && (\n          <Button variant=\"outline\" size=\"sm\" onClick={clearCurrentPage} disabled={effectiveLocked}>\n            Clear\n          </Button>\n        )}\n        {role === 'tutor' && (\n          <>\n            <Button variant=\"outline\" size=\"sm\" onClick={saveSnapshot}>Save Snapshot</Button>\n            <Button variant=\"outline\" size=\"sm\" onClick={loadLatestSnapshot}>Load Latest Snapshot</Button>\n          </>\n        )}\n        {effectiveCapabilities.flatten && <Button size=\"sm\" onClick={callFlattenService}>Flatten PDF</Button>}\n      </div>\n\n      <Tabs value={mode} onValueChange={(value) => setMode(value as PdfViewMode)}>\n        <TabsList>\n          <TabsTrigger value=\"original\">Original View</TabsTrigger>\n          {showAiActions && <TabsTrigger value=\"cleaned\">AI Cleaned Text</TabsTrigger>}\n          <TabsTrigger value=\"marked\">Marked Feedback</TabsTrigger>\n        </TabsList>\n      </Tabs>\n\n      <div className=\"flex items-center gap-2\">\n        <Button variant=\"outline\" size=\"sm\" disabled={pageNum <= 1} onClick={() => setPageNum((prev) => prev - 1)}>Prev</Button>\n        <span className=\"text-sm\">Page {pageNum} / {pageCount}</span>\n        <Button variant=\"outline\" size=\"sm\" disabled={pageNum >= pageCount} onClick={() => setPageNum((prev) => prev + 1)}>Next</Button>\n        {!fabricReady && <Badge variant=\"secondary\">Install `fabric` package to enable drawing sync</Badge>}\n      </div>\n\n      {mode === 'original' && (\n        <div className=\"relative inline-block border rounded-md overflow-hidden bg-white\">\n          <canvas ref={pdfCanvasRef} className=\"block\" />\n          <canvas ref={fabricCanvasElementRef} className=\"absolute inset-0\" />\n        </div>\n      )}\n\n      {mode === 'cleaned' && showAiActions && (\n        <pre className=\"rounded-md border bg-muted p-4 text-xs whitespace-pre-wrap\">{cleanedText || 'No cleaned text generated yet.'}</pre>\n      )}\n\n      {mode === 'marked' && (\n        <pre className=\"rounded-md border bg-muted p-4 text-xs whitespace-pre-wrap\">{markedFeedback || 'No marking feedback generated yet.'}</pre>\n      )}\n\n      <div className=\"text-xs text-muted-foreground flex items-center gap-2\">\n        <Upload className=\"w-3.5 h-3.5\" />\n        Coordinates are normalized as 0-100 percentages before sync for cross-device consistency.\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1917, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/pdf-tutoring/PDFTutoringWorkbench.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport Image from 'next/image'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Badge } from '@/components/ui/badge'\nimport { PDFCollaborativeViewer } from './PDFCollaborativeViewer'\n\ninterface PDFTutoringWorkbenchProps {\n  roomId: string\n}\n\nexport function PDFTutoringWorkbench({ roomId }: PDFTutoringWorkbenchProps) {\n  const [extractResult, setExtractResult] = useState('')\n  const [preprocessUrl, setPreprocessUrl] = useState('')\n  const [status, setStatus] = useState('Idle')\n  const [extractParser, setExtractParser] = useState<string>('unknown')\n  const [techCheck, setTechCheck] = useState<{ unpdfAvailable?: boolean; pdfParseAvailable?: boolean } | null>(null)\n\n  const extractPdfText = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0]\n    if (!file) return\n\n    const formData = new FormData()\n    formData.append('file', file)\n\n    setStatus('Extracting text...')\n    const res = await fetch('/api/pdf-tutoring/extract', {\n      method: 'POST',\n      body: formData,\n    })\n    const data = await res.json()\n    setExtractResult(data.markdown || data.text || '')\n    setExtractParser(data.parser || 'unknown')\n    setTechCheck(data.technologyCheck || null)\n    setStatus(res.ok ? 'Text extracted' : 'Extraction failed')\n  }\n\n  const preprocessImage = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0]\n    if (!file) return\n    const formData = new FormData()\n    formData.append('file', file)\n\n    setStatus('Preprocessing image...')\n    const res = await fetch('/api/pdf-tutoring/preprocess', {\n      method: 'POST',\n      body: formData,\n    })\n\n    if (!res.ok) {\n      setStatus('Preprocess failed')\n      return\n    }\n\n    const blob = await res.blob()\n    const url = URL.createObjectURL(blob)\n    setPreprocessUrl(url)\n    setStatus('Image preprocessed')\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <Card>\n        <CardHeader>\n          <CardTitle>AI Tutoring Engine - PDF Workbench</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex flex-wrap items-center gap-2\">\n            <Badge variant=\"outline\">Room: {roomId}</Badge>\n            <Badge>{status}</Badge>\n          </div>\n\n          <div className=\"grid grid-cols-1 gap-4 lg:grid-cols-2\">\n            <div className=\"space-y-2 rounded-md border p-3\">\n              <h3 className=\"font-medium\">Document Pipeline</h3>\n              <div className=\"flex flex-wrap gap-2\">\n                <Badge variant=\"secondary\">Parser: {extractParser}</Badge>\n                {techCheck && (\n                  <>\n                    <Badge variant={techCheck.unpdfAvailable ? 'default' : 'outline'}>\n                      unpdf {techCheck.unpdfAvailable ? 'on' : 'off'}\n                    </Badge>\n                    <Badge variant={techCheck.pdfParseAvailable ? 'default' : 'outline'}>\n                      pdf-parse {techCheck.pdfParseAvailable ? 'on' : 'off'}\n                    </Badge>\n                  </>\n                )}\n              </div>\n              <div className=\"space-y-2\">\n                <Input type=\"file\" accept=\"application/pdf\" onChange={extractPdfText} />\n                <Input type=\"file\" accept=\"image/*\" onChange={preprocessImage} />\n              </div>\n              {extractResult && (\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-xs text-muted-foreground\">{extractResult.length} chars extracted</span>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={async () => {\n                        await navigator.clipboard.writeText(extractResult)\n                        setStatus('Extracted text copied')\n                      }}\n                    >\n                      Copy text\n                    </Button>\n                  </div>\n                  <pre className=\"max-h-48 overflow-auto rounded bg-muted p-2 text-xs whitespace-pre-wrap\">{extractResult}</pre>\n                </div>\n              )}\n              {preprocessUrl && (\n                <Image\n                  src={preprocessUrl}\n                  alt=\"Preprocessed homework\"\n                  width={512}\n                  height={320}\n                  className=\"max-h-48 w-auto rounded border\"\n                  unoptimized\n                />\n              )}\n            </div>\n\n            <div className=\"space-y-2 rounded-md border p-3\">\n              <h3 className=\"font-medium\">Live Collaboration + Marking</h3>\n              <p className=\"text-xs text-muted-foreground\">\n                Includes lock/unlock, mode toggles, low-latency sync broadcast, and PDF flattening output.\n              </p>\n              <Button variant=\"outline\" size=\"sm\" onClick={() => setStatus('Ready for live tutoring')}>Prepare Session</Button>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <PDFCollaborativeViewer roomId={roomId} />\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2253, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/sheet.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = DialogPrimitive.Root\n\nconst SheetTrigger = DialogPrimitive.Trigger\n\nconst SheetClose = DialogPrimitive.Close\n\nconst SheetPortal = DialogPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content> & {\n    side?: \"top\" | \"bottom\" | \"left\" | \"right\"\n  }\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n        side === \"top\" && \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        side === \"bottom\" && \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        side === \"left\" && \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        side === \"right\" && \"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = DialogPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = DialogPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,QAAQ,4NAAoB;AAElC,MAAM,eAAe,+NAAuB;AAE5C,MAAM,aAAa,6NAAqB;AAExC,MAAM,cAAc,8NAAsB;AAE1C,MAAM,6BAAe,qQAAgB,CAGnC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC,+NAAuB;QACtB,WAAW,IAAA,2KAAE,EACX,0JACA;QAED,GAAG,KAAK;QACT,KAAK;;;;;;AAGT,aAAa,WAAW,GAAG,+NAAuB,CAAC,WAAW;AAE9D,MAAM,6BAAe,qQAAgB,CAKnC,CAAC,EAAE,OAAO,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpD,gSAAC;;0BACC,gSAAC;;;;;0BACD,gSAAC,+NAAuB;gBACtB,KAAK;gBACL,WAAW,IAAA,2KAAE,EACX,oMACA,SAAS,SAAS,qGAClB,SAAS,YAAY,8GACrB,SAAS,UAAU,iIACnB,SAAS,WAAW,oIACpB;gBAED,GAAG,KAAK;;oBAER;kCACD,gSAAC,6NAAqB;wBAAC,WAAU;;0CAC/B,gSAAC,mPAAC;gCAAC,WAAU;;;;;;0CACb,gSAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAKlC,aAAa,WAAW,GAAG,+NAAuB,CAAC,WAAW;AAE9D,MAAM,cAAc,CAAC,EACnB,SAAS,EACT,GAAG,OACkC,iBACrC,gSAAC;QACC,WAAW,IAAA,2KAAE,EACX,oDACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG;AAE1B,MAAM,cAAc,CAAC,EACnB,SAAS,EACT,GAAG,OACkC,iBACrC,gSAAC;QACC,WAAW,IAAA,2KAAE,EACX,iEACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,qQAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC,6NAAqB;QACpB,KAAK;QACL,WAAW,IAAA,2KAAE,EAAC,yCAAyC;QACtD,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG,6NAAqB,CAAC,WAAW;AAE1D,MAAM,iCAAmB,qQAAgB,CAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC,mOAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,2KAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG,mOAA2B,CAAC,WAAW"}},
    {"offset": {"line": 2393, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/dropdown-menu.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2604, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/whiteboard/TldrawMathBoard.tsx"],"sourcesContent":["'use client'\n\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react'\nimport { Tldraw, type Editor } from 'tldraw'\nimport type { Socket } from 'socket.io-client'\nimport * as Y from 'yjs'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Lock, Unlock, Wifi, WifiOff } from 'lucide-react'\nimport 'tldraw/tldraw.css'\n\ninterface TldrawMathBoardProps {\n  sessionId: string\n  socket: Socket | null\n  userId?: string\n  userName?: string\n  role: 'tutor' | 'student'\n  className?: string\n}\n\nexport function TldrawMathBoard({\n  sessionId,\n  socket,\n  userId,\n  userName,\n  role,\n  className = '',\n}: TldrawMathBoardProps) {\n  const editorRef = useRef<Editor | null>(null)\n  const applyingRemoteRef = useRef(false)\n  const syncTimerRef = useRef<ReturnType<typeof setTimeout> | null>(null)\n  const yDocRef = useRef<Y.Doc | null>(null)\n  const yMetaRef = useRef<Y.Map<unknown> | null>(null)\n  const socketRef = useRef<Socket | null>(null)\n  const canEditRef = useRef(false)\n  const queueSnapshotSyncRef = useRef<(() => void) | null>(null)\n  const [isConnected, setIsConnected] = useState(false)\n  const [isLocked, setIsLocked] = useState(false)\n\n  const canEdit = role === 'tutor' || !isLocked\n\n  useEffect(() => {\n    socketRef.current = socket\n  }, [socket])\n\n  useEffect(() => {\n    canEditRef.current = canEdit\n  }, [canEdit])\n\n  const applyReadonlyState = useCallback((editor: Editor | null, readonly: boolean) => {\n    if (!editor) return\n    editor.updateInstanceState({ isReadonly: readonly })\n  }, [])\n\n  const queueSnapshotSync = useCallback(() => {\n    if (!editorRef.current || !canEditRef.current) return\n    const yMeta = yMetaRef.current\n    if (!yMeta) return\n    if (syncTimerRef.current) clearTimeout(syncTimerRef.current)\n    syncTimerRef.current = setTimeout(() => {\n      if (!editorRef.current || applyingRemoteRef.current) return\n      const rawSnapshot = editorRef.current.getSnapshot() as unknown\n      // Store a detached JSON-safe snapshot so Yjs always sees state deltas across edits.\n      const snapshot =\n        typeof structuredClone === 'function'\n          ? structuredClone(rawSnapshot)\n          : JSON.parse(JSON.stringify(rawSnapshot))\n      yMeta.set('snapshot', snapshot)\n      yMeta.set('updatedAt', Date.now())\n      socketRef.current?.emit('math_tl_snapshot', {\n        sessionId,\n        snapshot,\n      })\n    }, 180)\n  }, [sessionId])\n\n  useEffect(() => {\n    queueSnapshotSyncRef.current = queueSnapshotSync\n  }, [queueSnapshotSync])\n\n  useEffect(() => {\n    if (!socket) return\n    const yDoc = new Y.Doc()\n    const yMeta = yDoc.getMap<unknown>('meta')\n    yDocRef.current = yDoc\n    yMetaRef.current = yMeta\n\n    const onYDocUpdate = (update: Uint8Array, origin: unknown) => {\n      if (!socket || origin === 'remote') return\n      socket.emit('math_yjs_update', {\n        sessionId,\n        update: Array.from(update),\n      })\n    }\n\n    const onYMetaUpdate = () => {\n      const snapshot = yMeta.get('snapshot')\n      if (!snapshot || !editorRef.current || applyingRemoteRef.current) return\n      applyingRemoteRef.current = true\n      try {\n        editorRef.current.loadSnapshot(snapshot as any)\n      } finally {\n        window.setTimeout(() => {\n          applyingRemoteRef.current = false\n        }, 0)\n      }\n    }\n\n    yDoc.on('update', onYDocUpdate)\n    yMeta.observe(onYMetaUpdate)\n\n    const join = () => {\n      socket.emit('math_wb_join', {\n        sessionId,\n        userId,\n        name: userName || (role === 'tutor' ? 'Tutor' : 'Student'),\n        role,\n      })\n      socket.emit('math_wb_request_sync', sessionId)\n      setIsConnected(true)\n    }\n\n    const onConnect = () => join()\n    const onDisconnect = () => {\n      setIsConnected(false)\n    }\n    const onState = (state: {\n      locked: boolean\n      tldrawSnapshot?: Record<string, unknown> | null\n    }) => {\n      setIsLocked(Boolean(state.locked))\n      if (state.tldrawSnapshot && yMeta) {\n        yMeta.set('snapshot', state.tldrawSnapshot)\n      }\n    }\n    const onLockChanged = (data: { locked: boolean }) => {\n      setIsLocked(Boolean(data.locked))\n    }\n    const onYjsSync = (payload: { sessionId?: string; update: number[] }) => {\n      if (payload.sessionId && payload.sessionId !== sessionId) return\n      Y.applyUpdate(yDoc, Uint8Array.from(payload.update || []), 'remote')\n    }\n    const onYjsUpdate = (payload: { sessionId?: string; actorId?: string; update: number[] }) => {\n      if (payload.sessionId && payload.sessionId !== sessionId) return\n      if (payload.actorId && payload.actorId === userId) return\n      Y.applyUpdate(yDoc, Uint8Array.from(payload.update || []), 'remote')\n    }\n    const onSnapshot = (payload: { sessionId?: string; actorId?: string; snapshot?: Record<string, unknown> | null }) => {\n      if (payload.sessionId && payload.sessionId !== sessionId) return\n      if (payload.actorId && payload.actorId === userId) return\n      if (!payload.snapshot || !editorRef.current) return\n      applyingRemoteRef.current = true\n      try {\n        editorRef.current.loadSnapshot(payload.snapshot as any)\n      } finally {\n        window.setTimeout(() => {\n          applyingRemoteRef.current = false\n        }, 0)\n      }\n    }\n\n    socket.on('connect', onConnect)\n    socket.on('disconnect', onDisconnect)\n    socket.on('math_wb_state', onState)\n    socket.on('math_wb_lock_changed', onLockChanged)\n    socket.on('math_yjs_sync', onYjsSync)\n    socket.on('math_yjs_update', onYjsUpdate)\n    socket.on('math_tl_snapshot', onSnapshot)\n\n    if (socket.connected) {\n      join()\n    }\n\n    return () => {\n      socket.off('connect', onConnect)\n      socket.off('disconnect', onDisconnect)\n      socket.off('math_wb_state', onState)\n      socket.off('math_wb_lock_changed', onLockChanged)\n      socket.off('math_yjs_sync', onYjsSync)\n      socket.off('math_yjs_update', onYjsUpdate)\n      socket.off('math_tl_snapshot', onSnapshot)\n      socket.emit('math_wb_leave', sessionId)\n      if (syncTimerRef.current) clearTimeout(syncTimerRef.current)\n      yMeta.unobserve(onYMetaUpdate)\n      yDoc.off('update', onYDocUpdate)\n      yDocRef.current = null\n      yMetaRef.current = null\n    }\n  }, [role, sessionId, socket, userId, userName])\n\n  const onMount = useCallback((editor: Editor) => {\n    editorRef.current = editor\n    applyReadonlyState(editor, !canEdit)\n    // Avoid remote font fetch failures (cdn.tldraw.com) from breaking runtime in restricted networks.\n    const fontManager = (editor as any).fonts\n    if (fontManager && !fontManager.__networkPatched) {\n      fontManager.__networkPatched = true\n      fontManager.requestFonts = () => {}\n      fontManager.ensureFontIsLoaded = async () => undefined\n      fontManager.loadRequiredFontsForCurrentPage = async () => undefined\n    }\n    const existingSnapshot = yMetaRef.current?.get('snapshot')\n    if (existingSnapshot) {\n      editor.loadSnapshot(existingSnapshot as any)\n    }\n    const unlisten = editor.store.listen(() => {\n      if (applyingRemoteRef.current) return\n      queueSnapshotSyncRef.current?.()\n    }, { source: 'user', scope: 'document' })\n    return () => {\n      unlisten()\n      editorRef.current = null\n    }\n  }, [applyReadonlyState, canEdit])\n\n  useEffect(() => {\n    applyReadonlyState(editorRef.current, !canEdit)\n  }, [applyReadonlyState, canEdit])\n\n  const statusBadge = useMemo(() => {\n    if (isConnected) {\n      return (\n        <Badge variant=\"outline\" className=\"gap-1\">\n          <Wifi className=\"h-3 w-3 text-green-600\" />\n          Synced\n        </Badge>\n      )\n    }\n    return (\n      <Badge variant=\"outline\" className=\"gap-1\">\n        <WifiOff className=\"h-3 w-3 text-amber-600\" />\n        Reconnecting\n      </Badge>\n    )\n  }, [isConnected])\n\n  return (\n    <div className={`h-full min-h-0 flex flex-col rounded-lg border bg-white ${className}`}>\n      <div className=\"flex items-center justify-between border-b px-3 py-2\">\n        <div className=\"flex items-center gap-2\">\n          <h3 className=\"text-sm font-semibold\">Math Whiteboard</h3>\n          {statusBadge}\n          <Badge variant={canEdit ? 'default' : 'secondary'}>\n            {canEdit ? 'Editable' : 'Read only'}\n          </Badge>\n        </div>\n        {role === 'tutor' && (\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            className=\"gap-1\"\n            onClick={() => socket?.emit('math_wb_lock', { sessionId, locked: !isLocked })}\n          >\n            {isLocked ? <Unlock className=\"h-3 w-3\" /> : <Lock className=\"h-3 w-3\" />}\n            {isLocked ? 'Unlock Students' : 'Lock Students'}\n          </Button>\n        )}\n      </div>\n      <div className=\"relative flex-1 min-h-0\">\n        <Tldraw onMount={onMount} />\n      </div>\n    </div>\n  )\n}\n\nexport default TldrawMathBoard\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2958, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/whiteboard/FabricMathBoard.tsx"],"sourcesContent":["'use client'\n\nimport { useCallback, useEffect, useMemo, useRef, useState, type ReactNode } from 'react'\nimport * as fabric from 'fabric'\nimport * as Y from 'yjs'\nimport type { Socket } from 'socket.io-client'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Pen, Square, Circle, Type, MousePointer2, Eraser, Lock, Unlock, Wifi, WifiOff, Hand } from 'lucide-react'\n\ninterface FabricMathBoardProps {\n  sessionId: string\n  socket: Socket | null\n  userId?: string\n  userName?: string\n  role: 'tutor' | 'student'\n  className?: string\n}\n\ntype Tool = 'select' | 'draw' | 'rect' | 'circle' | 'text' | 'erase'\n\ninterface FabricCanvasElement extends HTMLCanvasElement {\n  __fabricCanvas?: fabric.Canvas\n}\n\ndeclare global {\n  interface Window {\n    __fabricMathBoards?: Record<string, fabric.Canvas>\n  }\n}\n\nexport function FabricMathBoard({\n  sessionId,\n  socket,\n  userId,\n  userName,\n  role,\n  className = '',\n}: FabricMathBoardProps) {\n  const rootRef = useRef<HTMLDivElement | null>(null)\n  const canvasElRef = useRef<FabricCanvasElement | null>(null)\n  const canvasRef = useRef<fabric.Canvas | null>(null)\n  const drawingShapeRef = useRef<fabric.Object | null>(null)\n  const startPointRef = useRef<{ x: number; y: number } | null>(null)\n  const toolRef = useRef<Tool>('draw')\n  const canEditRef = useRef(true)\n  const queueSnapshotSyncRef = useRef<() => void>(() => {})\n\n  const yDocRef = useRef<Y.Doc | null>(null)\n  const yMetaRef = useRef<Y.Map<unknown> | null>(null)\n  const syncTimerRef = useRef<ReturnType<typeof setTimeout> | null>(null)\n  const applyingRemoteRef = useRef(false)\n\n  const [tool, setTool] = useState<Tool>('draw')\n  const [isConnected, setIsConnected] = useState(false)\n  const [isLocked, setIsLocked] = useState(false)\n  const [hasRequestedEditAccess, setHasRequestedEditAccess] = useState(false)\n  const [pendingEditRequests, setPendingEditRequests] = useState<Array<{ userId?: string; name: string; requestedAt: number }>>([])\n\n  const canEdit = role === 'tutor' || !isLocked\n\n  const applyReadonly = useCallback((readonly: boolean) => {\n    const canvas = canvasRef.current\n    if (!canvas) return\n    canvas.isDrawingMode = !readonly && (tool === 'draw' || tool === 'erase')\n    canvas.selection = !readonly && tool === 'select'\n    canvas.skipTargetFind = readonly || tool !== 'select'\n    canvas.forEachObject((obj) => {\n      obj.selectable = !readonly\n      obj.evented = !readonly\n    })\n    if (readonly) {\n      canvas.discardActiveObject()\n    }\n    canvas.renderAll()\n  }, [tool])\n\n  const queueSnapshotSync = useCallback(() => {\n    const canvas = canvasRef.current\n    const yMeta = yMetaRef.current\n    if (!canvas || !yMeta || !canEdit) return\n    if (syncTimerRef.current) clearTimeout(syncTimerRef.current)\n    syncTimerRef.current = setTimeout(() => {\n      if (applyingRemoteRef.current || !canvasRef.current || !yMetaRef.current) return\n      const snapshot = canvasRef.current.toJSON()\n      yMetaRef.current.set('snapshot', snapshot)\n      yMetaRef.current.set('updatedAt', Date.now())\n      socket?.emit('math_tl_snapshot', { sessionId, snapshot })\n    }, 140)\n  }, [canEdit, sessionId, socket])\n\n  useEffect(() => {\n    toolRef.current = tool\n  }, [tool])\n\n  useEffect(() => {\n    canEditRef.current = canEdit\n  }, [canEdit])\n\n  useEffect(() => {\n    queueSnapshotSyncRef.current = queueSnapshotSync\n  }, [queueSnapshotSync])\n\n  const applySnapshotToCanvas = useCallback((snapshot: unknown) => {\n    const canvas = canvasRef.current\n    if (!canvas || !snapshot) return\n\n    applyingRemoteRef.current = true\n    let finalized = false\n    const finalize = () => {\n      if (finalized) return\n      finalized = true\n      canvas.renderAll()\n      window.setTimeout(() => {\n        applyingRemoteRef.current = false\n      }, 0)\n    }\n\n    try {\n      const result = (canvas as any).loadFromJSON(snapshot, finalize)\n      if (result && typeof result.then === 'function') {\n        result.then(finalize).catch(finalize)\n      }\n    } catch {\n      finalize()\n    }\n  }, [])\n\n  useEffect(() => {\n    const yDoc = new Y.Doc()\n    const yMeta = yDoc.getMap<unknown>('meta')\n    yDocRef.current = yDoc\n    yMetaRef.current = yMeta\n\n    const onYDocUpdate = (update: Uint8Array, origin: unknown) => {\n      if (!socket || origin === 'remote') return\n      socket.emit('math_yjs_update', {\n        sessionId,\n        update: Array.from(update),\n      })\n    }\n\n    const onYMetaUpdate = () => {\n      const snapshot = yMeta.get('snapshot')\n      if (!snapshot || applyingRemoteRef.current) return\n      applySnapshotToCanvas(snapshot)\n    }\n\n    yDoc.on('update', onYDocUpdate)\n    yMeta.observe(onYMetaUpdate)\n\n    return () => {\n      if (syncTimerRef.current) clearTimeout(syncTimerRef.current)\n      yMeta.unobserve(onYMetaUpdate)\n      yDoc.off('update', onYDocUpdate)\n      yDoc.destroy()\n      yDocRef.current = null\n      yMetaRef.current = null\n    }\n  }, [applySnapshotToCanvas, sessionId, socket])\n\n  useEffect(() => {\n    if (!socket) return\n\n    const join = () => {\n      socket.emit('math_wb_join', {\n        sessionId,\n        userId,\n        name: userName || (role === 'tutor' ? 'Tutor' : 'Student'),\n        role,\n      })\n      socket.emit('math_wb_request_sync', sessionId)\n      setIsConnected(true)\n    }\n\n    const onConnect = () => join()\n    const onDisconnect = () => setIsConnected(false)\n    const onState = (state: { locked: boolean; tldrawSnapshot?: Record<string, unknown> | null }) => {\n      setIsLocked(Boolean(state.locked))\n      if (!state.locked) {\n        setHasRequestedEditAccess(false)\n        if (role === 'tutor') setPendingEditRequests([])\n      }\n      if (state.tldrawSnapshot && yMetaRef.current) {\n        yMetaRef.current.set('snapshot', state.tldrawSnapshot)\n      }\n    }\n    const onLockChanged = (data: { locked: boolean }) => {\n      setIsLocked(Boolean(data.locked))\n      if (!data.locked) {\n        setHasRequestedEditAccess(false)\n        if (role === 'tutor') setPendingEditRequests([])\n      }\n    }\n    const onEditRequest = (data: {\n      sessionId?: string\n      requester?: { userId?: string; name?: string }\n      requestedAt?: number\n    }) => {\n      if (data.sessionId && data.sessionId !== sessionId) return\n      if (role !== 'tutor') return\n      const requesterName = data.requester?.name?.trim()\n      if (!requesterName) return\n      setPendingEditRequests((prev) => {\n        const dedupeKey = data.requester?.userId || requesterName\n        const filtered = prev.filter((item) => (item.userId || item.name) !== dedupeKey)\n        return [\n          ...filtered,\n          {\n            userId: data.requester?.userId,\n            name: requesterName,\n            requestedAt: data.requestedAt || Date.now(),\n          },\n        ].slice(-6)\n      })\n    }\n    const onYjsSync = (payload: { sessionId?: string; update: number[] }) => {\n      if (payload.sessionId && payload.sessionId !== sessionId) return\n      const yDoc = yDocRef.current\n      if (!yDoc) return\n      Y.applyUpdate(yDoc, Uint8Array.from(payload.update || []), 'remote')\n    }\n    const onYjsUpdate = (payload: { sessionId?: string; actorId?: string; update: number[] }) => {\n      if (payload.sessionId && payload.sessionId !== sessionId) return\n      if (payload.actorId && payload.actorId === userId) return\n      const yDoc = yDocRef.current\n      if (!yDoc) return\n      Y.applyUpdate(yDoc, Uint8Array.from(payload.update || []), 'remote')\n    }\n    const onSnapshot = (payload: { sessionId?: string; actorId?: string; snapshot?: Record<string, unknown> | null }) => {\n      if (payload.sessionId && payload.sessionId !== sessionId) return\n      if (payload.actorId && payload.actorId === userId) return\n      if (!payload.snapshot) return\n      applySnapshotToCanvas(payload.snapshot)\n    }\n\n    socket.on('connect', onConnect)\n    socket.on('disconnect', onDisconnect)\n    socket.on('math_wb_state', onState)\n    socket.on('math_wb_lock_changed', onLockChanged)\n    socket.on('math_wb_edit_request', onEditRequest)\n    socket.on('math_yjs_sync', onYjsSync)\n    socket.on('math_yjs_update', onYjsUpdate)\n    socket.on('math_tl_snapshot', onSnapshot)\n\n    if (socket.connected) join()\n\n    return () => {\n      socket.off('connect', onConnect)\n      socket.off('disconnect', onDisconnect)\n      socket.off('math_wb_state', onState)\n      socket.off('math_wb_lock_changed', onLockChanged)\n      socket.off('math_wb_edit_request', onEditRequest)\n      socket.off('math_yjs_sync', onYjsSync)\n      socket.off('math_yjs_update', onYjsUpdate)\n      socket.off('math_tl_snapshot', onSnapshot)\n      socket.emit('math_wb_leave', sessionId)\n    }\n  }, [applySnapshotToCanvas, role, sessionId, socket, userId, userName])\n\n  useEffect(() => {\n    if (!canvasElRef.current || canvasRef.current) return\n\n    const canvas = new fabric.Canvas(canvasElRef.current, {\n      width: 1280,\n      height: 720,\n      backgroundColor: '#ffffff',\n      isDrawingMode: true,\n      selection: false,\n      preserveObjectStacking: true,\n    })\n    canvasRef.current = canvas\n    canvasElRef.current.__fabricCanvas = canvas\n    if (typeof window !== 'undefined' && process.env.NODE_ENV !== 'production') {\n      window.__fabricMathBoards = window.__fabricMathBoards ?? {}\n      window.__fabricMathBoards[sessionId] = canvas\n    }\n\n    const interactiveCanvas = canvas.upperCanvasEl as FabricCanvasElement | undefined\n    if (interactiveCanvas) {\n      interactiveCanvas.dataset.testid = 'fabric-math-interactive-canvas'\n      interactiveCanvas.dataset.mathSession = sessionId\n      interactiveCanvas.__fabricCanvas = canvas\n      interactiveCanvas.style.pointerEvents = 'auto'\n      interactiveCanvas.style.touchAction = 'none'\n    }\n    if (canvas.lowerCanvasEl) {\n      canvas.lowerCanvasEl.style.pointerEvents = 'auto'\n      canvas.lowerCanvasEl.style.touchAction = 'none'\n    }\n\n    const brush = canvas.freeDrawingBrush as fabric.PencilBrush\n    if (brush) {\n      brush.color = '#111827'\n      brush.width = 2\n    }\n\n    const onObjectMutate = () => {\n      if (!applyingRemoteRef.current) {\n        queueSnapshotSyncRef.current()\n      }\n    }\n\n    const getPoint = (evt: fabric.TEvent): { x: number; y: number } | null => {\n      const maybeEvent = evt as fabric.TEvent & { scenePoint?: { x: number; y: number } }\n      if (maybeEvent.scenePoint && Number.isFinite(maybeEvent.scenePoint.x) && Number.isFinite(maybeEvent.scenePoint.y)) {\n        return { x: maybeEvent.scenePoint.x, y: maybeEvent.scenePoint.y }\n      }\n      const pointerEvent = evt.e\n      if (!pointerEvent) return null\n      if (typeof (canvas as unknown as { getScenePoint?: (event: Event) => { x: number; y: number } }).getScenePoint === 'function') {\n        const scenePoint = (canvas as unknown as { getScenePoint: (event: Event) => { x: number; y: number } }).getScenePoint(pointerEvent)\n        if (Number.isFinite(scenePoint.x) && Number.isFinite(scenePoint.y)) {\n          return { x: scenePoint.x, y: scenePoint.y }\n        }\n      }\n      if (typeof (canvas as unknown as { getPointer?: (event: Event) => { x: number; y: number } }).getPointer === 'function') {\n        const fallbackPoint = (canvas as unknown as { getPointer: (event: Event) => { x: number; y: number } }).getPointer(pointerEvent)\n        if (Number.isFinite(fallbackPoint.x) && Number.isFinite(fallbackPoint.y)) {\n          return { x: fallbackPoint.x, y: fallbackPoint.y }\n        }\n      }\n      return null\n    }\n\n    const onMouseDown = (evt: fabric.TEvent) => {\n      if (!canEditRef.current) return\n      const pointer = getPoint(evt)\n      if (!pointer) return\n      const activeTool = toolRef.current\n\n      if (activeTool === 'text') {\n        const text = new fabric.IText('Text', {\n          left: pointer.x,\n          top: pointer.y,\n          fontSize: 20,\n          fill: '#111827',\n        })\n        canvas.add(text)\n        canvas.setActiveObject(text)\n        text.enterEditing()\n        onObjectMutate()\n        return\n      }\n\n      if (activeTool !== 'rect' && activeTool !== 'circle') return\n      startPointRef.current = { x: pointer.x, y: pointer.y }\n\n      if (activeTool === 'rect') {\n        const rect = new fabric.Rect({\n          left: pointer.x,\n          top: pointer.y,\n          width: 1,\n          height: 1,\n          fill: 'rgba(37, 99, 235, 0.08)',\n          stroke: '#2563eb',\n          strokeWidth: 2,\n        })\n        drawingShapeRef.current = rect\n        canvas.add(rect)\n      } else {\n        const circle = new fabric.Circle({\n          left: pointer.x,\n          top: pointer.y,\n          radius: 1,\n          fill: 'rgba(16, 185, 129, 0.08)',\n          stroke: '#10b981',\n          strokeWidth: 2,\n        })\n        drawingShapeRef.current = circle\n        canvas.add(circle)\n      }\n    }\n\n    const onMouseMove = (evt: fabric.TEvent) => {\n      if (!canEditRef.current) return\n      if (!startPointRef.current || !drawingShapeRef.current) return\n      const pointer = getPoint(evt)\n      if (!pointer) return\n\n      if (drawingShapeRef.current instanceof fabric.Rect) {\n        const x = Math.min(startPointRef.current.x, pointer.x)\n        const y = Math.min(startPointRef.current.y, pointer.y)\n        const width = Math.abs(pointer.x - startPointRef.current.x)\n        const height = Math.abs(pointer.y - startPointRef.current.y)\n        drawingShapeRef.current.set({ left: x, top: y, width, height })\n      } else if (drawingShapeRef.current instanceof fabric.Circle) {\n        const radius = Math.max(Math.abs(pointer.x - startPointRef.current.x), Math.abs(pointer.y - startPointRef.current.y)) / 2\n        drawingShapeRef.current.set({\n          radius,\n          left: startPointRef.current.x - radius,\n          top: startPointRef.current.y - radius,\n        })\n      }\n      canvas.renderAll()\n    }\n\n    const onMouseUp = () => {\n      if (!canEditRef.current) return\n      if (drawingShapeRef.current) {\n        drawingShapeRef.current = null\n        startPointRef.current = null\n        onObjectMutate()\n      }\n    }\n\n    canvas.on('path:created', onObjectMutate)\n    canvas.on('object:modified', onObjectMutate)\n    canvas.on('object:removed', onObjectMutate)\n    canvas.on('mouse:down', onMouseDown)\n    canvas.on('mouse:move', onMouseMove)\n    canvas.on('mouse:up', onMouseUp)\n\n    const resize = () => {\n      const root = rootRef.current\n      if (!root) return\n      const bounds = root.getBoundingClientRect()\n      const width = Math.max(960, Math.floor(bounds.width - 12))\n      const height = Math.max(520, Math.floor(bounds.height - 12))\n      canvas.setDimensions({ width, height })\n      canvas.renderAll()\n    }\n\n    resize()\n    const ro = new ResizeObserver(() => resize())\n    if (rootRef.current) ro.observe(rootRef.current)\n\n    return () => {\n      ro.disconnect()\n      canvas.off('path:created', onObjectMutate)\n      canvas.off('object:modified', onObjectMutate)\n      canvas.off('object:removed', onObjectMutate)\n      canvas.off('mouse:down', onMouseDown)\n      canvas.off('mouse:move', onMouseMove)\n      canvas.off('mouse:up', onMouseUp)\n      canvas.dispose()\n      if (typeof window !== 'undefined' && process.env.NODE_ENV !== 'production' && window.__fabricMathBoards) {\n        delete window.__fabricMathBoards[sessionId]\n      }\n      canvasRef.current = null\n    }\n  }, [sessionId])\n\n  useEffect(() => {\n    const canvas = canvasRef.current\n    if (!canvas) return\n\n    canvas.isDrawingMode = canEdit && (tool === 'draw' || tool === 'erase')\n    canvas.selection = canEdit && tool === 'select'\n    canvas.skipTargetFind = !(canEdit && tool === 'select')\n\n    if (canvas.freeDrawingBrush) {\n      canvas.freeDrawingBrush.color = tool === 'erase' ? '#ffffff' : '#111827'\n      canvas.freeDrawingBrush.width = tool === 'erase' ? 18 : 2\n    }\n\n    if (tool !== 'select') {\n      canvas.discardActiveObject()\n    }\n\n    applyReadonly(!canEdit)\n  }, [applyReadonly, canEdit, tool])\n\n  const statusBadge = useMemo(() => {\n    if (isConnected) {\n      return (\n        <Badge variant=\"outline\" className=\"gap-1\">\n          <Wifi className=\"h-3 w-3 text-green-600\" />\n          Synced\n        </Badge>\n      )\n    }\n    return (\n      <Badge variant=\"outline\" className=\"gap-1\">\n        <WifiOff className=\"h-3 w-3 text-amber-600\" />\n        Reconnecting\n      </Badge>\n    )\n  }, [isConnected])\n\n  const toolButton = (value: Tool, label: string, icon: ReactNode) => (\n    <Button\n      key={value}\n      type=\"button\"\n      size=\"sm\"\n      variant={tool === value ? 'default' : 'outline'}\n      onClick={() => setTool(value)}\n      disabled={!canEdit}\n      className=\"gap-1\"\n    >\n      {icon}\n      {label}\n    </Button>\n  )\n\n  const requestEditAccess = () => {\n    if (role !== 'student' || canEdit || !socket) return\n    socket.emit('math_wb_edit_request', { sessionId })\n    setHasRequestedEditAccess(true)\n  }\n\n  return (\n    <div className={`h-full min-h-0 flex flex-col rounded-lg border bg-white ${className}`} data-testid=\"fabric-math-board\">\n      <div className=\"flex flex-wrap items-center justify-between gap-2 border-b px-3 py-2\">\n        <div className=\"flex items-center gap-2\">\n          <h3 className=\"text-sm font-semibold\">Math Whiteboard</h3>\n          {statusBadge}\n          <Badge variant={canEdit ? 'default' : 'secondary'}>{canEdit ? 'Editable' : 'Read only'}</Badge>\n        </div>\n\n        <div className=\"flex flex-wrap items-center gap-1\">\n          {canEdit ? (\n            <>\n              {toolButton('select', 'Select', <MousePointer2 className=\"h-3 w-3\" />)}\n              {toolButton('draw', 'Draw', <Pen className=\"h-3 w-3\" />)}\n              {toolButton('erase', 'Erase', <Eraser className=\"h-3 w-3\" />)}\n              {toolButton('rect', 'Rectangle', <Square className=\"h-3 w-3\" />)}\n              {toolButton('circle', 'Circle', <Circle className=\"h-3 w-3\" />)}\n              {toolButton('text', 'Text', <Type className=\"h-3 w-3\" />)}\n            </>\n          ) : (\n            <Badge variant=\"secondary\">Toolbar disabled while locked</Badge>\n          )}\n\n          {role === 'student' && !canEdit && (\n            <Button\n              variant=\"secondary\"\n              size=\"sm\"\n              className=\"gap-1\"\n              onClick={requestEditAccess}\n              disabled={hasRequestedEditAccess}\n            >\n              <Hand className=\"h-3 w-3\" />\n              {hasRequestedEditAccess ? 'Request sent' : 'Request edit access'}\n            </Button>\n          )}\n\n          {role === 'tutor' && (\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"gap-1\"\n              onClick={() => socket?.emit('math_wb_lock', { sessionId, locked: !isLocked })}\n            >\n              {isLocked ? <Unlock className=\"h-3 w-3\" /> : <Lock className=\"h-3 w-3\" />}\n              {isLocked ? 'Unlock Students' : 'Lock Students'}\n            </Button>\n          )}\n          {role === 'tutor' && pendingEditRequests.length > 0 && (\n            <Badge variant=\"secondary\">\n              {pendingEditRequests.length} edit request{pendingEditRequests.length === 1 ? '' : 's'}\n            </Badge>\n          )}\n        </div>\n      </div>\n\n      <div ref={rootRef} className=\"relative flex-1 min-h-0 touch-none p-1\">\n        {role === 'student' && !canEdit && (\n          <div className=\"absolute left-3 right-3 top-3 z-10 rounded-md border border-amber-300 bg-amber-50 px-3 py-2 text-sm text-amber-900 shadow-sm\">\n            Board locked by tutor. You can view only until access is granted.\n          </div>\n        )}\n        <canvas\n          ref={canvasElRef}\n          data-testid=\"fabric-math-canvas\"\n          data-math-session={sessionId}\n          className=\"h-full w-full rounded border border-slate-200\"\n        />\n      </div>\n    </div>\n  )\n}\n\nexport default FabricMathBoard\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3682, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/whiteboard/MathBoardHost.tsx"],"sourcesContent":["'use client'\n\nimport type { Socket } from 'socket.io-client'\nimport TldrawMathBoard from './TldrawMathBoard'\nimport { FabricMathBoard } from './FabricMathBoard'\n\nexport interface MathBoardProps {\n  sessionId: string\n  socket: Socket | null\n  userId?: string\n  userName?: string\n  role: 'tutor' | 'student'\n  className?: string\n}\n\nfunction resolveEngine(): 'fabric' | 'tldraw' {\n  const raw = (process.env.NEXT_PUBLIC_MATH_ENGINE || 'fabric').toLowerCase()\n  return raw === 'tldraw' ? 'tldraw' : 'fabric'\n}\n\nexport function MathBoardHost(props: MathBoardProps) {\n  const engine = resolveEngine()\n\n  if (engine === 'tldraw') {\n    return <TldrawMathBoard {...props} />\n  }\n\n  return <FabricMathBoard {...props} />\n}\n\nexport default MathBoardHost\n"],"names":[],"mappings":";;;;;;;AAGA;AACA;AAJA;;;;AAeA,SAAS;IACP,MAAM,MAAM,CAAC,QAAQ,GAAG,CAAC,uBAAuB,IAAI,QAAQ,EAAE,WAAW;IACzE,OAAO,QAAQ,WAAW,WAAW;AACvC;AAEO,SAAS,cAAc,KAAqB;IACjD,MAAM,SAAS;IAEf,IAAI,WAAW,UAAU;QACvB,qBAAO,gSAAC,gNAAe;YAAE,GAAG,KAAK;;;;;;IACnC;IAEA,qBAAO,gSAAC,wNAAe;QAAE,GAAG,KAAK;;;;;;AACnC;uCAEe"}}]
}