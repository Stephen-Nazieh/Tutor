;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="6dbf9a84-c3a3-629e-f7a0-89af5c1f91f5")}catch(e){}}();
module.exports=[500842,e=>e.a(async(t,i)=>{try{var n=e.i(620971),a=e.i(384030),s=e.i(738597);e.i(688768);var r=e.i(257357),o=e.i(909105),l=e.i(997103),u=e.i(748846),d=e.i(841195),c=e.i(254799),p=t([a,s]);[a,s]=p.then?(await p)():p;let h=d.z.object({topic:d.z.string().min(1),subject:d.z.string().min(1),questionCount:d.z.number().min(1).max(20).default(5),questionTypes:d.z.array(d.z.enum(["mcq","true_false","short_answer","fill_blank"])).default(["mcq"]),difficulty:d.z.enum(["beginner","intermediate","advanced"]).default("intermediate"),gradeLevel:d.z.string().optional(),learningObjectives:d.z.array(d.z.string()).optional(),includeAnswers:d.z.boolean().default(!0),includeExplanations:d.z.boolean().default(!0),timeLimit:d.z.number().optional(),adaptiveBasedOn:d.z.string().optional()});function f(){return Math.random().toString(36).substring(2,11)}let m=(0,a.withAuth)(async(e,t)=>{let i=t.user.id;try{let t,a=await e.json(),o=h.safeParse(a);if(!o.success)return n.NextResponse.json({error:"Invalid request",details:o.error.format()},{status:400});let l=o.data,d=(t={mcq:"Multiple choice with 4 options (A, B, C, D)",true_false:"True/False questions",short_answer:"Short answer questions (1-2 sentence answers)",fill_blank:"Fill in the blank questions with clear blanks indicated"},`
Create a ${l.difficulty} level quiz on "${l.topic}" for ${l.subject}.

SPECIFICATIONS:
- Number of questions: ${l.questionCount}
- Question types: ${l.questionTypes.map(e=>t[e]).join(", ")}
- Difficulty: ${l.difficulty} (${({beginner:"Focus on recall and basic understanding. Use straightforward language.",intermediate:"Focus on application and analysis. Require some reasoning.",advanced:"Focus on synthesis and evaluation. Require critical thinking and deep understanding."})[l.difficulty]})
${l.gradeLevel?`- Target grade level: ${l.gradeLevel}`:""}
${l.learningObjectives?.length?`- Learning objectives: ${l.learningObjectives.join(", ")}`:""}
${l.timeLimit?`- Recommended time: ${l.timeLimit} minutes`:""}

REQUIREMENTS:
1. Questions should be clear and unambiguous
2. Distribute question types evenly if multiple types requested
3. ${l.includeAnswers?"Include correct answers":"Do NOT include answers"}
4. ${l.includeExplanations?"Provide brief explanations for each answer":"No explanations needed"}
5. Assign points based on difficulty (1-5 points per question)
6. Ensure questions test different cognitive levels (remember, understand, apply, analyze)

RESPONSE FORMAT - Return valid JSON:
{
  "title": "Quiz Title",
  "description": "Brief description of what this quiz covers",
  "instructions": "Instructions for students taking the quiz",
  "questions": [
    {
      "type": "mcq",
      "question": "What is...?",
      "options": ["Option A", "Option B", "Option C", "Option D"],
      "correctAnswer": "Option B",
      "explanation": "Option B is correct because...",
      "difficulty": "intermediate",
      "points": 2
    }
  ]
}

For true_false questions, set options to ["True", "False"].
For fill_blank, indicate blanks with ______ in the question text.
Generate exactly ${l.questionCount} questions.
`),p=await (0,u.generateWithFallback)(d,{temperature:.7,maxTokens:3e3}),m=function(e,t){try{let i=e.match(/\{[\s\S]*\}/);if(i){let e=JSON.parse(i[0]),n=(e.questions||[]).map(e=>({id:f(),type:e.type||"mcq",question:e.question||"",options:e.options,correctAnswer:e.correctAnswer||"",explanation:e.explanation,difficulty:e.difficulty||t.difficulty,points:e.points||1})),a=n.reduce((e,t)=>e+t.points,0);return{title:e.title||`${t.topic} Quiz`,description:e.description||`A ${t.difficulty} quiz on ${t.topic}`,topic:t.topic,subject:t.subject,difficulty:t.difficulty,timeLimit:t.timeLimit,totalPoints:a,questions:n,instructions:e.instructions||"Answer all questions to the best of your ability."}}}catch{}return{title:`${t.topic} Quiz`,description:`A ${t.difficulty} level quiz covering ${t.topic}.`,topic:t.topic,subject:t.subject,difficulty:t.difficulty,timeLimit:t.timeLimit,totalPoints:t.questionCount,instructions:"Answer all questions carefully.",questions:Array.from({length:t.questionCount},(e,i)=>({id:f(),type:t.questionTypes[i%t.questionTypes.length],question:`Question ${i+1} about ${t.topic}`,options:"mcq"===t.questionTypes[i%t.questionTypes.length]?["Option A","Option B","Option C","Option D"]:"true_false"===t.questionTypes[i%t.questionTypes.length]?["True","False"]:void 0,correctAnswer:"Answer",explanation:t.includeExplanations?"Explanation of the answer":void 0,difficulty:t.difficulty,points:1}))}}(p.content,l),y=null;try{let[e]=await s.drizzleDb.insert(r.quiz).values({id:(0,c.randomUUID)(),tutorId:i,title:m.title,description:m.description,type:"generated",status:"draft",timeLimit:m.timeLimit??null,allowedAttempts:3,shuffleQuestions:!0,shuffleOptions:!0,showCorrectAnswers:"after_submit",questions:m.questions,totalPoints:m.totalPoints,tags:[]}).returning({id:r.quiz.id});y=e??null}catch{}try{await s.drizzleDb.insert(r.aIAssistantInsight).values({id:(0,c.randomUUID)(),sessionId:a.sessionId||"temp",type:"content_suggestion",title:`Generated Quiz: ${m.title}`,content:`${m.questions.length} questions on ${m.topic}`,relatedData:{topic:m.topic,difficulty:m.difficulty,questionCount:m.questions.length},applied:!1})}catch{}return n.NextResponse.json({quiz:m,saved:!!y,quizId:y?.id,metadata:{provider:p.provider,latencyMs:p.latencyMs,generatedAt:new Date().toISOString()}})}catch(e){return console.error("Quiz generation error:",e),n.NextResponse.json({error:"Failed to generate quiz"},{status:500})}},{role:"TUTOR"}),y=(0,a.withAuth)(async(e,t)=>{let i=t.user.id;try{let e=(await s.drizzleDb.select({id:r.quiz.id,title:r.quiz.title,createdAt:r.quiz.createdAt}).from(r.quiz).where((0,o.eq)(r.quiz.tutorId,i)).orderBy((0,l.desc)(r.quiz.createdAt))).map(e=>({id:e.id,title:e.title,topic:null,subject:null,difficulty:null,createdAt:e.createdAt}));return n.NextResponse.json({quizzes:e})}catch(e){return console.error("Fetch quizzes error:",e),n.NextResponse.json({error:"Failed to fetch quizzes"},{status:500})}},{role:"TUTOR"});e.s(["GET",0,y,"POST",0,m]),i()}catch(e){i(e)}},!1),626408,e=>e.a(async(t,i)=>{try{var n=e.i(78315),a=e.i(586961),s=e.i(196657),r=e.i(899733),o=e.i(233979),l=e.i(631683),u=e.i(840960),d=e.i(711373),c=e.i(699699),p=e.i(521140),f=e.i(205260),h=e.i(500249),m=e.i(431740),y=e.i(82608),g=e.i(635207),q=e.i(193695);e.i(708038);var v=e.i(447430),R=e.i(500842),w=t([R]);[R]=w.then?(await w)():w;let E=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/tutor/ai-assistant/quiz/route",pathname:"/api/tutor/ai-assistant/quiz",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/api/tutor/ai-assistant/quiz/route.ts",nextConfigOutput:"",userland:R}),{workAsyncStorage:z,workUnitAsyncStorage:x,serverHooks:C}=E;function b(){return(0,s.patchFetch)({workAsyncStorage:z,workUnitAsyncStorage:x})}async function A(e,t,i){E.isDev&&(0,r.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let n="/api/tutor/ai-assistant/quiz/route";n=n.replace(/\/index$/,"")||"/";let s=await E.prepare(e,t,{srcPage:n,multiZoneDraftMode:!1});if(!s)return t.statusCode=400,t.end("Bad Request"),null==i.waitUntil||i.waitUntil.call(i,Promise.resolve()),null;let{buildId:R,params:w,nextConfig:b,parsedUrl:A,isDraftMode:z,prerenderManifest:x,routerServerContext:C,isOnDemandRevalidate:T,revalidateOnlyGenerated:O,resolvedPathname:_,clientReferenceManifest:N,serverActionsManifest:$}=s,S=(0,u.normalizeAppPath)(n),P=!!(x.dynamicRoutes[S]||x.routes[_]),I=async()=>((null==C?void 0:C.render404)?await C.render404(e,t,A,!1):t.end("This page could not be found"),null);if(P&&!z){let e=!!x.routes[_],t=x.dynamicRoutes[S];if(t&&!1===t.fallback&&!e){if(b.experimental.adapterPath)return await I();throw new q.NoFallbackError}}let j=null;!P||E.isDev||z||(j=_,j="/index"===j?"/":j);let D=!0===E.isDev||!P,k=P&&!D;$&&N&&(0,l.setManifestsSingleton)({page:n,clientReferenceManifest:N,serverActionsManifest:$});let U=e.method||"GET",F=(0,o.getTracer)(),M=F.getActiveScopeSpan(),L={params:w,prerenderManifest:x,renderOpts:{experimental:{authInterrupts:!!b.experimental.authInterrupts},cacheComponents:!!b.cacheComponents,supportsDynamicResponse:D,incrementalCache:(0,r.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:b.cacheLife,waitUntil:i.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,i,n,a)=>E.onRequestError(e,t,n,a,C)},sharedContext:{buildId:R}},H=new d.NodeNextRequest(e),B=new d.NodeNextResponse(t),K=c.NextRequestAdapter.fromNodeNextRequest(H,(0,c.signalFromNodeResponse)(t));try{let s=async e=>E.handle(K,L).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let i=F.getRootSpanAttributes();if(!i)return;if(i.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${i.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=i.get("next.route");if(a){let t=`${U} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${U} ${n}`)}),l=!!(0,r.getRequestMeta)(e,"minimalMode"),u=async r=>{var o,u;let d=async({previousCacheEntry:a})=>{try{if(!l&&T&&O&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await s(r);e.fetchMetrics=L.renderOpts.fetchMetrics;let o=L.renderOpts.pendingWaitUntil;o&&i.waitUntil&&(i.waitUntil(o),o=void 0);let u=L.renderOpts.collectedTags;if(!P)return await (0,h.sendResponse)(H,B,n,L.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(n.headers);u&&(t[g.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let i=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,a=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:i,expire:a}}}}catch(t){throw(null==a?void 0:a.isStale)&&await E.onRequestError(e,t,{routerKind:"App Router",routePath:n,routeType:"route",revalidateReason:(0,f.getRevalidateReason)({isStaticGeneration:k,isOnDemandRevalidate:T})},!1,C),t}},c=await E.handleResponse({req:e,nextConfig:b,cacheKey:j,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:x,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:O,responseGenerator:d,waitUntil:i.waitUntil,isMinimalMode:l});if(!P)return null;if((null==c||null==(o=c.value)?void 0:o.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(u=c.value)?void 0:u.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",T?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),z&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,m.fromNodeOutgoingHttpHeaders)(c.value.headers);return l&&P||p.delete(g.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,y.getCacheControlHeader)(c.cacheControl)),await (0,h.sendResponse)(H,B,new Response(c.value.body,{headers:p,status:c.value.status||200})),null};M?await u(M):await F.withPropagatedContext(e.headers,()=>F.trace(p.BaseServerSpan.handleRequest,{spanName:`${U} ${n}`,kind:o.SpanKind.SERVER,attributes:{"http.method":U,"http.target":e.url}},u))}catch(t){if(t instanceof q.NoFallbackError||await E.onRequestError(e,t,{routerKind:"App Router",routePath:S,routeType:"route",revalidateReason:(0,f.getRevalidateReason)({isStaticGeneration:k,isOnDemandRevalidate:T})},!1,C),P)throw t;return await (0,h.sendResponse)(H,B,new Response(null,{status:500})),null}}e.s(["handler",()=>A,"patchFetch",()=>b,"routeModule",()=>E,"serverHooks",()=>C,"workAsyncStorage",()=>z,"workUnitAsyncStorage",()=>x]),i()}catch(e){i(e)}},!1)];

//# debugId=6dbf9a84-c3a3-629e-f7a0-89af5c1f91f5
//# sourceMappingURL=ADK_WORKSPACE_TutorMekimi_tutorme-app_320d1ce2._.js.map