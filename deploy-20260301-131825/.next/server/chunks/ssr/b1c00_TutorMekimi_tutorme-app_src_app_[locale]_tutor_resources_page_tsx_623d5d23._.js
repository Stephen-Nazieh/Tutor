;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="744ead48-e73a-3cf0-4e0b-d839de1ef5a0")}catch(e){}}();
module.exports=[488232,a=>{"use strict";var b=a.i(260576),c=a.i(741510),d=a.i(113098),e=a.i(88684),f=a.i(981354),g=a.i(333340),h=a.i(263805),i=a.i(529004),j=a.i(763485),k=a.i(229020),l=a.i(595484),m=a.i(458588),n=a.i(361749),o=a.i(79385),p=a.i(53286),q=a.i(784276),r=a.i(640132),s=a.i(143650),t=a.i(479680),u=a.i(656247),v=a.i(927910),w=a.i(330254);let x=(0,a.i(293357).default)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var y=a.i(554015),z=a.i(147779),A=a.i(19926),B=a.i(771516),C=a.i(962337),D=a.i(846438);function E(){let[a,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(!0),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)({name:"",description:"",tags:"",isPublic:!1}),R=(0,c.useRef)(null),[S,T]=(0,c.useState)(!1),[U,V]=(0,c.useState)(null),[W,X]=(0,c.useState)("all"),[Y,Z]=(0,c.useState)(""),[$,_]=(0,c.useState)(!1);(0,c.useEffect)(()=>{aa()},[]),(0,c.useEffect)(()=>{let a=setTimeout(()=>{aa()},300);return()=>clearTimeout(a)},[H]);let aa=async()=>{try{let a=H?`?search=${encodeURIComponent(H)}`:"",b=await fetch(`/api/tutor/resources${a}`,{credentials:"include"});if(b.ok){let a=await b.json();E(a.resources||[])}else D.toast.error("Failed to load resources")}catch{D.toast.error("Failed to load resources")}finally{G(!1)}},ab=async()=>{if(!N)return void D.toast.error("Please select a file");M(!0);try{let a,b=await fetch(`/api/tutor/resources/upload-url?filename=${encodeURIComponent(N.name)}&mimeType=${encodeURIComponent(N.type)}&size=${N.size}&isPublic=${P.isPublic}`,{credentials:"include"});if(!b.ok)throw Error("Failed to get upload URL");let{uploadUrl:c,key:d,type:e,publicUrl:f,usePresigned:g}=await b.json();if(g){if(!(await fetch(c,{method:"PUT",body:N,headers:{"Content-Type":N.type}})).ok)throw Error("S3 upload failed");a=f||c.split("?")[0]}else{let b=new FormData;b.append("file",N);let c=await fetch("/api/tutor/resources/upload-proxy",{method:"POST",body:b,credentials:"include"});if(!c.ok)throw Error("Proxy upload failed");a=(await c.json()).url}let h=await fetch("/api/tutor/resources",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:P.name||N.name,description:P.description,type:e,size:N.size,mimeType:N.type,url:a,key:d,tags:P.tags.split(",").map(a=>a.trim()).filter(Boolean),isPublic:P.isPublic})});if(h.ok){let{resource:a}=await h.json();E(b=>[a,...b]),D.toast.success("Resource uploaded successfully"),K(!1),O(null),Q({name:"",description:"",tags:"",isPublic:!1})}else throw Error("Failed to create resource")}catch(a){console.error("[upload]",a),D.toast.error("Failed to upload resource")}finally{M(!1)}},ac=async a=>{try{let b=await fetch(`/api/tutor/resources/${a.id}/download`,{credentials:"include"});if(!b.ok)throw Error();let{downloadUrl:c}=await b.json(),d=document.createElement("a");d.href=c,d.download=a.name,d.target="_blank",document.body.appendChild(d),d.click(),document.body.removeChild(d),D.toast.success("Download started")}catch{D.toast.error("Failed to download resource")}},ad=async a=>{if(confirm("Are you sure you want to delete this resource?"))try{if((await fetch(`/api/tutor/resources/${a}`,{method:"DELETE",credentials:"include"})).ok)E(b=>b.filter(b=>b.id!==a)),D.toast.success("Resource deleted");else throw Error("Failed to delete")}catch{D.toast.error("Failed to delete resource")}},ae=async a=>{V(a),X("all"),Z(""),T(!0)},af=async()=>{if(U){_(!0);try{if(!(await fetch(`/api/tutor/resources/${U.id}/share`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({sharedWithAll:"all"===W,message:Y||null})})).ok)throw Error();D.toast.success("Resource shared successfully"),T(!1)}catch{D.toast.error("Failed to share resource")}finally{_(!1)}}};return(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[(0,b.jsx)(k.FolderOpen,{className:"h-6 w-6"}),"Resources"]}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your teaching materials and documents"})]}),(0,b.jsxs)(e.Button,{onClick:()=>K(!0),children:[(0,b.jsx)(l.Plus,{className:"h-4 w-4 mr-2"}),"Upload Resource"]})]}),(0,b.jsx)(d.Card,{className:"mb-6",children:(0,b.jsx)(d.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(m.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,b.jsx)(f.Input,{placeholder:"Search resources...",value:H,onChange:a=>I(a.target.value),className:"pl-10"})]})})}),F?(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[1,2,3,4].map(a=>(0,b.jsx)(d.Card,{className:"animate-pulse",children:(0,b.jsxs)(d.CardContent,{className:"p-6",children:[(0,b.jsx)("div",{className:"h-8 w-8 bg-gray-200 rounded mb-3"}),(0,b.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,b.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})},a))}):0===a.length?(0,b.jsx)(d.Card,{children:(0,b.jsxs)(d.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(k.FolderOpen,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:H?"No resources found":"No resources yet"}),(0,b.jsx)("p",{className:"text-gray-500 mb-4",children:H?"Try adjusting your search":"Upload your first teaching resource to get started"}),(0,b.jsxs)(e.Button,{onClick:()=>K(!0),children:[(0,b.jsx)(l.Plus,{className:"h-4 w-4 mr-2"}),"Upload Resource"]})]})}):(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[a.map(a=>(0,b.jsx)(d.Card,{className:"hover:shadow-md transition-shadow",children:(0,b.jsxs)(d.CardContent,{className:"p-4",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[function(a){switch(a){case"document":return(0,b.jsx)(n.FileText,{className:"h-8 w-8 text-blue-500"});case"image":return(0,b.jsx)(o.Image,{className:"h-8 w-8 text-green-500"});case"spreadsheet":return(0,b.jsx)(p.FileSpreadsheet,{className:"h-8 w-8 text-orange-500"});case"video":return(0,b.jsx)(v.Video,{className:"h-8 w-8 text-red-500"});default:return(0,b.jsx)(w.File,{className:"h-8 w-8 text-gray-500"})}}(a.type),(0,b.jsxs)(C.DropdownMenu,{children:[(0,b.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(q.MoreVertical,{className:"h-4 w-4"})})}),(0,b.jsxs)(C.DropdownMenuContent,{align:"end",children:[(0,b.jsxs)(C.DropdownMenuItem,{onClick:()=>ac(a),children:[(0,b.jsx)(r.Download,{className:"h-4 w-4 mr-2"}),"Download"]}),(0,b.jsxs)(C.DropdownMenuItem,{onClick:()=>ae(a),children:[(0,b.jsx)(y.Share2,{className:"h-4 w-4 mr-2"}),"Share with Students"]}),(0,b.jsxs)(C.DropdownMenuItem,{className:"text-red-600",onClick:()=>ad(a.id),children:[(0,b.jsx)(s.Trash2,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]}),(0,b.jsx)("h3",{className:"font-medium mt-3 truncate",title:a.name,children:a.name}),a.description&&(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-3",children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:function(a){if(0===a)return"0 Bytes";let b=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,b)).toFixed(1))+" "+["Bytes","KB","MB","GB"][b]}(a.size)}),a.tags.length>0&&(0,b.jsxs)("div",{className:"flex gap-1",children:[a.tags.slice(0,2).map((a,c)=>(0,b.jsx)(g.Badge,{variant:"secondary",className:"text-xs",children:a},c)),a.tags.length>2&&(0,b.jsxs)(g.Badge,{variant:"secondary",className:"text-xs",children:["+",a.tags.length-2]})]})]})]})},a.id)),(0,b.jsx)(d.Card,{className:"border-dashed hover:shadow-md transition-shadow cursor-pointer",onClick:()=>K(!0),children:(0,b.jsxs)(d.CardContent,{className:"p-4 flex flex-col items-center justify-center h-full min-h-[160px]",children:[(0,b.jsx)(l.Plus,{className:"h-10 w-10 text-gray-400 mb-2"}),(0,b.jsx)("p",{className:"text-gray-500 font-medium",children:"Upload New"})]})})]}),(0,b.jsx)(h.Dialog,{open:S,onOpenChange:T,children:(0,b.jsxs)(h.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsxs)(h.DialogHeader,{children:[(0,b.jsxs)(h.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(y.Share2,{className:"h-5 w-5"}),"Share Resource"]}),(0,b.jsxs)(h.DialogDescription,{children:["Share “",U?.name,"” with your students."]})]}),(0,b.jsxs)("div",{className:"space-y-4 py-2",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("button",{onClick:()=>X("all"),className:`flex flex-col items-center gap-2 p-4 rounded-lg border-2 transition-colors ${"all"===W?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,children:[(0,b.jsx)(z.Users,{className:"h-6 w-6 text-blue-600"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"All My Students"}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"All enrolled students"})]}),(0,b.jsxs)("button",{onClick:()=>X("specific"),className:`flex flex-col items-center gap-2 p-4 rounded-lg border-2 transition-colors ${"specific"===W?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,children:[(0,b.jsx)(A.Lock,{className:"h-6 w-6 text-purple-600"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"Specific Students"}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"Coming soon"})]})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(i.Label,{htmlFor:"shareMsg",children:"Message (optional)"}),(0,b.jsx)(j.Textarea,{id:"shareMsg",value:Y,onChange:a=>Z(a.target.value),placeholder:"Add a note for students...",rows:2})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>T(!1),children:"Cancel"}),(0,b.jsxs)(e.Button,{onClick:af,disabled:$,className:"gap-2",children:[$?(0,b.jsx)(t.Loader2,{className:"h-4 w-4 animate-spin"}):(0,b.jsx)(B.Globe,{className:"h-4 w-4"}),$?"Sharing...":"Share"]})]})]})}),(0,b.jsx)(h.Dialog,{open:J,onOpenChange:K,children:(0,b.jsxs)(h.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsxs)(h.DialogHeader,{children:[(0,b.jsx)(h.DialogTitle,{children:"Upload Resource"}),(0,b.jsx)(h.DialogDescription,{children:"Upload teaching materials, documents, or media files."})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"File"}),(0,b.jsx)("input",{type:"file",ref:R,onChange:a=>{let b=a.target.files?.[0];b&&(O(b),Q(a=>({...a,name:b.name.replace(/\.[^/.]+$/,"")})))},className:"hidden"}),(0,b.jsx)("div",{onClick:()=>R.current?.click(),className:"border-2 border-dashed rounded-lg p-6 text-center cursor-pointer hover:bg-gray-50 transition-colors",children:N?(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,b.jsx)(n.FileText,{className:"h-5 w-5 text-blue-500"}),(0,b.jsx)("span",{className:"font-medium",children:N.name}),(0,b.jsx)("button",{onClick:a=>{a.stopPropagation(),O(null)},className:"ml-2 text-red-500 hover:text-red-700",children:(0,b.jsx)(u.X,{className:"h-4 w-4"})})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.Plus,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Click to select a file"}),(0,b.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Max size: 100MB"})]})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"name",children:"Name"}),(0,b.jsx)(f.Input,{id:"name",value:P.name,onChange:a=>Q(b=>({...b,name:a.target.value})),placeholder:"Resource name"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{htmlFor:"description",children:"Description (optional)"}),(0,b.jsx)(j.Textarea,{id:"description",value:P.description,onChange:a=>Q(b=>({...b,description:a.target.value})),placeholder:"Brief description of the resource",rows:2})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(i.Label,{htmlFor:"tags",children:[(0,b.jsx)(x,{className:"h-4 w-4 inline mr-1"}),"Tags (comma separated)"]}),(0,b.jsx)(f.Input,{id:"tags",value:P.tags,onChange:a=>Q(b=>({...b,tags:a.target.value})),placeholder:"math, worksheet, grade-5"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"isPublic",checked:P.isPublic,onChange:a=>Q(b=>({...b,isPublic:a.target.checked})),className:"rounded border-gray-300"}),(0,b.jsx)(i.Label,{htmlFor:"isPublic",className:"text-sm cursor-pointer",children:"Make this resource public to students"})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>K(!1),children:"Cancel"}),(0,b.jsx)(e.Button,{onClick:ab,disabled:!N||L,children:L?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(t.Loader2,{className:"h-4 w-4 animate-spin mr-2"}),"Uploading..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.Plus,{className:"h-4 w-4 mr-2"}),"Upload"]})})]})]})})]})}a.s(["default",()=>E],488232)}];

//# debugId=744ead48-e73a-3cf0-4e0b-d839de1ef5a0
//# sourceMappingURL=b1c00_TutorMekimi_tutorme-app_src_app_%5Blocale%5D_tutor_resources_page_tsx_623d5d23._.js.map