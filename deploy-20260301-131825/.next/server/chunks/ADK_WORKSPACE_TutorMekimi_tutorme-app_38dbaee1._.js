;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="65acf4a3-53b0-25be-d000-60b84a17a978")}catch(e){}}();
module.exports=[367533,e=>e.a(async(t,i)=>{try{var n=e.i(620971),r=e.i(384030),a=e.i(738597);e.i(688768);var s=e.i(257357),o=e.i(909105),l=t([r,a]);[r,a]=l.then?(await l)():l;let d={english:{name:"English Language Arts",description:"Language arts, writing, grammar, and literature analysis"},math:{name:"Mathematics",description:"Algebra, geometry, and foundational problem solving"},precalculus:{name:"Pre-calculus",description:"Functions, trigonometry, and preparation for calculus"},"ap-calculus-ab":{name:"AP Calculus AB",description:"Limits, derivatives, integrals, and the Fundamental Theorem"},"ap-calculus-bc":{name:"AP Calculus BC",description:"All AB topics plus series, parametric, and polar calculus"},"ap-statistics":{name:"AP Statistics",description:"Data analysis, probability, and statistical inference"},physics:{name:"Physics",description:"Mechanics, thermodynamics, electricity, and magnetism"},chemistry:{name:"Chemistry",description:"Organic, inorganic, and physical chemistry fundamentals"},biology:{name:"Biology",description:"Cell biology, genetics, ecology, and evolution"},ielts:{name:"IELTS",description:"International English Language Testing System preparation"},toefl:{name:"TOEFL",description:"Test of English as a Foreign Language preparation"},cs:{name:"Computer Science",description:"Programming, algorithms, and software development"}},u=(0,r.withCsrf)((0,r.withAuth)(async(e,t)=>{let i,{response:l}=await (0,r.withRateLimitPreset)(e,"enroll");if(l)return l;let{subjectCode:u}=await e.json();if(!u)throw new r.ValidationError("Subject code required");let p=u.toLowerCase(),m=d[p];if(!m)throw new r.ValidationError("Invalid subject code");let[h]=await a.drizzleDb.select().from(s.curriculum).where((0,o.eq)(s.curriculum.subject,p)).limit(1);if(h){let[e]=await a.drizzleDb.select().from(s.curriculumEnrollment).where((0,o.and)((0,o.eq)(s.curriculumEnrollment.studentId,t.user.id),(0,o.eq)(s.curriculumEnrollment.curriculumId,h.id))).limit(1);if(e)throw new r.ValidationError("Already enrolled in this subject")}h?i=h.id:(i=crypto.randomUUID(),await a.drizzleDb.insert(s.curriculum).values({id:i,name:m.name,subject:p,description:m.description,difficulty:"intermediate",estimatedHours:40,isPublished:!0,isLiveOnline:!0}),await c(i,u));let g=crypto.randomUUID();await a.drizzleDb.insert(s.curriculumEnrollment).values({id:g,studentId:t.user.id,curriculumId:i,lessonsCompleted:0,enrollmentSource:"browse"});let[f]=await a.drizzleDb.select().from(s.userGamification).where((0,o.eq)(s.userGamification.userId,t.user.id)).limit(1);f?await a.drizzleDb.update(s.userGamification).set({xp:f.xp+50}).where((0,o.eq)(s.userGamification.userId,t.user.id)):await a.drizzleDb.insert(s.userGamification).values({id:crypto.randomUUID(),userId:t.user.id,level:1,xp:50,streakDays:0,longestStreak:0,totalStudyMinutes:0,grammarScore:0,vocabularyScore:0,speakingScore:0,listeningScore:0,confidenceScore:0,fluencyScore:0,unlockedWorlds:[]});let[v]=await a.drizzleDb.select().from(s.curriculumEnrollment).where((0,o.eq)(s.curriculumEnrollment.id,g)).limit(1);return n.NextResponse.json({success:!0,enrollment:v,message:`Enrolled in ${m.name}`})},{role:"STUDENT"}));async function c(e,t){let i={precalculus:[{title:"Functions and Graphs",description:"Understanding functions, domain, range, and transformations",lessons:["Introduction to Functions","Function Operations","Graph Transformations"]},{title:"Trigonometry",description:"Trigonometric functions, identities, and equations",lessons:["Unit Circle","Trig Functions","Trig Identities"]},{title:"Analytic Geometry",description:"Conic sections and parametric equations",lessons:["Circles and Parabolas","Ellipses and Hyperbolas","Parametric Equations"]},{title:"Sequences and Series",description:"Arithmetic, geometric sequences and series",lessons:["Arithmetic Sequences","Geometric Sequences","Series and Summation"]}],"ap-calculus-ab":[{title:"Limits and Continuity",description:"Understanding limits and continuity",lessons:["Introduction to Limits","Limit Properties","Continuity"]},{title:"Derivatives",description:"Definition, rules, and applications of derivatives",lessons:["Derivative Definition","Differentiation Rules","Chain Rule","Applications"]},{title:"Integrals",description:"Definite and indefinite integrals",lessons:["Antiderivatives","Definite Integrals","Fundamental Theorem","Applications"]}],"ap-calculus-bc":[{title:"Limits and Continuity",description:"Understanding limits and continuity",lessons:["Introduction to Limits","Limit Properties","Continuity"]},{title:"Derivatives",description:"Definition, rules, and applications",lessons:["Derivative Definition","Differentiation Rules","Applications"]},{title:"Integrals",description:"Definite and indefinite integrals",lessons:["Antiderivatives","Definite Integrals","Applications"]},{title:"Series",description:"Infinite series and convergence",lessons:["Sequences","Series Convergence","Power Series","Taylor Series"]},{title:"Parametric and Polar",description:"Parametric equations and polar coordinates",lessons:["Parametric Curves","Polar Coordinates","Calculus in Polar"]}],"ap-statistics":[{title:"Exploring Data",description:"Describing and analyzing data patterns",lessons:["Graphical Displays","Summarizing Distributions","Comparing Distributions"]},{title:"Sampling and Experimentation",description:"Data collection methods",lessons:["Sampling Methods","Experimental Design","Simulations"]},{title:"Probability",description:"Randomness and probability",lessons:["Probability Rules","Random Variables","Normal Distribution"]},{title:"Inference",description:"Statistical inference and testing",lessons:["Confidence Intervals","Hypothesis Testing","Comparing Groups"]}]}[t.toLowerCase()]||[{title:"Introduction",description:"Getting started with the subject",lessons:["Welcome","Basics","Getting Started"]},{title:"Core Concepts",description:"Fundamental principles",lessons:["Concept 1","Concept 2","Concept 3"]},{title:"Advanced Topics",description:"Deeper exploration",lessons:["Advanced 1","Advanced 2"]}];for(let t=0;t<i.length;t++){let n=i[t],r=crypto.randomUUID();await a.drizzleDb.insert(s.curriculumModule).values({id:r,curriculumId:e,title:n.title,description:n.description,order:t});let o=n.lessons.map((e,t)=>({id:crypto.randomUUID(),moduleId:r,title:e,description:null,duration:30,difficulty:"beginner",order:t,learningObjectives:[],teachingPoints:[],keyConcepts:[],commonMisconceptions:[],prerequisiteLessonIds:[]}));await a.drizzleDb.insert(s.curriculumLesson).values(o)}}e.s(["POST",0,u]),i()}catch(e){i(e)}},!1),465706,e=>e.a(async(t,i)=>{try{var n=e.i(78315),r=e.i(586961),a=e.i(196657),s=e.i(899733),o=e.i(233979),l=e.i(631683),c=e.i(840960),d=e.i(711373),u=e.i(699699),p=e.i(521140),m=e.i(205260),h=e.i(500249),g=e.i(431740),f=e.i(82608),v=e.i(635207),y=e.i(193695);e.i(708038);var w=e.i(447430),b=e.i(367533),C=t([b]);[b]=C.then?(await C)():C;let D=new n.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/student/subjects/enroll/route",pathname:"/api/student/subjects/enroll",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/api/student/subjects/enroll/route.ts",nextConfigOutput:"",userland:b}),{workAsyncStorage:A,workUnitAsyncStorage:S,serverHooks:P}=D;function R(){return(0,a.patchFetch)({workAsyncStorage:A,workUnitAsyncStorage:S})}async function E(e,t,i){D.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let n="/api/student/subjects/enroll/route";n=n.replace(/\/index$/,"")||"/";let a=await D.prepare(e,t,{srcPage:n,multiZoneDraftMode:!1});if(!a)return t.statusCode=400,t.end("Bad Request"),null==i.waitUntil||i.waitUntil.call(i,Promise.resolve()),null;let{buildId:b,params:C,nextConfig:R,parsedUrl:E,isDraftMode:A,prerenderManifest:S,routerServerContext:P,isOnDemandRevalidate:I,revalidateOnlyGenerated:T,resolvedPathname:x,clientReferenceManifest:q,serverActionsManifest:U}=a,O=(0,c.normalizeAppPath)(n),N=!!(S.dynamicRoutes[O]||S.routes[x]),L=async()=>((null==P?void 0:P.render404)?await P.render404(e,t,E,!1):t.end("This page could not be found"),null);if(N&&!A){let e=!!S.routes[x],t=S.dynamicRoutes[O];if(t&&!1===t.fallback&&!e){if(R.experimental.adapterPath)return await L();throw new y.NoFallbackError}}let z=null;!N||D.isDev||A||(z=x,z="/index"===z?"/":z);let _=!0===D.isDev||!N,j=N&&!_;U&&q&&(0,l.setManifestsSingleton)({page:n,clientReferenceManifest:q,serverActionsManifest:U});let H=e.method||"GET",k=(0,o.getTracer)(),M=k.getActiveScopeSpan(),F={params:C,prerenderManifest:S,renderOpts:{experimental:{authInterrupts:!!R.experimental.authInterrupts},cacheComponents:!!R.cacheComponents,supportsDynamicResponse:_,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:R.cacheLife,waitUntil:i.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,i,n,r)=>D.onRequestError(e,t,n,r,P)},sharedContext:{buildId:b}},G=new d.NodeNextRequest(e),B=new d.NodeNextResponse(t),K=u.NextRequestAdapter.fromNodeNextRequest(G,(0,u.signalFromNodeResponse)(t));try{let a=async e=>D.handle(K,F).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let i=k.getRootSpanAttributes();if(!i)return;if(i.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${i.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=i.get("next.route");if(r){let t=`${H} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${n}`)}),l=!!(0,s.getRequestMeta)(e,"minimalMode"),c=async s=>{var o,c;let d=async({previousCacheEntry:r})=>{try{if(!l&&I&&T&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await a(s);e.fetchMetrics=F.renderOpts.fetchMetrics;let o=F.renderOpts.pendingWaitUntil;o&&i.waitUntil&&(i.waitUntil(o),o=void 0);let c=F.renderOpts.collectedTags;if(!N)return await (0,h.sendResponse)(G,B,n,F.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,g.toNodeOutgoingHttpHeaders)(n.headers);c&&(t[v.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let i=void 0!==F.renderOpts.collectedRevalidate&&!(F.renderOpts.collectedRevalidate>=v.INFINITE_CACHE)&&F.renderOpts.collectedRevalidate,r=void 0===F.renderOpts.collectedExpire||F.renderOpts.collectedExpire>=v.INFINITE_CACHE?void 0:F.renderOpts.collectedExpire;return{value:{kind:w.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:i,expire:r}}}}catch(t){throw(null==r?void 0:r.isStale)&&await D.onRequestError(e,t,{routerKind:"App Router",routePath:n,routeType:"route",revalidateReason:(0,m.getRevalidateReason)({isStaticGeneration:j,isOnDemandRevalidate:I})},!1,P),t}},u=await D.handleResponse({req:e,nextConfig:R,cacheKey:z,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:S,isRoutePPREnabled:!1,isOnDemandRevalidate:I,revalidateOnlyGenerated:T,responseGenerator:d,waitUntil:i.waitUntil,isMinimalMode:l});if(!N)return null;if((null==u||null==(o=u.value)?void 0:o.kind)!==w.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(c=u.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",I?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),A&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,g.fromNodeOutgoingHttpHeaders)(u.value.headers);return l&&N||p.delete(v.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,f.getCacheControlHeader)(u.cacheControl)),await (0,h.sendResponse)(G,B,new Response(u.value.body,{headers:p,status:u.value.status||200})),null};M?await c(M):await k.withPropagatedContext(e.headers,()=>k.trace(p.BaseServerSpan.handleRequest,{spanName:`${H} ${n}`,kind:o.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},c))}catch(t){if(t instanceof y.NoFallbackError||await D.onRequestError(e,t,{routerKind:"App Router",routePath:O,routeType:"route",revalidateReason:(0,m.getRevalidateReason)({isStaticGeneration:j,isOnDemandRevalidate:I})},!1,P),N)throw t;return await (0,h.sendResponse)(G,B,new Response(null,{status:500})),null}}e.s(["handler",()=>E,"patchFetch",()=>R,"routeModule",()=>D,"serverHooks",()=>P,"workAsyncStorage",()=>A,"workUnitAsyncStorage",()=>S]),i()}catch(e){i(e)}},!1)];

//# debugId=65acf4a3-53b0-25be-d000-60b84a17a978
//# sourceMappingURL=ADK_WORKSPACE_TutorMekimi_tutorme-app_38dbaee1._.js.map