;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="47850e5f-d7ce-4609-4914-c76852d480fe")}catch(e){}}();
module.exports=[659234,a=>{"use strict";a.s(["default",()=>W,"useAdminContext",()=>U],659234);var b=a.i(260576),c=a.i(741510),d=a.i(454069),e=a.i(309421),f=a.i(663909),g=a.i(907682),h=a.i(681762),i=class extends h.Subscribable{constructor(a={}){super(),this.config=a,this.#a=new Map}#a;build(a,b,c){let d=b.queryKey,g=b.queryHash??(0,e.hashQueryKeyByOptions)(d,b),h=this.get(g);return h||(h=new f.Query({client:a,queryKey:d,queryHash:g,options:a.defaultQueryOptions(b),state:c,defaultOptions:a.getQueryDefaults(d)}),this.add(h)),h}add(a){this.#a.has(a.queryHash)||(this.#a.set(a.queryHash,a),this.notify({type:"added",query:a}))}remove(a){let b=this.#a.get(a.queryHash);b&&(a.destroy(),b===a&&this.#a.delete(a.queryHash),this.notify({type:"removed",query:a}))}clear(){g.notifyManager.batch(()=>{this.getAll().forEach(a=>{this.remove(a)})})}get(a){return this.#a.get(a)}getAll(){return[...this.#a.values()]}find(a){let b={exact:!0,...a};return this.getAll().find(a=>(0,e.matchQuery)(b,a))}findAll(a={}){let b=this.getAll();return Object.keys(a).length>0?b.filter(b=>(0,e.matchQuery)(a,b)):b}notify(a){g.notifyManager.batch(()=>{this.listeners.forEach(b=>{b(a)})})}onFocus(){g.notifyManager.batch(()=>{this.getAll().forEach(a=>{a.onFocus()})})}onOnline(){g.notifyManager.batch(()=>{this.getAll().forEach(a=>{a.onOnline()})})}},j=a.i(488661),k=h,l=class extends k.Subscribable{constructor(a={}){super(),this.config=a,this.#b=new Set,this.#c=new Map,this.#d=0}#b;#c;#d;build(a,b,c){let d=new j.Mutation({client:a,mutationCache:this,mutationId:++this.#d,options:a.defaultMutationOptions(b),state:c});return this.add(d),d}add(a){this.#b.add(a);let b=m(a);if("string"==typeof b){let c=this.#c.get(b);c?c.push(a):this.#c.set(b,[a])}this.notify({type:"added",mutation:a})}remove(a){if(this.#b.delete(a)){let b=m(a);if("string"==typeof b){let c=this.#c.get(b);if(c)if(c.length>1){let b=c.indexOf(a);-1!==b&&c.splice(b,1)}else c[0]===a&&this.#c.delete(b)}}this.notify({type:"removed",mutation:a})}canRun(a){let b=m(a);if("string"!=typeof b)return!0;{let c=this.#c.get(b),d=c?.find(a=>"pending"===a.state.status);return!d||d===a}}runNext(a){let b=m(a);if("string"!=typeof b)return Promise.resolve();{let c=this.#c.get(b)?.find(b=>b!==a&&b.state.isPaused);return c?.continue()??Promise.resolve()}}clear(){g.notifyManager.batch(()=>{this.#b.forEach(a=>{this.notify({type:"removed",mutation:a})}),this.#b.clear(),this.#c.clear()})}getAll(){return Array.from(this.#b)}find(a){let b={exact:!0,...a};return this.getAll().find(a=>(0,e.matchMutation)(b,a))}findAll(a={}){return this.getAll().filter(b=>(0,e.matchMutation)(a,b))}notify(a){g.notifyManager.batch(()=>{this.listeners.forEach(b=>{b(a)})})}resumePausedMutations(){let a=this.getAll().filter(a=>a.state.isPaused);return g.notifyManager.batch(()=>Promise.all(a.map(a=>a.continue().catch(e.noop))))}};function m(a){return a.options.scope?.id}var n=a.i(204104),o=a.i(960503);function p(a){return{onFetch:(b,c)=>{let d=b.options,f=b.fetchOptions?.meta?.fetchMore?.direction,g=b.state.data?.pages||[],h=b.state.data?.pageParams||[],i={pages:[],pageParams:[]},j=0,k=async()=>{let c=!1,k=(0,e.ensureQueryFn)(b.options,b.fetchOptions),l=async(a,d,f)=>{let g;if(c)return Promise.reject();if(null==d&&a.pages.length)return Promise.resolve(a);let h=(g={client:b.client,queryKey:b.queryKey,pageParam:d,direction:f?"backward":"forward",meta:b.options.meta},(0,e.addConsumeAwareSignal)(g,()=>b.signal,()=>c=!0),g),i=await k(h),{maxPages:j}=b.options,l=f?e.addToStart:e.addToEnd;return{pages:l(a.pages,i,j),pageParams:l(a.pageParams,d,j)}};if(f&&g.length){let a="backward"===f,b={pages:g,pageParams:h},c=(a?function(a,{pages:b,pageParams:c}){return b.length>0?a.getPreviousPageParam?.(b[0],b,c[0],c):void 0}:q)(d,b);i=await l(b,c,a)}else{let b=a??g.length;do{let a=0===j?h[0]??d.initialPageParam:q(d,i);if(j>0&&null==a)break;i=await l(i,a),j++}while(j<b)}return i};b.options.persister?b.fetchFn=()=>b.options.persister?.(k,{client:b.client,queryKey:b.queryKey,meta:b.options.meta,signal:b.signal},c):b.fetchFn=k}}}function q(a,{pages:b,pageParams:c}){let d=b.length-1;return b.length>0?a.getNextPageParam(b[d],b,c[d],c):void 0}var r=class{#e;#f;#g;#h;#i;#j;#k;#l;constructor(a={}){this.#e=a.queryCache||new i,this.#f=a.mutationCache||new l,this.#g=a.defaultOptions||{},this.#h=new Map,this.#i=new Map,this.#j=0}mount(){this.#j++,1===this.#j&&(this.#k=n.focusManager.subscribe(async a=>{a&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#l=o.onlineManager.subscribe(async a=>{a&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#j--,0===this.#j&&(this.#k?.(),this.#k=void 0,this.#l?.(),this.#l=void 0)}isFetching(a){return this.#e.findAll({...a,fetchStatus:"fetching"}).length}isMutating(a){return this.#f.findAll({...a,status:"pending"}).length}getQueryData(a){let b=this.defaultQueryOptions({queryKey:a});return this.#e.get(b.queryHash)?.state.data}ensureQueryData(a){let b=this.defaultQueryOptions(a),c=this.#e.build(this,b),d=c.state.data;return void 0===d?this.fetchQuery(a):(a.revalidateIfStale&&c.isStaleByTime((0,e.resolveStaleTime)(b.staleTime,c))&&this.prefetchQuery(b),Promise.resolve(d))}getQueriesData(a){return this.#e.findAll(a).map(({queryKey:a,state:b})=>[a,b.data])}setQueryData(a,b,c){let d=this.defaultQueryOptions({queryKey:a}),f=this.#e.get(d.queryHash),g=f?.state.data,h=(0,e.functionalUpdate)(b,g);if(void 0!==h)return this.#e.build(this,d).setData(h,{...c,manual:!0})}setQueriesData(a,b,c){return g.notifyManager.batch(()=>this.#e.findAll(a).map(({queryKey:a})=>[a,this.setQueryData(a,b,c)]))}getQueryState(a){let b=this.defaultQueryOptions({queryKey:a});return this.#e.get(b.queryHash)?.state}removeQueries(a){let b=this.#e;g.notifyManager.batch(()=>{b.findAll(a).forEach(a=>{b.remove(a)})})}resetQueries(a,b){let c=this.#e;return g.notifyManager.batch(()=>(c.findAll(a).forEach(a=>{a.reset()}),this.refetchQueries({type:"active",...a},b)))}cancelQueries(a,b={}){let c={revert:!0,...b};return Promise.all(g.notifyManager.batch(()=>this.#e.findAll(a).map(a=>a.cancel(c)))).then(e.noop).catch(e.noop)}invalidateQueries(a,b={}){return g.notifyManager.batch(()=>(this.#e.findAll(a).forEach(a=>{a.invalidate()}),a?.refetchType==="none")?Promise.resolve():this.refetchQueries({...a,type:a?.refetchType??a?.type??"active"},b))}refetchQueries(a,b={}){let c={...b,cancelRefetch:b.cancelRefetch??!0};return Promise.all(g.notifyManager.batch(()=>this.#e.findAll(a).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let b=a.fetch(void 0,c);return c.throwOnError||(b=b.catch(e.noop)),"paused"===a.state.fetchStatus?Promise.resolve():b}))).then(e.noop)}fetchQuery(a){let b=this.defaultQueryOptions(a);void 0===b.retry&&(b.retry=!1);let c=this.#e.build(this,b);return c.isStaleByTime((0,e.resolveStaleTime)(b.staleTime,c))?c.fetch(b):Promise.resolve(c.state.data)}prefetchQuery(a){return this.fetchQuery(a).then(e.noop).catch(e.noop)}fetchInfiniteQuery(a){return a.behavior=p(a.pages),this.fetchQuery(a)}prefetchInfiniteQuery(a){return this.fetchInfiniteQuery(a).then(e.noop).catch(e.noop)}ensureInfiniteQueryData(a){return a.behavior=p(a.pages),this.ensureQueryData(a)}resumePausedMutations(){return o.onlineManager.isOnline()?this.#f.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#f}getDefaultOptions(){return this.#g}setDefaultOptions(a){this.#g=a}setQueryDefaults(a,b){this.#h.set((0,e.hashKey)(a),{queryKey:a,defaultOptions:b})}getQueryDefaults(a){let b=[...this.#h.values()],c={};return b.forEach(b=>{(0,e.partialMatchKey)(a,b.queryKey)&&Object.assign(c,b.defaultOptions)}),c}setMutationDefaults(a,b){this.#i.set((0,e.hashKey)(a),{mutationKey:a,defaultOptions:b})}getMutationDefaults(a){let b=[...this.#i.values()],c={};return b.forEach(b=>{(0,e.partialMatchKey)(a,b.mutationKey)&&Object.assign(c,b.defaultOptions)}),c}defaultQueryOptions(a){if(a._defaulted)return a;let b={...this.#g.queries,...this.getQueryDefaults(a.queryKey),...a,_defaulted:!0};return b.queryHash||(b.queryHash=(0,e.hashQueryKeyByOptions)(b.queryKey,b)),void 0===b.refetchOnReconnect&&(b.refetchOnReconnect="always"!==b.networkMode),void 0===b.throwOnError&&(b.throwOnError=!!b.suspense),!b.networkMode&&b.persister&&(b.networkMode="offlineFirst"),b.queryFn===e.skipToken&&(b.enabled=!1),b}defaultMutationOptions(a){return a?._defaulted?a:{...this.#g.mutations,...a?.mutationKey&&this.getMutationDefaults(a.mutationKey),...a,_defaulted:!0}}clear(){this.#e.clear(),this.#f.clear()}},s=a.i(208051),t=a.i(52028),u=a.i(494176),v=a.i(768392),w=a.i(147779),x=a.i(293357);let y=(0,x.default)("toggle-left",[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]]);var z=a.i(970034),A=a.i(946685);let B=(0,x.default)("earth",[["path",{d:"M21.54 15H17a2 2 0 0 0-2 2v4.54",key:"1djwo0"}],["path",{d:"M7 3.34V5a3 3 0 0 0 3 3a2 2 0 0 1 2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.1.9-2 2-2h3.17",key:"1tzkfa"}],["path",{d:"M11 21.95V18a2 2 0 0 0-2-2a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05",key:"14pb5j"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var C=a.i(290385),D=a.i(766001),E=a.i(361749);let F=(0,x.default)("scroll-text",[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]);var G=a.i(706562),H=a.i(892094);let I=[{title:"Dashboard",href:"/admin",icon:v.LayoutDashboard,permission:null},{title:"Users",href:"/admin/users",icon:w.Users,permission:"users:read"},{title:"Feature Flags",href:"/admin/feature-flags",icon:y,permission:"features:read"},{title:"LLM Config",href:"/admin/llm",icon:z.Brain,permission:"llm:read"},{title:"Analytics",href:"/admin/analytics",icon:A.BarChart3,permission:"analytics:read"},{title:"Topology",href:"/admin/topology",icon:B,permission:"analytics:read"},{title:"Content",href:"/admin/content",icon:E.FileText,permission:"content:read"},{title:"Security",href:"/admin/security",icon:D.Shield,permission:"security:read"},{title:"Settings",href:"/admin/settings",icon:C.Settings,permission:"settings:read"},{title:"Audit Logs",href:"/admin/audit-log",icon:F,permission:"audit:read"}];function J({collapsed:a,onToggle:c}){let e=(0,d.usePathname)();return(0,b.jsxs)("aside",{className:(0,u.cn)("fixed left-0 top-0 z-40 h-screen bg-slate-900 text-white transition-all duration-300",a?"w-16":"w-64"),children:[(0,b.jsxs)("div",{className:"flex h-16 items-center justify-between border-b border-slate-700 px-4",children:[!a&&(0,b.jsxs)(t.default,{href:"/admin",className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-blue-600",children:(0,b.jsx)("span",{className:"text-lg font-bold",children:"A"})}),(0,b.jsx)("span",{className:"font-semibold",children:"Admin"})]}),(0,b.jsx)("button",{onClick:c,className:(0,u.cn)("flex h-8 w-8 items-center justify-center rounded-lg hover:bg-slate-800",a&&"mx-auto"),children:a?(0,b.jsx)(H.ChevronRight,{size:18}):(0,b.jsx)(G.ChevronLeft,{size:18})})]}),(0,b.jsx)("nav",{className:"space-y-1 p-2",children:I.map(c=>{let d=c.icon,f="/admin"===c.href?"/admin"===e:e===c.href||e.startsWith(`${c.href}/`);return(0,b.jsxs)(t.default,{href:c.href,className:(0,u.cn)("flex items-center gap-3 rounded-lg px-3 py-2.5 transition-colors",f?"bg-blue-600 text-white":"text-slate-400 hover:bg-slate-800 hover:text-white",a&&"justify-center px-2"),title:a?c.title:void 0,children:[(0,b.jsx)(d,{size:20}),!a&&(0,b.jsx)("span",{className:"text-sm",children:c.title})]},c.href)})}),!a&&(0,b.jsx)("div",{className:"absolute bottom-0 left-0 right-0 border-t border-slate-700 p-4",children:(0,b.jsx)("div",{className:"text-xs text-slate-500",children:"TutorMe Admin v1.0"})})]})}var K=a.i(88684),L=a.i(962337),M=a.i(164504),N=a.i(324666),O=a.i(309402),P=a.i(395261);function Q({collapsed:a}){let{session:d,logout:e}=U(),[f,g]=(0,c.useState)(!1),h=async()=>{g(!0);try{await e()}catch(a){console.error("Logout error:",a)}finally{g(!1)}},i=d?.name?d.name.split(" ").map(a=>a[0]).join("").toUpperCase():d?.email?.[0].toUpperCase()||"A";return(0,b.jsxs)("header",{className:"fixed right-0 top-0 z-30 flex h-16 items-center justify-between border-b bg-white px-6 transition-all duration-300",style:{left:a?"64px":"256px"},children:[(0,b.jsx)("div",{}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)(K.Button,{variant:"ghost",size:"icon",className:"relative",children:[(0,b.jsx)(N.Bell,{size:20}),(0,b.jsx)("span",{className:"absolute -right-0.5 -top-0.5 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-[10px] font-medium text-white",children:"3"})]}),(0,b.jsxs)(L.DropdownMenu,{children:[(0,b.jsx)(L.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(K.Button,{variant:"ghost",className:"flex items-center gap-2",children:[(0,b.jsxs)(M.Avatar,{className:"h-8 w-8",children:[(0,b.jsx)(M.AvatarImage,{src:""}),(0,b.jsx)(M.AvatarFallback,{className:"bg-blue-100 text-blue-700 text-sm",children:i})]}),(0,b.jsxs)("div",{className:"text-left hidden sm:block",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:d?.name||d?.email}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:d?.roles?.join(", ")})]})]})}),(0,b.jsxs)(L.DropdownMenuContent,{align:"end",className:"w-56",children:[(0,b.jsx)(L.DropdownMenuLabel,{children:"My Account"}),(0,b.jsx)(L.DropdownMenuSeparator,{}),(0,b.jsx)(L.DropdownMenuItem,{asChild:!0,children:(0,b.jsxs)(t.default,{href:"/admin/settings/profile",children:[(0,b.jsx)(P.User,{className:"mr-2 h-4 w-4"}),"Profile"]})}),(0,b.jsx)(L.DropdownMenuItem,{asChild:!0,children:(0,b.jsxs)(t.default,{href:"/admin/settings",children:[(0,b.jsx)(C.Settings,{className:"mr-2 h-4 w-4"}),"Settings"]})}),(0,b.jsx)(L.DropdownMenuSeparator,{}),(0,b.jsxs)(L.DropdownMenuItem,{onClick:h,disabled:f,className:"text-red-600 focus:text-red-600",children:[(0,b.jsx)(O.LogOut,{className:"mr-2 h-4 w-4"}),f?"Logging out...":"Log out"]})]})]})]})]})}var R=a.i(479680);let S=new r({defaultOptions:{queries:{staleTime:6e4,refetchOnWindowFocus:!1}}}),T=(0,c.createContext)(null);function U(){let a=(0,c.useContext)(T);if(!a)throw Error("useAdminContext must be used within AdminLayout");return a}function V({children:a}){let e=(0,d.useRouter)(),f=(0,d.usePathname)(),g=(0,d.useParams)(),h=g?.locale?`/${g.locale}`:"",i=`${h}/admin/login`,j=f.endsWith("/admin/login")||f.endsWith("/admin/forgot-password"),k=f.endsWith("/admin/topology"),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(!1);(0,c.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/admin/auth/session",{credentials:"include"});if(a.ok){let b=await a.json();m(b.session)}else m(null)}catch(a){console.error("Session check failed:",a),m(null)}finally{o(!1)}})()},[]),(0,c.useEffect)(()=>{n||l||j||e.replace(i)},[n,l,j,e,i]);let r=async()=>{try{await fetch("/api/admin/auth/logout",{method:"POST",credentials:"include"})}catch(a){console.error("Logout error:",a)}m(null),e.push(i)};return n?(0,b.jsx)("div",{className:"flex h-screen w-full items-center justify-center bg-slate-50",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(R.Loader2,{className:"h-10 w-10 animate-spin text-blue-600 mx-auto"}),(0,b.jsx)("p",{className:"mt-4 text-sm text-slate-500",children:"Loading..."})]})}):l?(0,b.jsx)(T.Provider,{value:{session:l,logout:r},children:(0,b.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[(0,b.jsx)(J,{collapsed:p,onToggle:()=>q(!p)}),(0,b.jsx)(Q,{collapsed:p}),(0,b.jsx)("main",{className:(0,u.cn)("pt-16 transition-all duration-300",k?"fixed inset-0 pt-16":""),style:{marginLeft:k?0:p?"64px":"256px",left:k?p?"64px":"256px":void 0},children:(0,b.jsx)("div",{className:(0,u.cn)(k?"h-full w-full p-0 bg-slate-950":"p-6"),children:a})})]})}):j?(0,b.jsx)("div",{className:"min-h-screen bg-slate-50",children:a}):(0,b.jsx)("div",{className:"flex h-screen w-full items-center justify-center bg-slate-50",children:(0,b.jsx)(R.Loader2,{className:"h-10 w-10 animate-spin text-blue-600"})})}function W({children:a}){return(0,b.jsx)(s.QueryClientProvider,{client:S,children:(0,b.jsx)(V,{children:a})})}}];

//# debugId=47850e5f-d7ce-4609-4914-c76852d480fe
//# sourceMappingURL=ADK_WORKSPACE_TutorMekimi_tutorme-app_src_app_%5Blocale%5D_admin_layout_tsx_92d25a7e._.js.map