;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="bd0ffafb-da55-381b-4cb8-b572442d7165")}catch(e){}}();
module.exports=[593758,89205,e=>{"use strict";var t=e.i(935539),i=e.i(691827),n=e.i(79165);function s(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(e=>e.toLowerCase()).join("_")}function o(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((e,t,i)=>e+(0===i?t.toLowerCase():`${t[0].toUpperCase()}${t.slice(1)}`),"")}function a(e){return e}class r{static [i.entityKind]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert="snake_case"===e?s:"camelCase"===e?o:a}getColumnCasing(e){if(!e.keyAsName)return e.name;let t=e.table[n.Table.Symbol.Schema]??"public",i=e.table[n.Table.Symbol.OriginalName],s=`${t}.${i}.${e.name}`;return this.cache[s]||this.cacheTable(e.table),this.cache[s]}cacheTable(e){let t=e[n.Table.Symbol.Schema]??"public",i=e[n.Table.Symbol.OriginalName],s=`${t}.${i}`;if(!this.cachedTables[s]){for(let t of Object.values(e[n.Table.Symbol.Columns])){let e=`${s}.${t.name}`;this.cache[e]=this.convert(t.name)}this.cachedTables[s]=!0}}clearCache(){this.cache={},this.cachedTables={}}}var l=e.i(707529),d=e.i(910529),u=e.i(450512),c=e.i(649331),m=e.i(824004),p=e.i(447108),h=e.i(996210),y=e.i(62841),_=e.i(888290),g=e.i(785560),x=e.i(111003),I=e.i(50676),N=e.i(909105),f=e.i(320947),b=e.i(827965),A=e.i(275925),T=e.i(239072),w=f;class S extends w.View{static [i.entityKind]="PgViewBase"}e.s(["PgViewBase",()=>S],89205);class v{static [i.entityKind]="PgDialect";casing;constructor(e){this.casing=new r(e?.casing)}async migrate(e,t,i){let n="string"==typeof i?"__drizzle_migrations":i.migrationsTable??"__drizzle_migrations",s="string"==typeof i?"drizzle":i.migrationsSchema??"drizzle",o=f.sql`
			CREATE TABLE IF NOT EXISTS ${f.sql.identifier(s)}.${f.sql.identifier(n)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute(f.sql`CREATE SCHEMA IF NOT EXISTS ${f.sql.identifier(s)}`),await t.execute(o);let a=(await t.all(f.sql`select id, hash, created_at from ${f.sql.identifier(s)}.${f.sql.identifier(n)} order by created_at desc limit 1`))[0];await t.transaction(async t=>{for await(let i of e)if(!a||Number(a.created_at)<i.folderMillis){for(let e of i.sql)await t.execute(f.sql.raw(e));await t.execute(f.sql`insert into ${f.sql.identifier(s)}.${f.sql.identifier(n)} ("hash", "created_at") values(${i.hash}, ${i.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[f.sql`with `];for(let[i,n]of e.entries())t.push(f.sql`${f.sql.identifier(n._.alias)} as (${n._.sql})`),i<e.length-1&&t.push(f.sql`, `);return t.push(f.sql` `),f.sql.join(t)}buildDeleteQuery({table:e,where:t,returning:i,withList:n}){let s=this.buildWithCTE(n),o=i?f.sql` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,a=t?f.sql` where ${t}`:void 0;return f.sql`${s}delete from ${e}${a}${o}`}buildUpdateSet(e,t){let i=e[n.Table.Symbol.Columns],s=Object.keys(i).filter(e=>void 0!==t[e]||i[e]?.onUpdateFn!==void 0),o=s.length;return f.sql.join(s.flatMap((e,n)=>{let s=i[e],a=t[e]??f.sql.param(s.onUpdateFn(),s),r=f.sql`${f.sql.identifier(this.casing.getColumnCasing(s))} = ${a}`;return n<o-1?[r,f.sql.raw(", ")]:[r]}))}buildUpdateQuery({table:e,set:t,where:i,returning:n,withList:s,from:o,joins:a}){let r=this.buildWithCTE(s),l=e[x.PgTable.Symbol.Name],d=e[x.PgTable.Symbol.Schema],u=e[x.PgTable.Symbol.OriginalName],c=l===u?void 0:l,m=f.sql`${d?f.sql`${f.sql.identifier(d)}.`:void 0}${f.sql.identifier(u)}${c&&f.sql` ${f.sql.identifier(c)}`}`,p=this.buildUpdateSet(e,t),h=o&&f.sql.join([f.sql.raw(" from "),this.buildFromTable(o)]),y=this.buildJoins(a),_=n?f.sql` returning ${this.buildSelection(n,{isSingleTable:!o})}`:void 0,g=i?f.sql` where ${i}`:void 0;return f.sql`${r}update ${m} set ${p}${h}${y}${g}${_}`}buildSelection(e,{isSingleTable:t=!1}={}){let n=e.length,s=e.flatMap(({field:e},s)=>{let o=[];if((0,i.is)(e,f.SQL.Aliased)&&e.isSelectionField)o.push(f.sql.identifier(e.fieldAlias));else if((0,i.is)(e,f.SQL.Aliased)||(0,i.is)(e,f.SQL)){let n=(0,i.is)(e,f.SQL.Aliased)?e.sql:e;t?o.push(new f.SQL(n.queryChunks.map(e=>(0,i.is)(e,u.PgColumn)?f.sql.identifier(this.casing.getColumnCasing(e)):e))):o.push(n),(0,i.is)(e,f.SQL.Aliased)&&o.push(f.sql` as ${f.sql.identifier(e.fieldAlias)}`)}else(0,i.is)(e,l.Column)&&(t?o.push(f.sql.identifier(this.casing.getColumnCasing(e))):o.push(e));return s<n-1&&o.push(f.sql`, `),o});return f.sql.join(s)}buildJoins(e){if(!e||0===e.length)return;let t=[];for(let[n,s]of e.entries()){0===n&&t.push(f.sql` `);let o=s.table,a=s.lateral?f.sql` lateral`:void 0;if((0,i.is)(o,x.PgTable)){let e=o[x.PgTable.Symbol.Name],i=o[x.PgTable.Symbol.Schema],n=o[x.PgTable.Symbol.OriginalName],r=e===n?void 0:s.alias;t.push(f.sql`${f.sql.raw(s.joinType)} join${a} ${i?f.sql`${f.sql.identifier(i)}.`:void 0}${f.sql.identifier(n)}${r&&f.sql` ${f.sql.identifier(r)}`} on ${s.on}`)}else if((0,i.is)(o,f.View)){let e=o[T.ViewBaseConfig].name,i=o[T.ViewBaseConfig].schema,n=o[T.ViewBaseConfig].originalName,r=e===n?void 0:s.alias;t.push(f.sql`${f.sql.raw(s.joinType)} join${a} ${i?f.sql`${f.sql.identifier(i)}.`:void 0}${f.sql.identifier(n)}${r&&f.sql` ${f.sql.identifier(r)}`} on ${s.on}`)}else t.push(f.sql`${f.sql.raw(s.joinType)} join${a} ${o} on ${s.on}`);n<e.length-1&&t.push(f.sql` `)}return f.sql.join(t)}buildFromTable(e){if((0,i.is)(e,n.Table)&&e[n.Table.Symbol.OriginalName]!==e[n.Table.Symbol.Name]){let t=f.sql`${f.sql.identifier(e[n.Table.Symbol.OriginalName])}`;return e[n.Table.Symbol.Schema]&&(t=f.sql`${f.sql.identifier(e[n.Table.Symbol.Schema])}.${t}`),f.sql`${t} ${f.sql.identifier(e[n.Table.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:t,fieldsFlat:s,where:o,having:a,table:r,joins:d,orderBy:u,groupBy:c,limit:m,offset:p,lockingClause:h,distinct:y,setOperators:_}){let g,x,I,N=s??(0,A.orderSelectedFields)(t);for(let e of N){let t;if((0,i.is)(e.field,l.Column)&&(0,n.getTableName)(e.field.table)!==((0,i.is)(r,b.Subquery)?r._.alias:(0,i.is)(r,S)?r[T.ViewBaseConfig].name:(0,i.is)(r,f.SQL)?void 0:(0,n.getTableName)(r))&&(t=e.field.table,!d?.some(({alias:e})=>e===(t[n.Table.Symbol.IsAlias]?(0,n.getTableName)(t):t[n.Table.Symbol.BaseName])))){let t=(0,n.getTableName)(e.field.table);throw Error(`Your "${e.path.join("->")}" field references a column "${t}"."${e.field.name}", but the table "${t}" is not part of the query! Did you forget to join it?`)}}let w=!d||0===d.length,v=this.buildWithCTE(e);y&&(g=!0===y?f.sql` distinct`:f.sql` distinct on (${f.sql.join(y.on,f.sql`, `)})`);let k=this.buildSelection(N,{isSingleTable:w}),P=this.buildFromTable(r),z=this.buildJoins(d),C=o?f.sql` where ${o}`:void 0,q=a?f.sql` having ${a}`:void 0;u&&u.length>0&&(x=f.sql` order by ${f.sql.join(u,f.sql`, `)}`),c&&c.length>0&&(I=f.sql` group by ${f.sql.join(c,f.sql`, `)}`);let R="object"==typeof m||"number"==typeof m&&m>=0?f.sql` limit ${m}`:void 0,E=p?f.sql` offset ${p}`:void 0,L=f.sql.empty();if(h){let e=f.sql` for ${f.sql.raw(h.strength)}`;h.config.of&&e.append(f.sql` of ${f.sql.join(Array.isArray(h.config.of)?h.config.of:[h.config.of],f.sql`, `)}`),h.config.noWait?e.append(f.sql` no wait`):h.config.skipLocked&&e.append(f.sql` skip locked`),L.append(e)}let M=f.sql`${v}select${g} ${k} from ${P}${z}${C}${I}${q}${x}${R}${E}${L}`;return _.length>0?this.buildSetOperations(M,_):M}buildSetOperations(e,t){let[i,...n]=t;if(!i)throw Error("Cannot pass undefined values to any set operator");return 0===n.length?this.buildSetOperationQuery({leftSelect:e,setOperator:i}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:i}),n)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:n,rightSelect:s,limit:o,orderBy:a,offset:r}}){let l,d=f.sql`(${e.getSQL()}) `,c=f.sql`(${s.getSQL()})`;if(a&&a.length>0){let e=[];for(let t of a)if((0,i.is)(t,u.PgColumn))e.push(f.sql.identifier(t.name));else if((0,i.is)(t,f.SQL)){for(let e=0;e<t.queryChunks.length;e++){let n=t.queryChunks[e];(0,i.is)(n,u.PgColumn)&&(t.queryChunks[e]=f.sql.identifier(n.name))}e.push(f.sql`${t}`)}else e.push(f.sql`${t}`);l=f.sql` order by ${f.sql.join(e,f.sql`, `)} `}let m="object"==typeof o||"number"==typeof o&&o>=0?f.sql` limit ${o}`:void 0,p=f.sql.raw(`${t} ${n?"all ":""}`),h=r?f.sql` offset ${r}`:void 0;return f.sql`${d}${p}${c}${l}${m}${h}`}buildInsertQuery({table:e,values:t,onConflict:s,returning:o,withList:a,select:r,overridingSystemValue_:l}){let d=[],u=Object.entries(e[n.Table.Symbol.Columns]).filter(([e,t])=>!t.shouldDisableInsert()),c=u.map(([,e])=>f.sql.identifier(this.casing.getColumnCasing(e)));if(r)(0,i.is)(t,f.SQL)?d.push(t):d.push(t.getSQL());else for(let[e,n]of(d.push(f.sql.raw("values ")),t.entries())){let s=[];for(let[e,t]of u){let o=n[e];if(void 0===o||(0,i.is)(o,f.Param)&&void 0===o.value)if(void 0!==t.defaultFn){let e=t.defaultFn(),n=(0,i.is)(e,f.SQL)?e:f.sql.param(e,t);s.push(n)}else if(t.default||void 0===t.onUpdateFn)s.push(f.sql`default`);else{let e=t.onUpdateFn(),n=(0,i.is)(e,f.SQL)?e:f.sql.param(e,t);s.push(n)}else s.push(o)}d.push(s),e<t.length-1&&d.push(f.sql`, `)}let m=this.buildWithCTE(a),p=f.sql.join(d),h=o?f.sql` returning ${this.buildSelection(o,{isSingleTable:!0})}`:void 0,y=s?f.sql` on conflict ${s}`:void 0,_=!0===l?f.sql`overriding system value `:void 0;return f.sql`${m}insert into ${e} ${c} ${_}${p}${y}${h}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:i}){let n=t?f.sql` concurrently`:void 0,s=i?f.sql` with no data`:void 0;return f.sql`refresh materialized view${n} ${e}${s}`}prepareTyping(e){if((0,i.is)(e,p.PgJsonb)||(0,i.is)(e,m.PgJson))return"json";if((0,i.is)(e,h.PgNumeric))return"decimal";if((0,i.is)(e,y.PgTime))return"time";if((0,i.is)(e,_.PgTimestamp)||(0,i.is)(e,_.PgTimestampString))return"timestamp";if((0,i.is)(e,c.PgDate)||(0,i.is)(e,c.PgDateString))return"date";else if((0,i.is)(e,g.PgUUID))return"uuid";else return"none"}sqlToQuery(e,t){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}buildRelationalQueryWithoutPK({fullSchema:e,schema:s,tableNamesMap:o,table:a,tableConfig:r,queryConfig:u,tableAlias:c,nestedQueryRelation:m,joinOn:p}){let h,y=[],_,g,A=[],T,w=[];if(!0===u)y=Object.entries(r.columns).map(([e,i])=>({dbKey:i.name,tsKey:e,field:(0,t.aliasedTableColumn)(i,c),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let a=Object.fromEntries(Object.entries(r.columns).map(([e,i])=>[e,(0,t.aliasedTableColumn)(i,c)]));if(u.where){let e="function"==typeof u.where?u.where(a,(0,I.getOperators)()):u.where;T=e&&(0,t.mapColumnsInSQLToAlias)(e,c)}let d=[],m=[];if(u.columns){let e=!1;for(let[t,i]of Object.entries(u.columns))void 0!==i&&t in r.columns&&(e||!0!==i||(e=!0),m.push(t));m.length>0&&(m=e?m.filter(e=>u.columns?.[e]===!0):Object.keys(r.columns).filter(e=>!m.includes(e)))}else m=Object.keys(r.columns);for(let e of m){let t=r.columns[e];d.push({tsKey:e,value:t})}let p=[];if(u.with&&(p=Object.entries(u.with).filter(e=>!!e[1]).map(([e,t])=>({tsKey:e,queryConfig:t,relation:r.relations[e]}))),u.extras)for(let[e,i]of Object.entries("function"==typeof u.extras?u.extras(a,{sql:f.sql}):u.extras))d.push({tsKey:e,value:(0,t.mapColumnsInAliasedSQLToAlias)(i,c)});for(let{tsKey:e,value:n}of d)y.push({dbKey:(0,i.is)(n,f.SQL.Aliased)?n.fieldAlias:r.columns[e].name,tsKey:e,field:(0,i.is)(n,l.Column)?(0,t.aliasedTableColumn)(n,c):n,relationTableTsKey:void 0,isJson:!1,selection:[]});let h="function"==typeof u.orderBy?u.orderBy(a,(0,I.getOrderByOperators)()):u.orderBy??[];for(let{tsKey:a,queryConfig:r,relation:d}of(Array.isArray(h)||(h=[h]),A=h.map(e=>(0,i.is)(e,l.Column)?(0,t.aliasedTableColumn)(e,c):(0,t.mapColumnsInSQLToAlias)(e,c)),_=u.limit,g=u.offset,p)){let l=(0,I.normalizeRelation)(s,o,d),u=o[(0,n.getTableUniqueName)(d.referencedTable)],m=`${c}_${a}`,p=(0,N.and)(...l.fields.map((e,i)=>(0,N.eq)((0,t.aliasedTableColumn)(l.references[i],m),(0,t.aliasedTableColumn)(e,c)))),h=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:s,tableNamesMap:o,table:e[u],tableConfig:s[u],queryConfig:(0,i.is)(d,I.One)?!0===r?{limit:1}:{...r,limit:1}:r,tableAlias:m,joinOn:p,nestedQueryRelation:d}),_=f.sql`${f.sql.identifier(m)}.${f.sql.identifier("data")}`.as(a);w.push({on:f.sql`true`,table:new b.Subquery(h.sql,{},m),alias:m,joinType:"left",lateral:!0}),y.push({dbKey:a,tsKey:a,field:_,relationTableTsKey:u,isJson:!0,selection:h.selection})}}if(0===y.length)throw new d.DrizzleError({message:`No fields selected for table "${r.tsName}" ("${c}")`});if(T=(0,N.and)(p,T),m){let e=f.sql`json_build_array(${f.sql.join(y.map(({field:e,tsKey:t,isJson:n})=>n?f.sql`${f.sql.identifier(`${c}_${t}`)}.${f.sql.identifier("data")}`:(0,i.is)(e,f.SQL.Aliased)?e.sql:e),f.sql`, `)})`;(0,i.is)(m,I.Many)&&(e=f.sql`coalesce(json_agg(${e}${A.length>0?f.sql` order by ${f.sql.join(A,f.sql`, `)}`:void 0}), '[]'::json)`);let n=[{dbKey:"data",tsKey:"data",field:e.as("data"),isJson:!0,relationTableTsKey:r.tsName,selection:y}];void 0!==_||void 0!==g||A.length>0?(h=this.buildSelectQuery({table:(0,t.aliasedTable)(a,c),fields:{},fieldsFlat:[{path:[],field:f.sql.raw("*")}],where:T,limit:_,offset:g,orderBy:A,setOperators:[]}),T=void 0,_=void 0,g=void 0,A=[]):h=(0,t.aliasedTable)(a,c),h=this.buildSelectQuery({table:(0,i.is)(h,x.PgTable)?h:new b.Subquery(h,{},c),fields:{},fieldsFlat:n.map(({field:e})=>({path:[],field:(0,i.is)(e,l.Column)?(0,t.aliasedTableColumn)(e,c):e})),joins:w,where:T,limit:_,offset:g,orderBy:A,setOperators:[]})}else h=this.buildSelectQuery({table:(0,t.aliasedTable)(a,c),fields:{},fieldsFlat:y.map(({field:e})=>({path:[],field:(0,i.is)(e,l.Column)?(0,t.aliasedTableColumn)(e,c):e})),joins:w,where:T,limit:_,offset:g,orderBy:A,setOperators:[]});return{tableTsKey:r.tsName,sql:h,selection:y}}}e.s(["PgDialect",()=>v],593758)},587682,e=>{"use strict";var t=e.i(691827),i=e.i(793886),n=e.i(79165),s=e.i(686289),o=e.i(275925);class a extends i.QueryPromise{constructor(e,t,i,n){super(),this.session=t,this.dialect=i,this.config={table:e,withList:n}}static [t.entityKind]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[n.Table.Symbol.Columns]){return this.config.returning=(0,o.orderSelectedFields)(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return s.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>s.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));$dynamic(){return this}}var r=i,l=e.i(320947),d=e.i(593758),u=e.i(935539),c=e.i(707529),m=e.i(827965),p=e.i(239072);class h{static [t.entityKind]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,i){if("_"===i)return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(i===p.ViewBaseConfig)return{...e[p.ViewBaseConfig],selectedFields:new Proxy(e[p.ViewBaseConfig].selectedFields,this)};if("symbol"==typeof i)return e[i];let n=((0,t.is)(e,m.Subquery)?e._.selectedFields:(0,t.is)(e,l.View)?e[p.ViewBaseConfig].selectedFields:e)[i];if((0,t.is)(n,l.SQL.Aliased)){if("sql"===this.config.sqlAliasedBehavior&&!n.isSelectionField)return n.sql;let e=n.clone();return e.isSelectionField=!0,e}if((0,t.is)(n,l.SQL)){if("sql"===this.config.sqlBehavior)return n;throw Error(`You tried to reference "${i}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return(0,t.is)(n,c.Column)?this.config.alias?new Proxy(n,new u.ColumnAliasProxyHandler(new Proxy(n.table,new u.TableAliasProxyHandler(this.config.alias,this.config.replaceOriginalName??!1)))):n:"object"!=typeof n||null===n?n:new Proxy(n,new h(this.config))}}var y=e.i(89205);class _{static [t.entityKind]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class g{static [t.entityKind]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let i,n=!!this.fields;return i=this.fields?this.fields:(0,t.is)(e,m.Subquery)?Object.fromEntries(Object.keys(e._.selectedFields).map(t=>[t,e[t]])):(0,t.is)(e,y.PgViewBase)?e[p.ViewBaseConfig].selectedFields:(0,t.is)(e,l.SQL)?{}:(0,o.getTableColumns)(e),new I({table:e,fields:i,isPartialSelect:n,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}}class x extends _{static [t.entityKind]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:t,isPartialSelect:i,session:n,dialect:s,withList:a,distinct:r}){super(),this.config={withList:a,table:e,fields:{...t},distinct:r,setOperators:[]},this.isPartialSelect=i,this.session=n,this.dialect=s,this._={selectedFields:t},this.tableName=(0,o.getTableLikeName)(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}createJoin(e){return(i,s)=>{let a=this.tableName,r=(0,o.getTableLikeName)(i);if("string"==typeof r&&this.config.joins?.some(e=>e.alias===r))throw Error(`Alias "${r}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof a&&(this.config.fields={[a]:this.config.fields}),"string"==typeof r&&!(0,t.is)(i,l.SQL))){let e=(0,t.is)(i,m.Subquery)?i._.selectedFields:(0,t.is)(i,l.View)?i[p.ViewBaseConfig].selectedFields:i[n.Table.Symbol.Columns];this.config.fields[r]=e}if("function"==typeof s&&(s=s(new Proxy(this.config.fields,new h({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:s,table:i,joinType:e,alias:r}),"string"==typeof r)switch(e){case"left":this.joinsNotNullableMap[r]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[r]=!0;break;case"inner":this.joinsNotNullableMap[r]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[r]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,t){return i=>{let n="function"==typeof i?i(f()):i;if(!(0,o.haveSameKeys)(this.getSelectedFields(),n.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:n}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new h({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new h({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new h({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new h({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),i=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=i:this.config.orderBy=i}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=e:this.config.orderBy=e;return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){return new Proxy(new m.Subquery(this.getSQL(),this.config.fields,e),new h({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new h({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class I extends x{static [t.entityKind]="PgSelect";_prepare(e){let{session:t,config:i,dialect:n,joinsNotNullableMap:a,authToken:r}=this;if(!t)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");return s.tracer.startActiveSpan("drizzle.prepareQuery",()=>{let s=(0,o.orderSelectedFields)(i.fields),l=t.prepareQuery(n.sqlToQuery(this.getSQL()),s,e,!0);return l.joinsNotNullableMap=a,l.setToken(r)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>s.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))}function N(e,t){return(i,n,...s)=>{let a=[n,...s].map(i=>({type:e,isAll:t,rightSelect:i}));for(let e of a)if(!(0,o.haveSameKeys)(i.getSelectedFields(),e.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return i.addSetOperators(a)}}(0,o.applyMixins)(I,[i.QueryPromise]);let f=()=>({union:b,unionAll:A,intersect:T,intersectAll:w,except:S,exceptAll:v}),b=N("union",!1),A=N("union",!0),T=N("intersect",!1),w=N("intersect",!0),S=N("except",!1),v=N("except",!0);class k{static [t.entityKind]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=(0,t.is)(e,d.PgDialect)?e:void 0,this.dialectConfig=(0,t.is)(e,d.PgDialect)?void 0:e}$with(e){let t=this;return{as:i=>("function"==typeof i&&(i=i(t)),new Proxy(new m.WithSubquery(i.getSQL(),i.getSelectedFields(),e,!0),new h({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}}with(...e){let t=this;return{select:function(i){return new g({fields:i??void 0,session:void 0,dialect:t.getDialect(),withList:e})},selectDistinct:function(e){return new g({fields:e??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})},selectDistinctOn:function(e,i){return new g({fields:i??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:e}})}}}select(e){return new g({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new g({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new g({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new d.PgDialect(this.dialectConfig)),this.dialect}}class P{constructor(e,t,i,n,s){this.table=e,this.session=t,this.dialect=i,this.withList=n,this.overridingSystemValue_=s}static [t.entityKind]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(0===(e=Array.isArray(e)?e:[e]).length)throw Error("values() must be called with at least one value");let i=e.map(e=>{let i={},s=this.table[n.Table.Symbol.Columns];for(let n of Object.keys(e)){let o=e[n];i[n]=(0,t.is)(o,l.SQL)?o:new l.Param(o,s[n])}return i});return new z(this.table,i,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let i="function"==typeof e?e(new k):e;if(!(0,t.is)(i,l.SQL)&&!(0,o.haveSameKeys)(this.table[n.Columns],i._.selectedFields))throw Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new z(this.table,i,this.session,this.dialect,this.withList,!0)}}class z extends r.QueryPromise{constructor(e,t,i,n,s,o,a){super(),this.session=i,this.dialect=n,this.config={table:e,values:t,withList:s,select:o,overridingSystemValue_:a}}static [t.entityKind]="PgInsert";config;returning(e=this.config.table[n.Table.Symbol.Columns]){return this.config.returning=(0,o.orderSelectedFields)(e),this}onConflictDoNothing(e={}){if(void 0===e.target)this.config.onConflict=l.sql`do nothing`;else{let t="";t=Array.isArray(e.target)?e.target.map(e=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(e))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let i=e.where?l.sql` where ${e.where}`:void 0;this.config.onConflict=l.sql`(${l.sql.raw(t)})${i} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let t=e.where?l.sql` where ${e.where}`:void 0,i=e.targetWhere?l.sql` where ${e.targetWhere}`:void 0,n=e.setWhere?l.sql` where ${e.setWhere}`:void 0,s=this.dialect.buildUpdateSet(this.config.table,(0,o.mapUpdateSet)(this.config.table,e.set)),a="";return a=Array.isArray(e.target)?e.target.map(e=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(e))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=l.sql`(${l.sql.raw(a)})${i} do update set ${s}${t}${n}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return s.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>s.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));$dynamic(){return this}}var C=e.i(111003),q=i;class R{constructor(e,t,i,n){this.table=e,this.session=t,this.dialect=i,this.withList=n}static [t.entityKind]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new E(this.table,(0,o.mapUpdateSet)(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}}class E extends q.QueryPromise{constructor(e,t,i,n,s){super(),this.session=i,this.dialect=n,this.config={set:t,table:e,withList:s,joins:[]},this.tableName=(0,o.getTableLikeName)(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}static [t.entityKind]="PgUpdate";config;tableName;joinsNotNullableMap;from(e){let t=(0,o.getTableLikeName)(e);return"string"==typeof t&&(this.joinsNotNullableMap[t]=!0),this.config.from=e,this}getTableLikeFields(e){return(0,t.is)(e,C.PgTable)?e[n.Table.Symbol.Columns]:(0,t.is)(e,m.Subquery)?e._.selectedFields:e[p.ViewBaseConfig].selectedFields}createJoin(e){return(i,s)=>{let a=(0,o.getTableLikeName)(i);if("string"==typeof a&&this.config.joins.some(e=>e.alias===a))throw Error(`Alias "${a}" is already used in this query`);if("function"==typeof s){let e=this.config.from&&!(0,t.is)(this.config.from,l.SQL)?this.getTableLikeFields(this.config.from):void 0;s=s(new Proxy(this.config.table[n.Table.Symbol.Columns],new h({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),e&&new Proxy(e,new h({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:s,table:i,joinType:e,alias:a}),"string"==typeof a)switch(e){case"left":this.joinsNotNullableMap[a]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[a]=!0;break;case"inner":this.joinsNotNullableMap[a]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[a]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[n.Table.Symbol.Columns]),this.config.from)){let i=(0,o.getTableLikeName)(this.config.from);if("string"==typeof i&&this.config.from&&!(0,t.is)(this.config.from,l.SQL)){let t=this.getTableLikeFields(this.config.from);e[i]=t}for(let i of this.config.joins){let n=(0,o.getTableLikeName)(i.table);if("string"==typeof n&&!(0,t.is)(i.table,l.SQL)){let t=this.getTableLikeFields(i.table);e[n]=t}}}return this.config.returning=(0,o.orderSelectedFields)(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){let t=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return t.joinsNotNullableMap=this.joinsNotNullableMap,t}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);$dynamic(){return this}}var L=l;class M extends L.SQL{constructor(e){super(M.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=M.buildCount(e.source,e.filters)}sql;token;static [t.entityKind]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,t){return L.sql`(select count(*) from ${e}${L.sql.raw(" where ").if(t)}${t})`}static buildCount(e,t){return L.sql`select count(*) as count from ${e}${L.sql.raw(" where ").if(t)}${t};`}setToken(e){return this.token=e,this}then(e,t){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}}var j=i,B=e.i(50676);class ${constructor(e,t,i,n,s,o,a){this.fullSchema=e,this.schema=t,this.tableNamesMap=i,this.table=n,this.tableConfig=s,this.dialect=o,this.session=a}static [t.entityKind]="PgRelationalQueryBuilder";findMany(e){return new Q(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new Q(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}}class Q extends j.QueryPromise{constructor(e,t,i,n,s,o,a,r,l){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=i,this.table=n,this.tableConfig=s,this.dialect=o,this.session=a,this.config=r,this.mode=l}static [t.entityKind]="PgRelationalQuery";_prepare(e){return s.tracer.startActiveSpan("drizzle.prepareQuery",()=>{let{query:t,builtQuery:i}=this._toSQL();return this.session.prepareQuery(i,void 0,e,!0,(e,i)=>{let n=e.map(e=>(0,B.mapRelationalRow)(this.schema,this.tableConfig,e,t.selection,i));return"first"===this.mode?n[0]:n})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),t=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:t}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return s.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}}var K=i;class D extends K.QueryPromise{constructor(e,t,i,n){super(),this.execute=e,this.sql=t,this.query=i,this.mapBatchResult=n}static [t.entityKind]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}}var O=i;class W extends O.QueryPromise{constructor(e,t,i){super(),this.session=t,this.dialect=i,this.config={view:e}}static [t.entityKind]="PgRefreshMaterializedView";config;concurrently(){if(void 0!==this.config.withNoData)throw Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(void 0!==this.config.concurrently)throw Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return s.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>s.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))}class U{constructor(e,t,i){if(this.dialect=e,this.session=t,this._=i?{schema:i.schema,fullSchema:i.fullSchema,tableNamesMap:i.tableNamesMap,session:t}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:t},this.query={},this._.schema)for(const[n,s]of Object.entries(this._.schema))this.query[n]=new $(i.fullSchema,this._.schema,this._.tableNamesMap,i.fullSchema[n],s,e,t)}static [t.entityKind]="PgDatabase";query;$with(e){let t=this;return{as:i=>("function"==typeof i&&(i=i(new k(t.dialect))),new Proxy(new m.WithSubquery(i.getSQL(),i.getSelectedFields(),e,!0),new h({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}}$count(e,t){return new M({source:e,filters:t,session:this.session})}with(...e){let t=this;return{select:function(i){return new g({fields:i??void 0,session:t.session,dialect:t.dialect,withList:e})},selectDistinct:function(i){return new g({fields:i??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})},selectDistinctOn:function(i,n){return new g({fields:n??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:{on:i}})},update:function(i){return new R(i,t.session,t.dialect,e)},insert:function(i){return new P(i,t.session,t.dialect,e)},delete:function(i){return new a(i,t.session,t.dialect,e)}}}select(e){return new g({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new g({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,t){return new g({fields:t??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new R(e,this.session,this.dialect)}insert(e){return new P(e,this.session,this.dialect)}delete(e){return new a(e,this.session,this.dialect)}refreshMaterializedView(e){return new W(e,this.session,this.dialect)}authToken;execute(e){let t="string"==typeof e?l.sql.raw(e):e.getSQL(),i=this.dialect.sqlToQuery(t),n=this.session.prepareQuery(i,void 0,void 0,!1);return new D(()=>n.execute(void 0,this.authToken),t,i,e=>n.mapResult(e,!0))}transaction(e,t){return this.session.transaction(e,t)}}e.s(["PgDatabase",()=>U],587682)},566063,e=>{"use strict";var t=e.i(691827),i=e.i(910529),n=e.i(320947),s=e.i(686289),o=e.i(587682);class a{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,t){return e}setToken(e){return this.authToken=e,this}static [t.entityKind]="PgPreparedQuery";joinsNotNullableMap}class r{constructor(e){this.dialect=e}static [t.entityKind]="PgSession";execute(e,t){return s.tracer.startActiveSpan("drizzle.operation",()=>s.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(t).execute(void 0,t))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,t){return Number((await this.execute(e,t))[0].count)}}class l extends o.PgDatabase{constructor(e,t,i,n=0){super(e,t,i),this.schema=i,this.nestedIndex=n}static [t.entityKind]="PgTransaction";rollback(){throw new i.TransactionRollbackError}getTransactionConfigSQL(e){let t=[];return e.isolationLevel&&t.push(`isolation level ${e.isolationLevel}`),e.accessMode&&t.push(e.accessMode),"boolean"==typeof e.deferrable&&t.push(e.deferrable?"deferrable":"not deferrable"),n.sql.raw(t.join(" "))}setTransaction(e){return this.session.execute(n.sql`set transaction ${this.getTransactionConfigSQL(e)}`)}}e.s(["PgPreparedQuery",()=>a,"PgSession",()=>r,"PgTransaction",()=>l])},17059,e=>e.a(async(t,i)=>{try{var n=e.i(238523),s=e.i(691827),o=e.i(608898),a=e.i(566063),r=e.i(320947),l=e.i(686289),d=e.i(275925),u=t([n]);[n]=u.then?(await u)():u;let{Pool:c,types:m}=n.default;class p extends a.PgPreparedQuery{constructor(e,t,i,n,s,o,a,r){super({sql:t,params:i}),this.client=e,this.params=i,this.logger=n,this.fields=s,this._isResponseInArrayMode=a,this.customResultMapper=r,this.rawQueryConfig={name:o,text:t,types:{getTypeParser:(e,t)=>e===m.builtins.TIMESTAMPTZ||e===m.builtins.TIMESTAMP||e===m.builtins.DATE||e===m.builtins.INTERVAL?e=>e:m.getTypeParser(e,t)}},this.queryConfig={name:o,text:t,rowMode:"array",types:{getTypeParser:(e,t)=>e===m.builtins.TIMESTAMPTZ||e===m.builtins.TIMESTAMP||e===m.builtins.DATE||e===m.builtins.INTERVAL?e=>e:m.getTypeParser(e,t)}}}static [s.entityKind]="NodePgPreparedQuery";rawQueryConfig;queryConfig;async execute(e={}){return l.tracer.startActiveSpan("drizzle.execute",async()=>{let t=(0,r.fillPlaceholders)(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,t);let{fields:i,rawQueryConfig:n,client:s,queryConfig:o,joinsNotNullableMap:a,customResultMapper:u}=this;if(!i&&!u)return l.tracer.startActiveSpan("drizzle.driver.execute",async e=>(e?.setAttributes({"drizzle.query.name":n.name,"drizzle.query.text":n.text,"drizzle.query.params":JSON.stringify(t)}),s.query(n,t)));let c=await l.tracer.startActiveSpan("drizzle.driver.execute",e=>(e?.setAttributes({"drizzle.query.name":o.name,"drizzle.query.text":o.text,"drizzle.query.params":JSON.stringify(t)}),s.query(o,t)));return l.tracer.startActiveSpan("drizzle.mapResponse",()=>u?u(c.rows):c.rows.map(e=>(0,d.mapResultRow)(i,e,a)))})}all(e={}){return l.tracer.startActiveSpan("drizzle.execute",()=>{let t=(0,r.fillPlaceholders)(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,t),l.tracer.startActiveSpan("drizzle.driver.execute",e=>(e?.setAttributes({"drizzle.query.name":this.rawQueryConfig.name,"drizzle.query.text":this.rawQueryConfig.text,"drizzle.query.params":JSON.stringify(t)}),this.client.query(this.rawQueryConfig,t).then(e=>e.rows)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}}class h extends a.PgSession{constructor(e,t,i,n={}){super(t),this.client=e,this.schema=i,this.options=n,this.logger=n.logger??new o.NoopLogger}static [s.entityKind]="NodePgSession";logger;prepareQuery(e,t,i,n,s){return new p(this.client,e.sql,e.params,this.logger,t,i,n,s)}async transaction(e,t){let i=this.client instanceof c?new h(await this.client.connect(),this.dialect,this.schema,this.options):this,n=new y(this.dialect,i,this.schema);await n.execute(r.sql`begin${t?r.sql` ${n.getTransactionConfigSQL(t)}`:void 0}`);try{let t=await e(n);return await n.execute(r.sql`commit`),t}catch(e){throw await n.execute(r.sql`rollback`),e}finally{this.client instanceof c&&i.client.release()}}async count(e){let t=await this.execute(e);return Number(t.rows[0].count)}}class y extends a.PgTransaction{static [s.entityKind]="NodePgTransaction";async transaction(e){let t=`sp${this.nestedIndex+1}`,i=new y(this.dialect,this.session,this.schema,this.nestedIndex+1);await i.execute(r.sql.raw(`savepoint ${t}`));try{let n=await e(i);return await i.execute(r.sql.raw(`release savepoint ${t}`)),n}catch(e){throw await i.execute(r.sql.raw(`rollback to savepoint ${t}`)),e}}}e.s(["NodePgSession",()=>h]),i()}catch(e){i(e)}},!1),13460,e=>e.a(async(t,i)=>{try{var n=e.i(238523),s=e.i(691827),o=e.i(608898),a=e.i(587682),r=e.i(593758),l=e.i(50676),d=e.i(275925),u=e.i(17059),c=t([n,u]);[n,u]=c.then?(await c)():c;class h{constructor(e,t,i={}){this.client=e,this.dialect=t,this.options=i}static [s.entityKind]="NodePgDriver";createSession(e){return new u.NodePgSession(this.client,this.dialect,e,{logger:this.options.logger})}}class y extends a.PgDatabase{static [s.entityKind]="NodePgDatabase"}function m(e,t={}){let i,n,s=new r.PgDialect({casing:t.casing});if(!0===t.logger?i=new o.DefaultLogger:!1!==t.logger&&(i=t.logger),t.schema){let e=(0,l.extractTablesRelationalConfig)(t.schema,l.createTableRelationsHelpers);n={fullSchema:t.schema,schema:e.tables,tableNamesMap:e.tableNamesMap}}let a=new h(e,s,{logger:i}).createSession(n),d=new y(s,a,n);return d.$client=e,d}function p(...e){if("string"==typeof e[0]){let t=new n.default.Pool({connectionString:e[0]});return m(t,e[1])}if((0,d.isConfig)(e[0])){let{connection:t,client:i,...s}=e[0];if(i)return m(i,s);let o=new n.default.Pool("string"==typeof t?{connectionString:t}:t);return m(o,s)}return m(e[0],e[1])}(p||(p={})).mock=function(e){return m({},e)},e.s(["drizzle",()=>p]),i()}catch(e){i(e)}},!1),1638,257357,e=>{"use strict";var t=e.i(851305);let i=(0,t.pgEnum)("Role",["STUDENT","TUTOR","PARENT","ADMIN"]),n=(0,t.pgEnum)("PollType",["MULTIPLE_CHOICE","TRUE_FALSE","RATING","SHORT_ANSWER","WORD_CLOUD"]),s=(0,t.pgEnum)("PollStatus",["DRAFT","ACTIVE","CLOSED"]),o=(0,t.pgEnum)("SessionType",["CLINIC","GROUP","ONE_ON_ONE"]),a=(0,t.pgEnum)("MessageSource",["AI","TUTOR","STUDENT"]),r=(0,t.pgEnum)("Tier",["FREE","PRO","ELITE"]),l=(0,t.pgEnum)("PaymentStatus",["PENDING","PROCESSING","COMPLETED","FAILED","REFUNDED","CANCELLED"]),d=(0,t.pgEnum)("PaymentGateway",["AIRWALLEX","HITPAY"]),u=(0,t.pgEnum)("RefundStatus",["PENDING","PROCESSING","COMPLETED","FAILED"]),c=(0,t.pgEnum)("EventType",["LESSON","CLINIC","CONSULTATION","BREAK","PERSONAL","OTHER"]),m=(0,t.pgEnum)("EventStatus",["CONFIRMED","TENTATIVE","CANCELLED"]),p=(0,t.pgEnum)("MathSessionStatus",["ACTIVE","PAUSED","ENDED","ARCHIVED"]),h=(0,t.pgEnum)("MathAIInteractionType",["SOLVE","HINT","CHECK","EXPLAIN","RECOGNIZE"]);e.s(["eventStatusEnum",0,m,"eventTypeEnum",0,c,"mathAIInteractionTypeEnum",0,h,"mathSessionStatusEnum",0,p,"messageSourceEnum",0,a,"paymentGatewayEnum",0,d,"paymentStatusEnum",0,l,"pollStatusEnum",0,s,"pollTypeEnum",0,n,"refundStatusEnum",0,u,"roleEnum",0,i,"sessionTypeEnum",0,o,"tierEnum",0,r],1638);var y=e.i(111003),_=e.i(924841),g=e.i(911560),x=e.i(343297),I=e.i(888290),N=e.i(447108),f=e.i(984376),b=e.i(320947),A=e.i(691827),T=e.i(450512);class w{constructor(e,t){this.unique=e,this.name=t}static [A.entityKind]="PgIndexBuilderOn";on(...e){return new S(e.map(e=>{if((0,A.is)(e,b.SQL))return e;let t=new T.IndexedColumn(e.name,!!e.keyAsName,e.columnType,e.indexConfig);return e.indexConfig=JSON.parse(JSON.stringify(e.defaultConfig)),t}),this.unique,!1,this.name)}onOnly(...e){return new S(e.map(e=>{if((0,A.is)(e,b.SQL))return e;let t=new T.IndexedColumn(e.name,!!e.keyAsName,e.columnType,e.indexConfig);return e.indexConfig=e.defaultConfig,t}),this.unique,!0,this.name)}using(e,...t){return new S(t.map(e=>{if((0,A.is)(e,b.SQL))return e;let t=new T.IndexedColumn(e.name,!!e.keyAsName,e.columnType,e.indexConfig);return e.indexConfig=JSON.parse(JSON.stringify(e.defaultConfig)),t}),this.unique,!0,this.name,e)}}class S{static [A.entityKind]="PgIndexBuilder";config;constructor(e,t,i,n,s="btree"){this.config={name:n,columns:e,unique:t,only:i,method:s}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new v(this.config,e)}}class v{static [A.entityKind]="PgIndex";config;constructor(e,t){this.config={...e,table:t}}}function k(e){return new w(!1,e)}function P(e){return new w(!0,e)}let z=(0,y.pgTable)("User",{id:(0,_.text)("id").primaryKey().notNull(),email:(0,_.text)("email").notNull().unique(),password:(0,_.text)("password"),role:i("role").notNull(),emailVerified:(0,I.timestamp)("emailVerified",{withTimezone:!0}),image:(0,_.text)("image"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)}),C=(0,y.pgTable)("Account",{id:(0,_.text)("id").primaryKey().notNull(),userId:(0,_.text)("userId").notNull(),type:(0,_.text)("type").notNull(),provider:(0,_.text)("provider").notNull(),providerAccountId:(0,_.text)("providerAccountId").notNull(),refresh_token:(0,_.text)("refresh_token"),access_token:(0,_.text)("access_token"),expires_at:(0,g.integer)("expires_at"),token_type:(0,_.text)("token_type"),scope:(0,_.text)("scope"),id_token:(0,_.text)("id_token"),session_state:(0,_.text)("session_state")},e=>({Account_userId_idx:k("Account_userId_idx").on(e.userId),Account_provider_providerAccountId_key:P("Account_provider_providerAccountId_key").on(e.provider,e.providerAccountId)})),q=(0,y.pgTable)("Profile",{id:(0,_.text)("id").primaryKey().notNull(),userId:(0,_.text)("userId").notNull().unique(),name:(0,_.text)("name"),username:(0,_.text)("username").unique(),bio:(0,_.text)("bio"),avatarUrl:(0,_.text)("avatarUrl"),dateOfBirth:(0,I.timestamp)("dateOfBirth",{withTimezone:!0}),timezone:(0,_.text)("timezone").notNull(),emailNotifications:(0,x.boolean)("emailNotifications").notNull(),smsNotifications:(0,x.boolean)("smsNotifications").notNull(),gradeLevel:(0,_.text)("gradeLevel"),studentUniqueId:(0,_.text)("studentUniqueId").unique(),subjectsOfInterest:(0,_.text)("subjectsOfInterest").array().notNull(),preferredLanguages:(0,_.text)("preferredLanguages").array().notNull(),learningGoals:(0,_.text)("learningGoals").array().notNull(),tosAccepted:(0,x.boolean)("tosAccepted").notNull(),tosAcceptedAt:(0,I.timestamp)("tosAcceptedAt",{withTimezone:!0}),organizationName:(0,_.text)("organizationName"),isOnboarded:(0,x.boolean)("isOnboarded").notNull(),hourlyRate:(0,f.doublePrecision)("hourlyRate"),specialties:(0,_.text)("specialties").array().notNull(),credentials:(0,_.text)("credentials"),availability:(0,N.jsonb)("availability"),paidClassesEnabled:(0,x.boolean)("paidClassesEnabled").notNull(),paymentGatewayPreference:(0,_.text)("paymentGatewayPreference"),currency:(0,_.text)("currency"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)}),R=(0,y.pgTable)("CurriculumCatalog",{id:(0,_.text)("id").primaryKey().notNull(),subject:(0,_.text)("subject").notNull(),name:(0,_.text)("name").notNull(),code:(0,_.text)("code"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({CurriculumCatalog_subject_idx:k("CurriculumCatalog_subject_idx").on(e.subject),CurriculumCatalog_subject_name_key:P("CurriculumCatalog_subject_name_key").on(e.subject,e.name)})),E=(0,y.pgTable)("Curriculum",{id:(0,_.text)("id").primaryKey().notNull(),name:(0,_.text)("name").notNull(),description:(0,_.text)("description"),subject:(0,_.text)("subject").notNull(),gradeLevel:(0,_.text)("gradeLevel"),difficulty:(0,_.text)("difficulty").notNull(),estimatedHours:(0,g.integer)("estimatedHours").notNull(),isPublished:(0,x.boolean)("isPublished").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date),creatorId:(0,_.text)("creatorId"),isLiveOnline:(0,x.boolean)("isLiveOnline").notNull(),languageOfInstruction:(0,_.text)("languageOfInstruction"),price:(0,f.doublePrecision)("price"),currency:(0,_.text)("currency"),curriculumSource:(0,_.text)("curriculumSource"),outlineSource:(0,_.text)("outlineSource"),schedule:(0,N.jsonb)("schedule"),courseMaterials:(0,N.jsonb)("courseMaterials"),coursePitch:(0,_.text)("coursePitch")},e=>({Curriculum_subject_idx:k("Curriculum_subject_idx").on(e.subject),Curriculum_isPublished_idx:k("Curriculum_isPublished_idx").on(e.isPublished),Curriculum_creatorId_idx:k("Curriculum_creatorId_idx").on(e.creatorId)})),L=(0,y.pgTable)("CurriculumShare",{id:(0,_.text)("id").primaryKey().notNull(),curriculumId:(0,_.text)("curriculumId").notNull(),sharedByTutorId:(0,_.text)("sharedByTutorId").notNull(),recipientId:(0,_.text)("recipientId").notNull(),message:(0,_.text)("message").notNull(),isPublic:(0,x.boolean)("isPublic").notNull(),sharedAt:(0,I.timestamp)("sharedAt",{withTimezone:!0}).notNull().defaultNow()},e=>({CurriculumShare_sharedByTutorId_idx:k("CurriculumShare_sharedByTutorId_idx").on(e.sharedByTutorId),CurriculumShare_recipientId_idx:k("CurriculumShare_recipientId_idx").on(e.recipientId),CurriculumShare_curriculumId_idx:k("CurriculumShare_curriculumId_idx").on(e.curriculumId),CurriculumShare_curriculumId_recipientId_key:P("CurriculumShare_curriculumId_recipientId_key").on(e.curriculumId,e.recipientId)})),M=(0,y.pgTable)("CurriculumModule",{id:(0,_.text)("id").primaryKey().notNull(),curriculumId:(0,_.text)("curriculumId").notNull(),title:(0,_.text)("title").notNull(),description:(0,_.text)("description"),order:(0,g.integer)("order").notNull(),builderData:(0,N.jsonb)("builderData")},e=>({CurriculumModule_curriculumId_idx:k("CurriculumModule_curriculumId_idx").on(e.curriculumId),CurriculumModule_order_idx:k("CurriculumModule_order_idx").on(e.order)})),j=(0,y.pgTable)("CurriculumLesson",{id:(0,_.text)("id").primaryKey().notNull(),moduleId:(0,_.text)("moduleId").notNull(),title:(0,_.text)("title").notNull(),description:(0,_.text)("description"),duration:(0,g.integer)("duration").notNull(),difficulty:(0,_.text)("difficulty").notNull(),order:(0,g.integer)("order").notNull(),learningObjectives:(0,_.text)("learningObjectives").array().notNull(),teachingPoints:(0,_.text)("teachingPoints").array().notNull(),keyConcepts:(0,_.text)("keyConcepts").array().notNull(),examples:(0,N.jsonb)("examples"),practiceProblems:(0,N.jsonb)("practiceProblems"),commonMisconceptions:(0,_.text)("commonMisconceptions").array().notNull(),prerequisiteLessonIds:(0,_.text)("prerequisiteLessonIds").array().notNull(),builderData:(0,N.jsonb)("builderData")},e=>({CurriculumLesson_moduleId_idx:k("CurriculumLesson_moduleId_idx").on(e.moduleId),CurriculumLesson_order_idx:k("CurriculumLesson_order_idx").on(e.order)})),B=(0,y.pgTable)("LessonSession",{id:(0,_.text)("id").primaryKey().notNull(),studentId:(0,_.text)("studentId").notNull(),lessonId:(0,_.text)("lessonId").notNull(),status:(0,_.text)("status").notNull(),currentSection:(0,_.text)("currentSection").notNull(),conceptMastery:(0,N.jsonb)("conceptMastery").notNull(),misconceptions:(0,_.text)("misconceptions").array().notNull(),sessionContext:(0,N.jsonb)("sessionContext"),whiteboardItems:(0,_.text)("whiteboardItems").array().notNull(),startedAt:(0,I.timestamp)("startedAt",{withTimezone:!0}).notNull().defaultNow(),lastActivityAt:(0,I.timestamp)("lastActivityAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date),completedAt:(0,I.timestamp)("completedAt",{withTimezone:!0})},e=>({LessonSession_studentId_idx:k("LessonSession_studentId_idx").on(e.studentId),LessonSession_lessonId_idx:k("LessonSession_lessonId_idx").on(e.lessonId),LessonSession_studentId_lessonId_key:P("LessonSession_studentId_lessonId_key").on(e.studentId,e.lessonId)})),$=(0,y.pgTable)("CurriculumLessonProgress",{id:(0,_.text)("id").primaryKey().notNull(),lessonId:(0,_.text)("lessonId").notNull(),studentId:(0,_.text)("studentId").notNull(),status:(0,_.text)("status").notNull(),currentSection:(0,_.text)("currentSection").notNull(),score:(0,g.integer)("score"),completedAt:(0,I.timestamp)("completedAt",{withTimezone:!0}),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({CurriculumLessonProgress_studentId_idx:k("CurriculumLessonProgress_studentId_idx").on(e.studentId),CurriculumLessonProgress_lessonId_studentId_key:P("CurriculumLessonProgress_lessonId_studentId_key").on(e.lessonId,e.studentId)})),Q=(0,y.pgTable)("CurriculumEnrollment",{id:(0,_.text)("id").primaryKey().notNull(),studentId:(0,_.text)("studentId").notNull(),curriculumId:(0,_.text)("curriculumId").notNull(),batchId:(0,_.text)("batchId"),enrolledAt:(0,I.timestamp)("enrolledAt",{withTimezone:!0}).notNull().defaultNow(),completedAt:(0,I.timestamp)("completedAt",{withTimezone:!0}),lastActivity:(0,I.timestamp)("lastActivity",{withTimezone:!0}).notNull().defaultNow(),lessonsCompleted:(0,g.integer)("lessonsCompleted").notNull(),enrollmentSource:(0,_.text)("enrollmentSource")},e=>({CurriculumEnrollment_studentId_idx:k("CurriculumEnrollment_studentId_idx").on(e.studentId),CurriculumEnrollment_batchId_idx:k("CurriculumEnrollment_batchId_idx").on(e.batchId),CurriculumEnrollment_studentId_curriculumId_key:P("CurriculumEnrollment_studentId_curriculumId_key").on(e.studentId,e.curriculumId)})),K=(0,y.pgTable)("CourseBatch",{id:(0,_.text)("id").primaryKey().notNull(),curriculumId:(0,_.text)("curriculumId").notNull(),name:(0,_.text)("name").notNull(),startDate:(0,I.timestamp)("startDate",{withTimezone:!0}),order:(0,g.integer)("order").notNull(),difficulty:(0,_.text)("difficulty"),schedule:(0,N.jsonb)("schedule"),price:(0,f.doublePrecision)("price"),currency:(0,_.text)("currency"),languageOfInstruction:(0,_.text)("languageOfInstruction"),isLive:(0,x.boolean)("isLive").notNull(),meetingUrl:(0,_.text)("meetingUrl"),maxStudents:(0,g.integer)("maxStudents").notNull()},e=>({CourseBatch_curriculumId_idx:k("CourseBatch_curriculumId_idx").on(e.curriculumId)})),D=(0,y.pgTable)("CurriculumProgress",{id:(0,_.text)("id").primaryKey().notNull(),studentId:(0,_.text)("studentId").notNull(),curriculumId:(0,_.text)("curriculumId").notNull(),lessonsCompleted:(0,g.integer)("lessonsCompleted").notNull(),totalLessons:(0,g.integer)("totalLessons").notNull(),currentLessonId:(0,_.text)("currentLessonId"),averageScore:(0,f.doublePrecision)("averageScore"),isCompleted:(0,x.boolean)("isCompleted").notNull(),startedAt:(0,I.timestamp)("startedAt",{withTimezone:!0}).notNull().defaultNow(),completedAt:(0,I.timestamp)("completedAt",{withTimezone:!0})},e=>({CurriculumProgress_studentId_idx:k("CurriculumProgress_studentId_idx").on(e.studentId),CurriculumProgress_studentId_curriculumId_key:P("CurriculumProgress_studentId_curriculumId_key").on(e.studentId,e.curriculumId)})),O=(0,y.pgTable)("StudentPerformance",{id:(0,_.text)("id").primaryKey().notNull(),studentId:(0,_.text)("studentId").notNull(),curriculumId:(0,_.text)("curriculumId"),averageScore:(0,f.doublePrecision)("averageScore").notNull(),completionRate:(0,f.doublePrecision)("completionRate").notNull(),engagementScore:(0,f.doublePrecision)("engagementScore").notNull(),attendanceRate:(0,f.doublePrecision)("attendanceRate").notNull(),participationRate:(0,f.doublePrecision)("participationRate").notNull(),strengths:(0,N.jsonb)("strengths").notNull(),weaknesses:(0,N.jsonb)("weaknesses").notNull(),taskHistory:(0,N.jsonb)("taskHistory").notNull(),commonMistakes:(0,N.jsonb)("commonMistakes").notNull(),skillBreakdown:(0,N.jsonb)("skillBreakdown").notNull(),cluster:(0,_.text)("cluster").notNull(),learningStyle:(0,_.text)("learningStyle"),pace:(0,_.text)("pace").notNull(),recommendedPeers:(0,N.jsonb)("recommendedPeers").notNull(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({StudentPerformance_studentId_idx:k("StudentPerformance_studentId_idx").on(e.studentId),StudentPerformance_curriculumId_idx:k("StudentPerformance_curriculumId_idx").on(e.curriculumId),StudentPerformance_cluster_idx:k("StudentPerformance_cluster_idx").on(e.cluster),StudentPerformance_studentId_curriculumId_key:P("StudentPerformance_studentId_curriculumId_key").on(e.studentId,e.curriculumId)})),W=(0,y.pgTable)("TaskSubmission",{id:(0,_.text)("id").primaryKey().notNull(),taskId:(0,_.text)("taskId").notNull(),studentId:(0,_.text)("studentId").notNull(),answers:(0,N.jsonb)("answers").notNull(),timeSpent:(0,g.integer)("timeSpent").notNull(),attempts:(0,g.integer)("attempts").notNull(),questionResults:(0,N.jsonb)("questionResults"),score:(0,f.doublePrecision)("score"),maxScore:(0,g.integer)("maxScore").notNull(),status:(0,_.text)("status").notNull(),aiFeedback:(0,N.jsonb)("aiFeedback"),tutorFeedback:(0,_.text)("tutorFeedback"),tutorApproved:(0,x.boolean)("tutorApproved").notNull(),submittedAt:(0,I.timestamp)("submittedAt",{withTimezone:!0}).notNull().defaultNow(),gradedAt:(0,I.timestamp)("gradedAt",{withTimezone:!0})},e=>({TaskSubmission_studentId_idx:k("TaskSubmission_studentId_idx").on(e.studentId),TaskSubmission_taskId_idx:k("TaskSubmission_taskId_idx").on(e.taskId),TaskSubmission_taskId_studentId_key:P("TaskSubmission_taskId_studentId_key").on(e.taskId,e.studentId)})),U=(0,y.pgTable)("FeedbackWorkflow",{id:(0,_.text)("id").primaryKey().notNull(),submissionId:(0,_.text)("submissionId").notNull().unique(),studentId:(0,_.text)("studentId").notNull(),aiScore:(0,f.doublePrecision)("aiScore"),aiComments:(0,_.text)("aiComments"),aiStrengths:(0,N.jsonb)("aiStrengths").notNull(),aiImprovements:(0,N.jsonb)("aiImprovements").notNull(),aiResources:(0,N.jsonb)("aiResources").notNull(),status:(0,_.text)("status").notNull(),modifiedScore:(0,f.doublePrecision)("modifiedScore"),modifiedComments:(0,_.text)("modifiedComments"),addedNotes:(0,_.text)("addedNotes"),approvedAt:(0,I.timestamp)("approvedAt",{withTimezone:!0}),approvedBy:(0,_.text)("approvedBy"),autoApproved:(0,x.boolean)("autoApproved").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({FeedbackWorkflow_studentId_idx:k("FeedbackWorkflow_studentId_idx").on(e.studentId),FeedbackWorkflow_status_idx:k("FeedbackWorkflow_status_idx").on(e.status)})),F=(0,y.pgTable)("GeneratedTask",{id:(0,_.text)("id").primaryKey().notNull(),tutorId:(0,_.text)("tutorId").notNull(),roomId:(0,_.text)("roomId"),title:(0,_.text)("title").notNull(),description:(0,_.text)("description").notNull(),type:(0,_.text)("type").notNull(),difficulty:(0,_.text)("difficulty").notNull(),questions:(0,N.jsonb)("questions").notNull(),distributionMode:(0,_.text)("distributionMode").notNull(),assignments:(0,N.jsonb)("assignments").notNull(),documentSource:(0,_.text)("documentSource"),status:(0,_.text)("status").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),assignedAt:(0,I.timestamp)("assignedAt",{withTimezone:!0}),lessonId:(0,_.text)("lessonId"),batchId:(0,_.text)("batchId"),dueDate:(0,I.timestamp)("dueDate",{withTimezone:!0}),maxScore:(0,g.integer)("maxScore").notNull(),timeLimitMinutes:(0,g.integer)("timeLimitMinutes"),enforceTimeLimit:(0,x.boolean)("enforceTimeLimit").notNull(),enforceDueDate:(0,x.boolean)("enforceDueDate").notNull(),maxAttempts:(0,g.integer)("maxAttempts").notNull()},e=>({GeneratedTask_tutorId_idx:k("GeneratedTask_tutorId_idx").on(e.tutorId),GeneratedTask_roomId_idx:k("GeneratedTask_roomId_idx").on(e.roomId),GeneratedTask_status_idx:k("GeneratedTask_status_idx").on(e.status),GeneratedTask_lessonId_idx:k("GeneratedTask_lessonId_idx").on(e.lessonId),GeneratedTask_batchId_idx:k("GeneratedTask_batchId_idx").on(e.batchId)})),G=(0,y.pgTable)("BreakoutSession",{id:(0,_.text)("id").primaryKey().notNull(),mainRoomId:(0,_.text)("mainRoomId").notNull(),tutorId:(0,_.text)("tutorId").notNull(),roomCount:(0,g.integer)("roomCount").notNull(),participantsPerRoom:(0,g.integer)("participantsPerRoom").notNull(),distributionMode:(0,_.text)("distributionMode").notNull(),timeLimit:(0,g.integer)("timeLimit").notNull(),aiAssistantEnabled:(0,x.boolean)("aiAssistantEnabled").notNull(),status:(0,_.text)("status").notNull(),startedAt:(0,I.timestamp)("startedAt",{withTimezone:!0}),endedAt:(0,I.timestamp)("endedAt",{withTimezone:!0}),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({BreakoutSession_mainRoomId_idx:k("BreakoutSession_mainRoomId_idx").on(e.mainRoomId),BreakoutSession_tutorId_idx:k("BreakoutSession_tutorId_idx").on(e.tutorId),BreakoutSession_status_idx:k("BreakoutSession_status_idx").on(e.status)})),V=(0,y.pgTable)("BreakoutRoom",{id:(0,_.text)("id").primaryKey().notNull(),sessionId:(0,_.text)("sessionId").notNull(),name:(0,_.text)("name").notNull(),aiEnabled:(0,x.boolean)("aiEnabled").notNull(),aiMode:(0,_.text)("aiMode").notNull(),assignedTaskId:(0,_.text)("assignedTaskId"),status:(0,_.text)("status").notNull(),endsAt:(0,I.timestamp)("endsAt",{withTimezone:!0}),aiNotes:(0,N.jsonb)("aiNotes").notNull(),alerts:(0,N.jsonb)("alerts").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({BreakoutRoom_sessionId_idx:k("BreakoutRoom_sessionId_idx").on(e.sessionId),BreakoutRoom_status_idx:k("BreakoutRoom_status_idx").on(e.status)})),J=(0,y.pgTable)("BreakoutRoomAssignment",{id:(0,_.text)("id").primaryKey().notNull(),roomId:(0,_.text)("roomId").notNull(),studentId:(0,_.text)("studentId").notNull(),joinedAt:(0,I.timestamp)("joinedAt",{withTimezone:!0}).notNull().defaultNow(),leftAt:(0,I.timestamp)("leftAt",{withTimezone:!0})},e=>({BreakoutRoomAssignment_studentId_idx:k("BreakoutRoomAssignment_studentId_idx").on(e.studentId),BreakoutRoomAssignment_roomId_studentId_key:P("BreakoutRoomAssignment_roomId_studentId_key").on(e.roomId,e.studentId)})),H=(0,y.pgTable)("AITutorEnrollment",{id:(0,_.text)("id").primaryKey().notNull(),studentId:(0,_.text)("studentId").notNull(),subjectCode:(0,_.text)("subjectCode").notNull(),enrolledAt:(0,I.timestamp)("enrolledAt",{withTimezone:!0}).notNull().defaultNow(),lastSessionAt:(0,I.timestamp)("lastSessionAt",{withTimezone:!0}),totalSessions:(0,g.integer)("totalSessions").notNull(),totalMinutes:(0,g.integer)("totalMinutes").notNull(),status:(0,_.text)("status").notNull()},e=>({AITutorEnrollment_studentId_idx:k("AITutorEnrollment_studentId_idx").on(e.studentId),AITutorEnrollment_studentId_subjectCode_key:P("AITutorEnrollment_studentId_subjectCode_key").on(e.studentId,e.subjectCode)})),Y=(0,y.pgTable)("AIInteractionSession",{id:(0,_.text)("id").primaryKey().notNull(),studentId:(0,_.text)("studentId").notNull(),subjectCode:(0,_.text)("subjectCode").notNull(),startedAt:(0,I.timestamp)("startedAt",{withTimezone:!0}).notNull().defaultNow(),endedAt:(0,I.timestamp)("endedAt",{withTimezone:!0}),messageCount:(0,g.integer)("messageCount").notNull(),topicsCovered:(0,_.text)("topicsCovered").array().notNull(),summary:(0,_.text)("summary")},e=>({AIInteractionSession_studentId_idx:k("AIInteractionSession_studentId_idx").on(e.studentId),AIInteractionSession_startedAt_idx:k("AIInteractionSession_startedAt_idx").on(e.startedAt)})),Z=(0,y.pgTable)("AITutorDailyUsage",{id:(0,_.text)("id").primaryKey().notNull(),userId:(0,_.text)("userId").notNull(),date:(0,I.timestamp)("date",{withTimezone:!0}).notNull().defaultNow(),sessionCount:(0,g.integer)("sessionCount").notNull(),messageCount:(0,g.integer)("messageCount").notNull(),minutesUsed:(0,g.integer)("minutesUsed").notNull()},e=>({AITutorDailyUsage_userId_idx:k("AITutorDailyUsage_userId_idx").on(e.userId),AITutorDailyUsage_userId_date_key:P("AITutorDailyUsage_userId_date_key").on(e.userId,e.date)})),X=(0,y.pgTable)("AITutorSubscription",{id:(0,_.text)("id").primaryKey().notNull(),userId:(0,_.text)("userId").notNull().unique(),tier:r("tier").notNull(),dailySessions:(0,g.integer)("dailySessions").notNull(),dailyMessages:(0,g.integer)("dailyMessages").notNull(),startedAt:(0,I.timestamp)("startedAt",{withTimezone:!0}).notNull().defaultNow(),expiresAt:(0,I.timestamp)("expiresAt",{withTimezone:!0}),isActive:(0,x.boolean)("isActive").notNull()}),ee=(0,y.pgTable)("ContentItem",{id:(0,_.text)("id").primaryKey().notNull(),title:(0,_.text)("title").notNull(),description:(0,_.text)("description"),subject:(0,_.text)("subject").notNull(),type:(0,_.text)("type").notNull(),url:(0,_.text)("url"),thumbnailUrl:(0,_.text)("thumbnailUrl"),duration:(0,g.integer)("duration"),difficulty:(0,_.text)("difficulty").notNull(),isPublished:(0,x.boolean)("isPublished").notNull(),transcript:(0,_.text)("transcript"),videoVariants:(0,N.jsonb)("videoVariants"),uploadStatus:(0,_.text)("uploadStatus"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({ContentItem_subject_idx:k("ContentItem_subject_idx").on(e.subject),ContentItem_isPublished_idx:k("ContentItem_isPublished_idx").on(e.isPublished)})),et=(0,y.pgTable)("VideoWatchEvent",{id:(0,_.text)("id").primaryKey().notNull(),contentId:(0,_.text)("contentId").notNull(),studentId:(0,_.text)("studentId").notNull(),eventType:(0,_.text)("eventType").notNull(),videoSeconds:(0,f.doublePrecision)("videoSeconds").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),metadata:(0,N.jsonb)("metadata")},e=>({VideoWatchEvent_contentId_idx:k("VideoWatchEvent_contentId_idx").on(e.contentId),VideoWatchEvent_studentId_idx:k("VideoWatchEvent_studentId_idx").on(e.studentId),VideoWatchEvent_contentId_studentId_idx:k("VideoWatchEvent_contentId_studentId_idx").on(e.contentId,e.studentId)})),ei=(0,y.pgTable)("ContentQuizCheckpoint",{id:(0,_.text)("id").primaryKey().notNull(),contentId:(0,_.text)("contentId").notNull(),videoTimestampSec:(0,g.integer)("videoTimestampSec").notNull(),title:(0,_.text)("title"),questions:(0,N.jsonb)("questions").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({ContentQuizCheckpoint_contentId_idx:k("ContentQuizCheckpoint_contentId_idx").on(e.contentId),ContentQuizCheckpoint_contentId_videoTimestampSec_key:P("ContentQuizCheckpoint_contentId_videoTimestampSec_key").on(e.contentId,e.videoTimestampSec)})),en=(0,y.pgTable)("ContentProgress",{id:(0,_.text)("id").primaryKey().notNull(),contentId:(0,_.text)("contentId").notNull(),studentId:(0,_.text)("studentId").notNull(),progress:(0,g.integer)("progress").notNull(),completed:(0,x.boolean)("completed").notNull(),lastPosition:(0,g.integer)("lastPosition"),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({ContentProgress_studentId_idx:k("ContentProgress_studentId_idx").on(e.studentId),ContentProgress_contentId_studentId_key:P("ContentProgress_contentId_studentId_key").on(e.contentId,e.studentId)})),es=(0,y.pgTable)("ReviewSchedule",{id:(0,_.text)("id").primaryKey().notNull(),studentId:(0,_.text)("studentId").notNull(),contentId:(0,_.text)("contentId").notNull(),lastReviewed:(0,I.timestamp)("lastReviewed",{withTimezone:!0}).notNull().defaultNow(),nextReview:(0,I.timestamp)("nextReview",{withTimezone:!0}).notNull(),interval:(0,g.integer)("interval").notNull(),easeFactor:(0,f.doublePrecision)("easeFactor").notNull(),stability:(0,f.doublePrecision)("stability").notNull(),repetitionCount:(0,g.integer)("repetitionCount").notNull(),performance:(0,f.doublePrecision)("performance").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({ReviewSchedule_studentId_idx:k("ReviewSchedule_studentId_idx").on(e.studentId),ReviewSchedule_nextReview_idx:k("ReviewSchedule_nextReview_idx").on(e.nextReview),ReviewSchedule_studentId_contentId_key:P("ReviewSchedule_studentId_contentId_key").on(e.studentId,e.contentId)})),eo=(0,y.pgTable)("QuizAttempt",{id:(0,_.text)("id").primaryKey().notNull(),studentId:(0,_.text)("studentId").notNull(),quizId:(0,_.text)("quizId").notNull(),assignmentId:(0,_.text)("assignmentId"),answers:(0,N.jsonb)("answers").notNull(),score:(0,g.integer)("score").notNull(),maxScore:(0,g.integer)("maxScore").notNull(),completedAt:(0,I.timestamp)("completedAt",{withTimezone:!0}).notNull().defaultNow(),timeSpent:(0,g.integer)("timeSpent").notNull(),questionResults:(0,N.jsonb)("questionResults"),feedback:(0,_.text)("feedback"),status:(0,_.text)("status").notNull(),attemptNumber:(0,g.integer)("attemptNumber").notNull(),startedAt:(0,I.timestamp)("startedAt",{withTimezone:!0}).notNull().defaultNow()},e=>({QuizAttempt_studentId_idx:k("QuizAttempt_studentId_idx").on(e.studentId),QuizAttempt_quizId_idx:k("QuizAttempt_quizId_idx").on(e.quizId),QuizAttempt_assignmentId_idx:k("QuizAttempt_assignmentId_idx").on(e.assignmentId),QuizAttempt_studentId_quizId_idx:k("QuizAttempt_studentId_quizId_idx").on(e.studentId,e.quizId)})),ea=(0,y.pgTable)("QuestionBankItem",{id:(0,_.text)("id").primaryKey().notNull(),tutorId:(0,_.text)("tutorId").notNull(),type:(0,_.text)("type").notNull(),question:(0,_.text)("question").notNull(),options:(0,N.jsonb)("options"),correctAnswer:(0,N.jsonb)("correctAnswer"),explanation:(0,_.text)("explanation"),hint:(0,_.text)("hint"),points:(0,g.integer)("points").notNull(),difficulty:(0,_.text)("difficulty").notNull(),tags:(0,_.text)("tags").array().notNull(),subject:(0,_.text)("subject"),curriculumId:(0,_.text)("curriculumId"),lessonId:(0,_.text)("lessonId"),isPublic:(0,x.boolean)("isPublic").notNull(),usageCount:(0,g.integer)("usageCount").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({QuestionBankItem_tutorId_idx:k("QuestionBankItem_tutorId_idx").on(e.tutorId),QuestionBankItem_type_idx:k("QuestionBankItem_type_idx").on(e.type),QuestionBankItem_difficulty_idx:k("QuestionBankItem_difficulty_idx").on(e.difficulty),QuestionBankItem_subject_idx:k("QuestionBankItem_subject_idx").on(e.subject),QuestionBankItem_tags_idx:k("QuestionBankItem_tags_idx").on(e.tags)})),er=(0,y.pgTable)("Quiz",{id:(0,_.text)("id").primaryKey().notNull(),tutorId:(0,_.text)("tutorId").notNull(),title:(0,_.text)("title").notNull(),description:(0,_.text)("description"),type:(0,_.text)("type").notNull(),status:(0,_.text)("status").notNull(),timeLimit:(0,g.integer)("timeLimit"),allowedAttempts:(0,g.integer)("allowedAttempts").notNull(),shuffleQuestions:(0,x.boolean)("shuffleQuestions").notNull(),shuffleOptions:(0,x.boolean)("shuffleOptions").notNull(),showCorrectAnswers:(0,_.text)("showCorrectAnswers").notNull(),passingScore:(0,g.integer)("passingScore"),questions:(0,N.jsonb)("questions").notNull(),totalPoints:(0,g.integer)("totalPoints").notNull(),tags:(0,_.text)("tags").array().notNull(),startDate:(0,I.timestamp)("startDate",{withTimezone:!0}),dueDate:(0,I.timestamp)("dueDate",{withTimezone:!0}),curriculumId:(0,_.text)("curriculumId"),lessonId:(0,_.text)("lessonId"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({Quiz_tutorId_idx:k("Quiz_tutorId_idx").on(e.tutorId),Quiz_status_idx:k("Quiz_status_idx").on(e.status),Quiz_type_idx:k("Quiz_type_idx").on(e.type),Quiz_curriculumId_idx:k("Quiz_curriculumId_idx").on(e.curriculumId),Quiz_lessonId_idx:k("Quiz_lessonId_idx").on(e.lessonId)})),el=(0,y.pgTable)("QuizAssignment",{id:(0,_.text)("id").primaryKey().notNull(),quizId:(0,_.text)("quizId").notNull(),assignedByTutorId:(0,_.text)("assignedByTutorId").notNull(),assignedToType:(0,_.text)("assignedToType").notNull(),assignedToId:(0,_.text)("assignedToId"),assignedToAll:(0,x.boolean)("assignedToAll").notNull(),assignedAt:(0,I.timestamp)("assignedAt",{withTimezone:!0}).notNull().defaultNow(),dueDate:(0,I.timestamp)("dueDate",{withTimezone:!0}),isActive:(0,x.boolean)("isActive").notNull()},e=>({QuizAssignment_quizId_idx:k("QuizAssignment_quizId_idx").on(e.quizId),QuizAssignment_assignedByTutorId_idx:k("QuizAssignment_assignedByTutorId_idx").on(e.assignedByTutorId),QuizAssignment_assignedToId_idx:k("QuizAssignment_assignedToId_idx").on(e.assignedToId),QuizAssignment_isActive_idx:k("QuizAssignment_isActive_idx").on(e.isActive)})),ed=(0,y.pgTable)("Note",{id:(0,_.text)("id").primaryKey().notNull(),contentId:(0,_.text)("contentId").notNull(),studentId:(0,_.text)("studentId").notNull(),content:(0,_.text)("content").notNull(),timestamp:(0,g.integer)("timestamp").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({Note_contentId_idx:k("Note_contentId_idx").on(e.contentId),Note_studentId_idx:k("Note_studentId_idx").on(e.studentId)})),eu=(0,y.pgTable)("Bookmark",{id:(0,_.text)("id").primaryKey().notNull(),contentId:(0,_.text)("contentId").notNull(),studentId:(0,_.text)("studentId").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({Bookmark_studentId_idx:k("Bookmark_studentId_idx").on(e.studentId),Bookmark_contentId_studentId_key:P("Bookmark_contentId_studentId_key").on(e.contentId,e.studentId)})),ec=(0,y.pgTable)("UserGamification",{id:(0,_.text)("id").primaryKey().notNull(),userId:(0,_.text)("userId").notNull().unique(),level:(0,g.integer)("level").notNull(),xp:(0,g.integer)("xp").notNull(),streakDays:(0,g.integer)("streakDays").notNull(),longestStreak:(0,g.integer)("longestStreak").notNull(),lastLogin:(0,I.timestamp)("lastLogin",{withTimezone:!0}).notNull().defaultNow(),lastActiveDate:(0,I.timestamp)("lastActiveDate",{withTimezone:!0}),totalStudyMinutes:(0,g.integer)("totalStudyMinutes").notNull(),grammarScore:(0,g.integer)("grammarScore").notNull(),vocabularyScore:(0,g.integer)("vocabularyScore").notNull(),speakingScore:(0,g.integer)("speakingScore").notNull(),listeningScore:(0,g.integer)("listeningScore").notNull(),confidenceScore:(0,g.integer)("confidenceScore").notNull(),fluencyScore:(0,g.integer)("fluencyScore").notNull(),unlockedWorlds:(0,_.text)("unlockedWorlds").array().notNull()}),em=(0,y.pgTable)("Achievement",{id:(0,_.text)("id").primaryKey().notNull(),userId:(0,_.text)("userId").notNull(),type:(0,_.text)("type").notNull(),title:(0,_.text)("title").notNull(),description:(0,_.text)("description").notNull(),unlockedAt:(0,I.timestamp)("unlockedAt",{withTimezone:!0}).notNull().defaultNow(),xpAwarded:(0,g.integer)("xpAwarded").notNull()},e=>({Achievement_userId_idx:k("Achievement_userId_idx").on(e.userId)})),ep=(0,y.pgTable)("Mission",{id:(0,_.text)("id").primaryKey().notNull(),title:(0,_.text)("title").notNull(),description:(0,_.text)("description").notNull(),type:(0,_.text)("type").notNull(),xpReward:(0,g.integer)("xpReward").notNull(),requirement:(0,N.jsonb)("requirement").notNull(),isActive:(0,x.boolean)("isActive").notNull()}),eh=(0,y.pgTable)("MissionProgress",{id:(0,_.text)("id").primaryKey().notNull(),missionId:(0,_.text)("missionId").notNull(),studentId:(0,_.text)("studentId").notNull(),progress:(0,g.integer)("progress").notNull(),completed:(0,x.boolean)("completed").notNull(),completedAt:(0,I.timestamp)("completedAt",{withTimezone:!0})},e=>({MissionProgress_studentId_idx:k("MissionProgress_studentId_idx").on(e.studentId),MissionProgress_missionId_studentId_key:P("MissionProgress_missionId_studentId_key").on(e.missionId,e.studentId)})),ey=(0,y.pgTable)("UserDailyQuest",{id:(0,_.text)("id").primaryKey().notNull(),userId:(0,_.text)("userId").notNull(),missionId:(0,_.text)("missionId").notNull(),date:(0,I.timestamp)("date",{withTimezone:!0}).notNull().defaultNow(),completed:(0,x.boolean)("completed").notNull()},e=>({UserDailyQuest_userId_idx:k("UserDailyQuest_userId_idx").on(e.userId),UserDailyQuest_userId_missionId_date_key:P("UserDailyQuest_userId_missionId_date_key").on(e.userId,e.missionId,e.date)})),e_=(0,y.pgTable)("Badge",{id:(0,_.text)("id").primaryKey().notNull(),key:(0,_.text)("key").notNull().unique(),name:(0,_.text)("name").notNull(),description:(0,_.text)("description").notNull(),icon:(0,_.text)("icon").notNull(),color:(0,_.text)("color").notNull(),category:(0,_.text)("category").notNull(),rarity:(0,_.text)("rarity").notNull(),xpBonus:(0,g.integer)("xpBonus").notNull(),requirement:(0,N.jsonb)("requirement").notNull(),isSecret:(0,x.boolean)("isSecret").notNull(),order:(0,g.integer)("order").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()}),eg=(0,y.pgTable)("UserBadge",{id:(0,_.text)("id").primaryKey().notNull(),userId:(0,_.text)("userId").notNull(),badgeId:(0,_.text)("badgeId").notNull(),earnedAt:(0,I.timestamp)("earnedAt",{withTimezone:!0}).notNull().defaultNow(),progress:(0,g.integer)("progress").notNull()},e=>({UserBadge_userId_idx:k("UserBadge_userId_idx").on(e.userId),UserBadge_badgeId_idx:k("UserBadge_badgeId_idx").on(e.badgeId),UserBadge_userId_badgeId_key:P("UserBadge_userId_badgeId_key").on(e.userId,e.badgeId)})),ex=(0,y.pgTable)("LeaderboardEntry",{id:(0,_.text)("id").primaryKey().notNull(),userId:(0,_.text)("userId").notNull(),type:(0,_.text)("type").notNull(),periodStart:(0,I.timestamp)("periodStart",{withTimezone:!0}),periodEnd:(0,I.timestamp)("periodEnd",{withTimezone:!0}),score:(0,g.integer)("score").notNull(),rank:(0,g.integer)("rank")},e=>({LeaderboardEntry_type_score_idx:k("LeaderboardEntry_type_score_idx").on(e.type,e.score),LeaderboardEntry_userId_idx:k("LeaderboardEntry_userId_idx").on(e.userId),LeaderboardEntry_userId_type_periodStart_key:P("LeaderboardEntry_userId_type_periodStart_key").on(e.userId,e.type,e.periodStart)})),eI=(0,y.pgTable)("LiveSession",{id:(0,_.text)("id").primaryKey().notNull(),tutorId:(0,_.text)("tutorId").notNull(),curriculumId:(0,_.text)("curriculumId"),title:(0,_.text)("title").notNull(),subject:(0,_.text)("subject").notNull(),description:(0,_.text)("description"),gradeLevel:(0,_.text)("gradeLevel"),type:o("type").notNull(),scheduledAt:(0,I.timestamp)("scheduledAt",{withTimezone:!0}),startedAt:(0,I.timestamp)("startedAt",{withTimezone:!0}),endedAt:(0,I.timestamp)("endedAt",{withTimezone:!0}),maxStudents:(0,g.integer)("maxStudents").notNull(),status:(0,_.text)("status").notNull(),roomId:(0,_.text)("roomId"),roomUrl:(0,_.text)("roomUrl"),recordingUrl:(0,_.text)("recordingUrl"),recordingAvailableAt:(0,I.timestamp)("recordingAvailableAt",{withTimezone:!0})},e=>({LiveSession_tutorId_idx:k("LiveSession_tutorId_idx").on(e.tutorId),LiveSession_curriculumId_idx:k("LiveSession_curriculumId_idx").on(e.curriculumId),LiveSession_status_idx:k("LiveSession_status_idx").on(e.status),LiveSession_scheduledAt_idx:k("LiveSession_scheduledAt_idx").on(e.scheduledAt)})),eN=(0,y.pgTable)("SessionReplayArtifact",{id:(0,_.text)("id").primaryKey().notNull(),sessionId:(0,_.text)("sessionId").notNull().unique(),tutorId:(0,_.text)("tutorId").notNull(),recordingUrl:(0,_.text)("recordingUrl"),transcript:(0,_.text)("transcript"),summary:(0,_.text)("summary"),summaryJson:(0,N.jsonb)("summaryJson"),status:(0,_.text)("status").notNull(),startedAt:(0,I.timestamp)("startedAt",{withTimezone:!0}),endedAt:(0,I.timestamp)("endedAt",{withTimezone:!0}),generatedAt:(0,I.timestamp)("generatedAt",{withTimezone:!0}),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({SessionReplayArtifact_tutorId_idx:k("SessionReplayArtifact_tutorId_idx").on(e.tutorId),SessionReplayArtifact_status_idx:k("SessionReplayArtifact_status_idx").on(e.status),SessionReplayArtifact_generatedAt_idx:k("SessionReplayArtifact_generatedAt_idx").on(e.generatedAt)})),ef=(0,y.pgTable)("SessionParticipant",{id:(0,_.text)("id").primaryKey().notNull(),sessionId:(0,_.text)("sessionId").notNull(),studentId:(0,_.text)("studentId").notNull(),joinedAt:(0,I.timestamp)("joinedAt",{withTimezone:!0}).notNull().defaultNow(),leftAt:(0,I.timestamp)("leftAt",{withTimezone:!0})},e=>({SessionParticipant_studentId_idx:k("SessionParticipant_studentId_idx").on(e.studentId),SessionParticipant_sessionId_studentId_key:P("SessionParticipant_sessionId_studentId_key").on(e.sessionId,e.studentId)})),eb=(0,y.pgTable)("Poll",{id:(0,_.text)("id").primaryKey().notNull(),sessionId:(0,_.text)("sessionId").notNull(),tutorId:(0,_.text)("tutorId").notNull(),question:(0,_.text)("question").notNull(),type:n("type").notNull(),isAnonymous:(0,x.boolean)("isAnonymous").notNull(),allowMultiple:(0,x.boolean)("allowMultiple").notNull(),timeLimit:(0,g.integer)("timeLimit"),showResults:(0,x.boolean)("showResults").notNull(),correctOptionId:(0,_.text)("correctOptionId"),status:s("status").notNull(),startedAt:(0,I.timestamp)("startedAt",{withTimezone:!0}),endedAt:(0,I.timestamp)("endedAt",{withTimezone:!0}),totalResponses:(0,g.integer)("totalResponses").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({Poll_sessionId_idx:k("Poll_sessionId_idx").on(e.sessionId),Poll_tutorId_idx:k("Poll_tutorId_idx").on(e.tutorId),Poll_status_idx:k("Poll_status_idx").on(e.status),Poll_createdAt_idx:k("Poll_createdAt_idx").on(e.createdAt)})),eA=(0,y.pgTable)("PollOption",{id:(0,_.text)("id").primaryKey().notNull(),pollId:(0,_.text)("pollId").notNull(),label:(0,_.text)("label").notNull(),text:(0,_.text)("text").notNull(),color:(0,_.text)("color"),responseCount:(0,g.integer)("responseCount").notNull(),percentage:(0,f.doublePrecision)("percentage").notNull()},e=>({PollOption_pollId_idx:k("PollOption_pollId_idx").on(e.pollId)})),eT=(0,y.pgTable)("PollResponse",{id:(0,_.text)("id").primaryKey().notNull(),pollId:(0,_.text)("pollId").notNull(),respondentHash:(0,_.text)("respondentHash"),optionIds:(0,_.text)("optionIds").array().notNull(),rating:(0,g.integer)("rating"),textAnswer:(0,_.text)("textAnswer"),studentId:(0,_.text)("studentId"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({PollResponse_pollId_idx:k("PollResponse_pollId_idx").on(e.pollId),PollResponse_studentId_idx:k("PollResponse_studentId_idx").on(e.studentId),PollResponse_pollId_respondentHash_key:P("PollResponse_pollId_respondentHash_key").on(e.pollId,e.respondentHash)})),ew=(0,y.pgTable)("Message",{id:(0,_.text)("id").primaryKey().notNull(),sessionId:(0,_.text)("sessionId").notNull(),userId:(0,_.text)("userId").notNull(),content:(0,_.text)("content").notNull(),type:(0,_.text)("type").notNull(),source:a("source").notNull(),timestamp:(0,I.timestamp)("timestamp",{withTimezone:!0}).notNull().defaultNow()},e=>({Message_sessionId_idx:k("Message_sessionId_idx").on(e.sessionId),Message_userId_idx:k("Message_userId_idx").on(e.userId)})),eS=(0,y.pgTable)("Conversation",{id:(0,_.text)("id").primaryKey().notNull(),participant1Id:(0,_.text)("participant1Id").notNull(),participant2Id:(0,_.text)("participant2Id").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({Conversation_participant1Id_idx:k("Conversation_participant1Id_idx").on(e.participant1Id),Conversation_participant2Id_idx:k("Conversation_participant2Id_idx").on(e.participant2Id),Conversation_updatedAt_idx:k("Conversation_updatedAt_idx").on(e.updatedAt),Conversation_participant1Id_participant2Id_key:P("Conversation_participant1Id_participant2Id_key").on(e.participant1Id,e.participant2Id)})),ev=(0,y.pgTable)("DirectMessage",{id:(0,_.text)("id").primaryKey().notNull(),conversationId:(0,_.text)("conversationId").notNull(),senderId:(0,_.text)("senderId").notNull(),content:(0,_.text)("content").notNull(),type:(0,_.text)("type").notNull(),attachmentUrl:(0,_.text)("attachmentUrl"),read:(0,x.boolean)("read").notNull(),readAt:(0,I.timestamp)("readAt",{withTimezone:!0}),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({DirectMessage_conversationId_idx:k("DirectMessage_conversationId_idx").on(e.conversationId),DirectMessage_senderId_idx:k("DirectMessage_senderId_idx").on(e.senderId),DirectMessage_createdAt_idx:k("DirectMessage_createdAt_idx").on(e.createdAt)})),ek=(0,y.pgTable)("Notification",{id:(0,_.text)("id").primaryKey().notNull(),userId:(0,_.text)("userId").notNull(),type:(0,_.text)("type").notNull(),title:(0,_.text)("title").notNull(),message:(0,_.text)("message").notNull(),data:(0,N.jsonb)("data"),read:(0,x.boolean)("read").notNull(),readAt:(0,I.timestamp)("readAt",{withTimezone:!0}),actionUrl:(0,_.text)("actionUrl"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({Notification_userId_idx:k("Notification_userId_idx").on(e.userId),Notification_read_idx:k("Notification_read_idx").on(e.read),Notification_createdAt_idx:k("Notification_createdAt_idx").on(e.createdAt),Notification_type_idx:k("Notification_type_idx").on(e.type),idx_notification_user_read_created:k("idx_notification_user_read_created").on(e.userId,e.read,e.createdAt),idx_notification_user_type_created:k("idx_notification_user_type_created").on(e.userId,e.type,e.createdAt)})),eP=(0,y.pgTable)("NotificationPreference",{id:(0,_.text)("id").primaryKey().notNull(),userId:(0,_.text)("userId").notNull().unique(),emailEnabled:(0,x.boolean)("emailEnabled").notNull(),pushEnabled:(0,x.boolean)("pushEnabled").notNull(),inAppEnabled:(0,x.boolean)("inAppEnabled").notNull(),channelOverrides:(0,N.jsonb)("channelOverrides").notNull(),quietHoursStart:(0,_.text)("quietHoursStart"),quietHoursEnd:(0,_.text)("quietHoursEnd"),timezone:(0,_.text)("timezone").notNull(),emailDigest:(0,_.text)("emailDigest").notNull(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)}),ez=(0,y.pgTable)("AIAssistantSession",{id:(0,_.text)("id").primaryKey().notNull(),tutorId:(0,_.text)("tutorId").notNull(),title:(0,_.text)("title").notNull(),context:(0,_.text)("context"),status:(0,_.text)("status").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({AIAssistantSession_tutorId_idx:k("AIAssistantSession_tutorId_idx").on(e.tutorId),AIAssistantSession_status_idx:k("AIAssistantSession_status_idx").on(e.status),AIAssistantSession_updatedAt_idx:k("AIAssistantSession_updatedAt_idx").on(e.updatedAt)})),eC=(0,y.pgTable)("AIAssistantMessage",{id:(0,_.text)("id").primaryKey().notNull(),sessionId:(0,_.text)("sessionId").notNull(),role:(0,_.text)("role").notNull(),content:(0,_.text)("content").notNull(),metadata:(0,N.jsonb)("metadata"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({AIAssistantMessage_sessionId_idx:k("AIAssistantMessage_sessionId_idx").on(e.sessionId),AIAssistantMessage_createdAt_idx:k("AIAssistantMessage_createdAt_idx").on(e.createdAt)})),eq=(0,y.pgTable)("AIAssistantInsight",{id:(0,_.text)("id").primaryKey().notNull(),sessionId:(0,_.text)("sessionId").notNull(),type:(0,_.text)("type").notNull(),title:(0,_.text)("title").notNull(),content:(0,_.text)("content").notNull(),relatedData:(0,N.jsonb)("relatedData"),applied:(0,x.boolean)("applied").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({AIAssistantInsight_sessionId_idx:k("AIAssistantInsight_sessionId_idx").on(e.sessionId),AIAssistantInsight_type_idx:k("AIAssistantInsight_type_idx").on(e.type),AIAssistantInsight_createdAt_idx:k("AIAssistantInsight_createdAt_idx").on(e.createdAt)})),eR=(0,y.pgTable)("Clinic",{id:(0,_.text)("id").primaryKey().notNull(),title:(0,_.text)("title").notNull(),subject:(0,_.text)("subject").notNull(),description:(0,_.text)("description"),tutorId:(0,_.text)("tutorId").notNull(),startTime:(0,I.timestamp)("startTime",{withTimezone:!0}).notNull(),duration:(0,g.integer)("duration").notNull(),maxStudents:(0,g.integer)("maxStudents").notNull(),status:(0,_.text)("status").notNull(),roomUrl:(0,_.text)("roomUrl"),roomId:(0,_.text)("roomId"),requiresPayment:(0,x.boolean)("requiresPayment").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({Clinic_startTime_idx:k("Clinic_startTime_idx").on(e.startTime),Clinic_status_idx:k("Clinic_status_idx").on(e.status)})),eE=(0,y.pgTable)("ClinicBooking",{id:(0,_.text)("id").primaryKey().notNull(),clinicId:(0,_.text)("clinicId").notNull(),studentId:(0,_.text)("studentId").notNull(),bookedAt:(0,I.timestamp)("bookedAt",{withTimezone:!0}).notNull().defaultNow(),attended:(0,x.boolean)("attended").notNull(),requiresPayment:(0,x.boolean)("requiresPayment").notNull()},e=>({ClinicBooking_studentId_idx:k("ClinicBooking_studentId_idx").on(e.studentId),ClinicBooking_clinicId_studentId_key:P("ClinicBooking_clinicId_studentId_key").on(e.clinicId,e.studentId)})),eL=(0,y.pgTable)("Payment",{id:(0,_.text)("id").primaryKey().notNull(),bookingId:(0,_.text)("bookingId").unique(),amount:(0,f.doublePrecision)("amount").notNull(),currency:(0,_.text)("currency").notNull(),status:l("status").notNull(),gateway:d("gateway").notNull(),gatewayPaymentId:(0,_.text)("gatewayPaymentId"),gatewayCheckoutUrl:(0,_.text)("gatewayCheckoutUrl"),paidAt:(0,I.timestamp)("paidAt",{withTimezone:!0}),refundedAt:(0,I.timestamp)("refundedAt",{withTimezone:!0}),metadata:(0,N.jsonb)("metadata"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date),enrollmentId:(0,_.text)("enrollmentId"),tutorId:(0,_.text)("tutorId")},e=>({Payment_status_idx:k("Payment_status_idx").on(e.status),Payment_gateway_idx:k("Payment_gateway_idx").on(e.gateway),Payment_gatewayPaymentId_idx:k("Payment_gatewayPaymentId_idx").on(e.gatewayPaymentId),Payment_tutorId_idx:k("Payment_tutorId_idx").on(e.tutorId),idx_payment_tutor_status_created:k("idx_payment_tutor_status_created").on(e.tutorId,e.status,e.createdAt),idx_payment_enrollment_status:k("idx_payment_enrollment_status").on(e.enrollmentId,e.status)})),eM=(0,y.pgTable)("Refund",{id:(0,_.text)("id").primaryKey().notNull(),paymentId:(0,_.text)("paymentId").notNull(),amount:(0,f.doublePrecision)("amount").notNull(),reason:(0,_.text)("reason"),status:u("status").notNull(),gatewayRefundId:(0,_.text)("gatewayRefundId"),processedAt:(0,I.timestamp)("processedAt",{withTimezone:!0}),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({Refund_paymentId_idx:k("Refund_paymentId_idx").on(e.paymentId)})),ej=(0,y.pgTable)("WebhookEvent",{id:(0,_.text)("id").primaryKey().notNull(),paymentId:(0,_.text)("paymentId"),gateway:d("gateway").notNull(),eventType:(0,_.text)("eventType").notNull(),payload:(0,N.jsonb)("payload").notNull(),processed:(0,x.boolean)("processed").notNull(),processedAt:(0,I.timestamp)("processedAt",{withTimezone:!0}),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({WebhookEvent_gateway_eventType_idx:k("WebhookEvent_gateway_eventType_idx").on(e.gateway,e.eventType),WebhookEvent_processed_idx:k("WebhookEvent_processed_idx").on(e.processed)})),eB=(0,y.pgTable)("Payout",{id:(0,_.text)("id").primaryKey().notNull(),tutorId:(0,_.text)("tutorId").notNull(),amount:(0,f.doublePrecision)("amount").notNull(),currency:(0,_.text)("currency").notNull(),status:(0,_.text)("status").notNull(),method:(0,_.text)("method").notNull(),details:(0,N.jsonb)("details"),notes:(0,_.text)("notes"),requestedAt:(0,I.timestamp)("requestedAt",{withTimezone:!0}).notNull().defaultNow(),processedAt:(0,I.timestamp)("processedAt",{withTimezone:!0}),completedAt:(0,I.timestamp)("completedAt",{withTimezone:!0}),transactionReference:(0,_.text)("transactionReference")},e=>({Payout_tutorId_idx:k("Payout_tutorId_idx").on(e.tutorId),Payout_status_idx:k("Payout_status_idx").on(e.status),Payout_requestedAt_idx:k("Payout_requestedAt_idx").on(e.requestedAt)})),e$=(0,y.pgTable)("PaymentOnPayout",{id:(0,_.text)("id").primaryKey().notNull(),paymentId:(0,_.text)("paymentId").notNull(),payoutId:(0,_.text)("payoutId").notNull(),amount:(0,f.doublePrecision)("amount").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({PaymentOnPayout_payoutId_idx:k("PaymentOnPayout_payoutId_idx").on(e.payoutId),PaymentOnPayout_paymentId_idx:k("PaymentOnPayout_paymentId_idx").on(e.paymentId),PaymentOnPayout_paymentId_payoutId_key:P("PaymentOnPayout_paymentId_payoutId_key").on(e.paymentId,e.payoutId)})),eQ=(0,y.pgTable)("PlatformRevenue",{id:(0,_.text)("id").primaryKey().notNull(),paymentId:(0,_.text)("paymentId").notNull(),amount:(0,f.doublePrecision)("amount").notNull(),month:(0,_.text)("month").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({PlatformRevenue_paymentId_idx:k("PlatformRevenue_paymentId_idx").on(e.paymentId),PlatformRevenue_month_idx:k("PlatformRevenue_month_idx").on(e.month),PlatformRevenue_createdAt_idx:k("PlatformRevenue_createdAt_idx").on(e.createdAt)})),eK=(0,y.pgTable)("StudyGroup",{id:(0,_.text)("id").primaryKey().notNull(),name:(0,_.text)("name").notNull(),subject:(0,_.text)("subject").notNull(),description:(0,_.text)("description"),maxMembers:(0,g.integer)("maxMembers").notNull(),createdBy:(0,_.text)("createdBy").notNull(),isActive:(0,x.boolean)("isActive").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({StudyGroup_subject_idx:k("StudyGroup_subject_idx").on(e.subject),StudyGroup_isActive_idx:k("StudyGroup_isActive_idx").on(e.isActive)})),eD=(0,y.pgTable)("StudyGroupMember",{id:(0,_.text)("id").primaryKey().notNull(),groupId:(0,_.text)("groupId").notNull(),studentId:(0,_.text)("studentId").notNull(),joinedAt:(0,I.timestamp)("joinedAt",{withTimezone:!0}).notNull().defaultNow(),role:(0,_.text)("role").notNull()},e=>({StudyGroupMember_studentId_idx:k("StudyGroupMember_studentId_idx").on(e.studentId),StudyGroupMember_groupId_studentId_key:P("StudyGroupMember_groupId_studentId_key").on(e.groupId,e.studentId)})),eO=(0,y.pgTable)("UserActivityLog",{id:(0,_.text)("id").primaryKey().notNull(),userId:(0,_.text)("userId").notNull(),action:(0,_.text)("action").notNull(),metadata:(0,N.jsonb)("metadata"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({UserActivityLog_userId_idx:k("UserActivityLog_userId_idx").on(e.userId),UserActivityLog_createdAt_idx:k("UserActivityLog_createdAt_idx").on(e.createdAt),idx_user_activity_user_created:k("idx_user_activity_user_created").on(e.userId,e.createdAt)})),eW=(0,y.pgTable)("ApiKey",{id:(0,_.text)("id").primaryKey().notNull(),name:(0,_.text)("name").notNull(),keyHash:(0,_.text)("keyHash").notNull(),createdById:(0,_.text)("createdById"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),lastUsedAt:(0,I.timestamp)("lastUsedAt",{withTimezone:!0})},e=>({ApiKey_keyHash_idx:k("ApiKey_keyHash_idx").on(e.keyHash)})),eU=(0,y.pgTable)("SecurityEvent",{id:(0,_.text)("id").primaryKey().notNull(),eventType:(0,_.text)("eventType").notNull(),ip:(0,_.text)("ip"),metadata:(0,N.jsonb)("metadata"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),action:(0,_.text)("action"),userId:(0,_.text)("userId"),actorId:(0,_.text)("actorId"),targetType:(0,_.text)("targetType"),targetId:(0,_.text)("targetId"),severity:(0,_.text)("severity"),description:(0,_.text)("description"),originIp:(0,_.text)("originIp"),userAgent:(0,_.text)("userAgent"),countryCode:(0,_.text)("countryCode"),region:(0,_.text)("region"),city:(0,_.text)("city"),deviceId:(0,_.text)("deviceId"),sessionId:(0,_.text)("sessionId"),correlationId:(0,_.text)("correlationId"),occurredAt:(0,I.timestamp)("occurredAt",{withTimezone:!0})},e=>({SecurityEvent_eventType_idx:k("SecurityEvent_eventType_idx").on(e.eventType),SecurityEvent_action_idx:k("SecurityEvent_action_idx").on(e.action),SecurityEvent_severity_idx:k("SecurityEvent_severity_idx").on(e.severity),SecurityEvent_createdAt_idx:k("SecurityEvent_createdAt_idx").on(e.createdAt),SecurityEvent_occurredAt_idx:k("SecurityEvent_occurredAt_idx").on(e.occurredAt),SecurityEvent_ip_idx:k("SecurityEvent_ip_idx").on(e.ip),SecurityEvent_userId_idx:k("SecurityEvent_userId_idx").on(e.userId)})),eF=(0,y.pgTable)("PerformanceMetric",{id:(0,_.text)("id").primaryKey().notNull(),name:(0,_.text)("name").notNull(),metricValue:(0,f.doublePrecision)("metric_value").notNull(),unit:(0,_.text)("unit").notNull(),tags:(0,N.jsonb)("tags"),userId:(0,_.text)("userId"),sessionId:(0,_.text)("sessionId"),timestamp:(0,I.timestamp)("timestamp",{withTimezone:!0}).notNull().defaultNow()},e=>({PerformanceMetric_name_idx:k("PerformanceMetric_name_idx").on(e.name),PerformanceMetric_timestamp_idx:k("PerformanceMetric_timestamp_idx").on(e.timestamp),PerformanceMetric_userId_idx:k("PerformanceMetric_userId_idx").on(e.userId)})),eG=(0,y.pgTable)("PerformanceAlert",{id:(0,_.text)("id").primaryKey().notNull(),type:(0,_.text)("type").notNull(),severity:(0,_.text)("severity").notNull(),message:(0,_.text)("message").notNull(),metric:(0,_.text)("metric"),threshold:(0,f.doublePrecision)("threshold"),currentValue:(0,f.doublePrecision)("currentValue"),timestamp:(0,I.timestamp)("timestamp",{withTimezone:!0}).notNull().defaultNow(),resolved:(0,x.boolean)("resolved").notNull(),resolvedAt:(0,I.timestamp)("resolvedAt",{withTimezone:!0})},e=>({PerformanceAlert_type_idx:k("PerformanceAlert_type_idx").on(e.type),PerformanceAlert_severity_idx:k("PerformanceAlert_severity_idx").on(e.severity),PerformanceAlert_resolved_idx:k("PerformanceAlert_resolved_idx").on(e.resolved),PerformanceAlert_timestamp_idx:k("PerformanceAlert_timestamp_idx").on(e.timestamp)})),eV=(0,y.pgTable)("EngagementSnapshot",{id:(0,_.text)("id").primaryKey().notNull(),sessionId:(0,_.text)("sessionId").notNull(),studentId:(0,_.text)("studentId").notNull(),engagementScore:(0,f.doublePrecision)("engagementScore").notNull(),attentionLevel:(0,_.text)("attentionLevel").notNull(),comprehensionEstimate:(0,f.doublePrecision)("comprehensionEstimate"),participationCount:(0,g.integer)("participationCount").notNull(),chatMessages:(0,g.integer)("chatMessages").notNull(),whiteboardInteractions:(0,g.integer)("whiteboardInteractions").notNull(),struggleIndicators:(0,g.integer)("struggleIndicators").notNull(),timestamp:(0,I.timestamp)("timestamp",{withTimezone:!0}).notNull().defaultNow()},e=>({EngagementSnapshot_sessionId_idx:k("EngagementSnapshot_sessionId_idx").on(e.sessionId),EngagementSnapshot_studentId_idx:k("EngagementSnapshot_studentId_idx").on(e.studentId)})),eJ=(0,y.pgTable)("SessionEngagementSummary",{sessionId:(0,_.text)("sessionId").primaryKey().notNull(),averageEngagement:(0,f.doublePrecision)("averageEngagement"),peakEngagement:(0,f.doublePrecision)("peakEngagement"),lowEngagement:(0,f.doublePrecision)("lowEngagement"),participationRate:(0,f.doublePrecision)("participationRate"),totalChatMessages:(0,g.integer)("totalChatMessages"),totalHandRaises:(0,g.integer)("totalHandRaises"),timeOnTaskPercentage:(0,f.doublePrecision)("timeOnTaskPercentage")}),eH=(0,y.pgTable)("PostSessionReport",{id:(0,_.text)("id").primaryKey().notNull(),sessionId:(0,_.text)("sessionId").notNull(),tutorId:(0,_.text)("tutorId").notNull(),status:(0,_.text)("status").notNull(),keyConcepts:(0,N.jsonb)("keyConcepts").notNull(),mainTopics:(0,N.jsonb)("mainTopics").notNull(),studentQuestions:(0,N.jsonb)("studentQuestions").notNull(),challengingConcepts:(0,N.jsonb)("challengingConcepts").notNull(),overallAssessment:(0,_.text)("overallAssessment").notNull(),averageEngagement:(0,f.doublePrecision)("averageEngagement").notNull(),peakEngagement:(0,f.doublePrecision)("peakEngagement").notNull(),lowEngagement:(0,f.doublePrecision)("lowEngagement").notNull(),participationRate:(0,f.doublePrecision)("participationRate").notNull(),chatActivity:(0,g.integer)("chatActivity").notNull(),handRaises:(0,g.integer)("handRaises").notNull(),timeOnTask:(0,f.doublePrecision)("timeOnTask").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({PostSessionReport_sessionId_idx:k("PostSessionReport_sessionId_idx").on(e.sessionId)})),eY=(0,y.pgTable)("StudentSessionInsight",{id:(0,_.text)("id").primaryKey().notNull(),sessionId:(0,_.text)("sessionId").notNull(),studentId:(0,_.text)("studentId").notNull(),engagement:(0,f.doublePrecision)("engagement").notNull(),participation:(0,g.integer)("participation").notNull(),questionsAsked:(0,g.integer)("questionsAsked").notNull(),timeAwayMinutes:(0,g.integer)("timeAwayMinutes").notNull(),flaggedForFollowUp:(0,x.boolean)("flaggedForFollowUp").notNull(),followUpReason:(0,_.text)("followUpReason"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({StudentSessionInsight_sessionId_idx:k("StudentSessionInsight_sessionId_idx").on(e.sessionId)})),eZ=(0,y.pgTable)("SessionBookmark",{id:(0,_.text)("id").primaryKey().notNull(),sessionId:(0,_.text)("sessionId").notNull(),timestampSeconds:(0,g.integer)("timestampSeconds").notNull(),label:(0,_.text)("label"),note:(0,_.text)("note"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({SessionBookmark_sessionId_idx:k("SessionBookmark_sessionId_idx").on(e.sessionId)})),eX=(0,y.pgTable)("Resource",{id:(0,_.text)("id").primaryKey().notNull(),tutorId:(0,_.text)("tutorId").notNull(),name:(0,_.text)("name").notNull(),description:(0,_.text)("description"),type:(0,_.text)("type").notNull(),size:(0,g.integer)("size").notNull(),mimeType:(0,_.text)("mimeType"),url:(0,_.text)("url").notNull(),key:(0,_.text)("key").notNull(),tags:(0,_.text)("tags").array().notNull(),isPublic:(0,x.boolean)("isPublic").notNull(),downloadCount:(0,g.integer)("downloadCount").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({Resource_tutorId_idx:k("Resource_tutorId_idx").on(e.tutorId),Resource_type_idx:k("Resource_type_idx").on(e.type),Resource_tags_idx:k("Resource_tags_idx").on(e.tags),Resource_isPublic_idx:k("Resource_isPublic_idx").on(e.isPublic)})),e0=(0,y.pgTable)("ResourceShare",{id:(0,_.text)("id").primaryKey().notNull(),resourceId:(0,_.text)("resourceId").notNull(),sharedByTutorId:(0,_.text)("sharedByTutorId").notNull(),recipientId:(0,_.text)("recipientId"),curriculumId:(0,_.text)("curriculumId"),sharedWithAll:(0,x.boolean)("sharedWithAll").notNull(),message:(0,_.text)("message"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({ResourceShare_resourceId_idx:k("ResourceShare_resourceId_idx").on(e.resourceId),ResourceShare_recipientId_idx:k("ResourceShare_recipientId_idx").on(e.recipientId),ResourceShare_sharedByTutorId_idx:k("ResourceShare_sharedByTutorId_idx").on(e.sharedByTutorId),ResourceShare_resourceId_recipientId_key:P("ResourceShare_resourceId_recipientId_key").on(e.resourceId,e.recipientId),ResourceShare_resourceId_sharedWithAll_key:P("ResourceShare_resourceId_sharedWithAll_key").on(e.resourceId,e.sharedWithAll)})),e1=(0,y.pgTable)("LibraryTask",{id:(0,_.text)("id").primaryKey().notNull(),userId:(0,_.text)("userId").notNull(),question:(0,_.text)("question").notNull(),type:(0,_.text)("type").notNull(),options:(0,N.jsonb)("options"),correctAnswer:(0,_.text)("correctAnswer"),explanation:(0,_.text)("explanation"),difficulty:(0,_.text)("difficulty").notNull(),subject:(0,_.text)("subject").notNull(),topics:(0,N.jsonb)("topics").notNull(),isFavorite:(0,x.boolean)("isFavorite").notNull(),usageCount:(0,g.integer)("usageCount").notNull(),lastUsedAt:(0,I.timestamp)("lastUsedAt",{withTimezone:!0}),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({LibraryTask_userId_idx:k("LibraryTask_userId_idx").on(e.userId),LibraryTask_isFavorite_idx:k("LibraryTask_isFavorite_idx").on(e.isFavorite)})),e2=(0,y.pgTable)("AdminRole",{id:(0,_.text)("id").primaryKey().notNull(),name:(0,_.text)("name").notNull().unique(),description:(0,_.text)("description"),permissions:(0,N.jsonb)("permissions").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)}),e8=(0,y.pgTable)("AdminAssignment",{id:(0,_.text)("id").primaryKey().notNull(),userId:(0,_.text)("userId").notNull(),roleId:(0,_.text)("roleId").notNull(),assignedBy:(0,_.text)("assignedBy"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),expiresAt:(0,I.timestamp)("expiresAt",{withTimezone:!0}),isActive:(0,x.boolean)("isActive").notNull()},e=>({AdminAssignment_userId_idx:k("AdminAssignment_userId_idx").on(e.userId),AdminAssignment_roleId_idx:k("AdminAssignment_roleId_idx").on(e.roleId),AdminAssignment_userId_roleId_key:P("AdminAssignment_userId_roleId_key").on(e.userId,e.roleId)})),e5=(0,y.pgTable)("FeatureFlag",{id:(0,_.text)("id").primaryKey().notNull(),key:(0,_.text)("key").notNull().unique(),name:(0,_.text)("name").notNull(),description:(0,_.text)("description"),enabled:(0,x.boolean)("enabled").notNull(),scope:(0,_.text)("scope").notNull(),targetValue:(0,N.jsonb)("targetValue"),config:(0,N.jsonb)("config").notNull(),createdBy:(0,_.text)("createdBy"),updatedBy:(0,_.text)("updatedBy"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date),deletedAt:(0,I.timestamp)("deletedAt",{withTimezone:!0})},e=>({FeatureFlag_key_idx:k("FeatureFlag_key_idx").on(e.key),FeatureFlag_scope_idx:k("FeatureFlag_scope_idx").on(e.scope),FeatureFlag_enabled_idx:k("FeatureFlag_enabled_idx").on(e.enabled)})),e6=(0,y.pgTable)("FeatureFlagChange",{id:(0,_.text)("id").primaryKey().notNull(),flagId:(0,_.text)("flagId").notNull(),changedBy:(0,_.text)("changedBy").notNull(),previousValue:(0,N.jsonb)("previousValue"),newValue:(0,N.jsonb)("newValue"),changeReason:(0,_.text)("changeReason"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({FeatureFlagChange_flagId_idx:k("FeatureFlagChange_flagId_idx").on(e.flagId),FeatureFlagChange_changedBy_idx:k("FeatureFlagChange_changedBy_idx").on(e.changedBy),FeatureFlagChange_createdAt_idx:k("FeatureFlagChange_createdAt_idx").on(e.createdAt)})),e7=(0,y.pgTable)("LlmProvider",{id:(0,_.text)("id").primaryKey().notNull(),name:(0,_.text)("name").notNull(),providerType:(0,_.text)("providerType").notNull(),apiKeyEncrypted:(0,_.text)("apiKeyEncrypted"),baseUrl:(0,_.text)("baseUrl"),isActive:(0,x.boolean)("isActive").notNull(),isDefault:(0,x.boolean)("isDefault").notNull(),priority:(0,g.integer)("priority").notNull(),config:(0,N.jsonb)("config").notNull(),rateLimits:(0,N.jsonb)("rateLimits").notNull(),costPer1kTokens:(0,f.doublePrecision)("costPer1kTokens"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)}),e9=(0,y.pgTable)("LlmModel",{id:(0,_.text)("id").primaryKey().notNull(),providerId:(0,_.text)("providerId").notNull(),modelId:(0,_.text)("modelId").notNull(),name:(0,_.text)("name"),description:(0,_.text)("description"),maxTokens:(0,g.integer)("maxTokens"),supportsVision:(0,x.boolean)("supportsVision").notNull(),supportsFunctions:(0,x.boolean)("supportsFunctions").notNull(),isActive:(0,x.boolean)("isActive").notNull(),config:(0,N.jsonb)("config").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({LlmModel_providerId_idx:k("LlmModel_providerId_idx").on(e.providerId),LlmModel_isActive_idx:k("LlmModel_isActive_idx").on(e.isActive),LlmModel_providerId_modelId_key:P("LlmModel_providerId_modelId_key").on(e.providerId,e.modelId)})),e3=(0,y.pgTable)("LlmRoutingRule",{id:(0,_.text)("id").primaryKey().notNull(),name:(0,_.text)("name"),description:(0,_.text)("description"),priority:(0,g.integer)("priority").notNull(),conditions:(0,N.jsonb)("conditions").notNull(),targetModelId:(0,_.text)("targetModelId").notNull(),fallbackModelId:(0,_.text)("fallbackModelId"),isActive:(0,x.boolean)("isActive").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),providerId:(0,_.text)("providerId").notNull()},e=>({LlmRoutingRule_targetModelId_idx:k("LlmRoutingRule_targetModelId_idx").on(e.targetModelId),LlmRoutingRule_isActive_idx:k("LlmRoutingRule_isActive_idx").on(e.isActive),LlmRoutingRule_priority_idx:k("LlmRoutingRule_priority_idx").on(e.priority)})),e4=(0,y.pgTable)("SystemSetting",{id:(0,_.text)("id").primaryKey().notNull(),category:(0,_.text)("category").notNull(),key:(0,_.text)("key").notNull(),settingValue:(0,N.jsonb)("setting_value").notNull(),valueType:(0,_.text)("valueType").notNull(),description:(0,_.text)("description"),isEditable:(0,x.boolean)("isEditable").notNull(),requiresRestart:(0,x.boolean)("requiresRestart").notNull(),updatedBy:(0,_.text)("updatedBy"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({SystemSetting_category_idx:k("SystemSetting_category_idx").on(e.category),SystemSetting_key_idx:k("SystemSetting_key_idx").on(e.key),SystemSetting_category_key_key:P("SystemSetting_category_key_key").on(e.category,e.key)})),te=(0,y.pgTable)("AdminAuditLog",{id:(0,_.text)("id").primaryKey().notNull(),adminId:(0,_.text)("adminId").notNull(),action:(0,_.text)("action").notNull(),resourceType:(0,_.text)("resourceType"),resourceId:(0,_.text)("resourceId"),previousState:(0,N.jsonb)("previousState"),newState:(0,N.jsonb)("newState"),metadata:(0,N.jsonb)("metadata"),ipAddress:(0,_.text)("ipAddress"),userAgent:(0,_.text)("userAgent"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({AdminAuditLog_adminId_idx:k("AdminAuditLog_adminId_idx").on(e.adminId),AdminAuditLog_action_idx:k("AdminAuditLog_action_idx").on(e.action),AdminAuditLog_resourceType_idx:k("AdminAuditLog_resourceType_idx").on(e.resourceType),AdminAuditLog_createdAt_idx:k("AdminAuditLog_createdAt_idx").on(e.createdAt)})),tt=(0,y.pgTable)("AdminSession",{id:(0,_.text)("id").primaryKey().notNull(),adminId:(0,_.text)("adminId").notNull(),token:(0,_.text)("token").notNull().unique(),ipAddress:(0,_.text)("ipAddress"),userAgent:(0,_.text)("userAgent"),startedAt:(0,I.timestamp)("startedAt",{withTimezone:!0}).notNull().defaultNow(),lastActiveAt:(0,I.timestamp)("lastActiveAt",{withTimezone:!0}).notNull().defaultNow(),expiresAt:(0,I.timestamp)("expiresAt",{withTimezone:!0}).notNull(),isRevoked:(0,x.boolean)("isRevoked").notNull()},e=>({AdminSession_adminId_idx:k("AdminSession_adminId_idx").on(e.adminId),AdminSession_token_idx:k("AdminSession_token_idx").on(e.token),AdminSession_expiresAt_idx:k("AdminSession_expiresAt_idx").on(e.expiresAt)})),ti=(0,y.pgTable)("IpWhitelist",{id:(0,_.text)("id").primaryKey().notNull(),ipAddress:(0,_.text)("ipAddress").notNull().unique(),description:(0,_.text)("description"),isActive:(0,x.boolean)("isActive").notNull(),createdBy:(0,_.text)("createdBy"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),expiresAt:(0,I.timestamp)("expiresAt",{withTimezone:!0})},e=>({IpWhitelist_ipAddress_idx:k("IpWhitelist_ipAddress_idx").on(e.ipAddress),IpWhitelist_isActive_idx:k("IpWhitelist_isActive_idx").on(e.isActive)})),tn=(0,y.pgTable)("CalendarConnection",{id:(0,_.text)("id").primaryKey().notNull(),userId:(0,_.text)("userId").notNull(),provider:(0,_.text)("provider").notNull(),providerAccountId:(0,_.text)("providerAccountId"),accessToken:(0,_.text)("accessToken"),refreshToken:(0,_.text)("refreshToken"),expiresAt:(0,I.timestamp)("expiresAt",{withTimezone:!0}),syncEnabled:(0,x.boolean)("syncEnabled").notNull(),syncDirection:(0,_.text)("syncDirection").notNull(),lastSyncedAt:(0,I.timestamp)("lastSyncedAt",{withTimezone:!0}),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({CalendarConnection_userId_idx:k("CalendarConnection_userId_idx").on(e.userId),CalendarConnection_provider_idx:k("CalendarConnection_provider_idx").on(e.provider),CalendarConnection_userId_provider_key:P("CalendarConnection_userId_provider_key").on(e.userId,e.provider)})),ts=(0,y.pgTable)("CalendarEvent",{id:(0,_.text)("id").primaryKey().notNull(),tutorId:(0,_.text)("tutorId").notNull(),title:(0,_.text)("title").notNull(),description:(0,_.text)("description"),type:c("type").notNull(),status:m("status").notNull(),startTime:(0,I.timestamp)("startTime",{withTimezone:!0}).notNull(),endTime:(0,I.timestamp)("endTime",{withTimezone:!0}).notNull(),timezone:(0,_.text)("timezone").notNull(),isAllDay:(0,x.boolean)("isAllDay").notNull(),recurrenceRule:(0,_.text)("recurrenceRule"),recurringEventId:(0,_.text)("recurringEventId"),isRecurring:(0,x.boolean)("isRecurring").notNull(),location:(0,_.text)("location"),meetingUrl:(0,_.text)("meetingUrl"),isVirtual:(0,x.boolean)("isVirtual").notNull(),curriculumId:(0,_.text)("curriculumId"),batchId:(0,_.text)("batchId"),studentId:(0,_.text)("studentId"),attendees:(0,N.jsonb)("attendees"),maxAttendees:(0,g.integer)("maxAttendees").notNull(),reminders:(0,N.jsonb)("reminders"),color:(0,_.text)("color"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date),createdBy:(0,_.text)("createdBy").notNull(),externalId:(0,_.text)("externalId"),deletedAt:(0,I.timestamp)("deletedAt",{withTimezone:!0}),isCancelled:(0,x.boolean)("isCancelled").notNull()},e=>({CalendarEvent_tutorId_idx:k("CalendarEvent_tutorId_idx").on(e.tutorId),CalendarEvent_startTime_idx:k("CalendarEvent_startTime_idx").on(e.startTime),CalendarEvent_endTime_idx:k("CalendarEvent_endTime_idx").on(e.endTime),CalendarEvent_status_idx:k("CalendarEvent_status_idx").on(e.status),CalendarEvent_type_idx:k("CalendarEvent_type_idx").on(e.type),CalendarEvent_recurringEventId_idx:k("CalendarEvent_recurringEventId_idx").on(e.recurringEventId),CalendarEvent_tutorId_startTime_endTime_idx:k("CalendarEvent_tutorId_startTime_endTime_idx").on(e.tutorId,e.startTime,e.endTime),CalendarEvent_curriculumId_idx:k("CalendarEvent_curriculumId_idx").on(e.curriculumId),CalendarEvent_batchId_idx:k("CalendarEvent_batchId_idx").on(e.batchId)})),to=(0,y.pgTable)("CalendarAvailability",{id:(0,_.text)("id").primaryKey().notNull(),tutorId:(0,_.text)("tutorId").notNull(),dayOfWeek:(0,g.integer)("dayOfWeek").notNull(),startTime:(0,_.text)("startTime").notNull(),endTime:(0,_.text)("endTime").notNull(),timezone:(0,_.text)("timezone").notNull(),isAvailable:(0,x.boolean)("isAvailable").notNull(),validFrom:(0,I.timestamp)("validFrom",{withTimezone:!0}),validUntil:(0,I.timestamp)("validUntil",{withTimezone:!0}),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({CalendarAvailability_tutorId_idx:k("CalendarAvailability_tutorId_idx").on(e.tutorId),CalendarAvailability_dayOfWeek_idx:k("CalendarAvailability_dayOfWeek_idx").on(e.dayOfWeek),CalendarAvailability_tutorId_dayOfWeek_startTime_endTime_key:P("CalendarAvailability_tutorId_dayOfWeek_startTime_endTime_key").on(e.tutorId,e.dayOfWeek,e.startTime,e.endTime)})),ta=(0,y.pgTable)("CalendarException",{id:(0,_.text)("id").primaryKey().notNull(),tutorId:(0,_.text)("tutorId").notNull(),date:(0,I.timestamp)("date",{withTimezone:!0}).notNull(),isAvailable:(0,x.boolean)("isAvailable").notNull(),startTime:(0,_.text)("startTime"),endTime:(0,_.text)("endTime"),reason:(0,_.text)("reason"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({CalendarException_tutorId_idx:k("CalendarException_tutorId_idx").on(e.tutorId),CalendarException_date_idx:k("CalendarException_date_idx").on(e.date),CalendarException_tutorId_date_startTime_key:P("CalendarException_tutorId_date_startTime_key").on(e.tutorId,e.date,e.startTime)})),tr=(0,y.pgTable)("Whiteboard",{id:(0,_.text)("id").primaryKey().notNull(),tutorId:(0,_.text)("tutorId").notNull(),sessionId:(0,_.text)("sessionId"),roomId:(0,_.text)("roomId"),curriculumId:(0,_.text)("curriculumId"),lessonId:(0,_.text)("lessonId"),title:(0,_.text)("title").notNull(),description:(0,_.text)("description"),isTemplate:(0,x.boolean)("isTemplate").notNull(),isPublic:(0,x.boolean)("isPublic").notNull(),width:(0,g.integer)("width").notNull(),height:(0,g.integer)("height").notNull(),backgroundColor:(0,_.text)("backgroundColor").notNull(),backgroundStyle:(0,_.text)("backgroundStyle").notNull(),backgroundImage:(0,_.text)("backgroundImage"),collaborators:(0,N.jsonb)("collaborators"),visibility:(0,_.text)("visibility").notNull(),isBroadcasting:(0,x.boolean)("isBroadcasting").notNull(),ownerType:(0,_.text)("ownerType").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date),deletedAt:(0,I.timestamp)("deletedAt",{withTimezone:!0})},e=>({Whiteboard_tutorId_idx:k("Whiteboard_tutorId_idx").on(e.tutorId),Whiteboard_sessionId_idx:k("Whiteboard_sessionId_idx").on(e.sessionId),Whiteboard_roomId_idx:k("Whiteboard_roomId_idx").on(e.roomId),Whiteboard_curriculumId_idx:k("Whiteboard_curriculumId_idx").on(e.curriculumId),Whiteboard_lessonId_idx:k("Whiteboard_lessonId_idx").on(e.lessonId),Whiteboard_isTemplate_idx:k("Whiteboard_isTemplate_idx").on(e.isTemplate),Whiteboard_createdAt_idx:k("Whiteboard_createdAt_idx").on(e.createdAt),Whiteboard_visibility_idx:k("Whiteboard_visibility_idx").on(e.visibility),Whiteboard_isBroadcasting_idx:k("Whiteboard_isBroadcasting_idx").on(e.isBroadcasting),Whiteboard_sessionId_visibility_idx:k("Whiteboard_sessionId_visibility_idx").on(e.sessionId,e.visibility),Whiteboard_sessionId_ownerType_idx:k("Whiteboard_sessionId_ownerType_idx").on(e.sessionId,e.ownerType)})),tl=(0,y.pgTable)("WhiteboardPage",{id:(0,_.text)("id").primaryKey().notNull(),whiteboardId:(0,_.text)("whiteboardId").notNull(),name:(0,_.text)("name").notNull(),order:(0,g.integer)("order").notNull(),backgroundColor:(0,_.text)("backgroundColor"),backgroundStyle:(0,_.text)("backgroundStyle"),backgroundImage:(0,_.text)("backgroundImage"),strokes:(0,N.jsonb)("strokes").notNull(),shapes:(0,N.jsonb)("shapes").notNull(),texts:(0,N.jsonb)("texts").notNull(),images:(0,N.jsonb)("images").notNull(),viewState:(0,N.jsonb)("viewState"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({WhiteboardPage_whiteboardId_idx:k("WhiteboardPage_whiteboardId_idx").on(e.whiteboardId),WhiteboardPage_order_idx:k("WhiteboardPage_order_idx").on(e.order),WhiteboardPage_whiteboardId_order_key:P("WhiteboardPage_whiteboardId_order_key").on(e.whiteboardId,e.order)})),td=(0,y.pgTable)("WhiteboardSnapshot",{id:(0,_.text)("id").primaryKey().notNull(),whiteboardId:(0,_.text)("whiteboardId").notNull(),name:(0,_.text)("name").notNull(),thumbnailUrl:(0,_.text)("thumbnailUrl"),pages:(0,N.jsonb)("pages").notNull(),createdBy:(0,_.text)("createdBy").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({WhiteboardSnapshot_whiteboardId_idx:k("WhiteboardSnapshot_whiteboardId_idx").on(e.whiteboardId),WhiteboardSnapshot_createdAt_idx:k("WhiteboardSnapshot_createdAt_idx").on(e.createdAt)})),tu=(0,y.pgTable)("WhiteboardSession",{id:(0,_.text)("id").primaryKey().notNull(),whiteboardId:(0,_.text)("whiteboardId").notNull(),roomId:(0,_.text)("roomId").notNull(),tutorId:(0,_.text)("tutorId").notNull(),participants:(0,N.jsonb)("participants").notNull(),isActive:(0,x.boolean)("isActive").notNull(),startedAt:(0,I.timestamp)("startedAt",{withTimezone:!0}).notNull().defaultNow(),endedAt:(0,I.timestamp)("endedAt",{withTimezone:!0}),operations:(0,N.jsonb)("operations"),finalPageStates:(0,N.jsonb)("finalPageStates")},e=>({WhiteboardSession_whiteboardId_idx:k("WhiteboardSession_whiteboardId_idx").on(e.whiteboardId),WhiteboardSession_roomId_idx:k("WhiteboardSession_roomId_idx").on(e.roomId),WhiteboardSession_tutorId_idx:k("WhiteboardSession_tutorId_idx").on(e.tutorId),WhiteboardSession_isActive_idx:k("WhiteboardSession_isActive_idx").on(e.isActive)})),tc=(0,y.pgTable)("MathWhiteboardSession",{id:(0,_.text)("id").primaryKey().notNull(),liveSessionId:(0,_.text)("liveSessionId").notNull(),tutorId:(0,_.text)("tutorId").notNull(),title:(0,_.text)("title").notNull(),description:(0,_.text)("description"),status:p("status").notNull(),isLocked:(0,x.boolean)("isLocked").notNull(),allowStudentEdit:(0,x.boolean)("allowStudentEdit").notNull(),allowStudentTools:(0,x.boolean)("allowStudentTools").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date),endedAt:(0,I.timestamp)("endedAt",{withTimezone:!0})},e=>({MathWhiteboardSession_liveSessionId_idx:k("MathWhiteboardSession_liveSessionId_idx").on(e.liveSessionId),MathWhiteboardSession_tutorId_idx:k("MathWhiteboardSession_tutorId_idx").on(e.tutorId),MathWhiteboardSession_status_idx:k("MathWhiteboardSession_status_idx").on(e.status),MathWhiteboardSession_createdAt_idx:k("MathWhiteboardSession_createdAt_idx").on(e.createdAt)})),tm=(0,y.pgTable)("MathWhiteboardPage",{id:(0,_.text)("id").primaryKey().notNull(),sessionId:(0,_.text)("sessionId").notNull(),name:(0,_.text)("name").notNull(),order:(0,g.integer)("order").notNull(),width:(0,g.integer)("width").notNull(),height:(0,g.integer)("height").notNull(),backgroundType:(0,_.text)("backgroundType").notNull(),backgroundColor:(0,_.text)("backgroundColor").notNull(),elements:(0,N.jsonb)("elements").notNull(),vectorClock:(0,N.jsonb)("vectorClock").notNull(),lastModified:(0,I.timestamp)("lastModified",{withTimezone:!0}).notNull().$onUpdate(()=>new Date),modifiedBy:(0,_.text)("modifiedBy"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({MathWhiteboardPage_sessionId_idx:k("MathWhiteboardPage_sessionId_idx").on(e.sessionId),MathWhiteboardPage_order_idx:k("MathWhiteboardPage_order_idx").on(e.order),MathWhiteboardPage_sessionId_order_key:P("MathWhiteboardPage_sessionId_order_key").on(e.sessionId,e.order)})),tp=(0,y.pgTable)("MathWhiteboardParticipant",{id:(0,_.text)("id").primaryKey().notNull(),sessionId:(0,_.text)("sessionId").notNull(),userId:(0,_.text)("userId").notNull(),role:i("role").notNull(),canEdit:(0,x.boolean)("canEdit").notNull(),canChat:(0,x.boolean)("canChat").notNull(),canUseAI:(0,x.boolean)("canUseAI").notNull(),cursorX:(0,f.doublePrecision)("cursorX"),cursorY:(0,f.doublePrecision)("cursorY"),cursorColor:(0,_.text)("cursorColor").notNull(),isTyping:(0,x.boolean)("isTyping").notNull(),joinedAt:(0,I.timestamp)("joinedAt",{withTimezone:!0}).notNull().defaultNow(),leftAt:(0,I.timestamp)("leftAt",{withTimezone:!0})},e=>({MathWhiteboardParticipant_sessionId_idx:k("MathWhiteboardParticipant_sessionId_idx").on(e.sessionId),MathWhiteboardParticipant_userId_idx:k("MathWhiteboardParticipant_userId_idx").on(e.userId),MathWhiteboardParticipant_sessionId_userId_key:P("MathWhiteboardParticipant_sessionId_userId_key").on(e.sessionId,e.userId)})),th=(0,y.pgTable)("MathWhiteboardSnapshot",{id:(0,_.text)("id").primaryKey().notNull(),sessionId:(0,_.text)("sessionId").notNull(),name:(0,_.text)("name").notNull(),description:(0,_.text)("description"),thumbnailUrl:(0,_.text)("thumbnailUrl"),pages:(0,N.jsonb)("pages").notNull(),viewState:(0,N.jsonb)("viewState"),createdBy:(0,_.text)("createdBy").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({MathWhiteboardSnapshot_sessionId_idx:k("MathWhiteboardSnapshot_sessionId_idx").on(e.sessionId),MathWhiteboardSnapshot_createdAt_idx:k("MathWhiteboardSnapshot_createdAt_idx").on(e.createdAt)})),ty=(0,y.pgTable)("MathAIInteraction",{id:(0,_.text)("id").primaryKey().notNull(),sessionId:(0,_.text)("sessionId").notNull(),userId:(0,_.text)("userId").notNull(),type:h("type").notNull(),inputText:(0,_.text)("inputText"),inputLatex:(0,_.text)("inputLatex"),inputImage:(0,_.text)("inputImage"),output:(0,_.text)("output").notNull(),outputLatex:(0,_.text)("outputLatex"),modelUsed:(0,_.text)("modelUsed").notNull(),latencyMs:(0,g.integer)("latencyMs").notNull(),tokensUsed:(0,g.integer)("tokensUsed"),steps:(0,N.jsonb)("steps"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({MathAIInteraction_sessionId_idx:k("MathAIInteraction_sessionId_idx").on(e.sessionId),MathAIInteraction_type_idx:k("MathAIInteraction_type_idx").on(e.type),MathAIInteraction_createdAt_idx:k("MathAIInteraction_createdAt_idx").on(e.createdAt)})),t_=(0,y.pgTable)("FamilyAccount",{id:(0,_.text)("id").primaryKey().notNull(),familyName:(0,_.text)("familyName").notNull(),familyType:(0,_.text)("familyType").notNull(),primaryEmail:(0,_.text)("primaryEmail").notNull().unique(),phoneNumber:(0,_.text)("phoneNumber"),address:(0,_.text)("address"),country:(0,_.text)("country"),timezone:(0,_.text)("timezone"),defaultCurrency:(0,_.text)("defaultCurrency").notNull(),monthlyBudget:(0,f.doublePrecision)("monthlyBudget").notNull(),enableBudget:(0,x.boolean)("enableBudget").notNull(),allowAdults:(0,x.boolean)("allowAdults").notNull(),isActive:(0,x.boolean)("isActive").notNull(),isVerified:(0,x.boolean)("isVerified").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date),verifiedAt:(0,I.timestamp)("verifiedAt",{withTimezone:!0})},e=>({FamilyAccount_isActive_idx:k("FamilyAccount_isActive_idx").on(e.isActive),FamilyAccount_isVerified_idx:k("FamilyAccount_isVerified_idx").on(e.isVerified),FamilyAccount_createdAt_idx:k("FamilyAccount_createdAt_idx").on(e.createdAt),idx_family_account_status:k("idx_family_account_status").on(e.isActive,e.isVerified),idx_family_account_active_created:k("idx_family_account_active_created").on(e.isActive,e.createdAt),idx_family_account_type_status:k("idx_family_account_type_status").on(e.familyType,e.isActive)})),tg=(0,y.pgTable)("FamilyMember",{id:(0,_.text)("id").primaryKey().notNull(),familyAccountId:(0,_.text)("familyAccountId").notNull(),userId:(0,_.text)("userId"),name:(0,_.text)("name").notNull(),relation:(0,_.text)("relation").notNull(),email:(0,_.text)("email"),phone:(0,_.text)("phone"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({FamilyMember_familyAccountId_idx:k("FamilyMember_familyAccountId_idx").on(e.familyAccountId),FamilyMember_userId_idx:k("FamilyMember_userId_idx").on(e.userId),idx_family_member_account_user:k("idx_family_member_account_user").on(e.familyAccountId,e.userId),idx_family_member_user_relation:k("idx_family_member_user_relation").on(e.userId,e.relation)})),tx=(0,y.pgTable)("FamilyBudget",{id:(0,_.text)("id").primaryKey().notNull(),parentId:(0,_.text)("parentId").notNull(),month:(0,g.integer)("month").notNull(),year:(0,g.integer)("year").notNull(),amount:(0,f.doublePrecision)("amount").notNull(),spent:(0,f.doublePrecision)("spent").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({FamilyBudget_parentId_idx:k("FamilyBudget_parentId_idx").on(e.parentId),idx_family_budget_parent_period:k("idx_family_budget_parent_period").on(e.parentId,e.year,e.month),FamilyBudget_parentId_month_year_key:P("FamilyBudget_parentId_month_year_key").on(e.parentId,e.month,e.year)})),tI=(0,y.pgTable)("FamilyPayment",{id:(0,_.text)("id").primaryKey().notNull(),parentId:(0,_.text)("parentId").notNull(),amount:(0,f.doublePrecision)("amount").notNull(),method:(0,_.text)("method").notNull(),status:(0,_.text)("status").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({FamilyPayment_parentId_idx:k("FamilyPayment_parentId_idx").on(e.parentId),idx_family_payment_parent_created:k("idx_family_payment_parent_created").on(e.parentId,e.createdAt),idx_family_payment_parent_status_created:k("idx_family_payment_parent_status_created").on(e.parentId,e.status,e.createdAt)})),tN=(0,y.pgTable)("BudgetAlert",{id:(0,_.text)("id").primaryKey().notNull(),parentId:(0,_.text)("parentId").notNull(),type:(0,_.text)("type").notNull(),message:(0,_.text)("message").notNull(),isRead:(0,x.boolean)("isRead").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({BudgetAlert_parentId_idx:k("BudgetAlert_parentId_idx").on(e.parentId)})),tf=(0,y.pgTable)("ParentActivityLog",{id:(0,_.text)("id").primaryKey().notNull(),parentId:(0,_.text)("parentId").notNull(),action:(0,_.text)("action").notNull(),details:(0,_.text)("details"),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({ParentActivityLog_parentId_idx:k("ParentActivityLog_parentId_idx").on(e.parentId),idx_parent_activity_parent_created:k("idx_parent_activity_parent_created").on(e.parentId,e.createdAt)})),tb=(0,y.pgTable)("FamilyNotification",{id:(0,_.text)("id").primaryKey().notNull(),parentId:(0,_.text)("parentId").notNull(),title:(0,_.text)("title").notNull(),message:(0,_.text)("message").notNull(),isRead:(0,x.boolean)("isRead").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({FamilyNotification_parentId_idx:k("FamilyNotification_parentId_idx").on(e.parentId),idx_family_notification_parent_created:k("idx_family_notification_parent_created").on(e.parentId,e.createdAt),idx_family_notification_parent_read_created:k("idx_family_notification_parent_read_created").on(e.parentId,e.isRead,e.createdAt)})),tA=(0,y.pgTable)("EmergencyContact",{id:(0,_.text)("id").primaryKey().notNull(),parentId:(0,_.text)("parentId").notNull(),name:(0,_.text)("name").notNull(),relation:(0,_.text)("relation").notNull(),phone:(0,_.text)("phone").notNull(),email:(0,_.text)("email"),isPrimary:(0,x.boolean)("isPrimary").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow()},e=>({EmergencyContact_parentId_idx:k("EmergencyContact_parentId_idx").on(e.parentId),idx_emergency_contact_parent_primary:k("idx_emergency_contact_parent_primary").on(e.parentId,e.isPrimary),idx_emergency_contact_parent_primary_created:k("idx_emergency_contact_parent_primary_created").on(e.parentId,e.isPrimary,e.createdAt)})),tT=(0,y.pgTable)("StudentProgressSnapshot",{id:(0,_.text)("id").primaryKey().notNull(),parentId:(0,_.text)("parentId").notNull(),studentId:(0,_.text)("studentId").notNull(),data:(0,N.jsonb)("data").notNull(),capturedAt:(0,I.timestamp)("capturedAt",{withTimezone:!0}).notNull().defaultNow()},e=>({StudentProgressSnapshot_parentId_idx:k("StudentProgressSnapshot_parentId_idx").on(e.parentId),StudentProgressSnapshot_studentId_idx:k("StudentProgressSnapshot_studentId_idx").on(e.studentId),idx_student_progress_parent_captured:k("idx_student_progress_parent_captured").on(e.parentId,e.capturedAt),idx_student_progress_student_captured:k("idx_student_progress_student_captured").on(e.studentId,e.capturedAt)})),tw=(0,y.pgTable)("ParentPaymentAuthorization",{id:(0,_.text)("id").primaryKey().notNull(),parentId:(0,_.text)("parentId").notNull().unique(),level:(0,_.text)("level").notNull(),maxAmount:(0,f.doublePrecision)("maxAmount"),methods:(0,_.text)("methods").array().notNull(),isActive:(0,x.boolean)("isActive").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({ParentPaymentAuthorization_parentId_idx:k("ParentPaymentAuthorization_parentId_idx").on(e.parentId)})),tS=(0,y.pgTable)("ParentSpendingLimit",{id:(0,_.text)("id").primaryKey().notNull(),parentId:(0,_.text)("parentId").notNull(),category:(0,_.text)("category").notNull(),limit:(0,f.doublePrecision)("limit").notNull(),period:(0,_.text)("period").notNull(),isActive:(0,x.boolean)("isActive").notNull(),createdAt:(0,I.timestamp)("createdAt",{withTimezone:!0}).notNull().defaultNow(),updatedAt:(0,I.timestamp)("updatedAt",{withTimezone:!0}).notNull().$onUpdate(()=>new Date)},e=>({ParentSpendingLimit_parentId_idx:k("ParentSpendingLimit_parentId_idx").on(e.parentId)}));e.s(["aIAssistantInsight",0,eq,"aIAssistantMessage",0,eC,"aIAssistantSession",0,ez,"aIInteractionSession",0,Y,"aITutorDailyUsage",0,Z,"aITutorEnrollment",0,H,"aITutorSubscription",0,X,"account",0,C,"achievement",0,em,"adminAssignment",0,e8,"adminAuditLog",0,te,"adminRole",0,e2,"adminSession",0,tt,"apiKey",0,eW,"badge",0,e_,"bookmark",0,eu,"breakoutRoom",0,V,"breakoutRoomAssignment",0,J,"breakoutSession",0,G,"budgetAlert",0,tN,"calendarAvailability",0,to,"calendarConnection",0,tn,"calendarEvent",0,ts,"calendarException",0,ta,"clinic",0,eR,"clinicBooking",0,eE,"contentItem",0,ee,"contentProgress",0,en,"contentQuizCheckpoint",0,ei,"conversation",0,eS,"courseBatch",0,K,"curriculum",0,E,"curriculumCatalog",0,R,"curriculumEnrollment",0,Q,"curriculumLesson",0,j,"curriculumLessonProgress",0,$,"curriculumModule",0,M,"curriculumProgress",0,D,"curriculumShare",0,L,"directMessage",0,ev,"emergencyContact",0,tA,"engagementSnapshot",0,eV,"familyAccount",0,t_,"familyBudget",0,tx,"familyMember",0,tg,"familyNotification",0,tb,"familyPayment",0,tI,"featureFlag",0,e5,"featureFlagChange",0,e6,"feedbackWorkflow",0,U,"generatedTask",0,F,"ipWhitelist",0,ti,"leaderboardEntry",0,ex,"lessonSession",0,B,"libraryTask",0,e1,"liveSession",0,eI,"llmModel",0,e9,"llmProvider",0,e7,"llmRoutingRule",0,e3,"mathAIInteraction",0,ty,"mathWhiteboardPage",0,tm,"mathWhiteboardParticipant",0,tp,"mathWhiteboardSession",0,tc,"mathWhiteboardSnapshot",0,th,"message",0,ew,"mission",0,ep,"missionProgress",0,eh,"note",0,ed,"notification",0,ek,"notificationPreference",0,eP,"parentActivityLog",0,tf,"parentPaymentAuthorization",0,tw,"parentSpendingLimit",0,tS,"payment",0,eL,"paymentOnPayout",0,e$,"payout",0,eB,"performanceAlert",0,eG,"performanceMetric",0,eF,"platformRevenue",0,eQ,"poll",0,eb,"pollOption",0,eA,"pollResponse",0,eT,"postSessionReport",0,eH,"profile",0,q,"questionBankItem",0,ea,"quiz",0,er,"quizAssignment",0,el,"quizAttempt",0,eo,"refund",0,eM,"resource",0,eX,"resourceShare",0,e0,"reviewSchedule",0,es,"securityEvent",0,eU,"sessionBookmark",0,eZ,"sessionEngagementSummary",0,eJ,"sessionParticipant",0,ef,"sessionReplayArtifact",0,eN,"studentPerformance",0,O,"studentProgressSnapshot",0,tT,"studentSessionInsight",0,eY,"studyGroup",0,eK,"studyGroupMember",0,eD,"systemSetting",0,e4,"taskSubmission",0,W,"user",0,z,"userActivityLog",0,eO,"userBadge",0,eg,"userDailyQuest",0,ey,"userGamification",0,ec,"videoWatchEvent",0,et,"webhookEvent",0,ej,"whiteboard",0,tr,"whiteboardPage",0,tl,"whiteboardSession",0,tu,"whiteboardSnapshot",0,td],257357)},688768,546060,521384,e=>{"use strict";e.i(1638);var t=e.i(257357),i=e.i(111003),n=e.i(924841),s=e.i(888290),o=e.i(397753);let a=(0,i.pgTable)("Session",{sessionToken:(0,n.text)("sessionToken").primaryKey(),userId:(0,n.text)("userId").notNull(),expires:(0,s.timestamp)("expires",{withTimezone:!0}).notNull()}),r=(0,i.pgTable)("VerificationToken",{identifier:(0,n.text)("identifier").notNull(),token:(0,n.text)("token").notNull(),expires:(0,s.timestamp)("expires",{withTimezone:!0}).notNull()},e=>({compositePk:(0,o.primaryKey)({columns:[e.identifier,e.token]})}));e.s(["session",0,a,"verificationToken",0,r],546060);var l=e.i(50676);let d=(0,l.relations)(t.user,({one:e,many:i})=>({profile:e(t.profile,{fields:[t.user.id],references:[t.profile.userId]}),adminAssignments:i(t.adminAssignment),adminSessions:i(t.adminSession),curriculumEnrollments:i(t.curriculumEnrollment),liveSessionsAsTutor:i(t.liveSession),sessionParticipations:i(t.sessionParticipant),payouts:i(t.payout),achievements:i(t.achievement),gamification:e(t.userGamification,{fields:[t.user.id],references:[t.userGamification.userId]}),familyMemberships:i(t.familyMember),conversationsAsParticipant1:i(t.conversation,{relationName:"participant1"}),conversationsAsParticipant2:i(t.conversation,{relationName:"participant2"}),sentDirectMessages:i(t.directMessage)})),u=(0,l.relations)(t.profile,({one:e})=>({user:e(t.user,{fields:[t.profile.userId],references:[t.user.id]})})),c=(0,l.relations)(t.adminSession,({one:e})=>({admin:e(t.user,{fields:[t.adminSession.adminId],references:[t.user.id]})})),m=(0,l.relations)(t.adminAssignment,({one:e})=>({user:e(t.user,{fields:[t.adminAssignment.userId],references:[t.user.id]}),role:e(t.adminRole,{fields:[t.adminAssignment.roleId],references:[t.adminRole.id]})})),p=(0,l.relations)(t.adminRole,({many:e})=>({assignments:e(t.adminAssignment)})),h=(0,l.relations)(t.curriculum,({many:e})=>({batches:e(t.courseBatch),enrollments:e(t.curriculumEnrollment),modules:e(t.curriculumModule),shares:e(t.curriculumShare),progress:e(t.curriculumProgress),studentPerformances:e(t.studentPerformance)})),y=(0,l.relations)(t.curriculumModule,({one:e,many:i})=>({curriculum:e(t.curriculum,{fields:[t.curriculumModule.curriculumId],references:[t.curriculum.id]}),lessons:i(t.curriculumLesson)})),_=(0,l.relations)(t.curriculumLesson,({one:e,many:i})=>({module:e(t.curriculumModule,{fields:[t.curriculumLesson.moduleId],references:[t.curriculumModule.id]}),progressRecords:i(t.curriculumLessonProgress)})),g=(0,l.relations)(t.curriculumLessonProgress,({one:e})=>({lesson:e(t.curriculumLesson,{fields:[t.curriculumLessonProgress.lessonId],references:[t.curriculumLesson.id]}),student:e(t.user,{fields:[t.curriculumLessonProgress.studentId],references:[t.user.id]})})),x=(0,l.relations)(t.curriculumProgress,({one:e})=>({student:e(t.user,{fields:[t.curriculumProgress.studentId],references:[t.user.id]}),curriculum:e(t.curriculum,{fields:[t.curriculumProgress.curriculumId],references:[t.curriculum.id]})})),I=(0,l.relations)(t.studentPerformance,({one:e})=>({student:e(t.user,{fields:[t.studentPerformance.studentId],references:[t.user.id]}),curriculum:e(t.curriculum,{fields:[t.studentPerformance.curriculumId],references:[t.curriculum.id]})})),N=(0,l.relations)(t.courseBatch,({one:e,many:i})=>({curriculum:e(t.curriculum,{fields:[t.courseBatch.curriculumId],references:[t.curriculum.id]}),enrollments:i(t.curriculumEnrollment)})),f=(0,l.relations)(t.curriculumEnrollment,({one:e})=>({student:e(t.user,{fields:[t.curriculumEnrollment.studentId],references:[t.user.id]}),curriculum:e(t.curriculum,{fields:[t.curriculumEnrollment.curriculumId],references:[t.curriculum.id]}),batch:e(t.courseBatch,{fields:[t.curriculumEnrollment.batchId],references:[t.courseBatch.id]})})),b=(0,l.relations)(t.curriculumShare,({one:e})=>({curriculum:e(t.curriculum,{fields:[t.curriculumShare.curriculumId],references:[t.curriculum.id]}),sharedBy:e(t.user,{fields:[t.curriculumShare.sharedByTutorId],references:[t.user.id]}),recipient:e(t.user,{fields:[t.curriculumShare.recipientId],references:[t.user.id]})})),A=(0,l.relations)(t.studyGroup,({many:e})=>({members:e(t.studyGroupMember)})),T=(0,l.relations)(t.studyGroupMember,({one:e})=>({group:e(t.studyGroup,{fields:[t.studyGroupMember.groupId],references:[t.studyGroup.id]}),user:e(t.user,{fields:[t.studyGroupMember.studentId],references:[t.user.id]})})),w=(0,l.relations)(t.liveSession,({one:e,many:i})=>({tutor:e(t.user,{fields:[t.liveSession.tutorId],references:[t.user.id]}),participants:i(t.sessionParticipant)})),S=(0,l.relations)(t.sessionParticipant,({one:e})=>({session:e(t.liveSession,{fields:[t.sessionParticipant.sessionId],references:[t.liveSession.id]}),student:e(t.user,{fields:[t.sessionParticipant.studentId],references:[t.user.id]})})),v=(0,l.relations)(t.clinic,({one:e,many:i})=>({tutor:e(t.user,{fields:[t.clinic.tutorId],references:[t.user.id]}),bookings:i(t.clinicBooking)})),k=(0,l.relations)(t.clinicBooking,({one:e})=>({clinic:e(t.clinic,{fields:[t.clinicBooking.clinicId],references:[t.clinic.id]}),student:e(t.user,{fields:[t.clinicBooking.studentId],references:[t.user.id]})})),P=(0,l.relations)(t.payout,({one:e,many:i})=>({tutor:e(t.user,{fields:[t.payout.tutorId],references:[t.user.id]}),payments:i(t.paymentOnPayout)})),z=(0,l.relations)(t.paymentOnPayout,({one:e})=>({payout:e(t.payout,{fields:[t.paymentOnPayout.payoutId],references:[t.payout.id]}),payment:e(t.payment,{fields:[t.paymentOnPayout.paymentId],references:[t.payment.id]})})),C=(0,l.relations)(t.achievement,({one:e})=>({user:e(t.user,{fields:[t.achievement.userId],references:[t.user.id]})})),q=(0,l.relations)(t.userGamification,({one:e})=>({user:e(t.user,{fields:[t.userGamification.userId],references:[t.user.id]})})),R=(0,l.relations)(t.familyAccount,({many:e})=>({members:e(t.familyMember),payments:e(t.familyPayment),notifications:e(t.familyNotification),activities:e(t.parentActivityLog)})),E=(0,l.relations)(t.familyMember,({one:e})=>({familyAccount:e(t.familyAccount,{fields:[t.familyMember.familyAccountId],references:[t.familyAccount.id]}),user:e(t.user,{fields:[t.familyMember.userId],references:[t.user.id]})})),L=(0,l.relations)(t.familyPayment,({one:e})=>({parent:e(t.familyAccount,{fields:[t.familyPayment.parentId],references:[t.familyAccount.id]})})),M=(0,l.relations)(t.familyNotification,({one:e})=>({parent:e(t.familyAccount,{fields:[t.familyNotification.parentId],references:[t.familyAccount.id]})})),j=(0,l.relations)(t.parentActivityLog,({one:e})=>({parent:e(t.familyAccount,{fields:[t.parentActivityLog.parentId],references:[t.familyAccount.id]})})),B=(0,l.relations)(t.payment,({one:e})=>({booking:e(t.clinicBooking,{fields:[t.payment.bookingId],references:[t.clinicBooking.id]}),enrollment:e(t.curriculumEnrollment,{fields:[t.payment.enrollmentId],references:[t.curriculumEnrollment.id]})})),$=(0,l.relations)(t.quiz,({one:e,many:i})=>({tutor:e(t.user,{fields:[t.quiz.tutorId],references:[t.user.id]}),curriculum:e(t.curriculum,{fields:[t.quiz.curriculumId],references:[t.curriculum.id]}),lesson:e(t.curriculumLesson,{fields:[t.quiz.lessonId],references:[t.curriculumLesson.id]}),attempts:i(t.quizAttempt),assignments:i(t.quizAssignment)})),Q=(0,l.relations)(t.quizAttempt,({one:e})=>({quiz:e(t.quiz,{fields:[t.quizAttempt.quizId],references:[t.quiz.id]}),student:e(t.user,{fields:[t.quizAttempt.studentId],references:[t.user.id]}),assignment:e(t.quizAssignment,{fields:[t.quizAttempt.assignmentId],references:[t.quizAssignment.id]})})),K=(0,l.relations)(t.quizAssignment,({one:e,many:i})=>({quiz:e(t.quiz,{fields:[t.quizAssignment.quizId],references:[t.quiz.id]}),tutor:e(t.user,{fields:[t.quizAssignment.assignedByTutorId],references:[t.user.id]}),attempts:i(t.quizAttempt)})),D=(0,l.relations)(t.conversation,({one:e,many:i})=>({participant1:e(t.user,{fields:[t.conversation.participant1Id],references:[t.user.id],relationName:"participant1"}),participant2:e(t.user,{fields:[t.conversation.participant2Id],references:[t.user.id],relationName:"participant2"}),messages:i(t.directMessage)})),O=(0,l.relations)(t.directMessage,({one:e})=>({conversation:e(t.conversation,{fields:[t.directMessage.conversationId],references:[t.conversation.id]}),sender:e(t.user,{fields:[t.directMessage.senderId],references:[t.user.id]})})),W=(0,l.relations)(t.generatedTask,({one:e,many:i})=>({tutor:e(t.user,{fields:[t.generatedTask.tutorId],references:[t.user.id]}),lesson:e(t.curriculumLesson,{fields:[t.generatedTask.lessonId],references:[t.curriculumLesson.id]}),submissions:i(t.taskSubmission)})),U=(0,l.relations)(t.taskSubmission,({one:e})=>({task:e(t.generatedTask,{fields:[t.taskSubmission.taskId],references:[t.generatedTask.id]}),student:e(t.user,{fields:[t.taskSubmission.studentId],references:[t.user.id]}),feedbackWorkflow:e(t.feedbackWorkflow,{fields:[t.taskSubmission.id],references:[t.feedbackWorkflow.submissionId]})})),F=(0,l.relations)(t.feedbackWorkflow,({one:e})=>({submission:e(t.taskSubmission,{fields:[t.feedbackWorkflow.submissionId],references:[t.taskSubmission.id]}),student:e(t.user,{fields:[t.feedbackWorkflow.studentId],references:[t.user.id]})})),G=(0,l.relations)(t.lessonSession,({one:e})=>({lesson:e(t.curriculumLesson,{fields:[t.lessonSession.lessonId],references:[t.curriculumLesson.id]}),student:e(t.user,{fields:[t.lessonSession.studentId],references:[t.user.id]})})),V=(0,l.relations)(t.aITutorEnrollment,({one:e})=>({student:e(t.user,{fields:[t.aITutorEnrollment.studentId],references:[t.user.id]})})),J=(0,l.relations)(t.aIInteractionSession,({one:e})=>({student:e(t.user,{fields:[t.aIInteractionSession.studentId],references:[t.user.id]})})),H=(0,l.relations)(t.aITutorDailyUsage,({one:e})=>({user:e(t.user,{fields:[t.aITutorDailyUsage.userId],references:[t.user.id]})})),Y=(0,l.relations)(t.userActivityLog,({one:e})=>({user:e(t.user,{fields:[t.userActivityLog.userId],references:[t.user.id]})}));e.s(["aIInteractionSessionRelations",0,J,"aITutorDailyUsageRelations",0,H,"aITutorEnrollmentRelations",0,V,"achievementRelations",0,C,"adminAssignmentRelations",0,m,"adminRoleRelations",0,p,"adminSessionRelations",0,c,"clinicBookingRelations",0,k,"clinicRelations",0,v,"conversationRelations",0,D,"courseBatchRelations",0,N,"curriculumEnrollmentRelations",0,f,"curriculumLessonProgressRelations",0,g,"curriculumLessonRelations",0,_,"curriculumModuleRelations",0,y,"curriculumProgressRelations",0,x,"curriculumRelations",0,h,"curriculumShareRelations",0,b,"directMessageRelations",0,O,"familyAccountRelations",0,R,"familyMemberRelations",0,E,"familyNotificationRelations",0,M,"familyPaymentRelations",0,L,"feedbackWorkflowRelations",0,F,"generatedTaskRelations",0,W,"lessonSessionRelations",0,G,"liveSessionRelations",0,w,"parentActivityLogRelations",0,j,"paymentOnPayoutRelations",0,z,"paymentRelations",0,B,"payoutRelations",0,P,"profileRelations",0,u,"quizAssignmentRelations",0,K,"quizAttemptRelations",0,Q,"quizRelations",0,$,"sessionParticipantRelations",0,S,"studentPerformanceRelations",0,I,"studyGroupMemberRelations",0,T,"studyGroupRelations",0,A,"taskSubmissionRelations",0,U,"userActivityLogRelations",0,Y,"userGamificationRelations",0,q,"userRelations",0,d],521384),e.s([],688768)},470413,e=>{"use strict";e.i(688768);var t=e.i(1638),i=e.i(257357),n=e.i(546060),s=e.i(521384);e.s(["aIAssistantInsight",()=>i.aIAssistantInsight,"aIAssistantMessage",()=>i.aIAssistantMessage,"aIAssistantSession",()=>i.aIAssistantSession,"aIInteractionSession",()=>i.aIInteractionSession,"aIInteractionSessionRelations",()=>s.aIInteractionSessionRelations,"aITutorDailyUsage",()=>i.aITutorDailyUsage,"aITutorDailyUsageRelations",()=>s.aITutorDailyUsageRelations,"aITutorEnrollment",()=>i.aITutorEnrollment,"aITutorEnrollmentRelations",()=>s.aITutorEnrollmentRelations,"aITutorSubscription",()=>i.aITutorSubscription,"account",()=>i.account,"achievement",()=>i.achievement,"achievementRelations",()=>s.achievementRelations,"adminAssignment",()=>i.adminAssignment,"adminAssignmentRelations",()=>s.adminAssignmentRelations,"adminAuditLog",()=>i.adminAuditLog,"adminRole",()=>i.adminRole,"adminRoleRelations",()=>s.adminRoleRelations,"adminSession",()=>i.adminSession,"adminSessionRelations",()=>s.adminSessionRelations,"apiKey",()=>i.apiKey,"badge",()=>i.badge,"bookmark",()=>i.bookmark,"breakoutRoom",()=>i.breakoutRoom,"breakoutRoomAssignment",()=>i.breakoutRoomAssignment,"breakoutSession",()=>i.breakoutSession,"budgetAlert",()=>i.budgetAlert,"calendarAvailability",()=>i.calendarAvailability,"calendarConnection",()=>i.calendarConnection,"calendarEvent",()=>i.calendarEvent,"calendarException",()=>i.calendarException,"clinic",()=>i.clinic,"clinicBooking",()=>i.clinicBooking,"clinicBookingRelations",()=>s.clinicBookingRelations,"clinicRelations",()=>s.clinicRelations,"contentItem",()=>i.contentItem,"contentProgress",()=>i.contentProgress,"contentQuizCheckpoint",()=>i.contentQuizCheckpoint,"conversation",()=>i.conversation,"conversationRelations",()=>s.conversationRelations,"courseBatch",()=>i.courseBatch,"courseBatchRelations",()=>s.courseBatchRelations,"curriculum",()=>i.curriculum,"curriculumCatalog",()=>i.curriculumCatalog,"curriculumEnrollment",()=>i.curriculumEnrollment,"curriculumEnrollmentRelations",()=>s.curriculumEnrollmentRelations,"curriculumLesson",()=>i.curriculumLesson,"curriculumLessonProgress",()=>i.curriculumLessonProgress,"curriculumLessonProgressRelations",()=>s.curriculumLessonProgressRelations,"curriculumLessonRelations",()=>s.curriculumLessonRelations,"curriculumModule",()=>i.curriculumModule,"curriculumModuleRelations",()=>s.curriculumModuleRelations,"curriculumProgress",()=>i.curriculumProgress,"curriculumProgressRelations",()=>s.curriculumProgressRelations,"curriculumRelations",()=>s.curriculumRelations,"curriculumShare",()=>i.curriculumShare,"curriculumShareRelations",()=>s.curriculumShareRelations,"directMessage",()=>i.directMessage,"directMessageRelations",()=>s.directMessageRelations,"emergencyContact",()=>i.emergencyContact,"engagementSnapshot",()=>i.engagementSnapshot,"eventStatusEnum",()=>t.eventStatusEnum,"eventTypeEnum",()=>t.eventTypeEnum,"familyAccount",()=>i.familyAccount,"familyAccountRelations",()=>s.familyAccountRelations,"familyBudget",()=>i.familyBudget,"familyMember",()=>i.familyMember,"familyMemberRelations",()=>s.familyMemberRelations,"familyNotification",()=>i.familyNotification,"familyNotificationRelations",()=>s.familyNotificationRelations,"familyPayment",()=>i.familyPayment,"familyPaymentRelations",()=>s.familyPaymentRelations,"featureFlag",()=>i.featureFlag,"featureFlagChange",()=>i.featureFlagChange,"feedbackWorkflow",()=>i.feedbackWorkflow,"feedbackWorkflowRelations",()=>s.feedbackWorkflowRelations,"generatedTask",()=>i.generatedTask,"generatedTaskRelations",()=>s.generatedTaskRelations,"ipWhitelist",()=>i.ipWhitelist,"leaderboardEntry",()=>i.leaderboardEntry,"lessonSession",()=>i.lessonSession,"lessonSessionRelations",()=>s.lessonSessionRelations,"libraryTask",()=>i.libraryTask,"liveSession",()=>i.liveSession,"liveSessionRelations",()=>s.liveSessionRelations,"llmModel",()=>i.llmModel,"llmProvider",()=>i.llmProvider,"llmRoutingRule",()=>i.llmRoutingRule,"mathAIInteraction",()=>i.mathAIInteraction,"mathAIInteractionTypeEnum",()=>t.mathAIInteractionTypeEnum,"mathSessionStatusEnum",()=>t.mathSessionStatusEnum,"mathWhiteboardPage",()=>i.mathWhiteboardPage,"mathWhiteboardParticipant",()=>i.mathWhiteboardParticipant,"mathWhiteboardSession",()=>i.mathWhiteboardSession,"mathWhiteboardSnapshot",()=>i.mathWhiteboardSnapshot,"message",()=>i.message,"messageSourceEnum",()=>t.messageSourceEnum,"mission",()=>i.mission,"missionProgress",()=>i.missionProgress,"note",()=>i.note,"notification",()=>i.notification,"notificationPreference",()=>i.notificationPreference,"parentActivityLog",()=>i.parentActivityLog,"parentActivityLogRelations",()=>s.parentActivityLogRelations,"parentPaymentAuthorization",()=>i.parentPaymentAuthorization,"parentSpendingLimit",()=>i.parentSpendingLimit,"payment",()=>i.payment,"paymentGatewayEnum",()=>t.paymentGatewayEnum,"paymentOnPayout",()=>i.paymentOnPayout,"paymentOnPayoutRelations",()=>s.paymentOnPayoutRelations,"paymentRelations",()=>s.paymentRelations,"paymentStatusEnum",()=>t.paymentStatusEnum,"payout",()=>i.payout,"payoutRelations",()=>s.payoutRelations,"performanceAlert",()=>i.performanceAlert,"performanceMetric",()=>i.performanceMetric,"platformRevenue",()=>i.platformRevenue,"poll",()=>i.poll,"pollOption",()=>i.pollOption,"pollResponse",()=>i.pollResponse,"pollStatusEnum",()=>t.pollStatusEnum,"pollTypeEnum",()=>t.pollTypeEnum,"postSessionReport",()=>i.postSessionReport,"profile",()=>i.profile,"profileRelations",()=>s.profileRelations,"questionBankItem",()=>i.questionBankItem,"quiz",()=>i.quiz,"quizAssignment",()=>i.quizAssignment,"quizAssignmentRelations",()=>s.quizAssignmentRelations,"quizAttempt",()=>i.quizAttempt,"quizAttemptRelations",()=>s.quizAttemptRelations,"quizRelations",()=>s.quizRelations,"refund",()=>i.refund,"refundStatusEnum",()=>t.refundStatusEnum,"resource",()=>i.resource,"resourceShare",()=>i.resourceShare,"reviewSchedule",()=>i.reviewSchedule,"roleEnum",()=>t.roleEnum,"securityEvent",()=>i.securityEvent,"session",()=>n.session,"sessionBookmark",()=>i.sessionBookmark,"sessionEngagementSummary",()=>i.sessionEngagementSummary,"sessionParticipant",()=>i.sessionParticipant,"sessionParticipantRelations",()=>s.sessionParticipantRelations,"sessionReplayArtifact",()=>i.sessionReplayArtifact,"sessionTypeEnum",()=>t.sessionTypeEnum,"studentPerformance",()=>i.studentPerformance,"studentPerformanceRelations",()=>s.studentPerformanceRelations,"studentProgressSnapshot",()=>i.studentProgressSnapshot,"studentSessionInsight",()=>i.studentSessionInsight,"studyGroup",()=>i.studyGroup,"studyGroupMember",()=>i.studyGroupMember,"studyGroupMemberRelations",()=>s.studyGroupMemberRelations,"studyGroupRelations",()=>s.studyGroupRelations,"systemSetting",()=>i.systemSetting,"taskSubmission",()=>i.taskSubmission,"taskSubmissionRelations",()=>s.taskSubmissionRelations,"tierEnum",()=>t.tierEnum,"user",()=>i.user,"userActivityLog",()=>i.userActivityLog,"userActivityLogRelations",()=>s.userActivityLogRelations,"userBadge",()=>i.userBadge,"userDailyQuest",()=>i.userDailyQuest,"userGamification",()=>i.userGamification,"userGamificationRelations",()=>s.userGamificationRelations,"userRelations",()=>s.userRelations,"verificationToken",()=>n.verificationToken,"videoWatchEvent",()=>i.videoWatchEvent,"webhookEvent",()=>i.webhookEvent,"whiteboard",()=>i.whiteboard,"whiteboardPage",()=>i.whiteboardPage,"whiteboardSession",()=>i.whiteboardSession,"whiteboardSnapshot",()=>i.whiteboardSnapshot])},738597,e=>e.a(async(t,i)=>{try{var n=e.i(13460),s=e.i(238523);e.i(688768);var o=e.i(470413),a=t([n,s]);[n,s]=a.then?(await a)():a;let r=process.env.DATABASE_POOL_URL||process.env.DIRECT_URL||process.env.DATABASE_URL;if(!r)throw Error("Missing database URL. Set DATABASE_URL, DIRECT_URL, or DATABASE_POOL_URL in .env or .env.local");let l=globalThis.drizzlePool??new s.Pool({connectionString:r,max:50,idleTimeoutMillis:3e4,connectionTimeoutMillis:5e3}),d=(0,n.drizzle)(l,{schema:o});e.s(["drizzleDb",0,d]),i()}catch(e){i(e)}},!1)];

//# debugId=bd0ffafb-da55-381b-4cb8-b572442d7165
//# sourceMappingURL=ADK_WORKSPACE_TutorMekimi_tutorme-app_6787d7f6._.js.map