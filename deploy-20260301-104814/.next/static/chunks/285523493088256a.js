;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="2ebc5f3c-1b41-1941-9a48-05a2abf162e2")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,196415,e=>{"use strict";var s=e.i(251474),t=e.i(800592),a=e.i(390553);let r=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));r.displayName="Card";let l=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...t}));l.displayName="CardHeader";let n=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("h3",{ref:r,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));n.displayName="CardTitle";let i=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("p",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",e),...t}));i.displayName="CardDescription";let d=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("p-6 pt-0",e),...t}));d.displayName="CardContent";let c=t.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",e),...t}));c.displayName="CardFooter",e.s(["Card",()=>r,"CardContent",()=>d,"CardDescription",()=>i,"CardFooter",()=>c,"CardHeader",()=>l,"CardTitle",()=>n])},462423,e=>{"use strict";let s=(0,e.i(879191).default)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);e.s(["BookOpen",()=>s],462423)},383918,e=>{"use strict";let s=(0,e.i(879191).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>s],383918)},257418,e=>{"use strict";let s=(0,e.i(879191).default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);e.s(["CreditCard",()=>s],257418)},506869,e=>{"use strict";var s=e.i(251474),t=e.i(536105),a=e.i(800592),r=e.i(151651),l=e.i(196415),n=e.i(870368),i=e.i(962825),d=e.i(383918),c=e.i(462423),o=e.i(257418),u=e.i(598320);function m(){var e,m;let h=(0,t.useParams)(),f=(0,t.useRouter)(),x=(0,t.useSearchParams)(),p="string"==typeof h.subjectCode?h.subjectCode:"",j="string"==typeof h.curriculumId?h.curriculumId:"",y=x.get("batch"),[C,g]=(0,a.useState)(null),[N,w]=(0,a.useState)(!0),[b,v]=(0,a.useState)(!1),[k,R]=(0,a.useState)(!1),[S,B]=(0,a.useState)(null),T=`/student/subjects/${encodeURIComponent(p)}/courses`,E=null!=C&&(null==C.price||0===C.price);(0,a.useEffect)(()=>{if(!j)return;let e=!1;return w(!0),B(null),fetch(`/api/curriculums/${encodeURIComponent(j)}`,{credentials:"include"}).then(e=>{if(404===e.status)throw Error("Course not found");if(!e.ok)throw Error("Failed to load course");return e.json()}).then(s=>{e||g(s)}).catch(s=>{e||B(s instanceof Error?s.message:"Failed to load course")}).finally(()=>{e||w(!1)}),()=>{e=!0}},[j]);let F=async()=>{let e=await fetch("/api/csrf",{credentials:"include"}),s=await e.json().catch(()=>({}));return s?.token??null},L=async()=>{if(C&&E){v(!0);try{let e=await F(),s=await fetch(`/api/curriculum/${encodeURIComponent(j)}/enroll`,{method:"POST",headers:{"Content-Type":"application/json",...e&&{"X-CSRF-Token":e}},credentials:"include",body:JSON.stringify(y?{batchId:y}:{})}),t=await s.json().catch(()=>({}));if(!s.ok)return void u.toast.error(t?.message??"Enrollment failed");u.toast.success("Enrolled successfully"),f.push("/student/dashboard")}catch{u.toast.error("Enrollment failed")}finally{v(!1)}}},P=async()=>{if(C&&!E){R(!0);try{let e=await F(),s=await fetch("/api/payments/create",{method:"POST",headers:{"Content-Type":"application/json",...e&&{"X-CSRF-Token":e}},credentials:"include",body:JSON.stringify({curriculumId:j})}),t=await s.json().catch(()=>({}));if(!s.ok)return void u.toast.error(t?.message??t?.error??"Could not start payment");let a=t?.checkoutUrl;if(a){window.location.href=a;return}u.toast.error("No checkout URL received")}catch{u.toast.error("Could not start payment")}finally{R(!1)}}};return N?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsx)(d.Loader2,{className:"w-8 h-8 animate-spin text-gray-400"})}):S||!C?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,s.jsxs)("div",{className:"max-w-xl mx-auto p-4 sm:p-6",children:[(0,s.jsxs)(r.default,{href:T,className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900 mb-6",children:[(0,s.jsx)(i.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to courses"]}),(0,s.jsx)(l.Card,{className:"border-destructive/50",children:(0,s.jsxs)(l.CardContent,{className:"pt-6",children:[(0,s.jsx)("p",{className:"text-sm text-destructive",children:S??"Course not found"}),(0,s.jsx)(n.Button,{variant:"outline",asChild:!0,className:"mt-4",children:(0,s.jsx)(r.default,{href:T,children:"Back to courses"})})]})})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,s.jsxs)("div",{className:"max-w-xl mx-auto p-4 sm:p-6",children:[(0,s.jsxs)(r.default,{href:T,className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900 mb-6",children:[(0,s.jsx)(i.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to courses"]}),(0,s.jsxs)(l.Card,{children:[(0,s.jsxs)(l.CardHeader,{children:[(0,s.jsxs)(l.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(c.BookOpen,{className:"w-5 h-5"}),C.name]}),(C.gradeLevel||C.difficulty)&&(0,s.jsxs)(l.CardDescription,{className:"flex flex-wrap gap-2",children:[C.gradeLevel&&(0,s.jsx)("span",{children:C.gradeLevel}),C.difficulty&&(0,s.jsx)("span",{className:"capitalize",children:C.difficulty})]})]}),(0,s.jsxs)(l.CardContent,{className:"space-y-4",children:[C.description&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:C.description}),(0,s.jsxs)("ul",{className:"text-sm text-muted-foreground space-y-1",children:[(0,s.jsxs)("li",{children:[C.estimatedHours,"h estimated"]}),(0,s.jsxs)("li",{children:[C.modulesCount," modules · ",C.lessonsCount," lessons"]}),(0,s.jsxs)("li",{className:"font-medium text-foreground",children:["Price: ",(e=C.price,m=C.currency,null==e||0===e?"Free":`${m??"SGD"} ${Number(e).toFixed(2)}`)]})]}),C.enrolled?(0,s.jsxs)("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"You're already enrolled in this course."}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)(n.Button,{asChild:!0,children:(0,s.jsx)(r.default,{href:"/student/dashboard",children:"Go to dashboard"})}),(0,s.jsx)(n.Button,{variant:"outline",asChild:!0,children:(0,s.jsx)(r.default,{href:"/student/scores",children:"My scores"})}),(0,s.jsx)(n.Button,{variant:"outline",asChild:!0,children:(0,s.jsx)(r.default,{href:`/student/subjects/${encodeURIComponent(p)}/courses/${encodeURIComponent(j)}/details`,children:"View course details"})})]})]}):E?(0,s.jsx)(n.Button,{className:"w-full sm:w-auto",onClick:L,disabled:b,children:b?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Enrolling…"]}):"Enroll"}):(0,s.jsxs)("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:[(0,s.jsxs)("p",{className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(o.CreditCard,{className:"w-4 h-4"}),"Pay & Enroll"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"You will be redirected to our secure payment page. After payment, you will be enrolled automatically."}),(0,s.jsx)(n.Button,{className:"w-full sm:w-auto",onClick:P,disabled:k,children:k?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Redirecting…"]}):"Pay & Enroll"})]})]})]})]})})}e.s(["default",()=>m])}]);

//# debugId=2ebc5f3c-1b41-1941-9a48-05a2abf162e2
//# sourceMappingURL=7e48dddd9a4b29b9.js.map