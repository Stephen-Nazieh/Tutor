{
  "version": 3,
  "sources": [],
  "debugId": "064a9e86-dee8-a0a4-881c-aba2fd0e1bc5",
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <p\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,qQAAgB,CAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC;QACC,KAAK;QACL,WAAW,IAAA,2KAAE,EACX,4DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,qQAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC;QACC,KAAK;QACL,WAAW,IAAA,2KAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,qQAAgB,CAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC;QACC,KAAK;QACL,WAAW,IAAA,2KAAE,EACX,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,qQAAgB,CAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC;QACC,KAAK;QACL,WAAW,IAAA,2KAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,qQAAgB,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC;QAAI,KAAK;QAAK,WAAW,IAAA,2KAAE,EAAC,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,qQAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC;QACC,KAAK;QACL,WAAW,IAAA,2KAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 90, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/switch.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,uBAAS,qQAAgB,CAG7B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,gSAAC,4NAAqB;QACpB,WAAW,IAAA,2KAAE,EACX,sXACA;QAED,GAAG,KAAK;QACT,KAAK;kBAEL,cAAA,gSAAC,6NAAsB;YACrB,WAAW,IAAA,2KAAE,EACX;;;;;;;;;;;AAKR,OAAO,WAAW,GAAG,4NAAqB,CAAC,WAAW"}},
    {"offset": {"line": 125, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/separator.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\n\ninterface SeparatorProps extends React.HTMLAttributes<HTMLDivElement> {\n  orientation?: \"horizontal\" | \"vertical\"\n  decorative?: boolean\n}\n\nconst Separator = React.forwardRef<HTMLDivElement, SeparatorProps>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <div\n      ref={ref}\n      role={decorative ? \"none\" : \"separator\"}\n      aria-orientation={decorative ? undefined : orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = \"Separator\"\n\nexport { Separator }\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAOA,MAAM,0BAAY,qQAAgB,CAChC,CACE,EAAE,SAAS,EAAE,cAAc,YAAY,EAAE,aAAa,IAAI,EAAE,GAAG,OAAO,EACtE,oBAEA,gSAAC;QACC,KAAK;QACL,MAAM,aAAa,SAAS;QAC5B,oBAAkB,aAAa,YAAY;QAC3C,WAAW,IAAA,2KAAE,EACX,sBACA,gBAAgB,eAAe,mBAAmB,kBAClD;QAED,GAAG,KAAK;;;;;;AAIf,UAAU,WAAW,GAAG"}},
    {"offset": {"line": 152, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/tutor/CoursePitchSection.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from '@/components/ui/dialog'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { Badge } from '@/components/ui/badge'\nimport { Sparkles, Loader2, Save, Trash2, Eye, Edit3, Wand2, PenLine } from 'lucide-react'\nimport { toast } from 'sonner'\nimport { cn } from '@/lib/utils'\n\ninterface CoursePitchSectionProps {\n  courseId: string\n}\n\nexport function CoursePitchSection({ courseId }: CoursePitchSectionProps) {\n  const [pitch, setPitch] = useState<string | null>(null)\n  const [editedPitch, setEditedPitch] = useState('')\n  const [manualPitch, setManualPitch] = useState('')\n  const [isLoading, setIsLoading] = useState(false)\n  const [isGenerating, setIsGenerating] = useState(false)\n  const [isSavingManual, setIsSavingManual] = useState(false)\n  const [showPreview, setShowPreview] = useState(false)\n  const [showEditDialog, setShowEditDialog] = useState(false)\n  const [isSaving, setIsSaving] = useState(false)\n  const [activeTab, setActiveTab] = useState<'ai' | 'manual'>(pitch ? 'ai' : 'ai')\n\n  useEffect(() => {\n    loadPitch()\n  }, [courseId])\n\n  const loadPitch = async () => {\n    setIsLoading(true)\n    try {\n      const res = await fetch(`/api/tutor/courses/${courseId}/pitch`, {\n        credentials: 'include'\n      })\n      if (res.ok) {\n        const data = await res.json()\n        setPitch(data.pitch)\n        setEditedPitch(data.pitch || '')\n        setManualPitch(data.pitch || '')\n      }\n    } catch {\n      // ignore\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const generatePitch = async () => {\n    setIsGenerating(true)\n    try {\n      const csrfRes = await fetch('/api/csrf', { credentials: 'include' })\n      const csrfData = await csrfRes.json().catch(() => ({}))\n      const csrfToken = csrfData?.token ?? null\n\n      const res = await fetch(`/api/tutor/courses/${courseId}/pitch`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(csrfToken ? { 'X-CSRF-Token': csrfToken } : {}),\n        },\n        credentials: 'include',\n      })\n\n      if (!res.ok) {\n        const data = await res.json()\n        throw new Error(data.error || 'Failed to generate pitch')\n      }\n\n      const data = await res.json()\n      setPitch(data.pitch)\n      setEditedPitch(data.pitch)\n      setManualPitch(data.pitch)\n      setActiveTab('ai')\n      toast.success('Course pitch generated successfully!')\n    } catch (error) {\n      toast.error(error instanceof Error ? error.message : 'Failed to generate pitch')\n    } finally {\n      setIsGenerating(false)\n    }\n  }\n\n  const saveManualPitch = async () => {\n    if (!manualPitch.trim()) {\n      toast.error('Please enter a pitch')\n      return\n    }\n    setIsSavingManual(true)\n    try {\n      const csrfRes = await fetch('/api/csrf', { credentials: 'include' })\n      const csrfData = await csrfRes.json().catch(() => ({}))\n      const csrfToken = csrfData?.token ?? null\n\n      const res = await fetch(`/api/tutor/courses/${courseId}/pitch`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(csrfToken ? { 'X-CSRF-Token': csrfToken } : {}),\n        },\n        credentials: 'include',\n        body: JSON.stringify({ pitch: manualPitch }),\n      })\n\n      if (!res.ok) throw new Error('Failed to save')\n\n      setPitch(manualPitch)\n      setEditedPitch(manualPitch)\n      toast.success('Course pitch saved!')\n    } catch {\n      toast.error('Failed to save pitch')\n    } finally {\n      setIsSavingManual(false)\n    }\n  }\n\n  const savePitch = async () => {\n    setIsSaving(true)\n    try {\n      const csrfRes = await fetch('/api/csrf', { credentials: 'include' })\n      const csrfData = await csrfRes.json().catch(() => ({}))\n      const csrfToken = csrfData?.token ?? null\n\n      const res = await fetch(`/api/tutor/courses/${courseId}/pitch`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(csrfToken ? { 'X-CSRF-Token': csrfToken } : {}),\n        },\n        credentials: 'include',\n        body: JSON.stringify({ pitch: editedPitch }),\n      })\n\n      if (!res.ok) throw new Error('Failed to save')\n\n      setPitch(editedPitch)\n      setManualPitch(editedPitch)\n      setShowEditDialog(false)\n      toast.success('Course pitch saved!')\n    } catch {\n      toast.error('Failed to save pitch')\n    } finally {\n      setIsSaving(false)\n    }\n  }\n\n  const deletePitch = async () => {\n    try {\n      const csrfRes = await fetch('/api/csrf', { credentials: 'include' })\n      const csrfData = await csrfRes.json().catch(() => ({}))\n      const csrfToken = csrfData?.token ?? null\n\n      const res = await fetch(`/api/tutor/courses/${courseId}/pitch`, {\n        method: 'DELETE',\n        headers: csrfToken ? { 'X-CSRF-Token': csrfToken } : {},\n        credentials: 'include',\n      })\n\n      if (!res.ok) throw new Error('Failed to delete')\n\n      setPitch(null)\n      setEditedPitch('')\n      setManualPitch('')\n      toast.success('Course pitch deleted')\n    } catch {\n      toast.error('Failed to delete pitch')\n    }\n  }\n\n  const renderMarkdown = (text: string) => {\n    return text\n      .replace(/^## (.*$)/gim, '<h2 class=\"text-xl font-bold mt-6 mb-3 text-slate-900\">$1</h2>')\n      .replace(/^### (.*$)/gim, '<h3 class=\"text-lg font-semibold mt-4 mb-2 text-slate-800\">$1</h3>')\n      .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n      .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\n      .replace(/^- (.*$)/gim, '<li class=\"ml-4 mb-1\">$1</li>')\n      .replace(/(<li.*<\\/li>\\n?)+/g, '<ul class=\"list-disc mb-4\">$&</ul>')\n      .replace(/\\n\\n/g, '<br/><br/>')\n  }\n\n  if (isLoading) {\n    return (\n      <Card className=\"mb-6\">\n        <CardContent className=\"py-8 text-center\">\n          <Loader2 className=\"h-8 w-8 animate-spin mx-auto text-muted-foreground\" />\n        </CardContent>\n      </Card>\n    )\n  }\n\n  return (\n    <>\n      <Card className={cn(\"mb-6\", pitch && \"border-green-200 bg-green-50/30\")}>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Sparkles className=\"h-5 w-5 text-amber-500\" />\n                Course Pitch\n              </CardTitle>\n              <CardDescription>\n                Create a compelling marketing description that persuades students to enroll\n              </CardDescription>\n            </div>\n            {pitch && (\n              <Badge variant=\"default\" className=\"bg-green-100 text-green-800\">\n                Saved\n              </Badge>\n            )}\n          </div>\n        </CardHeader>\n        <CardContent>\n          {!pitch ? (\n            <Tabs value={activeTab} onValueChange={(v) => setActiveTab(v as 'ai' | 'manual')}>\n              <TabsList className=\"mb-4\">\n                <TabsTrigger value=\"ai\" className=\"gap-2\">\n                  <Wand2 className=\"h-4 w-4\" />\n                  AI Generate\n                </TabsTrigger>\n                <TabsTrigger value=\"manual\" className=\"gap-2\">\n                  <PenLine className=\"h-4 w-4\" />\n                  Write My Own\n                </TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"ai\">\n                <div className=\"text-center py-8 bg-muted/30 rounded-lg\">\n                  <Wand2 className=\"h-12 w-12 text-muted-foreground mx-auto mb-4\" />\n                  <h3 className=\"text-lg font-medium mb-2\">Generate with AI</h3>\n                  <p className=\"text-muted-foreground mb-4 max-w-md mx-auto\">\n                    Let AI create a persuasive course description that highlights what students will learn, \n                    who it&apos;s for, and why they should enroll.\n                  </p>\n                  <Button \n                    onClick={generatePitch} \n                    disabled={isGenerating}\n                    size=\"lg\"\n                    className=\"gap-2\"\n                  >\n                    {isGenerating ? (\n                      <>\n                        <Loader2 className=\"h-4 w-4 animate-spin\" />\n                        Generating...\n                      </>\n                    ) : (\n                      <>\n                        <Sparkles className=\"h-4 w-4\" />\n                        Generate Course Pitch\n                      </>\n                    )}\n                  </Button>\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"manual\">\n                <div className=\"space-y-4\">\n                  <Textarea\n                    placeholder=\"Write your course pitch here... Describe what students will learn, who this course is for, and why they should enroll.\"\n                    value={manualPitch}\n                    onChange={(e) => setManualPitch(e.target.value)}\n                    rows={8}\n                    className=\"resize-none\"\n                  />\n                  <div className=\"flex justify-end\">\n                    <Button \n                      onClick={saveManualPitch}\n                      disabled={isSavingManual || !manualPitch.trim()}\n                      className=\"gap-2\"\n                    >\n                      {isSavingManual && <Loader2 className=\"h-4 w-4 animate-spin\" />}\n                      <Save className=\"h-4 w-4\" />\n                      Save Pitch\n                    </Button>\n                  </div>\n                </div>\n              </TabsContent>\n            </Tabs>\n          ) : (\n            <div className=\"space-y-4\">\n              <div className=\"bg-white rounded-lg p-4 max-h-[300px] overflow-y-auto border\">\n                <div \n                  className=\"prose prose-slate max-w-none\"\n                  dangerouslySetInnerHTML={{ __html: renderMarkdown(pitch) }}\n                />\n              </div>\n              \n              <div className=\"flex flex-wrap gap-2\">\n                <Button \n                  variant=\"outline\" \n                  onClick={() => setShowPreview(true)}\n                  className=\"gap-2\"\n                >\n                  <Eye className=\"h-4 w-4\" />\n                  Full Preview\n                </Button>\n                <Button \n                  variant=\"outline\" \n                  onClick={() => setShowEditDialog(true)}\n                  className=\"gap-2\"\n                >\n                  <Edit3 className=\"h-4 w-4\" />\n                  Edit\n                </Button>\n                <Button \n                  variant=\"outline\" \n                  onClick={generatePitch}\n                  disabled={isGenerating}\n                  className=\"gap-2\"\n                >\n                  {isGenerating ? (\n                    <Loader2 className=\"h-4 w-4 animate-spin\" />\n                  ) : (\n                    <Wand2 className=\"h-4 w-4\" />\n                  )}\n                  Regenerate with AI\n                </Button>\n                <Button \n                  variant=\"ghost\" \n                  onClick={deletePitch}\n                  className=\"gap-2 text-red-600 hover:text-red-700 hover:bg-red-50\"\n                >\n                  <Trash2 className=\"h-4 w-4\" />\n                  Delete\n                </Button>\n              </div>\n\n              <div className=\"rounded-lg border bg-amber-50 border-amber-200 p-4\">\n                <p className=\"text-sm text-amber-800\">\n                  <strong>ðŸ’¡ Tip:</strong> This pitch will be displayed on the course page for students to read. \n                  A compelling pitch can significantly increase enrollment rates!\n                </p>\n              </div>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Full Preview Dialog */}\n      <Dialog open={showPreview} onOpenChange={setShowPreview}>\n        <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>Course Pitch Preview</DialogTitle>\n            <DialogDescription>\n              This is how students will see your course pitch\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"prose prose-slate max-w-none\">\n            <div dangerouslySetInnerHTML={{ __html: renderMarkdown(pitch || '') }} />\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Edit Dialog */}\n      <Dialog open={showEditDialog} onOpenChange={setShowEditDialog}>\n        <DialogContent className=\"max-w-3xl max-h-[90vh]\">\n          <DialogHeader>\n            <DialogTitle>Edit Course Pitch</DialogTitle>\n            <DialogDescription>\n              Make adjustments to your course pitch\n            </DialogDescription>\n          </DialogHeader>\n          <Textarea\n            value={editedPitch}\n            onChange={(e) => setEditedPitch(e.target.value)}\n            rows={20}\n            className=\"font-mono text-sm\"\n          />\n          <div className=\"flex justify-end gap-2\">\n            <Button variant=\"outline\" onClick={() => setShowEditDialog(false)}>\n              Cancel\n            </Button>\n            <Button onClick={savePitch} disabled={isSaving} className=\"gap-2\">\n              {isSaving && <Loader2 className=\"h-4 w-4 animate-spin\" />}\n              <Save className=\"h-4 w-4\" />\n              Save Changes\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 926, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/lib/extract-file-text.ts"],"sourcesContent":["// @ts-nocheck\n/**\n * Extract plain text from uploaded files: .txt, .md, .pdf, .docx, and images (OCR).\n * Used by the course/subject materials upload flow.\n */\n\nexport async function extractTextFromFile(file: File): Promise<string> {\n  const name = file.name.toLowerCase()\n  const type = file.type\n\n  // Plain text\n  if (\n    type === 'text/plain' ||\n    type.startsWith('text/') ||\n    name.endsWith('.txt') ||\n    name.endsWith('.md') ||\n    name.endsWith('.markdown')\n  ) {\n    return readAsText(file)\n  }\n\n  // PDF\n  if (type === 'application/pdf' || name.endsWith('.pdf')) {\n    return extractPdfText(file)\n  }\n\n  // Word .docx\n  if (\n    type === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' ||\n    name.endsWith('.docx')\n  ) {\n    return extractDocxText(file)\n  }\n\n  // Legacy .doc - treat as binary; we could try mammoth with .doc but support is limited\n  if (name.endsWith('.doc')) {\n    try {\n      return extractDocxText(file)\n    } catch {\n      return readAsText(file).catch(() => '')\n    }\n  }\n\n  // Images: OCR\n  if (type.startsWith('image/')) {\n    return extractImageText(file)\n  }\n\n  // Fallback: try as text\n  return readAsText(file).catch(() => '')\n}\n\nfunction readAsText(file: File): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader()\n    reader.onload = () => resolve(String(reader.result ?? ''))\n    reader.onerror = () => reject(reader.error)\n    reader.readAsText(file)\n  })\n}\n\nasync function extractPdfText(file: File): Promise<string> {\n  const pdfjs = await import('pdfjs-dist')\n  // Worker must be same-origin (CSP blocks external scripts). Served from public/ via copy-pdf-worker script.\n  if (typeof window !== 'undefined') {\n    const opts = (pdfjs as { GlobalWorkerOptions?: { workerSrc?: string } }).GlobalWorkerOptions\n    if (opts && !opts.workerSrc) {\n      opts.workerSrc = '/pdf.worker.min.mjs'\n    }\n  }\n  const data = await file.arrayBuffer()\n  const doc = await pdfjs.getDocument({ data }).promise\n  const numPages = doc.numPages\n  const parts: string[] = []\n  for (let i = 1; i <= numPages; i++) {\n    const page = await doc.getPage(i)\n    const content = await page.getTextContent()\n    const pageText = content.items.map((item: { str?: string }) => (item as { str?: string }).str ?? '').join(' ')\n    parts.push(pageText)\n  }\n  return parts.join('\\n\\n').trim() || ''\n}\n\nasync function extractDocxText(file: File): Promise<string> {\n  const mammoth = await import('mammoth')\n  const arrayBuffer = await file.arrayBuffer()\n  const result = await mammoth.extractRawText({ arrayBuffer })\n  return (result.value || '').trim()\n}\n\nasync function extractImageText(file: File): Promise<string> {\n  const mod = await import('tesseract.js')\n  const api = (mod as { default?: { recognize: (image: File, lang?: string, opts?: object) => Promise<{ data: { text?: string } }> }; recognize?: (image: File, lang?: string, opts?: object) => Promise<{ data: { text?: string } }> }).default ?? mod\n  const { data } = await api.recognize(file, 'eng', { logger: () => {} })\n  return (data?.text || '').trim()\n}\n"],"names":[],"mappings":"AAAA,cAAc;AACd;;;CAGC;;;;AAEM,eAAe,oBAAoB,IAAU;IAClD,MAAM,OAAO,KAAK,IAAI,CAAC,WAAW;IAClC,MAAM,OAAO,KAAK,IAAI;IAEtB,aAAa;IACb,IACE,SAAS,gBACT,KAAK,UAAU,CAAC,YAChB,KAAK,QAAQ,CAAC,WACd,KAAK,QAAQ,CAAC,UACd,KAAK,QAAQ,CAAC,cACd;QACA,OAAO,WAAW;IACpB;IAEA,MAAM;IACN,IAAI,SAAS,qBAAqB,KAAK,QAAQ,CAAC,SAAS;QACvD,OAAO,eAAe;IACxB;IAEA,aAAa;IACb,IACE,SAAS,6EACT,KAAK,QAAQ,CAAC,UACd;QACA,OAAO,gBAAgB;IACzB;IAEA,uFAAuF;IACvF,IAAI,KAAK,QAAQ,CAAC,SAAS;QACzB,IAAI;YACF,OAAO,gBAAgB;QACzB,EAAE,OAAM;YACN,OAAO,WAAW,MAAM,KAAK,CAAC,IAAM;QACtC;IACF;IAEA,cAAc;IACd,IAAI,KAAK,UAAU,CAAC,WAAW;QAC7B,OAAO,iBAAiB;IAC1B;IAEA,wBAAwB;IACxB,OAAO,WAAW,MAAM,KAAK,CAAC,IAAM;AACtC;AAEA,SAAS,WAAW,IAAU;IAC5B,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,MAAM,SAAS,IAAI;QACnB,OAAO,MAAM,GAAG,IAAM,QAAQ,OAAO,OAAO,MAAM,IAAI;QACtD,OAAO,OAAO,GAAG,IAAM,OAAO,OAAO,KAAK;QAC1C,OAAO,UAAU,CAAC;IACpB;AACF;AAEA,eAAe,eAAe,IAAU;IACtC,MAAM,QAAQ;IACd,4GAA4G;IAC5G;;IAMA,MAAM,OAAO,MAAM,KAAK,WAAW;IACnC,MAAM,MAAM,MAAM,MAAM,WAAW,CAAC;QAAE;IAAK,GAAG,OAAO;IACrD,MAAM,WAAW,IAAI,QAAQ;IAC7B,MAAM,QAAkB,EAAE;IAC1B,IAAK,IAAI,IAAI,GAAG,KAAK,UAAU,IAAK;QAClC,MAAM,OAAO,MAAM,IAAI,OAAO,CAAC;QAC/B,MAAM,UAAU,MAAM,KAAK,cAAc;QACzC,MAAM,WAAW,QAAQ,KAAK,CAAC,GAAG,CAAC,CAAC,OAA2B,AAAC,KAA0B,GAAG,IAAI,IAAI,IAAI,CAAC;QAC1G,MAAM,IAAI,CAAC;IACb;IACA,OAAO,MAAM,IAAI,CAAC,QAAQ,IAAI,MAAM;AACtC;AAEA,eAAe,gBAAgB,IAAU;IACvC,MAAM,UAAU;IAChB,MAAM,cAAc,MAAM,KAAK,WAAW;IAC1C,MAAM,SAAS,MAAM,QAAQ,cAAc,CAAC;QAAE;IAAY;IAC1D,OAAO,CAAC,OAAO,KAAK,IAAI,EAAE,EAAE,IAAI;AAClC;AAEA,eAAe,iBAAiB,IAAU;IACxC,MAAM,MAAM;IACZ,MAAM,MAAM,AAAC,IAA0N,OAAO,IAAI;IAClP,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,SAAS,CAAC,MAAM,OAAO;QAAE,QAAQ,KAAO;IAAE;IACrE,OAAO,CAAC,MAAM,QAAQ,EAAE,EAAE,IAAI;AAChC"}}]
}