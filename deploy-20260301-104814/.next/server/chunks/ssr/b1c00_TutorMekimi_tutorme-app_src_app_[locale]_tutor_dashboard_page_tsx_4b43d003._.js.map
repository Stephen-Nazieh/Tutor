{
  "version": 3,
  "sources": [],
  "debugId": "76fbb956-0503-5242-a908-3f500c9dffd2",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/page.tsx","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/lib/format-currency.ts","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/components/StatsCards.tsx","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/components/UpcomingClassesCard.tsx","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/components/StudentsNeedingAttentionCard.tsx","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/components/AIInsightsCard.tsx","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/components/QuickActionsCard.tsx","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/components/AITeachingAssistantWidget.tsx","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/components/StudentProgressCard.tsx","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/components/RevenueDashboard.tsx","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/node_modules/zustand/esm/vanilla.mjs","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/node_modules/zustand/esm/middleware/immer.mjs","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/components/CreateClassDialog.tsx","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/ui/popover.tsx","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/components/CommunicationCenter.tsx","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/components/ModernHeroSection.tsx","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/components/GlassCard.tsx","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/components/InteractiveCalendar.tsx","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/%5Blocale%5D/tutor/dashboard/components/index.ts","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/node_modules/zustand/esm/react.mjs","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/node_modules/lucide-react/src/icons/repeat.ts","../../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/stores/communication-store.ts"],"sourcesContent":["'use client'\n\nimport { useState, useEffect, useCallback, Suspense } from 'react'\nimport { useSession } from 'next-auth/react'\nimport { useSearchParams } from 'next/navigation'\nimport Link from 'next/link'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\n\nimport { Plus, Settings, BookOpen, Library, ChevronRight, Sparkles, Video, Info, X } from 'lucide-react'\nimport { toast } from 'sonner'\n\nimport {\n  CreateClassDialog,\n  CreateCourseDialog,\n  StatsCards,\n  UpcomingClassesCard,\n  StudentsNeedingAttentionCard,\n  InteractiveCalendar,\n  type UpcomingClass,\n  type StudentNeedingAttention,\n} from './components'\nimport { StudentProgressCard } from './components/StudentProgressCard'\nimport { ModernHeroSection } from './components/ModernHeroSection'\nimport { GlassCard } from './components/GlassCard'\n\n// Loading fallback for Suspense\nfunction DashboardSkeleton() {\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-8\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        <div className=\"h-8 bg-gray-200 rounded w-1/3 animate-pulse\" />\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n          {[1, 2, 3, 4].map((i) => (\n            <div key={i} className=\"h-24 bg-gray-200 rounded animate-pulse\" />\n          ))}\n        </div>\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <div className=\"lg:col-span-2 space-y-6\">\n            <div className=\"h-64 bg-gray-200 rounded animate-pulse\" />\n          </div>\n          <div className=\"space-y-6\">\n            <div className=\"h-48 bg-gray-200 rounded animate-pulse\" />\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nconst defaultStats = {\n  totalClasses: 0,\n  totalStudents: 0,\n  upcomingClasses: 0,\n  earnings: 0,\n  currency: 'SGD' as string,\n}\n\n// Inner component that uses searchParams\nfunction TutorDashboardContent() {\n  const { data: session } = useSession()\n  const searchParams = useSearchParams()\n  const [showCreateDialog, setShowCreateDialog] = useState(false)\n  const [showCreateCourseDialog, setShowCreateCourseDialog] = useState(false)\n  \n  useEffect(() => {\n    if (searchParams.get('create') === '1') setShowCreateDialog(true)\n    if (searchParams.get('course') === '1') setShowCreateCourseDialog(true)\n  }, [searchParams])\n  const [stats, setStats] = useState(defaultStats)\n  const [classes, setClasses] = useState<UpcomingClass[]>([])\n  const [students, setStudents] = useState<StudentNeedingAttention[]>([])\n  const [allStudents, setAllStudents] = useState<Array<{ id: string; name: string; email: string; courseCount: number; classCount: number }>>([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n  const [oneAccountTipDismissed, setOneAccountTipDismissed] = useState(true)\n  useEffect(() => {\n    try {\n      setOneAccountTipDismissed(localStorage.getItem('tutor-dashboard-one-account-tip-dismissed') === '1')\n    } catch {\n      setOneAccountTipDismissed(false)\n    }\n  }, [])\n  const showOneAccountTip = !oneAccountTipDismissed\n  const dismissOneAccountTip = () => {\n    setOneAccountTipDismissed(true)\n    try {\n      localStorage.setItem('tutor-dashboard-one-account-tip-dismissed', '1')\n    } catch {}\n  }\n\n  const fetchData = useCallback(async () => {\n    if (!session?.user?.id) return\n    setError(null)\n    try {\n      const [statsRes, classesRes, studentsRes, allStudentsRes] = await Promise.allSettled([\n        fetch('/api/tutor/stats', { credentials: 'include' }),\n        fetch('/api/tutor/classes', { credentials: 'include' }),\n        fetch('/api/tutor/students-needing-attention', { credentials: 'include' }),\n        fetch('/api/tutor/students', { credentials: 'include' }),\n      ])\n\n      const failures: string[] = []\n\n      if (statsRes.status === 'fulfilled' && statsRes.value.ok) {\n        const d = await statsRes.value.json()\n        setStats({\n          totalClasses: d.totalClasses ?? 0,\n          totalStudents: d.totalStudents ?? 0,\n          upcomingClasses: d.upcomingClasses ?? 0,\n          earnings: d.earnings ?? 0,\n          currency: d.currency ?? 'SGD',\n        })\n      } else {\n        failures.push('stats')\n      }\n\n      if (classesRes.status === 'fulfilled' && classesRes.value.ok) {\n        const d = await classesRes.value.json()\n        setClasses(d.classes ?? [])\n      } else {\n        failures.push('classes')\n      }\n\n      if (studentsRes.status === 'fulfilled' && studentsRes.value.ok) {\n        const d = await studentsRes.value.json()\n        setStudents(d.students ?? [])\n      } else {\n        failures.push('students-needing-attention')\n      }\n\n      if (allStudentsRes.status === 'fulfilled' && allStudentsRes.value.ok) {\n        const d = await allStudentsRes.value.json()\n        setAllStudents(d.students ?? [])\n      } else {\n        failures.push('students')\n      }\n\n      if (failures.length >= 2) {\n        setError('Failed to load dashboard data')\n      }\n    } catch {\n      setError('Failed to load dashboard data')\n    } finally {\n      setLoading(false)\n    }\n  }, [session?.user?.id])\n\n  useEffect(() => {\n    if (session?.user?.id) {\n      setLoading(true)\n      fetchData()\n    } else {\n      setLoading(false)\n    }\n  }, [session?.user?.id, fetchData])\n\n  const handleClassCreated = useCallback((classData?: { id: string; [key: string]: unknown }) => {\n    if (classData) {\n      // Add the new class to the list immediately\n      const newClass: UpcomingClass = {\n        id: classData.id,\n        title: (classData.title as string) || 'New Class',\n        subject: (classData.subject as string) || '',\n        scheduledAt: (classData.scheduledAt as string) || new Date().toISOString(),\n        duration: (classData.durationMinutes as number) || 60,\n        maxStudents: (classData.maxStudents as number) || 50,\n        enrolledStudents: 0,\n        status: (classData.status as string) || 'scheduled',\n      }\n      setClasses(prev => [newClass, ...prev])\n      // Update stats\n      setStats(prev => ({\n        ...prev,\n        totalClasses: prev.totalClasses + 1,\n        upcomingClasses: prev.upcomingClasses + 1,\n      }))\n    } else {\n      fetchData()\n    }\n  }, [fetchData])\n\n  const handleRemoveClass = useCallback(async (classId: string) => {\n    try {\n      const csrfRes = await fetch('/api/csrf', { credentials: 'include' })\n      const csrfData = await csrfRes.json().catch(() => ({}))\n      const csrfToken = csrfData?.token ?? null\n\n      const res = await fetch(`/api/tutor/classes/${classId}`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(csrfToken && { 'X-CSRF-Token': csrfToken }),\n        },\n        credentials: 'include',\n      })\n\n      if (res.ok) {\n        setClasses(prev => prev.filter(c => c.id !== classId))\n        setStats(prev => ({\n          ...prev,\n          totalClasses: Math.max(0, prev.totalClasses - 1),\n          upcomingClasses: Math.max(0, prev.upcomingClasses - 1),\n        }))\n        toast.success('Class removed successfully')\n      } else {\n        const data = await res.json().catch(() => ({}))\n        toast.error(data.error || 'Failed to remove class')\n      }\n    } catch {\n      toast.error('Failed to remove class')\n    }\n  }, [])\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('en-US', {\n      month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit'\n    })\n  }\n\n  return (\n    <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {showOneAccountTip && (\n          <div className=\"mb-4 p-3 rounded-lg bg-slate-50 border border-slate-200 flex items-start gap-2\">\n            <Info className=\"w-4 h-4 text-slate-500 shrink-0 mt-0.5\" />\n            <p className=\"text-sm text-slate-600 flex-1\">\n              Only one account is logged in per browser. Logging in as a different user in another tab will switch the account in all tabs. To use a student account at the same time, use another browser or an incognito window.\n            </p>\n            <button type=\"button\" onClick={dismissOneAccountTip} className=\"p-1 rounded hover:bg-slate-200 text-slate-500\" aria-label=\"Dismiss\">\n              <X className=\"w-4 h-4\" />\n            </button>\n          </div>\n        )}\n        {/* Modern Hero Section */}\n        <div className=\"mb-8\">\n          <ModernHeroSection \n            stats={stats} \n            loading={loading} \n            onScheduleClass={() => setShowCreateDialog(true)}\n            onCreateCourse={() => setShowCreateCourseDialog(true)}\n          />\n        </div>\n\n        {error && (\n          <div className=\"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl text-red-800 text-sm\">\n            {error}\n            <Button variant=\"outline\" size=\"sm\" className=\"ml-2\" onClick={() => { setLoading(true); fetchData(); }}>\n              Retry\n            </Button>\n          </div>\n        )}\n\n        {/* Modern Grid Layout - Full Width */}\n        <div className=\"space-y-6\">\n            <UpcomingClassesCard\n              classes={classes}\n              formatDate={formatDate}\n              loading={loading}\n              onCreateClassClick={() => setShowCreateDialog(true)}\n              onRemoveClass={handleRemoveClass}\n            />\n            \n            <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\n              <div className=\"lg:col-span-2\">\n                <GlassCard \n                  title=\"Course Catalogue\" \n                  icon={Library}\n                  gradient=\"blue\"\n                  action={\n                    <Link href=\"/curriculum\">\n                      <Button variant=\"ghost\" size=\"sm\">\n                        View\n                        <ChevronRight className=\"w-4 h-4 ml-1\" />\n                      </Button>\n                    </Link>\n                  }\n                >\n                  <p className=\"text-sm text-gray-600 mb-4\">\n                    Browse and manage your courses. Create new courses, then configure curriculum, groups, and schedule for each.\n                  </p>\n                  <Link href=\"/curriculum\">\n                    <Button variant=\"outline\" className=\"w-full\">\n                      <Library className=\"w-4 h-4 mr-2\" />\n                      Open Course Catalogue\n                    </Button>\n                  </Link>\n                </GlassCard>\n              </div>\n\n              <div className=\"lg:col-span-2\">\n                <StudentsNeedingAttentionCard students={students} loading={loading} />\n              </div>\n            </div>\n\n            <StudentProgressCard loading={loading} students={allStudents} />\n            \n            {/* Interactive Calendar */}\n            <InteractiveCalendar \n              onEventClick={(event) => console.log('Event clicked:', event)}\n              onDateClick={(date) => console.log('Date clicked:', date)}\n              onCreateClass={(date) => setShowCreateDialog(true)}\n              loading={loading}\n            />\n\n        {/* Create Class Dialog */}\n        <CreateClassDialog\n          open={showCreateDialog}\n          onOpenChange={setShowCreateDialog}\n          onClassCreated={handleClassCreated}\n          redirectToClass={false}\n        />\n\n        {/* Create Course Dialog */}\n        <CreateCourseDialog\n          open={showCreateCourseDialog}\n          onOpenChange={setShowCreateCourseDialog}\n        />\n      </div>\n    </div>\n  )\n}\n\n// Main export wrapped in Suspense\nexport default function TutorDashboard() {\n  return (\n    <Suspense fallback={<DashboardSkeleton />}>\n      <TutorDashboardContent />\n    </Suspense>\n  )\n}\n","/**\n * Format earnings for display using the tutor's preferred currency from settings.\n */\n\nconst CURRENCY_SYMBOLS: Record<string, string> = {\n  SGD: 'S$',\n  USD: '$',\n  EUR: '€',\n  GBP: '£',\n  CNY: '¥',\n  JPY: '¥',\n}\n\n/**\n * Format an amount in the given currency code.\n * Uses symbol when known, otherwise \"CODE amount\" (e.g. \"123 AUD\").\n */\nexport function formatEarnings(amount: number, currencyCode: string): string {\n  const code = (currencyCode || 'SGD').toUpperCase()\n  const symbol = CURRENCY_SYMBOLS[code]\n  const formatted = amount.toLocaleString('en-US', {\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 2,\n  })\n  if (symbol) return `${symbol}${formatted}`\n  return `${formatted} ${code}`\n}\n","'use client'\n\nimport { Card, CardContent } from '@/components/ui/card'\nimport { Calendar, Users, DollarSign, TrendingUp } from 'lucide-react'\nimport { formatEarnings } from '@/lib/format-currency'\n\ninterface Stats {\n  totalClasses: number\n  totalStudents: number\n  upcomingClasses: number\n  earnings: number\n  /** Tutor's display currency from settings (e.g. SGD, USD). Defaults to SGD. */\n  currency?: string\n}\n\ninterface StatsCardsProps {\n  stats: Stats\n  loading?: boolean\n}\n\nfunction StatSkeleton() {\n  return (\n    <Card>\n      <CardContent className=\"p-6\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"space-y-2\">\n            <div className=\"h-4 w-20 bg-gray-200 rounded animate-pulse\" />\n            <div className=\"h-8 w-12 bg-gray-200 rounded animate-pulse\" />\n          </div>\n          <div className=\"w-12 h-12 bg-gray-200 rounded-full animate-pulse\" />\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\nexport function StatsCards({ stats, loading }: StatsCardsProps) {\n  if (loading) {\n    return (\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\n        {[1, 2, 3, 4].map((i) => <StatSkeleton key={i} />)}\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\n      <Card>\n        <CardContent className=\"p-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm text-gray-500\">Total Classes</p>\n              <p className=\"text-3xl font-bold\">{stats.totalClasses}</p>\n            </div>\n            <div className=\"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center\">\n              <Calendar className=\"w-6 h-6 text-blue-600\" />\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardContent className=\"p-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm text-gray-500\">Total Students</p>\n              <p className=\"text-3xl font-bold\">{stats.totalStudents}</p>\n            </div>\n            <div className=\"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center\">\n              <Users className=\"w-6 h-6 text-green-600\" />\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardContent className=\"p-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm text-gray-500\" title=\"Scheduled (any future date) and currently active classes\">Upcoming</p>\n              <p className=\"text-3xl font-bold\">{stats.upcomingClasses}</p>\n            </div>\n            <div className=\"w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center\">\n              <TrendingUp className=\"w-6 h-6 text-orange-600\" />\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardContent className=\"p-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm text-gray-500\">Earnings</p>\n              <p className=\"text-3xl font-bold\">{formatEarnings(stats.earnings, stats.currency ?? 'SGD')}</p>\n            </div>\n            <div className=\"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center\">\n              <DollarSign className=\"w-6 h-6 text-purple-600\" />\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n","'use client'\n\nimport Link from 'next/link'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Clock, BookOpen, Copy, Plus, Sparkles, Video, Trash2 } from 'lucide-react'\nimport { toast } from 'sonner'\nimport { formatClassTime } from '@/lib/format-class-time'\n\nexport interface UpcomingClass {\n  id: string\n  title: string\n  subject: string\n  scheduledAt: string\n  duration: number\n  maxStudents: number\n  enrolledStudents: number\n  status: string\n}\n\ninterface UpcomingClassesCardProps {\n  classes: UpcomingClass[]\n  formatDate: (dateString: string) => string\n  loading?: boolean\n  onCreateClassClick?: () => void\n  onRemoveClass?: (classId: string) => void\n}\n\nfunction copyJoinLink(classId: string) {\n  const url = typeof window !== 'undefined' ? `${window.location.origin}/tutor/live-class/${classId}` : ''\n  if (typeof navigator !== 'undefined' && navigator.clipboard?.writeText) {\n    navigator.clipboard.writeText(url).then(() => toast.success('Join link copied to clipboard'))\n  }\n}\n\nexport function UpcomingClassesCard({ classes, formatDate, loading, onCreateClassClick, onRemoveClass }: UpcomingClassesCardProps) {\n  return (\n    <Card>\n      <CardHeader className=\"flex flex-row items-center justify-between\">\n        <CardTitle className=\"flex items-center gap-2\" title=\"Scheduled and active classes\">\n          <Clock className=\"w-5 h-5 text-blue-500\" />\n          My Classes\n        </CardTitle>\n        <Link href=\"/tutor/classes\">\n          <Button variant=\"ghost\" size=\"sm\">View All</Button>\n        </Link>\n      </CardHeader>\n      <CardContent>\n        {loading ? (\n          <div className=\"space-y-4\" aria-busy=\"true\">\n            {[1, 2, 3].map((i) => (\n              <div key={i} className=\"flex items-center justify-between p-4 border rounded-lg\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-12 h-12 bg-gray-200 rounded-lg animate-pulse\" />\n                  <div className=\"space-y-2\">\n                    <div className=\"h-4 w-48 bg-gray-200 rounded animate-pulse\" />\n                    <div className=\"h-3 w-36 bg-gray-200 rounded animate-pulse\" />\n                    <div className=\"h-3 w-24 bg-gray-200 rounded animate-pulse\" />\n                  </div>\n                </div>\n                <div className=\"h-9 w-24 bg-gray-200 rounded animate-pulse\" />\n              </div>\n            ))}\n          </div>\n        ) : classes.length === 0 ? (\n          <div className=\"text-center py-8 px-4 border rounded-lg border-dashed border-gray-300 bg-gray-50/50\">\n            <p className=\"text-gray-600 mb-3\">No upcoming classes</p>\n            {onCreateClassClick && (\n              <Button onClick={onCreateClassClick}>\n                <Plus className=\"w-4 h-4 mr-2\" /> Schedule a class\n              </Button>\n            )}\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {classes.map((cls) => {\n              const time = formatClassTime(cls.scheduledAt)\n              return (\n              <div\n                key={cls.id}\n                className=\"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 transition-colors\"\n              >\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center\">\n                    <BookOpen className=\"w-6 h-6 text-blue-600\" />\n                  </div>\n                  <div>\n                    <h3 className=\"font-medium\">{cls.title}</h3>\n                    <p className=\"text-sm text-gray-500\">\n                      {cls.subject} • {time.formatted}\n                      {time.relative && (\n                        <span className=\"text-blue-600 font-medium\"> • {time.relative}</span>\n                      )}\n                    </p>\n                    <p className=\"text-xs text-gray-400\">\n                      {cls.enrolledStudents}/{cls.maxStudents} students enrolled\n                    </p>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => copyJoinLink(cls.id)}\n                    title=\"Copy join link\"\n                  >\n                    <Copy className=\"w-4 h-4\" />\n                  </Button>\n                  <Link href={`/tutor/live-class/${cls.id}`} title=\"Enter Live Class\">\n                    <Button size=\"sm\" className=\"bg-gradient-to-r from-purple-600 to-blue-600\">\n                      <Video className=\"w-4 h-4 mr-1\" />\n                      Enter Room\n                    </Button>\n                  </Link>\n                  {onRemoveClass && (\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => onRemoveClass(cls.id)}\n                      title=\"Remove class\"\n                      className=\"text-red-500 hover:text-red-700 hover:bg-red-50\"\n                    >\n                      <Trash2 className=\"w-4 h-4\" />\n                    </Button>\n                  )}\n                </div>\n              </div>\n              )\n            })}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  )\n}\n","'use client'\n\nimport { useRouter } from 'next/navigation'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\n\nexport interface StudentNeedingAttention {\n  id: string\n  name: string\n  initial: string\n  color: string\n  issue: string\n}\n\ninterface Props {\n  students: StudentNeedingAttention[]\n  loading?: boolean\n}\n\nexport function StudentsNeedingAttentionCard({ students, loading }: Props) {\n  const router = useRouter()\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>Students Needing Attention</CardTitle>\n      </CardHeader>\n      <CardContent>\n        {loading ? (\n          <div className=\"space-y-3\" aria-busy=\"true\">\n            {[1, 2, 3].map((i) => (\n              <div key={i} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-10 h-10 rounded-full bg-gray-200 animate-pulse\" />\n                  <div className=\"space-y-2\">\n                    <div className=\"h-4 w-24 bg-gray-200 rounded animate-pulse\" />\n                    <div className=\"h-3 w-40 bg-gray-200 rounded animate-pulse\" />\n                  </div>\n                </div>\n                <div className=\"h-8 w-20 bg-gray-200 rounded animate-pulse\" />\n              </div>\n            ))}\n          </div>\n        ) : students.length === 0 ? (\n          <p className=\"text-sm text-gray-500 py-4 text-center\">No students need attention right now.</p>\n        ) : (\n          <div className=\"space-y-3\">\n            {students.map((s) => (\n              <div key={s.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-10 h-10 rounded-full flex items-center justify-center font-semibold bg-gray-100 text-gray-700\">\n                    {s.initial}\n                  </div>\n                  <div>\n                    <p className=\"font-medium\">{s.name}</p>\n                    <p className=\"text-sm text-gray-600\">{s.issue}</p>\n                  </div>\n                </div>\n                <Button size=\"sm\" variant=\"outline\" onClick={() => router.push(`/tutor/reports/${s.id}`)}>\n                  View Details\n                </Button>\n              </div>\n            ))}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  )\n}\n","'use client'\n\nimport { useRouter } from 'next/navigation'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { ChevronRight } from 'lucide-react'\n\nexport function AIInsightsCard() {\n  const router = useRouter()\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>AI Insights</CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-4\">\n          <div className=\"p-3 bg-yellow-50 rounded-lg border border-yellow-200\">\n            <p className=\"text-sm font-medium text-yellow-800\">Attention Needed</p>\n            <p className=\"text-sm text-yellow-700 mt-1\">3 students struggling with systems of equations</p>\n          </div>\n          <div className=\"p-3 bg-green-50 rounded-lg border border-green-200\">\n            <p className=\"text-sm font-medium text-green-800\">Good Progress</p>\n            <p className=\"text-sm text-green-700 mt-1\">85% mastered linear equations</p>\n          </div>\n          <Button variant=\"outline\" className=\"w-full\" onClick={() => router.push('/tutor/reports')}>\n            View Full Report <ChevronRight className=\"w-4 h-4 ml-1\" />\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n","'use client'\n\nimport { useRouter } from 'next/navigation'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { BookOpen, Settings } from 'lucide-react'\n\nexport function QuickActionsCard() {\n  const router = useRouter()\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>Quick Actions</CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-2\">\n          <Button variant=\"outline\" className=\"w-full justify-start\" onClick={() => router.push('/tutor/reports')}>\n            <BookOpen className=\"w-4 h-4 mr-2\" /> View Reports\n          </Button>\n          <Button variant=\"outline\" className=\"w-full justify-start\" onClick={() => router.push('/tutor/settings')}>\n            <Settings className=\"w-4 h-4 mr-2\" /> Settings\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n","'use client'\n\nimport { useState, useEffect } from 'react'\nimport Link from 'next/link'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { ScrollArea } from '@/components/ui/scroll-area'\nimport { cn } from '@/lib/utils'\nimport { toast } from 'sonner'\nimport { \n  Sparkles, \n  Lightbulb, \n  AlertTriangle, \n  Clock, \n  BookOpen,\n  ChevronRight,\n  Check,\n  X,\n  TrendingUp,\n  Users,\n  Target,\n  Loader2,\n  MessageSquare\n} from 'lucide-react'\n\ninterface AIAssistantInsight {\n  id: string\n  type: 'lesson_idea' | 'student_analysis' | 'content_suggestion' | 'engagement_tip'\n  title: string\n  content: string\n  applied: boolean\n  createdAt: string\n}\n\ninterface AITeachingAssistantWidgetProps {\n  upcomingClass?: {\n    id: string\n    title: string\n    time: string\n    studentCount: number\n  }\n}\n\nexport function AITeachingAssistantWidget({ upcomingClass }: AITeachingAssistantWidgetProps) {\n  const [activeTab, setActiveTab] = useState<'insights' | 'chat'>('insights')\n  const [insights, setInsights] = useState<AIAssistantInsight[]>([])\n  const [loading, setLoading] = useState(true)\n  const [dismissedInsights, setDismissedInsights] = useState<string[]>([])\n  \n  // Fetch insights from API\n  useEffect(() => {\n    fetchInsights()\n  }, [])\n  \n  const fetchInsights = async () => {\n    try {\n      const res = await fetch('/api/tutor/ai-assistant/insights', {\n        credentials: 'include',\n      })\n      if (res.ok) {\n        const data = await res.json()\n        setInsights(data.insights || [])\n      }\n    } catch {\n      // Silent fail - widget shows default state\n    } finally {\n      setLoading(false)\n    }\n  }\n  \n  const markAsApplied = async (insightId: string) => {\n    try {\n      const res = await fetch(`/api/tutor/ai-assistant/insights/${insightId}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({ applied: true }),\n      })\n      \n      if (res.ok) {\n        setInsights(prev => prev.map(i => \n          i.id === insightId ? { ...i, applied: true } : i\n        ))\n        toast.success('Marked as applied')\n      }\n    } catch {\n      toast.error('Failed to update')\n    }\n  }\n  \n  const dismissInsight = (id: string) => {\n    setDismissedInsights(prev => [...prev, id])\n  }\n  \n  const visibleInsights = insights.filter(i => !dismissedInsights.includes(i.id) && !i.applied)\n  \n  const getInsightIcon = (type: string) => {\n    switch (type) {\n      case 'lesson_idea': return <Clock className=\"w-4 h-4 text-blue-500\" />\n      case 'student_analysis': return <Users className=\"w-4 h-4 text-orange-500\" />\n      case 'content_suggestion': return <BookOpen className=\"w-4 h-4 text-green-500\" />\n      case 'engagement_tip': return <Target className=\"w-4 h-4 text-purple-500\" />\n      default: return <Sparkles className=\"w-4 h-4 text-blue-500\" />\n    }\n  }\n  \n  const getTypeLabel = (type: string) => {\n    switch (type) {\n      case 'lesson_idea': return 'Lesson Idea'\n      case 'student_analysis': return 'Student Insight'\n      case 'content_suggestion': return 'Content'\n      case 'engagement_tip': return 'Engagement'\n      default: return 'Insight'\n    }\n  }\n  \n  if (loading) {\n    return (\n      <Card className=\"h-full flex flex-col\">\n        <CardContent className=\"flex-1 flex items-center justify-center\">\n          <Loader2 className=\"h-6 w-6 animate-spin text-blue-500\" />\n        </CardContent>\n      </Card>\n    )\n  }\n  \n  return (\n    <Card className=\"h-full flex flex-col\">\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-8 h-8 bg-gradient-to-br from-purple-500 to-blue-500 rounded-lg flex items-center justify-center\">\n              <Sparkles className=\"w-4 h-4 text-white\" />\n            </div>\n            <div>\n              <CardTitle className=\"text-sm font-medium\">AI Teaching Assistant</CardTitle>\n              <p className=\"text-xs text-gray-500\">Personalized insights & guidance</p>\n            </div>\n          </div>\n          {visibleInsights.length > 0 && (\n            <Badge variant=\"destructive\" className=\"text-xs\">\n              {visibleInsights.length}\n            </Badge>\n          )}\n        </div>\n        \n        {/* Tabs */}\n        <div className=\"flex gap-1 mt-3\">\n          <Button\n            variant={activeTab === 'insights' ? 'default' : 'ghost'}\n            size=\"sm\"\n            className=\"flex-1 text-xs\"\n            onClick={() => setActiveTab('insights')}\n          >\n            <Lightbulb className=\"w-3 h-3 mr-1\" />\n            Insights\n          </Button>\n          <Link href=\"/tutor/ai-assistant\" className=\"flex-1\">\n            <Button\n              variant={activeTab === 'chat' ? 'default' : 'ghost'}\n              size=\"sm\"\n              className=\"w-full text-xs\"\n            >\n              <MessageSquare className=\"w-3 h-3 mr-1\" />\n              Chat\n            </Button>\n          </Link>\n        </div>\n      </CardHeader>\n      \n      <CardContent className=\"p-0\">\n        <div className=\"px-4 pb-4\">\n          {visibleInsights.length === 0 ? (\n            <div className=\"text-center py-8\">\n              <Check className=\"w-10 h-10 text-green-500 mx-auto mb-2\" />\n              <p className=\"text-sm text-gray-600 font-medium\">All caught up!</p>\n              <p className=\"text-xs text-gray-400\">No new insights. Start a chat for personalized help.</p>\n              <Link href=\"/tutor/ai-assistant\">\n                <Button size=\"sm\" className=\"mt-3 gap-2\">\n                  <Sparkles className=\"w-4 h-4\" />\n                  Ask AI Assistant\n                </Button>\n              </Link>\n            </div>\n          ) : (\n            <ScrollArea className=\"h-[300px]\">\n              <div className=\"space-y-3\">\n                {visibleInsights.slice(0, 5).map((insight) => (\n                  <div\n                    key={insight.id}\n                    className=\"p-3 rounded-lg border border-gray-200 bg-white shadow-sm\"\n                  >\n                    <div className=\"flex items-start gap-3\">\n                      {getInsightIcon(insight.type)}\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center gap-2\">\n                            <span className=\"font-medium text-sm\">{insight.title}</span>\n                            <Badge variant=\"secondary\" className=\"text-xs\">\n                              {getTypeLabel(insight.type)}\n                            </Badge>\n                          </div>\n                          <Button \n                            size=\"icon\" \n                            variant=\"ghost\" \n                            className=\"h-6 w-6 -mr-1\"\n                            onClick={() => dismissInsight(insight.id)}\n                          >\n                            <X className=\"w-3 h-3\" />\n                          </Button>\n                        </div>\n                        <p className=\"text-sm text-gray-600 mt-1 line-clamp-3\">{insight.content}</p>\n                        \n                        <div className=\"flex gap-2 mt-2\">\n                          <Button \n                            size=\"sm\" \n                            variant=\"outline\" \n                            className=\"text-xs\"\n                            onClick={() => markAsApplied(insight.id)}\n                          >\n                            <Check className=\"w-3 h-3 mr-1\" />\n                            Apply\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n                \n                {visibleInsights.length > 5 && (\n                  <Link href=\"/tutor/ai-assistant\">\n                    <Button variant=\"ghost\" className=\"w-full text-xs\">\n                      View {visibleInsights.length - 5} more insights\n                      <ChevronRight className=\"w-3 h-3 ml-1\" />\n                    </Button>\n                  </Link>\n                )}\n              </div>\n            </ScrollArea>\n          )}\n          \n          {/* Quick Stats */}\n          <div className=\"grid grid-cols-2 gap-2 mt-4\">\n            <div className=\"p-3 bg-blue-50 rounded-lg\">\n              <div className=\"flex items-center gap-2 mb-1\">\n                <TrendingUp className=\"w-4 h-4 text-blue-600\" />\n                <span className=\"text-xs text-blue-600 font-medium\">AI Chats</span>\n              </div>\n              <p className=\"text-lg font-bold text-blue-800\">{insights.length > 0 ? 'Active' : 'Start'}</p>\n              <p className=\"text-xs text-blue-600\">\n                {insights.length} insights generated\n              </p>\n            </div>\n            <Link href=\"/tutor/ai-assistant\">\n              <div className=\"p-3 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors cursor-pointer\">\n                <div className=\"flex items-center gap-2 mb-1\">\n                  <MessageSquare className=\"w-4 h-4 text-purple-600\" />\n                  <span className=\"text-xs text-purple-600 font-medium\">Chat Now</span>\n                </div>\n                <p className=\"text-lg font-bold text-purple-800\">Ask AI</p>\n                <p className=\"text-xs text-purple-600\">Get personalized help →</p>\n              </div>\n            </Link>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n","'use client'\n\nimport { useEffect, useMemo, useState } from 'react'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Badge } from '@/components/ui/badge'\nimport { Button } from '@/components/ui/button'\nimport { Progress } from '@/components/ui/progress'\nimport { Input } from '@/components/ui/input'\nimport { TrendingUp, Search, ExternalLink, AlertTriangle } from 'lucide-react'\nimport { useRouter } from 'next/navigation'\n\ninterface TutorStudent {\n  id: string\n  name: string\n  email: string\n  courseCount: number\n  classCount: number\n}\n\ninterface StudentProgressRow {\n  studentId: string\n  overallProgress: number\n  engagementRate: number\n  assignmentCompletion: number\n  averageScore: number\n  recentRisk: 'low' | 'medium' | 'high'\n}\n\ninterface StudentProgressCardProps {\n  students?: TutorStudent[]\n  loading?: boolean\n}\n\nconst getRiskBadge = (risk: StudentProgressRow['recentRisk']) => {\n  if (risk === 'high') return <Badge variant=\"destructive\">Needs attention</Badge>\n  if (risk === 'medium') return <Badge variant=\"secondary\">Watch</Badge>\n  return <Badge variant=\"outline\">Stable</Badge>\n}\n\nexport function StudentProgressCard({ students = [], loading }: StudentProgressCardProps) {\n  const router = useRouter()\n  const [searchQuery, setSearchQuery] = useState('')\n  const [progressRows, setProgressRows] = useState<Record<string, StudentProgressRow>>({})\n  const [loadingProgress, setLoadingProgress] = useState(false)\n\n  useEffect(() => {\n    let active = true\n    const loadProgress = async () => {\n      if (students.length === 0) {\n        setProgressRows({})\n        return\n      }\n\n      setLoadingProgress(true)\n      try {\n        const res = await fetch('/api/tutor/dashboard/student-progress', { credentials: 'include' })\n        if (!res.ok) return\n        const data = await res.json()\n        const rows = Array.isArray(data.students) ? data.students : []\n        if (!active) return\n        const next: Record<string, StudentProgressRow> = {}\n        for (const row of rows) {\n          if (typeof row?.studentId !== 'string') continue\n          next[row.studentId] = row as StudentProgressRow\n        }\n        setProgressRows(next)\n      } catch {\n        // Non-fatal: base roster still renders.\n      } finally {\n        if (active) setLoadingProgress(false)\n      }\n    }\n\n    loadProgress()\n    return () => {\n      active = false\n    }\n  }, [students])\n\n  const filtered = useMemo(() => {\n    const query = searchQuery.trim().toLowerCase()\n    if (!query) return students\n    return students.filter((s) => s.name.toLowerCase().includes(query) || s.email.toLowerCase().includes(query))\n  }, [searchQuery, students])\n\n  const summary = useMemo(() => {\n    const rows = students\n      .map((s) => progressRows[s.id])\n      .filter((r): r is StudentProgressRow => Boolean(r))\n    if (rows.length === 0) {\n      return { avgProgress: 0, avgEngagement: 0, riskCount: 0 }\n    }\n    return {\n      avgProgress: Math.round(rows.reduce((sum, r) => sum + r.overallProgress, 0) / rows.length),\n      avgEngagement: Math.round(rows.reduce((sum, r) => sum + r.engagementRate, 0) / rows.length),\n      riskCount: rows.filter((r) => r.recentRisk === 'high').length,\n    }\n  }, [students, progressRows])\n\n  if (loading) {\n    return (\n      <Card>\n        <CardContent className=\"p-6\">\n          <div className=\"space-y-4\">\n            {[1, 2, 3].map((i) => (\n              <div key={i} className=\"h-20 bg-gray-100 rounded animate-pulse\" />\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  return (\n    <Card>\n      <CardHeader className=\"space-y-3\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-base flex items-center gap-2\">\n            <TrendingUp className=\"w-5 h-5 text-blue-500\" />\n            Student Progress\n          </CardTitle>\n          {summary.riskCount > 0 && (\n            <Badge variant=\"destructive\" className=\"gap-1\">\n              <AlertTriangle className=\"w-3 h-3\" />\n              {summary.riskCount} at risk\n            </Badge>\n          )}\n        </div>\n        <div className=\"grid grid-cols-3 gap-2 text-center\">\n          <div className=\"rounded-lg bg-blue-50 p-2\">\n            <p className=\"text-lg font-bold text-blue-700\">{summary.avgProgress}%</p>\n            <p className=\"text-xs text-blue-600\">Avg progress</p>\n          </div>\n          <div className=\"rounded-lg bg-green-50 p-2\">\n            <p className=\"text-lg font-bold text-green-700\">{summary.avgEngagement}%</p>\n            <p className=\"text-xs text-green-600\">Engagement</p>\n          </div>\n          <div className=\"rounded-lg bg-purple-50 p-2\">\n            <p className=\"text-lg font-bold text-purple-700\">{students.length}</p>\n            <p className=\"text-xs text-purple-600\">Students</p>\n          </div>\n        </div>\n        <div className=\"relative\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n          <Input\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            placeholder=\"Search students\"\n            className=\"pl-9\"\n          />\n        </div>\n      </CardHeader>\n      <CardContent className=\"space-y-3\">\n        {filtered.length === 0 ? (\n          <p className=\"text-sm text-muted-foreground py-6 text-center\">No students found.</p>\n        ) : (\n          filtered.map((student) => {\n            const row = progressRows[student.id]\n            return (\n              <div key={student.id} className=\"rounded-lg border p-3 space-y-2\">\n                <div className=\"flex items-center justify-between gap-2\">\n                  <div className=\"min-w-0\">\n                    <p className=\"font-medium truncate\">{student.name}</p>\n                    <p className=\"text-xs text-muted-foreground truncate\">{student.email}</p>\n                  </div>\n                  {row ? getRiskBadge(row.recentRisk) : <Badge variant=\"outline\">No metrics yet</Badge>}\n                </div>\n                <div className=\"space-y-1\">\n                  <div className=\"flex justify-between text-xs text-muted-foreground\">\n                    <span>Progress</span>\n                    <span>{row?.overallProgress ?? 0}%</span>\n                  </div>\n                  <Progress value={row?.overallProgress ?? 0} className=\"h-2\" />\n                </div>\n                <div className=\"flex items-center justify-between text-xs text-muted-foreground\">\n                  <span>Courses: {student.courseCount}</span>\n                  <span>Classes: {student.classCount}</span>\n                  <span>Score: {row?.averageScore ?? 0}%</span>\n                </div>\n                <div className=\"flex justify-end\">\n                  <Button size=\"sm\" variant=\"outline\" onClick={() => router.push(`/tutor/reports/${student.id}`)}>\n                    <ExternalLink className=\"h-3.5 w-3.5 mr-1\" />\n                    Open Report\n                  </Button>\n                </div>\n              </div>\n            )\n          })\n        )}\n        {loadingProgress && <p className=\"text-xs text-muted-foreground\">Refreshing metrics…</p>}\n      </CardContent>\n    </Card>\n  )\n}\n","'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { ScrollArea } from '@/components/ui/scroll-area'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from '@/components/ui/dialog'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { toast } from 'sonner'\nimport { cn } from '@/lib/utils'\nimport {\n  DollarSign,\n  TrendingUp,\n  TrendingDown,\n  Users,\n  Calendar,\n  CreditCard,\n  Wallet,\n  ArrowUpRight,\n  ArrowDownRight,\n  Clock,\n  BarChart3,\n  PieChart,\n  Download,\n  Eye,\n  ChevronRight,\n  Mail,\n  Send\n} from 'lucide-react'\n\ninterface RevenueDashboardProps {\n  compact?: boolean\n  defaultTab?: 'overview' | 'earnings' | 'courses' | 'analytics'\n  externalEmailDialogOpen?: boolean\n  onExternalEmailDialogChange?: (open: boolean) => void\n}\n\ninterface EarningRecord {\n  id: string\n  date: string\n  description: string\n  amount: number\n  type: 'class' | 'course' | 'refund' | 'payout'\n  status: 'completed' | 'pending' | 'processing'\n  studentName?: string\n}\n\ninterface CoursePerformance {\n  id: string\n  name: string\n  enrollments: number\n  revenue: number\n  conversionRate: number\n  rating: number\n}\n\ninterface TimeSlotPopularity {\n  slot: string\n  bookings: number\n  revenue: number\n}\n\n// Demo data\nconst generateDemoEarnings = (): EarningRecord[] => [\n  { id: '1', date: '2026-02-15', description: 'Advanced Mathematics Class', amount: 150, type: 'class', status: 'completed', studentName: 'Alice Zhang' },\n  { id: '2', date: '2026-02-14', description: 'Physics 101 Course Sale', amount: 299, type: 'course', status: 'completed' },\n  { id: '3', date: '2026-02-13', description: 'English Literature Class', amount: 120, type: 'class', status: 'completed', studentName: 'Bob Li' },\n  { id: '4', date: '2026-02-12', description: 'Refund - Cancelled Class', amount: -150, type: 'refund', status: 'completed', studentName: 'Carol Wang' },\n  { id: '5', date: '2026-02-10', description: 'Monthly Payout', amount: -1200, type: 'payout', status: 'completed' },\n  { id: '6', date: '2026-02-09', description: 'Chemistry Tutoring', amount: 180, type: 'class', status: 'completed', studentName: 'David Chen' },\n  { id: '7', date: '2026-02-08', description: 'Math Course Bundle', amount: 499, type: 'course', status: 'completed' },\n  { id: '8', date: '2026-02-07', description: 'Private Session', amount: 200, type: 'class', status: 'pending', studentName: 'Emma Liu' },\n]\n\nconst generateDemoCoursePerformance = (): CoursePerformance[] => [\n  { id: '1', name: 'Advanced Mathematics', enrollments: 45, revenue: 13455, conversionRate: 12.5, rating: 4.8 },\n  { id: '2', name: 'Physics 101', enrollments: 32, revenue: 9568, conversionRate: 8.3, rating: 4.6 },\n  { id: '3', name: 'English Literature', enrollments: 28, revenue: 5544, conversionRate: 6.7, rating: 4.9 },\n  { id: '4', name: 'Chemistry Basics', enrollments: 18, revenue: 5382, conversionRate: 5.2, rating: 4.4 },\n]\n\nconst generateDemoTimeSlots = (): TimeSlotPopularity[] => [\n  { slot: 'Mon-Fri 6-8 PM', bookings: 45, revenue: 6750 },\n  { slot: 'Sat-Sun 10-12 AM', bookings: 38, revenue: 5700 },\n  { slot: 'Mon-Fri 4-6 PM', bookings: 32, revenue: 4800 },\n  { slot: 'Sat-Sun 2-4 PM', bookings: 28, revenue: 4200 },\n  { slot: 'Weekday Mornings', bookings: 15, revenue: 2250 },\n]\n\n// Email Dialog Component\ninterface EmailStatementDialogProps {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  emailAddress: string\n  setEmailAddress: (email: string) => void\n  sendingEmail: boolean\n  onSend: () => void\n}\n\nfunction EmailStatementDialog({\n  open,\n  onOpenChange,\n  emailAddress,\n  setEmailAddress,\n  sendingEmail,\n  onSend\n}: EmailStatementDialogProps) {\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-md\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Mail className=\"w-5 h-5\" />\n            Email Statement\n          </DialogTitle>\n          <DialogDescription>\n            Send your revenue statement to any email address. The statement will include all transactions for the current period.\n          </DialogDescription>\n        </DialogHeader>\n        <div className=\"space-y-4 py-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"email\">Email Address</Label>\n            <Input\n              id=\"email\"\n              type=\"email\"\n              placeholder=\"Enter email address...\"\n              value={emailAddress}\n              onChange={(e) => setEmailAddress(e.target.value)}\n              onKeyDown={(e) => e.key === 'Enter' && onSend()}\n            />\n          </div>\n          <div className=\"p-3 bg-gray-50 rounded-lg text-sm\">\n            <p className=\"font-medium text-gray-700\">Statement will include:</p>\n            <ul className=\"mt-2 space-y-1 text-gray-600\">\n              <li>• Transaction history</li>\n              <li>• Revenue summary</li>\n              <li>• Course performance metrics</li>\n              <li>• Tax information (if applicable)</li>\n            </ul>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\n            Cancel\n          </Button>\n          <Button\n            onClick={onSend}\n            disabled={sendingEmail}\n            className=\"bg-gradient-to-r from-purple-600 to-blue-600\"\n          >\n            {sendingEmail ? (\n              <>\n                <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2\" />\n                Sending...\n              </>\n            ) : (\n              <>\n                <Send className=\"w-4 h-4 mr-2\" />\n                Send Statement\n              </>\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nexport function RevenueDashboard({\n  compact = false,\n  defaultTab = 'overview',\n  externalEmailDialogOpen,\n  onExternalEmailDialogChange\n}: RevenueDashboardProps) {\n  const router = useRouter()\n  const [activeTab, setActiveTab] = useState(defaultTab)\n  const [earnings] = useState<EarningRecord[]>(generateDemoEarnings())\n  const [courses] = useState<CoursePerformance[]>(generateDemoCoursePerformance())\n  const [timeSlots] = useState<TimeSlotPopularity[]>(generateDemoTimeSlots())\n  const [internalShowEmailDialog, setInternalShowEmailDialog] = useState(false)\n  const [emailAddress, setEmailAddress] = useState('')\n  const [sendingEmail, setSendingEmail] = useState(false)\n\n  // Use external dialog state if provided, otherwise use internal\n  const showEmailDialog = externalEmailDialogOpen !== undefined ? externalEmailDialogOpen : internalShowEmailDialog\n  const setShowEmailDialog = (open: boolean) => {\n    if (onExternalEmailDialogChange) {\n      onExternalEmailDialogChange(open)\n    }\n    setInternalShowEmailDialog(open)\n  }\n\n  // Calculate metrics\n  const totalRevenue = earnings\n    .filter(e => e.type !== 'payout' && e.type !== 'refund')\n    .reduce((sum, e) => sum + e.amount, 0)\n\n  const pendingAmount = earnings\n    .filter(e => e.status === 'pending')\n    .reduce((sum, e) => sum + e.amount, 0)\n\n  const availableBalance = totalRevenue - earnings\n    .filter(e => e.type === 'payout')\n    .reduce((sum, e) => sum + Math.abs(e.amount), 0)\n\n  const thisMonthRevenue = earnings\n    .filter(e => e.date.startsWith('2026-02') && e.type !== 'payout' && e.type !== 'refund')\n    .reduce((sum, e) => sum + e.amount, 0)\n\n  const lastMonthRevenue = 8500 // Demo comparison\n  const revenueChange = ((thisMonthRevenue - lastMonthRevenue) / lastMonthRevenue) * 100\n\n  const totalBookings = earnings.filter(e => e.type === 'class').length\n  const avgBookingValue = totalBookings > 0 ? Math.round(totalRevenue / totalBookings) : 0\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('en-SG', { style: 'currency', currency: 'SGD' }).format(amount)\n  }\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\n  }\n\n  const getStatusBadge = (status: string) => {\n    switch (status) {\n      case 'completed': return <Badge variant=\"default\" className=\"bg-green-600\">Completed</Badge>\n      case 'pending': return <Badge variant=\"outline\" className=\"text-yellow-600 border-yellow-600\">Pending</Badge>\n      case 'processing': return <Badge variant=\"outline\" className=\"text-blue-600 border-blue-600\">Processing</Badge>\n      default: return <Badge variant=\"secondary\">{status}</Badge>\n    }\n  }\n\n  const getTypeIcon = (type: string) => {\n    switch (type) {\n      case 'class': return <Calendar className=\"w-4 h-4 text-blue-500\" />\n      case 'course': return <BarChart3 className=\"w-4 h-4 text-purple-500\" />\n      case 'refund': return <ArrowDownRight className=\"w-4 h-4 text-red-500\" />\n      case 'payout': return <Wallet className=\"w-4 h-4 text-orange-500\" />\n      default: return <DollarSign className=\"w-4 h-4 text-gray-500\" />\n    }\n  }\n\n  const handleSendEmail = async () => {\n    if (!emailAddress.trim() || !emailAddress.includes('@')) {\n      toast.error('Please enter a valid email address')\n      return\n    }\n    setSendingEmail(true)\n    // Simulate API call\n    await new Promise(resolve => setTimeout(resolve, 1500))\n    toast.success(`Statement sent to ${emailAddress}`)\n    setSendingEmail(false)\n    setShowEmailDialog(false)\n    setEmailAddress('')\n  }\n\n  if (compact) {\n    return (\n      <>\n        <Card className=\"h-full\">\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <DollarSign className=\"w-5 h-5 text-green-500\" />\n                <CardTitle className=\"text-base\">Revenue</CardTitle>\n              </div>\n              <Button variant=\"ghost\" size=\"sm\" onClick={() => router.push('/tutor/revenue')}>\n                View All\n                <ChevronRight className=\"w-4 h-4 ml-1\" />\n              </Button>\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-2xl font-bold\">{formatCurrency(availableBalance)}</p>\n                  <p className=\"text-xs text-gray-500\">Available Balance</p>\n                </div>\n                <div className=\"text-right\">\n                  <div className=\"flex items-center gap-1 text-green-600\">\n                    <TrendingUp className=\"w-4 h-4\" />\n                    <span className=\"text-sm font-medium\">+{revenueChange.toFixed(1)}%</span>\n                  </div>\n                  <p className=\"text-xs text-gray-500\">vs last month</p>\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-3\">\n                <div className=\"p-3 bg-gray-50 rounded-lg\">\n                  <p className=\"text-lg font-bold\">{totalBookings}</p>\n                  <p className=\"text-xs text-gray-500\">Bookings</p>\n                </div>\n                <div className=\"p-3 bg-gray-50 rounded-lg\">\n                  <p className=\"text-lg font-bold\">{formatCurrency(avgBookingValue)}</p>\n                  <p className=\"text-xs text-gray-500\">Avg Value</p>\n                </div>\n              </div>\n\n              {pendingAmount > 0 && (\n                <div className=\"p-3 bg-yellow-50 rounded-lg border border-yellow-200\">\n                  <p className=\"text-sm text-yellow-800\">\n                    <Clock className=\"w-4 h-4 inline mr-1\" />\n                    {formatCurrency(pendingAmount)} pending clearance\n                  </p>\n                </div>\n              )}\n\n              <div className=\"space-y-2\">\n                <Button className=\"w-full\" variant=\"outline\" onClick={() => router.push('/tutor/revenue')}>\n                  <TrendingUp className=\"w-4 h-4 mr-2\" />\n                  Revenue & Analytics\n                </Button>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  <Button className=\"w-full\" variant=\"outline\" size=\"sm\">\n                    <Download className=\"w-4 h-4 mr-1\" />\n                    Download\n                  </Button>\n                  <Button\n                    className=\"w-full\"\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setShowEmailDialog(true)}\n                  >\n                    <Mail className=\"w-4 h-4 mr-1\" />\n                    Email\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n        <EmailStatementDialog\n          open={showEmailDialog}\n          onOpenChange={setShowEmailDialog}\n          emailAddress={emailAddress}\n          setEmailAddress={setEmailAddress}\n          sendingEmail={sendingEmail}\n          onSend={handleSendEmail}\n        />\n      </>\n    )\n\n    return (\n      <>\n        <Card className=\"h-full flex flex-col\">\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <DollarSign className=\"w-5 h-5 text-green-500\" />\n                <CardTitle className=\"text-base\">Revenue & Business</CardTitle>\n              </div>\n              <div className=\"flex items-center gap-1\">\n                <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowEmailDialog(true)}>\n                  <Mail className=\"w-4 h-4 mr-1\" />\n                  Email\n                </Button>\n                <Button variant=\"ghost\" size=\"sm\">\n                  <Download className=\"w-4 h-4 mr-1\" />\n                  Export\n                </Button>\n              </div>\n            </div>\n\n            {/* Summary Cards */}\n            <div className=\"grid grid-cols-2 gap-3 mt-3\">\n              <div className=\"p-3 bg-green-50 rounded-lg\">\n                <p className=\"text-xs text-green-600 mb-1\">Available Balance</p>\n                <p className=\"text-xl font-bold text-green-800\">{formatCurrency(availableBalance)}</p>\n              </div>\n              <div className=\"p-3 bg-blue-50 rounded-lg\">\n                <p className=\"text-xs text-blue-600 mb-1\">This Month</p>\n                <div className=\"flex items-center gap-2\">\n                  <p className=\"text-xl font-bold text-blue-800\">{formatCurrency(thisMonthRevenue)}</p>\n                  <Badge variant={revenueChange >= 0 ? 'default' : 'destructive'} className=\"text-xs\">\n                    {revenueChange >= 0 ? '+' : ''}{revenueChange.toFixed(0)}%\n                  </Badge>\n                </div>\n              </div>\n            </div>\n\n            {/* Tabs */}\n            <Tabs value={activeTab} onValueChange={setActiveTab as any} className=\"mt-4\">\n              <TabsList className=\"grid w-full grid-cols-4\">\n                <TabsTrigger value=\"overview\" className=\"text-xs\">Overview</TabsTrigger>\n                <TabsTrigger value=\"earnings\" className=\"text-xs\">Earnings</TabsTrigger>\n                <TabsTrigger value=\"courses\" className=\"text-xs\">Courses</TabsTrigger>\n                <TabsTrigger value=\"analytics\" className=\"text-xs\">Analytics</TabsTrigger>\n              </TabsList>\n            </Tabs>\n          </CardHeader>\n\n          <CardContent className=\"flex-1 p-0\">\n            <ScrollArea className=\"h-[calc(100%-180px)]\">\n              <div className=\"px-4 pb-4\">\n                {activeTab === 'overview' && (\n                  <div className=\"space-y-4\">\n                    {/* Key Metrics */}\n                    <div className=\"grid grid-cols-2 gap-3\">\n                      <div className=\"p-3 bg-gray-50 rounded-lg text-center\">\n                        <p className=\"text-lg font-bold\">{totalBookings}</p>\n                        <p className=\"text-xs text-gray-500\">Total Bookings</p>\n                      </div>\n                      <div className=\"p-3 bg-gray-50 rounded-lg text-center\">\n                        <p className=\"text-lg font-bold\">{formatCurrency(avgBookingValue)}</p>\n                        <p className=\"text-xs text-gray-500\">Avg Booking Value</p>\n                      </div>\n                      <div className=\"p-3 bg-gray-50 rounded-lg text-center\">\n                        <p className=\"text-lg font-bold\">{courses.length}</p>\n                        <p className=\"text-xs text-gray-500\">Active Courses</p>\n                      </div>\n                      <div className=\"p-3 bg-gray-50 rounded-lg text-center\">\n                        <p className=\"text-lg font-bold\">4.7</p>\n                        <p className=\"text-xs text-gray-500\">Avg Rating</p>\n                      </div>\n                    </div>\n\n                    {/* Recent Earnings */}\n                    <div>\n                      <h3 className=\"text-sm font-medium mb-2\">Recent Transactions</h3>\n                      <div className=\"space-y-2\">\n                        {earnings.slice(0, 5).map((earning) => (\n                          <div key={earning.id} className=\"flex items-center justify-between p-2 bg-gray-50 rounded\">\n                            <div className=\"flex items-center gap-2\">\n                              {getTypeIcon(earning.type)}\n                              <div>\n                                <p className=\"text-sm font-medium\">{earning.description}</p>\n                                <p className=\"text-xs text-gray-500\">{formatDate(earning.date)}</p>\n                              </div>\n                            </div>\n                            <div className=\"text-right\">\n                              <p className={cn(\n                                \"text-sm font-medium\",\n                                earning.amount < 0 ? \"text-red-600\" : \"text-green-600\"\n                              )}>\n                                {earning.amount < 0 ? '' : '+'}{formatCurrency(earning.amount)}\n                              </p>\n                              {getStatusBadge(earning.status)}\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n\n                    {/* Payout Button */}\n                    {availableBalance > 0 && (\n                      <Button className=\"w-full bg-gradient-to-r from-green-600 to-emerald-600\">\n                        <Wallet className=\"w-4 h-4 mr-2\" />\n                        Request Payout ({formatCurrency(availableBalance)})\n                      </Button>\n                    )}\n                  </div>\n                )}\n\n                {activeTab === 'earnings' && (\n                  <div className=\"space-y-3\">\n                    {earnings.map((earning) => (\n                      <div key={earning.id} className=\"p-3 border rounded-lg\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex items-start gap-3\">\n                            <div className=\"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center\">\n                              {getTypeIcon(earning.type)}\n                            </div>\n                            <div>\n                              <p className=\"font-medium text-sm\">{earning.description}</p>\n                              {earning.studentName && (\n                                <p className=\"text-xs text-gray-500\">Student: {earning.studentName}</p>\n                              )}\n                              <p className=\"text-xs text-gray-400\">{earning.date}</p>\n                            </div>\n                          </div>\n                          <div className=\"text-right\">\n                            <p className={cn(\n                              \"font-bold\",\n                              earning.amount < 0 ? \"text-red-600\" : \"text-green-600\"\n                            )}>\n                              {earning.amount < 0 ? '' : '+'}{formatCurrency(earning.amount)}\n                            </p>\n                            {getStatusBadge(earning.status)}\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n\n                {activeTab === 'courses' && (\n                  <div className=\"space-y-3\">\n                    {courses.map((course) => (\n                      <div key={course.id} className=\"p-3 border rounded-lg\">\n                        <div className=\"flex items-start justify-between mb-2\">\n                          <h4 className=\"font-medium text-sm\">{course.name}</h4>\n                          <Badge variant=\"outline\" className=\"text-xs\">\n                            ⭐ {course.rating}\n                          </Badge>\n                        </div>\n                        <div className=\"grid grid-cols-3 gap-2 text-center\">\n                          <div className=\"p-2 bg-gray-50 rounded\">\n                            <p className=\"text-lg font-bold\">{course.enrollments}</p>\n                            <p className=\"text-xs text-gray-500\">Students</p>\n                          </div>\n                          <div className=\"p-2 bg-gray-50 rounded\">\n                            <p className=\"text-lg font-bold\">{formatCurrency(course.revenue)}</p>\n                            <p className=\"text-xs text-gray-500\">Revenue</p>\n                          </div>\n                          <div className=\"p-2 bg-gray-50 rounded\">\n                            <p className=\"text-lg font-bold\">{course.conversionRate}%</p>\n                            <p className=\"text-xs text-gray-500\">Conversion</p>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n\n                {activeTab === 'analytics' && (\n                  <div className=\"space-y-4\">\n                    {/* Conversion Funnel - Moved to top for visibility */}\n                    <div className=\"p-4 bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg border border-blue-200\">\n                      <h3 className=\"font-medium mb-4 flex items-center gap-2 text-blue-900\">\n                        <TrendingUp className=\"w-5 h-5\" />\n                        Conversion Funnel\n                      </h3>\n                      <div className=\"space-y-4\">\n                        <div>\n                          <div className=\"flex justify-between text-sm mb-1\">\n                            <span className=\"text-gray-700 font-medium\">👀 Page Views</span>\n                            <span className=\"font-bold\">1,245</span>\n                          </div>\n                          <div className=\"h-3 bg-blue-100 rounded-full overflow-hidden\">\n                            <div className=\"h-full bg-blue-500 rounded-full\" style={{ width: '100%' }} />\n                          </div>\n                        </div>\n\n                        <div className=\"flex justify-center\">\n                          <div className=\"text-xs text-gray-500\">▼ 36.6% conversion</div>\n                        </div>\n\n                        <div>\n                          <div className=\"flex justify-between text-sm mb-1\">\n                            <span className=\"text-gray-700 font-medium\">📚 Course Views</span>\n                            <span className=\"font-bold\">456 (36.6%)</span>\n                          </div>\n                          <div className=\"h-3 bg-purple-100 rounded-full overflow-hidden\">\n                            <div className=\"h-full bg-purple-500 rounded-full\" style={{ width: '36.6%' }} />\n                          </div>\n                        </div>\n\n                        <div className=\"flex justify-center\">\n                          <div className=\"text-xs text-gray-500\">▼ 27.0% conversion</div>\n                        </div>\n\n                        <div>\n                          <div className=\"flex justify-between text-sm mb-1\">\n                            <span className=\"text-gray-700 font-medium\">✅ Enrollments</span>\n                            <span className=\"font-bold text-green-600\">123 (27.0%)</span>\n                          </div>\n                          <div className=\"h-3 bg-green-100 rounded-full overflow-hidden\">\n                            <div className=\"h-full bg-green-500 rounded-full\" style={{ width: '27.0%' }} />\n                          </div>\n                        </div>\n                      </div>\n\n                      <div className=\"mt-4 p-3 bg-white/70 rounded text-sm\">\n                        <p className=\"text-gray-700\">\n                          <strong>💡 Insight:</strong> Your course pages are converting well!\n                          Consider optimizing the landing page to increase views.\n                        </p>\n                      </div>\n                    </div>\n\n                    {/* Popular Time Slots */}\n                    <div>\n                      <h3 className=\"text-sm font-medium mb-3 flex items-center gap-2\">\n                        <Clock className=\"w-4 h-4\" />\n                        Popular Time Slots\n                      </h3>\n                      <div className=\"space-y-2\">\n                        {timeSlots.map((slot, idx) => (\n                          <div key={idx} className=\"flex items-center gap-3\">\n                            <span className=\"text-xs w-32 truncate\">{slot.slot}</span>\n                            <div className=\"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden\">\n                              <div\n                                className=\"h-full bg-purple-500 rounded-full\"\n                                style={{ width: `${(slot.bookings / 50) * 100}%` }}\n                              />\n                            </div>\n                            <span className=\"text-xs w-12 text-right\">{slot.bookings}</span>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n\n                    {/* Conversion Funnel */}\n                    <div className=\"p-3 bg-gray-50 rounded-lg\">\n                      <h3 className=\"text-sm font-medium mb-3\">Conversion Funnel</h3>\n                      <div className=\"space-y-2\">\n                        <div className=\"flex justify-between text-sm\">\n                          <span className=\"text-gray-600\">Page Views</span>\n                          <span className=\"font-medium\">1,245</span>\n                        </div>\n                        <div className=\"h-2 bg-blue-100 rounded-full overflow-hidden\">\n                          <div className=\"h-full bg-blue-500 rounded-full\" style={{ width: '100%' }} />\n                        </div>\n\n                        <div className=\"flex justify-between text-sm\">\n                          <span className=\"text-gray-600\">Course Views</span>\n                          <span className=\"font-medium\">456 (36.6%)</span>\n                        </div>\n                        <div className=\"h-2 bg-blue-100 rounded-full overflow-hidden\">\n                          <div className=\"h-full bg-blue-500 rounded-full\" style={{ width: '36.6%' }} />\n                        </div>\n\n                        <div className=\"flex justify-between text-sm\">\n                          <span className=\"text-gray-600\">Enrollments</span>\n                          <span className=\"font-medium\">123 (27.0%)</span>\n                        </div>\n                        <div className=\"h-2 bg-green-100 rounded-full overflow-hidden\">\n                          <div className=\"h-full bg-green-500 rounded-full\" style={{ width: '27.0%' }} />\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Revenue Trend */}\n                    <div className=\"p-3 bg-gray-50 rounded-lg\">\n                      <h3 className=\"text-sm font-medium mb-3\">Monthly Revenue Trend</h3>\n                      <div className=\"flex items-end gap-2 h-24\">\n                        {[65, 78, 45, 89, 92, 85, 95].map((height, idx) => (\n                          <div key={idx} className=\"flex-1 flex flex-col items-center gap-1\">\n                            <div\n                              className=\"w-full bg-purple-500 rounded-t\"\n                              style={{ height: `${height}%` }}\n                            />\n                            <span className=\"text-xs text-gray-500\">\n                              {['Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'][idx]}\n                            </span>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </ScrollArea>\n          </CardContent>\n        </Card>\n        <EmailStatementDialog\n          open={showEmailDialog}\n          onOpenChange={setShowEmailDialog}\n          emailAddress={emailAddress}\n          setEmailAddress={setEmailAddress}\n          sendingEmail={sendingEmail}\n          onSend={handleSendEmail}\n        />\n      </>\n    )\n  }\n}\n","const createStoreImpl = (createState) => {\n  let state;\n  const listeners = /* @__PURE__ */ new Set();\n  const setState = (partial, replace) => {\n    const nextState = typeof partial === \"function\" ? partial(state) : partial;\n    if (!Object.is(nextState, state)) {\n      const previousState = state;\n      state = (replace != null ? replace : typeof nextState !== \"object\" || nextState === null) ? nextState : Object.assign({}, state, nextState);\n      listeners.forEach((listener) => listener(state, previousState));\n    }\n  };\n  const getState = () => state;\n  const getInitialState = () => initialState;\n  const subscribe = (listener) => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  };\n  const api = { setState, getState, getInitialState, subscribe };\n  const initialState = state = createState(setState, getState, api);\n  return api;\n};\nconst createStore = ((createState) => createState ? createStoreImpl(createState) : createStoreImpl);\n\nexport { createStore };\n","import { produce } from 'immer';\n\nconst immerImpl = (initializer) => (set, get, store) => {\n  store.setState = (updater, replace, ...args) => {\n    const nextState = typeof updater === \"function\" ? produce(updater) : updater;\n    return set(nextState, replace, ...args);\n  };\n  return initializer(store.setState, get, store);\n};\nconst immer = immerImpl;\n\nexport { immer };\n","'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Textarea } from '@/components/ui/textarea'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { toast } from 'sonner'\nimport { Loader2 } from 'lucide-react'\n\nconst SUBJECTS = [\n  { value: 'math', label: 'Mathematics' },\n  { value: 'physics', label: 'Physics' },\n  { value: 'chemistry', label: 'Chemistry' },\n  { value: 'biology', label: 'Biology' },\n  { value: 'english', label: 'English' },\n  { value: 'history', label: 'History' },\n  { value: 'cs', label: 'Computer Science' },\n  { value: 'ielts', label: 'IELTS' },\n  { value: 'toefl', label: 'TOEFL' },\n]\n\nconst GRADE_LEVELS = [\n  { value: '6', label: 'Grade 6' },\n  { value: '7', label: 'Grade 7' },\n  { value: '8', label: 'Grade 8' },\n  { value: '9', label: 'Grade 9' },\n  { value: '10', label: 'Grade 10' },\n  { value: '11', label: 'Grade 11' },\n  { value: '12', label: 'Grade 12' },\n  { value: 'college', label: 'College' },\n]\n\ninterface CreateClassDialogProps {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  onClassCreated?: (classData?: { id: string; [key: string]: unknown }) => void\n  redirectToClass?: boolean\n}\n\nexport function CreateClassDialog({ open, onOpenChange, onClassCreated, redirectToClass = true }: CreateClassDialogProps) {\n  const router = useRouter()\n  const [creating, setCreating] = useState(false)\n  const [apiError, setApiError] = useState<string | null>(null)\n  const [form, setForm] = useState({\n    title: '',\n    subject: '',\n    description: '',\n    gradeLevel: '',\n    maxStudents: 50,\n    durationMinutes: 60,\n    scheduledAt: '',\n  })\n\n  const handleSubmit = async () => {\n    if (!form.title.trim()) { toast.error('Please enter a class title'); return }\n    if (!form.subject) { toast.error('Please select a subject'); return }\n    if (!form.gradeLevel) { toast.error('Please select a grade level'); return }\n    if (!form.scheduledAt) { toast.error('Please select date and time'); return }\n\n    setCreating(true)\n    setApiError(null)\n    try {\n      const scheduledDate = new Date(form.scheduledAt)\n      if (Number.isNaN(scheduledDate.getTime())) {\n        const message = 'Please provide a valid date and time.'\n        setApiError(message)\n        toast.error(message)\n        return\n      }\n\n      const csrfRes = await fetch('/api/csrf', { credentials: 'include' })\n      const csrfData = await csrfRes.json().catch(() => ({}))\n      const csrfToken = csrfData?.token ?? null\n\n      const res = await fetch('/api/class/rooms', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          ...(csrfToken && { 'X-CSRF-Token': csrfToken }),\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          title: form.title,\n          subject: form.subject,\n          gradeLevel: form.gradeLevel,\n          description: form.description,\n          maxStudents: form.maxStudents,\n          durationMinutes: form.durationMinutes,\n          scheduledAt: scheduledDate.toISOString(),\n        }),\n      })\n\n      const raw = await res.text()\n      let data: { error?: string; session?: { id: string } } = {}\n      if (raw) {\n        try {\n          data = JSON.parse(raw) as { error?: string; session?: { id: string } }\n        } catch {\n          data = { error: `Request failed (${res.status}): ${raw.slice(0, 180)}` }\n        }\n      }\n      if (res.ok) {\n        toast.success('Class created successfully!')\n        onOpenChange(false)\n        onClassCreated?.(data.session)\n        if (redirectToClass && data.session?.id) {\n          router.push(`/tutor/live-class/${data.session.id}`)\n        }\n      } else {\n        const message = data.error || 'Room creation failed. Please try again.'\n        setApiError(message)\n        toast.error(message)\n      }\n    } catch (error) {\n      const message = error instanceof Error\n        ? error.message\n        : 'An error occurred. Please check your connection and try again.'\n      setApiError(message)\n      toast.error(message)\n    } finally {\n      setCreating(false)\n    }\n  }\n\n  const handleOpenChange = (next: boolean) => {\n    if (creating) return\n    if (!next) setApiError(null)\n    onOpenChange(next)\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={handleOpenChange}>\n      <DialogContent className=\"sm:max-w-[500px]\" aria-busy={creating} aria-describedby={apiError ? 'create-class-api-error' : undefined}>\n        <DialogHeader>\n          <DialogTitle>Create New Class</DialogTitle>\n          <DialogDescription>Schedule a new live class session for your students.</DialogDescription>\n        </DialogHeader>\n        <div className=\"space-y-4 py-4\">\n          {apiError && (\n            <p id=\"create-class-api-error\" className=\"text-sm text-red-600 bg-red-50 border border-red-200 rounded-md px-3 py-2\" role=\"alert\">\n              {apiError}\n            </p>\n          )}\n          <div>\n            <Label>Class Title *</Label>\n            <Input\n              value={form.title}\n              onChange={e => setForm({ ...form, title: e.target.value })}\n              placeholder=\"e.g., AP Calculus - Limits\"\n              disabled={creating}\n              aria-invalid={!!apiError}\n            />\n          </div>\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <Label>Subject *</Label>\n              <Select value={form.subject} onValueChange={v => setForm({ ...form, subject: v })}>\n                <SelectTrigger disabled={creating}><SelectValue placeholder=\"Select subject\" /></SelectTrigger>\n                <SelectContent>\n                  {SUBJECTS.map(s => <SelectItem key={s.value} value={s.value}>{s.label}</SelectItem>)}\n                </SelectContent>\n              </Select>\n            </div>\n            <div>\n              <Label>Grade Level *</Label>\n              <Select value={form.gradeLevel} onValueChange={v => setForm({ ...form, gradeLevel: v })}>\n                <SelectTrigger disabled={creating}><SelectValue placeholder=\"Select grade\" /></SelectTrigger>\n                <SelectContent>\n                  {GRADE_LEVELS.map(g => <SelectItem key={g.value} value={g.value}>{g.label}</SelectItem>)}\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n          <div>\n            <Label>Description</Label>\n            <Textarea\n              value={form.description}\n              onChange={e => setForm({ ...form, description: e.target.value })}\n              placeholder=\"What will you cover in this class?\"\n              disabled={creating}\n            />\n          </div>\n          <div>\n            <Label>Date & Time *</Label>\n            <Input\n              type=\"datetime-local\"\n              value={form.scheduledAt}\n              onChange={e => setForm({ ...form, scheduledAt: e.target.value })}\n              disabled={creating}\n            />\n          </div>\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <Label>Duration (minutes)</Label>\n              <Select value={form.durationMinutes.toString()} onValueChange={v => setForm({ ...form, durationMinutes: parseInt(v) })}>\n                <SelectTrigger disabled={creating}><SelectValue /></SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"30\">30 minutes</SelectItem>\n                  <SelectItem value=\"60\">1 hour</SelectItem>\n                  <SelectItem value=\"90\">1.5 hours</SelectItem>\n                  <SelectItem value=\"120\">2 hours</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            <div>\n              <Label>Max Students</Label>\n              <Select value={form.maxStudents.toString()} onValueChange={v => setForm({ ...form, maxStudents: parseInt(v) })}>\n                <SelectTrigger disabled={creating}><SelectValue /></SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"10\">10 students</SelectItem>\n                  <SelectItem value=\"25\">25 students</SelectItem>\n                  <SelectItem value=\"50\">50 students</SelectItem>\n                  <SelectItem value=\"100\">100 students</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => handleOpenChange(false)} disabled={creating}>Cancel</Button>\n          <Button onClick={handleSubmit} disabled={creating} aria-busy={creating}>\n            {creating && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n            Create Class\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n","'use client'\n\nimport * as React from 'react'\nimport * as PopoverPrimitive from '@radix-ui/react-popover'\n\nimport { cn } from '@/lib/utils'\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = 'center', sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        'z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","'use client'\n\nimport { useEffect, useRef, useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport {\n  useFilteredMessages,\n  useMessageStats,\n  useSearchQuery,\n  useFilter,\n  useSelectedMessage,\n  useSelectedMessages,\n  useShowMultiSelect,\n  useShowCompose,\n  useShowTemplates,\n  useShowAnnouncement,\n  useShowQuickRepliesManager,\n  useShowAnalytics,\n  useShowFilters,\n  useReplyText,\n  useShowAIReplies,\n  useAiReplies,\n  useIsRecordingVoice,\n  useVoiceRecordingDuration,\n  useIsScheduling,\n  useScheduledDate,\n  useScheduledTime,\n  useShowThread,\n  useThreadMessages,\n  useTypingIndicators,\n  usePresenceStatus,\n  useIsWebSocketConnected,\n  useComposeTo,\n  useComposeSubject,\n  useComposeMessage,\n  useComposeAttachments,\n  useSelectedLabels,\n  useComposePriority,\n  useTemplates,\n  useQuickReplies,\n  useLabels,\n  useCommunicationActions,\n  type Message,\n  type Attachment,\n  type MessageTemplate,\n  type QuickReply,\n  type AIReply,\n  type Label as LabelType,\n  type PresenceStatus,\n  type TypingIndicator,\n} from '@/stores/communication-store'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { ScrollArea } from '@/components/ui/scroll-area'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from '@/components/ui/dialog'\nimport { Avatar, AvatarFallback } from '@/components/ui/avatar'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Checkbox } from '@/components/ui/checkbox'\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover'\nimport { Calendar } from '@/components/ui/calendar'\nimport { format, isAfter } from 'date-fns'\nimport { cn } from '@/lib/utils'\nimport { toast } from 'sonner'\nimport {\n  MessageSquare,\n  Send,\n  Search,\n  Filter,\n  Star,\n  Clock,\n  MoreVertical,\n  Plus,\n  Sparkles,\n  Mail,\n  Megaphone,\n  ChevronRight,\n  Archive,\n  Trash2,\n  Reply,\n  Forward,\n  Bookmark,\n  Smile,\n  Paperclip,\n  Mic,\n  Bot,\n  Check,\n  CheckCheck,\n  MicOff,\n  Pause,\n  Play,\n  X,\n  CalendarDays,\n  Tag,\n  BarChart3,\n  Zap,\n  Globe,\n  Users,\n  FileText,\n  Image as ImageIcon,\n  Download,\n  Hash,\n  Settings,\n  Volume2,\n  Loader2,\n  ChevronDown,\n  ChevronUp,\n  MessageCircle,\n  Bell,\n  Eye,\n  EyeOff,\n  Copy,\n  Edit3,\n  Trash,\n  Radio,\n  Wifi,\n  WifiOff\n} from 'lucide-react'\n\n// ============================================\n// MOCK DATA GENERATORS\n// ============================================\n\nconst generateAIReplies = (messageContent: string): AIReply[] => [\n  { id: '1', text: 'I\\'d be happy to help! Let me explain that concept in more detail during our next session.', tone: 'friendly' },\n  { id: '2', text: 'Thank you for reaching out. Here\\'s a resource that might help: [link]', tone: 'formal' },\n  { id: '3', text: 'No problem at all! This is a common question. The key is to remember that...', tone: 'casual' },\n  { id: '4', text: 'I understand your frustration. Let\\'s work through this together step by step.', tone: 'empathetic' }\n]\n\n// ============================================\n// MAIN COMPONENT\n// ============================================\n\nexport function CommunicationCenter() {\n  const router = useRouter()\n  \n  // Zustand store selectors - granular subscriptions for optimized re-renders\n  const filteredMessages = useFilteredMessages()\n  const stats = useMessageStats()\n  const searchQuery = useSearchQuery()\n  const filter = useFilter()\n  const selectedMessage = useSelectedMessage()\n  const selectedMessages = useSelectedMessages()\n  const showMultiSelect = useShowMultiSelect()\n  const showCompose = useShowCompose()\n  const showTemplates = useShowTemplates()\n  const showAnnouncement = useShowAnnouncement()\n  const showQuickRepliesManager = useShowQuickRepliesManager()\n  const showAnalytics = useShowAnalytics()\n  const showFilters = useShowFilters()\n  const replyText = useReplyText()\n  const showAIReplies = useShowAIReplies()\n  const aiReplies = useAiReplies()\n  const isRecordingVoice = useIsRecordingVoice()\n  const voiceRecordingDuration = useVoiceRecordingDuration()\n  const isScheduling = useIsScheduling()\n  const scheduledDate = useScheduledDate()\n  const scheduledTime = useScheduledTime()\n  const showThread = useShowThread()\n  const threadMessages = useThreadMessages()\n  const typingIndicators = useTypingIndicators()\n  const presenceStatus = usePresenceStatus()\n  const isWebSocketConnected = useIsWebSocketConnected()\n  const composeTo = useComposeTo()\n  const composeSubject = useComposeSubject()\n  const composeMessage = useComposeMessage()\n  const composeAttachments = useComposeAttachments()\n  const selectedLabels = useSelectedLabels()\n  const composePriority = useComposePriority()\n  const templates = useTemplates()\n  const quickReplies = useQuickReplies()\n  const labels = useLabels()\n  \n  // Store actions\n  const actions = useCommunicationActions()\n\n  // Local state for UI\n  const [calendarOpen, setCalendarOpen] = useState(false)\n\n  // Refs\n  const voiceRecorderRef = useRef<NodeJS.Timeout | null>(null)\n  const fileInputRef = useRef<HTMLInputElement>(null)\n\n  // ============================================\n  // REAL-TIME SIMULATION (WebSocket mock)\n  // ============================================\n  \n  useEffect(() => {\n    // Simulate WebSocket connection\n    actions.setIsWebSocketConnected(true)\n    \n    // Simulate typing indicators\n    const typingInterval = setInterval(() => {\n      if (Math.random() > 0.7) {\n        const newIndicator: TypingIndicator = {\n          userId: 's' + Math.floor(Math.random() * 5 + 1),\n          userName: ['Alice', 'Bob', 'Carol', 'David', 'Emma'][Math.floor(Math.random() * 5)],\n          timestamp: Date.now()\n        }\n        actions.addTypingIndicator(newIndicator)\n        actions.clearExpiredTypingIndicators()\n      }\n    }, 2000)\n    \n    // Simulate presence updates\n    const presenceInterval = setInterval(() => {\n      const statuses: Record<string, PresenceStatus> = {\n        s1: { userId: 's1', status: Math.random() > 0.3 ? 'online' : 'away' },\n        s2: { userId: 's2', status: Math.random() > 0.5 ? 'online' : 'offline', lastSeen: new Date().toISOString() },\n        s3: { userId: 's3', status: 'online' },\n        s4: { userId: 's4', status: Math.random() > 0.6 ? 'online' : 'offline' },\n        s5: { userId: 's5', status: 'away' }\n      }\n      actions.setPresenceStatus(statuses)\n    }, 5000)\n    \n    return () => {\n      clearInterval(typingInterval)\n      clearInterval(presenceInterval)\n    }\n  }, [actions])\n\n  // filteredMessages and stats are already computed by store selectors\n\n  // ============================================\n  // HANDLERS\n  // ============================================\n  \n  const formatTime = (timestamp: string) => {\n    const date = new Date(timestamp)\n    const now = new Date()\n    const diff = now.getTime() - date.getTime()\n    const hours = Math.floor(diff / (1000 * 60 * 60))\n    if (hours < 1) return 'Just now'\n    if (hours < 24) return `${hours}h ago`\n    return date.toLocaleDateString()\n  }\n\n  const handleReply = () => {\n    if (!replyText.trim() && composeAttachments.length === 0) return\n    \n    const newMessage: Message = {\n      id: `reply-${Date.now()}`,\n      studentId: selectedMessage?.studentId || '',\n      studentName: 'You',\n      subject: `Re: ${selectedMessage?.subject}`,\n      content: replyText,\n      timestamp: new Date().toISOString(),\n      isRead: true,\n      isStarred: false,\n      priority: 'normal',\n      type: 'message',\n      parentId: selectedMessage?.id,\n      attachments: composeAttachments\n    }\n    \n    actions.addMessage(newMessage)\n    toast.success(isScheduling ? 'Message scheduled!' : 'Reply sent!')\n    actions.setReplyText('')\n    actions.clearComposeAttachments()\n    actions.setShowAIReplies(false)\n    actions.setIsScheduling(false)\n    actions.setScheduledDate(undefined)\n  }\n\n  const handleAIAssist = () => {\n    if (!selectedMessage) return\n    const suggestions = generateAIReplies(selectedMessage.content)\n    actions.setAiReplies(suggestions)\n    actions.setShowAIReplies(true)\n  }\n\n  const handleUseTemplate = (template: MessageTemplate) => {\n    actions.setReplyText(template.content)\n    actions.setShowTemplates(false)\n  }\n\n  const handleUseQuickReply = (quickReply: QuickReply) => {\n    actions.setReplyText(quickReply.content)\n  }\n\n  const handleVoiceRecord = () => {\n    if (isRecordingVoice) {\n      // Stop recording\n      actions.setIsRecordingVoice(false)\n      if (voiceRecorderRef.current) {\n        clearInterval(voiceRecorderRef.current)\n      }\n      toast.success(`Voice message recorded (${voiceRecordingDuration}s)`)\n      actions.setVoiceRecordingDuration(0)\n    } else {\n      // Start recording\n      actions.setIsRecordingVoice(true)\n      actions.setVoiceRecordingDuration(0)\n      voiceRecorderRef.current = setInterval(() => {\n        actions.incrementVoiceDuration()\n      }, 1000)\n    }\n  }\n\n  const handleFileUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files\n    if (!files) return\n    \n    Array.from(files).forEach(file => {\n      const newAttachment: Attachment = {\n        id: `att-${Date.now()}-${Math.random()}`,\n        name: file.name,\n        type: file.type.startsWith('image/') ? 'image' : file.type.includes('pdf') ? 'pdf' : 'document',\n        url: URL.createObjectURL(file),\n        size: file.size\n      }\n      actions.addComposeAttachment(newAttachment)\n    })\n    \n    toast.success(`${files.length} file(s) attached`)\n  }\n\n  const handleToggleMessageSelection = (messageId: string) => {\n    actions.toggleMessageSelection(messageId)\n  }\n\n  const handleSelectAll = () => {\n    if (selectedMessages.size === filteredMessages.length) {\n      actions.setSelectedMessages(new Set())\n    } else {\n      actions.setSelectedMessages(new Set(filteredMessages.map(m => m.id)))\n    }\n  }\n\n  const handleBulkAction = (action: 'read' | 'unread' | 'star' | 'archive' | 'delete') => {\n    switch (action) {\n      case 'read':\n        actions.bulkMarkAsRead(selectedMessages)\n        break\n      case 'unread':\n        actions.bulkMarkAsUnread(selectedMessages)\n        break\n      case 'star':\n        actions.bulkToggleStar(selectedMessages)\n        break\n      case 'archive':\n        actions.bulkArchive(selectedMessages)\n        break\n      case 'delete':\n        actions.bulkDelete(selectedMessages)\n        break\n    }\n    \n    actions.setSelectedMessages(new Set())\n    actions.setShowMultiSelect(false)\n    toast.success(`Messages ${action}ed`)\n  }\n\n  const handleAddLabel = (messageId: string, labelId: string) => {\n    actions.addLabelToMessage(messageId, labelId)\n  }\n\n  const handleTranslate = (message: Message) => {\n    // Mock translation\n    actions.translateMessage(message.id, `[Translated] ${message.content}`, 'zh-CN')\n    toast.success('Message translated')\n  }\n\n  const handleViewThread = (message: Message) => {\n    actions.setSelectedMessage(message)\n    // Mock thread messages\n    actions.setThreadMessages([\n      message,\n      {\n        id: 'reply-1',\n        studentId: message.studentId,\n        studentName: message.studentName,\n        subject: '',\n        content: 'Follow-up question about the same topic...',\n        timestamp: new Date(Date.now() - 1000 * 60 * 60).toISOString(),\n        isRead: true,\n        isStarred: false,\n        priority: 'normal',\n        type: 'message',\n        parentId: message.id\n      },\n      {\n        id: 'reply-2',\n        studentId: 'tutor',\n        studentName: 'You',\n        subject: '',\n        content: 'Thanks for the clarification!',\n        timestamp: new Date(Date.now() - 1000 * 60 * 30).toISOString(),\n        isRead: true,\n        isStarred: false,\n        priority: 'normal',\n        type: 'message',\n        parentId: message.id\n      }\n    ])\n    actions.setShowThread(true)\n  }\n\n  const getPresenceIndicator = (studentId: string) => {\n    const status = presenceStatus[studentId]\n    if (!status) return null\n    \n    return (\n      <span className={cn(\n        \"w-2 h-2 rounded-full absolute bottom-0 right-0 border-2 border-white\",\n        status.status === 'online' && \"bg-green-500\",\n        status.status === 'away' && \"bg-yellow-500\",\n        status.status === 'offline' && \"bg-gray-400\"\n      )} />\n    )\n  }\n\n  const formatFileSize = (bytes: number) => {\n    if (bytes < 1024) return bytes + ' B'\n    if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB'\n    return (bytes / (1024 * 1024)).toFixed(1) + ' MB'\n  }\n\n  // ============================================\n  // RENDER\n  // ============================================\n  \n  return (\n    <Card className=\"h-full flex flex-col\">\n      <CardHeader className=\"pb-3\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <MessageSquare className=\"w-5 h-5 text-blue-500\" />\n            <CardTitle className=\"text-base\">Communication Center</CardTitle>\n            {stats.unread > 0 && (\n              <Badge variant=\"destructive\" className=\"text-xs\">\n                {stats.unread}\n              </Badge>\n            )}\n            {/* WebSocket connection indicator */}\n            <div className={cn(\n              \"flex items-center gap-1 px-2 py-0.5 rounded-full text-xs\",\n              isWebSocketConnected ? \"bg-green-100 text-green-700\" : \"bg-red-100 text-red-700\"\n            )}>\n              {isWebSocketConnected ? <Wifi className=\"w-3 h-3\" /> : <WifiOff className=\"w-3 h-3\" />}\n              {isWebSocketConnected ? 'Live' : 'Offline'}\n            </div>\n          </div>\n          <div className=\"flex items-center gap-1\">\n            <Button variant=\"ghost\" size=\"sm\" onClick={() => actions.setShowAnalytics(true)}>\n              <BarChart3 className=\"w-4 h-4 mr-1\" />\n              Analytics\n            </Button>\n            <Button variant=\"ghost\" size=\"sm\" onClick={() => actions.setShowAnnouncement(true)}>\n              <Megaphone className=\"w-4 h-4 mr-1\" />\n              Announce\n            </Button>\n            <Button size=\"sm\" onClick={() => actions.setShowCompose(true)}>\n              <Plus className=\"w-4 h-4 mr-1\" />\n              New\n            </Button>\n          </div>\n        </div>\n\n        {/* Search & Filter Bar */}\n        <div className=\"flex gap-2 mt-3\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-2.5 top-2.5 w-4 h-4 text-gray-400\" />\n            <Input\n              placeholder=\"Search messages, labels, courses...\"\n              value={searchQuery}\n              onChange={(e) => actions.setSearchQuery(e.target.value)}\n              className=\"pl-9 h-9\"\n            />\n          </div>\n          <Popover open={showFilters} onOpenChange={actions.setShowFilters}>\n            <PopoverTrigger asChild>\n              <Button variant=\"outline\" size=\"sm\" className=\"h-9\">\n                <Filter className=\"w-4 h-4 mr-1\" />\n                Filter\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-80\">\n              <div className=\"space-y-4\">\n                <h4 className=\"font-medium\">Filter Messages</h4>\n                <div className=\"space-y-2\">\n                  <Label>Status</Label>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {['all', 'unread', 'starred', 'high', 'scheduled'].map(f => (\n                      <Button\n                        key={f}\n                        variant={filter === f ? 'default' : 'outline'}\n                        size=\"sm\"\n                        onClick={() => actions.setFilter(f as any)}\n                      >\n                        {f.charAt(0).toUpperCase() + f.slice(1)}\n                      </Button>\n                    ))}\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>Labels</Label>\n                  <div className=\"flex flex-wrap gap-1\">\n                    {labels.map(label => (\n                      <Badge\n                        key={label.id}\n                        variant=\"outline\"\n                        className={cn(\"cursor-pointer\", label.color)}\n                      >\n                        {label.name}\n                      </Badge>\n                    ))}\n                  </div>\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n          <Button\n            variant={showMultiSelect ? 'default' : 'outline'}\n            size=\"sm\"\n            className=\"h-9\"\n            onClick={() => {\n              actions.setShowMultiSelect(!showMultiSelect)\n              actions.setSelectedMessages(new Set())\n            }}\n          >\n            <Check className=\"w-4 h-4 mr-1\" />\n            Select\n          </Button>\n        </div>\n\n        {/* Bulk Actions Bar */}\n        {showMultiSelect && selectedMessages.size > 0 && (\n          <div className=\"flex items-center justify-between mt-2 p-2 bg-blue-50 rounded-lg\">\n            <span className=\"text-sm text-blue-700\">\n              {selectedMessages.size} selected\n            </span>\n            <div className=\"flex gap-1\">\n              <Button size=\"sm\" variant=\"ghost\" onClick={() => handleBulkAction('read')}>\n                <Check className=\"w-4 h-4 mr-1\" />\n                Read\n              </Button>\n              <Button size=\"sm\" variant=\"ghost\" onClick={() => handleBulkAction('star')}>\n                <Star className=\"w-4 h-4 mr-1\" />\n                Star\n              </Button>\n              <Button size=\"sm\" variant=\"ghost\" onClick={() => handleBulkAction('archive')}>\n                <Archive className=\"w-4 h-4 mr-1\" />\n                Archive\n              </Button>\n              <Button size=\"sm\" variant=\"ghost\" className=\"text-red-600\" onClick={() => handleBulkAction('delete')}>\n                <Trash2 className=\"w-4 h-4 mr-1\" />\n                Delete\n              </Button>\n            </div>\n          </div>\n        )}\n\n        {/* Typing Indicators */}\n        {typingIndicators.length > 0 && (\n          <div className=\"flex items-center gap-2 mt-2 text-sm text-gray-500\">\n            <div className=\"flex -space-x-1\">\n              {typingIndicators.slice(0, 3).map((t, i) => (\n                <div key={i} className=\"w-6 h-6 rounded-full bg-blue-100 border-2 border-white flex items-center justify-center text-xs\">\n                  {t.userName[0]}\n                </div>\n              ))}\n            </div>\n            <span>{typingIndicators[0].userName} is typing...</span>\n          </div>\n        )}\n      </CardHeader>\n\n      <CardContent className=\"p-0 flex-1 overflow-hidden\">\n        <ScrollArea className=\"h-full\">\n          <div className=\"space-y-1 px-4 pb-4\">\n            {filteredMessages.length === 0 ? (\n              <div className=\"text-center py-8\">\n                <Mail className=\"w-10 h-10 text-gray-300 mx-auto mb-2\" />\n                <p className=\"text-sm text-gray-500\">No messages found</p>\n              </div>\n            ) : (\n              filteredMessages.map((message) => (\n                <div\n                  key={message.id}\n                  onClick={() => !showMultiSelect && actions.setSelectedMessage(message)}\n                  className={cn(\n                    \"p-3 rounded-lg border cursor-pointer transition-all hover:shadow-md relative\",\n                    !message.isRead ? \"bg-blue-50 border-blue-200\" : \"bg-white border-gray-200\",\n                    message.priority === 'high' && !message.isRead && \"border-l-4 border-l-red-500\",\n                    selectedMessages.has(message.id) && \"ring-2 ring-blue-500\",\n                    message.isScheduled && \"bg-yellow-50 border-yellow-200\"\n                  )}\n                >\n                  {/* Multi-select checkbox */}\n                  {showMultiSelect && (\n                    <div className=\"absolute top-3 left-3\">\n                      <Checkbox\n                        checked={selectedMessages.has(message.id)}\n                        onCheckedChange={() => handleToggleMessageSelection(message.id)}\n                        onClick={(e) => e.stopPropagation()}\n                      />\n                    </div>\n                  )}\n                  \n                  <div className={cn(\"flex items-start gap-3\", showMultiSelect && \"pl-8\")}>\n                    {/* Avatar with presence */}\n                    <div className=\"relative\">\n                      <Avatar className=\"w-10 h-10\">\n                        <AvatarFallback className={cn(\n                          \"text-xs\",\n                          message.type === 'system' ? \"bg-gray-200\" : \"bg-blue-100 text-blue-700\"\n                        )}>\n                          {message.studentName.split(' ').map(n => n[0]).join('')}\n                        </AvatarFallback>\n                      </Avatar>\n                      {message.type !== 'system' && getPresenceIndicator(message.studentId)}\n                    </div>\n                    \n                    <div className=\"flex-1 min-w-0\">\n                      {/* Header row */}\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-2\">\n                          <span className={cn(\"font-medium text-sm\", !message.isRead && \"text-blue-900\")}>\n                            {message.studentName}\n                          </span>\n                          {message.isStarred && <Star className=\"w-3 h-3 text-yellow-500 fill-yellow-500\" />}\n                          {message.priority === 'high' && (\n                            <Badge variant=\"destructive\" className=\"text-xs px-1 py-0\">High</Badge>\n                          )}\n                          {message.isScheduled && (\n                            <Badge variant=\"outline\" className=\"text-xs bg-yellow-50\">\n                              <Clock className=\"w-3 h-3 mr-1\" />\n                              Scheduled\n                            </Badge>\n                          )}\n                          {message.replyCount && message.replyCount > 0 && (\n                            <Badge variant=\"outline\" className=\"text-xs\">\n                              <MessageCircle className=\"w-3 h-3 mr-1\" />\n                              {message.replyCount}\n                            </Badge>\n                          )}\n                        </div>\n                        <span className=\"text-xs text-gray-400\">{formatTime(message.timestamp)}</span>\n                      </div>\n                      \n                      {/* Subject & Content */}\n                      <p className={cn(\"text-sm truncate\", !message.isRead ? \"font-medium text-gray-900\" : \"text-gray-600\")}>\n                        {message.subject}\n                      </p>\n                      <p className=\"text-xs text-gray-500 truncate mt-0.5\">\n                        {message.voiceUrl ? '🎤 Voice message' : message.content}\n                      </p>\n                      \n                      {/* Labels */}\n                      {message.labels && message.labels.length > 0 && (\n                        <div className=\"flex flex-wrap gap-1 mt-2\">\n                          {message.labels.map(labelId => {\n                            const label = labels.find(l => l.id === labelId)\n                            if (!label) return null\n                            return (\n                              <Badge key={labelId} variant=\"outline\" className={cn(\"text-xs\", label.color)}>\n                                {label.name}\n                              </Badge>\n                            )\n                          })}\n                        </div>\n                      )}\n                      \n                      {/* Attachments indicator */}\n                      {message.attachments && message.attachments.length > 0 && (\n                        <div className=\"flex items-center gap-1 mt-2 text-xs text-gray-500\">\n                          <Paperclip className=\"w-3 h-3\" />\n                          {message.attachments.length} attachment(s)\n                        </div>\n                      )}\n                      \n                      {/* Read receipt */}\n                      {message.isRead && message.readAt && (\n                        <div className=\"flex items-center gap-1 mt-1 text-xs text-gray-400\">\n                          <CheckCheck className=\"w-3 h-3\" />\n                          Read {formatTime(message.readAt)}\n                        </div>\n                      )}\n                    </div>\n                    \n                    {/* Unread indicator */}\n                    {!message.isRead && (\n                      <div className=\"w-2 h-2 bg-blue-500 rounded-full shrink-0\" />\n                    )}\n                  </div>\n                </div>\n              ))\n            )}\n          </div>\n        </ScrollArea>\n\n        {/* Quick Stats Footer */}\n        <div className=\"p-3 border-t bg-gray-50 flex items-center justify-between text-xs text-gray-500\">\n          <div className=\"flex gap-3\">\n            <span>{stats.total} total</span>\n            <span>•</span>\n            <span>{stats.unread} unread</span>\n            <span>•</span>\n            <span>{stats.todayMessages} today</span>\n          </div>\n          <Button variant=\"ghost\" size=\"sm\" className=\"h-6 text-xs\" onClick={() => router.push('/tutor/messages')}>\n            Open Full Center\n            <ChevronRight className=\"w-3 h-3 ml-1\" />\n          </Button>\n        </div>\n      </CardContent>\n\n      {/* ============================================\n          MESSAGE DETAIL DIALOG\n          ============================================ */}\n      <Dialog open={!!selectedMessage && !showThread} onOpenChange={() => actions.setSelectedMessage(null)}>\n        <DialogContent className=\"sm:max-w-2xl max-h-[90vh] flex flex-col\">\n          {selectedMessage && (\n            <>\n              <DialogHeader>\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"relative\">\n                      <Avatar className=\"w-12 h-12\">\n                        <AvatarFallback className=\"bg-blue-100 text-blue-700\">\n                          {selectedMessage.studentName.split(' ').map(n => n[0]).join('')}\n                        </AvatarFallback>\n                      </Avatar>\n                      {getPresenceIndicator(selectedMessage.studentId)}\n                    </div>\n                    <div>\n                      <DialogTitle className=\"text-lg\">{selectedMessage.subject}</DialogTitle>\n                      <p className=\"text-sm text-gray-500\">\n                        From: {selectedMessage.studentName} • {formatTime(selectedMessage.timestamp)}\n                      </p>\n                    </div>\n                  </div>\n                  <div className=\"flex gap-1\">\n                    <Button \n                      variant=\"ghost\" \n                      size=\"icon\"\n                      onClick={() => {\n                        actions.toggleMessageStar(selectedMessage.id)\n                      }}\n                    >\n                      <Star className={cn(\"w-4 h-4\", selectedMessage.isStarred && \"fill-yellow-500 text-yellow-500\")} />\n                    </Button>\n                    <Button variant=\"ghost\" size=\"icon\" onClick={() => handleTranslate(selectedMessage)}>\n                      <Globe className=\"w-4 h-4\" />\n                    </Button>\n                    <Button variant=\"ghost\" size=\"icon\">\n                      <Archive className=\"w-4 h-4\" />\n                    </Button>\n                    <Button variant=\"ghost\" size=\"icon\">\n                      <Trash2 className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </DialogHeader>\n\n              <ScrollArea className=\"flex-1 my-4\">\n                <div className=\"space-y-4\">\n                  {/* Original message */}\n                  <div className=\"p-4 bg-gray-50 rounded-lg\">\n                    <p className=\"text-gray-800 whitespace-pre-wrap\">{selectedMessage.content}</p>\n                    {selectedMessage.translatedContent && (\n                      <div className=\"mt-3 p-3 bg-blue-50 rounded border border-blue-200\">\n                        <p className=\"text-sm text-blue-800\">{selectedMessage.translatedContent}</p>\n                        <p className=\"text-xs text-blue-500 mt-1\">Translated from {selectedMessage.translatedFrom}</p>\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Voice message player */}\n                  {selectedMessage.voiceUrl && (\n                    <div className=\"p-4 bg-purple-50 rounded-lg flex items-center gap-3\">\n                      <Button size=\"icon\" variant=\"outline\">\n                        <Play className=\"w-4 h-4\" />\n                      </Button>\n                      <div className=\"flex-1 h-2 bg-purple-200 rounded-full\">\n                        <div className=\"w-1/3 h-full bg-purple-500 rounded-full\" />\n                      </div>\n                      <span className=\"text-sm text-purple-700\">{selectedMessage.voiceDuration}s</span>\n                    </div>\n                  )}\n\n                  {/* Attachments */}\n                  {selectedMessage.attachments && selectedMessage.attachments.length > 0 && (\n                    <div className=\"space-y-2\">\n                      <h4 className=\"text-sm font-medium\">Attachments</h4>\n                      <div className=\"flex flex-wrap gap-2\">\n                        {selectedMessage.attachments.map(att => (\n                          <div key={att.id} className=\"flex items-center gap-2 p-2 border rounded-lg bg-white\">\n                            {att.type === 'image' ? <ImageIcon className=\"w-4 h-4\" /> : <FileText className=\"w-4 h-4\" />}\n                            <span className=\"text-sm\">{att.name}</span>\n                            <span className=\"text-xs text-gray-500\">({formatFileSize(att.size)})</span>\n                            <Button size=\"icon\" variant=\"ghost\" className=\"h-6 w-6\">\n                              <Download className=\"w-4 h-4\" />\n                            </Button>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Thread button */}\n                  {selectedMessage.replyCount && selectedMessage.replyCount > 0 && (\n                    <Button variant=\"outline\" className=\"w-full\" onClick={() => handleViewThread(selectedMessage)}>\n                      <MessageCircle className=\"w-4 h-4 mr-2\" />\n                      View Thread ({selectedMessage.replyCount} replies)\n                    </Button>\n                  )}\n\n                  {/* Label management */}\n                  <div className=\"flex flex-wrap gap-2\">\n                    {labels.map(label => (\n                      <Button\n                        key={label.id}\n                        variant={selectedMessage.labels?.includes(label.id) ? 'default' : 'outline'}\n                        size=\"sm\"\n                        className={cn(\"text-xs\", selectedMessage.labels?.includes(label.id) && label.color)}\n                        onClick={() => handleAddLabel(selectedMessage.id, label.id)}\n                      >\n                        <Tag className=\"w-3 h-3 mr-1\" />\n                        {label.name}\n                      </Button>\n                    ))}\n                  </div>\n\n                  {/* AI Assistant */}\n                  <div>\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <Button variant=\"outline\" size=\"sm\" onClick={handleAIAssist} className=\"gap-2\">\n                        <Sparkles className=\"w-4 h-4 text-purple-500\" />\n                        AI Reply Assistant\n                      </Button>\n                      <div className=\"flex gap-1\">\n                        <Button variant=\"outline\" size=\"sm\" onClick={() => actions.setShowTemplates(true)}>\n                          <Bookmark className=\"w-4 h-4 mr-1\" />\n                          Templates\n                        </Button>\n                        <Button variant=\"outline\" size=\"sm\" onClick={() => actions.setShowQuickRepliesManager(true)}>\n                          <Zap className=\"w-4 h-4 mr-1\" />\n                          Quick Replies\n                        </Button>\n                      </div>\n                    </div>\n\n                    {/* Quick Replies */}\n                    <div className=\"flex flex-wrap gap-2 mb-3\">\n                      {quickReplies.slice(0, 4).map(qr => (\n                        <Button\n                          key={qr.id}\n                          variant=\"outline\"\n                          size=\"sm\"\n                          className=\"text-xs\"\n                          onClick={() => handleUseQuickReply(qr)}\n                        >\n                          {qr.title}\n                        </Button>\n                      ))}\n                    </div>\n\n                    {showAIReplies && (\n                      <div className=\"space-y-2 mb-4\">\n                        <p className=\"text-xs text-gray-500\">AI-suggested replies:</p>\n                        {aiReplies.map((reply) => (\n                          <button\n                            key={reply.id}\n                            onClick={() => actions.setReplyText(reply.text)}\n                            className=\"w-full text-left p-3 bg-purple-50 border border-purple-200 rounded-lg hover:bg-purple-100 transition-colors\"\n                          >\n                            <div className=\"flex items-center gap-2 mb-1\">\n                              <Bot className=\"w-3 h-3 text-purple-500\" />\n                              <span className=\"text-xs font-medium text-purple-700 capitalize\">{reply.tone}</span>\n                            </div>\n                            <p className=\"text-sm text-gray-800\">{reply.text}</p>\n                          </button>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </ScrollArea>\n\n              {/* Reply Box */}\n              <div className=\"space-y-3 border-t pt-4\">\n                {/* Attachments preview */}\n                {composeAttachments.length > 0 && (\n                  <div className=\"flex flex-wrap gap-2\">\n                    {composeAttachments.map(att => (\n                      <div key={att.id} className=\"flex items-center gap-1 p-2 bg-gray-100 rounded text-sm\">\n                        <span>{att.name}</span>\n                        <Button \n                          size=\"icon\" \n                          variant=\"ghost\" \n                          className=\"h-5 w-5\"\n                          onClick={() => actions.removeComposeAttachment(att.id)}\n                        >\n                          <X className=\"w-3 h-3\" />\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                )}\n\n                {/* Voice recording indicator */}\n                {isRecordingVoice && (\n                  <div className=\"flex items-center gap-3 p-3 bg-red-50 rounded-lg\">\n                    <div className=\"w-3 h-3 bg-red-500 rounded-full animate-pulse\" />\n                    <span className=\"text-red-700\">Recording... {voiceRecordingDuration}s</span>\n                    <Button size=\"sm\" variant=\"destructive\" onClick={handleVoiceRecord}>\n                      <MicOff className=\"w-4 h-4 mr-1\" />\n                      Stop\n                    </Button>\n                  </div>\n                )}\n\n                {/* Scheduling indicator */}\n                {isScheduling && scheduledDate && (\n                  <div className=\"flex items-center gap-3 p-3 bg-yellow-50 rounded-lg\">\n                    <Clock className=\"w-4 h-4 text-yellow-600\" />\n                    <span className=\"text-yellow-700\">\n                      Scheduled for: {format(scheduledDate, 'PPP')} at {scheduledTime}\n                    </span>\n                    <Button size=\"sm\" variant=\"ghost\" onClick={() => { actions.setIsScheduling(false); actions.setScheduledDate(undefined); }}>\n                      <X className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                )}\n\n                <Textarea\n                  placeholder=\"Type your reply...\"\n                  value={replyText}\n                  onChange={(e) => actions.setReplyText(e.target.value)}\n                  className=\"min-h-[100px]\"\n                />\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex gap-1\">\n                    <Button variant=\"ghost\" size=\"icon\" onClick={() => fileInputRef.current?.click()}>\n                      <Paperclip className=\"w-4 h-4\" />\n                    </Button>\n                    <input\n                      ref={fileInputRef}\n                      type=\"file\"\n                      multiple\n                      className=\"hidden\"\n                      onChange={handleFileUpload}\n                    />\n                    <Button variant=\"ghost\" size=\"icon\">\n                      <Smile className=\"w-4 h-4\" />\n                    </Button>\n                    <Button \n                      variant=\"ghost\" \n                      size=\"icon\"\n                      onClick={handleVoiceRecord}\n                      className={cn(isRecordingVoice && \"text-red-500\")}\n                    >\n                      <Mic className=\"w-4 h-4\" />\n                    </Button>\n                    <Popover open={calendarOpen} onOpenChange={setCalendarOpen}>\n                      <PopoverTrigger asChild>\n                        <Button variant=\"ghost\" size=\"icon\">\n                          <CalendarDays className=\"w-4 h-4\" />\n                        </Button>\n                      </PopoverTrigger>\n                      <PopoverContent className=\"w-auto p-0\">\n                        <Calendar\n                          mode=\"single\"\n                          selected={scheduledDate}\n                          onSelect={(date) => {\n                            actions.setScheduledDate(date)\n                            actions.setIsScheduling(true)\n                            setCalendarOpen(false)\n                          }}\n                          disabled={(date) => isAfter(new Date(), date)}\n                        />\n                        {scheduledDate && (\n                          <div className=\"p-3 border-t\">\n                            <Label>Time</Label>\n                            <Input\n                              type=\"time\"\n                              value={scheduledTime}\n                              onChange={(e) => actions.setScheduledTime(e.target.value)}\n                              className=\"mt-1\"\n                            />\n                          </div>\n                        )}\n                      </PopoverContent>\n                    </Popover>\n                  </div>\n                  <Button onClick={handleReply} disabled={!replyText.trim() && composeAttachments.length === 0}>\n                    <Send className=\"w-4 h-4 mr-2\" />\n                    {isScheduling ? 'Schedule' : 'Send'}\n                  </Button>\n                </div>\n              </div>\n            </>\n          )}\n        </DialogContent>\n      </Dialog>\n\n      {/* ============================================\n          THREAD VIEW DIALOG\n          ============================================ */}\n      <Dialog open={showThread} onOpenChange={actions.setShowThread}>\n        <DialogContent className=\"sm:max-w-2xl max-h-[90vh]\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <MessageCircle className=\"w-5 h-5\" />\n              Message Thread\n            </DialogTitle>\n          </DialogHeader>\n          <ScrollArea className=\"h-[500px]\">\n            <div className=\"space-y-4 py-4\">\n              {threadMessages.map((msg, index) => (\n                <div\n                  key={msg.id}\n                  className={cn(\n                    \"flex gap-3\",\n                    msg.studentName === 'You' ? \"flex-row-reverse\" : \"\"\n                  )}\n                >\n                  <Avatar className=\"w-8 h-8\">\n                    <AvatarFallback className={cn(\n                      \"text-xs\",\n                      msg.studentName === 'You' ? \"bg-green-100 text-green-700\" : \"bg-blue-100 text-blue-700\"\n                    )}>\n                      {msg.studentName.split(' ').map(n => n[0]).join('')}\n                    </AvatarFallback>\n                  </Avatar>\n                  <div className={cn(\n                    \"max-w-[80%] p-3 rounded-lg\",\n                    msg.studentName === 'You' ? \"bg-green-100 text-green-900\" : \"bg-gray-100 text-gray-900\"\n                  )}>\n                    <p className=\"text-sm\">{msg.content}</p>\n                    <p className=\"text-xs text-gray-500 mt-1\">{formatTime(msg.timestamp)}</p>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </ScrollArea>\n        </DialogContent>\n      </Dialog>\n\n      {/* ============================================\n          COMPOSE DIALOG\n          ============================================ */}\n      <Dialog open={showCompose} onOpenChange={actions.setShowCompose}>\n        <DialogContent className=\"sm:max-w-lg\">\n          <DialogHeader>\n            <DialogTitle>New Message</DialogTitle>\n            <DialogDescription>Send a message to your students</DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label>To</Label>\n              <Input \n                placeholder=\"Search students...\"\n                value={composeTo}\n                onChange={(e) => actions.setComposeTo(e.target.value)}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Subject</Label>\n              <Input \n                placeholder=\"Enter subject...\"\n                value={composeSubject}\n                onChange={(e) => actions.setComposeSubject(e.target.value)}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Priority</Label>\n              <div className=\"flex gap-2\">\n                {(['low', 'normal', 'high'] as const).map(p => (\n                  <Button\n                    key={p}\n                    variant={composePriority === p ? 'default' : 'outline'}\n                    size=\"sm\"\n                    onClick={() => actions.setComposePriority(p)}\n                  >\n                    {p.charAt(0).toUpperCase() + p.slice(1)}\n                  </Button>\n                ))}\n              </div>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Labels</Label>\n              <div className=\"flex flex-wrap gap-2\">\n                {labels.map(label => (\n                  <Button\n                    key={label.id}\n                    variant={selectedLabels.includes(label.id) ? 'default' : 'outline'}\n                    size=\"sm\"\n                    className={cn(\"text-xs\", selectedLabels.includes(label.id) && label.color)}\n                    onClick={() => actions.toggleSelectedLabel(label.id)}\n                  >\n                    {label.name}\n                  </Button>\n                ))}\n              </div>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Message</Label>\n              <Textarea \n                placeholder=\"Type your message...\"\n                className=\"min-h-[150px]\"\n                value={composeMessage}\n                onChange={(e) => actions.setComposeMessage(e.target.value)}\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => actions.setShowCompose(false)}>Cancel</Button>\n            <Button onClick={() => { \n              toast.success('Message sent!'); \n              actions.setShowCompose(false);\n              actions.resetComposeForm();\n            }}>\n              <Send className=\"w-4 h-4 mr-2\" />\n              Send\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* ============================================\n          TEMPLATES DIALOG\n          ============================================ */}\n      <Dialog open={showTemplates} onOpenChange={actions.setShowTemplates}>\n        <DialogContent className=\"sm:max-w-lg\">\n          <DialogHeader>\n            <DialogTitle>Message Templates</DialogTitle>\n            <DialogDescription>Quick insert saved responses</DialogDescription>\n          </DialogHeader>\n          <ScrollArea className=\"h-[300px]\">\n            <div className=\"space-y-2 py-4\">\n              {templates.map((template) => (\n                <button\n                  key={template.id}\n                  onClick={() => handleUseTemplate(template)}\n                  className=\"w-full text-left p-3 border rounded-lg hover:bg-gray-50 transition-colors\"\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"font-medium\">{template.title}</span>\n                    <Badge variant=\"outline\" className=\"text-xs capitalize\">{template.category}</Badge>\n                  </div>\n                  <p className=\"text-sm text-gray-500 truncate mt-1\">{template.content}</p>\n                </button>\n              ))}\n            </div>\n          </ScrollArea>\n        </DialogContent>\n      </Dialog>\n\n      {/* ============================================\n          QUICK REPLIES MANAGER DIALOG\n          ============================================ */}\n      <Dialog open={showQuickRepliesManager} onOpenChange={actions.setShowQuickRepliesManager}>\n        <DialogContent className=\"sm:max-w-lg\">\n          <DialogHeader>\n            <DialogTitle>Quick Replies</DialogTitle>\n            <DialogDescription>Manage your quick response shortcuts</DialogDescription>\n          </DialogHeader>\n          <ScrollArea className=\"h-[300px]\">\n            <div className=\"space-y-2 py-4\">\n              {quickReplies.map((qr) => (\n                <div key={qr.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                  <div>\n                    <span className=\"font-medium\">{qr.title}</span>\n                    {qr.shortcut && (\n                      <Badge variant=\"outline\" className=\"ml-2 text-xs\">{qr.shortcut}</Badge>\n                    )}\n                    <p className=\"text-sm text-gray-500 truncate\">{qr.content}</p>\n                  </div>\n                  <div className=\"flex gap-1\">\n                    <Button \n                      size=\"sm\" \n                      variant=\"ghost\"\n                      onClick={() => {\n                        actions.setReplyText(qr.content)\n                        actions.setShowQuickRepliesManager(false)\n                      }}\n                    >\n                      Use\n                    </Button>\n                    <Button size=\"icon\" variant=\"ghost\" className=\"text-red-500\">\n                      <Trash2 className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </ScrollArea>\n          <DialogFooter>\n            <Button onClick={() => actions.setShowQuickRepliesManager(false)}>Close</Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* ============================================\n          ANNOUNCEMENT DIALOG\n          ============================================ */}\n      <Dialog open={showAnnouncement} onOpenChange={actions.setShowAnnouncement}>\n        <DialogContent className=\"sm:max-w-lg\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <Megaphone className=\"w-5 h-5\" />\n              Broadcast Announcement\n            </DialogTitle>\n            <DialogDescription>Send an announcement to all students or specific courses</DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label>Recipients</Label>\n              <select className=\"w-full border rounded-lg px-3 py-2\">\n                <option>All Students</option>\n                <option>Advanced Mathematics</option>\n                <option>Physics 101</option>\n                <option>English Literature</option>\n              </select>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Subject</Label>\n              <Input placeholder=\"Announcement title...\" />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Message</Label>\n              <Textarea placeholder=\"Your announcement...\" className=\"min-h-[150px]\" />\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <input type=\"checkbox\" id=\"schedule\" className=\"rounded\" />\n              <Label htmlFor=\"schedule\" className=\"text-sm cursor-pointer\">Schedule for later</Label>\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => actions.setShowAnnouncement(false)}>Cancel</Button>\n            <Button \n              onClick={() => { toast.success('Announcement broadcasted!'); actions.setShowAnnouncement(false); }}\n              className=\"bg-gradient-to-r from-purple-600 to-blue-600\"\n            >\n              <Megaphone className=\"w-4 h-4 mr-2\" />\n              Broadcast\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* ============================================\n          ANALYTICS DIALOG\n          ============================================ */}\n      <Dialog open={showAnalytics} onOpenChange={actions.setShowAnalytics}>\n        <DialogContent className=\"sm:max-w-2xl\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <BarChart3 className=\"w-5 h-5\" />\n              Communication Analytics\n            </DialogTitle>\n          </DialogHeader>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 py-4\">\n            <div className=\"p-4 bg-blue-50 rounded-lg text-center\">\n              <p className=\"text-2xl font-bold\">{stats.total}</p>\n              <p className=\"text-sm text-gray-600\">Total Messages</p>\n            </div>\n            <div className=\"p-4 bg-red-50 rounded-lg text-center\">\n              <p className=\"text-2xl font-bold\">{stats.unread}</p>\n              <p className=\"text-sm text-gray-600\">Unread</p>\n            </div>\n            <div className=\"p-4 bg-yellow-50 rounded-lg text-center\">\n              <p className=\"text-2xl font-bold\">{stats.unreadHighPriority}</p>\n              <p className=\"text-sm text-gray-600\">High Priority</p>\n            </div>\n            <div className=\"p-4 bg-green-50 rounded-lg text-center\">\n              <p className=\"text-2xl font-bold\">{stats.responseTime}</p>\n              <p className=\"text-sm text-gray-600\">Avg Response</p>\n            </div>\n          </div>\n          <div className=\"space-y-4\">\n            <div className=\"p-4 border rounded-lg\">\n              <h4 className=\"font-medium mb-2\">Message Distribution</h4>\n              <div className=\"space-y-2\">\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"text-sm w-20\">Today</span>\n                  <div className=\"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden\">\n                    <div className=\"h-full bg-blue-500 rounded-full\" style={{ width: `${(stats.todayMessages / stats.total) * 100}%` }} />\n                  </div>\n                  <span className=\"text-sm\">{stats.todayMessages}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"text-sm w-20\">With Files</span>\n                  <div className=\"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden\">\n                    <div className=\"h-full bg-purple-500 rounded-full\" style={{ width: `${(stats.withAttachments / stats.total) * 100}%` }} />\n                  </div>\n                  <span className=\"text-sm\">{stats.withAttachments}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"text-sm w-20\">Scheduled</span>\n                  <div className=\"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden\">\n                    <div className=\"h-full bg-yellow-500 rounded-full\" style={{ width: `${(stats.scheduled / stats.total) * 100}%` }} />\n                  </div>\n                  <span className=\"text-sm\">{stats.scheduled}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </Card>\n  )\n}\n","'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Card, CardContent } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { cn } from '@/lib/utils'\nimport {\n  Calendar,\n  Users,\n  DollarSign,\n  TrendingUp,\n  Clock,\n  Sparkles,\n  ArrowRight,\n  Activity,\n  BookOpen,\n  Award\n} from 'lucide-react'\n\ninterface ModernHeroSectionProps {\n  stats?: {\n    totalClasses: number\n    totalStudents: number\n    upcomingClasses: number\n    earnings: number\n    currency: string\n  }\n  loading?: boolean\n  onScheduleClass?: () => void\n  onCreateCourse?: () => void\n}\n\nexport function ModernHeroSection({ stats, loading, onScheduleClass, onCreateCourse }: ModernHeroSectionProps) {\n  const [greeting, setGreeting] = useState('Good morning')\n  const [currentTime, setCurrentTime] = useState(new Date())\n\n  useEffect(() => {\n    const hour = new Date().getHours()\n    if (hour < 12) setGreeting('Good morning')\n    else if (hour < 18) setGreeting('Good afternoon')\n    else setGreeting('Good evening')\n\n    const timer = setInterval(() => setCurrentTime(new Date()), 60000)\n    return () => clearInterval(timer)\n  }, [])\n\n  const formatTime = (date: Date) => {\n    return date.toLocaleTimeString('en-US', {\n      hour: '2-digit',\n      minute: '2-digit',\n      hour12: true\n    })\n  }\n\n  const formatDate = (date: Date) => {\n    return date.toLocaleDateString('en-US', {\n      weekday: 'long',\n      month: 'long',\n      day: 'numeric'\n    })\n  }\n\n  if (loading) {\n    return (\n      <div className=\"relative overflow-hidden rounded-3xl bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-8\">\n        <div className=\"animate-pulse space-y-4\">\n          <div className=\"h-8 bg-white/10 rounded w-1/3\" />\n          <div className=\"h-4 bg-white/10 rounded w-1/4\" />\n          <div className=\"grid grid-cols-4 gap-4 mt-8\">\n            {[1, 2, 3, 4].map(i => (\n              <div key={i} className=\"h-24 bg-white/10 rounded-xl\" />\n            ))}\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"relative overflow-hidden rounded-3xl bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-8\">\n      {/* Background Pattern */}\n      <div className=\"absolute inset-0 opacity-30\">\n        <div className=\"absolute top-0 left-0 w-96 h-96 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl animate-pulse\" />\n        <div className=\"absolute top-0 right-0 w-96 h-96 bg-blue-500 rounded-full mix-blend-multiply filter blur-3xl animate-pulse delay-1000\" />\n        <div className=\"absolute bottom-0 left-1/2 w-96 h-96 bg-pink-500 rounded-full mix-blend-multiply filter blur-3xl animate-pulse delay-2000\" />\n      </div>\n\n      {/* Content */}\n      <div className=\"relative z-10\">\n        {/* Header Row */}\n        <div className=\"flex items-start justify-between mb-8\">\n          <div>\n            <div className=\"flex items-center gap-2 mb-2\">\n              <Sparkles className=\"w-5 h-5 text-yellow-400\" />\n              <span className=\"text-purple-300 text-sm font-medium\">\n                {greeting}, Tutor\n              </span>\n            </div>\n            <h1 className=\"text-4xl font-bold text-white mb-2\">\n              Welcome Back!\n            </h1>\n            <p className=\"text-slate-400\">\n              {formatDate(currentTime)} • {formatTime(currentTime)}\n            </p>\n          </div>\n          <div className=\"flex items-center gap-3\">\n            <Badge className=\"bg-white/10 text-white border-white/20 backdrop-blur-sm\">\n              <Activity className=\"w-3 h-3 mr-1\" />\n              Live\n            </Badge>\n          </div>\n        </div>\n\n        {/* Quick Stats Row */}\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8\">\n          <StatCard\n            icon={BookOpen}\n            label=\"Total Classes\"\n            value={stats?.totalClasses || 0}\n            trend=\"+12%\"\n            trendUp\n            color=\"from-blue-500 to-cyan-500\"\n          />\n          <StatCard\n            icon={Users}\n            label=\"Active Students\"\n            value={stats?.totalStudents || 0}\n            trend=\"+8%\"\n            trendUp\n            color=\"from-purple-500 to-pink-500\"\n          />\n          <StatCard\n            icon={Calendar}\n            label=\"Upcoming\"\n            value={stats?.upcomingClasses || 0}\n            sublabel=\"This week\"\n            color=\"from-orange-500 to-red-500\"\n          />\n          <StatCard\n            icon={DollarSign}\n            label=\"Earnings\"\n            value={`${stats?.currency || 'SGD'} ${(stats?.earnings || 0).toLocaleString()}`}\n            trend=\"+23%\"\n            trendUp\n            color=\"from-green-500 to-emerald-500\"\n          />\n        </div>\n\n        {/* Action Bar */}\n        <div className=\"flex flex-wrap items-center gap-4\">\n          <Button\n            className=\"bg-white text-slate-900 hover:bg-white/90 font-medium shadow-lg\"\n            onClick={onScheduleClass}\n          >\n            <Calendar className=\"w-4 h-4 mr-2\" />\n            Schedule Class\n            <ArrowRight className=\"w-4 h-4 ml-2\" />\n          </Button>\n          <Button\n            className=\"bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:from-purple-600 hover:to-pink-600 font-medium shadow-lg border-0\"\n            onClick={onCreateCourse}\n          >\n            <Award className=\"w-4 h-4 mr-2\" />\n            Create Course\n          </Button>\n          <div className=\"flex-1\" />\n          <div className=\"flex items-center gap-2 text-sm text-slate-400\">\n            <Clock className=\"w-4 h-4\" />\n            <span>Next class in 2h 15m</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\ninterface StatCardProps {\n  icon: any\n  label: string\n  value: string | number\n  sublabel?: string\n  trend?: string\n  trendUp?: boolean\n  color: string\n}\n\nfunction StatCard({ icon: Icon, label, value, sublabel, trend, trendUp, color }: StatCardProps) {\n  return (\n    <div className=\"group relative overflow-hidden rounded-2xl bg-white/5 backdrop-blur-sm border border-white/10 p-4 hover:bg-white/10 transition-all cursor-pointer\">\n      <div className={cn(\"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br opacity-20 rounded-bl-full\", color)} />\n      <div className=\"relative\">\n        <div className={cn(\"w-10 h-10 rounded-xl bg-gradient-to-br flex items-center justify-center mb-3\", color)}>\n          <Icon className=\"w-5 h-5 text-white\" />\n        </div>\n        <p className=\"text-slate-400 text-xs font-medium mb-1\">{label}</p>\n        <div className=\"flex items-end justify-between\">\n          <p className=\"text-2xl font-bold text-white\">{value}</p>\n          {sublabel && (\n            <p className=\"text-slate-400 text-xs\">{sublabel}</p>\n          )}\n          {trend && (\n            <div className={cn(\n              \"flex items-center text-xs font-medium\",\n              trendUp ? \"text-green-400\" : \"text-red-400\"\n            )}>\n              <TrendingUp className={cn(\"w-3 h-3 mr-0.5\", !trendUp && \"rotate-180\")} />\n              {trend}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n","'use client'\n\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { cn } from '@/lib/utils'\nimport { ReactNode } from 'react'\n\ninterface GlassCardProps {\n  children: ReactNode\n  title?: string\n  icon?: React.ComponentType<{ className?: string }>\n  className?: string\n  headerClassName?: string\n  gradient?: 'purple' | 'blue' | 'green' | 'orange' | 'pink' | 'none'\n  badge?: string | number\n  action?: ReactNode\n}\n\nexport function GlassCard({ \n  children, \n  title, \n  icon: Icon, \n  className,\n  headerClassName,\n  gradient = 'none',\n  badge,\n  action\n}: GlassCardProps) {\n  const gradientStyles = {\n    purple: 'from-purple-500/10 to-pink-500/10 border-purple-200/50',\n    blue: 'from-blue-500/10 to-cyan-500/10 border-blue-200/50',\n    green: 'from-green-500/10 to-emerald-500/10 border-green-200/50',\n    orange: 'from-orange-500/10 to-amber-500/10 border-orange-200/50',\n    pink: 'from-pink-500/10 to-rose-500/10 border-pink-200/50',\n    none: 'border-gray-200'\n  }\n\n  return (\n    <Card className={cn(\n      \"overflow-hidden bg-white/80 backdrop-blur-xl border\",\n      gradient !== 'none' && `bg-gradient-to-br ${gradientStyles[gradient]}`,\n      className\n    )}>\n      {title && (\n        <CardHeader className={cn(\"pb-3\", headerClassName)}>\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              {Icon && (\n                <div className={cn(\n                  \"w-8 h-8 rounded-lg flex items-center justify-center\",\n                  gradient === 'purple' ? \"bg-purple-100 text-purple-600\" :\n                  gradient === 'blue' ? \"bg-blue-100 text-blue-600\" :\n                  gradient === 'green' ? \"bg-green-100 text-green-600\" :\n                  gradient === 'orange' ? \"bg-orange-100 text-orange-600\" :\n                  gradient === 'pink' ? \"bg-pink-100 text-pink-600\" :\n                  \"bg-gray-100 text-gray-600\"\n                )}>\n                  <Icon className=\"w-4 h-4\" />\n                </div>\n              )}\n              <CardTitle className=\"text-base font-semibold\">{title}</CardTitle>\n              {badge !== undefined && (\n                <span className={cn(\n                  \"px-2 py-0.5 rounded-full text-xs font-medium\",\n                  gradient === 'purple' ? \"bg-purple-100 text-purple-700\" :\n                  gradient === 'blue' ? \"bg-blue-100 text-blue-700\" :\n                  gradient === 'green' ? \"bg-green-100 text-green-700\" :\n                  gradient === 'orange' ? \"bg-orange-100 text-orange-700\" :\n                  gradient === 'pink' ? \"bg-pink-100 text-pink-700\" :\n                  \"bg-gray-100 text-gray-700\"\n                )}>\n                  {badge}\n                </span>\n              )}\n            </div>\n            {action && <div>{action}</div>}\n          </div>\n        </CardHeader>\n      )}\n      <CardContent className={cn(\"pt-0\", !title && \"pt-6\")}>\n        {children}\n      </CardContent>\n    </Card>\n  )\n}\n","'use client'\n\nimport { useState, useMemo, useEffect, useCallback } from 'react'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Checkbox } from '@/components/ui/checkbox'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from '@/components/ui/dialog'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { Switch } from '@/components/ui/switch'\nimport { cn } from '@/lib/utils'\nimport { toast } from 'sonner'\n\n// DnD Kit imports\nimport {\n  DndContext,\n  DragOverlay,\n  closestCorners,\n  KeyboardSensor,\n  PointerSensor,\n  useSensor,\n  useSensors,\n  DragStartEvent,\n  DragEndEvent,\n  useDraggable,\n  useDroppable,\n} from '@dnd-kit/core'\nimport { CSS } from '@dnd-kit/utilities'\n\nimport {\n  ChevronLeft,\n  ChevronRight,\n  Calendar as CalendarIcon,\n  Clock,\n  Users,\n  Plus,\n  MapPin,\n  Video,\n  MoreVertical,\n  Edit,\n  Trash2,\n  AlertCircle,\n  Filter,\n  Bell,\n  Repeat,\n  X,\n  CheckCircle2,\n  AlertTriangle,\n  GripVertical,\n  CalendarPlus,\n  RefreshCw,\n  ExternalLink,\n  Copy,\n  Layers\n} from 'lucide-react'\n\n// Date manipulation\nimport {\n  addDays,\n  addWeeks,\n  format,\n  isSameDay,\n  startOfWeek,\n  eachDayOfInterval,\n  isWithinInterval\n} from 'date-fns'\n\ninterface CalendarEvent {\n  id: string\n  title: string\n  date: Date\n  duration: number\n  type: 'class' | 'office_hours' | 'personal' | 'deadline'\n  status: 'scheduled' | 'live' | 'completed' | 'cancelled'\n  studentCount?: number\n  maxStudents?: number\n  subject?: string\n  location?: string\n  isOnline?: boolean\n  description?: string\n  color?: string\n  isRecurring?: boolean\n  recurringPattern?: 'daily' | 'weekly' | 'biweekly' | 'monthly'\n}\n\ninterface AvailabilityBlock {\n  id: string\n  dayOfWeek: number\n  startTime: string\n  endTime: string\n  isAvailable: boolean\n}\n\ninterface CalendarConnection {\n  id: string\n  provider: 'google' | 'outlook' | 'apple'\n  connected: boolean\n  email?: string\n  lastSynced?: Date\n  syncEnabled: boolean\n}\n\ninterface InteractiveCalendarProps {\n  events?: CalendarEvent[]\n  onEventClick?: (event: CalendarEvent) => void\n  onDateClick?: (date: Date) => void\n  onCreateClass?: (date: Date) => void\n  onEventUpdate?: (event: CalendarEvent) => void\n  loading?: boolean\n}\n\nconst SUBJECTS = [\n  { name: 'Mathematics', color: 'bg-blue-500' },\n  { name: 'Physics', color: 'bg-purple-500' },\n  { name: 'English', color: 'bg-green-500' },\n  { name: 'Chemistry', color: 'bg-orange-500' },\n  { name: 'Biology', color: 'bg-pink-500' },\n  { name: 'History', color: 'bg-red-500' },\n  { name: 'Office Hours', color: 'bg-gray-500' }\n]\n\nconst generateDemoEvents = (): CalendarEvent[] => {\n  const today = new Date()\n  const events: CalendarEvent[] = []\n\n  // Generate recurring weekly classes\n  const recurringClasses = [\n    { title: 'Advanced Mathematics', subject: 'Mathematics', duration: 60, students: 12, max: 20, day: 1, time: 14, color: 'bg-blue-500', isRecurring: true, pattern: 'weekly' as const },\n    { title: 'Physics 101', subject: 'Physics', duration: 90, students: 8, max: 15, day: 2, time: 16, color: 'bg-purple-500', isRecurring: true, pattern: 'weekly' as const },\n    { title: 'English Literature', subject: 'English', duration: 60, students: 15, max: 25, day: 3, time: 14, color: 'bg-green-500', isRecurring: true, pattern: 'weekly' as const },\n    { title: 'Chemistry Lab', subject: 'Chemistry', duration: 120, students: 6, max: 10, day: 4, time: 15, color: 'bg-orange-500', isRecurring: true, pattern: 'weekly' as const },\n    { title: 'Office Hours', subject: 'Office Hours', duration: 60, students: 0, max: 5, day: 5, time: 17, color: 'bg-gray-500', type: 'office_hours' as const, isRecurring: true, pattern: 'weekly' as const },\n  ]\n\n  // Generate 4 weeks of recurring classes\n  for (let week = 0; week < 4; week++) {\n    recurringClasses.forEach((cls, idx) => {\n      const eventDate = new Date(today)\n      eventDate.setDate(today.getDate() - today.getDay() + cls.day + (week * 7))\n      eventDate.setHours(cls.time, 0, 0, 0)\n\n      if (eventDate >= new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000)) {\n        events.push({\n          id: `recurring-${week}-${idx}`,\n          title: cls.title,\n          date: eventDate,\n          duration: cls.duration,\n          type: cls.type || 'class',\n          status: eventDate < today ? 'completed' : 'scheduled',\n          studentCount: cls.students,\n          maxStudents: cls.max,\n          subject: cls.subject,\n          isOnline: Math.random() > 0.3,\n          description: `Regular ${cls.pattern} class session`,\n          color: cls.color,\n          isRecurring: cls.isRecurring,\n          recurringPattern: cls.pattern\n        })\n      }\n    })\n  }\n\n  // Add some one-time events\n  events.push({\n    id: 'special-1',\n    title: 'Parent-Teacher Meeting',\n    date: new Date(today.getTime() + 2 * 24 * 60 * 60 * 1000),\n    duration: 60,\n    type: 'personal',\n    status: 'scheduled',\n    subject: 'Office Hours',\n    color: 'bg-red-500'\n  })\n\n  return events\n}\n\nconst generateAvailability = (): AvailabilityBlock[] => [\n  { id: '1', dayOfWeek: 1, startTime: '09:00', endTime: '12:00', isAvailable: true },\n  { id: '2', dayOfWeek: 1, startTime: '14:00', endTime: '18:00', isAvailable: true },\n  { id: '3', dayOfWeek: 2, startTime: '09:00', endTime: '12:00', isAvailable: true },\n  { id: '4', dayOfWeek: 2, startTime: '14:00', endTime: '18:00', isAvailable: true },\n  { id: '5', dayOfWeek: 3, startTime: '09:00', endTime: '12:00', isAvailable: true },\n  { id: '6', dayOfWeek: 3, startTime: '14:00', endTime: '18:00', isAvailable: true },\n  { id: '7', dayOfWeek: 4, startTime: '09:00', endTime: '12:00', isAvailable: true },\n  { id: '8', dayOfWeek: 4, startTime: '14:00', endTime: '18:00', isAvailable: true },\n  { id: '9', dayOfWeek: 5, startTime: '09:00', endTime: '12:00', isAvailable: true },\n  { id: '10', dayOfWeek: 5, startTime: '14:00', endTime: '17:00', isAvailable: true },\n]\n\ntype CalendarView = 'month' | 'week' | 'day' | 'availability'\n\n// Draggable Event Component\nfunction DraggableEvent({\n  event,\n  onClick,\n  hasConflict,\n  style = {}\n}: {\n  event: CalendarEvent\n  onClick: () => void\n  hasConflict?: boolean\n  style?: React.CSSProperties\n}) {\n  const { attributes, listeners, setNodeRef, transform, isDragging } = useDraggable({\n    id: event.id,\n    data: { event }\n  })\n\n  const cssTransform = CSS.Transform.toString(transform)\n\n  return (\n    <div\n      ref={setNodeRef}\n      {...listeners}\n      {...attributes}\n      style={{\n        ...style,\n        transform: cssTransform,\n        opacity: isDragging ? 0.5 : 1,\n        cursor: 'grab'\n      }}\n      className={cn(\n        \"absolute left-1 right-1 rounded p-2 cursor-pointer text-xs overflow-hidden group\",\n        event.color || 'bg-blue-500',\n        event.status === 'cancelled' && \"opacity-50\",\n        hasConflict && \"ring-2 ring-red-500 ring-offset-1\"\n      )}\n      onClick={(e) => {\n        e.stopPropagation()\n        onClick()\n      }}\n    >\n      <div className=\"flex items-start justify-between\">\n        <div className=\"flex-1 min-w-0\">\n          <p className=\"font-medium text-white truncate\">{event.title}</p>\n          <p className=\"text-white/80\">\n            {event.date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })}\n          </p>\n        </div>\n        <GripVertical className=\"w-3 h-3 text-white/50 opacity-0 group-hover:opacity-100 transition-opacity\" />\n      </div>\n      {hasConflict && (\n        <AlertTriangle className=\"w-3 h-3 text-white absolute top-1 right-1\" />\n      )}\n    </div>\n  )\n}\n\nexport function InteractiveCalendar({\n  events: initialEvents,\n  onEventClick,\n  onDateClick,\n  onCreateClass,\n  onEventUpdate,\n  loading\n}: InteractiveCalendarProps) {\n  const [events, setEvents] = useState<CalendarEvent[]>(initialEvents || generateDemoEvents())\n  const [availability, setAvailability] = useState<AvailabilityBlock[]>(generateAvailability())\n  const [currentDate, setCurrentDate] = useState(new Date())\n  const [view, setView] = useState<CalendarView>('month')\n  const [selectedEvent, setSelectedEvent] = useState<CalendarEvent | null>(null)\n  const [selectedDate, setSelectedDate] = useState<Date | null>(null)\n  const [subjectFilter, setSubjectFilter] = useState<string>('all')\n  const [typeFilter, setTypeFilter] = useState<string>('all')\n  const [showConflictWarning, setShowConflictWarning] = useState<CalendarEvent[]>([])\n  const [notifications, setNotifications] = useState<string[]>([])\n\n  // New feature states\n  const [showBatchModal, setShowBatchModal] = useState(false)\n  const [showCalendarIntegrations, setShowCalendarIntegrations] = useState(false)\n  const [activeDragEvent, setActiveDragEvent] = useState<CalendarEvent | null>(null)\n  const [calendarConnections, setCalendarConnections] = useState<CalendarConnection[]>([\n    { id: '1', provider: 'google', connected: false, syncEnabled: true },\n    { id: '2', provider: 'outlook', connected: false, syncEnabled: true },\n    { id: '3', provider: 'apple', connected: false, syncEnabled: false },\n  ])\n\n  // DnD Sensors\n  const sensors = useSensors(\n    useSensor(PointerSensor, {\n      activationConstraint: {\n        distance: 8,\n      },\n    }),\n    useSensor(KeyboardSensor, {\n      coordinateGetter: (event: any) => {\n        const { active } = event\n        const node = active?.rect?.current?.translated\n        return node ? { x: node.left, y: node.top } : { x: 0, y: 0 }\n      },\n    })\n  )\n\n  // Check for conflicts\n  useEffect(() => {\n    const conflicts: CalendarEvent[] = []\n    events.forEach((event1, i) => {\n      events.forEach((event2, j) => {\n        if (i >= j) return\n        if (event1.date.toDateString() === event2.date.toDateString()) {\n          const start1 = event1.date.getTime()\n          const end1 = start1 + event1.duration * 60000\n          const start2 = event2.date.getTime()\n          const end2 = start2 + event2.duration * 60000\n\n          if ((start1 < end2 && end1 > start2)) {\n            conflicts.push(event1, event2)\n          }\n        }\n      })\n    })\n\n    const uniqueConflicts = Array.from(new Set(conflicts))\n    if (uniqueConflicts.length > 0) {\n      setShowConflictWarning(uniqueConflicts)\n    }\n  }, [events])\n\n  // Upcoming notifications\n  useEffect(() => {\n    const upcoming = events.filter(e => {\n      const timeDiff = e.date.getTime() - new Date().getTime()\n      return timeDiff > 0 && timeDiff < 24 * 60 * 60 * 1000 && e.status === 'scheduled'\n    })\n\n    if (upcoming.length > 0) {\n      setNotifications(upcoming.map(e => `${e.title} at ${e.date.toLocaleTimeString()}`))\n    }\n  }, [events])\n\n  const filteredEvents = useMemo(() => {\n    return events.filter(event => {\n      const matchesSubject = subjectFilter === 'all' || event.subject === subjectFilter\n      const matchesType = typeFilter === 'all' || event.type === typeFilter\n      return matchesSubject && matchesType\n    })\n  }, [events, subjectFilter, typeFilter])\n\n  const daysOfWeek = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']\n  const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',\n    'July', 'August', 'September', 'October', 'November', 'December']\n\n  const calendarDays = useMemo(() => {\n    const year = currentDate.getFullYear()\n    const month = currentDate.getMonth()\n\n    const firstDay = new Date(year, month, 1)\n    const lastDay = new Date(year, month + 1, 0)\n    const daysInMonth = lastDay.getDate()\n    const startingDayOfWeek = firstDay.getDay()\n\n    const days: (Date | null)[] = []\n\n    for (let i = 0; i < startingDayOfWeek; i++) {\n      days.push(null)\n    }\n\n    for (let i = 1; i <= daysInMonth; i++) {\n      days.push(new Date(year, month, i))\n    }\n\n    return days\n  }, [currentDate])\n\n  const getEventsForDate = (date: Date) => {\n    return filteredEvents.filter(event => {\n      const eventDate = new Date(event.date)\n      return eventDate.toDateString() === date.toDateString()\n    }).sort((a, b) => a.date.getTime() - b.date.getTime())\n  }\n\n  const navigateMonth = (direction: number) => {\n    setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + direction, 1))\n  }\n\n  const goToToday = () => {\n    setCurrentDate(new Date())\n  }\n\n  const handleDateClick = (date: Date) => {\n    setSelectedDate(date)\n    onDateClick?.(date)\n  }\n\n  const handleEventClick = (event: CalendarEvent) => {\n    setSelectedEvent(event)\n    onEventClick?.(event)\n  }\n\n  const isToday = (date: Date) => {\n    return date.toDateString() === new Date().toDateString()\n  }\n\n  const toggleAvailability = (id: string) => {\n    setAvailability(prev => prev.map(block =>\n      block.id === id ? { ...block, isAvailable: !block.isAvailable } : block\n    ))\n  }\n\n  // DnD Handlers\n  const handleDragStart = useCallback((event: DragStartEvent) => {\n    const { active } = event\n    const draggedEvent = events.find(e => e.id === active.id)\n    if (draggedEvent) {\n      setActiveDragEvent(draggedEvent)\n    }\n  }, [events])\n\n  const handleDragEnd = useCallback((event: DragEndEvent) => {\n    const { active, over } = event\n\n    if (over && active.id !== over.id) {\n      const draggedEvent = events.find(e => e.id === active.id)\n      const dropData = over.data.current as { date?: Date; hour?: number } | undefined\n\n      if (draggedEvent && dropData?.date) {\n        const newDate = new Date(dropData.date)\n        if (dropData.hour !== undefined) {\n          newDate.setHours(dropData.hour, draggedEvent.date.getMinutes(), 0, 0)\n        } else {\n          newDate.setHours(draggedEvent.date.getHours(), draggedEvent.date.getMinutes(), 0, 0)\n        }\n\n        const updatedEvent = { ...draggedEvent, date: newDate }\n\n        setEvents(prev => prev.map(e => e.id === draggedEvent.id ? updatedEvent : e))\n        onEventUpdate?.(updatedEvent)\n        toast.success(`Rescheduled: ${draggedEvent.title} to ${format(newDate, 'MMM d, h:mm a')}`)\n      }\n    }\n\n    setActiveDragEvent(null)\n  }, [events, onEventUpdate])\n\n  // Calendar Integration Handlers\n  const connectCalendar = (provider: 'google' | 'outlook' | 'apple') => {\n    // In real implementation, this would open OAuth flow\n    toast.loading(`Connecting to ${provider} calendar...`)\n\n    // Simulate connection\n    setTimeout(() => {\n      setCalendarConnections(prev => prev.map(conn =>\n        conn.provider === provider\n          ? { ...conn, connected: true, email: `tutor@${provider}.com`, lastSynced: new Date() }\n          : conn\n      ))\n      toast.success(`Connected to ${provider} calendar!`)\n    }, 1500)\n  }\n\n  const disconnectCalendar = (provider: string) => {\n    setCalendarConnections(prev => prev.map(conn =>\n      conn.provider === provider\n        ? { ...conn, connected: false, email: undefined, lastSynced: undefined }\n        : conn\n    ))\n    toast.success(`Disconnected from ${provider}`)\n  }\n\n  const syncCalendars = () => {\n    toast.loading('Syncing calendars...')\n    setTimeout(() => {\n      setCalendarConnections(prev => prev.map(conn =>\n        conn.connected ? { ...conn, lastSynced: new Date() } : conn\n      ))\n      toast.success('Calendars synced!')\n    }, 2000)\n  }\n\n  if (loading) {\n    return (\n      <Card className=\"h-[600px]\">\n        <CardContent className=\"flex items-center justify-center h-full\">\n          <div className=\"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full\" />\n        </CardContent>\n      </Card>\n    )\n  }\n\n  return (\n    <DndContext\n      sensors={sensors}\n      collisionDetection={closestCorners}\n      onDragStart={handleDragStart}\n      onDragEnd={handleDragEnd}\n    >\n      <Card className=\"h-full\">\n        <CardHeader className=\"pb-3\">\n          <div className=\"flex items-center justify-between flex-wrap gap-4\">\n            <div className=\"flex items-center gap-4\">\n              <CardTitle className=\"text-xl flex items-center gap-2\">\n                <CalendarIcon className=\"w-5 h-5 text-blue-500\" />\n                Calendar\n                {notifications.length > 0 && (\n                  <Badge variant=\"destructive\" className=\"text-xs\">\n                    <Bell className=\"w-3 h-3 mr-1\" />\n                    {notifications.length}\n                  </Badge>\n                )}\n              </CardTitle>\n              <div className=\"flex items-center gap-2\">\n                <Button variant=\"outline\" size=\"icon\" onClick={() => navigateMonth(-1)}>\n                  <ChevronLeft className=\"w-4 h-4\" />\n                </Button>\n                <h2 className=\"text-lg font-semibold min-w-[150px] text-center\">\n                  {monthNames[currentDate.getMonth()]} {currentDate.getFullYear()}\n                </h2>\n                <Button variant=\"outline\" size=\"icon\" onClick={() => navigateMonth(1)}>\n                  <ChevronRight className=\"w-4 h-4\" />\n                </Button>\n              </div>\n              <Button variant=\"outline\" size=\"sm\" onClick={goToToday}>\n                Today\n              </Button>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              {/* Calendar Integrations */}\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => setShowCalendarIntegrations(true)}\n              >\n                <RefreshCw className={cn(\n                  \"w-4 h-4 mr-2\",\n                  calendarConnections.some(c => c.connected) && \"text-green-500\"\n                )} />\n                Sync\n              </Button>\n\n              {/* Batch Create */}\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => setShowBatchModal(true)}\n              >\n                <Layers className=\"w-4 h-4 mr-2\" />\n                Batch\n              </Button>\n\n              {/* Filters */}\n              <Select value={subjectFilter} onValueChange={setSubjectFilter}>\n                <SelectTrigger className=\"w-36\">\n                  <Filter className=\"w-4 h-4 mr-2\" />\n                  <SelectValue placeholder=\"Filter\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Subjects</SelectItem>\n                  {SUBJECTS.map(s => (\n                    <SelectItem key={s.name} value={s.name}>{s.name}</SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n\n              {/* View Toggle */}\n              <div className=\"flex bg-gray-100 rounded-lg p-1\">\n                {(['month', 'week', 'day', 'availability'] as CalendarView[]).map((v) => (\n                  <button\n                    key={v}\n                    onClick={() => setView(v)}\n                    className={cn(\n                      \"px-3 py-1 rounded-md text-sm font-medium transition-colors capitalize\",\n                      view === v ? \"bg-white shadow-sm\" : \"text-gray-600 hover:text-gray-900\"\n                    )}\n                  >\n                    {v === 'availability' ? 'My Availability' : v}\n                  </button>\n                ))}\n              </div>\n\n              <Button onClick={() => onCreateClass?.(selectedDate || new Date())}>\n                <Plus className=\"w-4 h-4 mr-2\" />\n                Add\n              </Button>\n            </div>\n          </div>\n\n          {/* Conflict Warning Banner */}\n          {showConflictWarning.length > 0 && (\n            <div className=\"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3\">\n              <AlertTriangle className=\"w-5 h-5 text-red-500\" />\n              <div className=\"flex-1\">\n                <p className=\"text-sm font-medium text-red-800\">\n                  {showConflictWarning.length / 2} scheduling conflicts detected\n                </p>\n                <p className=\"text-xs text-red-600\">\n                  Some classes overlap in time. Drag events to reschedule or click &quot;View&quot; to see conflicts.\n                </p>\n              </div>\n              <Button variant=\"outline\" size=\"sm\" onClick={() => setView('week')}>\n                View\n              </Button>\n              <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowConflictWarning([])}>\n                <X className=\"w-4 h-4\" />\n              </Button>\n            </div>\n          )}\n\n          {/* Legend */}\n          <div className=\"flex items-center gap-4 mt-4 text-sm flex-wrap\">\n            {SUBJECTS.map((subject) => (\n              <button\n                key={subject.name}\n                onClick={() => setSubjectFilter(subjectFilter === subject.name ? 'all' : subject.name)}\n                className={cn(\n                  \"flex items-center gap-1 px-2 py-1 rounded-full transition-colors\",\n                  subjectFilter === subject.name ? \"bg-gray-200\" : \"hover:bg-gray-100\"\n                )}\n              >\n                <div className={cn(\"w-3 h-3 rounded-full\", subject.color)} />\n                <span>{subject.name}</span>\n              </button>\n            ))}\n            {subjectFilter !== 'all' && (\n              <Button variant=\"ghost\" size=\"sm\" onClick={() => setSubjectFilter('all')}>\n                Clear Filter\n              </Button>\n            )}\n          </div>\n        </CardHeader>\n\n        <CardContent className=\"pt-0\">\n          {view === 'month' && (\n            <MonthView\n              days={calendarDays}\n              events={filteredEvents}\n              onDateClick={handleDateClick}\n              onEventClick={handleEventClick}\n              isToday={isToday}\n              getEventsForDate={getEventsForDate}\n              conflicts={showConflictWarning}\n            />\n          )}\n\n          {view === 'week' && (\n            <WeekView\n              currentDate={currentDate}\n              events={filteredEvents}\n              onEventClick={handleEventClick}\n              onDateClick={handleDateClick}\n              conflicts={showConflictWarning}\n            />\n          )}\n\n          {view === 'day' && (\n            <DayView\n              currentDate={currentDate}\n              events={filteredEvents}\n              onEventClick={handleEventClick}\n              conflicts={showConflictWarning}\n            />\n          )}\n\n          {view === 'availability' && (\n            <AvailabilityView\n              availability={availability}\n              onToggle={toggleAvailability}\n              onSave={() => {\n                toast.success('Availability updated!')\n                setView('month')\n              }}\n            />\n          )}\n        </CardContent>\n\n        {/* Event Detail Dialog */}\n        <Dialog open={!!selectedEvent} onOpenChange={() => setSelectedEvent(null)}>\n          <DialogContent className=\"sm:max-w-lg\">\n            {selectedEvent && (\n              <>\n                <DialogHeader>\n                  <div className=\"flex items-start justify-between\">\n                    <div>\n                      <DialogTitle className=\"text-xl\">{selectedEvent.title}</DialogTitle>\n                      <DialogDescription className=\"mt-1\">\n                        {selectedEvent.subject} • {selectedEvent.duration} minutes\n                      </DialogDescription>\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <Badge className={cn(selectedEvent.color || 'bg-blue-500')}>\n                        {selectedEvent.type}\n                      </Badge>\n                      {selectedEvent.isRecurring && (\n                        <Badge variant=\"outline\" className=\"gap-1\">\n                          <Repeat className=\"w-3 h-3\" />\n                          {selectedEvent.recurringPattern}\n                        </Badge>\n                      )}\n                    </div>\n                  </div>\n                </DialogHeader>\n\n                <div className=\"space-y-4 py-4\">\n                  <div className=\"flex items-center gap-3 p-3 bg-gray-50 rounded-lg\">\n                    <Clock className=\"w-5 h-5 text-gray-500\" />\n                    <div>\n                      <p className=\"font-medium\">\n                        {selectedEvent.date.toLocaleDateString('en-US', {\n                          weekday: 'long',\n                          month: 'long',\n                          day: 'numeric'\n                        })}\n                      </p>\n                      <p className=\"text-sm text-gray-500\">\n                        {selectedEvent.date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })} -\n                        {new Date(selectedEvent.date.getTime() + selectedEvent.duration * 60000).toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })}\n                      </p>\n                    </div>\n                  </div>\n\n                  {selectedEvent.type === 'class' && (\n                    <div className=\"flex items-center gap-3 p-3 bg-gray-50 rounded-lg\">\n                      <Users className=\"w-5 h-5 text-gray-500\" />\n                      <div>\n                        <p className=\"font-medium\">\n                          {selectedEvent.studentCount} / {selectedEvent.maxStudents} students enrolled\n                        </p>\n                        <p className=\"text-sm text-gray-500\">\n                          {selectedEvent.maxStudents && selectedEvent.studentCount &&\n                            selectedEvent.maxStudents - selectedEvent.studentCount} spots remaining\n                        </p>\n                      </div>\n                    </div>\n                  )}\n\n                  <div className=\"flex items-center gap-3 p-3 bg-gray-50 rounded-lg\">\n                    {selectedEvent.isOnline ? (\n                      <Video className=\"w-5 h-5 text-gray-500\" />\n                    ) : (\n                      <MapPin className=\"w-5 h-5 text-gray-500\" />\n                    )}\n                    <p className=\"font-medium\">\n                      {selectedEvent.isOnline ? 'Online Class' : 'In-Person'}\n                    </p>\n                  </div>\n\n                  {/* Conflict Warning in Detail */}\n                  {showConflictWarning.find(e => e.id === selectedEvent.id) && (\n                    <div className=\"flex items-center gap-2 p-3 bg-red-50 text-red-700 rounded-lg\">\n                      <AlertTriangle className=\"w-5 h-5\" />\n                      <span>This class has a scheduling conflict!</span>\n                    </div>\n                  )}\n                </div>\n\n                <DialogFooter className=\"gap-2\">\n                  <Button variant=\"outline\" onClick={() => setSelectedEvent(null)}>\n                    Close\n                  </Button>\n                  {selectedEvent.isRecurring && (\n                    <Button variant=\"outline\">\n                      <Repeat className=\"w-4 h-4 mr-2\" />\n                      Edit Series\n                    </Button>\n                  )}\n                  <Button\n                    className=\"bg-gradient-to-r from-purple-600 to-blue-600\"\n                    onClick={() => {\n                      toast.success('Joining class...')\n                      setSelectedEvent(null)\n                    }}\n                  >\n                    <Video className=\"w-4 h-4 mr-2\" />\n                    Join Class\n                  </Button>\n                </DialogFooter>\n              </>\n            )}\n          </DialogContent>\n        </Dialog>\n\n        {/* Date Selection Dialog */}\n        <Dialog open={!!selectedDate && !selectedEvent} onOpenChange={() => setSelectedDate(null)}>\n          <DialogContent className=\"sm:max-w-md\">\n            <DialogHeader>\n              <DialogTitle>\n                {selectedDate?.toLocaleDateString('en-US', {\n                  weekday: 'long',\n                  month: 'long',\n                  day: 'numeric'\n                })}\n              </DialogTitle>\n              <DialogDescription>\n                {getEventsForDate(selectedDate || new Date()).length} events scheduled\n              </DialogDescription>\n            </DialogHeader>\n\n            <div className=\"space-y-3 py-4\">\n              {getEventsForDate(selectedDate || new Date()).map((event) => (\n                <div\n                  key={event.id}\n                  className=\"p-3 border rounded-lg hover:bg-gray-50 cursor-pointer\"\n                  onClick={() => {\n                    setSelectedDate(null)\n                    handleEventClick(event)\n                  }}\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <div className={cn(\"w-3 h-3 rounded-full\", event.color || 'bg-blue-500')} />\n                    <div className=\"flex-1\">\n                      <p className=\"font-medium\">{event.title}</p>\n                      <p className=\"text-sm text-gray-500\">\n                        {event.date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })}\n                      </p>\n                    </div>\n                    {showConflictWarning.find(e => e.id === event.id) && (\n                      <AlertTriangle className=\"w-4 h-4 text-red-500\" />\n                    )}\n                    <ChevronRight className=\"w-4 h-4 text-gray-400\" />\n                  </div>\n                </div>\n              ))}\n\n              {getEventsForDate(selectedDate || new Date()).length === 0 && (\n                <p className=\"text-center text-gray-500 py-4\">No events scheduled for this day</p>\n              )}\n            </div>\n\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={() => setSelectedDate(null)}>\n                Close\n              </Button>\n              <Button onClick={() => {\n                onCreateClass?.(selectedDate || new Date())\n                setSelectedDate(null)\n              }}>\n                <Plus className=\"w-4 h-4 mr-2\" />\n                Schedule Class\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        {/* Calendar Integrations Modal */}\n        <Dialog open={showCalendarIntegrations} onOpenChange={setShowCalendarIntegrations}>\n          <DialogContent className=\"sm:max-w-md\">\n            <DialogHeader>\n              <DialogTitle className=\"flex items-center gap-2\">\n                <RefreshCw className=\"w-5 h-5\" />\n                Calendar Integrations\n              </DialogTitle>\n              <DialogDescription>\n                Sync your schedule with external calendars\n              </DialogDescription>\n            </DialogHeader>\n\n            <div className=\"space-y-4 py-4\">\n              {calendarConnections.map((connection) => (\n                <div\n                  key={connection.id}\n                  className={cn(\n                    \"p-4 border rounded-lg transition-colors\",\n                    connection.connected ? \"border-green-200 bg-green-50/50\" : \"border-gray-200\"\n                  )}\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className={cn(\n                        \"w-10 h-10 rounded-lg flex items-center justify-center\",\n                        connection.provider === 'google' && \"bg-blue-100 text-blue-600\",\n                        connection.provider === 'outlook' && \"bg-blue-600 text-white\",\n                        connection.provider === 'apple' && \"bg-gray-900 text-white\"\n                      )}>\n                        {connection.provider === 'google' && <CalendarIcon className=\"w-5 h-5\" />}\n                        {connection.provider === 'outlook' && <ExternalLink className=\"w-5 h-5\" />}\n                        {connection.provider === 'apple' && <CalendarIcon className=\"w-5 h-5\" />}\n                      </div>\n                      <div>\n                        <p className=\"font-medium capitalize\">{connection.provider} Calendar</p>\n                        {connection.connected ? (\n                          <p className=\"text-xs text-green-600 flex items-center gap-1\">\n                            <CheckCircle2 className=\"w-3 h-3\" />\n                            Connected{connection.email && ` • ${connection.email}`}\n                          </p>\n                        ) : (\n                          <p className=\"text-xs text-gray-500\">Not connected</p>\n                        )}\n                      </div>\n                    </div>\n\n                    <div className=\"flex items-center gap-2\">\n                      {connection.connected ? (\n                        <>\n                          <Switch\n                            checked={connection.syncEnabled}\n                            onCheckedChange={(checked) => {\n                              setCalendarConnections(prev => prev.map(c =>\n                                c.id === connection.id ? { ...c, syncEnabled: checked } : c\n                              ))\n                            }}\n                          />\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => disconnectCalendar(connection.provider)}\n                          >\n                            <X className=\"w-4 h-4\" />\n                          </Button>\n                        </>\n                      ) : (\n                        <Button\n                          size=\"sm\"\n                          onClick={() => connectCalendar(connection.provider)}\n                        >\n                          Connect\n                        </Button>\n                      )}\n                    </div>\n                  </div>\n\n                  {connection.connected && connection.lastSynced && (\n                    <p className=\"text-xs text-gray-500 mt-2\">\n                      Last synced: {format(connection.lastSynced, 'MMM d, h:mm a')}\n                    </p>\n                  )}\n                </div>\n              ))}\n            </div>\n\n            <DialogFooter className=\"gap-2\">\n              <Button variant=\"outline\" onClick={() => setShowCalendarIntegrations(false)}>\n                Close\n              </Button>\n              <Button onClick={syncCalendars} className=\"gap-2\">\n                <RefreshCw className=\"w-4 h-4\" />\n                Sync All\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        {/* Batch Class Creation Modal */}\n        <BatchClassModal\n          open={showBatchModal}\n          onClose={() => setShowBatchModal(false)}\n          onCreate={(newEvents) => {\n            setEvents(prev => [...prev, ...newEvents])\n            toast.success(`Created ${newEvents.length} classes!`)\n          }}\n        />\n\n        {/* Drag Overlay */}\n        <DragOverlay>\n          {activeDragEvent ? (\n            <div className={cn(\n              \"p-2 rounded text-xs opacity-90 shadow-lg\",\n              activeDragEvent.color || 'bg-blue-500'\n            )}>\n              <p className=\"font-medium text-white\">{activeDragEvent.title}</p>\n            </div>\n          ) : null}\n        </DragOverlay>\n      </Card>\n    </DndContext>\n  )\n}\n\n// Sub-components\n\nfunction DroppableDay({ date, children, className }: { date: Date; children: React.ReactNode; className?: string }) {\n  const { setNodeRef, isOver } = useDroppable({\n    id: `day-${format(date, 'yyyy-MM-dd')}`,\n    data: { date }\n  })\n\n  return (\n    <div\n      ref={setNodeRef}\n      className={cn(\n        className,\n        isOver && \"bg-blue-50 ring-2 ring-blue-400 ring-inset\"\n      )}\n    >\n      {children}\n    </div>\n  )\n}\n\nfunction DroppableHour({ date, hour, children, className }: { date: Date; hour: number; children?: React.ReactNode; className?: string }) {\n  const { setNodeRef, isOver } = useDroppable({\n    id: `hour-${format(date, 'yyyy-MM-dd')}-${hour}`,\n    data: { date, hour }\n  })\n\n  return (\n    <div\n      ref={setNodeRef}\n      className={cn(\n        className,\n        isOver && \"bg-blue-50/50\"\n      )}\n    >\n      {children}\n    </div>\n  )\n}\n\nfunction MonthView({ days, events, onDateClick, onEventClick, isToday, getEventsForDate, conflicts }: any) {\n  return (\n    <div className=\"border rounded-lg overflow-hidden\">\n      <div className=\"grid grid-cols-7 bg-gray-50 border-b\">\n        {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map((day) => (\n          <div key={day} className=\"p-2 text-center text-sm font-medium text-gray-600\">\n            {day}\n          </div>\n        ))}\n      </div>\n\n      <div className=\"grid grid-cols-7\">\n        {days.map((date: Date | null, index: number) => (\n          <DroppableDay\n            key={index}\n            date={date || new Date()}\n            className={cn(\n              \"min-h-[100px] p-2 border-r border-b last:border-r-0\",\n              !date && \"bg-gray-50/50\",\n              date && \"hover:bg-gray-50 cursor-pointer\"\n            )}\n          >\n            {date && (\n              <div onClick={() => onDateClick(date)}>\n                <div className={cn(\n                  \"text-sm font-medium mb-1 w-7 h-7 flex items-center justify-center rounded-full\",\n                  isToday(date) && \"bg-blue-600 text-white\"\n                )}>\n                  {date.getDate()}\n                </div>\n                <div className=\"space-y-1\">\n                  {getEventsForDate(date).slice(0, 3).map((event: CalendarEvent) => {\n                    const hasConflict = conflicts.find((e: CalendarEvent) => e.id === event.id)\n                    return (\n                      <div\n                        key={event.id}\n                        className={cn(\n                          \"text-xs p-1.5 rounded cursor-pointer truncate\",\n                          event.color || 'bg-blue-100',\n                          event.status === 'cancelled' && \"opacity-50 line-through\",\n                          hasConflict && \"ring-1 ring-red-400\"\n                        )}\n                        onClick={(e) => {\n                          e.stopPropagation()\n                          onEventClick(event)\n                        }}\n                      >\n                        <div className=\"flex items-center gap-1\">\n                          <div className={cn(\"w-1.5 h-1.5 rounded-full\", event.color?.replace('bg-', 'bg-opacity-100 ') || 'bg-blue-500')} />\n                          <span className=\"font-medium truncate\">\n                            {event.date.getHours()}:{event.date.getMinutes().toString().padStart(2, '0')} {event.title}\n                          </span>\n                        </div>\n                      </div>\n                    )\n                  })}\n                  {getEventsForDate(date).length > 3 && (\n                    <p className=\"text-xs text-gray-500 pl-1\">\n                      +{getEventsForDate(date).length - 3} more\n                    </p>\n                  )}\n                </div>\n              </div>\n            )}\n          </DroppableDay>\n        ))}\n      </div>\n    </div>\n  )\n}\n\nfunction WeekView({ currentDate, events, onEventClick, onDateClick, conflicts }: any) {\n  const weekStart = new Date(currentDate)\n  weekStart.setDate(currentDate.getDate() - currentDate.getDay())\n\n  const weekDays = Array.from({ length: 7 }, (_, i) => {\n    const day = new Date(weekStart)\n    day.setDate(weekStart.getDate() + i)\n    return day\n  })\n\n  const hours = Array.from({ length: 12 }, (_, i) => i + 8)\n\n  return (\n    <div className=\"flex border rounded-lg overflow-hidden\">\n      <div className=\"w-16 border-r bg-gray-50\">\n        <div className=\"h-12 border-b\" />\n        {hours.map((hour) => (\n          <div key={hour} className=\"h-16 border-b text-xs text-gray-500 text-center pt-2\">\n            {hour}:00\n          </div>\n        ))}\n      </div>\n\n      <div className=\"flex-1 grid grid-cols-7\">\n        {weekDays.map((day, index) => (\n          <div key={index} className=\"border-r last:border-r-0\">\n            <div\n              className=\"h-12 border-b p-2 text-center cursor-pointer hover:bg-gray-50\"\n              onClick={() => onDateClick(day)}\n            >\n              <p className=\"text-xs text-gray-500\">{day.toLocaleDateString('en-US', { weekday: 'short' })}</p>\n              <p className={cn(\"text-sm font-medium\", day.toDateString() === new Date().toDateString() && \"text-blue-600\")}>\n                {day.getDate()}\n              </p>\n            </div>\n            <div className=\"relative\">\n              {hours.map((hour) => (\n                <DroppableHour\n                  key={hour}\n                  date={day}\n                  hour={hour}\n                  className=\"h-16 border-b\"\n                />\n              ))}\n\n              {events\n                .filter((event: CalendarEvent) => event.date.toDateString() === day.toDateString())\n                .map((event: CalendarEvent) => {\n                  const hour = event.date.getHours()\n                  const minute = event.date.getMinutes()\n                  const top = (hour - 8) * 64 + (minute / 60) * 64\n                  const height = (event.duration / 60) * 64\n                  const hasConflict = conflicts.find((e: CalendarEvent) => e.id === event.id)\n\n                  return (\n                    <DraggableEvent\n                      key={event.id}\n                      event={event}\n                      onClick={() => onEventClick(event)}\n                      hasConflict={hasConflict}\n                      style={{ top: `${top}px`, height: `${Math.max(height, 32)}px`, position: 'absolute' }}\n                    />\n                  )\n                })}\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  )\n}\n\nfunction DayView({ currentDate, events, onEventClick, conflicts }: any) {\n  const hours = Array.from({ length: 14 }, (_, i) => i + 7)\n\n  const dayEvents = events.filter(\n    (event: CalendarEvent) => event.date.toDateString() === currentDate.toDateString()\n  ).sort((a: CalendarEvent, b: CalendarEvent) => a.date.getTime() - b.date.getTime())\n\n  return (\n    <div className=\"flex border rounded-lg overflow-hidden\">\n      <div className=\"w-20 border-r bg-gray-50\">\n        {hours.map((hour) => (\n          <div key={hour} className=\"h-20 border-b px-2 py-2 text-sm text-gray-600 text-right\">\n            {hour}:00\n          </div>\n        ))}\n      </div>\n\n      <div className=\"flex-1 relative\">\n        {hours.map((hour) => (\n          <DroppableHour\n            key={hour}\n            date={currentDate}\n            hour={hour}\n            className=\"h-20 border-b\"\n          />\n        ))}\n\n        {dayEvents.map((event: CalendarEvent) => {\n          const hour = event.date.getHours()\n          const minute = event.date.getMinutes()\n          const top = (hour - 7) * 80 + (minute / 60) * 80\n          const height = (event.duration / 60) * 80\n          const hasConflict = conflicts.find((e: CalendarEvent) => e.id === event.id)\n\n          return (\n            <DraggableEvent\n              key={event.id}\n              event={event}\n              onClick={() => onEventClick(event)}\n              hasConflict={hasConflict}\n              style={{ top: `${top}px`, height: `${Math.max(height, 40)}px`, position: 'absolute', left: '8px', right: '8px' }}\n            />\n          )\n        })}\n\n        {dayEvents.length === 0 && (\n          <div className=\"absolute inset-0 flex items-center justify-center text-gray-400\">\n            <p>No events scheduled for this day</p>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\nfunction AvailabilityView({ availability, onToggle, onSave }: any) {\n  const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"bg-blue-50 p-4 rounded-lg\">\n        <h3 className=\"font-medium text-blue-900 mb-2\">Set Your Availability</h3>\n        <p className=\"text-sm text-blue-700\">\n          Mark when you&apos;re available for classes. Students will only be able to book during these times.\n        </p>\n      </div>\n\n      <div className=\"space-y-4\">\n        {days.map((day, dayIndex) => (\n          <div key={day} className=\"border rounded-lg p-4\">\n            <h4 className=\"font-medium mb-3\">{day}</h4>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n              {availability\n                .filter((block: AvailabilityBlock) => block.dayOfWeek === dayIndex + 1)\n                .map((block: AvailabilityBlock) => (\n                  <div\n                    key={block.id}\n                    className={cn(\n                      \"p-3 rounded-lg border cursor-pointer transition-all\",\n                      block.isAvailable\n                        ? \"bg-green-50 border-green-200\"\n                        : \"bg-gray-50 border-gray-200 opacity-50\"\n                    )}\n                    onClick={() => onToggle(block.id)}\n                  >\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"font-medium\">{block.startTime} - {block.endTime}</span>\n                      {block.isAvailable ? (\n                        <CheckCircle2 className=\"w-5 h-5 text-green-500\" />\n                      ) : (\n                        <X className=\"w-5 h-5 text-gray-400\" />\n                      )}\n                    </div>\n                  </div>\n                ))}\n            </div>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"flex justify-end gap-3\">\n        <Button variant=\"outline\">Cancel</Button>\n        <Button onClick={onSave} className=\"bg-gradient-to-r from-green-600 to-emerald-600\">\n          Save Availability\n        </Button>\n      </div>\n    </div>\n  )\n}\n\n// Batch Class Creation Modal Component\ninterface BatchClassModalProps {\n  open: boolean\n  onClose: () => void\n  onCreate: (events: CalendarEvent[]) => void\n}\n\nfunction BatchClassModal({ open, onClose, onCreate }: BatchClassModalProps) {\n  const [title, setTitle] = useState('')\n  const [subject, setSubject] = useState('Mathematics')\n  const [startDate, setStartDate] = useState(format(new Date(), 'yyyy-MM-dd'))\n  const [startTime, setStartTime] = useState('14:00')\n  const [duration, setDuration] = useState(60)\n  const [recurringPattern, setRecurringPattern] = useState<'daily' | 'weekly' | 'biweekly'>('weekly')\n  const [occurrences, setOccurrences] = useState(4)\n  const [maxStudents, setMaxStudents] = useState(20)\n  const [isOnline, setIsOnline] = useState(true)\n\n  const handleCreate = () => {\n    const newEvents: CalendarEvent[] = []\n    const baseDate = new Date(startDate)\n    const [hours, minutes] = startTime.split(':').map(Number)\n\n    for (let i = 0; i < occurrences; i++) {\n      const eventDate = new Date(baseDate)\n\n      if (recurringPattern === 'daily') {\n        eventDate.setDate(baseDate.getDate() + i)\n      } else if (recurringPattern === 'weekly') {\n        eventDate.setDate(baseDate.getDate() + (i * 7))\n      } else if (recurringPattern === 'biweekly') {\n        eventDate.setDate(baseDate.getDate() + (i * 14))\n      }\n\n      eventDate.setHours(hours, minutes, 0, 0)\n\n      const subjectColor = SUBJECTS.find(s => s.name === subject)?.color || 'bg-blue-500'\n\n      newEvents.push({\n        id: `batch-${Date.now()}-${i}`,\n        title: title || `${subject} Class`,\n        date: eventDate,\n        duration,\n        type: 'class',\n        status: 'scheduled',\n        subject,\n        maxStudents,\n        studentCount: 0,\n        isOnline,\n        color: subjectColor,\n        isRecurring: occurrences > 1,\n        recurringPattern: occurrences > 1 ? recurringPattern : undefined\n      })\n    }\n\n    onCreate(newEvents)\n    onClose()\n\n    // Reset form\n    setTitle('')\n    setOccurrences(4)\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"sm:max-w-lg\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <CalendarPlus className=\"w-5 h-5\" />\n            Batch Create Classes\n          </DialogTitle>\n          <DialogDescription>\n            Create multiple recurring classes at once\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4 py-4\">\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>Class Title</Label>\n              <Input\n                value={title}\n                onChange={(e) => setTitle(e.target.value)}\n                placeholder=\"e.g., Advanced Math\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Subject</Label>\n              <Select value={subject} onValueChange={setSubject}>\n                <SelectTrigger>\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  {SUBJECTS.filter(s => s.name !== 'Office Hours').map(s => (\n                    <SelectItem key={s.name} value={s.name}>{s.name}</SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>Start Date</Label>\n              <Input\n                type=\"date\"\n                value={startDate}\n                onChange={(e) => setStartDate(e.target.value)}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Start Time</Label>\n              <Input\n                type=\"time\"\n                value={startTime}\n                onChange={(e) => setStartTime(e.target.value)}\n              />\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-3 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>Duration (min)</Label>\n              <Input\n                type=\"number\"\n                value={duration}\n                onChange={(e) => setDuration(Number(e.target.value))}\n                min={15}\n                step={15}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Max Students</Label>\n              <Input\n                type=\"number\"\n                value={maxStudents}\n                onChange={(e) => setMaxStudents(Number(e.target.value))}\n                min={1}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>Occurrences</Label>\n              <Input\n                type=\"number\"\n                value={occurrences}\n                onChange={(e) => setOccurrences(Number(e.target.value))}\n                min={1}\n                max={52}\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>Recurring Pattern</Label>\n            <div className=\"flex gap-2\">\n              {(['weekly', 'biweekly', 'daily'] as const).map((pattern) => (\n                <Button\n                  key={pattern}\n                  type=\"button\"\n                  variant={recurringPattern === pattern ? 'default' : 'outline'}\n                  size=\"sm\"\n                  onClick={() => setRecurringPattern(pattern)}\n                  className=\"flex-1 capitalize\"\n                >\n                  {pattern === 'biweekly' ? 'Bi-weekly' : pattern}\n                </Button>\n              ))}\n            </div>\n          </div>\n\n          <div className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n            <div className=\"flex items-center gap-2\">\n              <Video className=\"w-4 h-4 text-gray-500\" />\n              <span className=\"text-sm\">Online Class</span>\n            </div>\n            <Switch checked={isOnline} onCheckedChange={setIsOnline} />\n          </div>\n\n          <div className=\"p-3 bg-blue-50 rounded-lg text-sm\">\n            <p className=\"font-medium text-blue-900\">Preview</p>\n            <p className=\"text-blue-700\">\n              Will create <strong>{occurrences}</strong> {recurringPattern} classes\n              starting <strong>{format(new Date(startDate), 'MMM d, yyyy')}</strong>\n            </p>\n          </div>\n        </div>\n\n        <DialogFooter className=\"gap-2\">\n          <Button variant=\"outline\" onClick={onClose}>\n            Cancel\n          </Button>\n          <Button onClick={handleCreate} className=\"gap-2\">\n            <Copy className=\"w-4 h-4\" />\n            Create {occurrences} Classes\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n","export { CreateClassDialog } from './CreateClassDialog'\nexport { CreateCourseDialog } from './CreateCourseDialog'\nexport { StatsCards } from './StatsCards'\nexport { UpcomingClassesCard, type UpcomingClass } from './UpcomingClassesCard'\nexport { StudentsNeedingAttentionCard, type StudentNeedingAttention } from './StudentsNeedingAttentionCard'\nexport { AIInsightsCard } from './AIInsightsCard'\nexport { QuickActionsCard } from './QuickActionsCard'\nexport { AITeachingAssistantWidget } from './AITeachingAssistantWidget'\nexport { StudentProgressCard } from './StudentProgressCard'\nexport { RevenueDashboard } from './RevenueDashboard'\nexport { CommunicationCenter } from './CommunicationCenter'\nexport { ModernHeroSection } from './ModernHeroSection'\nexport { GlassCard } from './GlassCard'\nexport { InteractiveCalendar } from './InteractiveCalendar'","import React from 'react';\nimport { createStore } from 'zustand/vanilla';\n\nconst identity = (arg) => arg;\nfunction useStore(api, selector = identity) {\n  const slice = React.useSyncExternalStore(\n    api.subscribe,\n    React.useCallback(() => selector(api.getState()), [api, selector]),\n    React.useCallback(() => selector(api.getInitialState()), [api, selector])\n  );\n  React.useDebugValue(slice);\n  return slice;\n}\nconst createImpl = (createState) => {\n  const api = createStore(createState);\n  const useBoundStore = (selector) => useStore(api, selector);\n  Object.assign(useBoundStore, api);\n  return useBoundStore;\n};\nconst create = ((createState) => createState ? createImpl(createState) : createImpl);\n\nexport { create, useStore };\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'm17 2 4 4-4 4', key: 'nntrym' }],\n  ['path', { d: 'M3 11v-1a4 4 0 0 1 4-4h14', key: '84bu3i' }],\n  ['path', { d: 'm7 22-4-4 4-4', key: '1wqhfi' }],\n  ['path', { d: 'M21 13v1a4 4 0 0 1-4 4H3', key: '1rx37r' }],\n];\n\n/**\n * @component @name Repeat\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTcgMiA0IDQtNCA0IiAvPgogIDxwYXRoIGQ9Ik0zIDExdi0xYTQgNCAwIDAgMSA0LTRoMTQiIC8+CiAgPHBhdGggZD0ibTcgMjItNC00IDQtNCIgLz4KICA8cGF0aCBkPSJNMjEgMTN2MWE0IDQgMCAwIDEtNCA0SDMiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/repeat\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Repeat = createLucideIcon('repeat', __iconNode);\n\nexport default Repeat;\n","import { create } from 'zustand'\nimport { immer } from 'zustand/middleware/immer'\n\n// ============================================\n// TYPES (matching component types)\n// ============================================\n\nexport interface Message {\n  id: string\n  studentId: string\n  studentName: string\n  avatar?: string\n  subject: string\n  content: string\n  timestamp: string\n  isRead: boolean\n  isStarred: boolean\n  priority: 'high' | 'normal' | 'low'\n  course?: string\n  type: 'message' | 'announcement' | 'system'\n  attachments?: Attachment[]\n  readAt?: string\n  labels?: string[]\n  isScheduled?: boolean\n  scheduledFor?: string\n  parentId?: string\n  replyCount?: number\n  voiceUrl?: string\n  voiceDuration?: number\n  translatedContent?: string\n  translatedFrom?: string\n}\n\nexport interface Attachment {\n  id: string\n  name: string\n  type: 'image' | 'pdf' | 'document' | 'audio'\n  url: string\n  size: number\n}\n\nexport interface MessageTemplate {\n  id: string\n  title: string\n  content: string\n  category: 'general' | 'course' | 'feedback' | 'reminder' | 'technical'\n}\n\nexport interface QuickReply {\n  id: string\n  title: string\n  content: string\n  shortcut?: string\n}\n\nexport interface AIReply {\n  id: string\n  text: string\n  tone: 'formal' | 'casual' | 'friendly' | 'empathetic'\n}\n\nexport interface Label {\n  id: string\n  name: string\n  color: string\n}\n\nexport interface PresenceStatus {\n  userId: string\n  status: 'online' | 'offline' | 'away'\n  lastSeen?: string\n}\n\nexport interface TypingIndicator {\n  userId: string\n  userName: string\n  timestamp: number\n}\n\n// ============================================\n// STORE STATE INTERFACE\n// ============================================\n\ninterface CommunicationState {\n  // ==================== Core Data ====================\n  messages: Message[]\n  templates: MessageTemplate[]\n  quickReplies: QuickReply[]\n  labels: Label[]\n  \n  // ==================== UI State ====================\n  searchQuery: string\n  filter: 'all' | 'unread' | 'starred' | 'high' | 'scheduled'\n  selectedMessage: Message | null\n  selectedMessages: Set<string>\n  showMultiSelect: boolean\n  \n  // ==================== Dialog States ====================\n  showCompose: boolean\n  showTemplates: boolean\n  showAnnouncement: boolean\n  showQuickRepliesManager: boolean\n  showAnalytics: boolean\n  showFilters: boolean\n  \n  // ==================== Reply State ====================\n  replyText: string\n  showAIReplies: boolean\n  aiReplies: AIReply[]\n  isRecordingVoice: boolean\n  voiceRecordingDuration: number\n  \n  // ==================== Scheduling State ====================\n  isScheduling: boolean\n  scheduledDate: Date | undefined\n  scheduledTime: string\n  \n  // ==================== Thread View State ====================\n  showThread: boolean\n  threadMessages: Message[]\n  \n  // ==================== Real-time State ====================\n  typingIndicators: TypingIndicator[]\n  presenceStatus: Record<string, PresenceStatus>\n  isWebSocketConnected: boolean\n  \n  // ==================== Compose Form State ====================\n  composeTo: string\n  composeSubject: string\n  composeMessage: string\n  composeAttachments: Attachment[]\n  selectedLabels: string[]\n  composePriority: 'high' | 'normal' | 'low'\n  \n  // ==================== Actions ====================\n  // Core data actions\n  setMessages: (messages: Message[]) => void\n  addMessage: (message: Message) => void\n  updateMessage: (messageId: string, updates: Partial<Message>) => void\n  deleteMessage: (messageId: string) => void\n  setTemplates: (templates: MessageTemplate[]) => void\n  setQuickReplies: (replies: QuickReply[]) => void\n  \n  // UI actions\n  setSearchQuery: (query: string) => void\n  setFilter: (filter: 'all' | 'unread' | 'starred' | 'high' | 'scheduled') => void\n  setSelectedMessage: (message: Message | null) => void\n  toggleMessageSelection: (messageId: string) => void\n  setSelectedMessages: (messageIds: Set<string>) => void\n  setShowMultiSelect: (show: boolean) => void\n  \n  // Dialog actions\n  setShowCompose: (show: boolean) => void\n  setShowTemplates: (show: boolean) => void\n  setShowAnnouncement: (show: boolean) => void\n  setShowQuickRepliesManager: (show: boolean) => void\n  setShowAnalytics: (show: boolean) => void\n  setShowFilters: (show: boolean) => void\n  \n  // Reply actions\n  setReplyText: (text: string) => void\n  setShowAIReplies: (show: boolean) => void\n  setAiReplies: (replies: AIReply[]) => void\n  setIsRecordingVoice: (recording: boolean) => void\n  setVoiceRecordingDuration: (duration: number) => void\n  incrementVoiceDuration: () => void\n  \n  // Scheduling actions\n  setIsScheduling: (scheduling: boolean) => void\n  setScheduledDate: (date: Date | undefined) => void\n  setScheduledTime: (time: string) => void\n  \n  // Thread actions\n  setShowThread: (show: boolean) => void\n  setThreadMessages: (messages: Message[]) => void\n  \n  // Real-time actions\n  addTypingIndicator: (indicator: TypingIndicator) => void\n  removeTypingIndicator: (userId: string) => void\n  clearExpiredTypingIndicators: () => void\n  setPresenceStatus: (statuses: Record<string, PresenceStatus>) => void\n  updatePresenceStatus: (userId: string, status: PresenceStatus) => void\n  setIsWebSocketConnected: (connected: boolean) => void\n  \n  // Compose form actions\n  setComposeTo: (to: string) => void\n  setComposeSubject: (subject: string) => void\n  setComposeMessage: (message: string) => void\n  addComposeAttachment: (attachment: Attachment) => void\n  removeComposeAttachment: (attachmentId: string) => void\n  clearComposeAttachments: () => void\n  toggleSelectedLabel: (labelId: string) => void\n  setSelectedLabels: (labels: string[]) => void\n  setComposePriority: (priority: 'high' | 'normal' | 'low') => void\n  resetComposeForm: () => void\n  \n  // Bulk actions\n  bulkMarkAsRead: (messageIds: Set<string>) => void\n  bulkMarkAsUnread: (messageIds: Set<string>) => void\n  bulkToggleStar: (messageIds: Set<string>) => void\n  bulkDelete: (messageIds: Set<string>) => void\n  bulkArchive: (messageIds: Set<string>) => void\n  \n  // Message actions\n  toggleMessageStar: (messageId: string) => void\n  markMessageAsRead: (messageId: string) => void\n  addLabelToMessage: (messageId: string, labelId: string) => void\n  removeLabelFromMessage: (messageId: string, labelId: string) => void\n  translateMessage: (messageId: string, translatedContent: string, translatedFrom: string) => void\n  \n  // Utility actions\n  reset: () => void\n}\n\n// ============================================\n// INITIAL STATE\n// ============================================\n\nconst generateDemoMessages = (): Message[] => [\n  {\n    id: '1',\n    studentId: 's1',\n    studentName: 'Alice Zhang',\n    subject: 'Question about homework',\n    content: 'Hi, I\\'m having trouble understanding problem 3 from yesterday\\'s assignment. Could you explain the concept of derivatives again?',\n    timestamp: new Date(Date.now() - 1000 * 60 * 30).toISOString(),\n    isRead: false,\n    isStarred: true,\n    priority: 'high',\n    course: 'Advanced Mathematics',\n    type: 'message',\n    labels: ['homework', 'urgent'],\n    replyCount: 2,\n    attachments: []\n  },\n  {\n    id: '2',\n    studentId: 's2',\n    studentName: 'Bob Li',\n    subject: 'Missed class notification',\n    content: 'I won\\'t be able to attend tomorrow\\'s class due to a family event. Will there be a recording available?',\n    timestamp: new Date(Date.now() - 1000 * 60 * 60 * 2).toISOString(),\n    isRead: false,\n    isStarred: false,\n    priority: 'normal',\n    course: 'Physics 101',\n    type: 'message',\n    labels: ['attendance'],\n    attachments: []\n  },\n  {\n    id: '3',\n    studentId: 's3',\n    studentName: 'Carol Wang',\n    subject: 'Thank you!',\n    content: 'Just wanted to say thanks for the extra help yesterday. I finally understood the concept!',\n    timestamp: new Date(Date.now() - 1000 * 60 * 60 * 5).toISOString(),\n    isRead: true,\n    isStarred: false,\n    priority: 'low',\n    course: 'English Literature',\n    type: 'message',\n    readAt: new Date(Date.now() - 1000 * 60 * 60 * 4).toISOString(),\n    labels: ['feedback'],\n    attachments: []\n  },\n  {\n    id: '4',\n    studentId: 'system',\n    studentName: 'System',\n    subject: 'New student enrolled',\n    content: 'A new student has enrolled in your Advanced Mathematics course.',\n    timestamp: new Date(Date.now() - 1000 * 60 * 60 * 24).toISOString(),\n    isRead: true,\n    isStarred: false,\n    priority: 'normal',\n    type: 'system',\n    attachments: []\n  },\n  {\n    id: '5',\n    studentId: 's4',\n    studentName: 'David Chen',\n    subject: 'Assignment extension request',\n    content: 'I\\'m facing some technical issues with my laptop. Could I get a 2-day extension for the upcoming assignment?',\n    timestamp: new Date(Date.now() - 1000 * 60 * 60 * 48).toISOString(),\n    isRead: true,\n    isStarred: true,\n    priority: 'high',\n    course: 'Advanced Mathematics',\n    type: 'message',\n    labels: ['extension', 'technical'],\n    attachments: [\n      { id: 'a1', name: 'error-screenshot.png', type: 'image', url: '#', size: 1024000 }\n    ]\n  },\n  {\n    id: '6',\n    studentId: 's5',\n    studentName: 'Emma Liu',\n    subject: 'Voice message',\n    content: '[Voice message]',\n    timestamp: new Date(Date.now() - 1000 * 60 * 15).toISOString(),\n    isRead: false,\n    isStarred: false,\n    priority: 'normal',\n    course: 'Physics 101',\n    type: 'message',\n    voiceUrl: '#',\n    voiceDuration: 45,\n    attachments: []\n  }\n]\n\nconst generateDemoTemplates = (): MessageTemplate[] => [\n  { id: '1', title: 'Welcome Message', content: 'Welcome to the course! I\\'m excited to have you join us. If you have any questions, feel free to reach out.', category: 'general' },\n  { id: '2', title: 'Assignment Reminder', content: 'Just a friendly reminder that the assignment is due tomorrow. Let me know if you need any help!', category: 'reminder' },\n  { id: '3', title: 'Great Work!', content: 'Excellent work on the recent assignment! Your understanding of the concepts has really improved.', category: 'feedback' },\n  { id: '4', title: 'Class Cancellation', content: 'Unfortunately, tomorrow\\'s class is cancelled due to unforeseen circumstances. We\\'ll reschedule soon.', category: 'course' },\n  { id: '5', title: 'Technical Support', content: 'I understand you\\'re experiencing technical difficulties. Let\\'s troubleshoot this together.', category: 'technical' }\n]\n\nconst generateQuickReplies = (): QuickReply[] => [\n  { id: '1', title: 'Thank you', content: 'Thank you for reaching out!', shortcut: '/ty' },\n  { id: '2', title: 'Will check', content: 'I\\'ll look into this and get back to you shortly.', shortcut: '/check' },\n  { id: '3', title: 'Great job', content: 'Great work! Keep it up!', shortcut: '/great' },\n  { id: '4', title: 'See you in class', content: 'Looking forward to seeing you in class!', shortcut: '/class' }\n]\n\nconst LABELS: Label[] = [\n  { id: 'homework', name: 'Homework', color: 'bg-blue-100 text-blue-700 border-blue-200' },\n  { id: 'urgent', name: 'Urgent', color: 'bg-red-100 text-red-700 border-red-200' },\n  { id: 'feedback', name: 'Feedback', color: 'bg-green-100 text-green-700 border-green-200' },\n  { id: 'technical', name: 'Technical', color: 'bg-purple-100 text-purple-700 border-purple-200' },\n  { id: 'attendance', name: 'Attendance', color: 'bg-yellow-100 text-yellow-700 border-yellow-200' },\n  { id: 'extension', name: 'Extension', color: 'bg-orange-100 text-orange-700 border-orange-200' }\n]\n\nconst initialState = {\n  messages: generateDemoMessages(),\n  templates: generateDemoTemplates(),\n  quickReplies: generateQuickReplies(),\n  labels: LABELS,\n  searchQuery: '',\n  filter: 'all' as const,\n  selectedMessage: null,\n  selectedMessages: new Set<string>(),\n  showMultiSelect: false,\n  showCompose: false,\n  showTemplates: false,\n  showAnnouncement: false,\n  showQuickRepliesManager: false,\n  showAnalytics: false,\n  showFilters: false,\n  replyText: '',\n  showAIReplies: false,\n  aiReplies: [] as AIReply[],\n  isRecordingVoice: false,\n  voiceRecordingDuration: 0,\n  isScheduling: false,\n  scheduledDate: undefined as Date | undefined,\n  scheduledTime: '09:00',\n  showThread: false,\n  threadMessages: [] as Message[],\n  typingIndicators: [] as TypingIndicator[],\n  presenceStatus: {} as Record<string, PresenceStatus>,\n  isWebSocketConnected: false,\n  composeTo: '',\n  composeSubject: '',\n  composeMessage: '',\n  composeAttachments: [] as Attachment[],\n  selectedLabels: [] as string[],\n  composePriority: 'normal' as const,\n}\n\n// ============================================\n// STORE CREATION\n// ============================================\n\nexport const useCommunicationStore = create<CommunicationState>()(\n  immer((set, get) => ({\n    ...initialState,\n    \n    // Core data actions\n    setMessages: (messages) => set((state) => {\n      state.messages = messages\n    }),\n    \n    addMessage: (message) => set((state) => {\n      state.messages.unshift(message)\n    }),\n    \n    updateMessage: (messageId, updates) => set((state) => {\n      const index = state.messages.findIndex(m => m.id === messageId)\n      if (index !== -1) {\n        state.messages[index] = { ...state.messages[index], ...updates }\n      }\n    }),\n    \n    deleteMessage: (messageId) => set((state) => {\n      state.messages = state.messages.filter(m => m.id !== messageId)\n    }),\n    \n    setTemplates: (templates) => set((state) => {\n      state.templates = templates\n    }),\n    \n    setQuickReplies: (replies) => set((state) => {\n      state.quickReplies = replies\n    }),\n    \n    // UI actions\n    setSearchQuery: (query) => set((state) => {\n      state.searchQuery = query\n    }),\n    \n    setFilter: (filter) => set((state) => {\n      state.filter = filter\n    }),\n    \n    setSelectedMessage: (message) => set((state) => {\n      state.selectedMessage = message\n    }),\n    \n    toggleMessageSelection: (messageId) => set((state) => {\n      const newSet = new Set(state.selectedMessages)\n      if (newSet.has(messageId)) {\n        newSet.delete(messageId)\n      } else {\n        newSet.add(messageId)\n      }\n      state.selectedMessages = newSet\n    }),\n    \n    setSelectedMessages: (messageIds) => set((state) => {\n      state.selectedMessages = messageIds\n    }),\n    \n    setShowMultiSelect: (show) => set((state) => {\n      state.showMultiSelect = show\n    }),\n    \n    // Dialog actions\n    setShowCompose: (show) => set((state) => {\n      state.showCompose = show\n    }),\n    \n    setShowTemplates: (show) => set((state) => {\n      state.showTemplates = show\n    }),\n    \n    setShowAnnouncement: (show) => set((state) => {\n      state.showAnnouncement = show\n    }),\n    \n    setShowQuickRepliesManager: (show) => set((state) => {\n      state.showQuickRepliesManager = show\n    }),\n    \n    setShowAnalytics: (show) => set((state) => {\n      state.showAnalytics = show\n    }),\n    \n    setShowFilters: (show) => set((state) => {\n      state.showFilters = show\n    }),\n    \n    // Reply actions\n    setReplyText: (text) => set((state) => {\n      state.replyText = text\n    }),\n    \n    setShowAIReplies: (show) => set((state) => {\n      state.showAIReplies = show\n    }),\n    \n    setAiReplies: (replies) => set((state) => {\n      state.aiReplies = replies\n    }),\n    \n    setIsRecordingVoice: (recording) => set((state) => {\n      state.isRecordingVoice = recording\n    }),\n    \n    setVoiceRecordingDuration: (duration) => set((state) => {\n      state.voiceRecordingDuration = duration\n    }),\n    \n    incrementVoiceDuration: () => set((state) => {\n      state.voiceRecordingDuration += 1\n    }),\n    \n    // Scheduling actions\n    setIsScheduling: (scheduling) => set((state) => {\n      state.isScheduling = scheduling\n    }),\n    \n    setScheduledDate: (date) => set((state) => {\n      state.scheduledDate = date\n    }),\n    \n    setScheduledTime: (time) => set((state) => {\n      state.scheduledTime = time\n    }),\n    \n    // Thread actions\n    setShowThread: (show) => set((state) => {\n      state.showThread = show\n    }),\n    \n    setThreadMessages: (messages) => set((state) => {\n      state.threadMessages = messages\n    }),\n    \n    // Real-time actions\n    addTypingIndicator: (indicator) => set((state) => {\n      state.typingIndicators.push(indicator)\n    }),\n    \n    removeTypingIndicator: (userId) => set((state) => {\n      state.typingIndicators = state.typingIndicators.filter(t => t.userId !== userId)\n    }),\n    \n    clearExpiredTypingIndicators: () => set((state) => {\n      const now = Date.now()\n      state.typingIndicators = state.typingIndicators.filter(t => now - t.timestamp < 3000)\n    }),\n    \n    setPresenceStatus: (statuses) => set((state) => {\n      state.presenceStatus = statuses\n    }),\n    \n    updatePresenceStatus: (userId, status) => set((state) => {\n      state.presenceStatus[userId] = status\n    }),\n    \n    setIsWebSocketConnected: (connected) => set((state) => {\n      state.isWebSocketConnected = connected\n    }),\n    \n    // Compose form actions\n    setComposeTo: (to) => set((state) => {\n      state.composeTo = to\n    }),\n    \n    setComposeSubject: (subject) => set((state) => {\n      state.composeSubject = subject\n    }),\n    \n    setComposeMessage: (message) => set((state) => {\n      state.composeMessage = message\n    }),\n    \n    addComposeAttachment: (attachment) => set((state) => {\n      state.composeAttachments.push(attachment)\n    }),\n    \n    removeComposeAttachment: (attachmentId) => set((state) => {\n      state.composeAttachments = state.composeAttachments.filter(a => a.id !== attachmentId)\n    }),\n    \n    clearComposeAttachments: () => set((state) => {\n      state.composeAttachments = []\n    }),\n    \n    toggleSelectedLabel: (labelId) => set((state) => {\n      if (state.selectedLabels.includes(labelId)) {\n        state.selectedLabels = state.selectedLabels.filter(l => l !== labelId)\n      } else {\n        state.selectedLabels.push(labelId)\n      }\n    }),\n    \n    setSelectedLabels: (labels) => set((state) => {\n      state.selectedLabels = labels\n    }),\n    \n    setComposePriority: (priority) => set((state) => {\n      state.composePriority = priority\n    }),\n    \n    resetComposeForm: () => set((state) => {\n      state.composeTo = ''\n      state.composeSubject = ''\n      state.composeMessage = ''\n      state.composeAttachments = []\n      state.selectedLabels = []\n      state.composePriority = 'normal'\n    }),\n    \n    // Bulk actions\n    bulkMarkAsRead: (messageIds) => set((state) => {\n      state.messages.forEach(msg => {\n        if (messageIds.has(msg.id)) {\n          msg.isRead = true\n          msg.readAt = new Date().toISOString()\n        }\n      })\n    }),\n    \n    bulkMarkAsUnread: (messageIds) => set((state) => {\n      state.messages.forEach(msg => {\n        if (messageIds.has(msg.id)) {\n          msg.isRead = false\n          msg.readAt = undefined\n        }\n      })\n    }),\n    \n    bulkToggleStar: (messageIds) => set((state) => {\n      state.messages.forEach(msg => {\n        if (messageIds.has(msg.id)) {\n          msg.isStarred = !msg.isStarred\n        }\n      })\n    }),\n    \n    bulkDelete: (messageIds) => set((state) => {\n      state.messages = state.messages.filter(m => !messageIds.has(m.id))\n    }),\n    \n    bulkArchive: (messageIds) => set((state) => {\n      state.messages.forEach(msg => {\n        if (messageIds.has(msg.id)) {\n          msg.type = 'message'\n        }\n      })\n    }),\n    \n    // Message actions\n    toggleMessageStar: (messageId) => set((state) => {\n      const msg = state.messages.find(m => m.id === messageId)\n      if (msg) {\n        msg.isStarred = !msg.isStarred\n      }\n      if (state.selectedMessage?.id === messageId) {\n        state.selectedMessage.isStarred = !state.selectedMessage.isStarred\n      }\n    }),\n    \n    markMessageAsRead: (messageId) => set((state) => {\n      const msg = state.messages.find(m => m.id === messageId)\n      if (msg) {\n        msg.isRead = true\n        msg.readAt = new Date().toISOString()\n      }\n      if (state.selectedMessage?.id === messageId) {\n        state.selectedMessage.isRead = true\n        state.selectedMessage.readAt = new Date().toISOString()\n      }\n    }),\n    \n    addLabelToMessage: (messageId, labelId) => set((state) => {\n      const msg = state.messages.find(m => m.id === messageId)\n      if (msg) {\n        const labels = msg.labels || []\n        if (!labels.includes(labelId)) {\n          msg.labels = [...labels, labelId]\n        }\n      }\n      if (state.selectedMessage?.id === messageId) {\n        const labels = state.selectedMessage.labels || []\n        if (!labels.includes(labelId)) {\n          state.selectedMessage.labels = [...labels, labelId]\n        }\n      }\n    }),\n    \n    removeLabelFromMessage: (messageId, labelId) => set((state) => {\n      const msg = state.messages.find(m => m.id === messageId)\n      if (msg && msg.labels) {\n        msg.labels = msg.labels.filter(l => l !== labelId)\n      }\n      if (state.selectedMessage?.id === messageId && state.selectedMessage.labels) {\n        state.selectedMessage.labels = state.selectedMessage.labels.filter(l => l !== labelId)\n      }\n    }),\n    \n    translateMessage: (messageId, translatedContent, translatedFrom) => set((state) => {\n      const msg = state.messages.find(m => m.id === messageId)\n      if (msg) {\n        msg.translatedContent = translatedContent\n        msg.translatedFrom = translatedFrom\n      }\n      if (state.selectedMessage?.id === messageId) {\n        state.selectedMessage.translatedContent = translatedContent\n        state.selectedMessage.translatedFrom = translatedFrom\n      }\n    }),\n    \n    // Utility actions\n    reset: () => set(() => ({ ...initialState })),\n  }))\n)\n\n// ============================================\n// GRANULAR SELECTORS FOR OPTIMIZED RE-RENDERS\n// ============================================\n\n// Core data selectors\nexport const useMessages = () => useCommunicationStore((state) => state.messages)\nexport const useTemplates = () => useCommunicationStore((state) => state.templates)\nexport const useQuickReplies = () => useCommunicationStore((state) => state.quickReplies)\nexport const useLabels = () => useCommunicationStore((state) => state.labels)\n\n// Filtered messages selector (memoized computation)\nexport const useFilteredMessages = () => useCommunicationStore((state) => {\n  const { messages, searchQuery, filter } = state\n  return messages.filter(msg => {\n    const matchesSearch = \n      msg.studentName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      msg.subject.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      msg.content.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      msg.labels?.some(l => l.toLowerCase().includes(searchQuery.toLowerCase()))\n    \n    const matchesFilter = \n      filter === 'all' || \n      (filter === 'unread' && !msg.isRead) ||\n      (filter === 'starred' && msg.isStarred) ||\n      (filter === 'high' && msg.priority === 'high') ||\n      (filter === 'scheduled' && msg.isScheduled)\n    \n    return matchesSearch && matchesFilter\n  })\n})\n\n// Statistics selectors (computed values)\nexport const useMessageStats = () => useCommunicationStore((state) => {\n  const { messages } = state\n  return {\n    total: messages.length,\n    unread: messages.filter(m => !m.isRead).length,\n    unreadHighPriority: messages.filter(m => m.priority === 'high' && !m.isRead).length,\n    starred: messages.filter(m => m.isStarred).length,\n    withAttachments: messages.filter(m => m.attachments && m.attachments.length > 0).length,\n    scheduled: messages.filter(m => m.isScheduled).length,\n    responseTime: '2.5 hours', // Mock average response time\n    todayMessages: messages.filter(m => new Date(m.timestamp).toDateString() === new Date().toDateString()).length\n  }\n})\n\n// UI state selectors\nexport const useSearchQuery = () => useCommunicationStore((state) => state.searchQuery)\nexport const useFilter = () => useCommunicationStore((state) => state.filter)\nexport const useSelectedMessage = () => useCommunicationStore((state) => state.selectedMessage)\nexport const useSelectedMessages = () => useCommunicationStore((state) => state.selectedMessages)\nexport const useShowMultiSelect = () => useCommunicationStore((state) => state.showMultiSelect)\n\n// Dialog state selectors\nexport const useShowCompose = () => useCommunicationStore((state) => state.showCompose)\nexport const useShowTemplates = () => useCommunicationStore((state) => state.showTemplates)\nexport const useShowAnnouncement = () => useCommunicationStore((state) => state.showAnnouncement)\nexport const useShowQuickRepliesManager = () => useCommunicationStore((state) => state.showQuickRepliesManager)\nexport const useShowAnalytics = () => useCommunicationStore((state) => state.showAnalytics)\nexport const useShowFilters = () => useCommunicationStore((state) => state.showFilters)\n\n// Reply state selectors\nexport const useReplyText = () => useCommunicationStore((state) => state.replyText)\nexport const useShowAIReplies = () => useCommunicationStore((state) => state.showAIReplies)\nexport const useAiReplies = () => useCommunicationStore((state) => state.aiReplies)\nexport const useIsRecordingVoice = () => useCommunicationStore((state) => state.isRecordingVoice)\nexport const useVoiceRecordingDuration = () => useCommunicationStore((state) => state.voiceRecordingDuration)\n\n// Scheduling state selectors\nexport const useIsScheduling = () => useCommunicationStore((state) => state.isScheduling)\nexport const useScheduledDate = () => useCommunicationStore((state) => state.scheduledDate)\nexport const useScheduledTime = () => useCommunicationStore((state) => state.scheduledTime)\n\n// Thread state selectors\nexport const useShowThread = () => useCommunicationStore((state) => state.showThread)\nexport const useThreadMessages = () => useCommunicationStore((state) => state.threadMessages)\n\n// Real-time state selectors\nexport const useTypingIndicators = () => useCommunicationStore((state) => state.typingIndicators)\nexport const usePresenceStatus = () => useCommunicationStore((state) => state.presenceStatus)\nexport const usePresenceStatusForUser = (userId: string) => useCommunicationStore((state) => state.presenceStatus[userId])\nexport const useIsWebSocketConnected = () => useCommunicationStore((state) => state.isWebSocketConnected)\n\n// Compose form selectors\nexport const useComposeTo = () => useCommunicationStore((state) => state.composeTo)\nexport const useComposeSubject = () => useCommunicationStore((state) => state.composeSubject)\nexport const useComposeMessage = () => useCommunicationStore((state) => state.composeMessage)\nexport const useComposeAttachments = () => useCommunicationStore((state) => state.composeAttachments)\nexport const useSelectedLabels = () => useCommunicationStore((state) => state.selectedLabels)\nexport const useComposePriority = () => useCommunicationStore((state) => state.composePriority)\n\n// Action selectors (grouped for convenience)\nexport const useCommunicationActions = () => useCommunicationStore((state) => ({\n  // Core data\n  setMessages: state.setMessages,\n  addMessage: state.addMessage,\n  updateMessage: state.updateMessage,\n  deleteMessage: state.deleteMessage,\n  setTemplates: state.setTemplates,\n  setQuickReplies: state.setQuickReplies,\n  \n  // UI\n  setSearchQuery: state.setSearchQuery,\n  setFilter: state.setFilter,\n  setSelectedMessage: state.setSelectedMessage,\n  toggleMessageSelection: state.toggleMessageSelection,\n  setSelectedMessages: state.setSelectedMessages,\n  setShowMultiSelect: state.setShowMultiSelect,\n  \n  // Dialogs\n  setShowCompose: state.setShowCompose,\n  setShowTemplates: state.setShowTemplates,\n  setShowAnnouncement: state.setShowAnnouncement,\n  setShowQuickRepliesManager: state.setShowQuickRepliesManager,\n  setShowAnalytics: state.setShowAnalytics,\n  setShowFilters: state.setShowFilters,\n  \n  // Reply\n  setReplyText: state.setReplyText,\n  setShowAIReplies: state.setShowAIReplies,\n  setAiReplies: state.setAiReplies,\n  setIsRecordingVoice: state.setIsRecordingVoice,\n  setVoiceRecordingDuration: state.setVoiceRecordingDuration,\n  incrementVoiceDuration: state.incrementVoiceDuration,\n  \n  // Scheduling\n  setIsScheduling: state.setIsScheduling,\n  setScheduledDate: state.setScheduledDate,\n  setScheduledTime: state.setScheduledTime,\n  \n  // Thread\n  setShowThread: state.setShowThread,\n  setThreadMessages: state.setThreadMessages,\n  \n  // Real-time\n  addTypingIndicator: state.addTypingIndicator,\n  removeTypingIndicator: state.removeTypingIndicator,\n  clearExpiredTypingIndicators: state.clearExpiredTypingIndicators,\n  setPresenceStatus: state.setPresenceStatus,\n  updatePresenceStatus: state.updatePresenceStatus,\n  setIsWebSocketConnected: state.setIsWebSocketConnected,\n  \n  // Compose form\n  setComposeTo: state.setComposeTo,\n  setComposeSubject: state.setComposeSubject,\n  setComposeMessage: state.setComposeMessage,\n  addComposeAttachment: state.addComposeAttachment,\n  removeComposeAttachment: state.removeComposeAttachment,\n  clearComposeAttachments: state.clearComposeAttachments,\n  toggleSelectedLabel: state.toggleSelectedLabel,\n  setSelectedLabels: state.setSelectedLabels,\n  setComposePriority: state.setComposePriority,\n  resetComposeForm: state.resetComposeForm,\n  \n  // Bulk actions\n  bulkMarkAsRead: state.bulkMarkAsRead,\n  bulkMarkAsUnread: state.bulkMarkAsUnread,\n  bulkToggleStar: state.bulkToggleStar,\n  bulkDelete: state.bulkDelete,\n  bulkArchive: state.bulkArchive,\n  \n  // Message actions\n  toggleMessageStar: state.toggleMessageStar,\n  markMessageAsRead: state.markMessageAsRead,\n  addLabelToMessage: state.addLabelToMessage,\n  removeLabelFromMessage: state.removeLabelFromMessage,\n  translateMessage: state.translateMessage,\n  \n  // Utility\n  reset: state.reset,\n}))\n"],"names":[],"mappings":"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","ignoreList":[10,11,19,20]}}]
}