;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="5e65efb5-99a6-19a8-9ad8-6939f30b84d2")}catch(e){}}();
module.exports=[217348,a=>{"use strict";var b=a.i(260576),c=a.i(741510),d=a.i(52028),e=a.i(454069),f=a.i(88684),g=a.i(113098),h=a.i(981354),i=a.i(529004),j=a.i(763485),k=a.i(333340),l=a.i(868606),m=a.i(846438),n=a.i(36094),o=a.i(393890),p=a.i(268067),q=a.i(858901),r=a.i(50169),s=a.i(283284),t=a.i(708751);function u(){let a=(0,e.useParams)(),u=(0,e.useSearchParams)(),v="string"==typeof a?.locale?a.locale:"en",w="drafts"===u.get("tab")?"drafts":"public",[x,y]=(0,c.useState)(!0),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)([]),[H,I]=(0,c.useState)([]),[J,K]=(0,c.useState)(w),[L,M]=(0,c.useState)("list"),[N,O]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let a=!0;return(async()=>{y(!0);try{let b=await fetch("/api/tutor/public-profile",{credentials:"include"});if(!b.ok)throw Error("Failed to load public profile");let c=await b.json();if(!a)return;C(c?.profile?.username||""),E(c?.profile?.bio||""),G(Array.isArray(c?.courses)?c.courses:[]);let d=await fetch("/api/tutor/courses",{credentials:"include"});if(d.ok){let a=((await d.json()).courses||[]).filter(a=>!a.isPublished).map(a=>({id:a.id,name:a.name,description:a.description,subject:a.subject,isPublished:a.isPublished,updatedAt:a.updatedAt,_count:a._count||{modules:0,lessons:0}}));I(a)}}catch(a){m.toast.error(a instanceof Error?a.message:"Failed to load data")}finally{a&&y(!1)}})(),()=>{a=!1}},[J]);let P=(0,c.useMemo)(()=>B.trim().replace(/^@+/,""),[B]),Q=(0,c.useMemo)(()=>P?`/${v}/u/${P}`:"",[v,P]),R=(0,c.useMemo)(()=>P?`/@${P}`:"",[P]),S=(0,c.useMemo)(()=>Q,[Q]),T=(0,c.useMemo)(()=>R,[R]),U=async()=>{A(!0);try{let a=await fetch("/api/csrf",{credentials:"include"}),b=await a.json().catch(()=>({})),c=b?.token??null,d=await fetch("/api/tutor/public-profile",{method:"PATCH",headers:{"Content-Type":"application/json",...c?{"X-CSRF-Token":c}:{}},credentials:"include",body:JSON.stringify({username:B,bio:D})}),e=await d.json().catch(()=>({}));if(!d.ok)return void m.toast.error(e?.error||"Failed to save profile");C(e?.profile?.username||B),E(e?.profile?.bio||D),m.toast.success("Public page settings updated")}catch{m.toast.error("Failed to save profile")}finally{A(!1)}},V=a=>new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"My Page & Courses"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Manage your public profile and view your courses."})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[(0,b.jsx)(f.Button,{onClick:()=>O(!0),children:"Create New Course"}),Q&&(0,b.jsx)(f.Button,{variant:"outline",size:"sm",asChild:!0,children:(0,b.jsxs)(d.default,{href:Q,target:"_blank",children:[(0,b.jsx)(o.ExternalLink,{className:"h-4 w-4 mr-1.5"}),"View public page"]})})]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"pb-3",children:[(0,b.jsx)(g.CardTitle,{className:"text-lg",children:"Profile Settings"}),(0,b.jsx)(g.CardDescription,{children:"Customize how you appear to students on your public page."})]}),(0,b.jsxs)(g.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Username"}),(0,b.jsx)(h.Input,{value:B,onChange:a=>C(a.target.value.replace(/\s+/g,"")),placeholder:"e.g. jane.math",disabled:x||z}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Displayed as @",B.replace(/^@+/,"")||"username"]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(i.Label,{children:"Bio"}),(0,b.jsx)(j.Textarea,{value:D,onChange:a=>E(a.target.value),rows:2,disabled:x||z,placeholder:"Short bio for your public page...",className:"min-h-[80px]"})]})]}),(0,b.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[S&&(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2 rounded-md border bg-muted/30 p-2.5 text-sm",children:[(0,b.jsx)("span",{className:"font-medium shrink-0",children:"Public URL"}),(0,b.jsx)("span",{className:"break-all text-muted-foreground flex-1 min-w-0",children:S}),(0,b.jsxs)("div",{className:"flex gap-1 shrink-0",children:[(0,b.jsx)(f.Button,{size:"sm",variant:"outline",className:"h-7",onClick:()=>{navigator.clipboard.writeText(S),m.toast.success("Public URL copied")},children:(0,b.jsx)(n.Copy,{className:"h-3.5 w-3.5"})}),(0,b.jsx)(f.Button,{size:"sm",variant:"ghost",className:"h-7",asChild:!0,children:(0,b.jsx)(d.default,{href:Q,target:"_blank",children:(0,b.jsx)(o.ExternalLink,{className:"h-3.5 w-3.5"})})})]})]}),T&&(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2 rounded-md border bg-muted/30 p-2.5 text-sm",children:[(0,b.jsx)("span",{className:"font-medium shrink-0",children:"@ Handle"}),(0,b.jsx)("span",{className:"break-all text-muted-foreground flex-1 min-w-0",children:T}),(0,b.jsxs)("div",{className:"flex gap-1 shrink-0",children:[(0,b.jsx)(f.Button,{size:"sm",variant:"outline",className:"h-7",onClick:()=>{navigator.clipboard.writeText(T),m.toast.success("@ link copied")},children:(0,b.jsx)(n.Copy,{className:"h-3.5 w-3.5"})}),(0,b.jsx)(f.Button,{size:"sm",variant:"ghost",className:"h-7",asChild:!0,children:(0,b.jsx)(d.default,{href:R,target:"_blank",children:(0,b.jsx)(o.ExternalLink,{className:"h-3.5 w-3.5"})})})]})]})]}),(0,b.jsx)(f.Button,{onClick:U,disabled:x||z,size:"sm",children:z?"Saving...":"Save Public Page"})]})]}),(0,b.jsxs)(l.Tabs,{value:J,onValueChange:K,className:"space-y-6",children:[(0,b.jsxs)(l.TabsList,{className:"grid w-full grid-cols-2 max-w-md",children:[(0,b.jsxs)(l.TabsTrigger,{value:"public",children:["Published Courses",F.length>0&&(0,b.jsx)("span",{className:"ml-2 rounded-full bg-muted px-2 py-0.5 text-xs",children:F.length})]}),(0,b.jsxs)(l.TabsTrigger,{value:"drafts",children:["Work in Progress",H.length>0&&(0,b.jsx)("span",{className:"ml-2 rounded-full bg-muted px-2 py-0.5 text-xs",children:H.length})]})]}),(0,b.jsx)(l.TabsContent,{value:"public",className:"space-y-4",children:(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(g.CardTitle,{children:["Published Courses (",F.length,")"]}),(0,b.jsx)(g.CardDescription,{children:"These courses are visible on your public page."})]}),(0,b.jsx)(f.Button,{onClick:()=>O(!0),className:"w-fit",children:"Create New Course"})]})}),(0,b.jsxs)(g.CardContent,{className:"space-y-2",children:[F.map(a=>(0,b.jsxs)("div",{className:"rounded border p-3",children:[(0,b.jsx)("div",{className:"font-medium",children:a.name}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:a.description||"No description"}),(0,b.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,b.jsx)(k.Badge,{variant:"secondary",children:a.subject}),a.gradeLevel?(0,b.jsx)(k.Badge,{variant:"outline",children:a.gradeLevel}):null,a.difficulty?(0,b.jsx)(k.Badge,{variant:"outline",children:a.difficulty}):null]})]},a.id)),0===F.length&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:'No published courses yet. Go to "Work in Progress" to publish your courses.'})]})]})}),(0,b.jsx)(l.TabsContent,{value:"drafts",className:"space-y-4",children:(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{children:"Work in Progress"}),(0,b.jsx)(g.CardDescription,{children:"Courses you're building that aren't published yet."})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"flex items-center border rounded-md p-1 bg-muted/50",children:[(0,b.jsx)(f.Button,{variant:"grid"===L?"secondary":"ghost",size:"sm",className:"h-7 px-2",onClick:()=>M("grid"),children:(0,b.jsx)(r.LayoutGrid,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{variant:"list"===L?"secondary":"ghost",size:"sm",className:"h-7 px-2",onClick:()=>M("list"),children:(0,b.jsx)(s.List,{className:"h-4 w-4"})})]}),(0,b.jsx)(f.Button,{asChild:!0,children:(0,b.jsx)(d.default,{href:"/tutor/curriculum",children:"+ New Course"})})]})]})}),(0,b.jsx)(g.CardContent,{children:0===H.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"No courses in progress. Start building your first course!"}),(0,b.jsx)(f.Button,{onClick:()=>O(!0),children:"Create New Course"})]}):"list"===L?(0,b.jsx)("div",{className:"space-y-3",children:H.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between rounded border p-4 hover:bg-muted/50 transition-colors",children:[(0,b.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-medium truncate",children:a.name}),(0,b.jsx)(k.Badge,{variant:"secondary",children:a.subject}),(0,b.jsx)(k.Badge,{variant:"outline",className:"text-amber-600 border-amber-200 bg-amber-50",children:"Draft"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:a.description||"No description"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:[a._count.modules," modules • ",a._count.lessons," lessons • Last edited ",V(a.updatedAt)]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,b.jsx)(f.Button,{size:"sm",asChild:!0,children:(0,b.jsxs)(d.default,{href:`/tutor/courses/${a.id}/builder`,children:[(0,b.jsx)(p.Edit,{className:"h-4 w-4 mr-1"}),"Edit & Publish"]})}),(0,b.jsx)(f.Button,{size:"sm",variant:"outline",asChild:!0,children:(0,b.jsxs)(d.default,{href:`/tutor/courses/${a.id}`,children:[(0,b.jsx)(q.DollarSign,{className:"h-4 w-4 mr-1"}),"Price & Schedule"]})})]})]},a.id))}):(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:H.map(a=>(0,b.jsxs)("div",{className:"rounded border p-4 hover:bg-muted/50 transition-colors flex flex-col",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-2",children:[(0,b.jsx)("span",{className:"font-medium truncate",children:a.name}),(0,b.jsx)(k.Badge,{variant:"outline",className:"text-amber-600 border-amber-200 bg-amber-50 shrink-0",children:"Draft"})]}),(0,b.jsx)(k.Badge,{variant:"secondary",className:"mb-2",children:a.subject}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2",children:a.description||"No description"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-3",children:[a._count.modules," modules • ",a._count.lessons," lessons"]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Last edited ",V(a.updatedAt)]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2 mt-4 pt-3 border-t",children:[(0,b.jsx)(f.Button,{size:"sm",asChild:!0,className:"w-full",children:(0,b.jsxs)(d.default,{href:`/tutor/courses/${a.id}/builder`,children:[(0,b.jsx)(p.Edit,{className:"h-4 w-4 mr-1"}),"Edit & Publish"]})}),(0,b.jsx)(f.Button,{size:"sm",variant:"outline",asChild:!0,className:"w-full",children:(0,b.jsxs)(d.default,{href:`/tutor/courses/${a.id}`,children:[(0,b.jsx)(q.DollarSign,{className:"h-4 w-4 mr-1"}),"Price & Schedule"]})})]})]},a.id))})})]})})]}),(0,b.jsx)(t.CreateCourseDialog,{open:N,onOpenChange:O,onCourseCreated:()=>{fetch("/api/tutor/courses",{credentials:"include"}).then(a=>a.ok?a.json():{courses:[]}).then(a=>{I((a.courses||[]).filter(a=>!a.isPublished))}).catch(()=>{})}})]})}a.s(["default",()=>u])}];

//# debugId=5e65efb5-99a6-19a8-9ad8-6939f30b84d2
//# sourceMappingURL=b1c00_TutorMekimi_tutorme-app_src_app_%5Blocale%5D_tutor_my-page_page_tsx_69902c57._.js.map