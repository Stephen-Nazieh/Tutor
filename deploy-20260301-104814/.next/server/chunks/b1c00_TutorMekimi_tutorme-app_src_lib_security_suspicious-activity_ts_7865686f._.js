;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="c26b6240-6426-7cc6-1579-e2e3f800578a")}catch(e){}}();
module.exports=[145830,e=>e.a(async(t,i)=>{try{var a=e.i(909105),n=e.i(320947),r=e.i(738597);e.i(688768);var c=e.i(257357),s=e.i(254799),u=t([r]);async function o(e,t){try{var i;await r.drizzleDb.insert(c.securityEvent).values({id:s.default.randomUUID(),eventType:"auth_failed",ip:e??void 0,metadata:t?{identifierHash:(i=t,s.default.createHash("sha256").update(i).digest("hex").slice(0,16))}:{}})}catch(e){console.error("Failed to log security event:",e)}}async function d(e){let t=new Date(Date.now()-9e5),[i]=await r.drizzleDb.select({count:n.sql`count(*)::int`}).from(c.securityEvent).where((0,a.and)((0,a.eq)(c.securityEvent.eventType,"auth_failed"),(0,a.eq)(c.securityEvent.ip,e),(0,a.gte)(c.securityEvent.createdAt,t)));return(i?.count??0)>=5}[r]=u.then?(await u)():u,e.s(["isSuspiciousIp",()=>d,"logFailedLogin",()=>o]),i()}catch(e){i(e)}},!1)];

//# debugId=c26b6240-6426-7cc6-1579-e2e3f800578a
//# sourceMappingURL=b1c00_TutorMekimi_tutorme-app_src_lib_security_suspicious-activity_ts_7865686f._.js.map