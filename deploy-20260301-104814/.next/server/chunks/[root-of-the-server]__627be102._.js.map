{
  "version": 3,
  "sources": [],
  "debugId": "5a860102-5be0-1349-1399-fe569bc24b97",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/lib/api/params.ts","../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/lib/messaging/permissions.ts"],"sourcesContent":["/**\n * Normalize Next.js dynamic route params to a single string.\n * Next.js 15+ may expose params as Record<string, string | string[]> or Promise<...>.\n * Use this so Drizzle eq(column, id) receives string, not string | string[].\n */\nexport function getParam(\n  params: Record<string, string | string[] | undefined> | undefined,\n  key: string\n): string | undefined {\n  if (!params || typeof params !== 'object') return undefined\n  const value = params[key]\n  if (value == null) return undefined\n  return Array.isArray(value) ? value[0] : value\n}\n\n/**\n * Await params if it's a Promise, then get a single string param.\n */\nexport async function getParamAsync(\n  params: Promise<Record<string, string | string[]>> | Record<string, string | string[]> | undefined,\n  key: string\n): Promise<string | undefined> {\n  const resolved = params instanceof Promise ? await params : params\n  return getParam(resolved as Record<string, string | string[] | undefined>, key)\n}\n","type AppRole = 'STUDENT' | 'TUTOR' | 'PARENT' | 'ADMIN'\n\nconst MESSAGING_ALLOWED_TARGETS: Record<AppRole, AppRole[]> = {\n  STUDENT: ['TUTOR', 'PARENT', 'ADMIN'],\n  TUTOR: ['STUDENT', 'PARENT', 'ADMIN'],\n  PARENT: ['STUDENT', 'TUTOR', 'ADMIN'],\n  ADMIN: ['STUDENT', 'TUTOR', 'PARENT', 'ADMIN'],\n}\n\nexport function canSendDirectMessage(senderRole: AppRole, recipientRole: AppRole): boolean {\n  return MESSAGING_ALLOWED_TARGETS[senderRole].includes(recipientRole)\n}\n\nexport function isConversationAllowedByRoles(roleA: AppRole, roleB: AppRole): boolean {\n  return canSendDirectMessage(roleA, roleB) && canSendDirectMessage(roleB, roleA)\n}\n\nexport function getInboxPathByRole(role: AppRole): string {\n  switch (role) {\n    case 'TUTOR':\n      return '/tutor/messages'\n    case 'STUDENT':\n      return '/student/messages'\n    case 'PARENT':\n      return '/parent/messages'\n    default:\n      return '/admin'\n  }\n}\n\n"],"names":[],"mappings":"wCAkBO,eAAe,EACpB,CAAkG,CAClG,CAAW,MAdX,EAgBiB,IAhBgD,EACjE,GAAW,IAewB,QAAU,MAAM,EAAS,EAb5D,GAAI,CAAC,GAA4B,UAAlB,OAAO,EAAqB,OAAO,AAClD,IAAM,EAAQ,CAAM,CAAC,AAasD,EAblD,QACzB,AAAa,MAAM,AAAf,EACG,KADmB,CACb,OAAO,CAAC,GAAS,CAAK,CAAC,EAAE,CAAG,QAY3C,uDCtBA,IAAM,EAAwD,CAC5D,QAAS,CAAC,QAAS,SAAU,QAAQ,CACrC,MAAO,CAAC,UAAW,SAAU,QAAQ,CACrC,OAAQ,CAAC,UAAW,QAAS,QAAQ,CACrC,MAAO,CAAC,UAAW,QAAS,SAAU,QAAQ,AAChD,EAEO,SAAS,EAAqB,CAAmB,CAAE,CAAsB,EAC9E,OAAO,CAAyB,CAAC,EAAW,CAAC,QAAQ,CAAC,EACxD,CAEO,SAAS,EAA6B,CAAc,CAAE,CAAc,EACzE,OAAO,EAAqB,EAAO,IAAU,EAAqB,EAAO,EAC3E,CAEO,SAAS,EAAmB,CAAa,EAC9C,OAAQ,GACN,IAAK,QACH,MAAO,iBACT,KAAK,UACH,MAAO,mBACT,KAAK,SACH,MAAO,kBACT,SACE,MAAO,QACX,CACF"}}]
}