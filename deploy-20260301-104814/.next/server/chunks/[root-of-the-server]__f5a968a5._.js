;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="727fc314-bede-07ae-6ce8-89ae7eeef097")}catch(e){}}();
module.exports=[921517,(e,t,r)=>{t.exports=e.x("http",()=>require("http"))},406461,(e,t,r)=>{t.exports=e.x("zlib",()=>require("zlib"))},524836,(e,t,r)=>{t.exports=e.x("https",()=>require("https"))},792509,(e,t,r)=>{t.exports=e.x("url",()=>require("url"))},427699,(e,t,r)=>{t.exports=e.x("events",()=>require("events"))},500874,(e,t,r)=>{t.exports=e.x("buffer",()=>require("buffer"))},918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},224361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},654884,139346,983142,322112,e=>{"use strict";var t,r,n="object"==typeof globalThis?globalThis:e.g,a="1.9.0",s=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,o=function(e){var t=new Set([e]),r=new Set,n=e.match(s);if(!n)return function(){return!1};var a={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(null!=a.prerelease)return function(t){return t===e};function o(e){return r.add(e),!1}return function(e){if(t.has(e))return!0;if(r.has(e))return!1;var n=e.match(s);if(!n)return o(e);var i={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(null!=i.prerelease||a.major!==i.major)return o(e);if(0===a.major)return a.minor===i.minor&&a.patch<=i.patch?(t.add(e),!0):o(e);return a.minor<=i.minor?(t.add(e),!0):o(e)}}(a),i=Symbol.for("opentelemetry.js.api."+a.split(".")[0]);function l(e,t,r,s){void 0===s&&(s=!1);var o,l=n[i]=null!=(o=n[i])?o:{version:a};if(!s&&l[e]){var c=Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return r.error(c.stack||c.message),!1}if(l.version!==a){var c=Error("@opentelemetry/api: Registration of version v"+l.version+" for "+e+" does not match previously registered API v"+a);return r.error(c.stack||c.message),!1}return l[e]=t,r.debug("@opentelemetry/api: Registered a global for "+e+" v"+a+"."),!0}function c(e){var t,r,a=null==(t=n[i])?void 0:t.version;if(a&&o(a))return null==(r=n[i])?void 0:r[e]}function u(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+a+".");var r=n[i];r&&delete r[e]}e.s(["getGlobal",()=>c,"registerGlobal",()=>l,"unregisterGlobal",()=>u],139346);var d=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(a)throw a.error}}return o},m=function(e,t,r){if(r||2==arguments.length)for(var n,a=0,s=t.length;a<s;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))},p=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return f("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return f("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return f("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return f("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return f("verbose",this._namespace,e)},e}();function f(e,t,r){var n=c("diag");if(n)return r.unshift(t),n[e].apply(n,m([],d(r),!1))}(t=r||(r={}))[t.NONE=0]="NONE",t[t.ERROR=30]="ERROR",t[t.WARN=50]="WARN",t[t.INFO=60]="INFO",t[t.DEBUG=70]="DEBUG",t[t.VERBOSE=80]="VERBOSE",t[t.ALL=9999]="ALL",e.s(["DiagLogLevel",()=>r],983142);var g=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(a)throw a.error}}return o},h=function(e,t,r){if(r||2==arguments.length)for(var n,a=0,s=t.length;a<s;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))},v=function(){function e(){function e(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=c("diag");if(n)return n[e].apply(n,h([],g(t),!1))}}var t=this;t.setLogger=function(e,n){if(void 0===n&&(n={logLevel:r.INFO}),e===t){var a,s,o,i=Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!=(a=i.stack)?a:i.message),!1}"number"==typeof n&&(n={logLevel:n});var u=c("diag"),d=function(e,t){function n(r,n){var a=t[r];return"function"==typeof a&&e>=n?a.bind(t):function(){}}return e<r.NONE?e=r.NONE:e>r.ALL&&(e=r.ALL),t=t||{},{error:n("error",r.ERROR),warn:n("warn",r.WARN),info:n("info",r.INFO),debug:n("debug",r.DEBUG),verbose:n("verbose",r.VERBOSE)}}(null!=(s=n.logLevel)?s:r.INFO,e);if(u&&!n.suppressOverrideMessage){var m=null!=(o=Error().stack)?o:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+m),d.warn("Current logger will overwrite one already registered from "+m)}return l("diag",d,t,!0)},t.disable=function(){u("diag",t)},t.createComponentLogger=function(e){return new p(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();e.s(["DiagAPI",()=>v],322112);var y=v.instance();e.s(["diag",()=>y],654884)},254799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},238523,e=>e.a(async(t,r)=>{try{let t=await e.y("pg-db6d965ecbff73b5");e.n(t),r()}catch(e){r(e)}},!0),908286,e=>{"use strict";async function t(e,t){var r=e instanceof Promise?await e:e;if(!r||"object"!=typeof r)return;let n=r[t];return null!=n?Array.isArray(n)?n[0]:n:void 0}e.s(["getParamAsync",()=>t])},891820,e=>e.a(async(t,r)=>{try{var n=e.i(909105),a=e.i(997103),s=e.i(320947),o=e.i(738597);e.i(688768);var i=e.i(257357),l=t([o]);async function c(e,t){let r=await o.drizzleDb.select().from(i.taskSubmission).where((0,n.eq)(i.taskSubmission.studentId,e));if(0===r.length)return{averageScore:0,completionRate:0,engagementScore:0,attendanceRate:0,participationRate:0};let a=r.reduce((e,t)=>e+(Number(t.score)||0),0)/r.length,l=r.filter(e=>"graded"===e.status).length/r.length*100,c=r.reduce((e,t)=>e+(t.timeSpent||0),0)/r.length,u=r.reduce((e,t)=>e+(t.attempts||1),0)/r.length,d=Math.min(100,c/300*50+1/u*50),m=await o.drizzleDb.select({sessionId:i.sessionParticipant.sessionId,joinedAt:i.sessionParticipant.joinedAt}).from(i.sessionParticipant).where((0,n.eq)(i.sessionParticipant.studentId,e)),p=new Set(m.map(e=>e.sessionId)),f=new Set(m.filter(e=>null!=e.joinedAt).map(e=>e.sessionId)),g=p.size,h=f.size,[v]=await o.drizzleDb.select({count:s.sql`count(*)::int`}).from(i.message).where((0,n.eq)(i.message.userId,e)),y=v?.count??0,b=Math.min(100,5*y);return{averageScore:Math.round(10*a)/10,completionRate:Math.round(10*l)/10,engagementScore:Math.round(10*d)/10,attendanceRate:Math.round(10*(g>0?h/g*100:0))/10,participationRate:Math.round(10*b)/10}}async function u(e){let t={},r=await o.drizzleDb.select().from(i.taskSubmission).where((0,n.eq)(i.taskSubmission.studentId,e));for(let e of r){let r=e.answers;for(let n of r?.subjects||r?.topics||["general"])t[n]||(t[n]=[]),t[n].push(e.score||0)}let a={};for(let e of r){let t=e.questionResults;if(Array.isArray(t))for(let e of t){let t=e.questionId??"unknown";a[t]||(a[t]={correct:0,total:0}),a[t].total++,e.correct&&a[t].correct++}}for(let t of(await o.drizzleDb.select().from(i.quizAttempt).where((0,n.and)((0,n.eq)(i.quizAttempt.studentId,e),(0,n.isNotNull)(i.quizAttempt.questionResults))).limit(50))){let e=t.questionResults;if(Array.isArray(e))for(let t of e){let e=t.questionId??"unknown";a[e]||(a[e]={correct:0,total:0}),a[e].total++,t.correct&&a[e].correct++}}for(let[e,r]of Object.entries(a)){if(0===r.total)continue;let n=r.correct/r.total*100,a=`Q:${e}`;n>=80?(t[a]||(t[a]=[]),t[a].push(n)):n<50&&(t[a]||(t[a]=[]),t[a].push(n))}let s=[],l=[];for(let[e,r]of Object.entries(t)){let t=r.reduce((e,t)=>e+t,0)/r.length;t>=80?s.push(e):t<60&&l.push(e)}return{strengths:s,weaknesses:l}}async function d(e){let t=await o.drizzleDb.select().from(i.taskSubmission).where((0,n.eq)(i.taskSubmission.studentId,e)).orderBy((0,a.desc)(i.taskSubmission.submittedAt)).limit(50),r={},s=(e,t)=>{r[e]||(r[e]={count:0,lastAt:t}),r[e].count++,t>r[e].lastAt&&(r[e].lastAt=t)};for(let e of t){let t=e.answers;if(t?.mistakes)for(let r of t.mistakes)s(r.type||"general",e.submittedAt)}for(let e of t){let t=e.questionResults;if(Array.isArray(t))for(let r of t){if(r.correct)continue;let t=r.selectedAnswer?`Q:${r.questionId}: chose ${String(r.selectedAnswer).slice(0,40)}`:`Q:${r.questionId}: incorrect`;s(t,e.submittedAt)}}for(let t of(await o.drizzleDb.select().from(i.quizAttempt).where((0,n.and)((0,n.eq)(i.quizAttempt.studentId,e),(0,n.isNotNull)(i.quizAttempt.questionResults))).orderBy((0,a.desc)(i.quizAttempt.completedAt)).limit(50))){let e=t.questionResults;if(Array.isArray(e))for(let r of e){if(r.correct)continue;let e=r.selectedAnswer?`Q:${r.questionId}: chose ${String(r.selectedAnswer).slice(0,40)}`:`Q:${r.questionId}: incorrect`;s(e,t.completedAt)}}return Object.entries(r).map(([e,t])=>({type:e,frequency:t.count,lastOccurred:t.lastAt})).sort((e,t)=>t.frequency-e.frequency).slice(0,10)}async function m(e){let t=[],r=[],s=0,l=0;for(let c of(await o.drizzleDb.select().from(i.quizAttempt).where((0,n.and)((0,n.eq)(i.quizAttempt.studentId,e),(0,n.isNotNull)(i.quizAttempt.questionResults))).orderBy((0,a.desc)(i.quizAttempt.completedAt)).limit(50))){let e=c.questionResults;if(!Array.isArray(e)||0===e.length)continue;let n=e.map(e=>({sourceType:"quiz",sourceId:c.quizId,questionId:e.questionId,correct:e.correct??(void 0!==e.pointsEarned&&void 0!==e.pointsMax&&e.pointsEarned>=.7*e.pointsMax),pointsEarned:e.pointsEarned??0,pointsMax:e.pointsMax??100,selectedAnswer:e.selectedAnswer,completedAt:c.completedAt}));for(let e of n)l++,e.correct?s++:r.push(e.questionId);t.push({sourceType:"quiz",sourceId:c.quizId,completedAt:c.completedAt,questions:n})}for(let c of(await o.drizzleDb.select().from(i.taskSubmission).where((0,n.and)((0,n.eq)(i.taskSubmission.studentId,e),(0,n.isNotNull)(i.taskSubmission.questionResults))).orderBy((0,a.desc)(i.taskSubmission.submittedAt)).limit(50))){let e=c.questionResults;if(!Array.isArray(e)||0===e.length)continue;let n=e.map(e=>({sourceType:"task",sourceId:c.taskId,questionId:e.questionId,correct:e.correct??(void 0!==e.pointsEarned&&void 0!==e.pointsMax&&e.pointsEarned>=.7*e.pointsMax),pointsEarned:e.pointsEarned??0,pointsMax:e.pointsMax??100,selectedAnswer:e.selectedAnswer,completedAt:c.submittedAt}));for(let e of n)l++,e.correct?s++:r.push(e.questionId);t.push({sourceType:"task",sourceId:c.taskId,completedAt:c.submittedAt,questions:n})}return{bySource:t,weakQuestionIds:[...new Set(r)],totalCorrect:s,totalQuestions:l}}async function p(e,t){let r,s=await c(e,t),{strengths:l,weaknesses:m}=await u(e);if(t){let s=await o.drizzleDb.select({id:i.courseBatch.id}).from(i.courseBatch).where((0,n.eq)(i.courseBatch.curriculumId,t)),l=s.length>0?(await o.drizzleDb.select({id:i.generatedTask.id}).from(i.generatedTask).where((0,n.inArray)(i.generatedTask.batchId,s.map(e=>e.id)))).map(e=>e.id):[];r=l.length>0?await o.drizzleDb.select().from(i.taskSubmission).where((0,n.and)((0,n.eq)(i.taskSubmission.studentId,e),(0,n.inArray)(i.taskSubmission.taskId,l))).orderBy((0,a.desc)(i.taskSubmission.submittedAt)).limit(20):await o.drizzleDb.select().from(i.taskSubmission).where((0,n.eq)(i.taskSubmission.studentId,e)).orderBy((0,a.desc)(i.taskSubmission.submittedAt)).limit(20)}else r=await o.drizzleDb.select().from(i.taskSubmission).where((0,n.eq)(i.taskSubmission.studentId,e)).orderBy((0,a.desc)(i.taskSubmission.submittedAt)).limit(20);let p=r.map(e=>{let t=e.answers;return{taskId:e.taskId,score:e.score||0,timeSpent:e.timeSpent||0,attempts:e.attempts||1,completedAt:e.submittedAt,strengths:t?.strengthsDemonstrated||[],weaknesses:t?.areasForImprovement||[]}}),f=await d(e),g=function(e){if(e.length<3)return"normal";let t=e.reduce((e,t)=>e+t.timeSpent,0)/e.length,r=e.reduce((e,t)=>e+t.attempts,0)/e.length;return t<180&&r<1.5?"fast":t>600||r>2.5?"slow":"normal"}(p),h=s.averageScore>=80&&s.completionRate>=80&&s.engagementScore>=70?"advanced":s.averageScore<60||s.completionRate<50||s.engagementScore<40?"struggling":"intermediate",v=r.filter(e=>{let t=e.answers;return t?.taskType==="visual"}).length>r.length/2?"visual":"mixed";return{studentId:e,overallMetrics:s,subjectStrengths:l,subjectWeaknesses:m,learningStyle:v,pace:g,taskHistory:p,commonMistakes:f,performanceCluster:h}}async function f(e){let t=await o.drizzleDb.select({studentId:i.curriculumEnrollment.studentId}).from(i.curriculumEnrollment).where((0,n.eq)(i.curriculumEnrollment.curriculumId,e)),r=await Promise.all(t.map(async t=>{let[r]=await o.drizzleDb.select({name:i.profile.name}).from(i.profile).where((0,n.eq)(i.profile.userId,t.studentId)).limit(1);return{id:t.studentId,name:r?.name??"Unknown",performance:await p(t.studentId,e)}})),a={advanced:0,intermediate:0,struggling:0},s=0,l=[];for(let e of r)a[e.performance.performanceCluster]++,s+=e.performance.overallMetrics.averageScore,"struggling"===e.performance.performanceCluster&&l.push({id:e.id,name:e.name,reason:`Low performance: ${e.performance.overallMetrics.averageScore.toFixed(0)}% avg`});let c=r.sort((e,t)=>t.performance.overallMetrics.averageScore-e.performance.overallMetrics.averageScore).slice(0,5).map(e=>({id:e.id,name:e.name,score:e.performance.overallMetrics.averageScore}));return{totalStudents:t.length,averageScore:t.length>0?s/t.length:0,clusterDistribution:a,topStudents:c,studentsNeedingAttention:l}}async function g(e,t){let r=await p(e,t),[a]=await o.drizzleDb.select().from(i.studentPerformance).where((0,n.eq)(i.studentPerformance.studentId,e)).limit(1),s={studentId:e,cluster:r.performanceCluster,strengths:r.subjectStrengths,weaknesses:r.subjectWeaknesses,commonMistakes:r.commonMistakes.map(e=>({type:e.type,frequency:e.frequency})),learningStyle:r.learningStyle??"mixed",averageScore:r.overallMetrics.averageScore,completionRate:r.overallMetrics.completionRate,engagementScore:r.overallMetrics.engagementScore,attendanceRate:r.overallMetrics.attendanceRate,participationRate:r.overallMetrics.participationRate,pace:r.pace};a?await o.drizzleDb.update(i.studentPerformance).set({cluster:s.cluster,strengths:s.strengths,weaknesses:s.weaknesses,commonMistakes:s.commonMistakes,learningStyle:s.learningStyle,averageScore:s.averageScore,completionRate:s.completionRate,engagementScore:s.engagementScore,attendanceRate:s.attendanceRate,participationRate:s.participationRate,pace:s.pace,curriculumId:t??null}).where((0,n.eq)(i.studentPerformance.id,a.id)):await o.drizzleDb.insert(i.studentPerformance).values({id:crypto.randomUUID(),studentId:s.studentId,curriculumId:t??null,cluster:s.cluster,strengths:s.strengths,weaknesses:s.weaknesses,commonMistakes:s.commonMistakes,learningStyle:s.learningStyle,averageScore:s.averageScore,completionRate:s.completionRate,engagementScore:s.engagementScore,attendanceRate:s.attendanceRate,participationRate:s.participationRate,pace:s.pace,taskHistory:[],skillBreakdown:{},recommendedPeers:[],updatedAt:new Date})}[o]=l.then?(await l)():l,e.s(["getClassPerformanceSummary",()=>f,"getQuestionLevelBreakdown",()=>m,"getStudentPerformance",()=>p,"updateStudentPerformanceRecord",()=>g]),r()}catch(e){r(e)}},!1),412171,e=>{e.v(t=>Promise.all(["server/chunks/b1c00_TutorMekimi_tutorme-app_src_lib_security_suspicious-activity_ts_7865686f._.js"].map(t=>e.l(t))).then(()=>t(145830)))}];

//# debugId=727fc314-bede-07ae-6ce8-89ae7eeef097
//# sourceMappingURL=%5Broot-of-the-server%5D__f5a968a5._.js.map