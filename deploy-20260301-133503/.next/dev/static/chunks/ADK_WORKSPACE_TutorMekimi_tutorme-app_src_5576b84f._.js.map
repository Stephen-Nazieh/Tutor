{
  "version": 3,
  "sources": [],
  "debugId": "83da27e9-9367-1906-148e-7b38e6a62e15",
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/actions/library.ts"],"sourcesContent":["/**\n * Library Actions\n * Server actions for managing tutor's task library\n */\n\n'use server';\n\nimport { drizzleDb } from '@/lib/db/drizzle';\nimport { libraryTask } from '@/lib/db/schema';\nimport { eq, desc } from 'drizzle-orm';\nimport { revalidatePath } from 'next/cache';\n\nexport interface LibraryTask {\n  id: string;\n  question: string;\n  type: 'multiple_choice' | 'short_answer';\n  options?: string[];\n  correctAnswer?: string;\n  explanation?: string;\n  difficulty: string;\n  subject: string;\n  topics: string[];\n  isFavorite: boolean;\n  usageCount: number;\n  lastUsedAt?: Date;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface CreateLibraryTaskInput {\n  question: string;\n  type: 'multiple_choice' | 'short_answer';\n  options?: string[];\n  correctAnswer?: string;\n  explanation?: string;\n  difficulty: string;\n  subject: string;\n  topics: string[];\n}\n\n/**\n * Get all library tasks for a user\n */\nexport async function getLibraryTasks(userId: string): Promise<LibraryTask[]> {\n  try {\n    const tasks = await drizzleDb\n      .select()\n      .from(libraryTask)\n      .where(eq(libraryTask.userId, userId))\n      .orderBy(desc(libraryTask.createdAt));\n    return tasks.map((task) => ({\n      ...task,\n      correctAnswer: task.correctAnswer ?? undefined,\n      explanation: task.explanation ?? undefined,\n      lastUsedAt: task.lastUsedAt ?? undefined,\n      type: task.type as 'multiple_choice' | 'short_answer',\n      topics: (task.topics as string[]) ?? [],\n      options: task.options as string[] | undefined\n    }));\n  } catch (error) {\n    console.error('Failed to get library tasks:', error);\n    return [];\n  }\n}\n\n/**\n * Save a new task to the library\n */\nexport async function saveLibraryTask(\n  userId: string,\n  input: CreateLibraryTaskInput\n): Promise<LibraryTask | null> {\n  try {\n    const id = crypto.randomUUID();\n    await drizzleDb.insert(libraryTask).values({\n      id,\n      userId,\n      question: input.question,\n      type: input.type,\n      options: input.options ?? [],\n      correctAnswer: input.correctAnswer ?? null,\n      explanation: input.explanation ?? null,\n      difficulty: input.difficulty,\n      subject: input.subject,\n      topics: input.topics,\n      isFavorite: false,\n      usageCount: 0\n    });\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, id));\n    revalidatePath('/tutor/library');\n    return task\n      ? {\n          ...task,\n          correctAnswer: task.correctAnswer ?? undefined,\n          explanation: task.explanation ?? undefined,\n          lastUsedAt: task.lastUsedAt ?? undefined,\n          type: task.type as 'multiple_choice' | 'short_answer',\n          topics: (task.topics as string[]) ?? [],\n          options: task.options as string[] | undefined\n        }\n      : null;\n  } catch (error) {\n    console.error('Failed to save library task:', error);\n    return null;\n  }\n}\n\n/**\n * Toggle favorite status of a task\n */\nexport async function toggleFavoriteTask(\n  taskId: string,\n  userId: string\n): Promise<boolean> {\n  try {\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, taskId)).limit(1);\n    if (!task || task.userId !== userId) return false;\n    await drizzleDb\n      .update(libraryTask)\n      .set({ isFavorite: !task.isFavorite })\n      .where(eq(libraryTask.id, taskId));\n    revalidatePath('/tutor/library');\n    return true;\n  } catch (error) {\n    console.error('Failed to toggle favorite:', error);\n    return false;\n  }\n}\n\n/**\n * Delete a task from the library\n */\nexport async function deleteLibraryTask(\n  taskId: string,\n  userId: string\n): Promise<boolean> {\n  try {\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, taskId)).limit(1);\n    if (!task || task.userId !== userId) return false;\n    await drizzleDb.delete(libraryTask).where(eq(libraryTask.id, taskId));\n    revalidatePath('/tutor/library');\n    return true;\n  } catch (error) {\n    console.error('Failed to delete library task:', error);\n    return false;\n  }\n}\n\n/**\n * Increment usage count when a task is used\n */\nexport async function incrementTaskUsage(taskId: string): Promise<boolean> {\n  try {\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, taskId)).limit(1);\n    if (!task) return false;\n    await drizzleDb\n      .update(libraryTask)\n      .set({ usageCount: task.usageCount + 1, lastUsedAt: new Date() })\n      .where(eq(libraryTask.id, taskId));\n    return true;\n  } catch (error) {\n    console.error('Failed to increment task usage:', error);\n    return false;\n  }\n}\n\n/**\n * Migrate legacy tasks (placeholder for future migration logic)\n */\nexport async function migrateLegacyTasks(userId: string): Promise<number> {\n  try {\n    // Placeholder for future migration logic\n    // This would migrate tasks from an old format or storage\n    console.log('Migrating legacy tasks for user:', userId);\n    return 0;\n  } catch (error) {\n    console.error('Failed to migrate legacy tasks:', error);\n    return 0;\n  }\n}\n"],"names":[],"mappings":";;;;;;;MAoEsB,wBAAA,WAAA,GAAA,IAAA,oSAAA,EAAA,8CAAA,yRAAA,EAAA,KAAA,GAAA,+RAAA,EAAA,mDAAA"}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/actions/library.ts"],"sourcesContent":["/**\n * Library Actions\n * Server actions for managing tutor's task library\n */\n\n'use server';\n\nimport { drizzleDb } from '@/lib/db/drizzle';\nimport { libraryTask } from '@/lib/db/schema';\nimport { eq, desc } from 'drizzle-orm';\nimport { revalidatePath } from 'next/cache';\n\nexport interface LibraryTask {\n  id: string;\n  question: string;\n  type: 'multiple_choice' | 'short_answer';\n  options?: string[];\n  correctAnswer?: string;\n  explanation?: string;\n  difficulty: string;\n  subject: string;\n  topics: string[];\n  isFavorite: boolean;\n  usageCount: number;\n  lastUsedAt?: Date;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface CreateLibraryTaskInput {\n  question: string;\n  type: 'multiple_choice' | 'short_answer';\n  options?: string[];\n  correctAnswer?: string;\n  explanation?: string;\n  difficulty: string;\n  subject: string;\n  topics: string[];\n}\n\n/**\n * Get all library tasks for a user\n */\nexport async function getLibraryTasks(userId: string): Promise<LibraryTask[]> {\n  try {\n    const tasks = await drizzleDb\n      .select()\n      .from(libraryTask)\n      .where(eq(libraryTask.userId, userId))\n      .orderBy(desc(libraryTask.createdAt));\n    return tasks.map((task) => ({\n      ...task,\n      correctAnswer: task.correctAnswer ?? undefined,\n      explanation: task.explanation ?? undefined,\n      lastUsedAt: task.lastUsedAt ?? undefined,\n      type: task.type as 'multiple_choice' | 'short_answer',\n      topics: (task.topics as string[]) ?? [],\n      options: task.options as string[] | undefined\n    }));\n  } catch (error) {\n    console.error('Failed to get library tasks:', error);\n    return [];\n  }\n}\n\n/**\n * Save a new task to the library\n */\nexport async function saveLibraryTask(\n  userId: string,\n  input: CreateLibraryTaskInput\n): Promise<LibraryTask | null> {\n  try {\n    const id = crypto.randomUUID();\n    await drizzleDb.insert(libraryTask).values({\n      id,\n      userId,\n      question: input.question,\n      type: input.type,\n      options: input.options ?? [],\n      correctAnswer: input.correctAnswer ?? null,\n      explanation: input.explanation ?? null,\n      difficulty: input.difficulty,\n      subject: input.subject,\n      topics: input.topics,\n      isFavorite: false,\n      usageCount: 0\n    });\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, id));\n    revalidatePath('/tutor/library');\n    return task\n      ? {\n          ...task,\n          correctAnswer: task.correctAnswer ?? undefined,\n          explanation: task.explanation ?? undefined,\n          lastUsedAt: task.lastUsedAt ?? undefined,\n          type: task.type as 'multiple_choice' | 'short_answer',\n          topics: (task.topics as string[]) ?? [],\n          options: task.options as string[] | undefined\n        }\n      : null;\n  } catch (error) {\n    console.error('Failed to save library task:', error);\n    return null;\n  }\n}\n\n/**\n * Toggle favorite status of a task\n */\nexport async function toggleFavoriteTask(\n  taskId: string,\n  userId: string\n): Promise<boolean> {\n  try {\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, taskId)).limit(1);\n    if (!task || task.userId !== userId) return false;\n    await drizzleDb\n      .update(libraryTask)\n      .set({ isFavorite: !task.isFavorite })\n      .where(eq(libraryTask.id, taskId));\n    revalidatePath('/tutor/library');\n    return true;\n  } catch (error) {\n    console.error('Failed to toggle favorite:', error);\n    return false;\n  }\n}\n\n/**\n * Delete a task from the library\n */\nexport async function deleteLibraryTask(\n  taskId: string,\n  userId: string\n): Promise<boolean> {\n  try {\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, taskId)).limit(1);\n    if (!task || task.userId !== userId) return false;\n    await drizzleDb.delete(libraryTask).where(eq(libraryTask.id, taskId));\n    revalidatePath('/tutor/library');\n    return true;\n  } catch (error) {\n    console.error('Failed to delete library task:', error);\n    return false;\n  }\n}\n\n/**\n * Increment usage count when a task is used\n */\nexport async function incrementTaskUsage(taskId: string): Promise<boolean> {\n  try {\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, taskId)).limit(1);\n    if (!task) return false;\n    await drizzleDb\n      .update(libraryTask)\n      .set({ usageCount: task.usageCount + 1, lastUsedAt: new Date() })\n      .where(eq(libraryTask.id, taskId));\n    return true;\n  } catch (error) {\n    console.error('Failed to increment task usage:', error);\n    return false;\n  }\n}\n\n/**\n * Migrate legacy tasks (placeholder for future migration logic)\n */\nexport async function migrateLegacyTasks(userId: string): Promise<number> {\n  try {\n    // Placeholder for future migration logic\n    // This would migrate tasks from an old format or storage\n    console.log('Migrating legacy tasks for user:', userId);\n    return 0;\n  } catch (error) {\n    console.error('Failed to migrate legacy tasks:', error);\n    return 0;\n  }\n}\n"],"names":[],"mappings":";;;;;;;MA8GsB,wBAAA,WAAA,GAAA,IAAA,oSAAA,EAAA,8CAAA,yRAAA,EAAA,KAAA,GAAA,+RAAA,EAAA,sDAAA"}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/actions/library.ts"],"sourcesContent":["/**\n * Library Actions\n * Server actions for managing tutor's task library\n */\n\n'use server';\n\nimport { drizzleDb } from '@/lib/db/drizzle';\nimport { libraryTask } from '@/lib/db/schema';\nimport { eq, desc } from 'drizzle-orm';\nimport { revalidatePath } from 'next/cache';\n\nexport interface LibraryTask {\n  id: string;\n  question: string;\n  type: 'multiple_choice' | 'short_answer';\n  options?: string[];\n  correctAnswer?: string;\n  explanation?: string;\n  difficulty: string;\n  subject: string;\n  topics: string[];\n  isFavorite: boolean;\n  usageCount: number;\n  lastUsedAt?: Date;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface CreateLibraryTaskInput {\n  question: string;\n  type: 'multiple_choice' | 'short_answer';\n  options?: string[];\n  correctAnswer?: string;\n  explanation?: string;\n  difficulty: string;\n  subject: string;\n  topics: string[];\n}\n\n/**\n * Get all library tasks for a user\n */\nexport async function getLibraryTasks(userId: string): Promise<LibraryTask[]> {\n  try {\n    const tasks = await drizzleDb\n      .select()\n      .from(libraryTask)\n      .where(eq(libraryTask.userId, userId))\n      .orderBy(desc(libraryTask.createdAt));\n    return tasks.map((task) => ({\n      ...task,\n      correctAnswer: task.correctAnswer ?? undefined,\n      explanation: task.explanation ?? undefined,\n      lastUsedAt: task.lastUsedAt ?? undefined,\n      type: task.type as 'multiple_choice' | 'short_answer',\n      topics: (task.topics as string[]) ?? [],\n      options: task.options as string[] | undefined\n    }));\n  } catch (error) {\n    console.error('Failed to get library tasks:', error);\n    return [];\n  }\n}\n\n/**\n * Save a new task to the library\n */\nexport async function saveLibraryTask(\n  userId: string,\n  input: CreateLibraryTaskInput\n): Promise<LibraryTask | null> {\n  try {\n    const id = crypto.randomUUID();\n    await drizzleDb.insert(libraryTask).values({\n      id,\n      userId,\n      question: input.question,\n      type: input.type,\n      options: input.options ?? [],\n      correctAnswer: input.correctAnswer ?? null,\n      explanation: input.explanation ?? null,\n      difficulty: input.difficulty,\n      subject: input.subject,\n      topics: input.topics,\n      isFavorite: false,\n      usageCount: 0\n    });\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, id));\n    revalidatePath('/tutor/library');\n    return task\n      ? {\n          ...task,\n          correctAnswer: task.correctAnswer ?? undefined,\n          explanation: task.explanation ?? undefined,\n          lastUsedAt: task.lastUsedAt ?? undefined,\n          type: task.type as 'multiple_choice' | 'short_answer',\n          topics: (task.topics as string[]) ?? [],\n          options: task.options as string[] | undefined\n        }\n      : null;\n  } catch (error) {\n    console.error('Failed to save library task:', error);\n    return null;\n  }\n}\n\n/**\n * Toggle favorite status of a task\n */\nexport async function toggleFavoriteTask(\n  taskId: string,\n  userId: string\n): Promise<boolean> {\n  try {\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, taskId)).limit(1);\n    if (!task || task.userId !== userId) return false;\n    await drizzleDb\n      .update(libraryTask)\n      .set({ isFavorite: !task.isFavorite })\n      .where(eq(libraryTask.id, taskId));\n    revalidatePath('/tutor/library');\n    return true;\n  } catch (error) {\n    console.error('Failed to toggle favorite:', error);\n    return false;\n  }\n}\n\n/**\n * Delete a task from the library\n */\nexport async function deleteLibraryTask(\n  taskId: string,\n  userId: string\n): Promise<boolean> {\n  try {\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, taskId)).limit(1);\n    if (!task || task.userId !== userId) return false;\n    await drizzleDb.delete(libraryTask).where(eq(libraryTask.id, taskId));\n    revalidatePath('/tutor/library');\n    return true;\n  } catch (error) {\n    console.error('Failed to delete library task:', error);\n    return false;\n  }\n}\n\n/**\n * Increment usage count when a task is used\n */\nexport async function incrementTaskUsage(taskId: string): Promise<boolean> {\n  try {\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, taskId)).limit(1);\n    if (!task) return false;\n    await drizzleDb\n      .update(libraryTask)\n      .set({ usageCount: task.usageCount + 1, lastUsedAt: new Date() })\n      .where(eq(libraryTask.id, taskId));\n    return true;\n  } catch (error) {\n    console.error('Failed to increment task usage:', error);\n    return false;\n  }\n}\n\n/**\n * Migrate legacy tasks (placeholder for future migration logic)\n */\nexport async function migrateLegacyTasks(userId: string): Promise<number> {\n  try {\n    // Placeholder for future migration logic\n    // This would migrate tasks from an old format or storage\n    console.log('Migrating legacy tasks for user:', userId);\n    return 0;\n  } catch (error) {\n    console.error('Failed to migrate legacy tasks:', error);\n    return 0;\n  }\n}\n"],"names":[],"mappings":";;;;;;;MAoIsB,wBAAA,WAAA,GAAA,IAAA,oSAAA,EAAA,8CAAA,yRAAA,EAAA,KAAA,GAAA,+RAAA,EAAA,qDAAA"}},
    {"offset": {"line": 56, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/actions/library.ts"],"sourcesContent":["/**\n * Library Actions\n * Server actions for managing tutor's task library\n */\n\n'use server';\n\nimport { drizzleDb } from '@/lib/db/drizzle';\nimport { libraryTask } from '@/lib/db/schema';\nimport { eq, desc } from 'drizzle-orm';\nimport { revalidatePath } from 'next/cache';\n\nexport interface LibraryTask {\n  id: string;\n  question: string;\n  type: 'multiple_choice' | 'short_answer';\n  options?: string[];\n  correctAnswer?: string;\n  explanation?: string;\n  difficulty: string;\n  subject: string;\n  topics: string[];\n  isFavorite: boolean;\n  usageCount: number;\n  lastUsedAt?: Date;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\nexport interface CreateLibraryTaskInput {\n  question: string;\n  type: 'multiple_choice' | 'short_answer';\n  options?: string[];\n  correctAnswer?: string;\n  explanation?: string;\n  difficulty: string;\n  subject: string;\n  topics: string[];\n}\n\n/**\n * Get all library tasks for a user\n */\nexport async function getLibraryTasks(userId: string): Promise<LibraryTask[]> {\n  try {\n    const tasks = await drizzleDb\n      .select()\n      .from(libraryTask)\n      .where(eq(libraryTask.userId, userId))\n      .orderBy(desc(libraryTask.createdAt));\n    return tasks.map((task) => ({\n      ...task,\n      correctAnswer: task.correctAnswer ?? undefined,\n      explanation: task.explanation ?? undefined,\n      lastUsedAt: task.lastUsedAt ?? undefined,\n      type: task.type as 'multiple_choice' | 'short_answer',\n      topics: (task.topics as string[]) ?? [],\n      options: task.options as string[] | undefined\n    }));\n  } catch (error) {\n    console.error('Failed to get library tasks:', error);\n    return [];\n  }\n}\n\n/**\n * Save a new task to the library\n */\nexport async function saveLibraryTask(\n  userId: string,\n  input: CreateLibraryTaskInput\n): Promise<LibraryTask | null> {\n  try {\n    const id = crypto.randomUUID();\n    await drizzleDb.insert(libraryTask).values({\n      id,\n      userId,\n      question: input.question,\n      type: input.type,\n      options: input.options ?? [],\n      correctAnswer: input.correctAnswer ?? null,\n      explanation: input.explanation ?? null,\n      difficulty: input.difficulty,\n      subject: input.subject,\n      topics: input.topics,\n      isFavorite: false,\n      usageCount: 0\n    });\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, id));\n    revalidatePath('/tutor/library');\n    return task\n      ? {\n          ...task,\n          correctAnswer: task.correctAnswer ?? undefined,\n          explanation: task.explanation ?? undefined,\n          lastUsedAt: task.lastUsedAt ?? undefined,\n          type: task.type as 'multiple_choice' | 'short_answer',\n          topics: (task.topics as string[]) ?? [],\n          options: task.options as string[] | undefined\n        }\n      : null;\n  } catch (error) {\n    console.error('Failed to save library task:', error);\n    return null;\n  }\n}\n\n/**\n * Toggle favorite status of a task\n */\nexport async function toggleFavoriteTask(\n  taskId: string,\n  userId: string\n): Promise<boolean> {\n  try {\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, taskId)).limit(1);\n    if (!task || task.userId !== userId) return false;\n    await drizzleDb\n      .update(libraryTask)\n      .set({ isFavorite: !task.isFavorite })\n      .where(eq(libraryTask.id, taskId));\n    revalidatePath('/tutor/library');\n    return true;\n  } catch (error) {\n    console.error('Failed to toggle favorite:', error);\n    return false;\n  }\n}\n\n/**\n * Delete a task from the library\n */\nexport async function deleteLibraryTask(\n  taskId: string,\n  userId: string\n): Promise<boolean> {\n  try {\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, taskId)).limit(1);\n    if (!task || task.userId !== userId) return false;\n    await drizzleDb.delete(libraryTask).where(eq(libraryTask.id, taskId));\n    revalidatePath('/tutor/library');\n    return true;\n  } catch (error) {\n    console.error('Failed to delete library task:', error);\n    return false;\n  }\n}\n\n/**\n * Increment usage count when a task is used\n */\nexport async function incrementTaskUsage(taskId: string): Promise<boolean> {\n  try {\n    const [task] = await drizzleDb.select().from(libraryTask).where(eq(libraryTask.id, taskId)).limit(1);\n    if (!task) return false;\n    await drizzleDb\n      .update(libraryTask)\n      .set({ usageCount: task.usageCount + 1, lastUsedAt: new Date() })\n      .where(eq(libraryTask.id, taskId));\n    return true;\n  } catch (error) {\n    console.error('Failed to increment task usage:', error);\n    return false;\n  }\n}\n\n/**\n * Migrate legacy tasks (placeholder for future migration logic)\n */\nexport async function migrateLegacyTasks(userId: string): Promise<number> {\n  try {\n    // Placeholder for future migration logic\n    // This would migrate tasks from an old format or storage\n    console.log('Migrating legacy tasks for user:', userId);\n    return 0;\n  } catch (error) {\n    console.error('Failed to migrate legacy tasks:', error);\n    return 0;\n  }\n}\n"],"names":[],"mappings":";;;;;;;MAuJsB,wBAAA,WAAA,GAAA,IAAA,oSAAA,EAAA,8CAAA,yRAAA,EAAA,KAAA,GAAA,+RAAA,EAAA,sDAAA"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/class/assets-panel.tsx"],"sourcesContent":["'use client'\n\n/**\n * Assets Panel (Smart Assistant Edition)\n * PRO FEATURES:\n * - Smart Recommendations based on Student Context\n * - Resizable Panels Layout\n * - Glassmorphism UI\n */\n\nimport { useState, useMemo, useEffect } from 'react'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Badge } from '@/components/ui/badge'\nimport { ScrollArea } from '@/components/ui/scroll-area'\nimport { Panel, Group as PanelGroup, Separator as PanelResizeHandle } from 'react-resizable-panels'\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog'\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu'\nimport {\n  Folder,\n  FolderOpen,\n  FileText,\n  FileQuestion,\n  ClipboardCheck,\n  StickyNote,\n  ChevronRight,\n  ChevronDown,\n  Plus,\n  MoreVertical,\n  Search,\n  Upload,\n  File,\n  BookOpen,\n  GraduationCap,\n  Layers,\n  Edit,\n  Trash2,\n  Download,\n  Eye,\n  Sparkles,\n  Zap,\n  Layout,\n  X\n} from 'lucide-react'\nimport { toast } from 'sonner'\nimport { MemoryService } from '@/lib/ai/memory-service'\n\ntype AssetType = 'subject' | 'lesson' | 'task' | 'assessment' | 'note'\n\ninterface Asset {\n  id: string\n  name: string\n  type: AssetType\n  parentId: string | null\n  createdAt: Date\n  updatedAt: Date\n  content?: string\n  fileUrl?: string\n  fileType?: string\n  description?: string\n  metadata?: {\n    taskType?: string\n    difficulty?: string\n    duration?: number\n    topic?: string\n    tags?: string[]\n  }\n}\n\ninterface StudentStub {\n  id: string\n  name: string\n  status: 'active' | 'struggling' | 'idle' | 'needs_help'\n  // In a real app we'd pull full context, here we simulate filtered view\n  struggles?: string[]\n}\n\ninterface AssetsPanelProps {\n  roomId: string\n  students?: StudentStub[]\n  onAssetSelect?: (asset: Asset) => void\n  onAssetCreate?: (asset: Partial<Asset>) => void\n  onAssetDelete?: (assetId: string) => void\n  selectionMode?: boolean\n  onAssetsSelect?: (assets: Asset[]) => void\n  onClose?: () => void\n}\n\nconst typeIcons: Record<AssetType, typeof File> = {\n  subject: GraduationCap,\n  lesson: BookOpen,\n  task: FileQuestion,\n  assessment: ClipboardCheck,\n  note: StickyNote,\n}\n\nconst typeColors: Record<AssetType, string> = {\n  subject: 'bg-blue-500/20 text-blue-400 border-blue-500/50',\n  lesson: 'bg-green-500/20 text-green-400 border-green-500/50',\n  task: 'bg-orange-500/20 text-orange-400 border-orange-500/50',\n  assessment: 'bg-purple-500/20 text-purple-400 border-purple-500/50',\n  note: 'bg-yellow-500/20 text-yellow-400 border-yellow-500/50',\n}\n\nconst typeLabels: Record<AssetType, string> = {\n  subject: 'Subject',\n  lesson: 'Lesson',\n  task: 'Task',\n  assessment: 'Assessment',\n  note: 'Note',\n}\n\n// Mock data - in production this would come from API\nconst mockAssets: Asset[] = [\n  {\n    id: 'sub-1',\n    name: 'Mathematics',\n    type: 'subject',\n    parentId: null,\n    createdAt: new Date('2026-01-15'),\n    updatedAt: new Date('2026-02-10'),\n    description: 'Mathematics curriculum materials',\n    metadata: { topic: 'math' }\n  },\n  {\n    id: 'les-1',\n    name: 'Algebra Basics',\n    type: 'lesson',\n    parentId: 'sub-1',\n    createdAt: new Date('2026-01-16'),\n    updatedAt: new Date('2026-01-20'),\n    description: 'Introduction to algebra',\n    metadata: { topic: 'algebra', tags: ['variables', 'equations'] }\n  },\n  {\n    id: 'les-2',\n    name: 'Linear Equations',\n    type: 'lesson',\n    parentId: 'sub-1',\n    createdAt: new Date('2026-01-18'),\n    updatedAt: new Date('2026-01-25'),\n    metadata: { topic: 'algebra', tags: ['linear_equations'] }\n  },\n  // Adding specific assets for recommendation demo\n  {\n    id: 'task-101',\n    name: 'Quadratic Formula Practice',\n    type: 'task',\n    parentId: 'les-1',\n    createdAt: new Date(),\n    updatedAt: new Date(),\n    description: 'Targeted practice for finding roots.',\n    metadata: { topic: 'quadratic_equations', tags: ['finding_roots'], difficulty: 'hard' }\n  },\n  {\n    id: 'task-1',\n    name: 'Practice Problems Set 1',\n    type: 'task',\n    parentId: 'les-1',\n    createdAt: new Date('2026-01-17'),\n    updatedAt: new Date('2026-01-17'),\n    metadata: { taskType: 'multiple_choice', difficulty: 'beginner' },\n  },\n  {\n    id: 'task-2',\n    name: 'Quiz: Variables',\n    type: 'task',\n    parentId: 'les-1',\n    createdAt: new Date('2026-01-19'),\n    updatedAt: new Date('2026-01-19'),\n    metadata: { taskType: 'short_answer', difficulty: 'intermediate' },\n  },\n  {\n    id: 'assess-1',\n    name: 'Algebra Mid-Assessment',\n    type: 'assessment',\n    parentId: 'sub-1',\n    createdAt: new Date('2026-01-30'),\n    updatedAt: new Date('2026-02-01'),\n    metadata: { duration: 45 },\n  },\n  {\n    id: 'note-1',\n    name: 'Teaching Notes',\n    type: 'note',\n    parentId: 'les-1',\n    createdAt: new Date('2026-01-16'),\n    updatedAt: new Date('2026-02-05'),\n    content: 'Focus on real-world examples. Students struggle with negative numbers.',\n  },\n  {\n    id: 'sub-2',\n    name: 'Physics',\n    type: 'subject',\n    parentId: null,\n    createdAt: new Date('2026-01-10'),\n    updatedAt: new Date('2026-02-08'),\n    description: 'Physics curriculum',\n  },\n  {\n    id: 'les-3',\n    name: 'Mechanics',\n    type: 'lesson',\n    parentId: 'sub-2',\n    createdAt: new Date('2026-01-12'),\n    updatedAt: new Date('2026-01-15'),\n    metadata: { tags: ['force', 'motion'] }\n  },\n  {\n    id: 'task-3',\n    name: 'Force Problems',\n    type: 'task',\n    parentId: 'les-3',\n    createdAt: new Date('2026-01-13'),\n    updatedAt: new Date('2026-01-14'),\n    metadata: { difficulty: 'intermediate' }\n  },\n]\n\nexport function AssetsPanel({ roomId, students = [], onAssetSelect, onAssetCreate, onAssetDelete, selectionMode, onAssetsSelect, onClose }: AssetsPanelProps) {\n  const [assets, setAssets] = useState<Asset[]>(mockAssets)\n  const [expandedFolders, setExpandedFolders] = useState<Set<string>>(new Set(['sub-1', 'sub-2']))\n  const [searchQuery, setSearchQuery] = useState('')\n  const [selectedAsset, setSelectedAsset] = useState<Asset | null>(null)\n  const [viewMode, setViewMode] = useState<'tree' | 'list'>('tree')\n  const [selectedAssets, setSelectedAssets] = useState<Set<string>>(new Set())\n\n  const handleCheckboxChange = (assetId: string, checked: boolean) => {\n    setSelectedAssets(prev => {\n      const next = new Set(prev)\n      if (checked) next.add(assetId)\n      else next.delete(assetId)\n      return next\n    })\n  }\n\n  const handleConfirmSelection = () => {\n    const selected = assets.filter(a => selectedAssets.has(a.id))\n    onAssetsSelect?.(selected)\n  }\n\n  // Smart Recommendations Logic\n  const recommendedAssets = useMemo(() => {\n    // 1. Identify active struggles from connected students\n    const struggleTopics = new Set<string>()\n    students.forEach(s => {\n      if (s.status === 'struggling' && s.struggles) {\n        s.struggles.forEach(topic => struggleTopics.add(topic.toLowerCase()))\n      }\n      // For demo, assume 'finding_roots' is a struggle if anyone is struggling\n      if (s.status === 'struggling') {\n        struggleTopics.add('quadratic_equations')\n        struggleTopics.add('finding_roots')\n      }\n    })\n\n    if (struggleTopics.size === 0) return []\n\n    // 2. Find matching assets\n    return assets.filter(asset => {\n      const topicMatch = asset.metadata?.topic && struggleTopics.has(asset.metadata.topic.toLowerCase())\n      const tagMatch = asset.metadata?.tags?.some(tag => struggleTopics.has(tag.toLowerCase()))\n      const textMatch = struggleTopics.has(asset.name.toLowerCase())\n      return topicMatch || tagMatch || textMatch\n    })\n  }, [assets, students])\n\n  // Build tree structure\n  const assetTree = useMemo(() => {\n    const buildTree = (parentId: string | null): Asset[] => {\n      return assets\n        .filter(a => a.parentId === parentId)\n        .sort((a, b) => {\n          // Folders (subjects, lessons) first, then files\n          const aIsFolder = a.type === 'subject' || a.type === 'lesson'\n          const bIsFolder = b.type === 'subject' || b.type === 'lesson'\n          if (aIsFolder && !bIsFolder) return -1\n          if (!aIsFolder && bIsFolder) return 1\n          return a.name.localeCompare(b.name)\n        })\n    }\n    return buildTree(null)\n  }, [assets])\n\n  // Filtered assets for search\n  const filteredAssets = useMemo(() => {\n    if (!searchQuery) return null\n    return assets.filter(a =>\n      a.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      a.description?.toLowerCase().includes(searchQuery.toLowerCase())\n    )\n  }, [assets, searchQuery])\n\n  const toggleFolder = (id: string) => {\n    setExpandedFolders(prev => {\n      const next = new Set(prev)\n      if (next.has(id)) {\n        next.delete(id)\n      } else {\n        next.add(id)\n      }\n      return next\n    })\n  }\n\n  const getChildAssets = (parentId: string) => {\n    return assets\n      .filter(a => a.parentId === parentId)\n      .sort((a, b) => a.name.localeCompare(b.name))\n  }\n\n  const handleCreateAsset = (type: AssetType, parentId: string | null = null) => {\n    const newAsset: Asset = {\n      id: `${type}-${Date.now()}`,\n      name: `New ${typeLabels[type]}`,\n      type,\n      parentId,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    }\n    setAssets(prev => [...prev, newAsset])\n    if (parentId) {\n      setExpandedFolders(prev => new Set(prev).add(parentId))\n    }\n    toast.success(`Created new ${typeLabels[type]}`)\n    onAssetCreate?.(newAsset)\n  }\n\n  const handleDeleteAsset = (asset: Asset, e: React.MouseEvent) => {\n    e.stopPropagation()\n    // Delete all children recursively\n    const deleteRecursive = (id: string) => {\n      const children = assets.filter(a => a.parentId === id)\n      children.forEach(child => deleteRecursive(child.id))\n      setAssets(prev => prev.filter(a => a.id !== id))\n    }\n    deleteRecursive(asset.id)\n    toast.success('Asset deleted')\n    onAssetDelete?.(asset.id)\n  }\n\n  const AssetIcon = ({ type, isOpen }: { type: AssetType; isOpen?: boolean }) => {\n    const Icon = type === 'subject' || type === 'lesson'\n      ? (isOpen ? FolderOpen : Folder)\n      : typeIcons[type]\n    return <Icon className=\"h-4 w-4\" />\n  }\n\n  const renderAssetItem = (asset: Asset, depth: number = 0) => {\n    const isFolder = asset.type === 'subject' || asset.type === 'lesson'\n    const isExpanded = expandedFolders.has(asset.id)\n    const children = isFolder ? getChildAssets(asset.id) : []\n    const hasChildren = children.length > 0\n    const isSelected = selectedAsset?.id === asset.id\n\n    return (\n      <div key={asset.id} className=\"select-none\">\n        <div\n          className={`group flex items-center gap-2 px-3 py-2 my-0.5 rounded-lg cursor-pointer transition-all duration-200 border border-transparent\n            ${isSelected\n              ? 'bg-blue-600/20 border-blue-500/30 text-white shadow-sm backdrop-blur-sm'\n              : 'hover:bg-white/5 hover:border-white/10 text-gray-300'\n            }`}\n          style={{ paddingLeft: `${12 + depth * 16}px` }}\n          onClick={() => {\n            if (isFolder) {\n              toggleFolder(asset.id)\n            }\n            setSelectedAsset(asset)\n            onAssetSelect?.(asset)\n          }}\n        >\n          {isFolder && hasChildren ? (\n            isExpanded ? (\n              <ChevronDown className=\"h-4 w-4 text-gray-500\" />\n            ) : (\n              <ChevronRight className=\"h-4 w-4 text-gray-500\" />\n            )\n          ) : (\n            <span className=\"w-4\" />\n          )}\n\n          {selectionMode && !isFolder && (\n            <input\n              type=\"checkbox\"\n              className=\"mr-2\"\n              checked={selectedAssets.has(asset.id)}\n              onClick={(e) => e.stopPropagation()}\n              onChange={(e) => handleCheckboxChange(asset.id, e.target.checked)}\n            />\n          )}\n\n          <span className={`p-1.5 rounded-md border ${typeColors[asset.type]}`}>\n            <AssetIcon type={asset.type} isOpen={isExpanded} />\n          </span>\n\n          <span className=\"flex-1 truncate text-sm font-medium\">{asset.name}</span>\n\n          {asset.metadata?.difficulty && (\n            <Badge variant=\"outline\" className={`text-[10px] px-1 h-5 ${asset.metadata.difficulty === 'hard' ? 'border-red-500/50 text-red-400' :\n              asset.metadata.difficulty === 'intermediate' ? 'border-yellow-500/50 text-yellow-400' :\n                'border-green-500/50 text-green-400'\n              }`}>\n              {asset.metadata.difficulty}\n            </Badge>\n          )}\n\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild onClick={(e) => e.stopPropagation()}>\n              <Button variant=\"ghost\" size=\"icon\" className=\"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity\">\n                <MoreVertical className=\"h-3 w-3\" />\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent align=\"end\" className=\"bg-gray-800 border-gray-700 text-gray-200\">\n              <DropdownMenuItem onClick={(e) => {\n                e.stopPropagation()\n                setSelectedAsset(asset)\n              }}>\n                <Eye className=\"h-4 w-4 mr-2\" />\n                Preview\n              </DropdownMenuItem>\n              <DropdownMenuItem onClick={(e) => e.stopPropagation()}>\n                <Edit className=\"h-4 w-4 mr-2\" />\n                Rename\n              </DropdownMenuItem>\n              <DropdownMenuItem onClick={(e) => e.stopPropagation()}>\n                <Download className=\"h-4 w-4 mr-2\" />\n                Download\n              </DropdownMenuItem>\n              <DropdownMenuItem\n                className=\"text-red-400 focus:text-red-400 focus:bg-red-900/20\"\n                onClick={(e) => handleDeleteAsset(asset, e)}\n              >\n                <Trash2 className=\"h-4 w-4 mr-2\" />\n                Delete\n              </DropdownMenuItem>\n            </DropdownMenuContent>\n          </DropdownMenu>\n        </div>\n\n        {isFolder && isExpanded && hasChildren && (\n          <div className=\"relative\">\n            <div className=\"absolute left-[20px] top-0 bottom-0 w-px bg-gray-800\" style={{ left: `${19 + depth * 16}px` }} />\n            {children.map(child => renderAssetItem(child, depth + 1))}\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"h-full flex flex-col bg-black/40 backdrop-blur-xl border-l border-white/10 text-white shadow-2xl\">\n      {/* Header */}\n      <div className=\"p-4 border-b border-white/10 shrink-0 bg-white/5\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"bg-gradient-to-br from-amber-500 to-orange-600 p-2.5 rounded-xl shadow-lg shadow-orange-900/20 shrink-0\">\n              <Layers className=\"h-5 w-5 text-white\" />\n            </div>\n            <div>\n              <h2 className=\"text-lg font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-400\">Smart Assets</h2>\n              <p className=\"text-xs text-gray-400\">AI-Curated Materials</p>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-2 shrink-0\">\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              className=\"h-8 w-8 p-0 rounded-full hover:bg-white/10\"\n              onClick={() => setViewMode(viewMode === 'tree' ? 'list' : 'tree')}\n            >\n              <Layout className=\"h-4 w-4\" />\n            </Button>\n            <Dialog>\n              <DialogTrigger asChild>\n                <Button size=\"sm\" className=\"bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-900/20 border border-blue-400/20\">\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  New\n                </Button>\n              </DialogTrigger>\n              <DialogContent className=\"bg-gray-900/95 border-gray-700 text-white backdrop-blur-xl\">\n                <DialogHeader>\n                  <DialogTitle>Create New Asset</DialogTitle>\n                </DialogHeader>\n                <div className=\"grid grid-cols-2 gap-3 mt-4\">\n                  <Button\n                    variant=\"outline\"\n                    className=\"h-auto py-4 flex flex-col items-center gap-2 hover:bg-white/5 border-gray-700\"\n                    onClick={() => handleCreateAsset('subject')}\n                  >\n                    <GraduationCap className=\"h-6 w-6 text-blue-400\" />\n                    <span>Subject</span>\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    className=\"h-auto py-4 flex flex-col items-center gap-2 hover:bg-white/5 border-gray-700\"\n                    onClick={() => handleCreateAsset('lesson')}\n                  >\n                    <BookOpen className=\"h-6 w-6 text-green-400\" />\n                    <span>Lesson</span>\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    className=\"h-auto py-4 flex flex-col items-center gap-2 hover:bg-white/5 border-gray-700\"\n                    onClick={() => handleCreateAsset('task')}\n                  >\n                    <FileQuestion className=\"h-6 w-6 text-orange-400\" />\n                    <span>Task</span>\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    className=\"h-auto py-4 flex flex-col items-center gap-2 hover:bg-white/5 border-gray-700\"\n                    onClick={() => handleCreateAsset('assessment')}\n                  >\n                    <ClipboardCheck className=\"h-6 w-6 text-purple-400\" />\n                    <span>Assessment</span>\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    className=\"h-auto py-4 flex flex-col items-center gap-2 col-span-2 hover:bg-white/5 border-gray-700\"\n                    onClick={() => handleCreateAsset('note')}\n                  >\n                    <StickyNote className=\"h-6 w-6 text-yellow-400\" />\n                    <span>Note</span>\n                  </Button>\n                </div>\n              </DialogContent>\n            </Dialog>\n            {selectionMode && onClose && (\n              <Button variant=\"ghost\" size=\"sm\" onClick={onClose} className=\"text-gray-400 hover:text-white\">\n                <X className=\"h-4 w-4\" />\n              </Button>\n            )}\n          </div>\n        </div>\n\n        {/* Search */}\n        <div className=\"relative group\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-500 group-focus-within:text-blue-400 transition-colors\" />\n          <Input\n            placeholder=\"Search assets...\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            className=\"pl-10 bg-black/20 border-white/10 text-white focus:bg-black/40 focus:border-blue-500/50 transition-all rounded-xl\"\n          />\n        </div>\n      </div>\n\n      {/* Content Area with Resizable Panels */}\n      <PanelGroup orientation=\"horizontal\" className=\"flex-1 min-h-0\">\n\n        {/* Left Panel: Asset List */}\n        <Panel defaultSize={60} minSize={30}>\n          <ScrollArea className=\"h-full\">\n            {/* Smart Recommendations Section */}\n            {recommendedAssets.length > 0 && !searchQuery && (\n              <div className=\"p-4 pb-2 border-b border-white/5 bg-gradient-to-b from-blue-900/10 to-transparent\">\n                <div className=\"flex items-center gap-2 mb-3 text-blue-300\">\n                  <Sparkles className=\"h-4 w-4\" />\n                  <span className=\"text-xs font-bold uppercase tracking-wider\">Recommended for Class</span>\n                </div>\n                <div className=\"space-y-1\">\n                  {recommendedAssets.map(asset => renderAssetItem(asset))}\n                </div>\n              </div>\n            )}\n\n            <div className=\"p-4\">\n              <div className=\"flex items-center gap-2 mb-3 text-gray-500\">\n                <Folder className=\"h-4 w-4\" />\n                <span className=\"text-xs font-bold uppercase tracking-wider\">All Library</span>\n              </div>\n\n              {searchQuery ? (\n                // Search results\n                filteredAssets && filteredAssets.length > 0 ? (\n                  <div className=\"space-y-1\">\n                    {filteredAssets.map(asset => renderAssetItem(asset, 0))}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-12 text-gray-500\">\n                    <Search className=\"h-12 w-12 mx-auto mb-3 opacity-20\" />\n                    <p>No assets found</p>\n                  </div>\n                )\n              ) : (\n                // Tree view\n                <div className=\"space-y-1\">\n                  {assetTree.length > 0 ? (\n                    assetTree.map(asset => (\n                      <div key={asset.id} className=\"group\">\n                        {renderAssetItem(asset, 0)}\n                      </div>\n                    ))\n                  ) : (\n                    <div className=\"text-center py-12 text-gray-500\">\n                      <Folder className=\"h-12 w-12 mx-auto mb-3 opacity-20\" />\n                      <p>No assets yet</p>\n                      <Button variant=\"link\" onClick={() => handleCreateAsset('subject')}>Create Subject</Button>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          </ScrollArea>\n        </Panel>\n\n        {/* Resizer Handle */}\n        <PanelResizeHandle className=\"w-1 bg-white/5 hover:bg-blue-500/50 transition-colors cursor-col-resize active:bg-blue-600\" />\n\n        {/* Right Panel: Preview (Collapsible?) */}\n        {selectedAsset && (\n          <Panel defaultSize={40} minSize={20}>\n            <div className=\"h-full flex flex-col bg-black/20 backdrop-blur-md border-l border-white/5\">\n              <ScrollArea className=\"flex-1 p-5\">\n                <div className=\"flex items-start gap-4 mb-6\">\n                  <div className={`p-3 rounded-xl shadow-lg ${typeColors[selectedAsset.type]}`}>\n                    <AssetIcon type={selectedAsset.type} />\n                  </div>\n                  <div className=\"flex-1 min-w-0 pt-1\">\n                    <h3 className=\"font-bold text-lg leading-tight truncate text-white\">{selectedAsset.name}</h3>\n                    <p className=\"text-xs text-blue-300/80 mt-1 uppercase tracking-wide font-medium\">{typeLabels[selectedAsset.type]}</p>\n                  </div>\n                </div>\n\n                <div className=\"space-y-6\">\n                  {selectedAsset.description && (\n                    <div className=\"space-y-2\">\n                      <h4 className=\"text-xs font-bold text-gray-500 uppercase tracking-wider\">Description</h4>\n                      <p className=\"text-sm text-gray-300 leading-relaxed bg-white/5 p-3 rounded-lg border border-white/5\">\n                        {selectedAsset.description}\n                      </p>\n                    </div>\n                  )}\n\n                  {selectedAsset.metadata && (\n                    <div className=\"space-y-3\">\n                      <h4 className=\"text-xs font-bold text-gray-500 uppercase tracking-wider\">Details</h4>\n                      <div className=\"grid grid-cols-2 gap-3\">\n                        {selectedAsset.metadata.taskType && (\n                          <div className=\"bg-white/5 p-2 rounded border border-white/5\">\n                            <span className=\"block text-[10px] text-gray-500 uppercase\">Type</span>\n                            <span className=\"text-sm capitalize\">{selectedAsset.metadata.taskType.replace('_', ' ')}</span>\n                          </div>\n                        )}\n                        {selectedAsset.metadata.difficulty && (\n                          <div className=\"bg-white/5 p-2 rounded border border-white/5\">\n                            <span className=\"block text-[10px] text-gray-500 uppercase\">Difficulty</span>\n                            <span className={`text-sm capitalize font-medium ${selectedAsset.metadata.difficulty === 'hard' ? 'text-red-400' :\n                              selectedAsset.metadata.difficulty === 'intermediate' ? 'text-yellow-400' :\n                                'text-green-400'\n                              }`}>\n                              {selectedAsset.metadata.difficulty}\n                            </span>\n                          </div>\n                        )}\n                        {selectedAsset.metadata.duration && (\n                          <div className=\"bg-white/5 p-2 rounded border border-white/5\">\n                            <span className=\"block text-[10px] text-gray-500 uppercase\">Duration</span>\n                            <span className=\"text-sm\">{selectedAsset.metadata.duration} min</span>\n                          </div>\n                        )}\n                        {selectedAsset.metadata.topic && (\n                          <div className=\"bg-white/5 p-2 rounded border border-white/5\">\n                            <span className=\"block text-[10px] text-gray-500 uppercase\">Topic</span>\n                            <span className=\"text-sm capitalize\">{selectedAsset.metadata.topic}</span>\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  )}\n\n                  {selectedAsset.content && (\n                    <div className=\"space-y-2\">\n                      <h4 className=\"text-xs font-bold text-gray-500 uppercase tracking-wider\">Preview</h4>\n                      <div className=\"bg-black/40 p-4 rounded-lg text-sm font-mono text-gray-300 max-h-60 overflow-y-auto border border-white/10 shadow-inner\">\n                        {selectedAsset.content}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </ScrollArea>\n\n              <div className=\"p-4 border-t border-white/10 bg-black/20 backdrop-blur-sm space-y-3\">\n                <div className=\"flex justify-between text-[10px] text-gray-500 font-medium uppercase tracking-wider\">\n                  <span>Created {selectedAsset.createdAt.toLocaleDateString()}</span>\n                  <span>Updated {selectedAsset.updatedAt.toLocaleDateString()}</span>\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button variant=\"outline\" className=\"flex-1 border-white/10 hover:bg-white/5 text-gray-300\">\n                    <Edit className=\"h-4 w-4 mr-2\" /> Edit\n                  </Button>\n                  <Button className=\"flex-1 bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-900/20\">\n                    <Zap className=\"h-4 w-4 mr-2\" /> Open\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </Panel>\n        )}\n      </PanelGroup>\n\n      {/* Footer Stats */}\n      <div className=\"p-2 border-t border-white/10 bg-black/30 backdrop-blur-sm shrink-0 flex justify-between items-center text-[10px] text-gray-500 uppercase tracking-wider font-medium px-4\">\n        <div className=\"flex gap-4\">\n          <span>{assets.filter(a => a.type === 'subject').length} Subjects</span>\n          <span>{assets.filter(a => a.type === 'lesson').length} Lessons</span>\n          <span>{assets.filter(a => a.type === 'task').length} Tasks</span>\n        </div>\n        <span>{assets.length} Assets</span>\n      </div>\n\n      {/* Selection Mode Footer */}\n      {selectionMode && (\n        <div className=\"p-4 border-t border-white/10 bg-black/40 backdrop-blur-sm flex justify-between items-center\">\n          <span className=\"text-sm text-gray-400\">{selectedAssets.size} selected</span>\n          <Button onClick={handleConfirmSelection} disabled={selectedAssets.size === 0} size=\"sm\" className=\"bg-purple-600 hover:bg-purple-500\">\n            Select {selectedAssets.size > 0 ? `(${selectedAssets.size})` : ''}\n          </Button>\n        </div>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1635, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/lib/ai/memory-service.ts"],"sourcesContent":["/**\n * Memory Service\n * The \"Shared Brain\" for AI Agents\n * Manages context persistence and retrieval\n */\n\nimport { StudentContext, StudentProfile, LearningState, AgentSignal } from './types/context'\n\n// Mock Database (In-Memory for now)\nconst profiles = new Map<string, StudentProfile>()\nconst states = new Map<string, LearningState>()\nconst signals = new Map<string, AgentSignal[]>()\nconst roomTranscripts = new Map<string, any[]>()\n\n// Initialize with some mock data for testing\nconst MOCK_STUDENT_ID = 'student-1'\nprofiles.set(MOCK_STUDENT_ID, {\n    id: MOCK_STUDENT_ID,\n    name: 'Sarah Chen',\n    age: 16,\n    level: 'B1',\n    learningStyle: 'visual',\n    interests: ['music', 'technology', 'travel'],\n    goals: ['improve_pronunciation', 'vocabulary_expansion'],\n    preferredVoice: { gender: 'female', accent: 'us' }\n})\n\nstates.set(MOCK_STUDENT_ID, {\n    currentMood: 'neutral',\n    energyLevel: 80,\n    recentStruggles: [],\n    masteredTopics: ['present_perfect', 'basic_greetings'],\n    activeTopics: ['conditionals', 'phrasal_verbs']\n})\n\nsignals.set(MOCK_STUDENT_ID, [])\n\nexport class MemoryService {\n    /**\n     * Get the full context for a student\n     * Aggregates Profile + State + Signals\n     */\n    static async getStudentContext(studentId: string): Promise<StudentContext | null> {\n        const profile = profiles.get(studentId)\n        if (!profile) return null\n\n        const state = states.get(studentId) || this.getInitialState()\n        const studentSignals = signals.get(studentId) || []\n\n        // Filter out expired signals\n        const activeSignals = studentSignals.filter(s => !s.expiresAt || s.expiresAt > Date.now())\n\n        return {\n            profile,\n            state,\n            signals: activeSignals\n        }\n    }\n\n    /**\n     * Transcript Management\n     */\n    static appendTranscript(roomId: string, entry: any) {\n        const current = roomTranscripts.get(roomId) || []\n        roomTranscripts.set(roomId, [...current, entry])\n    }\n\n    static getTranscript(roomId: string): any[] {\n        return roomTranscripts.get(roomId) || []\n    }\n\n    /**\n     * Record a new signal from an agent\n     */\n    static async recordSignal(studentId: string, signal: Omit<AgentSignal, 'id' | 'timestamp'>) {\n        const newSignal: AgentSignal = {\n            ...signal,\n            id: Math.random().toString(36).substring(7),\n            timestamp: Date.now()\n        }\n\n        const currentSignals = signals.get(studentId) || []\n        signals.set(studentId, [...currentSignals, newSignal])\n\n        // Auto-update state based on signals\n        if (signal.type === 'struggle_detected') {\n            await this.updateState(studentId, (state) => {\n                state.recentStruggles.push({\n                    topic: signal.context?.topic || 'unknown',\n                    errorType: signal.context?.errorType || 'general',\n                    severity: signal.context?.severity || 5,\n                    detectedAt: Date.now()\n                })\n                // Keep only last 5 struggles\n                if (state.recentStruggles.length > 5) state.recentStruggles.shift()\n                return state\n            })\n        }\n    }\n\n    /**\n     * Update the dynamic learning state\n     */\n    static async updateState(studentId: string, updateFn: (state: LearningState) => LearningState) {\n        const currentState = states.get(studentId) || this.getInitialState()\n        const newState = updateFn({ ...currentState })\n        states.set(studentId, newState)\n    }\n\n    /**\n     * Get initial state for new students\n     */\n    private static getInitialState(): LearningState {\n        return {\n            currentMood: 'neutral',\n            energyLevel: 100,\n            recentStruggles: [],\n            masteredTopics: [],\n            activeTopics: []\n        }\n    }\n\n    /**\n     * Analyze Transcript Summary and update context\n     * This is the bridge from Classroom TA to Personal Tutor\n     */\n    static async processClassSummary(studentId: string, summaryJson: any) {\n        // 1. Record the summary signal\n        await this.recordSignal(studentId, {\n            source: 'classroom_ta',\n            type: 'topic_requested', // Or a new type 'class_summary'\n            content: `Completed class on ${summaryJson.topic}. Status: ${summaryJson.status}`,\n            context: summaryJson\n        })\n\n        // 2. Update state based on summary\n        await this.updateState(studentId, (state) => {\n            // Add struggles\n            if (summaryJson.struggles && Array.isArray(summaryJson.struggles)) {\n                summaryJson.struggles.forEach((s: string) => {\n                    state.recentStruggles.push({\n                        topic: s,\n                        errorType: 'general',\n                        severity: 7,\n                        detectedAt: Date.now()\n                    })\n                })\n            }\n\n            // Update active topics\n            if (summaryJson.topic) {\n                if (!state.activeTopics.includes(summaryJson.topic)) {\n                    state.activeTopics.push(summaryJson.topic)\n                }\n            }\n\n            return state\n        })\n    }\n\n    /**\n     * Record Quiz Result and Update Context\n     * Updates student context based on quiz performance\n     */\n    static async recordQuizResult(studentId: string, result: {\n        topic: string\n        score: number\n        maxScore: number\n        questionTypes: string[]\n    }) {\n        const percentage = result.score / result.maxScore\n\n        // Record signal\n        await this.recordSignal(studentId, {\n            source: 'personal_tutor',\n            type: percentage >= 0.7 ? 'mastery_achieved' : 'struggle_detected',\n            content: `Quiz on ${result.topic}: ${result.score}/${result.maxScore} (${Math.round(percentage * 100)}%)`,\n            context: result\n        })\n\n        // Update state based on performance\n        await this.updateState(studentId, (state) => {\n            if (percentage < 0.7) {\n                // Poor performance - add to struggles\n                const existingStruggle = state.recentStruggles.find(s => s.topic === result.topic)\n                if (!existingStruggle) {\n                    state.recentStruggles.push({\n                        topic: result.topic,\n                        errorType: 'general',\n                        severity: Math.round((1 - percentage) * 10), // Higher severity for lower scores\n                        detectedAt: Date.now()\n                    })\n                    // Keep only last 10 struggles\n                    if (state.recentStruggles.length > 10) {\n                        state.recentStruggles.shift()\n                    }\n                }\n\n                // Add to active topics if not already there\n                if (!state.activeTopics.includes(result.topic)) {\n                    state.activeTopics.push(result.topic)\n                }\n            } else if (percentage >= 0.85) {\n                // Excellent performance - add to mastered topics\n                if (!state.masteredTopics.includes(result.topic)) {\n                    state.masteredTopics.push(result.topic)\n                }\n\n                // Remove from struggles if present\n                state.recentStruggles = state.recentStruggles.filter(s => s.topic !== result.topic)\n            }\n\n            return state\n        })\n    }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1846, "column": 0}, "map": {"version":3,"sources":["file:///Users/nazy/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/components/class/course-dev-panel.tsx"],"sourcesContent":["// @ts-nocheck\n'use client'\n\n/**\n * Course Development Panel - Phase 1 Enhancements\n * Features: Quick Start Templates, Smart Defaults, Quick Assign\n */\n\nimport { useState, useEffect, useTransition, startTransition } from 'react'\nimport {\n  getLibraryTasks,\n  saveLibraryTask,\n  toggleFavoriteTask,\n  deleteLibraryTask,\n  incrementTaskUsage,\n  migrateLegacyTasks\n} from '@/app/actions/library'\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card'\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { ScrollArea } from '@/components/ui/scroll-area'\nimport {\n  Wand2,\n  Users,\n  CheckCircle,\n  Loader2,\n  Send,\n  Save,\n  Trash2,\n  Edit3,\n  GraduationCap,\n  BookOpen,\n  FileQuestion,\n  Clock,\n  BarChart3,\n  Sparkles,\n  LayoutGrid,\n  List,\n  Zap,\n  Heart,\n  Star,\n  Stethoscope,\n  Eye,\n  Copy,\n  Square,\n  CheckSquare,\n\n  Library,\n  Search,\n  FolderHeart,\n  UploadCloud,\n  FileText,\n  FileUp,\n  X,\n  Target\n} from 'lucide-react'\nimport { AssetsPanel } from './assets-panel'\nimport { toast } from 'sonner'\nimport { MemoryService } from '@/lib/ai/memory-service'\n\ninterface CourseDevPanelProps {\n  roomId: string\n  students: {\n    id: string\n    name: string\n    userId: string\n    status?: string\n  }[]\n}\n\n// Phase 3: Library Task Interface\ninterface LibraryTask {\n  id: string\n  question: string\n  type: 'multiple_choice' | 'short_answer'\n  options?: string[]\n  correctAnswer?: string\n  explanation: string\n  difficulty: string\n  subject: string\n  topics: string[]\n  savedAt: string\n  usedCount: number\n  isFavorite: boolean\n  lastUsed?: string\n}\n\ninterface Library {\n  tasks: LibraryTask[]\n  version: number\n}\n\n// Quick Start Templates\nconst QUICK_TEMPLATES = [\n  {\n    id: 'math-algebra',\n    name: 'Math: Algebra Practice',\n    subject: 'Mathematics',\n    topics: 'Algebra, Linear Equations, Solving for Variables',\n    difficulty: 'intermediate' as const,\n    count: 5,\n    icon: '',\n  },\n  {\n    id: 'science-forces',\n    name: 'Science: Forces & Motion',\n    subject: 'Physics',\n    topics: 'Newton\\'s Laws, Force, Acceleration, Friction',\n    difficulty: 'intermediate' as const,\n    count: 8,\n    icon: '',\n  },\n  {\n    id: 'reading-comp',\n    name: 'Reading Comprehension',\n    subject: 'English',\n    topics: 'Main Idea, Inference, Context Clues',\n    difficulty: 'beginner' as const,\n    count: 6,\n    icon: '',\n  },\n  {\n    id: 'math-geometry',\n    name: 'Geometry Basics',\n    subject: 'Mathematics',\n    topics: 'Area, Perimeter, Circles, Triangles',\n    difficulty: 'beginner' as const,\n    count: 7,\n    icon: '',\n  },\n]\n\nexport function CourseDevPanel({ roomId, students }: CourseDevPanelProps) {\n  const [step, setStep] = useState<'generate' | 'review' | 'assign'>('generate')\n  const [isGenerating, setIsGenerating] = useState(false)\n\n  // Phase 2: Inline editing\n  const [editingTaskId, setEditingTaskId] = useState<string | null>(null)\n\n  // Phase 2: Batch operations\n  const [selectedTasks, setSelectedTasks] = useState<Set<string>>(new Set())\n  // Phase 4: Difficulty Auto-Calibration\n  // No new state needed, uses existing config.difficulty\n\n  // Phase 5: Import & Digitization\n  const [showImport, setShowImport] = useState(false)\n  const [isAnalyzing, setIsAnalyzing] = useState(false)\n  const [analysisProgress, setAnalysisProgress] = useState(0)\n  const [importedTasks, setImportedTasks] = useState<any[]>([])\n  const [importFile, setImportFile] = useState<File | null>(null)\n\n  // Phase 14: Source Selection & Assets Integration\n  const [sourceType, setSourceType] = useState<'lesson_transcript' | 'uploaded_documents' | 'all_sources'>('lesson_transcript')\n  const [showAssetsPanel, setShowAssetsPanel] = useState(false)\n  const [selectedAssets, setSelectedAssets] = useState<any[]>([])\n\n  // Phase 6: Assessment Builder\n  const [assignmentMode, setAssignmentMode] = useState<'practice' | 'exam'>('practice')\n  const [examConfig, setExamConfig] = useState({\n    title: '',\n    timeLimit: 30, // minutes\n    passingScore: 70, // percentage\n    shuffle: true\n  })\n\n  const [generatedTasks, setGeneratedTasks] = useState<any[]>([])\n  const [viewMode, setViewMode] = useState<'grid' | 'list'>('grid')\n\n  // Phase 3: Task Library\n  const [showLibrary, setShowLibrary] = useState(false)\n  const [searchQuery, setSearchQuery] = useState('')\n  const [showFavoritesOnly, setShowFavoritesOnly] = useState(false)\n  const [library, setLibrary] = useState<Library>({ tasks: [], version: 1 })\n\n  const [config, setConfig] = useState({\n    subject: '',\n    topics: '',\n    difficulty: 'intermediate',\n    count: 5,\n    distributionMode: 'personalized' as 'uniform' | 'personalized' | 'clustered',\n    questionType: 'mixed' as 'mixed' | 'multiple_choice' | 'short_answer'\n  })\n\n  // Smart Defaults: Load from localStorage on mount\n  useEffect(() => {\n    const loadSmartDefaults = () => {\n      try {\n        const saved = localStorage.getItem('coursedev-preferences')\n        if (saved) {\n          const prefs = JSON.parse(saved)\n          // Apply smart defaults\n          if (prefs.recentSubject) {\n            setConfig(prev => ({\n              ...prev,\n              subject: prefs.recentSubject,\n              topics: prefs.recentTopics || '',\n              difficulty: prefs.preferredDifficulty || 'intermediate',\n            }))\n          }\n        }\n      } catch (error) {\n        console.error('Failed to load preferences:', error)\n      }\n    }\n    loadSmartDefaults()\n  }, [])\n\n  // Save preferences when generating\n  const savePreferences = () => {\n    try {\n      localStorage.setItem('coursedev-preferences', JSON.stringify({\n        recentSubject: config.subject,\n        recentTopics: config.topics,\n        preferredDifficulty: config.difficulty,\n        lastUsed: new Date().toISOString(),\n      }))\n    } catch (error) {\n      console.error('Failed to save preferences:', error)\n    }\n  }\n\n  const handleGenerate = async () => {\n    if (!config.subject || !config.topics) {\n      toast.error('Please fill in subject and topics')\n      return\n    }\n\n    // Phase 14: Validate source-specific requirements\n    if (sourceType === 'uploaded_documents' && selectedAssets.length === 0) {\n      toast.error('Please select materials', {\n        description: 'Click \"Browse & Select Materials\" to choose documents'\n      })\n      return\n    }\n\n    setIsGenerating(true)\n    savePreferences() // Save preferences for smart defaults\n\n    // Phase 14: Build context based on source type\n    let contextPrompt = ''\n\n    if (sourceType === 'lesson_transcript') {\n      contextPrompt = `Generate tasks based on today's classroom lesson about ${config.subject}. `\n      contextPrompt += `Focus on the key concepts covered: ${config.topics}. `\n\n      // Fetch actual transcript from memory\n      const transcript = MemoryService.getTranscript(roomId)\n      if (transcript.length > 0) {\n        const transcriptText = transcript.map((t: any) => `${t.speaker}: ${t.text}`).join('\\n')\n        contextPrompt += `\\nLATEST TRANSCRIPT:\\n${transcriptText}\\n`\n      } else {\n        contextPrompt += `\\n(No active transcript found for this session yet)\\n`\n      }\n\n      contextPrompt += `Use the lesson content as the primary source. `\n    } else if (sourceType === 'uploaded_documents') {\n      contextPrompt = `Generate tasks based on the following uploaded materials:\\n`\n\n      // Include selected asset content\n      selectedAssets.forEach(asset => {\n        contextPrompt += `\\n--- Document: ${asset.name} ---\\n`\n        contextPrompt += asset.content || asset.description || '(No text content available)'\n        contextPrompt += `\\n----------------\\n`\n      })\n\n      contextPrompt += `\\nSubject: ${config.subject}. Topics to cover: ${config.topics}. `\n      contextPrompt += `Use only the content from these documents. `\n    } else if (sourceType === 'all_sources') {\n      contextPrompt = `Generate comprehensive tasks for ${config.subject} covering ${config.topics}. `\n\n      // Combine Transcript\n      const transcript = MemoryService.getTranscript(roomId)\n      if (transcript.length > 0) {\n        const transcriptText = transcript.map((t: any) => `${t.speaker}: ${t.text}`).join('\\n')\n        contextPrompt += `\\nLATEST TRANSCRIPT:\\n${transcriptText}\\n`\n      }\n\n      // Combine Docs\n      if (selectedAssets.length > 0) {\n        contextPrompt += `\\nREFERENCE MATERIALS:\\n`\n        selectedAssets.forEach(asset => {\n          contextPrompt += `${asset.name}: ${asset.content || asset.description || 'No content'}\\n`\n        })\n      }\n\n      contextPrompt += `Use lesson content, provided materials, and your general knowledge. `\n    }\n\n    // Simulate generation with context\n    setTimeout(() => {\n      const mockTasks = Array.from({ length: config.count }, (_, i) => {\n        let type = config.questionType\n        if (type === 'mixed') {\n          type = i % 2 === 0 ? 'multiple_choice' : 'short_answer'\n        }\n\n        // Add source indicator to question for demo\n        const sourceIndicator = sourceType === 'lesson_transcript'\n          ? '[From Lesson]'\n          : sourceType === 'uploaded_documents'\n            ? '[From Docs]'\n            : '[All Sources]'\n\n        return {\n          id: `task-${Date.now()}-${i}`,\n          type: type === 'multiple_choice' ? 'multiple_choice' : 'short_answer',\n          question: `${sourceIndicator} Sample ${config.subject} question ${i + 1} (${type}) about ${config.topics.split(',')[0]?.trim() || 'topic'}`,\n          options: type === 'multiple_choice' ? ['Option A', 'Option B', 'Option C', 'Option D'] : undefined,\n          correctAnswer: type === 'multiple_choice' ? 'Option A' : undefined,\n          explanation: `This tests understanding of core concepts. ${contextPrompt.substring(0, 100)}...`,\n          difficulty: config.difficulty,\n        }\n      })\n      setGeneratedTasks(mockTasks)\n      setStep('review')\n      setIsGenerating(false)\n\n      // Enhanced success message showing source\n      const sourceLabel = sourceType === 'lesson_transcript'\n        ? 'lesson transcript'\n        : sourceType === 'uploaded_documents'\n          ? `${selectedAssets.length} document(s)`\n          : 'all sources'\n\n      toast.success(`Generated ${mockTasks.length} tasks from ${sourceLabel}`)\n    }, 1500)\n  }\n\n  // Quick Assign: Generate and assign in one click\n  const handleQuickAssign = async (target: 'all' | 'struggling') => {\n    if (!config.subject || !config.topics) {\n      toast.error('Please fill in subject and topics first')\n      return\n    }\n\n    setIsGenerating(true)\n    savePreferences()\n\n    // Simulate generation + assignment\n    setTimeout(() => {\n      const taskCount = config.count\n      const targetStudents = target === 'all' ? students : students.filter(s => s.status === 'struggling')\n\n      toast.success(\n        ` Generated ${taskCount} tasks and assigned to ${targetStudents.length} student${targetStudents.length !== 1 ? 's' : ''}!`,\n        {\n          description: target === 'struggling' ? 'Helping struggling students' : 'Assigned to all students',\n          duration: 4000,\n        }\n      )\n\n      setIsGenerating(false)\n    }, 1500)\n  }\n\n  // Load template\n  const loadTemplate = (template: typeof QUICK_TEMPLATES[0]) => {\n    setConfig(prev => ({\n      ...prev,\n      subject: template.subject,\n      topics: template.topics,\n      difficulty: template.difficulty as 'beginner' | 'intermediate' | 'advanced',\n      count: template.count,\n      distributionMode: 'personalized',\n    }))\n    toast.success(`Loaded template: ${template.name}`)\n  }\n\n  // Phase 2: Update task\n  const updateTask = (taskId: string, updates: Partial<any>) => {\n    setGeneratedTasks(prev => prev.map(task =>\n      task.id === taskId ? { ...task, ...updates } : task\n    ))\n  }\n\n  // Phase 2: Duplicate task\n  const duplicateTask = (taskId: string) => {\n    const task = generatedTasks.find(t => t.id === taskId)\n    if (task) {\n      const newTask = { ...task, id: `task-${Date.now()}` }\n      setGeneratedTasks(prev => [...prev, newTask])\n      toast.success('Task duplicated')\n    }\n  }\n\n  // Phase 2: Delete task\n  const deleteTask = (taskId: string) => {\n    setGeneratedTasks(prev => prev.filter(t => t.id !== taskId))\n    setSelectedTasks(prev => {\n      const next = new Set(prev)\n      next.delete(taskId)\n      return next\n    })\n    toast.success('Task deleted')\n  }\n\n  // Phase 2: Batch operations\n  const toggleSelectAll = () => {\n    if (selectedTasks.size === generatedTasks.length) {\n      setSelectedTasks(new Set())\n    } else {\n      setSelectedTasks(new Set(generatedTasks.map(t => t.id)))\n    }\n  }\n\n  const bulkDelete = () => {\n    setGeneratedTasks(prev => prev.filter(t => !selectedTasks.has(t.id)))\n    toast.success(`Deleted ${selectedTasks.size} tasks`)\n    setSelectedTasks(new Set())\n  }\n\n  const bulkSetDifficulty = (difficulty: string) => {\n    setGeneratedTasks(prev => prev.map(task =>\n      selectedTasks.has(task.id) ? { ...task, difficulty } : task\n    ))\n    toast.success(`Updated ${selectedTasks.size} tasks to ${difficulty}`)\n    setSelectedTasks(new Set())\n  }\n\n  // Phase 2: Generate sample preview\n  const generatePreview = () => {\n    if (!config.subject || !config.topics) return null\n    const topic = config.topics.split(',')[0]?.trim() || 'topic'\n    return `Solve for x: 2x + 5 = 13 (${topic})`\n  }\n\n  // Phase 3: Library helpers\n\n\n  // Phase 3: Save to library (Server Action)\n  const saveToLibrary = async (task: any) => {\n    startTransition(async () => {\n      try {\n        const newTask = await saveLibraryTask({\n          ...task,\n          subject: config.subject,\n          topics: config.topics.split(',').map(t => t.trim())\n        })\n\n        setLibrary(prev => ({\n          ...prev,\n          tasks: [...prev.tasks, newTask as any]\n        }))\n        toast.success('Task saved to library')\n      } catch (error) {\n        toast.error('Failed to save task')\n      }\n    })\n  }\n\n  // Phase 3: Add from library (Server Action)\n  const addFromLibrary = async (libraryTask: LibraryTask) => {\n    const newTask = {\n      ...libraryTask,\n      id: `task-${Date.now()}`,\n    }\n\n    setGeneratedTasks(prev => [...prev, newTask])\n\n    // Update usage stats on server\n    startTransition(async () => {\n      await incrementTaskUsage(libraryTask.id)\n\n      // Optimistic update\n      setLibrary(prev => ({\n        ...prev,\n        tasks: prev.tasks.map(t =>\n          t.id === libraryTask.id\n            ? { ...t, usedCount: t.usedCount + 1, lastUsed: new Date().toISOString() }\n            : t\n        )\n      }))\n    })\n\n    toast.success('Task added from library')\n  }\n\n  // Phase 3: Toggle favorite (Server Action)\n  const toggleFavorite = async (taskId: string) => {\n    // Optimistic update\n    setLibrary(prev => ({\n      ...prev,\n      tasks: prev.tasks.map(t =>\n        t.id === taskId ? { ...t, isFavorite: !t.isFavorite } : t\n      )\n    }))\n\n    startTransition(async () => {\n      try {\n        await toggleFavoriteTask(taskId)\n      } catch (error) {\n        // Revert on failure\n        setLibrary(prev => ({\n          ...prev,\n          tasks: prev.tasks.map(t =>\n            t.id === taskId ? { ...t, isFavorite: !t.isFavorite } : t\n          )\n        }))\n        toast.error('Failed to update favorite')\n      }\n    })\n  }\n\n  // Phase 3: Delete from library (Server Action)\n  const deleteFromLibrary = async (taskId: string) => {\n    // Optimistic update\n    const previousLibrary = library\n    setLibrary(prev => ({\n      ...prev,\n      tasks: prev.tasks.filter(t => t.id !== taskId)\n    }))\n\n    startTransition(async () => {\n      try {\n        await deleteLibraryTask(taskId)\n        toast.success('Task removed from library')\n      } catch (error) {\n        // Revert\n        setLibrary(previousLibrary)\n        toast.error('Failed to delete task')\n      }\n    })\n  }\n\n  // Phase 3: Get filtered library tasks\n  const getFilteredLibraryTasks = () => {\n    let tasks = library.tasks\n\n    if (showFavoritesOnly) {\n      tasks = tasks.filter(t => t.isFavorite)\n    }\n\n    if (searchQuery) {\n      const query = searchQuery.toLowerCase()\n      tasks = tasks.filter(t =>\n        t.question.toLowerCase().includes(query) ||\n        t.subject.toLowerCase().includes(query) ||\n        t.topics.some(topic => topic.toLowerCase().includes(query))\n      )\n    }\n\n    // Sort by favorites first, then by usage\n    return tasks.sort((a, b) => {\n      if (a.isFavorite !== b.isFavorite) {\n        return a.isFavorite ? -1 : 1\n      }\n      return b.usedCount - a.usedCount\n    })\n  }\n\n\n\n  // Phase 4: Auto-detect difficulty\n  const autoDetectDifficulty = () => {\n    const total = students.length\n    if (total === 0) return\n\n    const struggling = students.filter(s => s.status === 'struggling').length\n    const onTrack = students.filter(s => s.status === 'on_track').length\n\n    let suggestedDifficulty = 'intermediate'\n    let reasoning = ''\n\n    if (struggling / total > 0.3) {\n      suggestedDifficulty = 'beginner'\n      reasoning = `Detected ${Math.round((struggling / total) * 100)}% struggling students. Suggesting Beginner difficulty.`\n    } else if (onTrack / total > 0.6) {\n      suggestedDifficulty = 'advanced'\n      reasoning = `Detected ${Math.round((onTrack / total) * 100)}% on-track students. Suggesting Advanced difficulty.`\n    } else {\n      suggestedDifficulty = 'intermediate'\n      reasoning = 'Class performance is balanced. Suggesting Intermediate difficulty.'\n    }\n\n    setConfig(prev => ({ ...prev, difficulty: suggestedDifficulty }))\n    toast.success('Difficulty Adjusted', { description: reasoning })\n  }\n\n  // Phase 5: Import & Digitization Logic\n  const handleFileUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0]\n    if (!file) return\n\n    if (file.size > 5 * 1024 * 1024) {\n      toast.error('File too large', { description: 'Please upload a file smaller than 5MB' })\n      return\n    }\n\n    setImportFile(file)\n    simulateOCR(file)\n  }\n\n  const simulateOCR = async (file: File) => {\n    setIsAnalyzing(true)\n    setAnalysisProgress(0)\n\n    // Simulate progress\n    const interval = setInterval(() => {\n      setAnalysisProgress(prev => {\n        if (prev >= 90) {\n          clearInterval(interval)\n          return 90\n        }\n        return prev + 10\n      })\n    }, 200)\n\n    // Simulate analysis time (2s)\n    await new Promise(resolve => setTimeout(resolve, 2000))\n    clearInterval(interval)\n    setAnalysisProgress(100)\n\n    // Mock results based on filename\n    const mockTasks = [\n      {\n        id: `imported-${Date.now()}-1`,\n        question: \"What is the primary function of the mitochondria?\",\n        type: \"multiple_choice\",\n        options: [\"Energy production\", \"Protein synthesis\", \"Waste disposal\", \"Cell division\"],\n        correctAnswer: \"Energy production\",\n        subject: \"Biology\",\n        topics: [\"Cell Biology\"],\n        difficulty: \"intermediate\"\n      },\n      {\n        id: `imported-${Date.now()}-2`,\n        question: \"Describe the process of osmosis.\",\n        type: \"short_answer\",\n        subject: \"Biology\",\n        topics: [\"Cell Biology\"],\n        difficulty: \"intermediate\"\n      },\n      {\n        id: `imported-${Date.now()}-3`,\n        question: \"Which organelle is known as the 'brain' of the cell?\",\n        type: \"multiple_choice\",\n        options: [\"Nucleus\", \"Ribosome\", \"Golgi apparatus\", \"Endoplasmic reticulum\"],\n        correctAnswer: \"Nucleus\",\n        subject: \"Biology\",\n        topics: [\"Cell Biology\"],\n        difficulty: \"beginner\"\n      }\n    ]\n\n    setImportedTasks(mockTasks)\n    setIsAnalyzing(false)\n    toast.success('Analysis Complete', { description: `Extracted ${mockTasks.length} questions from ${file.name}` })\n  }\n\n  const importExtractedTasks = () => {\n    setGeneratedTasks(prev => [...prev, ...importedTasks])\n    setShowImport(false)\n    setImportedTasks([])\n    setImportFile(null)\n    setStep('review')\n    toast.success('Import Successful', { description: `Added ${importedTasks.length} tasks to your set` })\n  }\n\n  const getStatusCounts = () => ({\n    total: students.length,\n    onTrack: students.filter(s => s.status === 'on_track').length,\n    needHelp: students.filter(s => s.status === 'needs_help').length,\n    struggling: students.filter(s => s.status === 'struggling').length,\n  })\n\n  const counts = getStatusCounts()\n\n  // Phase 14: Handle Assets Selection\n  const handleAssetsSelect = (assets: any[]) => {\n    setSelectedAssets(assets)\n    setShowAssetsPanel(false)\n    toast.success(`Selected ${assets.length} material(s)`, {\n      description: 'Assets ready for AI task generation'\n    })\n  }\n\n  return (\n    <div className=\"h-full flex flex-col bg-gray-900 text-white\">\n      {/* Progress Steps */}\n      <div className=\"px-6 py-4 border-b border-gray-700 bg-gray-800\">\n        <div className=\"flex items-center gap-2\">\n          <button\n            onClick={() => setStep('generate')}\n            className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${step === 'generate' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:text-white'\n              }`}\n          >\n            <div className={`w-6 h-6 rounded-full flex items-center justify-center text-sm ${step === 'generate' ? 'bg-white text-blue-600' : 'bg-gray-700'\n              }`}>1</div>\n            <span className=\"font-medium\">Configure</span>\n          </button>\n          <div className=\"w-8 h-px bg-gray-700\" />\n          <button\n            onClick={() => generatedTasks.length > 0 && setStep('review')}\n            className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${step === 'review' ? 'bg-blue-600 text-white' : generatedTasks.length > 0 ? 'text-gray-400 hover:text-white' : 'text-gray-600 cursor-not-allowed'\n              }`}\n          >\n            <div className={`w-6 h-6 rounded-full flex items-center justify-center text-sm ${step === 'review' ? 'bg-white text-blue-600' : generatedTasks.length > 0 ? 'bg-gray-700' : 'bg-gray-800'\n              }`}>2</div>\n            <span className=\"font-medium\">Review</span>\n            {generatedTasks.length > 0 && (\n              <Badge className=\"bg-blue-500\">{generatedTasks.length}</Badge>\n            )}\n          </button>\n          <div className=\"w-8 h-px bg-gray-700\" />\n          <button\n            onClick={() => generatedTasks.length > 0 && setStep('assign')}\n            className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${step === 'assign' ? 'bg-blue-600 text-white' : generatedTasks.length > 0 ? 'text-gray-400 hover:text-white' : 'text-gray-600 cursor-not-allowed'\n              }`}\n          >\n            <div className={`w-6 h-6 rounded-full flex items-center justify-center text-sm ${step === 'assign' ? 'bg-white text-blue-600' : generatedTasks.length > 0 ? 'bg-gray-700' : 'bg-gray-800'\n              }`}>3</div>\n            <span className=\"font-medium\">Assign</span>\n          </button>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"flex-1 overflow-hidden\">\n        {step === 'generate' && (\n          <div className=\"h-full flex\">\n            {/* Configuration Form */}\n            <div className=\"flex-1 p-6 overflow-auto\">\n              <div className=\"max-w-3xl mx-auto space-y-6\">\n                <div>\n                  <h2 className=\"text-2xl font-bold mb-2\">Task Configuration</h2>\n                  <p className=\"text-gray-400\">Configure AI to generate personalized learning tasks</p>\n                </div>\n\n                {/* Quick Start Templates */}\n                <Card className=\"bg-gradient-to-br from-blue-900/30 to-purple-900/30 border-blue-700\">\n                  <CardHeader>\n                    <CardTitle className=\"text-white text-base flex items-center gap-2\">\n                      <Sparkles className=\"h-5 w-5 text-yellow-400\" />\n                      Quick Start Templates\n                    </CardTitle>\n                    <CardDescription className=\"text-gray-300\">\n                      Load pre-configured templates to get started instantly\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"grid grid-cols-2 gap-3\">\n                      {QUICK_TEMPLATES.map((template) => (\n                        <button\n                          key={template.id}\n                          onClick={() => loadTemplate(template)}\n                          className=\"p-4 rounded-lg border-2 border-gray-600 bg-gray-800 hover:border-blue-500 hover:bg-gray-700 transition-all text-left group\"\n                        >\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <span className=\"text-2xl\">{template.icon}</span>\n                            <div className=\"flex-1\">\n                              <div className=\"font-semibold text-sm group-hover:text-blue-400 transition-colors\">\n                                {template.name}\n                              </div>\n                              <div className=\"text-xs text-gray-400\">\n                                {template.count} tasks  {template.difficulty}\n                              </div>\n                            </div>\n                          </div>\n                        </button>\n                      ))}\n\n                      {/* Phase 14: Browse Assets Card */}\n                      <button\n                        onClick={() => setShowAssetsPanel(true)}\n                        className=\"p-4 rounded-lg border-2 border-dashed border-gray-600 bg-gray-800/50 hover:border-purple-500 hover:bg-gray-800 transition-all text-left group flex flex-col justify-center items-center gap-2\"\n                      >\n                        <div className=\"w-12 h-12 rounded-full bg-purple-900/30 flex items-center justify-center group-hover:scale-110 transition-transform\">\n                          <Library className=\"h-6 w-6 text-purple-400\" />\n                        </div>\n                        <div className=\"text-center\">\n                          <div className=\"font-semibold text-sm group-hover:text-purple-400 transition-colors\">\n                            Browse & Select Materials\n                          </div>\n                          <div className=\"text-xs text-gray-400\">\n                            From Assets Panel\n                          </div>\n                        </div>\n                      </button>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Divider */}\n                <div className=\"relative\">\n                  <div className=\"absolute inset-0 flex items-center\">\n                    <div className=\"w-full border-t border-gray-700\"></div>\n                  </div>\n                  <div className=\"relative flex justify-center text-sm\">\n                    <span className=\"px-4 bg-gray-900 text-gray-400\">OR BUILD CUSTOM</span>\n                  </div>\n                </div>\n\n                {/* Phase 14: AI Source Selection */}\n                <Card className=\"bg-gradient-to-br from-purple-900/20 to-blue-900/20 border-purple-700/50\">\n                  <CardHeader>\n                    <CardTitle className=\"text-white text-base flex items-center gap-2\">\n                      <Target className=\"h-5 w-5 text-purple-400\" />\n                      AI Source Selection\n                    </CardTitle>\n                    <CardDescription className=\"text-gray-300\">\n                      Choose where AI should generate tasks from\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"space-y-3\">\n                      {/* Lesson Transcript Option */}\n                      <button\n                        onClick={() => setSourceType('lesson_transcript')}\n                        className={`w-full p-4 rounded-lg border-2 transition-all text-left ${sourceType === 'lesson_transcript'\n                          ? 'border-purple-500 bg-purple-900/30'\n                          : 'border-gray-600 bg-gray-800 hover:border-gray-500'\n                          }`}\n                      >\n                        <div className=\"flex items-center gap-3\">\n                          <div className={`w-5 h-5 rounded-full border-2 flex items-center justify-center ${sourceType === 'lesson_transcript'\n                            ? 'border-purple-500'\n                            : 'border-gray-500'\n                            }`}>\n                            {sourceType === 'lesson_transcript' && (\n                              <div className=\"w-3 h-3 rounded-full bg-purple-500\"></div>\n                            )}\n                          </div>\n                          <div className=\"flex-1\">\n                            <div className=\"font-semibold text-white\">Lesson Transcript</div>\n                            <div className=\"text-sm text-gray-400\">Generate from today's classroom session</div>\n                          </div>\n                        </div>\n                      </button>\n\n                      {/* Uploaded Documents Option */}\n                      <button\n                        onClick={() => setSourceType('uploaded_documents')}\n                        className={`w-full p-4 rounded-lg border-2 transition-all text-left ${sourceType === 'uploaded_documents'\n                          ? 'border-purple-500 bg-purple-900/30'\n                          : 'border-gray-600 bg-gray-800 hover:border-gray-500'\n                          }`}\n                      >\n                        <div className=\"flex items-center gap-3\">\n                          <div className={`w-5 h-5 rounded-full border-2 flex items-center justify-center ${sourceType === 'uploaded_documents'\n                            ? 'border-purple-500'\n                            : 'border-gray-500'\n                            }`}>\n                            {sourceType === 'uploaded_documents' && (\n                              <div className=\"w-3 h-3 rounded-full bg-purple-500\"></div>\n                            )}\n                          </div>\n                          <div className=\"flex-1\">\n                            <div className=\"font-semibold text-white\">Uploaded Documents</div>\n                            <div className=\"text-sm text-gray-400\">\n                              Generate from selected materials\n                              {selectedAssets.length > 0 && ` (${selectedAssets.length} selected)`}\n                            </div>\n                          </div>\n                        </div>\n                      </button>\n\n                      {/* All Sources Option */}\n                      <button\n                        onClick={() => setSourceType('all_sources')}\n                        className={`w-full p-4 rounded-lg border-2 transition-all text-left ${sourceType === 'all_sources'\n                          ? 'border-purple-500 bg-purple-900/30'\n                          : 'border-gray-600 bg-gray-800 hover:border-gray-500'\n                          }`}\n                      >\n                        <div className=\"flex items-center gap-3\">\n                          <div className={`w-5 h-5 rounded-full border-2 flex items-center justify-center ${sourceType === 'all_sources'\n                            ? 'border-purple-500'\n                            : 'border-gray-500'\n                            }`}>\n                            {sourceType === 'all_sources' && (\n                              <div className=\"w-3 h-3 rounded-full bg-purple-500\"></div>\n                            )}\n                          </div>\n                          <div className=\"flex-1\">\n                            <div className=\"font-semibold text-white\">All Sources</div>\n                            <div className=\"text-sm text-gray-400\">Lesson + Documents + General Knowledge</div>\n                          </div>\n                        </div>\n                      </button>\n                    </div>\n\n                    {/* Selected Materials Display */}\n                    {selectedAssets.length > 0 && (\n                      <div className=\"mt-4 p-3 bg-gray-800/50 rounded-lg border border-gray-700\">\n                        <div className=\"flex items-center gap-2 mb-2\">\n                          <FileText className=\"h-4 w-4 text-purple-400\" />\n                          <span className=\"text-sm font-medium text-gray-300\">Selected Materials:</span>\n                        </div>\n                        <div className=\"flex flex-wrap gap-2\">\n                          {selectedAssets.map((asset, idx) => (\n                            <Badge key={idx} variant=\"outline\" className=\"bg-purple-900/30 text-purple-300 border-purple-700\">\n                              {asset.name || `Asset ${idx + 1}`}\n                            </Badge>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n\n                <div className=\"grid grid-cols-2 gap-6\">\n                  <Card className=\"bg-gray-800 border-gray-700\">\n                    <CardHeader>\n                      <CardTitle className=\"text-white text-base flex items-center gap-2\">\n                        <BookOpen className=\"h-4 w-4 text-blue-400\" />\n                        Subject & Topics\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent className=\"space-y-4\">\n                      <div className=\"space-y-2\">\n                        <Label className=\"text-gray-300\">Subject</Label>\n                        <Input\n                          placeholder=\"e.g., Mathematics\"\n                          value={config.subject}\n                          onChange={(e) => setConfig({ ...config, subject: e.target.value })}\n                          className=\"bg-gray-700 border-gray-600 text-white\"\n                        />\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label className=\"text-gray-300\">Topics</Label>\n                        <Textarea\n                          placeholder=\"e.g., Algebra, Linear Equations, Quadratic Functions\"\n                          value={config.topics}\n                          onChange={(e) => setConfig({ ...config, topics: e.target.value })}\n                          className=\"bg-gray-700 border-gray-600 text-white min-h-[100px]\"\n                        />\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  <Card className=\"bg-gray-800 border-gray-700\">\n                    <CardHeader>\n                      <CardTitle className=\"text-white text-base flex items-center gap-2\">\n                        <BarChart3 className=\"h-4 w-4 text-green-400\" />\n                        Settings\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent className=\"space-y-4\">\n                      <div className=\"space-y-2\">\n                        <div className=\"flex items-center justify-between\">\n                          <Label className=\"text-gray-300\">Difficulty</Label>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={autoDetectDifficulty}\n                            className=\"h-6 text-xs text-blue-400 hover:text-blue-300 px-2\"\n                          >\n                            <Sparkles className=\"h-3 w-3 mr-1\" />\n                            Auto-detect\n                          </Button>\n                        </div>\n                        <Select\n                          value={config.difficulty}\n                          onValueChange={(v) => setConfig({ ...config, difficulty: v })}\n                        >\n                          <SelectTrigger className=\"bg-gray-700 border-gray-600 text-white\">\n                            <SelectValue />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"beginner\">Beginner</SelectItem>\n                            <SelectItem value=\"intermediate\">Intermediate</SelectItem>\n                            <SelectItem value=\"advanced\">Advanced</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label className=\"text-gray-300\">Distribution Mode</Label>\n                        <div className=\"grid grid-cols-1 gap-2\">\n                          {[\n                            { key: 'uniform', label: 'Same for all students' },\n                            { key: 'personalized', label: 'Personalized to each student' },\n                            { key: 'clustered', label: 'By performance cluster' },\n                          ].map(({ key, label }) => (\n                            <button\n                              key={key}\n                              onClick={() => setConfig({ ...config, distributionMode: key as any })}\n                              className={`p-3 rounded-lg border text-left transition-colors ${config.distributionMode === key\n                                ? 'border-blue-500 bg-blue-500/20'\n                                : 'border-gray-600 bg-gray-700 hover:bg-gray-600'\n                                }`}\n                            >\n                              <div className=\"flex items-center gap-2\">\n                                {config.distributionMode === key && (\n                                  <CheckCircle className=\"h-4 w-4 text-blue-400\" />\n                                )}\n                                <span className=\"text-sm\">{label}</span>\n                              </div>\n                            </button>\n                          ))}\n                        </div>\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label className=\"text-gray-300\">Number of Tasks: {config.count}</Label>\n                        <input\n                          type=\"range\"\n                          min={1}\n                          max={20}\n                          value={config.count}\n                          onChange={(e) => setConfig({ ...config, count: parseInt(e.target.value) })}\n                          className=\"w-full\"\n                        />\n                      </div>\n                    </CardContent>\n                  </Card>\n                </div>\n\n                {/* Phase 2: Live Preview */}\n                {(config.subject || config.topics) && (\n                  <Card className=\"bg-gray-800 border-blue-600 border-2\">\n                    <CardHeader>\n                      <CardTitle className=\"text-white text-sm flex items-center gap-2\">\n                        <Eye className=\"h-4 w-4 text-blue-400\" />\n                        Live Preview\n                      </CardTitle>\n                      <CardDescription className=\"text-gray-400 text-xs\">\n                        Sample question based on your configuration\n                      </CardDescription>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"bg-gray-700 p-4 rounded-lg\">\n                        <p className=\"text-sm text-gray-300 mb-3\">\n                          {generatePreview()}\n                        </p>\n                        <div className=\"space-y-1.5\">\n                          <div className=\"text-xs px-3 py-2 rounded bg-gray-600 text-gray-300\">A. x = 3</div>\n                          <div className=\"text-xs px-3 py-2 rounded bg-green-900/50 border border-green-700 text-green-300\">B. x = 4 </div>\n                          <div className=\"text-xs px-3 py-2 rounded bg-gray-600 text-gray-300\">C. x = 8</div>\n                          <div className=\"text-xs px-3 py-2 rounded bg-gray-600 text-gray-300\">D. x = 9</div>\n                        </div>\n                        <p className=\"text-xs text-gray-500 mt-3\">\n                           This is a sample. Actual questions will vary.\n                        </p>\n                      </div>\n                    </CardContent>\n                  </Card>\n                )}\n\n                <Button\n                  onClick={handleGenerate}\n                  disabled={isGenerating || !config.subject || !config.topics}\n                  className=\"w-full h-12 text-lg bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700\"\n                >\n                  {isGenerating ? (\n                    <>\n                      <Loader2 className=\"h-5 w-5 mr-2 animate-spin\" />\n                      Generating Tasks...\n                    </>\n                  ) : (\n                    <>\n                      <Sparkles className=\"h-5 w-5 mr-2\" />\n                      Generate {config.count} Tasks\n                    </>\n                  )}\n                </Button>\n\n                {/* Quick Assign Shortcuts - Phase 1 Feature */}\n                <div className=\"space-y-2\">\n                  <div className=\"grid grid-cols-2 gap-3\">\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => handleQuickAssign('all')}\n                      disabled={isGenerating || !config.subject || !config.topics}\n                      className=\"h-10 border-blue-600 text-blue-400 hover:bg-blue-600/20\"\n                    >\n                      <Zap className=\"h-4 w-4 mr-2\" />\n                      Quick Assign to All\n                    </Button>\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => handleQuickAssign('struggling')}\n                      disabled={isGenerating || !config.subject || !config.topics || counts.struggling === 0}\n                      className=\"h-10 border-red-600 text-red-400 hover:bg-red-600/20\"\n                    >\n                      <Heart className=\"h-4 w-4 mr-2\" />\n                      Help Struggling {counts.struggling > 0 && `(${counts.struggling})`}\n                    </Button>\n                  </div>\n                  <p className=\"text-xs text-center text-gray-500\">\n                     Quick Assign skips review and assigns tasks immediately\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            {/* Student Summary Sidebar */}\n            <div className=\"w-72 border-l border-gray-700 bg-gray-800 p-6\">\n              <h3 className=\"font-semibold mb-4 flex items-center gap-2\">\n                <Users className=\"h-4 w-4\" />\n                Students ({counts.total})\n              </h3>\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between p-3 bg-green-900/30 rounded-lg\">\n                  <span className=\"text-green-400\">On Track</span>\n                  <span className=\"font-bold text-green-400\">{counts.onTrack}</span>\n                </div>\n                <div className=\"flex items-center justify-between p-3 bg-yellow-900/30 rounded-lg\">\n                  <span className=\"text-yellow-400\">Need Help</span>\n                  <span className=\"font-bold text-yellow-400\">{counts.needHelp}</span>\n                </div>\n                <div className=\"flex items-center justify-between p-3 bg-red-900/30 rounded-lg\">\n                  <span className=\"text-red-400\">Struggling</span>\n                  <span className=\"font-bold text-red-400\">{counts.struggling}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {step === 'review' && (\n          <div className=\"h-full flex flex-col\">\n            {/* Toolbar */}\n            <div className=\"px-6 py-3 border-b border-gray-700 bg-gray-800 flex items-center justify-between\">\n              <div className=\"flex items-center gap-4\">\n                {/* Phase 2: Batch Selection */}\n                <div className=\"flex items-center gap-2\">\n                  <button\n                    onClick={toggleSelectAll}\n                    className=\"p-1 hover:bg-gray-700 rounded\"\n                  >\n                    {selectedTasks.size === generatedTasks.length ? (\n                      <CheckSquare className=\"h-4 w-4 text-blue-400\" />\n                    ) : (\n                      <Square className=\"h-4 w-4 text-gray-400\" />\n                    )}\n                  </button>\n                  <h3 className=\"font-semibold\">\n                    {selectedTasks.size > 0 ? (\n                      <span>{selectedTasks.size} of {generatedTasks.length} Selected</span>\n                    ) : (\n                      <span>{generatedTasks.length} Tasks Generated</span>\n                    )}\n                  </h3>\n                </div>\n\n                {/* Phase 2: Bulk Actions */}\n                {selectedTasks.size > 0 && (\n                  <div className=\"flex items-center gap-2\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={bulkDelete}\n                      className=\"h-8 border-red-600 text-red-400\"\n                    >\n                      <Trash2 className=\"h-3 w-3 mr-1\" />\n                      Delete\n                    </Button>\n                    <Select onValueChange={bulkSetDifficulty}>\n                      <SelectTrigger className=\"h-8 w-32 bg-gray-700\">\n                        <SelectValue placeholder=\"Difficulty\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"beginner\">Set Easy</SelectItem>\n                        <SelectItem value=\"intermediate\">Set Medium</SelectItem>\n                        <SelectItem value=\"advanced\">Set Hard</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                )}\n\n                {/* Phase 3: Library Button */}\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => setShowLibrary(true)}\n                  className=\"h-8 border-blue-500 text-blue-400 bg-blue-500/10 hover:bg-blue-500/20\"\n                >\n                  <Library className=\"h-4 w-4 mr-2\" />\n                  Library\n                </Button>\n\n                <div className=\"flex items-center gap-2 bg-gray-700 rounded-lg p-1\">\n                  <button\n                    onClick={() => setViewMode('grid')}\n                    className={`p-1.5 rounded ${viewMode === 'grid' ? 'bg-gray-600' : ''}`}\n                  >\n                    <LayoutGrid className=\"h-4 w-4\" />\n                  </button>\n                  <button\n                    onClick={() => setViewMode('list')}\n                    className={`p-1.5 rounded ${viewMode === 'list' ? 'bg-gray-600' : ''}`}\n                  >\n                    <List className=\"h-4 w-4\" />\n                  </button>\n                </div>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Button variant=\"outline\" onClick={() => setStep('generate')}>\n                  Back\n                </Button>\n                <Button onClick={() => setStep('assign')}>\n                  Continue to Assign\n                  <Send className=\"h-4 w-4 ml-2\" />\n                </Button>\n              </div>\n            </div>\n\n            {/* Tasks Grid */}\n            <ScrollArea className=\"flex-1 p-6\">\n              <div className={viewMode === 'grid'\n                ? \"grid grid-cols-2 lg:grid-cols-3 gap-4\"\n                : \"space-y-3\"\n              }>\n                {generatedTasks.map((task, index) => (\n                  <Card key={task.id} className=\"bg-gray-800 border-gray-700\">\n                    <CardHeader className=\"pb-3\">\n                      <div className=\"flex items-start justify-between\">\n                        {/* Phase 2: Checkbox */}\n                        <button\n                          onClick={() => {\n                            const next = new Set(selectedTasks)\n                            if (next.has(task.id)) {\n                              next.delete(task.id)\n                            } else {\n                              next.add(task.id)\n                            }\n                            setSelectedTasks(next)\n                          }}\n                          className=\"mr-3 mt-1\"\n                        >\n                          {selectedTasks.has(task.id) ? (\n                            <CheckSquare className=\"h-5 w-5 text-blue-400\" />\n                          ) : (\n                            <Square className=\"h-5 w-5 text-gray-500\" />\n                          )}\n                        </button>\n                        <div className=\"flex-1\">\n                          <Badge className=\"mb-2\" variant={task.type === 'multiple_choice' ? 'default' : 'secondary'}>\n                            {task.type === 'multiple_choice' ? 'Multiple Choice' : 'Short Answer'}\n                          </Badge>\n                          <CardTitle className=\"text-white text-sm\">\n                            Task {index + 1}\n                          </CardTitle>\n                        </div>\n                        <div className=\"flex gap-1 shrink-0\">\n                          {/* Phase 3: Save Button */}\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"h-8 w-8 text-yellow-500 hover:text-yellow-400 hover:bg-yellow-500/10\"\n                            onClick={() => saveToLibrary(task)}\n                            title=\"Save to Library\"\n                          >\n                            <Star className=\"h-4 w-4\" />\n                          </Button>\n                          {/* Phase 2: Duplicate Button */}\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"h-8 w-8\"\n                            onClick={() => duplicateTask(task.id)}\n                            title=\"Duplicate\"\n                          >\n                            <Copy className=\"h-4 w-4\" />\n                          </Button>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            className=\"h-8 w-8 text-red-400\"\n                            onClick={() => deleteTask(task.id)}\n                            title=\"Delete\"\n                          >\n                            <Trash2 className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </CardHeader>\n                    <CardContent className=\"space-y-3\">\n                      {/* Phase 2: Editable Question */}\n                      {editingTaskId === task.id ? (\n                        <Input\n                          value={task.question}\n                          onChange={(e) => updateTask(task.id, { question: e.target.value })}\n                          onBlur={() => setEditingTaskId(null)}\n                          autoFocus\n                          className=\"bg-gray-700 border-blue-600 text-white\"\n                        />\n                      ) : (\n                        <p\n                          className=\"text-sm text-gray-300 cursor-pointer hover:text-blue-400 transition-colors\"\n                          onClick={() => setEditingTaskId(task.id)}\n                          title=\"Click to edit\"\n                        >\n                          {task.question}\n                        </p>\n                      )}\n                      {task.options && (\n                        <div className=\"space-y-1\">\n                          {task.options.map((opt: string, i: number) => (\n                            <div\n                              key={i}\n                              className={`text-sm px-3 py-1.5 rounded ${opt === task.correctAnswer\n                                ? 'bg-green-900/50 text-green-300 border border-green-700'\n                                : 'bg-gray-700 text-gray-400'\n                                }`}\n                            >\n                              {String.fromCharCode(65 + i)}. {opt}\n                            </div>\n                          ))}\n                        </div>\n                      )}\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            </ScrollArea>\n          </div>\n        )}\n\n        {step === 'assign' && (\n          <div className=\"h-full flex\">\n            {/* Assignment Options */}\n            <div className=\"flex-1 p-6 overflow-auto\">\n              <div className=\"max-w-3xl mx-auto space-y-6\">\n                <div>\n                  <h2 className=\"text-2xl font-bold mb-2\">Assign Tasks</h2>\n                  <p className=\"text-gray-400\">Choose how students will receive this content</p>\n                </div>\n\n                {/* Phase 6: Assignment Mode Toggle */}\n                <Tabs value={assignmentMode} onValueChange={(v) => setAssignmentMode(v as any)} className=\"w-full\">\n                  <TabsList className=\"grid w-full grid-cols-2 bg-gray-800\">\n                    <TabsTrigger value=\"practice\">Practice Assignment</TabsTrigger>\n                    <TabsTrigger value=\"exam\">Formal Assessment (Exam)</TabsTrigger>\n                  </TabsList>\n\n                  <TabsContent value=\"practice\" className=\"mt-6 space-y-6\">\n                    <div className=\"grid gap-4\">\n                      <Card className=\"bg-gray-800 border-gray-700 hover:border-blue-500 transition-colors cursor-pointer\">\n                        <CardContent className=\"p-6\">\n                          <div className=\"flex items-center justify-between\">\n                            <div className=\"flex items-center gap-4\">\n                              <div className=\"w-12 h-12 rounded-full bg-blue-600 flex items-center justify-center\">\n                                <GraduationCap className=\"h-6 w-6\" />\n                              </div>\n                              <div>\n                                <h3 className=\"font-semibold text-lg\">All Students</h3>\n                                <p className=\"text-gray-400\">Assign to everyone in the session</p>\n                              </div>\n                            </div>\n                            <div className=\"text-right\">\n                              <p className=\"text-2xl font-bold\">{counts.total}</p>\n                              <p className=\"text-sm text-gray-400\">students</p>\n                            </div>\n                          </div>\n                        </CardContent>\n                      </Card>\n\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <Card className=\"bg-gray-800 border-gray-700 hover:border-green-500 transition-colors cursor-pointer\">\n                          <CardContent className=\"p-6\">\n                            <div className=\"flex items-center gap-3\">\n                              <div className=\"w-10 h-10 rounded-full bg-green-600 flex items-center justify-center\">\n                                <CheckCircle className=\"h-5 w-5\" />\n                              </div>\n                              <div>\n                                <h3 className=\"font-semibold\">On Track</h3>\n                                <p className=\"text-sm text-gray-400\">{counts.onTrack} students</p>\n                              </div>\n                            </div>\n                          </CardContent>\n                        </Card>\n\n                        <Card className=\"bg-gray-800 border-gray-700 hover:border-yellow-500 transition-colors cursor-pointer\">\n                          <CardContent className=\"p-6\">\n                            <div className=\"flex items-center gap-3\">\n                              <div className=\"w-10 h-10 rounded-full bg-yellow-600 flex items-center justify-center\">\n                                <Clock className=\"h-5 w-5\" />\n                              </div>\n                              <div>\n                                <h3 className=\"font-semibold\">Need Help</h3>\n                                <p className=\"text-sm text-gray-400\">{counts.needHelp} students</p>\n                              </div>\n                            </div>\n                          </CardContent>\n                        </Card>\n                      </div>\n\n                      <Card className=\"bg-gray-800 border-gray-700 hover:border-red-500 transition-colors cursor-pointer\">\n                        <CardContent className=\"p-6\">\n                          <div className=\"flex items-center gap-3\">\n                            <div className=\"w-10 h-10 rounded-full bg-red-600 flex items-center justify-center\">\n                              <FileQuestion className=\"h-5 w-5\" />\n                            </div>\n                            <div>\n                              <h3 className=\"font-semibold\">Struggling Students</h3>\n                              <p className=\"text-sm text-gray-400\">{counts.struggling} students need extra support</p>\n                            </div>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    </div>\n                  </TabsContent>\n\n                  <TabsContent value=\"exam\" className=\"mt-6 space-y-6\">\n                    <Card className=\"bg-gray-800 border-gray-700\">\n                      <CardHeader>\n                        <CardTitle className=\"flex items-center gap-2\">\n                          <Target className=\"h-5 w-5 text-red-500\" />\n                          Exam Configuration\n                        </CardTitle>\n                        <CardDescription>Configure settings for this formal assessment</CardDescription>\n                      </CardHeader>\n                      <CardContent className=\"space-y-4\">\n                        <div className=\"space-y-2\">\n                          <Label>Assessment Title</Label>\n                          <Input\n                            placeholder=\"e.g., Unit 4 Mid-Term Exam\"\n                            value={examConfig.title}\n                            onChange={(e) => setExamConfig({ ...examConfig, title: e.target.value })}\n                            className=\"bg-gray-900 border-gray-600\"\n                          />\n                        </div>\n                        <div className=\"grid grid-cols-2 gap-4\">\n                          <div className=\"space-y-2\">\n                            <Label>Time Limit (minutes)</Label>\n                            <Input\n                              type=\"number\"\n                              value={examConfig.timeLimit}\n                              onChange={(e) => setExamConfig({ ...examConfig, timeLimit: parseInt(e.target.value) })}\n                              className=\"bg-gray-900 border-gray-600\"\n                            />\n                          </div>\n                          <div className=\"space-y-2\">\n                            <Label>Passing Score (%)</Label>\n                            <div className=\"flex items-center gap-4\">\n                              <input\n                                type=\"range\"\n                                min=\"50\"\n                                max=\"100\"\n                                step=\"5\"\n                                value={examConfig.passingScore}\n                                onChange={(e) => setExamConfig({ ...examConfig, passingScore: parseInt(e.target.value) })}\n                                className=\"flex-1\"\n                              />\n                              <span className=\"font-bold w-12 text-right\">{examConfig.passingScore}%</span>\n                            </div>\n                          </div>\n                        </div>\n                        <div className=\"flex items-center gap-2 pt-2\">\n                          <input\n                            type=\"checkbox\"\n                            checked={examConfig.shuffle}\n                            onChange={(e) => setExamConfig({ ...examConfig, shuffle: e.target.checked })}\n                            id=\"shuffle\"\n                            className=\"w-4 h-4 rounded border-gray-600 bg-gray-900 text-blue-600 focus:ring-blue-500\"\n                          />\n                          <Label htmlFor=\"shuffle\" className=\"cursor-pointer\">Randomize question order for each student</Label>\n                        </div>\n                      </CardContent>\n                    </Card>\n\n                    <div className=\"bg-blue-900/20 border border-blue-800 rounded-lg p-4 flex gap-3\">\n                      <div className=\"p-2 bg-blue-900/50 rounded h-fit\">\n                        <Target className=\"h-5 w-5 text-blue-400\" />\n                      </div>\n                      <div>\n                        <h4 className=\"font-medium text-blue-300\">Exam Mode Active</h4>\n                        <p className=\"text-sm text-blue-200/70 mt-1\">\n                          Students will see a timer and receive a grade upon completion.\n                          Answers will be hidden until the exam is closed.\n                        </p>\n                      </div>\n                    </div>\n                  </TabsContent>\n                </Tabs>\n\n                <div className=\"flex gap-3\">\n                  <Button variant=\"outline\" className=\"flex-1\" onClick={() => setStep('review')}>\n                    Back\n                  </Button>\n                  <Button\n                    className={`flex-1 ${assignmentMode === 'exam' ? 'bg-red-600 hover:bg-red-700' : 'bg-blue-600 hover:bg-blue-700'}`}\n                    onClick={() => {\n                      if (assignmentMode === 'exam' && !examConfig.title) {\n                        toast.error('Missing Title', { description: 'Please provide a title for the exam' })\n                        return\n                      }\n                      const message = assignmentMode === 'exam'\n                        ? `Exam \"${examConfig.title}\" Published!`\n                        : 'Practice tasks assigned successfully!'\n\n                      const description = assignmentMode === 'exam'\n                        ? `Time limit: ${examConfig.timeLimit} mins  Passing: ${examConfig.passingScore}%`\n                        : `Assigned to ${counts.total} students`\n\n                      toast.success(message, { description })\n                    }}\n                  >\n                    {assignmentMode === 'exam' ? (\n                      <>\n                        <Target className=\"h-4 w-4 mr-2\" />\n                        Publish Assessment\n                      </>\n                    ) : (\n                      <>\n                        <Send className=\"h-4 w-4 mr-2\" />\n                        Assign Tasks\n                      </>\n                    )}\n                  </Button>\n                </div>\n              </div>\n            </div>\n\n            {/* Summary */}\n            <div className=\"w-72 border-l border-gray-700 bg-gray-800 p-6\">\n              <h3 className=\"font-semibold mb-4\">Assignment Summary</h3>\n              <div className=\"space-y-4\">\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-gray-400\">Tasks:</span>\n                  <span className=\"font-medium\">{generatedTasks.length}</span>\n                </div>\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-gray-400\">Subject:</span>\n                  <span className=\"font-medium\">{config.subject || 'Not set'}</span>\n                </div>\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-gray-400\">Difficulty:</span>\n                  <span className=\"font-medium capitalize\">{config.difficulty}</span>\n                </div>\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-gray-400\">Mode:</span>\n                  <span className=\"font-medium capitalize\">{config.distributionMode}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Phase 3: Library Dialog */}\n      <Dialog open={showLibrary} onOpenChange={setShowLibrary}>\n        <DialogContent className=\"max-w-4xl h-[600px] bg-gray-900 text-white border-gray-700 flex flex-col\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <Library className=\"h-5 w-5 text-blue-400\" />\n              Task Library\n            </DialogTitle>\n          </DialogHeader>\n\n          <div className=\"flex gap-4 py-4 border-b border-gray-800\">\n            <div className=\"relative flex-1\">\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400\" />\n              <Input\n                placeholder=\"Search saved tasks...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"pl-9 bg-gray-800 border-gray-700 text-white focus:border-blue-500\"\n              />\n            </div>\n            <Button\n              variant={showFavoritesOnly ? 'default' : 'outline'}\n              onClick={() => setShowFavoritesOnly(!showFavoritesOnly)}\n              className={showFavoritesOnly ? \"bg-yellow-600 hover:bg-yellow-700\" : \"border-gray-700\"}\n            >\n              <Star className={`h-4 w-4 mr-2 ${showFavoritesOnly ? 'fill-current' : ''}`} />\n              Favorites\n            </Button>\n          </div>\n\n          <ScrollArea className=\"flex-1 -mx-6 px-6\">\n            <div className=\"grid gap-3 py-4\">\n              {getFilteredLibraryTasks().length === 0 ? (\n                <div className=\"text-center py-12 text-gray-500\">\n                  <FolderHeart className=\"h-12 w-12 mx-auto mb-3 opacity-20\" />\n                  <p>No tasks found in library</p>\n                  <p className=\"text-sm\">Save tasks from the Review step to build your collection</p>\n                </div>\n              ) : (\n                getFilteredLibraryTasks().map(task => (\n                  <Card key={task.id} className=\"bg-gray-800 border-gray-700 hover:border-gray-600 transition-colors\">\n                    <CardContent className=\"p-4\">\n                      <div className=\"flex items-start gap-4\">\n                        <div className=\"flex-1 space-y-2\">\n                          <div className=\"flex items-center gap-2\">\n                            <Badge variant=\"outline\" className=\"bg-gray-900 border-gray-700 text-gray-400\">\n                              {task.subject}\n                            </Badge>\n                            <Badge variant=\"secondary\">\n                              {task.type === 'multiple_choice' ? 'MC' : 'SA'}\n                            </Badge>\n                            {task.topics.map((t, i) => (\n                              <span key={i} className=\"text-xs text-gray-500\">{t}</span>\n                            ))}\n                          </div>\n                          <p className=\"font-medium text-white\">{task.question}</p>\n                          <div className=\"text-xs text-gray-500 flex items-center gap-3\">\n                            <span>Used {task.usedCount} times</span>\n                            <span></span>\n                            <span>Saved {new Date(task.savedAt).toLocaleDateString()}</span>\n                          </div>\n                        </div>\n                        <div className=\"flex flex-col gap-2\">\n                          <Button size=\"sm\" onClick={() => addFromLibrary(task)}>\n                            Add to Set\n                          </Button>\n                          <div className=\"flex gap-1 justify-end\">\n                            <Button\n                              variant=\"ghost\"\n                              size=\"icon\"\n                              className=\"h-8 w-8\"\n                              onClick={() => toggleFavorite(task.id)}\n                            >\n                              <Star className={`h-4 w-4 ${task.isFavorite ? 'text-yellow-400 fill-current' : 'text-gray-500'}`} />\n                            </Button>\n                            <Button\n                              variant=\"ghost\"\n                              size=\"icon\"\n                              className=\"h-8 w-8 text-red-400 hover:text-red-300\"\n                              onClick={() => deleteFromLibrary(task.id)}\n                            >\n                              <Trash2 className=\"h-4 w-4\" />\n                            </Button>\n                          </div>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))\n              )}\n            </div>\n          </ScrollArea>\n        </DialogContent>\n      </Dialog>\n\n      {/* Phase 5: Import Dialog */}\n      <Dialog open={showImport} onOpenChange={(open) => {\n        if (!isAnalyzing) {\n          setShowImport(open)\n          if (!open) {\n            setImportedTasks([])\n            setImportFile(null)\n          }\n        }\n      }}>\n        <DialogContent className=\"max-w-3xl bg-gray-900 text-white border-gray-700\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <FileUp className=\"h-5 w-5 text-blue-400\" />\n              Import Content\n            </DialogTitle>\n          </DialogHeader>\n\n          <div className=\"min-h-[400px] flex flex-col\">\n            {!importFile ? (\n              <div className=\"flex-1 flex flex-col items-center justify-center border-2 border-dashed border-gray-700 rounded-lg m-4 bg-gray-800/50 hover:bg-gray-800/80 transition-colors relative\">\n                <input\n                  type=\"file\"\n                  accept=\".pdf,.png,.jpg,.jpeg\"\n                  onChange={handleFileUpload}\n                  className=\"absolute inset-0 opacity-0 cursor-pointer\"\n                />\n                <div className=\"w-20 h-20 rounded-full bg-gray-800 flex items-center justify-center mb-4\">\n                  <UploadCloud className=\"h-10 w-10 text-gray-400\" />\n                </div>\n                <h3 className=\"text-xl font-medium mb-2\">Upload Worksheet</h3>\n                <p className=\"text-gray-400 text-center max-w-sm mb-6\">\n                  Drag and drop your PDF or Image file here,<br />or click to browse\n                </p>\n                <div className=\"flex gap-4 text-sm text-gray-500\">\n                  <span className=\"flex items-center gap-1\"><FileText className=\"h-4 w-4\" /> PDF</span>\n                  <span className=\"flex items-center gap-1\"><FileText className=\"h-4 w-4\" /> PNG</span>\n                  <span className=\"flex items-center gap-1\"><FileText className=\"h-4 w-4\" /> JPG</span>\n                </div>\n              </div>\n            ) : isAnalyzing ? (\n              <div className=\"flex-1 flex flex-col items-center justify-center p-8\">\n                <div className=\"w-24 h-24 relative mb-6\">\n                  <div className=\"absolute inset-0 rounded-full border-4 border-gray-700\"></div>\n                  <div\n                    className=\"absolute inset-0 rounded-full border-4 border-blue-500 border-t-transparent animate-spin\"\n                  ></div>\n                  <div className=\"absolute inset-0 flex items-center justify-center font-bold text-lg\">\n                    {analysisProgress}%\n                  </div>\n                </div>\n                <h3 className=\"text-xl font-medium mb-2\">Analyzing Document...</h3>\n                <p className=\"text-gray-400 animate-pulse\">Running OCR and extracting questions</p>\n                <div className=\"mt-8 text-sm text-gray-500 flex items-center gap-2\">\n                  <FileText className=\"h-4 w-4\" />\n                  {importFile.name}\n                </div>\n              </div>\n            ) : (\n              <div className=\"flex-1 flex flex-col\">\n                <div className=\"flex items-center justify-between px-6 py-4 border-b border-gray-800\">\n                  <div>\n                    <h3 className=\"font-medium\">Detected Questions</h3>\n                    <p className=\"text-sm text-gray-400\">{importedTasks.length} items found in {importFile.name}</p>\n                  </div>\n                  <Button variant=\"ghost\" size=\"sm\" onClick={() => setImportFile(null)}>\n                    <X className=\"h-4 w-4 mr-2\" />\n                    Cancel\n                  </Button>\n                </div>\n                <ScrollArea className=\"flex-1 px-6\">\n                  <div className=\"space-y-4 py-4\">\n                    {importedTasks.map((task, i) => (\n                      <Card key={i} className=\"bg-gray-800 border-gray-700\">\n                        <CardContent className=\"p-4\">\n                          <div className=\"flex gap-3\">\n                            <div className=\"w-6 h-6 rounded-full bg-blue-900/50 flex items-center justify-center text-xs font-bold text-blue-400 shrink-0\">\n                              {i + 1}\n                            </div>\n                            <div className=\"flex-1 space-y-2\">\n                              <Input\n                                value={task.question}\n                                onChange={(e) => {\n                                  const newTasks = [...importedTasks]\n                                  newTasks[i].question = e.target.value\n                                  setImportedTasks(newTasks)\n                                }}\n                                className=\"bg-gray-900 border-gray-600\"\n                              />\n                              <div className=\"flex gap-2\">\n                                <Badge variant=\"outline\">{task.type}</Badge>\n                                <Badge variant=\"secondary\">{task.difficulty}</Badge>\n                              </div>\n                            </div>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    ))}\n                  </div>\n                </ScrollArea>\n                <div className=\"p-4 border-t border-gray-800 flex justify-end gap-3\">\n                  <Button variant=\"outline\" onClick={() => setImportFile(null)}>\n                    Back\n                  </Button>\n                  <Button onClick={importExtractedTasks}>\n                    Import {importedTasks.length} Tasks\n                  </Button>\n                </div>\n              </div>\n            )}\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Phase 14: Assets Panel Side Drawer */}\n      {/* Assets Selection Drawer */}\n      <div\n        className={`fixed inset-y-0 right-0 w-[600px] bg-gray-900 border-l border-gray-800 shadow-2xl transform transition-transform duration-300 z-50 ${showAssetsPanel ? 'translate-x-0' : 'translate-x-full'}`}\n      >\n        <AssetsPanel\n          roomId={roomId}\n          students={students.map(s => ({\n            id: s.id,\n            name: s.name,\n            status: (s.status === 'on_track' ? 'active' : s.status || 'active') as 'active' | 'struggling' | 'idle' | 'needs_help'\n          }))}\n          selectionMode={true}\n          onAssetsSelect={handleAssetsSelect}\n          onClose={() => setShowAssetsPanel(false)}\n        />\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}