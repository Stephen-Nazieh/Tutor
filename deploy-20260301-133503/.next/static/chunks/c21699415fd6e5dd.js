;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="9f6566da-ba62-b3f1-a9c0-f3abacecc72d")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,697126,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r={callServer:function(){return n.callServer},createServerReference:function(){return o.createServerReference},findSourceMapURL:function(){return i.findSourceMapURL}};for(var a in r)Object.defineProperty(s,a,{enumerable:!0,get:r[a]});let n=e.r(28760),i=e.r(433626),o=e.r(586942)},86034,e=>{"use strict";let t,s,r,a,n,i,o,l,c,d;var u,h,m,p,g,f,x,v,y=e.i(251474),b=e.i(536105),j=e.i(800592),w=e.i(624842),N=e.i(525689),k=e.i(870368),S=e.i(785784),_=e.i(156155),C=e.i(725399),M=e.i(313123),T=e.i(724501),E=e.i(598320),A=e.i(196415),P=e.i(587604),I=e.i(671869),O=e.i(674339),L=e.i(390553),D=e.i(396233),R=e.i(822290),B=e.i(65546),F=e.i(486258),z=e.i(894202),$=e.i(673419),V=e.i(703594),U=e.i(102955),q=e.i(194765),H=e.i(264066),J=e.i(956208),G=e.i(121162);function W({students:e,breakoutRooms:t,onCallOn:s,onAssignToRoom:r,onRemoveFromRoom:a,onPushHint:n,onSendNudge:i,onInviteToBreakout:o}){let[l,c]=(0,j.useState)(""),[d,u]=(0,j.useState)("all"),h=e.filter(e=>{let t=e.name.toLowerCase().includes(l.toLowerCase()),s="all"===d||"online"===d&&"online"===e.status||"away"===d&&("idle"===e.status||"away"===e.status)||"hand-raised"===d&&e.handRaised;return t&&s}),m=e.filter(e=>"online"===e.status).length,p=e.filter(e=>e.handRaised).length;return(0,y.jsxs)(A.Card,{className:"h-full flex flex-col",children:[(0,y.jsxs)(A.CardHeader,{className:"pb-3",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(D.Users,{className:"w-4 h-4"}),(0,y.jsx)(A.CardTitle,{className:"text-sm font-medium",children:"Students"}),(0,y.jsxs)(S.Badge,{variant:"secondary",className:"text-xs",children:[m,"/",e.length]})]}),p>0&&(0,y.jsxs)(S.Badge,{variant:"destructive",className:"gap-1",children:[(0,y.jsx)(R.Hand,{className:"w-3 h-3"}),p]})]}),(0,y.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,y.jsxs)("div",{className:"relative flex-1",children:[(0,y.jsx)(U.Search,{className:"absolute left-2.5 top-2.5 w-4 h-4 text-gray-400"}),(0,y.jsx)(P.Input,{placeholder:"Search students...",value:l,onChange:e=>c(e.target.value),className:"pl-9 h-9"})]}),(0,y.jsxs)(T.DropdownMenu,{children:[(0,y.jsx)(T.DropdownMenuTrigger,{asChild:!0,children:(0,y.jsx)(k.Button,{variant:"outline",size:"icon",className:"h-9 w-9",children:(0,y.jsx)(q.Filter,{className:"w-4 h-4"})})}),(0,y.jsxs)(T.DropdownMenuContent,{align:"end",children:[(0,y.jsx)(T.DropdownMenuItem,{onClick:()=>u("all"),children:"All Students"}),(0,y.jsx)(T.DropdownMenuItem,{onClick:()=>u("online"),children:"Online Only"}),(0,y.jsx)(T.DropdownMenuItem,{onClick:()=>u("away"),children:"Idle/Away"}),(0,y.jsx)(T.DropdownMenuItem,{onClick:()=>u("hand-raised"),children:"Hand Raised"})]})]})]})]}),(0,y.jsx)(A.CardContent,{className:"flex-1 p-0",children:(0,y.jsx)(O.ScrollArea,{className:"h-[calc(100%-100px)]",children:(0,y.jsx)("div",{className:"space-y-1 px-4 pb-4",children:0===h.length?(0,y.jsxs)("div",{className:"text-center py-8",children:[(0,y.jsx)(D.Users,{className:"w-10 h-10 text-gray-300 mx-auto mb-2"}),(0,y.jsx)("p",{className:"text-sm text-gray-500",children:"No students found"})]}):h.map(e=>{var l;return(0,y.jsxs)("div",{className:(0,L.cn)("flex items-center gap-3 p-3 rounded-lg border transition-all",e.handRaised?"bg-yellow-50 border-yellow-200":"bg-white border-gray-100 hover:border-gray-200"),children:[(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)(I.Avatar,{className:"w-10 h-10",children:(0,y.jsx)(I.AvatarFallback,{className:"bg-blue-100 text-blue-700 text-sm",children:e.name.split(" ").map(e=>e[0]).join("")})}),(0,y.jsx)("span",{className:(0,L.cn)("absolute bottom-0 right-0 w-3 h-3 rounded-full border-2 border-white",(e=>{switch(e){case"online":return"bg-green-500";case"idle":return"bg-yellow-500";case"away":return"bg-orange-500";default:return"bg-gray-400"}})(e.status))})]}),(0,y.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("span",{className:"font-medium text-sm truncate",children:e.name}),e.handRaised&&(0,y.jsx)(R.Hand,{className:"w-4 h-4 text-yellow-600 animate-pulse"})]}),(0,y.jsxs)("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[(0,y.jsxs)("span",{className:(0,L.cn)("font-medium",(l=e.engagementScore)>=80?"text-green-600":l>=60?"text-blue-600":l>=40?"text-yellow-600":"text-red-600"),children:[e.engagementScore,"% engaged"]}),e.breakoutRoomId&&(0,y.jsx)("span",{className:"text-blue-600",children:t.find(t=>t.id===e.breakoutRoomId)?.name})]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-1",children:[e.handRaised&&(0,y.jsx)(k.Button,{size:"sm",variant:"ghost",className:"h-8 text-yellow-700 hover:text-yellow-800 hover:bg-yellow-100",onClick:()=>s?.(e.id),children:"Call On"}),(0,y.jsxs)(T.DropdownMenu,{children:[(0,y.jsx)(T.DropdownMenuTrigger,{asChild:!0,children:(0,y.jsx)(k.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,y.jsx)(B.MoreVertical,{className:"w-4 h-4"})})}),(0,y.jsxs)(T.DropdownMenuContent,{align:"end",children:[(0,y.jsxs)(T.DropdownMenuItem,{onClick:()=>s?.(e.id),children:[(0,y.jsx)(z.MessageCircle,{className:"w-4 h-4 mr-2"}),"Send Message"]}),t.length>0&&!e.breakoutRoomId&&(0,y.jsx)(T.DropdownMenuItem,{asChild:!0,children:(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)($.UserPlus,{className:"w-4 h-4 mr-2"}),"Assign to Room",(0,y.jsx)("div",{className:"absolute left-full top-0 ml-1 bg-white border rounded-lg shadow-lg p-1 min-w-[120px]",children:t.map(t=>(0,y.jsx)("button",{className:"w-full text-left px-2 py-1 text-sm hover:bg-gray-100 rounded",onClick:()=>r?.(e.id,t.id),children:t.name},t.id))})]})}),e.breakoutRoomId&&(0,y.jsxs)(T.DropdownMenuItem,{onClick:()=>a?.(e.id),children:[(0,y.jsx)(V.LogOut,{className:"w-4 h-4 mr-2"}),"Remove from Room"]}),(0,y.jsxs)(T.DropdownMenuItem,{onClick:()=>n?.(e.id,"Remember to think about the key concept we discussed.","socratic"),children:[(0,y.jsx)(H.Lightbulb,{className:"w-4 h-4 mr-2"}),"Send Socratic Hint"]}),(0,y.jsxs)(T.DropdownMenuItem,{onClick:()=>i?.(e.id),children:[(0,y.jsx)(J.Bell,{className:"w-4 h-4 mr-2"}),"Send Nudge"]}),t.length>0&&(0,y.jsxs)(T.DropdownMenuItem,{onClick:()=>o?.(e.id),children:[(0,y.jsx)(G.LayoutGrid,{className:"w-4 h-4 mr-2"}),"Invite to Breakout"]}),(0,y.jsxs)(T.DropdownMenuItem,{className:"text-red-600",children:[(0,y.jsx)(F.MicOff,{className:"w-4 h-4 mr-2"}),"Mute"]})]})]})]})]},e.id)})})})})]})}var Q=e.i(230645),K=e.i(828977),Y=e.i(53169),X=e.i(393758),Z=e.i(129340),ee=e.i(879191);let et=(0,ee.default)("shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]);var es=e.i(683657),er=e.i(505595),ea=e.i(755142);let en=(0,ee.default)("door-open",[["path",{d:"M11 20H2",key:"nlcfvz"}],["path",{d:"M11 4.562v16.157a1 1 0 0 0 1.242.97L19 20V5.562a2 2 0 0 0-1.515-1.94l-4-1A2 2 0 0 0 11 4.561z",key:"au4z13"}],["path",{d:"M11 4H8a2 2 0 0 0-2 2v14",key:"74r1mk"}],["path",{d:"M14 12h.01",key:"1jfl7z"}],["path",{d:"M22 20h-3",key:"vhrsz"}]]);var ei=e.i(358469);let eo=[{key:"random",label:"Random",description:"Mix students randomly",icon:et},{key:"skill_based",label:"Skill Based",description:"Group by performance level",icon:Z.Target},{key:"social",label:"Social/Mixed",description:"Mix abilities for peer teaching",icon:$.UserPlus},{key:"manual",label:"Manual",description:"You assign students",icon:es.Settings2},{key:"self_select",label:"Self Select",description:"Students choose groups",icon:D.Users}];function el({config:e,setConfig:t,suggestion:s,students:r,onCreate:a,onCancel:n}){let i=r.filter(e=>"online"===e.status);return(0,y.jsx)("div",{className:"h-full flex flex-col bg-gray-50 p-6 overflow-auto",children:(0,y.jsxs)("div",{className:"max-w-4xl mx-auto w-full space-y-6",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,y.jsx)(ea.Sparkles,{className:"h-6 w-6 text-purple-600"}),"Create Breakout Rooms"]}),(0,y.jsx)("p",{className:"text-gray-500",children:"Configure and start breakout sessions"})]}),(0,y.jsxs)(k.Button,{variant:"outline",onClick:n,children:[(0,y.jsx)(K.X,{className:"h-4 w-4 mr-1"}),"Cancel"]})]}),s&&(0,y.jsxs)(A.Card,{className:"bg-purple-50 border-purple-200",children:[(0,y.jsx)(A.CardHeader,{children:(0,y.jsxs)(A.CardTitle,{className:"text-purple-900 text-base flex items-center gap-2",children:[(0,y.jsx)(X.Brain,{className:"h-5 w-5 text-purple-600"}),"AI Grouping Suggestion",(0,y.jsxs)(S.Badge,{variant:"secondary",className:"ml-2",children:[Math.round(100*s.confidence),"% confidence"]})]})}),(0,y.jsxs)(A.CardContent,{children:[(0,y.jsx)("p",{className:"text-sm text-purple-800 mb-3",children:s.description}),(0,y.jsx)("div",{className:"space-y-2",children:s.groups.map((e,t)=>(0,y.jsxs)("div",{className:"p-3 bg-white rounded-lg border border-purple-100",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,y.jsxs)("span",{className:"text-sm font-medium",children:["Group ",t+1]}),(0,y.jsxs)(S.Badge,{variant:"outline",className:"text-[10px]",children:[e.members.length," members"]}),(0,y.jsxs)("div",{className:"flex gap-1 ml-auto",children:[e.skillProfile.beginners>0&&(0,y.jsxs)(S.Badge,{className:"text-[10px] bg-blue-100 text-blue-700",children:[e.skillProfile.beginners," B"]}),e.skillProfile.intermediate>0&&(0,y.jsxs)(S.Badge,{className:"text-[10px] bg-green-100 text-green-700",children:[e.skillProfile.intermediate," I"]}),e.skillProfile.advanced>0&&(0,y.jsxs)(S.Badge,{className:"text-[10px] bg-purple-100 text-purple-700",children:[e.skillProfile.advanced," A"]})]})]}),(0,y.jsx)("p",{className:"text-xs text-gray-600",children:e.rationale}),(0,y.jsxs)("p",{className:"text-xs text-green-600 mt-1",children:["Expected: ",e.predictedOutcome]})]},t))})]})]}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,y.jsxs)(A.Card,{children:[(0,y.jsx)(A.CardHeader,{children:(0,y.jsx)(A.CardTitle,{className:"text-base",children:"Room Configuration"})}),(0,y.jsxs)(A.CardContent,{className:"space-y-4",children:[(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)("label",{className:"text-sm text-gray-600",children:"Number of Rooms"}),(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)(k.Button,{variant:"outline",size:"icon",onClick:()=>t({...e,roomCount:Math.max(1,e.roomCount-1)}),children:(0,y.jsx)(K.X,{className:"h-4 w-4"})}),(0,y.jsx)("span",{className:"text-2xl font-bold w-12 text-center",children:e.roomCount}),(0,y.jsx)(k.Button,{variant:"outline",size:"icon",onClick:()=>t({...e,roomCount:Math.min(10,e.roomCount+1)}),children:(0,y.jsx)(Y.Plus,{className:"h-4 w-4"})})]})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)("label",{className:"text-sm text-gray-600",children:"Students per Room"}),(0,y.jsxs)(Q.Select,{value:e.participantsPerRoom.toString(),onValueChange:s=>t({...e,participantsPerRoom:parseInt(s)}),children:[(0,y.jsx)(Q.SelectTrigger,{children:(0,y.jsx)(Q.SelectValue,{})}),(0,y.jsxs)(Q.SelectContent,{children:[(0,y.jsx)(Q.SelectItem,{value:"2",children:"2 students"}),(0,y.jsx)(Q.SelectItem,{value:"3",children:"3 students"}),(0,y.jsx)(Q.SelectItem,{value:"4",children:"4 students"}),(0,y.jsx)(Q.SelectItem,{value:"5",children:"5 students"}),(0,y.jsx)(Q.SelectItem,{value:"6",children:"6 students"})]})]})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)("label",{className:"text-sm text-gray-600",children:"Time Limit (minutes)"}),(0,y.jsxs)(Q.Select,{value:e.timeLimit.toString(),onValueChange:s=>t({...e,timeLimit:parseInt(s)}),children:[(0,y.jsx)(Q.SelectTrigger,{children:(0,y.jsx)(Q.SelectValue,{})}),(0,y.jsxs)(Q.SelectContent,{children:[(0,y.jsx)(Q.SelectItem,{value:"5",children:"5 minutes"}),(0,y.jsx)(Q.SelectItem,{value:"10",children:"10 minutes"}),(0,y.jsx)(Q.SelectItem,{value:"15",children:"15 minutes"}),(0,y.jsx)(Q.SelectItem,{value:"20",children:"20 minutes"}),(0,y.jsx)(Q.SelectItem,{value:"30",children:"30 minutes"}),(0,y.jsx)(Q.SelectItem,{value:"45",children:"45 minutes"})]})]})]})]})]}),(0,y.jsxs)(A.Card,{children:[(0,y.jsx)(A.CardHeader,{children:(0,y.jsx)(A.CardTitle,{className:"text-base",children:"Distribution Strategy"})}),(0,y.jsxs)(A.CardContent,{className:"space-y-3",children:[eo.map(({key:s,label:r,description:a,icon:n})=>(0,y.jsx)("button",{onClick:()=>t({...e,distributionMode:s}),className:(0,L.cn)("w-full p-3 rounded-lg border text-left transition-colors",e.distributionMode===s?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"),children:(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[e.distributionMode===s&&(0,y.jsx)(er.CheckCircle,{className:"h-5 w-5 text-blue-600"}),(0,y.jsx)("div",{className:(0,L.cn)("text-gray-400",e.distributionMode===s&&"text-blue-600"),children:(0,y.jsx)(n,{className:"h-4 w-4"})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"font-medium text-sm",children:r}),(0,y.jsx)("p",{className:"text-xs text-gray-500",children:a})]})]})},s)),(0,y.jsx)("div",{className:"pt-4 border-t",children:(0,y.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,y.jsx)("input",{type:"checkbox",checked:e.aiAssistantEnabled,onChange:s=>t({...e,aiAssistantEnabled:s.target.checked}),className:"w-5 h-5 rounded border-gray-300"}),(0,y.jsxs)("div",{children:[(0,y.jsx)("span",{className:"block text-sm font-medium",children:"Enable AI Assistant in rooms"}),(0,y.jsx)("span",{className:"text-xs text-gray-500",children:"AI will monitor and assist students"})]})]})})]})]})]}),(0,y.jsx)(A.Card,{className:"bg-gray-50 border-gray-200",children:(0,y.jsx)(A.CardContent,{className:"p-4",children:(0,y.jsx)("div",{className:"flex items-center justify-between",children:(0,y.jsxs)("div",{className:"flex items-center gap-6",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(D.Users,{className:"h-5 w-5 text-gray-400"}),(0,y.jsxs)("span",{className:"text-sm",children:[(0,y.jsx)("strong",{children:i.length})," students available"]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(en,{className:"h-5 w-5 text-gray-400"}),(0,y.jsxs)("span",{className:"text-sm",children:[(0,y.jsx)("strong",{children:e.roomCount})," rooms"]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(ei.Clock,{className:"h-5 w-5 text-gray-400"}),(0,y.jsxs)("span",{className:"text-sm",children:[(0,y.jsx)("strong",{children:e.timeLimit})," minutes"]})]})]})})})}),(0,y.jsxs)("div",{className:"flex gap-3",children:[(0,y.jsx)(k.Button,{variant:"outline",className:"flex-1",onClick:n,children:"Cancel"}),(0,y.jsxs)(k.Button,{className:"flex-1",onClick:a,children:[(0,y.jsx)(en,{className:"h-4 w-4 mr-2"}),"Create ",e.roomCount," Room",1!==e.roomCount?"s":""]})]})]})})}let ec=[{id:"discuss",title:"Group Discussion",description:"Discuss the key concepts covered in today's lesson. Share your understanding and ask clarifying questions.",type:"discussion"},{id:"problem",title:"Problem Solving",description:"Work together to solve the assigned problem set. Each member should contribute their approach.",type:"problem"},{id:"peer-teach",title:"Peer Teaching",description:"Each student takes turns explaining a concept to the group. Teach each other!",type:"discussion"},{id:"project",title:"Mini Project",description:"Collaborate on creating a presentation or solution to the given challenge.",type:"project"}],ed=(0,ee.default)("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]]);var eu=e.i(795624);function eh({room:e,unassignedStudents:t,onAssignStudent:s,onRemoveStudent:r,onJoinRoom:a,onExtendTime:n,onAssignTask:i}){var o;let l,[c,d]=(0,j.useState)(!1);return(0,y.jsxs)("div",{className:"h-full flex flex-col p-4",children:[(0,y.jsx)(A.Card,{className:"mb-4",children:(0,y.jsx)(A.CardHeader,{className:"pb-3",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,y.jsx)(A.CardTitle,{className:"text-lg",children:e.name}),(e=>{switch(e){case"active":return(0,y.jsx)(S.Badge,{className:"bg-green-500",children:"Active"});case"forming":return(0,y.jsx)(S.Badge,{variant:"outline",className:"border-blue-500 text-blue-600",children:"Forming"});case"paused":return(0,y.jsx)(S.Badge,{variant:"outline",className:"border-yellow-500 text-yellow-600",children:"Paused"});case"closed":return(0,y.jsx)(S.Badge,{variant:"secondary",children:"Closed"});default:return(0,y.jsx)(S.Badge,{variant:"outline",children:e})}})(e.status),e.aiEnabled&&(0,y.jsxs)(S.Badge,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-200",children:[(0,y.jsx)(X.Brain,{className:"h-3 w-3 mr-1"}),"AI"]})]}),e.topic&&(0,y.jsx)("p",{className:"text-sm text-gray-500",children:e.topic})]}),(0,y.jsx)("div",{className:"flex items-center gap-2",children:"active"===e.status&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:(0,L.cn)("flex items-center gap-1 px-2 py-1 rounded text-sm font-medium",e.timeRemaining<60?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:[(0,y.jsx)(ei.Clock,{className:"h-4 w-4"}),(l=Math.floor((o=e.timeRemaining)/60),`${l}:${(o%60).toString().padStart(2,"0")}`)]}),(0,y.jsxs)(k.Button,{onClick:()=>a(e),children:[(0,y.jsx)(ed,{className:"h-4 w-4 mr-2"}),"Join Room"]})]})})]})})}),(0,y.jsxs)("div",{className:"flex-1 grid grid-cols-2 gap-4 min-h-0",children:[(0,y.jsxs)(A.Card,{className:"flex flex-col",children:[(0,y.jsx)(A.CardHeader,{className:"pb-3",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)(A.CardTitle,{className:"text-sm font-medium flex items-center gap-2",children:[(0,y.jsx)(D.Users,{className:"h-4 w-4"}),"Students (",e.participants.filter(e=>"student"===e.role).length,")"]}),t.length>0&&(0,y.jsxs)(k.Button,{variant:"ghost",size:"sm",onClick:()=>d(!c),children:[(0,y.jsx)($.UserPlus,{className:"h-4 w-4 mr-1"}),"Add"]})]})}),(0,y.jsx)(A.CardContent,{className:"flex-1 overflow-hidden",children:(0,y.jsx)(O.ScrollArea,{className:"h-full",children:(0,y.jsxs)("div",{className:"space-y-2",children:[0===e.participants.filter(e=>"student"===e.role).length?(0,y.jsx)("p",{className:"text-sm text-gray-400 italic",children:"No students assigned"}):e.participants.filter(e=>"student"===e.role).map(t=>(0,y.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("div",{className:(0,L.cn)("w-2 h-2 rounded-full",t.isOnline?"bg-green-500":"bg-gray-400")}),(0,y.jsx)("span",{className:"text-sm",children:t.name}),t.handRaised&&(0,y.jsx)(eu.AlertCircle,{className:"h-3 w-3 text-yellow-500"})]}),(0,y.jsx)(k.Button,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>r(e.id,t.userId),children:(0,y.jsx)(V.LogOut,{className:"h-3 w-3 text-gray-400"})})]},t.id)),c&&t.length>0&&(0,y.jsxs)("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[(0,y.jsx)("h4",{className:"text-sm font-medium mb-2 text-blue-900",children:"Add Students"}),(0,y.jsx)("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:t.map(r=>(0,y.jsxs)("button",{className:"w-full text-left px-2 py-1.5 text-sm hover:bg-blue-100 rounded flex items-center gap-2",onClick:()=>{s(e.id,r.id),1===t.length&&d(!1)},children:[(0,y.jsx)(Y.Plus,{className:"h-3 w-3"}),r.name]},r.id))})]})]})})})]}),(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)(A.Card,{children:[(0,y.jsx)(A.CardHeader,{className:"pb-3",children:(0,y.jsx)(A.CardTitle,{className:"text-sm font-medium",children:"Assigned Task"})}),(0,y.jsxs)(A.CardContent,{children:[e.assignedTask?(0,y.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,y.jsx)("p",{className:"font-medium text-sm",children:e.assignedTask.title}),(0,y.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.assignedTask.description})]}):(0,y.jsx)("p",{className:"text-sm text-gray-400 italic",children:"No task assigned"}),(0,y.jsxs)("div",{className:"mt-3 space-y-1",children:[(0,y.jsx)("p",{className:"text-xs text-gray-500",children:"Assign a task:"}),ec.map(t=>(0,y.jsx)("button",{onClick:()=>i(e.id,t),className:"w-full text-left p-2 text-xs bg-gray-50 hover:bg-gray-100 rounded transition-colors",children:(0,y.jsx)("span",{className:"font-medium",children:t.title})},t.id))]})]})]}),"active"===e.status&&(0,y.jsxs)(A.Card,{children:[(0,y.jsx)(A.CardHeader,{className:"pb-3",children:(0,y.jsxs)(A.CardTitle,{className:"text-sm font-medium flex items-center gap-2",children:[(0,y.jsx)(ei.Clock,{className:"h-4 w-4"}),"Extend Time"]})}),(0,y.jsx)(A.CardContent,{children:(0,y.jsx)("div",{className:"flex gap-2",children:[5,10,15,30].map(t=>(0,y.jsxs)(k.Button,{size:"sm",variant:"outline",className:"flex-1 text-xs",onClick:()=>n(e.id,t),children:["+",t,"m"]},t))})})]}),(0,y.jsxs)(A.Card,{children:[(0,y.jsx)(A.CardHeader,{className:"pb-3",children:(0,y.jsx)(A.CardTitle,{className:"text-sm font-medium",children:"Metrics"})}),(0,y.jsx)(A.CardContent,{children:(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,y.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,y.jsx)("p",{className:"text-gray-500 text-xs",children:"Messages"}),(0,y.jsx)("p",{className:"font-medium",children:e.metrics.messagesExchanged})]}),(0,y.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,y.jsx)("p",{className:"text-gray-500 text-xs",children:"Engagement"}),(0,y.jsxs)("p",{className:"font-medium",children:[e.metrics.avgEngagement,"%"]})]}),(0,y.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,y.jsx)("p",{className:"text-gray-500 text-xs",children:"Participation"}),(0,y.jsxs)("p",{className:"font-medium",children:[e.metrics.participationRate,"%"]})]}),(0,y.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,y.jsx)("p",{className:"text-gray-500 text-xs",children:"Topic Focus"}),(0,y.jsxs)("p",{className:"font-medium",children:[e.metrics.topicAdherence,"%"]})]})]})})]}),e.alerts.length>0&&(0,y.jsxs)(A.Card,{className:"border-red-200",children:[(0,y.jsx)(A.CardHeader,{className:"pb-3",children:(0,y.jsxs)(A.CardTitle,{className:"text-sm font-medium flex items-center gap-2 text-red-700",children:[(0,y.jsx)(eu.AlertCircle,{className:"h-4 w-4"}),"Alerts (",e.alerts.length,")"]})}),(0,y.jsx)(A.CardContent,{children:(0,y.jsx)("div",{className:"space-y-2",children:e.alerts.slice(0,3).map((e,t)=>(0,y.jsxs)("div",{className:(0,L.cn)("p-2 rounded text-xs","high"===e.severity?"bg-red-50 text-red-700":"medium"===e.severity?"bg-yellow-50 text-yellow-700":"bg-blue-50 text-blue-700"),children:[(0,y.jsxs)("span",{className:"font-medium",children:[e.type,":"]})," ",e.message]},t))})})]})]})]})]})}var em=e.i(921236),ep=e.i(474167),eg=e.i(647667),ef=e.i(488672);function ex({rooms:e,onSelectRoom:t,onJoinRoom:s}){return(0,y.jsx)("div",{className:"h-full p-4 overflow-auto",children:(0,y.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>{var r;let a;return(0,y.jsxs)(A.Card,{className:(0,L.cn)("cursor-pointer transition-all hover:shadow-md",e.alerts.length>0&&"border-yellow-400"),onClick:()=>t(e.id),children:[(0,y.jsxs)(A.CardHeader,{className:"pb-3",children:[(0,y.jsxs)("div",{className:"flex items-start justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("div",{className:(0,L.cn)("w-3 h-3 rounded-full",(e=>{switch(e){case"active":return"bg-green-500";case"forming":return"bg-blue-500";case"paused":return"bg-yellow-500";case"closed":return"bg-gray-500";default:return"bg-gray-400"}})(e.status))}),(0,y.jsx)(A.CardTitle,{className:"text-base",children:e.name})]}),(0,y.jsx)(em.TooltipProvider,{children:(0,y.jsxs)(em.Tooltip,{children:[(0,y.jsx)(em.TooltipTrigger,{asChild:!0,children:(0,y.jsx)(k.Button,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:t=>{t.stopPropagation(),s(e)},disabled:"active"!==e.status,children:(0,y.jsx)(ed,{className:"h-4 w-4"})})}),(0,y.jsx)(em.TooltipContent,{children:(0,y.jsx)("p",{children:"Join Room"})})]})})]}),(0,y.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,y.jsx)(D.Users,{className:"h-3 w-3"}),e.participants.length," participants",e.aiEnabled&&(0,y.jsxs)(S.Badge,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:[(0,y.jsx)(X.Brain,{className:"h-3 w-3 mr-1"}),"AI"]})]})]}),(0,y.jsxs)(A.CardContent,{className:"space-y-3",children:[e.assignedTask&&(0,y.jsxs)("div",{className:"p-2 bg-gray-50 rounded text-xs",children:[(0,y.jsx)("p",{className:"font-medium text-gray-700",children:e.assignedTask.title}),(0,y.jsx)("p",{className:"text-gray-500 truncate",children:e.assignedTask.description})]}),"active"===e.status&&(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-[10px]",children:[(0,y.jsxs)("div",{className:"flex items-center gap-1 text-gray-500",children:[(0,y.jsx)(eg.MessageSquare,{className:"h-3 w-3"}),e.metrics.messagesExchanged," msgs"]}),(0,y.jsxs)("div",{className:"flex items-center gap-1 text-gray-500",children:[(0,y.jsx)(ef.BarChart3,{className:"h-3 w-3"}),Math.round(e.metrics.avgEngagement),"% engaged"]})]}),"active"===e.status&&(0,y.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,y.jsx)(ep.Timer,{className:(0,L.cn)("h-4 w-4",e.timeRemaining<60?"text-red-500":"text-gray-400")}),(0,y.jsx)("span",{className:(0,L.cn)(e.timeRemaining<60?"text-red-600 font-medium":"text-gray-600"),children:(a=Math.floor((r=e.timeRemaining)/60),`${a}:${(r%60).toString().padStart(2,"0")}`)})]}),e.alerts.length>0&&(0,y.jsxs)("div",{className:"space-y-1",children:[e.alerts.slice(0,2).map((e,t)=>(0,y.jsxs)("div",{className:(0,L.cn)("flex items-center gap-2 text-xs px-2 py-1 rounded","high"===e.severity?"bg-red-50 text-red-700":"medium"===e.severity?"bg-yellow-50 text-yellow-700":"bg-blue-50 text-blue-700"),children:[(0,y.jsx)("span",{children:(e=>{switch(e){case"confusion":return"â“";case"conflict":return"âš ï¸";case"off_topic":return"ðŸŽ¯";case"need_help":return"ðŸ†˜";case"quiet":return"ðŸ”‡";default:return"ðŸ””"}})(e.type)}),(0,y.jsx)("span",{className:"truncate",children:e.message})]},t)),e.alerts.length>2&&(0,y.jsxs)("p",{className:"text-xs text-gray-500",children:["+",e.alerts.length-2," more alerts"]})]})]})]},e.id)})})})}var ev=e.i(182372),ey=e.i(198350);let eb=(0,ee.default)("megaphone",[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]]);function ej({sessionId:e,tutorId:t,tutorName:s,students:r,onRoomsChange:a,onJoinRoom:n}){let{rooms:i,createRooms:o,endAllRooms:l,assignStudent:c,removeStudent:d,broadcastMessage:u,extendTime:h,assignTask:m}=function({sessionId:e,userId:t,userName:s,role:r}){let{socket:a,isConnected:n}=(0,N.useSocket)(),[i,o]=(0,j.useState)([]),l=(0,j.useRef)([]),c=(0,j.useCallback)(e=>({id:e.id,userId:e.userId||e.id,name:e.name,role:e.role||"student",joinedAt:e.joinedAt||new Date().toISOString(),isOnline:e.isOnline??!0,isMuted:e.isMuted??!1,isVideoOff:e.isVideoOff??!1,isScreenSharing:e.isScreenSharing??!1,engagementScore:e.engagementScore??0,attentionLevel:e.attentionLevel||"medium",handRaised:e.handRaised??!1}),[]),d=(0,j.useCallback)(t=>({id:t.id,name:t.name,mainRoomId:t.mainRoomId||e,participants:(t.participants||[]).map(e=>c(e)),maxParticipants:t.maxParticipants??6,status:t.status||"forming",timeRemaining:t.timeRemaining??t.timeLimit??0,timeLimit:t.timeLimit??t.timeRemaining??0,startedAt:t.startedAt,endsAt:t.endsAt,aiEnabled:t.aiEnabled??!0,aiMode:t.aiMode||"passive",assignedTask:t.assignedTask,topic:t.topic,alerts:t.alerts||[],metrics:t.metrics||{messagesExchanged:0,avgEngagement:0,participationRate:0,topicAdherence:0,lastUpdated:new Date().toISOString()},videoRoom:t.videoRoom,messages:t.messages||[]}),[c,e]);(0,j.useEffect)(()=>{l.current=i},[i]),(0,j.useEffect)(()=>{if(a&&n)return a.emit("breakout:join_coordination",{mainRoomId:e,userId:t,name:s,role:r}),a.emit("join_breakout_coordination",{mainRoomId:e,userId:t,name:s,role:r}),()=>{a.emit("breakout:leave_coordination",{mainRoomId:e,userId:t}),a.emit("breakout_leave_coordination",{mainRoomId:e,userId:t})}},[a,n,e,t,s,r]),(0,j.useEffect)(()=>{if(!a)return;let e=e=>{o(e.rooms.map(d))},t=e=>{o(t=>[...t,d(e.room)])},s=e=>{o(t=>t.filter(t=>t.id!==e.roomId))},r=e=>{o(t=>t.map(t=>t.id===e.roomId?{...t,participants:[...t.participants,c(e.participant)]}:t))},n=e=>{let t=e.userId||e.participantId;t&&o(s=>s.map(s=>s.id===e.roomId?{...s,participants:s.participants.filter(e=>e.userId!==t)}:s))},i=e=>{o(t=>t.map(t=>t.id===e.roomId?{...t,timeRemaining:e.secondsRemaining}:t))},l=e=>{o(t=>t.map(t=>t.id===e.roomId?{...t,timeRemaining:e.newTimeRemaining}:t))},u=e=>{let t={id:e.alert.id||`${e.roomId}-${Date.now()}`,type:e.alert.type,message:e.alert.message,timestamp:e.alert.timestamp||new Date().toISOString(),severity:e.alert.severity||"medium",participantId:e.alert.participantId,acknowledged:e.alert.acknowledged??!1};o(s=>s.map(s=>s.id===e.roomId?{...s,alerts:[...s.alerts,t]}:s))},h=e=>{let t="content"in e?e:{id:e.id,roomId:e.roomId,senderId:e.senderId,senderName:e.senderName,senderRole:"student",content:e.message,timestamp:"number"==typeof e.timestamp?new Date(e.timestamp).toISOString():e.timestamp,type:"text"};o(e=>e.map(e=>e.id===t.roomId?{...e,messages:[...e.messages,t],metrics:{...e.metrics,messagesExchanged:e.metrics.messagesExchanged+1}}:e))},m=e=>{o(t=>t.map(t=>t.id===e.roomId?{...t,metrics:{...t.metrics,...e.metrics}}:t))};return a.on("breakout:rooms_updated",e),a.on("breakout_rooms_created",e),a.on("breakout:room_created",t),a.on("breakout:room_ended",s),a.on("breakout:participant_joined",r),a.on("breakout_participant_joined",r),a.on("breakout:participant_left",n),a.on("breakout_participant_left",n),a.on("breakout:countdown",i),a.on("breakout_countdown",i),a.on("breakout:time_extended",l),a.on("breakout:alert",u),a.on("breakout_alert",u),a.on("breakout:message",h),a.on("breakout_message",h),a.on("breakout:metrics_update",m),()=>{a.off("breakout:rooms_updated",e),a.off("breakout_rooms_created",e),a.off("breakout:room_created",t),a.off("breakout:room_ended",s),a.off("breakout:participant_joined",r),a.off("breakout_participant_joined",r),a.off("breakout:participant_left",n),a.off("breakout_participant_left",n),a.off("breakout:countdown",i),a.off("breakout_countdown",i),a.off("breakout:time_extended",l),a.off("breakout:alert",u),a.off("breakout_alert",u),a.off("breakout:message",h),a.off("breakout_message",h),a.off("breakout:metrics_update",m)}},[a,d,c]);let u=(0,j.useCallback)(t=>{a?.emit("breakout:create",{mainRoomId:e,config:t}),a?.emit("breakout_create",{mainRoomId:e,config:t})},[a,e]),h=(0,j.useCallback)(e=>{a?.emit("breakout:join",{roomId:e,userId:t,name:s,role:r}),a?.emit("breakout_join",{roomId:e,userId:t,name:s,role:r})},[a,t,s,r]),m=(0,j.useCallback)(e=>{a?.emit("breakout:leave",{roomId:e,userId:t}),a?.emit("breakout_leave",{roomId:e,userId:t})},[a,t]),p=(0,j.useCallback)(e=>{a?.emit("breakout:end",{roomId:e})},[a]),g=(0,j.useCallback)(()=>{a?.emit("breakout:end_all",{mainRoomId:e}),a?.emit("breakout_close",{mainRoomId:e})},[a,e]),f=(0,j.useCallback)((e,t)=>{a?.emit("breakout:assign",{roomId:e,studentId:t})},[a]),x=(0,j.useCallback)((e,t)=>{a?.emit("breakout:remove",{roomId:e,studentId:t})},[a]),v=(0,j.useCallback)(()=>{a?.emit("breakout:rotate",{sessionId:e})},[a,e]),y=(0,j.useCallback)((e,t,s)=>{a?.emit("breakout:message",{roomId:e,content:t,type:s}),a?.emit("breakout_message",{roomId:e,message:t,type:s})},[a]),b=(0,j.useCallback)((t,s,r)=>{a?.emit("breakout:broadcast",{mainRoomId:e,message:t,target:s,roomIds:r}),a?.emit("breakout_broadcast",{mainRoomId:e,message:t,target:s,roomIds:r})},[a,e]),w=(0,j.useCallback)((e,t)=>{a?.emit("breakout:extend",{roomId:e,minutes:t})},[a]),k=(0,j.useCallback)((e,t)=>{a?.emit("breakout:assign_task",{roomId:e,task:t})},[a]),S=(0,j.useCallback)((e,t)=>{a?.emit("breakout:toggle_ai",{roomId:e,enabled:t})},[a]),_=(0,j.useCallback)(e=>{a?.emit("breakout:request_help",{roomId:e}),a?.emit("breakout_request_help",{roomId:e,userId:t})},[a,t]),C=(0,j.useCallback)((e,t)=>{a?.emit("breakout:raise_hand",{roomId:e,raised:t})},[a]);return{rooms:i,isConnected:n,createRooms:u,joinRoom:h,leaveRoom:m,endRoom:p,endAllRooms:g,assignStudent:f,removeStudent:x,rotateGroups:v,sendMessage:y,broadcastMessage:b,extendTime:w,assignTask:k,toggleAI:S,requestHelp:_,raiseHand:C,updateVideoState:(0,j.useCallback)((e,t)=>{a?.emit("breakout:video_state",{roomId:e,...t})},[a]),acknowledgeAlert:(0,j.useCallback)((e,t)=>{a?.emit("breakout:acknowledge_alert",{roomId:e,alertId:t})},[a])}}({sessionId:e,userId:t,userName:s,role:"tutor"}),[p,g]=(0,j.useState)(null),[f,x]=(0,j.useState)(!1),[v,b]=(0,j.useState)(""),[w,C]=(0,j.useState)({roomCount:3,participantsPerRoom:4,distributionMode:"random",timeLimit:15,aiAssistantEnabled:!0,aiMode:"passive"}),{suggestion:M}=function({students:e,config:t}){let s=(0,j.useCallback)(()=>{if(e.length<4)return;let{roomCount:s,distributionMode:r}=t,a=e.filter(e=>"beginner"===e.skillLevel||void 0!==e.recentPerformance&&e.recentPerformance<60),n=e.filter(e=>"intermediate"===e.skillLevel||void 0!==e.recentPerformance&&e.recentPerformance>=60&&e.recentPerformance<80),i=e.filter(e=>"advanced"===e.skillLevel||void 0!==e.recentPerformance&&e.recentPerformance>=80),o=e.filter(e=>!e.skillLevel&&void 0===e.recentPerformance);switch(r){case"skill_based":{if(0===a.length&&0===i.length)return;let e=[];if(a.length>0)for(let t=0;t<Math.min(s,Math.ceil(a.length/4));t++){let s=4*t,r=a.slice(s,s+4).map(e=>e.id);r.length>0&&e.push({roomIndex:e.length,members:r,rationale:"Beginners can work at a comfortable pace with foundational support",predictedOutcome:"Higher confidence and reduced frustration",skillProfile:{beginners:r.length,intermediate:0,advanced:0}})}if(n.length>0&&e.length<s)for(let t=0;t<Math.min(s-e.length,Math.ceil(n.length/4));t++){let s=4*t,r=n.slice(s,s+4).map(e=>e.id);r.length>0&&e.push({roomIndex:e.length,members:r,rationale:"Intermediate students can build on existing knowledge",predictedOutcome:"Steady progress with peer collaboration",skillProfile:{beginners:0,intermediate:r.length,advanced:0}})}if(i.length>0&&e.length<s)for(let t=0;t<Math.min(s-e.length,Math.ceil(i.length/4));t++){let s=4*t,r=i.slice(s,s+4).map(e=>e.id);r.length>0&&e.push({roomIndex:e.length,members:r,rationale:"Advanced students can tackle complex challenges",predictedOutcome:"Deeper exploration and leadership development",skillProfile:{beginners:0,intermediate:0,advanced:r.length}})}return{type:"skill_based",description:"Group students by similar skill levels for targeted instruction",confidence:.85,groups:e}}case"social":{let e=[];for(let t=0;t<s;t++){let s=[],r=Math.min(2,a.length-s.length);for(let e=0;e<r;e++){let e=a.find(e=>!s.includes(e.id));e&&s.push(e.id)}let l=Math.min(2,4-s.length);for(let e=0;e<l;e++){let e=n.find(e=>!s.includes(e.id));e&&s.push(e.id)}if(s.length<4&&i.length>0){let e=i.find(e=>!s.includes(e.id));e&&s.push(e.id)}for(;s.length<3&&o.length>0;){let e=o.find(e=>!s.includes(e.id));e&&s.push(e.id)}s.length>=2&&e.push({roomIndex:t,members:s,rationale:"Balanced group with mentorship opportunities",predictedOutcome:"Enhanced learning through teaching and diverse perspectives",skillProfile:{beginners:s.filter(e=>a.some(t=>t.id===e)).length,intermediate:s.filter(e=>n.some(t=>t.id===e)).length,advanced:s.filter(e=>i.some(t=>t.id===e)).length}})}return{type:"social",description:"Mix skill levels to promote peer teaching and collaboration",confidence:.8,groups:e}}case"random":{let r=[...e].sort(()=>Math.random()-.5),o=[];for(let e=0;e<s;e++){let s=e*t.participantsPerRoom,l=r.slice(s,s+t.participantsPerRoom).map(e=>e.id);l.length>0&&o.push({roomIndex:e,members:l,rationale:"Random distribution for unbiased group formation",predictedOutcome:"Natural group dynamics and diverse interactions",skillProfile:{beginners:l.filter(e=>a.some(t=>t.id===e)).length,intermediate:l.filter(e=>n.some(t=>t.id===e)).length,advanced:l.filter(e=>i.some(t=>t.id===e)).length}})}return{type:"random",description:"Randomly distribute students across groups",confidence:.7,groups:o}}default:return}},[e,t]);return{suggestion:(0,j.useMemo)(()=>{if("manual"!==t.distributionMode&&"self_select"!==t.distributionMode)return s()},[s,t.distributionMode])}}({students:r,config:w}),T=(0,j.useMemo)(()=>i.find(e=>e.id===p),[i,p]),A=(0,j.useMemo)(()=>r.filter(e=>!i.some(t=>t.participants.some(t=>t.userId===e.id))&&"online"===e.status),[r,i]),I=(0,j.useMemo)(()=>i.filter(e=>"active"===e.status),[i]),R=(0,j.useMemo)(()=>i.reduce((e,t)=>e+t.alerts.filter(e=>!e.acknowledged).length,0),[i]);(0,j.useEffect)(()=>{a?.(i)},[i,a]);let B=(0,j.useCallback)(()=>{o(M?{...w,suggestedGroups:M}:w),x(!1),E.toast.success(`Creating ${w.roomCount} breakout rooms...`)},[o,w,M]),F=(0,j.useCallback)(()=>{confirm("Are you sure you want to end all breakout sessions?")&&(l(),E.toast.success("Ending all breakout sessions..."))},[l]),z=(0,j.useCallback)(()=>{v.trim()&&(u(v,"all"),b(""),E.toast.success("Broadcast sent to all rooms"))},[u,v]),$=(0,j.useCallback)(e=>{n?.(e)},[n]),V=(0,j.useCallback)((e,t)=>{m(e,t),E.toast.success(`Task assigned: ${t.title}`)},[m]);return f?(0,y.jsx)(el,{config:w,setConfig:C,suggestion:M,students:r,onCreate:B,onCancel:()=>x(!1)}):0===i.length?(0,y.jsxs)("div",{className:"h-full flex flex-col bg-gray-50",children:[(0,y.jsxs)("div",{className:"p-4 border-b bg-white flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:"bg-blue-600 p-2 rounded-lg",children:(0,y.jsx)(ey.Grid3X3,{className:"h-5 w-5 text-white"})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h2",{className:"text-lg font-semibold",children:"Breakout Rooms"}),(0,y.jsx)("p",{className:"text-sm text-gray-500",children:"Manage small group sessions"})]})]}),(0,y.jsxs)(k.Button,{onClick:()=>x(!0),children:[(0,y.jsx)(Y.Plus,{className:"h-4 w-4 mr-2"}),"Create Rooms"]})]}),(0,y.jsx)("div",{className:"flex-1 flex items-center justify-center p-6",children:(0,y.jsxs)("div",{className:"text-center max-w-md",children:[(0,y.jsx)("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,y.jsx)(ey.Grid3X3,{className:"h-10 w-10 text-gray-400"})}),(0,y.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"No Breakout Rooms"}),(0,y.jsx)("p",{className:"text-gray-500 mb-6",children:"Create breakout rooms to split students into smaller groups for focused discussions or activities."}),(0,y.jsx)("div",{className:"flex items-center justify-center gap-4 text-sm text-gray-500",children:(0,y.jsxs)("span",{className:"flex items-center gap-1",children:[(0,y.jsx)(D.Users,{className:"h-4 w-4"}),r.filter(e=>"online"===e.status).length," students available"]})})]})})]}):(0,y.jsxs)("div",{className:"h-full flex flex-col bg-gray-50",children:[(0,y.jsxs)("div",{className:"px-4 py-3 border-b bg-white flex items-center justify-between shrink-0",children:[(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:"bg-blue-600 p-2 rounded-lg",children:(0,y.jsx)(ey.Grid3X3,{className:"h-5 w-5 text-white"})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h2",{className:"text-lg font-semibold",children:"Breakout Rooms"}),(0,y.jsxs)("p",{className:"text-sm text-gray-500",children:[i.length," rooms â€¢ ",i.reduce((e,t)=>e+t.participants.length,0)," students",R>0&&(0,y.jsxs)("span",{className:"ml-2 text-red-600",children:["â€¢ ",R," alert",1!==R?"s":""]})]})]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[I.length>0&&(0,y.jsxs)(k.Button,{variant:"outline",onClick:F,className:"text-red-600 border-red-200 hover:bg-red-50",children:[(0,y.jsx)(ev.Square,{className:"h-4 w-4 mr-2"}),"End All"]}),(0,y.jsxs)(k.Button,{onClick:()=>x(!0),children:[(0,y.jsx)(Y.Plus,{className:"h-4 w-4 mr-2"}),"Add Room"]})]})]}),(0,y.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,y.jsxs)("div",{className:"w-64 border-r bg-white flex flex-col shrink-0",children:[(0,y.jsx)("div",{className:"p-3 border-b",children:(0,y.jsx)("h3",{className:"text-sm font-medium text-gray-700",children:"Rooms"})}),(0,y.jsx)(O.ScrollArea,{className:"flex-1",children:(0,y.jsx)("div",{className:"p-2 space-y-1",children:i.map(e=>(0,y.jsxs)("button",{onClick:()=>g(e.id),className:(0,L.cn)("w-full text-left p-3 rounded-lg border transition-all",p===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),children:[(0,y.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,y.jsx)("span",{className:"font-medium text-sm",children:e.name}),(e=>{switch(e){case"active":return(0,y.jsx)(S.Badge,{className:"bg-green-500",children:"Active"});case"forming":return(0,y.jsx)(S.Badge,{variant:"outline",className:"border-blue-500 text-blue-600",children:"Forming"});case"paused":return(0,y.jsx)(S.Badge,{variant:"outline",className:"border-yellow-500 text-yellow-600",children:"Paused"});case"closed":return(0,y.jsx)(S.Badge,{variant:"secondary",children:"Closed"});default:return(0,y.jsx)(S.Badge,{variant:"outline",children:e})}})(e.status)]}),(0,y.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,y.jsx)(D.Users,{className:"h-3 w-3"}),e.participants.length,e.aiEnabled&&(0,y.jsxs)(S.Badge,{variant:"outline",className:"text-[10px] h-4 px-1",children:[(0,y.jsx)(X.Brain,{className:"h-2 w-2 mr-0.5"}),"AI"]})]}),e.alerts.length>0&&(0,y.jsxs)("div",{className:"mt-1 flex items-center gap-1 text-xs text-red-600",children:[(0,y.jsx)(eu.AlertCircle,{className:"h-3 w-3"}),e.alerts.length," alert",1!==e.alerts.length?"s":""]})]},e.id))})}),(0,y.jsx)("div",{className:"p-3 border-t bg-gray-50",children:(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-center",children:[(0,y.jsxs)("div",{className:"bg-white p-2 rounded border",children:[(0,y.jsx)("p",{className:"text-lg font-bold",children:I.length}),(0,y.jsx)("p",{className:"text-[10px] text-gray-500",children:"Active"})]}),(0,y.jsxs)("div",{className:"bg-white p-2 rounded border",children:[(0,y.jsx)("p",{className:"text-lg font-bold",children:R}),(0,y.jsx)("p",{className:"text-[10px] text-gray-500",children:"Alerts"})]})]})})]}),(0,y.jsx)("div",{className:"flex-1 overflow-hidden",children:T?(0,y.jsx)(eh,{room:T,unassignedStudents:A,onAssignStudent:c,onRemoveStudent:d,onJoinRoom:$,onExtendTime:h,onAssignTask:V}):(0,y.jsx)(ex,{rooms:i,onSelectRoom:g,onJoinRoom:$})}),(0,y.jsx)("div",{className:"w-80 border-l bg-white flex flex-col shrink-0",children:(0,y.jsxs)(_.Tabs,{defaultValue:"broadcast",className:"flex-1 flex flex-col",children:[(0,y.jsxs)(_.TabsList,{className:"grid w-full grid-cols-3 mx-2 mt-2",children:[(0,y.jsxs)(_.TabsTrigger,{value:"broadcast",className:"text-xs",children:[(0,y.jsx)(eb,{className:"h-3 w-3 mr-1"}),"Broadcast"]}),(0,y.jsxs)(_.TabsTrigger,{value:"alerts",className:"text-xs",children:[(0,y.jsx)(eu.AlertCircle,{className:"h-3 w-3 mr-1"}),"Alerts",R>0&&(0,y.jsx)("span",{className:"ml-1 bg-red-500 text-white text-[10px] px-1 rounded-full",children:R})]}),(0,y.jsxs)(_.TabsTrigger,{value:"stats",className:"text-xs",children:[(0,y.jsx)(ef.BarChart3,{className:"h-3 w-3 mr-1"}),"Stats"]})]}),(0,y.jsx)(_.TabsContent,{value:"broadcast",className:"flex-1 flex flex-col m-0 p-4",children:(0,y.jsxs)("div",{className:"space-y-3",children:[(0,y.jsx)(P.Input,{placeholder:"Message to all rooms...",value:v,onChange:e=>b(e.target.value),onKeyDown:e=>"Enter"===e.key&&z()}),(0,y.jsxs)(k.Button,{className:"w-full",onClick:z,disabled:!v.trim(),children:[(0,y.jsx)(eb,{className:"h-4 w-4 mr-2"}),"Broadcast to All"]}),(0,y.jsxs)("div",{className:"pt-2 border-t",children:[(0,y.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"Quick Messages"}),(0,y.jsx)("div",{className:"flex flex-wrap gap-1",children:["5 min left!","Wrap up soon","Great work!","Need help?"].map(e=>(0,y.jsx)("button",{onClick:()=>{u(e,"all"),E.toast.success(`Sent: "${e}"`)},className:"text-xs px-2 py-1 bg-gray-100 hover:bg-gray-200 rounded text-gray-600 transition-colors",children:e},e))})]})]})}),(0,y.jsx)(_.TabsContent,{value:"alerts",className:"flex-1 m-0 p-4",children:(0,y.jsx)(O.ScrollArea,{className:"h-full",children:(0,y.jsx)("div",{className:"space-y-2",children:0===i.flatMap(e=>e.alerts.filter(e=>!e.acknowledged).map(t=>({...t,roomName:e.name,roomId:e.id}))).length?(0,y.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,y.jsx)(er.CheckCircle,{className:"h-8 w-8 mx-auto mb-2 text-green-500"}),(0,y.jsx)("p",{className:"text-sm",children:"No active alerts"})]}):i.flatMap(e=>e.alerts.filter(e=>!e.acknowledged).map(t=>({...t,roomName:e.name,roomId:e.id}))).sort((e,t)=>{let s={high:3,medium:2,low:1};return s[t.severity]-s[e.severity]}).map((e,t)=>(0,y.jsxs)("div",{className:(0,L.cn)("p-3 rounded-lg border text-sm","high"===e.severity?"bg-red-50 border-red-200 text-red-800":"medium"===e.severity?"bg-yellow-50 border-yellow-200 text-yellow-800":"bg-blue-50 border-blue-200 text-blue-800"),children:[(0,y.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,y.jsx)("span",{children:(e=>{switch(e){case"confusion":return"â“";case"conflict":return"âš ï¸";case"off_topic":return"ðŸŽ¯";case"need_help":return"ðŸ†˜";case"quiet":return"ðŸ”‡";default:return"ðŸ””"}})(e.type)}),(0,y.jsx)("span",{className:"font-medium",children:e.roomName}),(0,y.jsx)(S.Badge,{variant:"outline",className:"text-[10px] ml-auto",children:e.severity})]}),(0,y.jsx)("p",{children:e.message})]},t))})})}),(0,y.jsx)(_.TabsContent,{value:"stats",className:"flex-1 m-0 p-4",children:(0,y.jsx)("div",{className:"space-y-4",children:(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,y.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg text-center border",children:[(0,y.jsx)("p",{className:"text-2xl font-bold",children:I.length}),(0,y.jsx)("p",{className:"text-xs text-gray-500",children:"Active Rooms"})]}),(0,y.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg text-center border",children:[(0,y.jsx)("p",{className:"text-2xl font-bold",children:R}),(0,y.jsx)("p",{className:"text-xs text-gray-500",children:"Active Alerts"})]}),(0,y.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg text-center border",children:[(0,y.jsx)("p",{className:"text-2xl font-bold",children:i.reduce((e,t)=>e+t.metrics.messagesExchanged,0)}),(0,y.jsx)("p",{className:"text-xs text-gray-500",children:"Messages"})]}),(0,y.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg text-center border",children:[(0,y.jsxs)("p",{className:"text-2xl font-bold",children:[Math.round(i.reduce((e,t)=>e+t.metrics.avgEngagement,0)/Math.max(i.length,1)),"%"]}),(0,y.jsx)("p",{className:"text-xs text-gray-500",children:"Avg Engagement"})]})]})})})]})})]})]})}var ew=e.i(960833),eN=e.i(610570);let ek=(0,ee.default)("video-off",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),eS=(0,ee.default)("monitor-up",[["path",{d:"m9 10 3-3 3 3",key:"11gsxs"}],["path",{d:"M12 13V7",key:"h0r20n"}],["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"M8 21h8",key:"1ev6f3"}]]),e_=(0,ee.default)("monitor-off",[["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"M17 17H4a2 2 0 0 1-2-2V5a2 2 0 0 1 1.184-1.826",key:"cv7jms"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8 21h8",key:"1ev6f3"}],["path",{d:"M8.656 3H20a2 2 0 0 1 2 2v10a2 2 0 0 1-.293 1.042",key:"z8ni2w"}]]),eC=(0,ee.default)("phone-off",[["path",{d:"M10.1 13.9a14 14 0 0 0 3.732 2.668 1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2 18 18 0 0 1-12.728-5.272",key:"1wngk7"}],["path",{d:"M22 2 2 22",key:"y4kqgn"}],["path",{d:"M4.76 13.582A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 .244.473",key:"10hv5p"}]]);var eM=e.i(504913),eT=e.i(315726),eE=e.i(359575);function eA({room:e,isOpen:t,userId:s,userName:r,role:a,onClose:n,onEndRoom:i,onExtendTime:o,onSendMessage:l,onRequestHelp:c,onRaiseHand:d}){var u;let h,[m,p]=(0,j.useState)("video"),[g,f]=(0,j.useState)({}),[x,v]=(0,j.useState)(""),[b,w]=(0,j.useState)(!1),[N,M]=(0,j.useState)(!1),[T,A]=(0,j.useState)(!1),[I,B]=(0,j.useState)(!1),z=(0,j.useRef)(null),$=(0,j.useMemo)(()=>e?g[e.id]??e.messages:[],[e,g]);if((0,j.useEffect)(()=>{z.current?.scrollIntoView({behavior:"smooth"})},[$]),!e)return null;let V="tutor"===a,U=()=>{if(!x.trim())return;let t={id:`msg-${Date.now()}`,roomId:e.id,senderId:s,senderName:r,senderRole:a,content:x,timestamp:new Date().toISOString(),type:"text"};f(s=>({...s,[e.id]:[...s[e.id]||e.messages,t]})),l?.(e.id,x),v("")};return(0,y.jsx)(C.Dialog,{open:t,onOpenChange:e=>!e&&n(),children:(0,y.jsxs)(C.DialogContent,{className:"max-w-6xl w-[95vw] h-[90vh] p-0 gap-0 overflow-hidden",children:[(0,y.jsx)(C.DialogHeader,{className:"px-6 py-4 border-b bg-white shrink-0",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center gap-4",children:[(0,y.jsxs)(C.DialogTitle,{className:"text-gray-900 text-lg flex items-center gap-2",children:[(0,y.jsx)(D.Users,{className:"h-5 w-5 text-blue-600"}),e.name]}),(0,y.jsx)(S.Badge,{variant:"secondary",className:(0,L.cn)("active"===e.status?"bg-green-100 text-green-700":"forming"===e.status?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),e.aiEnabled&&(0,y.jsxs)(S.Badge,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-200",children:[(0,y.jsx)(X.Brain,{className:"h-3 w-3 mr-1"}),"AI Active"]}),e.assignedTask&&(0,y.jsxs)("span",{className:"text-sm text-gray-500",children:["Task: ",e.assignedTask.title]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsxs)("div",{className:(0,L.cn)("flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-medium",e.timeRemaining<60?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:[(0,y.jsx)(ep.Timer,{className:"h-4 w-4"}),(h=Math.floor((u=e.timeRemaining)/60),`${h}:${(u%60).toString().padStart(2,"0")}`)]}),V&&(0,y.jsx)("div",{className:"flex items-center gap-1",children:(0,y.jsx)(k.Button,{variant:"outline",size:"sm",className:"h-8 px-2",onClick:()=>o?.(e.id,5),children:"+5m"})}),V&&(0,y.jsxs)(k.Button,{variant:"destructive",size:"sm",onClick:()=>{confirm(`Are you sure you want to end ${e.name}? All participants will return to the main room.`)&&(i?.(e.id),n())},className:"gap-1",children:[(0,y.jsx)(eC,{className:"h-4 w-4"}),"End Room"]})]})]})}),(0,y.jsx)("div",{className:"flex flex-1 overflow-hidden bg-gray-50",children:(0,y.jsxs)(_.Tabs,{value:m,onValueChange:p,className:"flex-1 flex flex-col",children:[(0,y.jsx)("div",{className:"bg-white border-b px-4",children:(0,y.jsxs)(_.TabsList,{className:"bg-transparent h-12",children:[(0,y.jsxs)(_.TabsTrigger,{value:"video",className:"data-[state=active]:bg-gray-100 text-gray-600 data-[state=active]:text-gray-900 gap-2",children:[(0,y.jsx)(eN.Video,{className:"h-4 w-4"}),"Video"]}),(0,y.jsxs)(_.TabsTrigger,{value:"chat",className:"data-[state=active]:bg-gray-100 text-gray-600 data-[state=active]:text-gray-900 gap-2",children:[(0,y.jsx)(eg.MessageSquare,{className:"h-4 w-4"}),"Chat",$.filter(e=>"text"===e.type).length>0&&(0,y.jsx)(S.Badge,{variant:"secondary",className:"text-[10px] h-4 px-1",children:$.filter(e=>"text"===e.type).length})]}),(0,y.jsxs)(_.TabsTrigger,{value:"participants",className:"data-[state=active]:bg-gray-100 text-gray-600 data-[state=active]:text-gray-900 gap-2",children:[(0,y.jsx)(D.Users,{className:"h-4 w-4"}),"Participants (",e.participants.length,")"]})]})}),(0,y.jsxs)(_.TabsContent,{value:"video",className:"flex-1 m-0 flex flex-col",children:[(0,y.jsx)("div",{className:"flex-1 p-4 overflow-auto",children:(0,y.jsxs)("div",{className:(0,L.cn)("grid gap-3 h-full",e.participants.length<=1?"grid-cols-1":e.participants.length<=2||e.participants.length<=4?"grid-cols-2":"grid-cols-3"),children:[(0,y.jsx)(eP,{participant:{id:s,userId:s,name:`${r} (You)`,role:a,isOnline:!0,isMuted:b,isVideoOff:N,isScreenSharing:T,engagementScore:100,attentionLevel:"high",handRaised:I,joinedAt:new Date().toISOString()},isSelf:!0}),e.participants.filter(e=>e.userId!==s).map((e,t)=>(0,y.jsx)(eP,{participant:e,index:t},e.id))]})}),(0,y.jsxs)("div",{className:"px-6 py-4 bg-white border-t flex items-center justify-center gap-4",children:[(0,y.jsx)(k.Button,{variant:b?"destructive":"outline",size:"icon",onClick:()=>w(!b),className:"h-12 w-12 rounded-full",children:b?(0,y.jsx)(F.MicOff,{className:"h-5 w-5"}):(0,y.jsx)(ew.Mic,{className:"h-5 w-5"})}),(0,y.jsx)(k.Button,{variant:N?"destructive":"outline",size:"icon",onClick:()=>M(!N),className:"h-12 w-12 rounded-full",children:N?(0,y.jsx)(ek,{className:"h-5 w-5"}):(0,y.jsx)(eN.Video,{className:"h-5 w-5"})}),(0,y.jsx)(k.Button,{variant:T?"default":"outline",size:"icon",onClick:()=>A(!T),className:(0,L.cn)("h-12 w-12 rounded-full",T&&"bg-blue-600"),children:T?(0,y.jsx)(e_,{className:"h-5 w-5"}):(0,y.jsx)(eS,{className:"h-5 w-5"})}),!V&&(0,y.jsx)(k.Button,{variant:I?"default":"outline",size:"icon",onClick:()=>{let t=!I;B(t),d?.(e.id,t),t&&E.toast.success("Hand raised")},className:(0,L.cn)("h-12 w-12 rounded-full",I&&"bg-yellow-500"),children:(0,y.jsx)(R.Hand,{className:"h-5 w-5"})}),!V&&(0,y.jsx)(k.Button,{variant:"outline",size:"icon",onClick:()=>{c?.(e.id),E.toast.success("Help request sent to tutor")},className:"h-12 w-12 rounded-full text-blue-600 border-blue-200",children:(0,y.jsx)(eE.HelpCircle,{className:"h-5 w-5"})}),(0,y.jsx)(k.Button,{variant:"destructive",size:"icon",onClick:n,className:"h-12 w-12 rounded-full",children:(0,y.jsx)(eC,{className:"h-5 w-5"})})]})]}),(0,y.jsxs)(_.TabsContent,{value:"chat",className:"flex-1 m-0 flex flex-col bg-white",children:[(0,y.jsx)(O.ScrollArea,{className:"flex-1 p-4",children:(0,y.jsxs)("div",{className:"space-y-4",children:[0===$.length?(0,y.jsxs)("div",{className:"text-center text-gray-400 py-8",children:[(0,y.jsx)(eg.MessageSquare,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,y.jsx)("p",{children:"No messages yet"}),(0,y.jsx)("p",{className:"text-sm",children:"Start the conversation!"})]}):$.map(e=>(0,y.jsx)(eI,{message:e,isSelf:e.senderId===s},e.id)),(0,y.jsx)("div",{ref:z})]})}),(0,y.jsxs)("div",{className:"p-4 bg-gray-50 border-t",children:[(0,y.jsxs)("div",{className:"flex gap-2",children:[(0,y.jsx)(P.Input,{placeholder:"Type a message...",value:x,onChange:e=>v(e.target.value),onKeyDown:e=>"Enter"===e.key&&U(),className:"bg-white"}),(0,y.jsxs)(k.Button,{onClick:U,disabled:!x.trim(),className:"gap-2",children:[(0,y.jsx)(eM.Send,{className:"h-4 w-4"}),"Send"]})]}),(0,y.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:V?"Your messages will be visible to all students in this room":"Your messages will be visible to everyone in this room"})]})]}),(0,y.jsx)(_.TabsContent,{value:"participants",className:"flex-1 m-0 bg-white",children:(0,y.jsx)(O.ScrollArea,{className:"h-full p-4",children:(0,y.jsx)("div",{className:"space-y-2",children:0===e.participants.length?(0,y.jsxs)("div",{className:"text-center text-gray-400 py-8",children:[(0,y.jsx)(D.Users,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,y.jsx)("p",{children:"No participants in this room"})]}):e.participants.map(e=>(0,y.jsx)(eO,{participant:e},e.id))})})})]})})]})})}function eP({participant:e,isSelf:t=!1,index:s=0}){let r=["bg-red-500","bg-green-500","bg-yellow-500","bg-purple-500","bg-pink-500","bg-indigo-500"],a=t?"bg-blue-600":r[s%r.length];return(0,y.jsxs)("div",{className:"relative bg-gray-900 rounded-xl overflow-hidden aspect-video flex items-center justify-center",children:[(0,y.jsxs)("div",{className:"text-center",children:[(0,y.jsx)("div",{className:(0,L.cn)("w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-2",a),children:(0,y.jsx)("span",{className:"text-white text-2xl font-bold",children:e.name.charAt(0).toUpperCase()})}),(0,y.jsx)("p",{className:"text-white font-medium",children:e.name}),(0,y.jsxs)("div",{className:"flex items-center justify-center gap-1 mt-1",children:[t&&(0,y.jsx)(S.Badge,{variant:"outline",className:"text-blue-400 border-blue-400",children:"You"}),"tutor"===e.role&&(0,y.jsxs)(S.Badge,{variant:"outline",className:"text-yellow-400 border-yellow-400",children:[(0,y.jsx)(eT.Crown,{className:"h-3 w-3 mr-1"}),"Tutor"]})]})]}),(0,y.jsxs)("div",{className:"absolute bottom-3 left-3 flex gap-2",children:[e.isMuted&&(0,y.jsx)("div",{className:"bg-red-600 p-1.5 rounded-full",children:(0,y.jsx)(F.MicOff,{className:"h-4 w-4 text-white"})}),e.isVideoOff&&(0,y.jsx)("div",{className:"bg-red-600 p-1.5 rounded-full",children:(0,y.jsx)(ek,{className:"h-4 w-4 text-white"})}),e.isScreenSharing&&(0,y.jsx)("div",{className:"bg-blue-600 p-1.5 rounded-full",children:(0,y.jsx)(eS,{className:"h-4 w-4 text-white"})})]}),e.handRaised&&(0,y.jsx)("div",{className:"absolute top-3 right-3 bg-yellow-500 p-2 rounded-full animate-pulse",children:(0,y.jsx)(R.Hand,{className:"h-4 w-4 text-white"})}),!t&&(0,y.jsx)("div",{className:"absolute top-3 left-3",children:(0,y.jsxs)(S.Badge,{variant:"outline",className:(0,L.cn)("text-xs",e.engagementScore>=80?"bg-green-600/50 text-green-400 border-green-500":e.engagementScore>=50?"bg-yellow-600/50 text-yellow-400 border-yellow-500":"bg-red-600/50 text-red-400 border-red-500"),children:[e.engagementScore,"%"]})})]})}function eI({message:e,isSelf:t}){let s="ai"===e.senderRole||"system"===e.type;return(0,y.jsxs)("div",{className:(0,L.cn)("flex gap-3",t&&"flex-row-reverse",s&&"justify-center"),children:[!s&&(0,y.jsx)("div",{className:(0,L.cn)("w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold shrink-0",t?"bg-blue-600 text-white":"tutor"===e.senderRole?"bg-yellow-500 text-white":"bg-gray-200 text-gray-700"),children:e.senderName.charAt(0).toUpperCase()}),(0,y.jsxs)("div",{className:(0,L.cn)("max-w-[70%]",t&&"text-right",s&&"text-center w-full"),children:[!s&&(0,y.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,y.jsx)("span",{className:(0,L.cn)("text-sm font-medium",t?"text-blue-600":"tutor"===e.senderRole?"text-yellow-600":"text-gray-700"),children:e.senderName}),(0,y.jsx)("span",{className:"text-xs text-gray-400",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,y.jsx)("div",{className:(0,L.cn)("inline-block px-3 py-2 rounded-lg text-sm text-left",s?"bg-purple-100 text-purple-800 italic":t?"bg-blue-600 text-white":"tutor"===e.senderRole?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",e.isQuestion&&!t&&!s&&"border-l-4 border-yellow-500"),children:e.content})]})]})}function eO({participant:e}){return(0,y.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:(0,L.cn)("w-10 h-10 rounded-full flex items-center justify-center font-bold text-white","tutor"===e.role?"bg-yellow-500":e.isOnline?"bg-green-500":"bg-gray-400"),children:e.name.charAt(0).toUpperCase()}),(0,y.jsxs)("div",{children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("p",{className:"font-medium",children:e.name}),"tutor"===e.role&&(0,y.jsxs)(S.Badge,{variant:"outline",className:"text-[10px]",children:[(0,y.jsx)(eT.Crown,{className:"h-3 w-3 mr-1"}),"Tutor"]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,y.jsx)("span",{className:(0,L.cn)("w-2 h-2 rounded-full",e.isOnline?"bg-green-500":"bg-gray-400")}),e.isOnline?"Online":"Offline",e.handRaised&&(0,y.jsx)("span",{className:"text-yellow-600 flex items-center gap-1",children:"â€¢ Hand raised"})]})]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsxs)(S.Badge,{variant:"outline",className:(0,L.cn)("text-xs",e.engagementScore>=80?"text-green-600 border-green-500":e.engagementScore>=50?"text-yellow-600 border-yellow-500":"text-red-600 border-red-500"),children:[e.engagementScore,"% engaged"]}),"low"===e.attentionLevel&&(0,y.jsx)(S.Badge,{variant:"outline",className:"text-xs text-red-600 border-red-500",children:"Attention"})]})]})}var eL=e.i(604766);let eD=(0,ee.default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);function eR({handRaises:e,onAcknowledge:t,onAnswer:s}){let r=[...e].sort((e,t)=>{if(e.status!==t.status)return"pending"===e.status?-1:1;if(e.priority!==t.priority){let s={high:3,normal:2,low:1};return s[t.priority]-s[e.priority]}return new Date(e.raisedAt).getTime()-new Date(t.raisedAt).getTime()}),a=e.filter(e=>"pending"===e.status).length;return(0,y.jsxs)(A.Card,{className:"h-full flex flex-col",children:[(0,y.jsx)(A.CardHeader,{className:"pb-3",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(R.Hand,{className:"w-4 h-4"}),(0,y.jsx)(A.CardTitle,{className:"text-sm font-medium",children:"Hand Raises"})]}),a>0&&(0,y.jsxs)(S.Badge,{variant:"destructive",className:"text-xs",children:[a," Pending"]})]})}),(0,y.jsx)(A.CardContent,{className:"flex-1 p-0",children:0===r.length?(0,y.jsx)("div",{className:"h-full flex items-center justify-center text-center p-4",children:(0,y.jsxs)("div",{children:[(0,y.jsx)(R.Hand,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),(0,y.jsx)("p",{className:"text-sm text-gray-500",children:"No hand raises yet"}),(0,y.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Students can raise hands to ask questions"})]})}):(0,y.jsx)(O.ScrollArea,{className:"h-[calc(100%-60px)]",children:(0,y.jsx)("div",{className:"space-y-2 px-4 pb-4",children:r.map(e=>(0,y.jsx)("div",{className:(0,L.cn)("p-3 rounded-lg border transition-all","pending"===e.status?"bg-white border-yellow-200 shadow-sm":"acknowledged"===e.status?"bg-blue-50 border-blue-200":"bg-green-50 border-green-200 opacity-70"),children:(0,y.jsxs)("div",{className:"flex items-start gap-3",children:[(0,y.jsx)(I.Avatar,{className:"w-8 h-8",children:(0,y.jsx)(I.AvatarFallback,{className:"text-xs bg-blue-100 text-blue-700",children:e.studentName.split(" ").map(e=>e[0]).join("")})}),(0,y.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsx)("p",{className:"font-medium text-sm",children:e.studentName}),(e=>{switch(e){case"pending":return(0,y.jsx)(S.Badge,{variant:"outline",className:"animate-pulse",children:"Waiting"});case"acknowledged":return(0,y.jsx)(S.Badge,{variant:"secondary",children:"Acknowledged"});case"answered":return(0,y.jsx)(S.Badge,{variant:"default",className:"bg-green-600",children:"Answered"})}})(e.status)]}),(0,y.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,y.jsx)(S.Badge,{variant:"outline",className:(0,L.cn)("text-xs",(e=>{switch(e){case"high":return"bg-red-100 text-red-700 border-red-200";case"normal":return"bg-yellow-100 text-yellow-700 border-yellow-200";case"low":return"bg-blue-100 text-blue-700 border-blue-200";default:return"bg-gray-100 text-gray-700"}})(e.priority)),children:e.priority.charAt(0).toUpperCase()+e.priority.slice(1)}),(0,y.jsxs)("span",{className:"text-xs text-gray-500 flex items-center gap-1",children:[(0,y.jsx)(ei.Clock,{className:"w-3 h-3"}),(e=>{let t=Math.floor((Date.now()-new Date(e).getTime())/1e3);if(t<60)return`${t}s`;let s=Math.floor(t/60);return`${s}m ${t%60}s`})(e.raisedAt)]})]}),e.topic&&(0,y.jsxs)("p",{className:"text-xs text-gray-600 mt-2",children:["Topic: ",e.topic]}),"pending"===e.status&&(0,y.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,y.jsxs)(k.Button,{size:"sm",variant:"outline",className:"flex-1 text-xs",onClick:()=>t?.(e.id),children:[(0,y.jsx)(eD,{className:"w-3 h-3 mr-1"}),"Acknowledge"]}),(0,y.jsxs)(k.Button,{size:"sm",className:"flex-1 text-xs bg-green-600 hover:bg-green-700",onClick:()=>s?.(e.id),children:[(0,y.jsx)(eL.Check,{className:"w-3 h-3 mr-1"}),"Answer"]})]})]})]})},e.id))})})})]})}var eB=e.i(468158),eF=e.i(507881);let ez=(0,ee.default)("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),e$=(0,ee.default)("frown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),eV=(0,ee.default)("meh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);function eU({messages:e,students:t,socket:s,roomId:r,onPinMessage:a}){let[n,i]=(0,j.useState)("all"),[o,l]=(0,j.useState)(""),[c,d]=(0,j.useState)(e),u=(0,j.useRef)(null);(0,j.useEffect)(()=>{d(e)},[e]),(0,j.useEffect)(()=>{if(!s)return;let e=e=>{d(t=>[...t,{id:e.id,studentId:e.userId,studentName:e.name,content:e.text,timestamp:e.timestamp,sentiment:"neutral",isQuestion:e.text.includes("?")}])};return s.on("chat_message",e),()=>{s.off("chat_message",e)}},[s,t]),(0,j.useEffect)(()=>{u.current&&(u.current.scrollTop=u.current.scrollHeight)},[e]);let h=c.filter(e=>"questions"===n?e.isQuestion||"confused"===e.sentiment:"pinned"!==n||e.isPinned),m=c.filter(e=>e.isQuestion||"confused"===e.sentiment).length,p=c.filter(e=>e.isPinned).length,g=()=>{if(o.trim()){if(!s)return void E.toast.error("Not connected to class");s.emit("tutor_broadcast",{text:o,targetGroup:"all"}),d(e=>[...e,{id:`tutor-${Date.now()}`,studentId:"tutor",studentName:"You",content:o,timestamp:new Date().toISOString(),sentiment:"neutral"}]),l("")}};return(0,y.jsxs)(A.Card,{className:"h-full flex flex-col",children:[(0,y.jsxs)(A.CardHeader,{className:"pb-2",children:[(0,y.jsx)("div",{className:"flex items-center justify-between",children:(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(eg.MessageSquare,{className:"w-4 h-4"}),(0,y.jsx)(A.CardTitle,{className:"text-sm font-medium",children:"Chat"})]})}),(0,y.jsxs)("div",{className:"flex gap-1 mt-2",children:[(0,y.jsx)(k.Button,{variant:"all"===n?"default":"ghost",size:"sm",className:"flex-1 text-xs h-7",onClick:()=>i("all"),children:"All"}),(0,y.jsxs)(k.Button,{variant:"questions"===n?"default":"ghost",size:"sm",className:"flex-1 text-xs h-7",onClick:()=>i("questions"),children:[(0,y.jsx)(eE.HelpCircle,{className:"w-3 h-3 mr-1"}),"Questions (",m,")"]}),(0,y.jsxs)(k.Button,{variant:"pinned"===n?"default":"ghost",size:"sm",className:"flex-1 text-xs h-7",onClick:()=>i("pinned"),children:[(0,y.jsx)(eB.Pin,{className:"w-3 h-3 mr-1"}),"Pinned (",p,")"]})]})]}),(0,y.jsxs)(A.CardContent,{className:"flex-1 p-0 flex flex-col",children:[(0,y.jsx)(O.ScrollArea,{className:"flex-1 px-4",ref:u,children:(0,y.jsx)("div",{className:"space-y-3 py-2",children:0===h.length?(0,y.jsxs)("div",{className:"text-center py-8",children:[(0,y.jsx)(eg.MessageSquare,{className:"w-10 h-10 text-gray-300 mx-auto mb-2"}),(0,y.jsx)("p",{className:"text-sm text-gray-500",children:"questions"===n?"No questions yet":"pinned"===n?"No pinned messages":"No messages yet"})]}):h.map(e=>(0,y.jsx)("div",{className:(0,L.cn)("p-3 rounded-lg border text-sm",(e=>{switch(e){case"positive":return"bg-green-50 border-green-200";case"negative":return"bg-red-50 border-red-200";case"confused":return"bg-orange-50 border-orange-200";case"question":return"bg-blue-50 border-blue-200";default:return"bg-white"}})(e.sentiment),e.isPinned&&"border-yellow-300 shadow-sm"),children:(0,y.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("span",{className:"font-medium text-xs",children:e.studentName}),(e=>{switch(e){case"positive":return(0,y.jsx)(ez,{className:"w-3 h-3 text-green-500"});case"negative":return(0,y.jsx)(e$,{className:"w-3 h-3 text-red-500"});case"confused":return(0,y.jsx)(eu.AlertCircle,{className:"w-3 h-3 text-orange-500"});case"question":return(0,y.jsx)(eE.HelpCircle,{className:"w-3 h-3 text-blue-500"});default:return(0,y.jsx)(eV,{className:"w-3 h-3 text-gray-400"})}})(e.sentiment),e.isQuestion&&(0,y.jsx)(S.Badge,{variant:"outline",className:"text-xs px-1 py-0 h-4",children:"Question"})]}),(0,y.jsx)("p",{className:"mt-1 text-gray-700",children:e.content}),(0,y.jsx)("span",{className:"text-xs text-gray-400 mt-1",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,y.jsx)(k.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 shrink-0",onClick:()=>a?.(e.id),children:e.isPinned?(0,y.jsx)(eF.PinOff,{className:"w-3 h-3 text-yellow-600"}):(0,y.jsx)(eB.Pin,{className:"w-3 h-3 text-gray-400"})})]})},e.id))})}),(0,y.jsx)("div",{className:"p-3 border-t mt-auto",children:(0,y.jsxs)("div",{className:"flex gap-2",children:[(0,y.jsx)(P.Input,{placeholder:"Broadcast message...",value:o,onChange:e=>l(e.target.value),onKeyDown:e=>"Enter"===e.key&&g(),className:"flex-1 text-sm"}),(0,y.jsx)(k.Button,{size:"icon",onClick:g,children:(0,y.jsx)(eM.Send,{className:"w-4 h-4"})})]})})]})]})}var eq=e.i(10313),eH=e.i(476319),eJ=e.i(772686),eG=e.i(329134),eW=e.i(642304),eQ=e.i(31374);function eK({metrics:e,alerts:t}){let s=Math.round(e.veryEngaged/e.totalStudents*100),r=Math.round(e.engaged/e.totalStudents*100),a=Math.round(e.passive/e.totalStudents*100),n=Math.round(e.disengaged/e.totalStudents*100);return(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,y.jsx)(A.Card,{children:(0,y.jsxs)(A.CardContent,{className:"p-4",children:[(0,y.jsxs)("div",{className:"flex items-start justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Avg. Engagement"}),(0,y.jsxs)("p",{className:"text-2xl font-bold",children:[e.averageEngagement,"%"]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-1",children:[(e=>{switch(e){case"up":return(0,y.jsx)(eH.TrendingUp,{className:"w-4 h-4 text-green-500"});case"down":return(0,y.jsx)(eJ.TrendingDown,{className:"w-4 h-4 text-red-500"});default:return(0,y.jsx)(eG.Minus,{className:"w-4 h-4 text-gray-400"})}})(e.engagementTrend),(0,y.jsx)("span",{className:(0,L.cn)("text-xs font-medium","up"===e.engagementTrend?"text-green-600":"down"===e.engagementTrend?"text-red-600":"text-gray-600"),children:"up"===e.engagementTrend?"+5%":"down"===e.engagementTrend?"-3%":"0%"})]})]}),(0,y.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,y.jsx)(eW.Activity,{className:"w-3 h-3 text-gray-400"}),(0,y.jsx)("span",{className:"text-xs text-gray-500",children:"Last 5 min avg"})]})]})}),(0,y.jsx)(A.Card,{children:(0,y.jsxs)(A.CardContent,{className:"p-4",children:[(0,y.jsxs)("div",{className:"flex items-start justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Participation"}),(0,y.jsxs)("p",{className:"text-2xl font-bold",children:[e.participationRate,"%"]})]}),(0,y.jsx)(eg.MessageSquare,{className:"w-5 h-5 text-blue-500"})]}),(0,y.jsx)("div",{className:"mt-2 flex items-center gap-2",children:(0,y.jsxs)("span",{className:"text-xs text-gray-500",children:[e.totalChatMessages," messages sent"]})})]})}),(0,y.jsx)(A.Card,{children:(0,y.jsxs)(A.CardContent,{className:"p-4",children:[(0,y.jsxs)("div",{className:"flex items-start justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Active Students"}),(0,y.jsx)("p",{className:"text-2xl font-bold",children:e.activeStudents})]}),(0,y.jsx)(D.Users,{className:"w-5 h-5 text-green-500"})]}),(0,y.jsx)("div",{className:"mt-2",children:(0,y.jsxs)("span",{className:"text-xs text-gray-500",children:["of ",e.totalStudents," total"]})})]})}),(0,y.jsx)(A.Card,{children:(0,y.jsxs)(A.CardContent,{className:"p-4",children:[(0,y.jsxs)("div",{className:"flex items-start justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Class Duration"}),(0,y.jsxs)("p",{className:"text-2xl font-bold",children:[Math.floor(e.classDuration/60),":",(e.classDuration%60).toString().padStart(2,"0")]})]}),(0,y.jsx)(ei.Clock,{className:"w-5 h-5 text-purple-500"})]}),(0,y.jsx)("div",{className:"mt-2",children:(0,y.jsxs)("span",{className:"text-xs text-gray-500",children:["Started ",new Date(e.classStartTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})})]})})]}),(0,y.jsxs)(A.Card,{children:[(0,y.jsx)(A.CardHeader,{className:"pb-3",children:(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(eQ.PieChart,{className:"w-4 h-4"}),(0,y.jsx)(A.CardTitle,{className:"text-sm font-medium",children:"Engagement Distribution"})]})}),(0,y.jsx)(A.CardContent,{className:"pt-0",children:(0,y.jsxs)("div",{className:"space-y-3",children:[(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:"w-20 text-xs font-medium text-gray-600",children:"Very Engaged"}),(0,y.jsx)("div",{className:"flex-1 h-3 bg-gray-100 rounded-full overflow-hidden",children:(0,y.jsx)("div",{className:"h-full bg-green-500 rounded-full transition-all",style:{width:`${s}%`}})}),(0,y.jsxs)("span",{className:"w-10 text-xs text-right",children:[s,"%"]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:"w-20 text-xs font-medium text-gray-600",children:"Engaged"}),(0,y.jsx)("div",{className:"flex-1 h-3 bg-gray-100 rounded-full overflow-hidden",children:(0,y.jsx)("div",{className:"h-full bg-blue-500 rounded-full transition-all",style:{width:`${r}%`}})}),(0,y.jsxs)("span",{className:"w-10 text-xs text-right",children:[r,"%"]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:"w-20 text-xs font-medium text-gray-600",children:"Passive"}),(0,y.jsx)("div",{className:"flex-1 h-3 bg-gray-100 rounded-full overflow-hidden",children:(0,y.jsx)("div",{className:"h-full bg-yellow-500 rounded-full transition-all",style:{width:`${a}%`}})}),(0,y.jsxs)("span",{className:"w-10 text-xs text-right",children:[a,"%"]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:"w-20 text-xs font-medium text-gray-600",children:"Disengaged"}),(0,y.jsx)("div",{className:"flex-1 h-3 bg-gray-100 rounded-full overflow-hidden",children:(0,y.jsx)("div",{className:"h-full bg-red-500 rounded-full transition-all",style:{width:`${n}%`}})}),(0,y.jsxs)("span",{className:"w-10 text-xs text-right",children:[n,"%"]})]})]})})]}),(0,y.jsxs)(A.Card,{children:[(0,y.jsx)(A.CardHeader,{className:"pb-3",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(eq.Zap,{className:"w-4 h-4"}),(0,y.jsx)(A.CardTitle,{className:"text-sm font-medium",children:"Attention Alerts"})]}),t.filter(e=>!e.acknowledged).length>0&&(0,y.jsxs)(S.Badge,{variant:"destructive",className:"text-xs",children:[t.filter(e=>!e.acknowledged).length," Active"]})]})}),(0,y.jsx)(A.CardContent,{className:"pt-0",children:0===t.length?(0,y.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No alerts - class is going smoothly!"}):(0,y.jsx)("div",{className:"space-y-2",children:t.slice(0,5).map(e=>(0,y.jsx)("div",{className:(0,L.cn)("p-3 rounded-lg border text-sm",(e=>{switch(e){case"high":return"bg-red-100 text-red-700 border-red-200";case"medium":return"bg-orange-100 text-orange-700 border-orange-200";case"low":return"bg-blue-100 text-blue-700 border-blue-200";default:return"bg-gray-100 text-gray-700"}})(e.severity),!e.acknowledged&&"animate-pulse"),children:(0,y.jsxs)("div",{className:"flex items-start gap-2",children:[(0,y.jsx)(eu.AlertCircle,{className:"w-4 h-4 mt-0.5 shrink-0"}),(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"font-medium",children:e.title}),(0,y.jsx)("p",{className:"text-xs opacity-80 mt-0.5",children:e.message}),(0,y.jsx)("p",{className:"text-xs opacity-60 mt-1",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},e.id))})})]})]})}var eY=e.i(697126);let eX=(0,eY.createServerReference)("6075ea928940b65dcbc7525ac536b6af51f44c2ca9",eY.callServer,void 0,eY.findSourceMapURL,"saveLibraryTask"),eZ=(0,eY.createServerReference)("6017248195ec7c3ab658cb291969eb1d7204b818d2",eY.callServer,void 0,eY.findSourceMapURL,"toggleFavoriteTask"),e0=(0,eY.createServerReference)("605cbe0e97c422211686962a28abdc3076feaf4335",eY.callServer,void 0,eY.findSourceMapURL,"deleteLibraryTask"),e1=(0,eY.createServerReference)("40f91213c9db900c19d33be7a667f471dacdd61736",eY.callServer,void 0,eY.findSourceMapURL,"incrementTaskUsage");var e2=e.i(538998),e4=e.i(247583),e5=e.i(383918),e3=e.i(715042),e6=e.i(414009),e8=e.i(462423),e7=e.i(416982),e9=e.i(545078),te=e.i(712960),tt=e.i(102558),ts=e.i(437524),tr=e.i(376194);let ta=(0,ee.default)("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var tn=e.i(455103);let ti=(0,ee.default)("folder-heart",[["path",{d:"M10.638 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v3.417",key:"10r6g4"}],["path",{d:"M14.62 18.8A2.25 2.25 0 1 1 18 15.836a2.25 2.25 0 1 1 3.38 2.966l-2.626 2.856a.998.998 0 0 1-1.507 0z",key:"15cy7q"}]]),to=(0,ee.default)("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);var tl=e.i(104444),tc=e.i(694933);function td({groupSize:e,panelElement:t,styleProp:s}){let r,[a,n]=function(e){switch(typeof e){case"number":return[e,"px"];case"string":{let t=parseFloat(e);return e.endsWith("%")?[t,"%"]:e.endsWith("px")?[t,"px"]:e.endsWith("rem")?[t,"rem"]:e.endsWith("em")?[t,"em"]:e.endsWith("vh")?[t,"vh"]:e.endsWith("vw")?[t,"vw"]:[t,"%"]}}}(s);switch(n){case"%":r=a/100*e;break;case"px":r=a;break;case"rem":r=a*parseFloat(getComputedStyle(t.ownerDocument.body).fontSize);break;case"em":r=a*parseFloat(getComputedStyle(t).fontSize);break;case"vh":r=a/100*window.innerHeight;break;case"vw":r=a/100*window.innerWidth}return r}function tu(e){return parseFloat(e.toFixed(3))}function th({group:e}){let{orientation:t,panels:s}=e;return s.reduce((e,s)=>e+="horizontal"===t?s.element.offsetWidth:s.element.offsetHeight,0)}function tm(e){let{panels:t}=e,s=th({group:e});return 0===s?t.map(e=>({collapsedSize:0,collapsible:!0===e.panelConstraints.collapsible,defaultSize:void 0,disabled:e.panelConstraints.disabled,minSize:0,maxSize:100,panelId:e.id})):t.map(e=>{let t,{element:r,panelConstraints:a}=e,n=0;void 0!==a.collapsedSize&&(n=tu(td({groupSize:s,panelElement:r,styleProp:a.collapsedSize})/s*100)),void 0!==a.defaultSize&&(t=tu(td({groupSize:s,panelElement:r,styleProp:a.defaultSize})/s*100));let i=0;void 0!==a.minSize&&(i=tu(td({groupSize:s,panelElement:r,styleProp:a.minSize})/s*100));let o=100;return void 0!==a.maxSize&&(o=tu(td({groupSize:s,panelElement:r,styleProp:a.maxSize})/s*100)),{collapsedSize:n,collapsible:!0===a.collapsible,defaultSize:t,disabled:a.disabled,minSize:i,maxSize:o,panelId:e.id}})}function tp(e,t="Assertion error"){if(!e)throw Error(t)}function tg(e,t){return Array.from(t).sort("horizontal"===e?tf:tx)}function tf(e,t){let s=e.element.offsetLeft-t.element.offsetLeft;return 0!==s?s:e.element.offsetWidth-t.element.offsetWidth}function tx(e,t){let s=e.element.offsetTop-t.element.offsetTop;return 0!==s?s:e.element.offsetHeight-t.element.offsetHeight}function tv(e){return null!==e&&"object"==typeof e&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}function ty(e,t){return{x:e.x>=t.left&&e.x<=t.right?0:Math.min(Math.abs(e.x-t.left),Math.abs(e.x-t.right)),y:e.y>=t.top&&e.y<=t.bottom?0:Math.min(Math.abs(e.y-t.top),Math.abs(e.y-t.bottom))}}function tb(e){let{element:s,orientation:r,panels:a,separators:n}=e,i=tg(r,Array.from(s.children).filter(tv).map(e=>({element:e}))).map(({element:e})=>e),o=[],l=!1,c=!1,d=-1,u=-1,h=0,m,p=[];{let e=-1;for(let t of i)t.hasAttribute("data-panel")&&(e++,null===t.ariaDisabled&&(h++,-1===d&&(d=e),u=e))}if(h>1){let s=-1;for(let h of i)if(h.hasAttribute("data-panel")){s++;let n=a.find(e=>e.element===h);if(n){if(m){let a,i=m.element.getBoundingClientRect(),g=h.getBoundingClientRect();if(c){let e="horizontal"===r?new DOMRect(i.right,i.top,0,i.height):new DOMRect(i.left,i.bottom,i.width,0),t="horizontal"===r?new DOMRect(g.left,g.top,0,g.height):new DOMRect(g.left,g.top,g.width,0);switch(p.length){case 0:a=[e,t];break;case 1:{let s=p[0],n=function({orientation:e,rects:t,targetRect:s}){let r={x:s.x+s.width/2,y:s.y+s.height/2},a,n=Number.MAX_VALUE;for(let s of t){let{x:t,y:i}=ty(r,s),o="horizontal"===e?t:i;o<n&&(n=o,a=s)}return tp(a,"No rect found"),a}({orientation:r,rects:[i,g],targetRect:s.element.getBoundingClientRect()});a=[s,n===i?t:e];break}default:a=p}}else a=p.length?p:["horizontal"===r?new DOMRect(i.right,g.top,g.left-i.right,g.height):new DOMRect(g.left,i.bottom,g.width,g.top-i.bottom)];for(let r of a){let a="width"in r?r:r.element.getBoundingClientRect(),i=(void 0===t&&(t="function"==typeof matchMedia&&!!matchMedia("(pointer:coarse)").matches),t)?e.resizeTargetMinimumSize.coarse:e.resizeTargetMinimumSize.fine;if(a.width<i){let e=i-a.width;a=new DOMRect(a.x-e/2,a.y,a.width+e,a.height)}if(a.height<i){let e=i-a.height;a=new DOMRect(a.x,a.y-e/2,a.width,a.height+e)}let c=s<=d||s>u;l||c||o.push({group:e,groupSize:th({group:e}),panels:[m,n],separator:"width"in r?void 0:r,rect:a}),l=!1}}c=!1,m=n,p=[]}}else if(h.hasAttribute("data-separator")){null!==h.ariaDisabled&&(l=!0);let e=n.find(e=>e.element===h);e?p.push(e):(m=void 0,p=[])}else c=!0}return o}function tj(e,t,s=0){return Math.abs(tu(e)-tu(t))<=s}let tw={cursorFlags:0,interactionState:{state:"inactive"},mountedGroups:new Map},tN=new class{#e={};addListener(e,t){let s=this.#e[e];return void 0===s?this.#e[e]=[t]:s.includes(t)||s.push(t),()=>{this.removeListener(e,t)}}emit(e,t){let s=this.#e[e];if(void 0!==s)if(1===s.length)s[0].call(null,t);else{let e=!1,r=null,a=Array.from(s);for(let s=0;s<a.length;s++){let n=a[s];try{n.call(null,t)}catch(t){null===r&&(e=!0,r=t)}}if(e)throw r}}removeAllListeners(){this.#e={}}removeListener(e,t){let s=this.#e[e];if(void 0!==s){let e=s.indexOf(t);e>=0&&s.splice(e,1)}}};function tk(e){let t="function"==typeof e?e(tw):e;if(tw===t)return tw;let s=tw;return tw={...tw,...t},void 0!==t.cursorFlags&&tN.emit("cursorFlagsChange",tw.cursorFlags),void 0!==t.interactionState&&tN.emit("interactionStateChange",tw.interactionState),void 0!==t.mountedGroups&&(tw.mountedGroups.forEach((e,t)=>{e.derivedPanelConstraints.forEach(r=>{if(r.collapsible){let{layout:a}=s.mountedGroups.get(t)??{};if(a){let s=tj(r.collapsedSize,e.layout[r.panelId]),n=tj(r.collapsedSize,a[r.panelId]);s&&!n&&(t.inMemoryLastExpandedPanelSizes[r.panelId]=a[r.panelId])}}})}),tN.emit("mountedGroupsChange",tw.mountedGroups)),tw}let tS=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function t_(e){let t=e.length;for(;t--;){let s=e[t];if(tp(s,"Missing node"),function(e){let t,s=getComputedStyle(e);return!!("fixed"===s.position||"auto"!==s.zIndex&&("static"!==s.position||"flex"===(t=getComputedStyle(tT(e)??e).display)||"inline-flex"===t)||1>+s.opacity||"transform"in s&&"none"!==s.transform||"webkitTransform"in s&&"none"!==s.webkitTransform||"mixBlendMode"in s&&"normal"!==s.mixBlendMode||"filter"in s&&"none"!==s.filter||"webkitFilter"in s&&"none"!==s.webkitFilter||"isolation"in s&&"isolate"===s.isolation||tS.test(s.willChange)||"touch"===s.webkitOverflowScrolling)}(s))return s}return null}function tC(e){return e&&Number(getComputedStyle(e).zIndex)||0}function tM(e){let t=[];for(;e;)t.push(e),e=tT(e);return t}function tT(e){let{parentNode:t}=e;return null!==t&&"object"==typeof t&&"nodeType"in t&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.host:t}function tE(e,t){let s=[];return t.forEach((t,r)=>{if(r.disabled)return;let a=tb(r),n=function(e,t,s){let r,a={x:1/0,y:1/0};for(let n of t){let t=ty(s,n.rect);switch(e){case"horizontal":t.x<=a.x&&(r=n,a=t);break;case"vertical":t.y<=a.y&&(r=n,a=t)}}return r?{distance:a,hitRegion:r}:void 0}(r.orientation,a,{x:e.clientX,y:e.clientY});n&&n.distance.x<=0&&n.distance.y<=0&&function({groupElement:e,hitRegion:t,pointerEventTarget:s}){if(!tv(s)||s.contains(e)||e.contains(s))return!0;if(function(e,t){let s;if(e===t)throw Error("Cannot compare node with itself");let r={a:tM(e),b:tM(t)};for(;r.a.at(-1)===r.b.at(-1);)s=r.a.pop(),r.b.pop();tp(s,"Stacking order can only be calculated for elements with a common ancestor");let a={a:tC(t_(r.a)),b:tC(t_(r.b))};if(a.a===a.b){let e=s.childNodes,t={a:r.a.at(-1),b:r.b.at(-1)},a=e.length;for(;a--;){let s=e[a];if(s===t.a)return 1;if(s===t.b)return -1}}return Math.sign(a.a-a.b)}(s,e)>0){let a=s;for(;a;){var r;if(a.contains(e))break;if(r=a.getBoundingClientRect(),r.x<t.x+t.width&&r.x+r.width>t.x&&r.y<t.y+t.height&&r.y+r.height>t.y)return!1;a=a.parentElement}}return!0}({groupElement:r.element,hitRegion:n.hitRegion.rect,pointerEventTarget:e.target})&&s.push(n.hitRegion)}),s}function tA(e,t){return tj(e,t)?0:e>t?1:-1}function tP({overrideDisabledPanels:e,panelConstraints:t,prevSize:s,size:r}){let{collapsedSize:a=0,collapsible:n,disabled:i,maxSize:o=100,minSize:l=0}=t;return i&&!e?s:(0>tA(r,l)&&(r=n&&0>tA(r,(a+l)/2)?a:l),tu(r=Math.min(o,r)))}function tI({delta:e,initialLayout:t,panelConstraints:s,pivotIndices:r,prevLayout:a,trigger:n}){if(tj(e,0))return t;let i="imperative-api"===n,o=Object.values(t),l=Object.values(a),c=[...o],[d,u]=r;tp(null!=d,"Invalid first pivot index"),tp(null!=u,"Invalid second pivot index");let h=0;if("keyboard"===n){{let t=e<0?u:d,r=s[t];tp(r,`Panel constraints not found for index ${t}`);let{collapsedSize:a=0,collapsible:n,minSize:i=0}=r;if(n){let s=o[t];if(tp(null!=s,`Previous layout not found for panel index ${t}`),tj(s,a)){let t=i-s;tA(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}{let t=e<0?d:u,r=s[t];tp(r,`No panel constraints found for index ${t}`);let{collapsedSize:a=0,collapsible:n,minSize:i=0}=r;if(n){let s=o[t];if(tp(null!=s,`Previous layout not found for panel index ${t}`),tj(s,i)){let t=s-a;tA(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}}else{let t=e<0?u:d,r=s[t];tp(r,`Panel constraints not found for index ${t}`);let a=o[t],{collapsible:n,collapsedSize:i,minSize:l}=r;if(n&&0>tA(a,l))if(e>0){let t=l-i;0>tA(a+e,l)&&(e=0>=tA(e,t/2)?0:t)}else{let t=l-i;0>tA(a-e,l)&&(e=tA(100+e,100-t/2)>0?0:-t)}}{let t=e<0?1:-1,r=e<0?u:d,a=0;for(;;){let e=o[r];if(tp(null!=e,`Previous layout not found for panel index ${r}`),a+=tP({overrideDisabledPanels:i,panelConstraints:s[r],prevSize:e,size:100})-e,(r+=t)<0||r>=s.length)break}let n=Math.min(Math.abs(e),Math.abs(a));e=e<0?0-n:n}{let t=e<0?d:u;for(;t>=0&&t<s.length;){let r=Math.abs(e)-Math.abs(h),a=o[t];tp(null!=a,`Previous layout not found for panel index ${t}`);let n=a-r,l=tP({overrideDisabledPanels:i,panelConstraints:s[t],prevSize:a,size:n});if(!tj(a,l)&&(h+=a-l,c[t]=l,h.toFixed(3).localeCompare(Math.abs(e).toFixed(3),void 0,{numeric:!0})>=0))break;e<0?t--:t++}}if(function(e,t){if(e.length!==t.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!=t[s])return!1;return!0}(l,c))return a;{let t=e<0?u:d,r=o[t];tp(null!=r,`Previous layout not found for panel index ${t}`);let a=r+h,n=tP({overrideDisabledPanels:i,panelConstraints:s[t],prevSize:r,size:a});if(c[t]=n,!tj(n,a)){let t=a-n,r=e<0?u:d;for(;r>=0&&r<s.length;){let a=c[r];tp(null!=a,`Previous layout not found for panel index ${r}`);let n=a+t,o=tP({overrideDisabledPanels:i,panelConstraints:s[r],prevSize:a,size:n});if(tj(a,o)||(t-=o-a,c[r]=o),tj(t,0))break;e>0?r--:r++}}}if(!tj(Object.values(c).reduce((e,t)=>t+e,0),100,.1))return a;let m=Object.keys(a);return c.reduce((e,t,s)=>(e[m[s]]=t,e),{})}function tO(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let s in e)if(void 0===t[s]||0!==tA(e[s],t[s]))return!1;return!0}function tL({layout:e,panelConstraints:t}){let s=Object.values(e),r=[...s],a=r.reduce((e,t)=>e+t,0);if(r.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${r.map(e=>`${e}%`).join(", ")}`);if(!tj(a,100)&&r.length>0)for(let e=0;e<t.length;e++){let t=r[e];tp(null!=t,`No layout data found for index ${e}`);let s=100/a*t;r[e]=s}let n=0;for(let e=0;e<t.length;e++){let a=s[e];tp(null!=a,`No layout data found for index ${e}`);let i=r[e];tp(null!=i,`No layout data found for index ${e}`);let o=tP({overrideDisabledPanels:!0,panelConstraints:t[e],prevSize:a,size:i});i!=o&&(n+=i-o,r[e]=o)}if(!tj(n,0))for(let e=0;e<t.length;e++){let s=r[e];tp(null!=s,`No layout data found for index ${e}`);let a=s+n,i=tP({overrideDisabledPanels:!0,panelConstraints:t[e],prevSize:s,size:a});if(s!==i&&(n-=i-s,r[e]=i,tj(n,0)))break}let i=Object.keys(e);return r.reduce((e,t,s)=>(e[i[s]]=t,e),{})}function tD({groupId:e,panelId:t}){let s=()=>{let{mountedGroups:t}=tw;for(let[s,{defaultLayoutDeferred:r,derivedPanelConstraints:a,layout:n,separatorToPanels:i}]of t)if(s.id===e)return{defaultLayoutDeferred:r,derivedPanelConstraints:a,group:s,layout:n,separatorToPanels:i};throw Error(`Group ${e} not found`)},r=()=>{let e=s().derivedPanelConstraints.find(e=>e.panelId===t);if(void 0!==e)return e;throw Error(`Panel constraints not found for Panel ${t}`)},a=()=>{let e=s().group.panels.find(e=>e.id===t);if(void 0!==e)return e;throw Error(`Layout not found for Panel ${t}`)},n=()=>{let e=s().layout[t];if(void 0!==e)return e;throw Error(`Layout not found for Panel ${t}`)},i=e=>{let r=n();if(e===r)return;let{defaultLayoutDeferred:a,derivedPanelConstraints:i,group:o,layout:l,separatorToPanels:c}=s(),d=o.panels.findIndex(e=>e.id===t),u=d===o.panels.length-1,h=tL({layout:tI({delta:u?r-e:e-r,initialLayout:l,panelConstraints:i,pivotIndices:u?[d-1,d]:[d,d+1],prevLayout:l,trigger:"imperative-api"}),panelConstraints:i});tO(l,h)||tk(e=>({mountedGroups:new Map(e.mountedGroups).set(o,{defaultLayoutDeferred:a,derivedPanelConstraints:i,layout:h,separatorToPanels:c})}))};return{collapse:()=>{let{collapsible:e,collapsedSize:t}=r(),{mutableValues:s}=a(),o=n();e&&o!==t&&(s.expandToSize=o,i(t))},expand:()=>{let{collapsible:e,collapsedSize:t,minSize:s}=r(),{mutableValues:o}=a(),l=n();if(e&&l===t){let e=o.expandToSize??s;0===e&&(e=1),i(e)}},getSize:()=>{let{group:e}=s(),t=n(),{element:r}=a();return{asPercentage:t,inPixels:"horizontal"===e.orientation?r.offsetWidth:r.offsetHeight}},isCollapsed:()=>{let{collapsible:e,collapsedSize:t}=r(),s=n();return e&&tj(t,s)},resize:e=>{if(n()!==e){let t;switch(typeof e){case"number":{let{group:r}=s();t=tu(e/th({group:r})*100);break}case"string":t=parseFloat(e)}i(t)}}}}function tR(e){if(e.defaultPrevented)return;let{mountedGroups:t}=tw;tE(e,t).forEach(t=>{if(t.separator){let s=t.panels.find(e=>void 0!==e.panelConstraints.defaultSize);if(s){let r=s.panelConstraints.defaultSize,a=tD({groupId:t.group.id,panelId:s.id});a&&void 0!==r&&(a.resize(r),e.preventDefault())}}})}function tB(e){let{mountedGroups:t}=tw;for(let[s]of t)if(s.separators.some(t=>t.element===e))return s;throw Error("Could not find parent Group for separator element")}function tF({groupId:e}){let t=()=>{let{mountedGroups:t}=tw;for(let[s,r]of t)if(s.id===e)return{group:s,...r};throw Error(`Could not find Group with id "${e}"`)};return{getLayout(){let{defaultLayoutDeferred:e,layout:s}=t();return e?{}:s},setLayout(e){let{defaultLayoutDeferred:s,derivedPanelConstraints:r,group:a,layout:n,separatorToPanels:i}=t(),o=tL({layout:e,panelConstraints:r});if(s)return n;if(!tO(n,o)){tk(e=>({mountedGroups:new Map(e.mountedGroups).set(a,{defaultLayoutDeferred:s,derivedPanelConstraints:r,layout:o,separatorToPanels:i})}));let e=a.panels.map(({id:e})=>e).join(",");a.inMemoryLayouts[e]=o}return o}}}function tz(e){let{mountedGroups:t}=tw,s=t.get(e);return tp(s,`Mounted Group ${e.id} not found`),s}function t$(e,t){let s=tB(e),r=tz(s),a=s.separators.find(t=>t.element===e);tp(a,"Matching separator not found");let n=r.separatorToPanels.get(a);tp(n,"Matching panels not found");let i=n.map(e=>s.panels.indexOf(e)),o=tF({groupId:s.id}).getLayout(),l=tL({layout:tI({delta:t,initialLayout:o,panelConstraints:r.derivedPanelConstraints,pivotIndices:i,prevLayout:o,trigger:"keyboard"}),panelConstraints:r.derivedPanelConstraints});tO(o,l)||tk(e=>({mountedGroups:new Map(e.mountedGroups).set(s,{defaultLayoutDeferred:r.defaultLayoutDeferred,derivedPanelConstraints:r.derivedPanelConstraints,layout:l,separatorToPanels:r.separatorToPanels})}))}function tV(e){if(e.defaultPrevented)return;let t=e.currentTarget,s=tB(t);if(!s.disabled)switch(e.key){case"ArrowDown":e.preventDefault(),"vertical"===s.orientation&&t$(t,5);break;case"ArrowLeft":e.preventDefault(),"horizontal"===s.orientation&&t$(t,-5);break;case"ArrowRight":e.preventDefault(),"horizontal"===s.orientation&&t$(t,5);break;case"ArrowUp":e.preventDefault(),"vertical"===s.orientation&&t$(t,-5);break;case"End":e.preventDefault(),t$(t,100);break;case"Enter":{e.preventDefault();let s=tB(t),{derivedPanelConstraints:r,layout:a,separatorToPanels:n}=tz(s),i=s.separators.find(e=>e.element===t);tp(i,"Matching separator not found");let o=n.get(i);tp(o,"Matching panels not found");let l=o[0],c=r.find(e=>e.panelId===l.id);if(tp(c,"Panel metadata not found"),c.collapsible){let e=a[l.id];t$(t,(c.collapsedSize===e?s.inMemoryLastExpandedPanelSizes[l.id]??c.minSize:c.collapsedSize)-e)}break}case"F6":{e.preventDefault();let s=tB(t).separators.map(e=>e.element),r=Array.from(s).findIndex(t=>t===e.currentTarget);tp(null!==r,"Index not found");let a=e.shiftKey?r>0?r-1:s.length-1:r+1<s.length?r+1:0;s[a].focus();break}case"Home":e.preventDefault(),t$(t,-100)}}function tU(e){if(e.defaultPrevented||"mouse"===e.pointerType&&e.button>0)return;let{mountedGroups:t}=tw,s=tE(e,t),r=new Map,a=!1;s.forEach(e=>{e.separator&&(a||(a=!0,e.separator.element.focus()));let s=t.get(e.group);s&&r.set(e.group,s.layout)}),tk({interactionState:{hitRegions:s,initialLayoutMap:r,pointerDownAtPoint:{x:e.clientX,y:e.clientY},state:"active"}}),s.length&&e.preventDefault()}let tq=e=>e,tH=()=>{};function tJ(){return void 0===s&&(s=!1,"u">typeof window&&(window.navigator.userAgent.includes("Chrome")||window.navigator.userAgent.includes("Firefox"))&&(s=!0)),s}let tG=new WeakMap;function tW(e){if(null===e.defaultView||void 0===e.defaultView)return;let{prevStyle:t,styleSheet:s}=tG.get(e)??{};void 0===s&&(s=new e.defaultView.CSSStyleSheet,e.adoptedStyleSheets.push(s));let{cursorFlags:r,interactionState:a}=tw;switch(a.state){case"active":case"hover":{let e=function({cursorFlags:e,groups:t,state:s}){let r=0,a=0;switch(s){case"active":case"hover":t.forEach(e=>{if(!e.disableCursor)switch(e.orientation){case"horizontal":r++;break;case"vertical":a++}})}if(0!==r||0!==a){if("active"===s&&e&&tJ()){let t=(4&e)!=0,s=(8&e)!=0;if((1&e)!=0)return t?"se-resize":s?"ne-resize":"e-resize";if((2&e)!=0)return t?"sw-resize":s?"nw-resize":"w-resize";if(t)return"s-resize";if(s)return"n-resize"}return tJ()?r>0&&a>0?"move":r>0?"ew-resize":"ns-resize":r>0&&a>0?"grab":r>0?"col-resize":"row-resize"}}({cursorFlags:r,groups:a.hitRegions.map(e=>e.group),state:a.state}),n=`*, *:hover {cursor: ${e} !important; }`;if(t===n)return;t=n,e?0===s.cssRules.length?s.insertRule(n):s.replaceSync(n):1===s.cssRules.length&&s.deleteRule(0);break}case"inactive":t=void 0,1===s.cssRules.length&&s.deleteRule(0)}tG.set(e,{prevStyle:t,styleSheet:s})}function tQ({document:e,event:t,hitRegions:s,initialLayoutMap:r,mountedGroups:a,pointerDownAtPoint:n,prevCursorFlags:i}){let o=0,l=new Map(a);s.forEach(e=>{let{group:s,groupSize:i}=e,{disableCursor:c,orientation:d,panels:u}=s,h=0;h=n?"horizontal"===d?(t.clientX-n.x)/i*100:(t.clientY-n.y)/i*100:"horizontal"===d?t.clientX<0?-100:100:t.clientY<0?-100:100;let m=r.get(s),{defaultLayoutDeferred:p,derivedPanelConstraints:g,layout:f,separatorToPanels:x}=a.get(s)??{defaultLayoutDeferred:!1};if(g&&m&&f&&x){let t=tI({delta:h,initialLayout:m,panelConstraints:g,pivotIndices:e.panels.map(e=>u.indexOf(e)),prevLayout:f,trigger:"mouse-or-touch"});if(tO(t,f)){if(0!==h&&!c)switch(d){case"horizontal":o|=h<0?1:2;break;case"vertical":o|=h<0?4:8}}else{l.set(e.group,{defaultLayoutDeferred:p,derivedPanelConstraints:g,layout:t,separatorToPanels:x});let s=e.group.panels.map(({id:e})=>e).join(",");e.group.inMemoryLayouts[s]=t}}});let c=0;0===t.movementX?c|=3&i:c|=3&o,0===t.movementY?c|=12&i:c|=12&o,tk({cursorFlags:c,mountedGroups:l}),tW(e)}function tK(e){let{cursorFlags:t,interactionState:s,mountedGroups:r}=tw;"active"===s.state&&tQ({document:e.currentTarget,event:e,hitRegions:s.hitRegions,initialLayoutMap:s.initialLayoutMap,mountedGroups:r,prevCursorFlags:t})}function tY(e){if(e.defaultPrevented)return;let{cursorFlags:t,interactionState:s,mountedGroups:r}=tw;if("active"===s.state){if(0===e.buttons){tk(e=>"inactive"===e.interactionState.state?e:{cursorFlags:0,interactionState:{state:"inactive"}}),tk(e=>({mountedGroups:new Map(e.mountedGroups)}));return}tQ({document:e.currentTarget,event:e,hitRegions:s.hitRegions,initialLayoutMap:s.initialLayoutMap,mountedGroups:r,pointerDownAtPoint:s.pointerDownAtPoint,prevCursorFlags:t})}else{let t=tE(e,r);0===t.length?"inactive"!==s.state&&tk({interactionState:{state:"inactive"}}):tk({interactionState:{hitRegions:t,state:"hover"}}),tW(e.currentTarget)}}function tX(e){if(e.relatedTarget instanceof HTMLIFrameElement){let{interactionState:e}=tw;"hover"===e.state&&tk({interactionState:{state:"inactive"}})}}function tZ(e){if(e.defaultPrevented||"mouse"===e.pointerType&&e.button>0)return;let{interactionState:t}=tw;"active"===t.state&&(tk({cursorFlags:0,interactionState:{state:"inactive"}}),t.hitRegions.length>0&&(tW(e.currentTarget),tk(e=>({mountedGroups:new Map(e.mountedGroups)})),e.preventDefault()))}function t0(e){let t=0,s=0,r={};for(let a of e)if(void 0!==a.defaultSize){t++;let e=tu(a.defaultSize);s+=e,r[a.panelId]=e}else r[a.panelId]=void 0;let a=e.length-t;if(0!==a){let t=tu((100-s)/a);for(let s of e)void 0===s.defaultSize&&(r[s.panelId]=t)}return r}let t1=new Map;function t2(e){let t=(0,j.useId)();return`${e??t}`}let t4="u">typeof window?j.useLayoutEffect:j.useEffect;function t5(e){let t=(0,j.useRef)(e);return t4(()=>{t.current=e},[e]),(0,j.useCallback)((...e)=>t.current?.(...e),[t])}function t3(...e){return t5(t=>{e.forEach(e=>{if(e)switch(typeof e){case"function":e(t);break;case"object":e.current=t}})})}function t6(e){let t=(0,j.useRef)({...e});return t4(()=>{for(let s in e)t.current[s]=e[s]},[e]),t.current}let t8=(0,j.createContext)(null);function t7({children:e,className:t,defaultLayout:s,disableCursor:r,disabled:a,elementRef:n,groupRef:i,id:o,onLayoutChange:l,onLayoutChanged:c,orientation:d="horizontal",resizeTargetMinimumSize:u={coarse:20,fine:10},style:h,...m}){let p,g=(0,j.useRef)({onLayoutChange:{},onLayoutChanged:{}}),f=t5(e=>{tO(g.current.onLayoutChange,e)||(g.current.onLayoutChange=e,l?.(e))}),x=t5(e=>{tO(g.current.onLayoutChanged,e)||(g.current.onLayoutChanged=e,c?.(e))}),v=t2(o),b=(0,j.useRef)(null),[w,N]=function(){let[e,t]=(0,j.useState)({});return[e,(0,j.useCallback)(()=>t({}),[])]}(),k=(0,j.useRef)({lastExpandedPanelSizes:{},layouts:{},panels:[],resizeTargetMinimumSize:u,separators:[]}),S=t3(b,n);p=(0,j.useRef)({getLayout:()=>({}),setLayout:tq}),(0,j.useImperativeHandle)(i,()=>p.current,[]),t4(()=>{Object.assign(p.current,tF({groupId:v}))});let _=t5((e,t)=>{let{interactionState:r,mountedGroups:a}=tw;for(let s of a.keys())if(s.id===e){let e=a.get(s);if(e){let a=!1;return"active"===r.state&&(a=r.hitRegions.some(e=>e.group===s)),{flexGrow:e.layout[t]??1,pointerEvents:a?"none":void 0}}}return{flexGrow:s?.[t]??1}}),C=t6({defaultLayout:s,disableCursor:r}),M=(0,j.useMemo)(()=>({get disableCursor(){return!!C.disableCursor},getPanelStyles:_,id:v,orientation:d,registerPanel:e=>{let t=k.current;return t.panels=tg(d,[...t.panels,e]),N(),()=>{t.panels=t.panels.filter(t=>t!==e),N()}},registerSeparator:e=>{let t=k.current;return t.separators=tg(d,[...t.separators,e]),N(),()=>{t.separators=t.separators.filter(t=>t!==e),N()}},togglePanelDisabled:(e,t)=>{let s=k.current.panels.find(t=>t.id===e);s&&(s.panelConstraints.disabled=t);let{mountedGroups:r}=tw;for(let e of r.keys())if(e.id===v){let t=r.get(e);t&&(t.derivedPanelConstraints=tm(e))}},toggleSeparatorDisabled:(e,t)=>{let s=k.current.separators.find(t=>t.id===e);s&&(s.disabled=t)}}),[_,v,N,d,C]),T=(0,j.useRef)(null);return t4(()=>{let e,t,s,r,n,i,o,l,c,u,h,m,p,g=b.current;if(null===g)return;let y=k.current;if(void 0!==C.defaultLayout&&Object.keys(C.defaultLayout).length===y.panels.length)for(let t of(e={},y.panels)){let s=C.defaultLayout[t.id];void 0!==s&&(e[t.id]=s)}let j={defaultLayout:e,disableCursor:!!C.disableCursor,disabled:!!a,element:g,id:v,inMemoryLastExpandedPanelSizes:k.current.lastExpandedPanelSizes,inMemoryLayouts:k.current.layouts,orientation:d,panels:y.panels,resizeTargetMinimumSize:y.resizeTargetMinimumSize,separators:y.separators};T.current=j;let w=(t=!0,tp(j.element.ownerDocument.defaultView,"Cannot register an unmounted Group"),s=j.element.ownerDocument.defaultView.ResizeObserver,r=new Set,n=new Set,(i=new s(e=>{for(let s of e){let{borderBoxSize:e,target:r}=s;if(r===j.element){if(t){if(0===th({group:j}))return;tk(e=>{let t=e.mountedGroups.get(j);if(t){let s=tm(j),r=t.defaultLayoutDeferred?t0(s):t.layout,a=tL({layout:r,panelConstraints:s});return!t.defaultLayoutDeferred&&tO(r,a)&&function(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let s in e)if(e[s]!==t[s])return!1;return!0}(t.derivedPanelConstraints,s)?e:{mountedGroups:new Map(e.mountedGroups).set(j,{defaultLayoutDeferred:!1,derivedPanelConstraints:s,layout:a,separatorToPanels:t.separatorToPanels})}}return e})}}else!function(e,t,s){if(!s[0])return;let r=e.panels.find(e=>e.element===t);if(!r||!r.onResize)return;let a=th({group:e}),n="horizontal"===e.orientation?r.element.offsetWidth:r.element.offsetHeight,i=r.mutableValues.prevSize,o={asPercentage:tu(n/a*100),inPixels:n};r.mutableValues.prevSize=o,r.onResize(o,r.id,i)}(j,r,e)}})).observe(j.element),j.panels.forEach(e=>{tp(!r.has(e.id),`Panel ids must be unique; id "${e.id}" was used more than once`),r.add(e.id),e.onResize&&i.observe(e.element)}),o=th({group:j}),l=tm(j),c=j.panels.map(({id:e})=>e).join(","),(u=j.defaultLayout)&&(function(e,t){let s=e.map(e=>e.id),r=Object.keys(t);if(s.length!==r.length)return!1;for(let e of s)if(!r.includes(e))return!1;return!0}(j.panels,u)||(u=void 0)),h=tL({layout:j.inMemoryLayouts[c]??u??t0(l),panelConstraints:l}),m=tb(j),p=j.element.ownerDocument,tk(e=>{let t=new Map;return t1.set(p,(t1.get(p)??0)+1),m.forEach(e=>{e.separator&&t.set(e.separator,e.panels)}),{mountedGroups:new Map(e.mountedGroups).set(j,{defaultLayoutDeferred:0===o,derivedPanelConstraints:l,layout:h,separatorToPanels:t})}}),j.separators.forEach(e=>{tp(!n.has(e.id),`Separator ids must be unique; id "${e.id}" was used more than once`),n.add(e.id),e.element.addEventListener("keydown",tV)}),1===t1.get(p)&&(p.addEventListener("dblclick",tR,!0),p.addEventListener("pointerdown",tU,!0),p.addEventListener("pointerleave",tK),p.addEventListener("pointermove",tY),p.addEventListener("pointerout",tX),p.addEventListener("pointerup",tZ,!0)),function(){t=!1,t1.set(p,Math.max(0,(t1.get(p)??0)-1)),tk(e=>{let t=new Map(e.mountedGroups);return t.delete(j),{mountedGroups:t}}),j.separators.forEach(e=>{e.element.removeEventListener("keydown",tV)}),t1.get(p)||(p.removeEventListener("dblclick",tR,!0),p.removeEventListener("pointerdown",tU,!0),p.removeEventListener("pointerleave",tK),p.removeEventListener("pointermove",tY),p.removeEventListener("pointerout",tX),p.removeEventListener("pointerup",tZ,!0)),i.disconnect()}),N=tw.mountedGroups.get(j);if(N){let{defaultLayoutDeferred:e,derivedPanelConstraints:t,layout:s}=N;!e&&t.length>0&&(f(s),x(s))}let S=tN.addListener("interactionStateChange",e=>{e.state}),_=tN.addListener("mountedGroupsChange",e=>{let t=e.get(j);if(t){let{defaultLayoutDeferred:e,derivedPanelConstraints:s,layout:r}=t;if(e||0===s.length)return;let{interactionState:a}=tw,n="active"!==a.state;f(r),n&&x(r)}});return()=>{T.current=null,w(),S(),_()}},[a,v,x,f,d,w,C]),(0,j.useEffect)(()=>{let e=T.current;e&&(e.defaultLayout=s,e.disableCursor=!!r)}),(0,y.jsx)(t8.Provider,{value:M,children:(0,y.jsx)("div",{...m,className:t,"data-group":!0,"data-testid":v,id:v,ref:S,style:{height:"100%",width:"100%",overflow:"hidden",...h,display:"flex",flexDirection:"horizontal"===d?"row":"column",flexWrap:"nowrap",touchAction:"horizontal"===d?"pan-y":"pan-x"},children:e})})}function t9(){let e=(0,j.useContext)(t8);return tp(e,"Group Context not found; did you render a Panel or Separator outside of a Group?"),e}function se({children:e,className:t,collapsedSize:s="0%",collapsible:r=!1,defaultSize:a,disabled:n,elementRef:i,id:o,maxSize:l="100%",minSize:c="0%",onResize:d,panelRef:u,style:h,...m}){let p=!!o,g=t2(o),f=t6({disabled:n}),x=(0,j.useRef)(null),v=t3(x,i),{getPanelStyles:b,id:w,orientation:N,registerPanel:k,togglePanelDisabled:S}=t9(),_=null!==d,C=t5((e,t,s)=>{d?.(e,o,s)});t4(()=>{let e=x.current;if(null!==e)return k({element:e,id:g,idIsStable:p,mutableValues:{expandToSize:void 0,prevSize:void 0},onResize:_?C:void 0,panelConstraints:{collapsedSize:s,collapsible:r,defaultSize:a,disabled:f.disabled,maxSize:l,minSize:c}})},[s,r,a,_,g,p,l,c,C,k,f]),(0,j.useEffect)(()=>{S(g,!!n)},[n,g,S]),function(e,t){let{id:s}=t9(),r=(0,j.useRef)({collapse:tH,expand:tH,getSize:()=>({asPercentage:0,inPixels:0}),isCollapsed:()=>!1,resize:tH});(0,j.useImperativeHandle)(t,()=>r.current,[]),t4(()=>{Object.assign(r.current,tD({groupId:s,panelId:e}))})}(g,u);let M=(0,j.useSyncExternalStore)(e=>(tN.addListener("mountedGroupsChange",e),()=>{tN.removeListener("mountedGroupsChange",e)}),()=>JSON.stringify(b(w,g)),()=>JSON.stringify(b(w,g)));return(0,y.jsx)("div",{...m,"aria-disabled":n||void 0,"data-panel":!0,"data-testid":g,id:g,ref:v,style:{...st,display:"flex",flexBasis:0,flexShrink:1,overflow:"hidden",...JSON.parse(M)},children:(0,y.jsx)("div",{className:t,style:{maxHeight:"100%",maxWidth:"100%",flexGrow:1,...h,touchAction:"horizontal"===N?"pan-y":"pan-x"},children:e})})}t7.displayName="Group",se.displayName="Panel";let st={minHeight:0,maxHeight:"100%",height:"auto",minWidth:0,maxWidth:"100%",width:"auto",border:"none",borderWidth:0,padding:0,margin:0};function ss({children:e,className:t,disabled:s,elementRef:r,id:a,style:n,...i}){let o,l=t2(a),c=t6({disabled:s}),[d,u]=(0,j.useState)({}),[h,m]=(0,j.useState)("inactive"),p=(0,j.useRef)(null),g=t3(p,r),{disableCursor:f,id:x,orientation:v,registerSeparator:b,toggleSeparatorDisabled:w}=t9();return t4(()=>{let e=p.current;if(null!==e){let t={disabled:c.disabled,element:e,id:l},s=b(t),r=tN.addListener("interactionStateChange",e=>{m("inactive"!==e.state&&e.hitRegions.some(e=>e.separator===t)?e.state:"inactive")}),a=tN.addListener("mountedGroupsChange",e=>{e.forEach(({derivedPanelConstraints:e,layout:s,separatorToPanels:r},a)=>{if(a.id===x){let n=r.get(t);if(n){let t=n[0],r=a.panels.indexOf(t);u(function({layout:e,panelConstraints:t,panelId:s,panelIndex:r}){let a,n,i=e[s],o=t.find(e=>e.panelId===s);if(o){let l=o.maxSize,c=o.collapsible?o.collapsedSize:o.minSize,d=[r,r+1];n=tL({layout:tI({delta:c-i,initialLayout:e,panelConstraints:t,pivotIndices:d,prevLayout:e}),panelConstraints:t})[s],a=tL({layout:tI({delta:l-i,initialLayout:e,panelConstraints:t,pivotIndices:d,prevLayout:e}),panelConstraints:t})[s]}return{valueControls:s,valueMax:a,valueMin:n,valueNow:i}}({layout:s,panelConstraints:e,panelId:t.id,panelIndex:r}))}}})});return()=>{r(),a(),s()}}},[x,l,b,c]),(0,j.useEffect)(()=>{w(l,!!s)},[s,l,w]),s&&!f&&(o="not-allowed"),(0,y.jsx)("div",{...i,"aria-controls":d.valueControls,"aria-disabled":s||void 0,"aria-orientation":"horizontal"===v?"vertical":"horizontal","aria-valuemax":d.valueMax,"aria-valuemin":d.valueMin,"aria-valuenow":d.valueNow,children:e,className:t,"data-separator":s?"disabled":h,"data-testid":l,id:l,ref:g,role:"separator",style:{flexBasis:"auto",cursor:o,...n,flexGrow:0,flexShrink:0,touchAction:"none"},tabIndex:s?void 0:0})}ss.displayName="Separator";let sr=(0,ee.default)("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);var sa=e.i(789716);let sn=(0,ee.default)("clipboard-check",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]),si=(0,ee.default)("sticky-note",[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]]);var so=e.i(800103),sl=e.i(59235),sc=e.i(751918),sd=e.i(265809),su=e.i(311);let sh=(0,ee.default)("panels-top-left",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]),sm={subject:e6.GraduationCap,lesson:e8.BookOpen,task:e7.FileQuestion,assessment:sn,note:si},sp={subject:"bg-blue-500/20 text-blue-400 border-blue-500/50",lesson:"bg-green-500/20 text-green-400 border-green-500/50",task:"bg-orange-500/20 text-orange-400 border-orange-500/50",assessment:"bg-purple-500/20 text-purple-400 border-purple-500/50",note:"bg-yellow-500/20 text-yellow-400 border-yellow-500/50"},sg={subject:"Subject",lesson:"Lesson",task:"Task",assessment:"Assessment",note:"Note"},sf=[{id:"sub-1",name:"Mathematics",type:"subject",parentId:null,createdAt:new Date("2026-01-15"),updatedAt:new Date("2026-02-10"),description:"Mathematics curriculum materials",metadata:{topic:"math"}},{id:"les-1",name:"Algebra Basics",type:"lesson",parentId:"sub-1",createdAt:new Date("2026-01-16"),updatedAt:new Date("2026-01-20"),description:"Introduction to algebra",metadata:{topic:"algebra",tags:["variables","equations"]}},{id:"les-2",name:"Linear Equations",type:"lesson",parentId:"sub-1",createdAt:new Date("2026-01-18"),updatedAt:new Date("2026-01-25"),metadata:{topic:"algebra",tags:["linear_equations"]}},{id:"task-101",name:"Quadratic Formula Practice",type:"task",parentId:"les-1",createdAt:new Date,updatedAt:new Date,description:"Targeted practice for finding roots.",metadata:{topic:"quadratic_equations",tags:["finding_roots"],difficulty:"hard"}},{id:"task-1",name:"Practice Problems Set 1",type:"task",parentId:"les-1",createdAt:new Date("2026-01-17"),updatedAt:new Date("2026-01-17"),metadata:{taskType:"multiple_choice",difficulty:"beginner"}},{id:"task-2",name:"Quiz: Variables",type:"task",parentId:"les-1",createdAt:new Date("2026-01-19"),updatedAt:new Date("2026-01-19"),metadata:{taskType:"short_answer",difficulty:"intermediate"}},{id:"assess-1",name:"Algebra Mid-Assessment",type:"assessment",parentId:"sub-1",createdAt:new Date("2026-01-30"),updatedAt:new Date("2026-02-01"),metadata:{duration:45}},{id:"note-1",name:"Teaching Notes",type:"note",parentId:"les-1",createdAt:new Date("2026-01-16"),updatedAt:new Date("2026-02-05"),content:"Focus on real-world examples. Students struggle with negative numbers."},{id:"sub-2",name:"Physics",type:"subject",parentId:null,createdAt:new Date("2026-01-10"),updatedAt:new Date("2026-02-08"),description:"Physics curriculum"},{id:"les-3",name:"Mechanics",type:"lesson",parentId:"sub-2",createdAt:new Date("2026-01-12"),updatedAt:new Date("2026-01-15"),metadata:{tags:["force","motion"]}},{id:"task-3",name:"Force Problems",type:"task",parentId:"les-3",createdAt:new Date("2026-01-13"),updatedAt:new Date("2026-01-14"),metadata:{difficulty:"intermediate"}}];function sx({roomId:e,students:t=[],onAssetSelect:s,onAssetCreate:r,onAssetDelete:a,selectionMode:n,onAssetsSelect:i,onClose:o}){let[l,c]=(0,j.useState)(sf),[d,u]=(0,j.useState)(new Set(["sub-1","sub-2"])),[h,m]=(0,j.useState)(""),[p,g]=(0,j.useState)(null),[f,x]=(0,j.useState)("tree"),[v,b]=(0,j.useState)(new Set),w=(0,j.useMemo)(()=>{let e=new Set;return(t.forEach(t=>{"struggling"===t.status&&t.struggles&&t.struggles.forEach(t=>e.add(t.toLowerCase())),"struggling"===t.status&&(e.add("quadratic_equations"),e.add("finding_roots"))}),0===e.size)?[]:l.filter(t=>{let s=t.metadata?.topic&&e.has(t.metadata.topic.toLowerCase()),r=t.metadata?.tags?.some(t=>e.has(t.toLowerCase())),a=e.has(t.name.toLowerCase());return s||r||a})},[l,t]),N=(0,j.useMemo)(()=>l.filter(e=>null===e.parentId).sort((e,t)=>{let s="subject"===e.type||"lesson"===e.type,r="subject"===t.type||"lesson"===t.type;return s&&!r?-1:!s&&r?1:e.name.localeCompare(t.name)}),[l]),_=(0,j.useMemo)(()=>h?l.filter(e=>e.name.toLowerCase().includes(h.toLowerCase())||e.description?.toLowerCase().includes(h.toLowerCase())):null,[l,h]),M=(e,t=null)=>{let s={id:`${e}-${Date.now()}`,name:`New ${sg[e]}`,type:e,parentId:t,createdAt:new Date,updatedAt:new Date};c(e=>[...e,s]),t&&u(e=>new Set(e).add(t)),E.toast.success(`Created new ${sg[e]}`),r?.(s)},A=({type:e,isOpen:t})=>{let s="subject"===e||"lesson"===e?t?sa.FolderOpen:sr:sm[e];return(0,y.jsx)(s,{className:"h-4 w-4"})},I=(e,t=0)=>{let r,i="subject"===e.type||"lesson"===e.type,o=d.has(e.id),h=i?(r=e.id,l.filter(e=>e.parentId===r).sort((e,t)=>e.name.localeCompare(t.name))):[],m=h.length>0,f=p?.id===e.id;return(0,y.jsxs)("div",{className:"select-none",children:[(0,y.jsxs)("div",{className:`group flex items-center gap-2 px-3 py-2 my-0.5 rounded-lg cursor-pointer transition-all duration-200 border border-transparent
            ${f?"bg-blue-600/20 border-blue-500/30 text-white shadow-sm backdrop-blur-sm":"hover:bg-white/5 hover:border-white/10 text-gray-300"}`,style:{paddingLeft:`${12+16*t}px`},onClick:()=>{var t;i&&(t=e.id,u(e=>{let s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s})),g(e),s?.(e)},children:[i&&m?o?(0,y.jsx)(sl.ChevronDown,{className:"h-4 w-4 text-gray-500"}):(0,y.jsx)(so.ChevronRight,{className:"h-4 w-4 text-gray-500"}):(0,y.jsx)("span",{className:"w-4"}),n&&!i&&(0,y.jsx)("input",{type:"checkbox",className:"mr-2",checked:v.has(e.id),onClick:e=>e.stopPropagation(),onChange:t=>{var s,r;return s=e.id,r=t.target.checked,void b(e=>{let t=new Set(e);return r?t.add(s):t.delete(s),t})}}),(0,y.jsx)("span",{className:`p-1.5 rounded-md border ${sp[e.type]}`,children:(0,y.jsx)(A,{type:e.type,isOpen:o})}),(0,y.jsx)("span",{className:"flex-1 truncate text-sm font-medium",children:e.name}),e.metadata?.difficulty&&(0,y.jsx)(S.Badge,{variant:"outline",className:`text-[10px] px-1 h-5 ${"hard"===e.metadata.difficulty?"border-red-500/50 text-red-400":"intermediate"===e.metadata.difficulty?"border-yellow-500/50 text-yellow-400":"border-green-500/50 text-green-400"}`,children:e.metadata.difficulty}),(0,y.jsxs)(T.DropdownMenu,{children:[(0,y.jsx)(T.DropdownMenuTrigger,{asChild:!0,onClick:e=>e.stopPropagation(),children:(0,y.jsx)(k.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,y.jsx)(B.MoreVertical,{className:"h-3 w-3"})})}),(0,y.jsxs)(T.DropdownMenuContent,{align:"end",className:"bg-gray-800 border-gray-700 text-gray-200",children:[(0,y.jsxs)(T.DropdownMenuItem,{onClick:t=>{t.stopPropagation(),g(e)},children:[(0,y.jsx)(ts.Eye,{className:"h-4 w-4 mr-2"}),"Preview"]}),(0,y.jsxs)(T.DropdownMenuItem,{onClick:e=>e.stopPropagation(),children:[(0,y.jsx)(sd.Edit,{className:"h-4 w-4 mr-2"}),"Rename"]}),(0,y.jsxs)(T.DropdownMenuItem,{onClick:e=>e.stopPropagation(),children:[(0,y.jsx)(su.Download,{className:"h-4 w-4 mr-2"}),"Download"]}),(0,y.jsxs)(T.DropdownMenuItem,{className:"text-red-400 focus:text-red-400 focus:bg-red-900/20",onClick:t=>{let s;return t.stopPropagation(),void((s=e=>{l.filter(t=>t.parentId===e).forEach(e=>s(e.id)),c(t=>t.filter(t=>t.id!==e))})(e.id),E.toast.success("Asset deleted"),a?.(e.id))},children:[(0,y.jsx)(e3.Trash2,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]}),i&&o&&m&&(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)("div",{className:"absolute left-[20px] top-0 bottom-0 w-px bg-gray-800",style:{left:`${19+16*t}px`}}),h.map(e=>I(e,t+1))]})]},e.id)};return(0,y.jsxs)("div",{className:"h-full flex flex-col bg-black/40 backdrop-blur-xl border-l border-white/10 text-white shadow-2xl",children:[(0,y.jsxs)("div",{className:"p-4 border-b border-white/10 shrink-0 bg-white/5",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:"bg-gradient-to-br from-amber-500 to-orange-600 p-2.5 rounded-xl shadow-lg shadow-orange-900/20 shrink-0",children:(0,y.jsx)(sc.Layers,{className:"h-5 w-5 text-white"})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h2",{className:"text-lg font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-400",children:"Smart Assets"}),(0,y.jsx)("p",{className:"text-xs text-gray-400",children:"AI-Curated Materials"})]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,y.jsx)(k.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full hover:bg-white/10",onClick:()=>x("tree"===f?"list":"tree"),children:(0,y.jsx)(sh,{className:"h-4 w-4"})}),(0,y.jsxs)(C.Dialog,{children:[(0,y.jsx)(C.DialogTrigger,{asChild:!0,children:(0,y.jsxs)(k.Button,{size:"sm",className:"bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-900/20 border border-blue-400/20",children:[(0,y.jsx)(Y.Plus,{className:"h-4 w-4 mr-2"}),"New"]})}),(0,y.jsxs)(C.DialogContent,{className:"bg-gray-900/95 border-gray-700 text-white backdrop-blur-xl",children:[(0,y.jsx)(C.DialogHeader,{children:(0,y.jsx)(C.DialogTitle,{children:"Create New Asset"})}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[(0,y.jsxs)(k.Button,{variant:"outline",className:"h-auto py-4 flex flex-col items-center gap-2 hover:bg-white/5 border-gray-700",onClick:()=>M("subject"),children:[(0,y.jsx)(e6.GraduationCap,{className:"h-6 w-6 text-blue-400"}),(0,y.jsx)("span",{children:"Subject"})]}),(0,y.jsxs)(k.Button,{variant:"outline",className:"h-auto py-4 flex flex-col items-center gap-2 hover:bg-white/5 border-gray-700",onClick:()=>M("lesson"),children:[(0,y.jsx)(e8.BookOpen,{className:"h-6 w-6 text-green-400"}),(0,y.jsx)("span",{children:"Lesson"})]}),(0,y.jsxs)(k.Button,{variant:"outline",className:"h-auto py-4 flex flex-col items-center gap-2 hover:bg-white/5 border-gray-700",onClick:()=>M("task"),children:[(0,y.jsx)(e7.FileQuestion,{className:"h-6 w-6 text-orange-400"}),(0,y.jsx)("span",{children:"Task"})]}),(0,y.jsxs)(k.Button,{variant:"outline",className:"h-auto py-4 flex flex-col items-center gap-2 hover:bg-white/5 border-gray-700",onClick:()=>M("assessment"),children:[(0,y.jsx)(sn,{className:"h-6 w-6 text-purple-400"}),(0,y.jsx)("span",{children:"Assessment"})]}),(0,y.jsxs)(k.Button,{variant:"outline",className:"h-auto py-4 flex flex-col items-center gap-2 col-span-2 hover:bg-white/5 border-gray-700",onClick:()=>M("note"),children:[(0,y.jsx)(si,{className:"h-6 w-6 text-yellow-400"}),(0,y.jsx)("span",{children:"Note"})]})]})]})]}),n&&o&&(0,y.jsx)(k.Button,{variant:"ghost",size:"sm",onClick:o,className:"text-gray-400 hover:text-white",children:(0,y.jsx)(K.X,{className:"h-4 w-4"})})]})]}),(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)(U.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-500 group-focus-within:text-blue-400 transition-colors"}),(0,y.jsx)(P.Input,{placeholder:"Search assets...",value:h,onChange:e=>m(e.target.value),className:"pl-10 bg-black/20 border-white/10 text-white focus:bg-black/40 focus:border-blue-500/50 transition-all rounded-xl"})]})]}),(0,y.jsxs)(t7,{orientation:"horizontal",className:"flex-1 min-h-0",children:[(0,y.jsx)(se,{defaultSize:60,minSize:30,children:(0,y.jsxs)(O.ScrollArea,{className:"h-full",children:[w.length>0&&!h&&(0,y.jsxs)("div",{className:"p-4 pb-2 border-b border-white/5 bg-gradient-to-b from-blue-900/10 to-transparent",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2 mb-3 text-blue-300",children:[(0,y.jsx)(ea.Sparkles,{className:"h-4 w-4"}),(0,y.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Recommended for Class"})]}),(0,y.jsx)("div",{className:"space-y-1",children:w.map(e=>I(e))})]}),(0,y.jsxs)("div",{className:"p-4",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2 mb-3 text-gray-500",children:[(0,y.jsx)(sr,{className:"h-4 w-4"}),(0,y.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider",children:"All Library"})]}),h?_&&_.length>0?(0,y.jsx)("div",{className:"space-y-1",children:_.map(e=>I(e,0))}):(0,y.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,y.jsx)(U.Search,{className:"h-12 w-12 mx-auto mb-3 opacity-20"}),(0,y.jsx)("p",{children:"No assets found"})]}):(0,y.jsx)("div",{className:"space-y-1",children:N.length>0?N.map(e=>(0,y.jsx)("div",{className:"group",children:I(e,0)},e.id)):(0,y.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,y.jsx)(sr,{className:"h-12 w-12 mx-auto mb-3 opacity-20"}),(0,y.jsx)("p",{children:"No assets yet"}),(0,y.jsx)(k.Button,{variant:"link",onClick:()=>M("subject"),children:"Create Subject"})]})})]})]})}),(0,y.jsx)(ss,{className:"w-1 bg-white/5 hover:bg-blue-500/50 transition-colors cursor-col-resize active:bg-blue-600"}),p&&(0,y.jsx)(se,{defaultSize:40,minSize:20,children:(0,y.jsxs)("div",{className:"h-full flex flex-col bg-black/20 backdrop-blur-md border-l border-white/5",children:[(0,y.jsxs)(O.ScrollArea,{className:"flex-1 p-5",children:[(0,y.jsxs)("div",{className:"flex items-start gap-4 mb-6",children:[(0,y.jsx)("div",{className:`p-3 rounded-xl shadow-lg ${sp[p.type]}`,children:(0,y.jsx)(A,{type:p.type})}),(0,y.jsxs)("div",{className:"flex-1 min-w-0 pt-1",children:[(0,y.jsx)("h3",{className:"font-bold text-lg leading-tight truncate text-white",children:p.name}),(0,y.jsx)("p",{className:"text-xs text-blue-300/80 mt-1 uppercase tracking-wide font-medium",children:sg[p.type]})]})]}),(0,y.jsxs)("div",{className:"space-y-6",children:[p.description&&(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Description"}),(0,y.jsx)("p",{className:"text-sm text-gray-300 leading-relaxed bg-white/5 p-3 rounded-lg border border-white/5",children:p.description})]}),p.metadata&&(0,y.jsxs)("div",{className:"space-y-3",children:[(0,y.jsx)("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Details"}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[p.metadata.taskType&&(0,y.jsxs)("div",{className:"bg-white/5 p-2 rounded border border-white/5",children:[(0,y.jsx)("span",{className:"block text-[10px] text-gray-500 uppercase",children:"Type"}),(0,y.jsx)("span",{className:"text-sm capitalize",children:p.metadata.taskType.replace("_"," ")})]}),p.metadata.difficulty&&(0,y.jsxs)("div",{className:"bg-white/5 p-2 rounded border border-white/5",children:[(0,y.jsx)("span",{className:"block text-[10px] text-gray-500 uppercase",children:"Difficulty"}),(0,y.jsx)("span",{className:`text-sm capitalize font-medium ${"hard"===p.metadata.difficulty?"text-red-400":"intermediate"===p.metadata.difficulty?"text-yellow-400":"text-green-400"}`,children:p.metadata.difficulty})]}),p.metadata.duration&&(0,y.jsxs)("div",{className:"bg-white/5 p-2 rounded border border-white/5",children:[(0,y.jsx)("span",{className:"block text-[10px] text-gray-500 uppercase",children:"Duration"}),(0,y.jsxs)("span",{className:"text-sm",children:[p.metadata.duration," min"]})]}),p.metadata.topic&&(0,y.jsxs)("div",{className:"bg-white/5 p-2 rounded border border-white/5",children:[(0,y.jsx)("span",{className:"block text-[10px] text-gray-500 uppercase",children:"Topic"}),(0,y.jsx)("span",{className:"text-sm capitalize",children:p.metadata.topic})]})]})]}),p.content&&(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Preview"}),(0,y.jsx)("div",{className:"bg-black/40 p-4 rounded-lg text-sm font-mono text-gray-300 max-h-60 overflow-y-auto border border-white/10 shadow-inner",children:p.content})]})]})]}),(0,y.jsxs)("div",{className:"p-4 border-t border-white/10 bg-black/20 backdrop-blur-sm space-y-3",children:[(0,y.jsxs)("div",{className:"flex justify-between text-[10px] text-gray-500 font-medium uppercase tracking-wider",children:[(0,y.jsxs)("span",{children:["Created ",p.createdAt.toLocaleDateString()]}),(0,y.jsxs)("span",{children:["Updated ",p.updatedAt.toLocaleDateString()]})]}),(0,y.jsxs)("div",{className:"flex gap-2",children:[(0,y.jsxs)(k.Button,{variant:"outline",className:"flex-1 border-white/10 hover:bg-white/5 text-gray-300",children:[(0,y.jsx)(sd.Edit,{className:"h-4 w-4 mr-2"})," Edit"]}),(0,y.jsxs)(k.Button,{className:"flex-1 bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-900/20",children:[(0,y.jsx)(eq.Zap,{className:"h-4 w-4 mr-2"})," Open"]})]})]})]})})]}),(0,y.jsxs)("div",{className:"p-2 border-t border-white/10 bg-black/30 backdrop-blur-sm shrink-0 flex justify-between items-center text-[10px] text-gray-500 uppercase tracking-wider font-medium px-4",children:[(0,y.jsxs)("div",{className:"flex gap-4",children:[(0,y.jsxs)("span",{children:[l.filter(e=>"subject"===e.type).length," Subjects"]}),(0,y.jsxs)("span",{children:[l.filter(e=>"lesson"===e.type).length," Lessons"]}),(0,y.jsxs)("span",{children:[l.filter(e=>"task"===e.type).length," Tasks"]})]}),(0,y.jsxs)("span",{children:[l.length," Assets"]})]}),n&&(0,y.jsxs)("div",{className:"p-4 border-t border-white/10 bg-black/40 backdrop-blur-sm flex justify-between items-center",children:[(0,y.jsxs)("span",{className:"text-sm text-gray-400",children:[v.size," selected"]}),(0,y.jsxs)(k.Button,{onClick:()=>{let e=l.filter(e=>v.has(e.id));i?.(e)},disabled:0===v.size,size:"sm",className:"bg-purple-600 hover:bg-purple-500",children:["Select ",v.size>0?`(${v.size})`:""]})]})]})}let sv=new Map,sy=new Map,sb=new Map,sj=new Map,sw="student-1";sv.set(sw,{id:sw,name:"Sarah Chen",age:16,level:"B1",learningStyle:"visual",interests:["music","technology","travel"],goals:["improve_pronunciation","vocabulary_expansion"],preferredVoice:{gender:"female",accent:"us"}}),sy.set(sw,{currentMood:"neutral",energyLevel:80,recentStruggles:[],masteredTopics:["present_perfect","basic_greetings"],activeTopics:["conditionals","phrasal_verbs"]}),sb.set(sw,[]);class sN{static async getStudentContext(e){let t=sv.get(e);return t?{profile:t,state:sy.get(e)||this.getInitialState(),signals:(sb.get(e)||[]).filter(e=>!e.expiresAt||e.expiresAt>Date.now())}:null}static appendTranscript(e,t){let s=sj.get(e)||[];sj.set(e,[...s,t])}static getTranscript(e){return sj.get(e)||[]}static async recordSignal(e,t){let s={...t,id:Math.random().toString(36).substring(7),timestamp:Date.now()},r=sb.get(e)||[];sb.set(e,[...r,s]),"struggle_detected"===t.type&&await this.updateState(e,e=>(e.recentStruggles.push({topic:t.context?.topic||"unknown",errorType:t.context?.errorType||"general",severity:t.context?.severity||5,detectedAt:Date.now()}),e.recentStruggles.length>5&&e.recentStruggles.shift(),e))}static async updateState(e,t){let s=t({...sy.get(e)||this.getInitialState()});sy.set(e,s)}static getInitialState(){return{currentMood:"neutral",energyLevel:100,recentStruggles:[],masteredTopics:[],activeTopics:[]}}static async processClassSummary(e,t){await this.recordSignal(e,{source:"classroom_ta",type:"topic_requested",content:`Completed class on ${t.topic}. Status: ${t.status}`,context:t}),await this.updateState(e,e=>(t.struggles&&Array.isArray(t.struggles)&&t.struggles.forEach(t=>{e.recentStruggles.push({topic:t,errorType:"general",severity:7,detectedAt:Date.now()})}),t.topic&&!e.activeTopics.includes(t.topic)&&e.activeTopics.push(t.topic),e))}static async recordQuizResult(e,t){let s=t.score/t.maxScore;await this.recordSignal(e,{source:"personal_tutor",type:s>=.7?"mastery_achieved":"struggle_detected",content:`Quiz on ${t.topic}: ${t.score}/${t.maxScore} (${Math.round(100*s)}%)`,context:t}),await this.updateState(e,e=>(s<.7?(!e.recentStruggles.find(e=>e.topic===t.topic)&&(e.recentStruggles.push({topic:t.topic,errorType:"general",severity:Math.round((1-s)*10),detectedAt:Date.now()}),e.recentStruggles.length>10&&e.recentStruggles.shift()),e.activeTopics.includes(t.topic)||e.activeTopics.push(t.topic)):s>=.85&&(e.masteredTopics.includes(t.topic)||e.masteredTopics.push(t.topic),e.recentStruggles=e.recentStruggles.filter(e=>e.topic!==t.topic)),e))}}let sk=[{id:"math-algebra",name:"Math: Algebra Practice",subject:"Mathematics",topics:"Algebra, Linear Equations, Solving for Variables",difficulty:"intermediate",count:5,icon:"ðŸ“"},{id:"science-forces",name:"Science: Forces & Motion",subject:"Physics",topics:"Newton's Laws, Force, Acceleration, Friction",difficulty:"intermediate",count:8,icon:"âš›ï¸"},{id:"reading-comp",name:"Reading Comprehension",subject:"English",topics:"Main Idea, Inference, Context Clues",difficulty:"beginner",count:6,icon:"ðŸ“š"},{id:"math-geometry",name:"Geometry Basics",subject:"Mathematics",topics:"Area, Perimeter, Circles, Triangles",difficulty:"beginner",count:7,icon:"ðŸ“"}];function sS({roomId:e,students:t}){let[s,r]=(0,j.useState)("generate"),[a,n]=(0,j.useState)(!1),[i,o]=(0,j.useState)(null),[l,c]=(0,j.useState)(new Set),[d,u]=(0,j.useState)(!1),[h,m]=(0,j.useState)(!1),[p,g]=(0,j.useState)(0),[f,x]=(0,j.useState)([]),[v,b]=(0,j.useState)(null),[w,N]=(0,j.useState)("lesson_transcript"),[M,T]=(0,j.useState)(!1),[I,L]=(0,j.useState)([]),[R,B]=(0,j.useState)("practice"),[F,z]=(0,j.useState)({title:"",timeLimit:30,passingScore:70,shuffle:!0}),[$,V]=(0,j.useState)([]),[q,H]=(0,j.useState)("grid"),[J,W]=(0,j.useState)(!1),[Y,X]=(0,j.useState)(""),[ee,et]=(0,j.useState)(!1),[es,en]=(0,j.useState)({tasks:[],version:1}),[eo,el]=(0,j.useState)({subject:"",topics:"",difficulty:"intermediate",count:5,distributionMode:"personalized",questionType:"mixed"});(0,j.useEffect)(()=>{try{let e=localStorage.getItem("coursedev-preferences");if(e){let t=JSON.parse(e);t.recentSubject&&el(e=>({...e,subject:t.recentSubject,topics:t.recentTopics||"",difficulty:t.preferredDifficulty||"intermediate"}))}}catch(e){console.error("Failed to load preferences:",e)}},[]);let ec=()=>{try{localStorage.setItem("coursedev-preferences",JSON.stringify({recentSubject:eo.subject,recentTopics:eo.topics,preferredDifficulty:eo.difficulty,lastUsed:new Date().toISOString()}))}catch(e){console.error("Failed to save preferences:",e)}},ed=async()=>{if(!eo.subject||!eo.topics)return void E.toast.error("Please fill in subject and topics");if("uploaded_documents"===w&&0===I.length)return void E.toast.error("Please select materials",{description:'Click "Browse & Select Materials" to choose documents'});n(!0),ec();let t="";if("lesson_transcript"===w){t=`Generate tasks based on today's classroom lesson about ${eo.subject}. Focus on the key concepts covered: ${eo.topics}. `;let s=sN.getTranscript(e);if(s.length>0){let e=s.map(e=>`${e.speaker}: ${e.text}`).join("\n");t+=`
LATEST TRANSCRIPT:
${e}
`}else t+=`
(No active transcript found for this session yet)
`;t+="Use the lesson content as the primary source. "}else if("uploaded_documents"===w)t=`Generate tasks based on the following uploaded materials:
`,I.forEach(e=>{t+=`
--- Document: ${e.name} ---
`,t+=e.content||e.description||"(No text content available)",t+=`
----------------
`}),t+=`
Subject: ${eo.subject}. Topics to cover: ${eo.topics}. `,t+="Use only the content from these documents. ";else if("all_sources"===w){t=`Generate comprehensive tasks for ${eo.subject} covering ${eo.topics}. `;let s=sN.getTranscript(e);if(s.length>0){let e=s.map(e=>`${e.speaker}: ${e.text}`).join("\n");t+=`
LATEST TRANSCRIPT:
${e}
`}I.length>0&&(t+=`
REFERENCE MATERIALS:
`,I.forEach(e=>{t+=`${e.name}: ${e.content||e.description||"No content"}
`})),t+="Use lesson content, provided materials, and your general knowledge. "}setTimeout(()=>{let e=Array.from({length:eo.count},(e,s)=>{let r=eo.questionType;return"mixed"===r&&(r=s%2==0?"multiple_choice":"short_answer"),{id:`task-${Date.now()}-${s}`,type:"multiple_choice"===r?"multiple_choice":"short_answer",question:`${"lesson_transcript"===w?"[From Lesson]":"uploaded_documents"===w?"[From Docs]":"[All Sources]"} Sample ${eo.subject} question ${s+1} (${r}) about ${eo.topics.split(",")[0]?.trim()||"topic"}`,options:"multiple_choice"===r?["Option A","Option B","Option C","Option D"]:void 0,correctAnswer:"multiple_choice"===r?"Option A":void 0,explanation:`This tests understanding of core concepts. ${t.substring(0,100)}...`,difficulty:eo.difficulty}});V(e),r("review"),n(!1);let s="lesson_transcript"===w?"lesson transcript":"uploaded_documents"===w?`${I.length} document(s)`:"all sources";E.toast.success(`Generated ${e.length} tasks from ${s}`)},1500)},eu=async e=>{eo.subject&&eo.topics?(n(!0),ec(),setTimeout(()=>{let s=eo.count,r="all"===e?t:t.filter(e=>"struggling"===e.status);E.toast.success(`âœ… Generated ${s} tasks and assigned to ${r.length} student${1!==r.length?"s":""}!`,{description:"struggling"===e?"Helping struggling students":"Assigned to all students",duration:4e3}),n(!1)},1500)):E.toast.error("Please fill in subject and topics first")},eh=async e=>{(0,j.startTransition)(async()=>{try{let t=await eX({...e,subject:eo.subject,topics:eo.topics.split(",").map(e=>e.trim())});en(e=>({...e,tasks:[...e.tasks,t]})),E.toast.success("Task saved to library")}catch(e){E.toast.error("Failed to save task")}})},em=async e=>{let t={...e,id:`task-${Date.now()}`};V(e=>[...e,t]),(0,j.startTransition)(async()=>{await e1(e.id),en(t=>({...t,tasks:t.tasks.map(t=>t.id===e.id?{...t,usedCount:t.usedCount+1,lastUsed:new Date().toISOString()}:t)}))}),E.toast.success("Task added from library")},ep=async e=>{en(t=>({...t,tasks:t.tasks.map(t=>t.id===e?{...t,isFavorite:!t.isFavorite}:t)})),(0,j.startTransition)(async()=>{try{await eZ(e)}catch(t){en(t=>({...t,tasks:t.tasks.map(t=>t.id===e?{...t,isFavorite:!t.isFavorite}:t)})),E.toast.error("Failed to update favorite")}})},eg=async e=>{en(t=>({...t,tasks:t.tasks.filter(t=>t.id!==e)})),(0,j.startTransition)(async()=>{try{await e0(e),E.toast.success("Task removed from library")}catch(e){en(es),E.toast.error("Failed to delete task")}})},ex=()=>{let e=es.tasks;if(ee&&(e=e.filter(e=>e.isFavorite)),Y){let t=Y.toLowerCase();e=e.filter(e=>e.question.toLowerCase().includes(t)||e.subject.toLowerCase().includes(t)||e.topics.some(e=>e.toLowerCase().includes(t)))}return e.sort((e,t)=>e.isFavorite!==t.isFavorite?e.isFavorite?-1:1:t.usedCount-e.usedCount)},ey=async e=>{m(!0),g(0);let t=setInterval(()=>{g(e=>e>=90?(clearInterval(t),90):e+10)},200);await new Promise(e=>setTimeout(e,2e3)),clearInterval(t),g(100);let s=[{id:`imported-${Date.now()}-1`,question:"What is the primary function of the mitochondria?",type:"multiple_choice",options:["Energy production","Protein synthesis","Waste disposal","Cell division"],correctAnswer:"Energy production",subject:"Biology",topics:["Cell Biology"],difficulty:"intermediate"},{id:`imported-${Date.now()}-2`,question:"Describe the process of osmosis.",type:"short_answer",subject:"Biology",topics:["Cell Biology"],difficulty:"intermediate"},{id:`imported-${Date.now()}-3`,question:"Which organelle is known as the 'brain' of the cell?",type:"multiple_choice",options:["Nucleus","Ribosome","Golgi apparatus","Endoplasmic reticulum"],correctAnswer:"Nucleus",subject:"Biology",topics:["Cell Biology"],difficulty:"beginner"}];x(s),m(!1),E.toast.success("Analysis Complete",{description:`Extracted ${s.length} questions from ${e.name}`})},eb={total:t.length,onTrack:t.filter(e=>"on_track"===e.status).length,needHelp:t.filter(e=>"needs_help"===e.status).length,struggling:t.filter(e=>"struggling"===e.status).length};return(0,y.jsxs)("div",{className:"h-full flex flex-col bg-gray-900 text-white",children:[(0,y.jsx)("div",{className:"px-6 py-4 border-b border-gray-700 bg-gray-800",children:(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsxs)("button",{onClick:()=>r("generate"),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${"generate"===s?"bg-blue-600 text-white":"text-gray-400 hover:text-white"}`,children:[(0,y.jsx)("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-sm ${"generate"===s?"bg-white text-blue-600":"bg-gray-700"}`,children:"1"}),(0,y.jsx)("span",{className:"font-medium",children:"Configure"})]}),(0,y.jsx)("div",{className:"w-8 h-px bg-gray-700"}),(0,y.jsxs)("button",{onClick:()=>$.length>0&&r("review"),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${"review"===s?"bg-blue-600 text-white":$.length>0?"text-gray-400 hover:text-white":"text-gray-600 cursor-not-allowed"}`,children:[(0,y.jsx)("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-sm ${"review"===s?"bg-white text-blue-600":$.length>0?"bg-gray-700":"bg-gray-800"}`,children:"2"}),(0,y.jsx)("span",{className:"font-medium",children:"Review"}),$.length>0&&(0,y.jsx)(S.Badge,{className:"bg-blue-500",children:$.length})]}),(0,y.jsx)("div",{className:"w-8 h-px bg-gray-700"}),(0,y.jsxs)("button",{onClick:()=>$.length>0&&r("assign"),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${"assign"===s?"bg-blue-600 text-white":$.length>0?"text-gray-400 hover:text-white":"text-gray-600 cursor-not-allowed"}`,children:[(0,y.jsx)("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-sm ${"assign"===s?"bg-white text-blue-600":$.length>0?"bg-gray-700":"bg-gray-800"}`,children:"3"}),(0,y.jsx)("span",{className:"font-medium",children:"Assign"})]})]})}),(0,y.jsxs)("div",{className:"flex-1 overflow-hidden",children:["generate"===s&&(0,y.jsxs)("div",{className:"h-full flex",children:[(0,y.jsx)("div",{className:"flex-1 p-6 overflow-auto",children:(0,y.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Task Configuration"}),(0,y.jsx)("p",{className:"text-gray-400",children:"Configure AI to generate personalized learning tasks"})]}),(0,y.jsxs)(A.Card,{className:"bg-gradient-to-br from-blue-900/30 to-purple-900/30 border-blue-700",children:[(0,y.jsxs)(A.CardHeader,{children:[(0,y.jsxs)(A.CardTitle,{className:"text-white text-base flex items-center gap-2",children:[(0,y.jsx)(ea.Sparkles,{className:"h-5 w-5 text-yellow-400"}),"Quick Start Templates"]}),(0,y.jsx)(A.CardDescription,{className:"text-gray-300",children:"Load pre-configured templates to get started instantly"})]}),(0,y.jsx)(A.CardContent,{children:(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[sk.map(e=>(0,y.jsx)("button",{onClick:()=>{el(t=>({...t,subject:e.subject,topics:e.topics,difficulty:e.difficulty,count:e.count,distributionMode:"personalized"})),E.toast.success(`Loaded template: ${e.name}`)},className:"p-4 rounded-lg border-2 border-gray-600 bg-gray-800 hover:border-blue-500 hover:bg-gray-700 transition-all text-left group",children:(0,y.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,y.jsx)("span",{className:"text-2xl",children:e.icon}),(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsx)("div",{className:"font-semibold text-sm group-hover:text-blue-400 transition-colors",children:e.name}),(0,y.jsxs)("div",{className:"text-xs text-gray-400",children:[e.count," tasks â€¢ ",e.difficulty]})]})]})},e.id)),(0,y.jsxs)("button",{onClick:()=>T(!0),className:"p-4 rounded-lg border-2 border-dashed border-gray-600 bg-gray-800/50 hover:border-purple-500 hover:bg-gray-800 transition-all text-left group flex flex-col justify-center items-center gap-2",children:[(0,y.jsx)("div",{className:"w-12 h-12 rounded-full bg-purple-900/30 flex items-center justify-center group-hover:scale-110 transition-transform",children:(0,y.jsx)(tn.Library,{className:"h-6 w-6 text-purple-400"})}),(0,y.jsxs)("div",{className:"text-center",children:[(0,y.jsx)("div",{className:"font-semibold text-sm group-hover:text-purple-400 transition-colors",children:"Browse & Select Materials"}),(0,y.jsx)("div",{className:"text-xs text-gray-400",children:"From Assets Panel"})]})]})]})})]}),(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,y.jsx)("div",{className:"w-full border-t border-gray-700"})}),(0,y.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,y.jsx)("span",{className:"px-4 bg-gray-900 text-gray-400",children:"OR BUILD CUSTOM"})})]}),(0,y.jsxs)(A.Card,{className:"bg-gradient-to-br from-purple-900/20 to-blue-900/20 border-purple-700/50",children:[(0,y.jsxs)(A.CardHeader,{children:[(0,y.jsxs)(A.CardTitle,{className:"text-white text-base flex items-center gap-2",children:[(0,y.jsx)(Z.Target,{className:"h-5 w-5 text-purple-400"}),"AI Source Selection"]}),(0,y.jsx)(A.CardDescription,{className:"text-gray-300",children:"Choose where AI should generate tasks from"})]}),(0,y.jsxs)(A.CardContent,{className:"space-y-4",children:[(0,y.jsxs)("div",{className:"space-y-3",children:[(0,y.jsx)("button",{onClick:()=>N("lesson_transcript"),className:`w-full p-4 rounded-lg border-2 transition-all text-left ${"lesson_transcript"===w?"border-purple-500 bg-purple-900/30":"border-gray-600 bg-gray-800 hover:border-gray-500"}`,children:(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${"lesson_transcript"===w?"border-purple-500":"border-gray-500"}`,children:"lesson_transcript"===w&&(0,y.jsx)("div",{className:"w-3 h-3 rounded-full bg-purple-500"})}),(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsx)("div",{className:"font-semibold text-white",children:"Lesson Transcript"}),(0,y.jsx)("div",{className:"text-sm text-gray-400",children:"Generate from today's classroom session"})]})]})}),(0,y.jsx)("button",{onClick:()=>N("uploaded_documents"),className:`w-full p-4 rounded-lg border-2 transition-all text-left ${"uploaded_documents"===w?"border-purple-500 bg-purple-900/30":"border-gray-600 bg-gray-800 hover:border-gray-500"}`,children:(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${"uploaded_documents"===w?"border-purple-500":"border-gray-500"}`,children:"uploaded_documents"===w&&(0,y.jsx)("div",{className:"w-3 h-3 rounded-full bg-purple-500"})}),(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsx)("div",{className:"font-semibold text-white",children:"Uploaded Documents"}),(0,y.jsxs)("div",{className:"text-sm text-gray-400",children:["Generate from selected materials",I.length>0&&` (${I.length} selected)`]})]})]})}),(0,y.jsx)("button",{onClick:()=>N("all_sources"),className:`w-full p-4 rounded-lg border-2 transition-all text-left ${"all_sources"===w?"border-purple-500 bg-purple-900/30":"border-gray-600 bg-gray-800 hover:border-gray-500"}`,children:(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${"all_sources"===w?"border-purple-500":"border-gray-500"}`,children:"all_sources"===w&&(0,y.jsx)("div",{className:"w-3 h-3 rounded-full bg-purple-500"})}),(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsx)("div",{className:"font-semibold text-white",children:"All Sources"}),(0,y.jsx)("div",{className:"text-sm text-gray-400",children:"Lesson + Documents + General Knowledge"})]})]})})]}),I.length>0&&(0,y.jsxs)("div",{className:"mt-4 p-3 bg-gray-800/50 rounded-lg border border-gray-700",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,y.jsx)(tl.FileText,{className:"h-4 w-4 text-purple-400"}),(0,y.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Selected Materials:"})]}),(0,y.jsx)("div",{className:"flex flex-wrap gap-2",children:I.map((e,t)=>(0,y.jsx)(S.Badge,{variant:"outline",className:"bg-purple-900/30 text-purple-300 border-purple-700",children:e.name||`Asset ${t+1}`},t))})]})]})]}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,y.jsxs)(A.Card,{className:"bg-gray-800 border-gray-700",children:[(0,y.jsx)(A.CardHeader,{children:(0,y.jsxs)(A.CardTitle,{className:"text-white text-base flex items-center gap-2",children:[(0,y.jsx)(e8.BookOpen,{className:"h-4 w-4 text-blue-400"}),"Subject & Topics"]})}),(0,y.jsxs)(A.CardContent,{className:"space-y-4",children:[(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(e2.Label,{className:"text-gray-300",children:"Subject"}),(0,y.jsx)(P.Input,{placeholder:"e.g., Mathematics",value:eo.subject,onChange:e=>el({...eo,subject:e.target.value}),className:"bg-gray-700 border-gray-600 text-white"})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(e2.Label,{className:"text-gray-300",children:"Topics"}),(0,y.jsx)(e4.Textarea,{placeholder:"e.g., Algebra, Linear Equations, Quadratic Functions",value:eo.topics,onChange:e=>el({...eo,topics:e.target.value}),className:"bg-gray-700 border-gray-600 text-white min-h-[100px]"})]})]})]}),(0,y.jsxs)(A.Card,{className:"bg-gray-800 border-gray-700",children:[(0,y.jsx)(A.CardHeader,{children:(0,y.jsxs)(A.CardTitle,{className:"text-white text-base flex items-center gap-2",children:[(0,y.jsx)(ef.BarChart3,{className:"h-4 w-4 text-green-400"}),"Settings"]})}),(0,y.jsxs)(A.CardContent,{className:"space-y-4",children:[(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsx)(e2.Label,{className:"text-gray-300",children:"Difficulty"}),(0,y.jsxs)(k.Button,{variant:"ghost",size:"sm",onClick:()=>{let e=t.length;if(0===e)return;let s=t.filter(e=>"struggling"===e.status).length,r=t.filter(e=>"on_track"===e.status).length,a="intermediate",n="";s/e>.3?(a="beginner",n=`Detected ${Math.round(s/e*100)}% struggling students. Suggesting Beginner difficulty.`):r/e>.6?(a="advanced",n=`Detected ${Math.round(r/e*100)}% on-track students. Suggesting Advanced difficulty.`):(a="intermediate",n="Class performance is balanced. Suggesting Intermediate difficulty."),el(e=>({...e,difficulty:a})),E.toast.success("Difficulty Adjusted",{description:n})},className:"h-6 text-xs text-blue-400 hover:text-blue-300 px-2",children:[(0,y.jsx)(ea.Sparkles,{className:"h-3 w-3 mr-1"}),"Auto-detect"]})]}),(0,y.jsxs)(Q.Select,{value:eo.difficulty,onValueChange:e=>el({...eo,difficulty:e}),children:[(0,y.jsx)(Q.SelectTrigger,{className:"bg-gray-700 border-gray-600 text-white",children:(0,y.jsx)(Q.SelectValue,{})}),(0,y.jsxs)(Q.SelectContent,{children:[(0,y.jsx)(Q.SelectItem,{value:"beginner",children:"Beginner"}),(0,y.jsx)(Q.SelectItem,{value:"intermediate",children:"Intermediate"}),(0,y.jsx)(Q.SelectItem,{value:"advanced",children:"Advanced"})]})]})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(e2.Label,{className:"text-gray-300",children:"Distribution Mode"}),(0,y.jsx)("div",{className:"grid grid-cols-1 gap-2",children:[{key:"uniform",label:"Same for all students"},{key:"personalized",label:"Personalized to each student"},{key:"clustered",label:"By performance cluster"}].map(({key:e,label:t})=>(0,y.jsx)("button",{onClick:()=>el({...eo,distributionMode:e}),className:`p-3 rounded-lg border text-left transition-colors ${eo.distributionMode===e?"border-blue-500 bg-blue-500/20":"border-gray-600 bg-gray-700 hover:bg-gray-600"}`,children:(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[eo.distributionMode===e&&(0,y.jsx)(er.CheckCircle,{className:"h-4 w-4 text-blue-400"}),(0,y.jsx)("span",{className:"text-sm",children:t})]})},e))})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)(e2.Label,{className:"text-gray-300",children:["Number of Tasks: ",eo.count]}),(0,y.jsx)("input",{type:"range",min:1,max:20,value:eo.count,onChange:e=>el({...eo,count:parseInt(e.target.value)}),className:"w-full"})]})]})]})]}),(eo.subject||eo.topics)&&(0,y.jsxs)(A.Card,{className:"bg-gray-800 border-blue-600 border-2",children:[(0,y.jsxs)(A.CardHeader,{children:[(0,y.jsxs)(A.CardTitle,{className:"text-white text-sm flex items-center gap-2",children:[(0,y.jsx)(ts.Eye,{className:"h-4 w-4 text-blue-400"}),"Live Preview"]}),(0,y.jsx)(A.CardDescription,{className:"text-gray-400 text-xs",children:"Sample question based on your configuration"})]}),(0,y.jsx)(A.CardContent,{children:(0,y.jsxs)("div",{className:"bg-gray-700 p-4 rounded-lg",children:[(0,y.jsx)("p",{className:"text-sm text-gray-300 mb-3",children:(()=>{if(!eo.subject||!eo.topics)return null;let e=eo.topics.split(",")[0]?.trim()||"topic";return`Solve for x: 2x + 5 = 13 (${e})`})()}),(0,y.jsxs)("div",{className:"space-y-1.5",children:[(0,y.jsx)("div",{className:"text-xs px-3 py-2 rounded bg-gray-600 text-gray-300",children:"A. x = 3"}),(0,y.jsx)("div",{className:"text-xs px-3 py-2 rounded bg-green-900/50 border border-green-700 text-green-300",children:"B. x = 4 âœ“"}),(0,y.jsx)("div",{className:"text-xs px-3 py-2 rounded bg-gray-600 text-gray-300",children:"C. x = 8"}),(0,y.jsx)("div",{className:"text-xs px-3 py-2 rounded bg-gray-600 text-gray-300",children:"D. x = 9"})]}),(0,y.jsx)("p",{className:"text-xs text-gray-500 mt-3",children:"ðŸ’¡ This is a sample. Actual questions will vary."})]})})]}),(0,y.jsx)(k.Button,{onClick:ed,disabled:a||!eo.subject||!eo.topics,className:"w-full h-12 text-lg bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:a?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(e5.Loader2,{className:"h-5 w-5 mr-2 animate-spin"}),"Generating Tasks..."]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(ea.Sparkles,{className:"h-5 w-5 mr-2"}),"Generate ",eo.count," Tasks"]})}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,y.jsxs)(k.Button,{variant:"outline",onClick:()=>eu("all"),disabled:a||!eo.subject||!eo.topics,className:"h-10 border-blue-600 text-blue-400 hover:bg-blue-600/20",children:[(0,y.jsx)(eq.Zap,{className:"h-4 w-4 mr-2"}),"Quick Assign to All"]}),(0,y.jsxs)(k.Button,{variant:"outline",onClick:()=>eu("struggling"),disabled:a||!eo.subject||!eo.topics||0===eb.struggling,className:"h-10 border-red-600 text-red-400 hover:bg-red-600/20",children:[(0,y.jsx)(te.Heart,{className:"h-4 w-4 mr-2"}),"Help Struggling ",eb.struggling>0&&`(${eb.struggling})`]})]}),(0,y.jsx)("p",{className:"text-xs text-center text-gray-500",children:"âš¡ Quick Assign skips review and assigns tasks immediately"})]})]})}),(0,y.jsxs)("div",{className:"w-72 border-l border-gray-700 bg-gray-800 p-6",children:[(0,y.jsxs)("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[(0,y.jsx)(D.Users,{className:"h-4 w-4"}),"Students (",eb.total,")"]}),(0,y.jsxs)("div",{className:"space-y-3",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-900/30 rounded-lg",children:[(0,y.jsx)("span",{className:"text-green-400",children:"On Track"}),(0,y.jsx)("span",{className:"font-bold text-green-400",children:eb.onTrack})]}),(0,y.jsxs)("div",{className:"flex items-center justify-between p-3 bg-yellow-900/30 rounded-lg",children:[(0,y.jsx)("span",{className:"text-yellow-400",children:"Need Help"}),(0,y.jsx)("span",{className:"font-bold text-yellow-400",children:eb.needHelp})]}),(0,y.jsxs)("div",{className:"flex items-center justify-between p-3 bg-red-900/30 rounded-lg",children:[(0,y.jsx)("span",{className:"text-red-400",children:"Struggling"}),(0,y.jsx)("span",{className:"font-bold text-red-400",children:eb.struggling})]})]})]})]}),"review"===s&&(0,y.jsxs)("div",{className:"h-full flex flex-col",children:[(0,y.jsxs)("div",{className:"px-6 py-3 border-b border-gray-700 bg-gray-800 flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center gap-4",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("button",{onClick:()=>{l.size===$.length?c(new Set):c(new Set($.map(e=>e.id)))},className:"p-1 hover:bg-gray-700 rounded",children:l.size===$.length?(0,y.jsx)(ta,{className:"h-4 w-4 text-blue-400"}):(0,y.jsx)(ev.Square,{className:"h-4 w-4 text-gray-400"})}),(0,y.jsx)("h3",{className:"font-semibold",children:l.size>0?(0,y.jsxs)("span",{children:[l.size," of ",$.length," Selected"]}):(0,y.jsxs)("span",{children:[$.length," Tasks Generated"]})})]}),l.size>0&&(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsxs)(k.Button,{variant:"outline",size:"sm",onClick:()=>{V(e=>e.filter(e=>!l.has(e.id))),E.toast.success(`Deleted ${l.size} tasks`),c(new Set)},className:"h-8 border-red-600 text-red-400",children:[(0,y.jsx)(e3.Trash2,{className:"h-3 w-3 mr-1"}),"Delete"]}),(0,y.jsxs)(Q.Select,{onValueChange:e=>{V(t=>t.map(t=>l.has(t.id)?{...t,difficulty:e}:t)),E.toast.success(`Updated ${l.size} tasks to ${e}`),c(new Set)},children:[(0,y.jsx)(Q.SelectTrigger,{className:"h-8 w-32 bg-gray-700",children:(0,y.jsx)(Q.SelectValue,{placeholder:"Difficulty"})}),(0,y.jsxs)(Q.SelectContent,{children:[(0,y.jsx)(Q.SelectItem,{value:"beginner",children:"Set Easy"}),(0,y.jsx)(Q.SelectItem,{value:"intermediate",children:"Set Medium"}),(0,y.jsx)(Q.SelectItem,{value:"advanced",children:"Set Hard"})]})]})]}),(0,y.jsxs)(k.Button,{variant:"outline",size:"sm",onClick:()=>W(!0),className:"h-8 border-blue-500 text-blue-400 bg-blue-500/10 hover:bg-blue-500/20",children:[(0,y.jsx)(tn.Library,{className:"h-4 w-4 mr-2"}),"Library"]}),(0,y.jsxs)("div",{className:"flex items-center gap-2 bg-gray-700 rounded-lg p-1",children:[(0,y.jsx)("button",{onClick:()=>H("grid"),className:`p-1.5 rounded ${"grid"===q?"bg-gray-600":""}`,children:(0,y.jsx)(G.LayoutGrid,{className:"h-4 w-4"})}),(0,y.jsx)("button",{onClick:()=>H("list"),className:`p-1.5 rounded ${"list"===q?"bg-gray-600":""}`,children:(0,y.jsx)(e9.List,{className:"h-4 w-4"})})]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(k.Button,{variant:"outline",onClick:()=>r("generate"),children:"Back"}),(0,y.jsxs)(k.Button,{onClick:()=>r("assign"),children:["Continue to Assign",(0,y.jsx)(eM.Send,{className:"h-4 w-4 ml-2"})]})]})]}),(0,y.jsx)(O.ScrollArea,{className:"flex-1 p-6",children:(0,y.jsx)("div",{className:"grid"===q?"grid grid-cols-2 lg:grid-cols-3 gap-4":"space-y-3",children:$.map((e,t)=>(0,y.jsxs)(A.Card,{className:"bg-gray-800 border-gray-700",children:[(0,y.jsx)(A.CardHeader,{className:"pb-3",children:(0,y.jsxs)("div",{className:"flex items-start justify-between",children:[(0,y.jsx)("button",{onClick:()=>{let t=new Set(l);t.has(e.id)?t.delete(e.id):t.add(e.id),c(t)},className:"mr-3 mt-1",children:l.has(e.id)?(0,y.jsx)(ta,{className:"h-5 w-5 text-blue-400"}):(0,y.jsx)(ev.Square,{className:"h-5 w-5 text-gray-500"})}),(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsx)(S.Badge,{className:"mb-2",variant:"multiple_choice"===e.type?"default":"secondary",children:"multiple_choice"===e.type?"Multiple Choice":"Short Answer"}),(0,y.jsxs)(A.CardTitle,{className:"text-white text-sm",children:["Task ",t+1]})]}),(0,y.jsxs)("div",{className:"flex gap-1 shrink-0",children:[(0,y.jsx)(k.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-yellow-500 hover:text-yellow-400 hover:bg-yellow-500/10",onClick:()=>eh(e),title:"Save to Library",children:(0,y.jsx)(tt.Star,{className:"h-4 w-4"})}),(0,y.jsx)(k.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>(e=>{let t=$.find(t=>t.id===e);if(t){let e={...t,id:`task-${Date.now()}`};V(t=>[...t,e]),E.toast.success("Task duplicated")}})(e.id),title:"Duplicate",children:(0,y.jsx)(tr.Copy,{className:"h-4 w-4"})}),(0,y.jsx)(k.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-400",onClick:()=>{var t;return t=e.id,void(V(e=>e.filter(e=>e.id!==t)),c(e=>{let s=new Set(e);return s.delete(t),s}),E.toast.success("Task deleted"))},title:"Delete",children:(0,y.jsx)(e3.Trash2,{className:"h-4 w-4"})})]})]})}),(0,y.jsxs)(A.CardContent,{className:"space-y-3",children:[i===e.id?(0,y.jsx)(P.Input,{value:e.question,onChange:t=>{var s,r;return s=e.id,r={question:t.target.value},void V(e=>e.map(e=>e.id===s?{...e,...r}:e))},onBlur:()=>o(null),autoFocus:!0,className:"bg-gray-700 border-blue-600 text-white"}):(0,y.jsx)("p",{className:"text-sm text-gray-300 cursor-pointer hover:text-blue-400 transition-colors",onClick:()=>o(e.id),title:"Click to edit",children:e.question}),e.options&&(0,y.jsx)("div",{className:"space-y-1",children:e.options.map((t,s)=>(0,y.jsxs)("div",{className:`text-sm px-3 py-1.5 rounded ${t===e.correctAnswer?"bg-green-900/50 text-green-300 border border-green-700":"bg-gray-700 text-gray-400"}`,children:[String.fromCharCode(65+s),". ",t]},s))})]})]},e.id))})})]}),"assign"===s&&(0,y.jsxs)("div",{className:"h-full flex",children:[(0,y.jsx)("div",{className:"flex-1 p-6 overflow-auto",children:(0,y.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Assign Tasks"}),(0,y.jsx)("p",{className:"text-gray-400",children:"Choose how students will receive this content"})]}),(0,y.jsxs)(_.Tabs,{value:R,onValueChange:e=>B(e),className:"w-full",children:[(0,y.jsxs)(_.TabsList,{className:"grid w-full grid-cols-2 bg-gray-800",children:[(0,y.jsx)(_.TabsTrigger,{value:"practice",children:"Practice Assignment"}),(0,y.jsx)(_.TabsTrigger,{value:"exam",children:"Formal Assessment (Exam)"})]}),(0,y.jsx)(_.TabsContent,{value:"practice",className:"mt-6 space-y-6",children:(0,y.jsxs)("div",{className:"grid gap-4",children:[(0,y.jsx)(A.Card,{className:"bg-gray-800 border-gray-700 hover:border-blue-500 transition-colors cursor-pointer",children:(0,y.jsx)(A.CardContent,{className:"p-6",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center gap-4",children:[(0,y.jsx)("div",{className:"w-12 h-12 rounded-full bg-blue-600 flex items-center justify-center",children:(0,y.jsx)(e6.GraduationCap,{className:"h-6 w-6"})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{className:"font-semibold text-lg",children:"All Students"}),(0,y.jsx)("p",{className:"text-gray-400",children:"Assign to everyone in the session"})]})]}),(0,y.jsxs)("div",{className:"text-right",children:[(0,y.jsx)("p",{className:"text-2xl font-bold",children:eb.total}),(0,y.jsx)("p",{className:"text-sm text-gray-400",children:"students"})]})]})})}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,y.jsx)(A.Card,{className:"bg-gray-800 border-gray-700 hover:border-green-500 transition-colors cursor-pointer",children:(0,y.jsx)(A.CardContent,{className:"p-6",children:(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-600 flex items-center justify-center",children:(0,y.jsx)(er.CheckCircle,{className:"h-5 w-5"})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{className:"font-semibold",children:"On Track"}),(0,y.jsxs)("p",{className:"text-sm text-gray-400",children:[eb.onTrack," students"]})]})]})})}),(0,y.jsx)(A.Card,{className:"bg-gray-800 border-gray-700 hover:border-yellow-500 transition-colors cursor-pointer",children:(0,y.jsx)(A.CardContent,{className:"p-6",children:(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:"w-10 h-10 rounded-full bg-yellow-600 flex items-center justify-center",children:(0,y.jsx)(ei.Clock,{className:"h-5 w-5"})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{className:"font-semibold",children:"Need Help"}),(0,y.jsxs)("p",{className:"text-sm text-gray-400",children:[eb.needHelp," students"]})]})]})})})]}),(0,y.jsx)(A.Card,{className:"bg-gray-800 border-gray-700 hover:border-red-500 transition-colors cursor-pointer",children:(0,y.jsx)(A.CardContent,{className:"p-6",children:(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:"w-10 h-10 rounded-full bg-red-600 flex items-center justify-center",children:(0,y.jsx)(e7.FileQuestion,{className:"h-5 w-5"})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{className:"font-semibold",children:"Struggling Students"}),(0,y.jsxs)("p",{className:"text-sm text-gray-400",children:[eb.struggling," students need extra support"]})]})]})})})]})}),(0,y.jsxs)(_.TabsContent,{value:"exam",className:"mt-6 space-y-6",children:[(0,y.jsxs)(A.Card,{className:"bg-gray-800 border-gray-700",children:[(0,y.jsxs)(A.CardHeader,{children:[(0,y.jsxs)(A.CardTitle,{className:"flex items-center gap-2",children:[(0,y.jsx)(Z.Target,{className:"h-5 w-5 text-red-500"}),"Exam Configuration"]}),(0,y.jsx)(A.CardDescription,{children:"Configure settings for this formal assessment"})]}),(0,y.jsxs)(A.CardContent,{className:"space-y-4",children:[(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(e2.Label,{children:"Assessment Title"}),(0,y.jsx)(P.Input,{placeholder:"e.g., Unit 4 Mid-Term Exam",value:F.title,onChange:e=>z({...F,title:e.target.value}),className:"bg-gray-900 border-gray-600"})]}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(e2.Label,{children:"Time Limit (minutes)"}),(0,y.jsx)(P.Input,{type:"number",value:F.timeLimit,onChange:e=>z({...F,timeLimit:parseInt(e.target.value)}),className:"bg-gray-900 border-gray-600"})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(e2.Label,{children:"Passing Score (%)"}),(0,y.jsxs)("div",{className:"flex items-center gap-4",children:[(0,y.jsx)("input",{type:"range",min:"50",max:"100",step:"5",value:F.passingScore,onChange:e=>z({...F,passingScore:parseInt(e.target.value)}),className:"flex-1"}),(0,y.jsxs)("span",{className:"font-bold w-12 text-right",children:[F.passingScore,"%"]})]})]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-2 pt-2",children:[(0,y.jsx)("input",{type:"checkbox",checked:F.shuffle,onChange:e=>z({...F,shuffle:e.target.checked}),id:"shuffle",className:"w-4 h-4 rounded border-gray-600 bg-gray-900 text-blue-600 focus:ring-blue-500"}),(0,y.jsx)(e2.Label,{htmlFor:"shuffle",className:"cursor-pointer",children:"Randomize question order for each student"})]})]})]}),(0,y.jsxs)("div",{className:"bg-blue-900/20 border border-blue-800 rounded-lg p-4 flex gap-3",children:[(0,y.jsx)("div",{className:"p-2 bg-blue-900/50 rounded h-fit",children:(0,y.jsx)(Z.Target,{className:"h-5 w-5 text-blue-400"})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h4",{className:"font-medium text-blue-300",children:"Exam Mode Active"}),(0,y.jsx)("p",{className:"text-sm text-blue-200/70 mt-1",children:"Students will see a timer and receive a grade upon completion. Answers will be hidden until the exam is closed."})]})]})]})]}),(0,y.jsxs)("div",{className:"flex gap-3",children:[(0,y.jsx)(k.Button,{variant:"outline",className:"flex-1",onClick:()=>r("review"),children:"Back"}),(0,y.jsx)(k.Button,{className:`flex-1 ${"exam"===R?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"}`,onClick:()=>{if("exam"===R&&!F.title)return void E.toast.error("Missing Title",{description:"Please provide a title for the exam"});let e="exam"===R?`Exam "${F.title}" Published!`:"Practice tasks assigned successfully!",t="exam"===R?`Time limit: ${F.timeLimit} mins â€¢ Passing: ${F.passingScore}%`:`Assigned to ${eb.total} students`;E.toast.success(e,{description:t})},children:"exam"===R?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Z.Target,{className:"h-4 w-4 mr-2"}),"Publish Assessment"]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(eM.Send,{className:"h-4 w-4 mr-2"}),"Assign Tasks"]})})]})]})}),(0,y.jsxs)("div",{className:"w-72 border-l border-gray-700 bg-gray-800 p-6",children:[(0,y.jsx)("h3",{className:"font-semibold mb-4",children:"Assignment Summary"}),(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,y.jsx)("span",{className:"text-gray-400",children:"Tasks:"}),(0,y.jsx)("span",{className:"font-medium",children:$.length})]}),(0,y.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,y.jsx)("span",{className:"text-gray-400",children:"Subject:"}),(0,y.jsx)("span",{className:"font-medium",children:eo.subject||"Not set"})]}),(0,y.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,y.jsx)("span",{className:"text-gray-400",children:"Difficulty:"}),(0,y.jsx)("span",{className:"font-medium capitalize",children:eo.difficulty})]}),(0,y.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,y.jsx)("span",{className:"text-gray-400",children:"Mode:"}),(0,y.jsx)("span",{className:"font-medium capitalize",children:eo.distributionMode})]})]})]})]})]}),(0,y.jsx)(C.Dialog,{open:J,onOpenChange:W,children:(0,y.jsxs)(C.DialogContent,{className:"max-w-4xl h-[600px] bg-gray-900 text-white border-gray-700 flex flex-col",children:[(0,y.jsx)(C.DialogHeader,{children:(0,y.jsxs)(C.DialogTitle,{className:"flex items-center gap-2",children:[(0,y.jsx)(tn.Library,{className:"h-5 w-5 text-blue-400"}),"Task Library"]})}),(0,y.jsxs)("div",{className:"flex gap-4 py-4 border-b border-gray-800",children:[(0,y.jsxs)("div",{className:"relative flex-1",children:[(0,y.jsx)(U.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,y.jsx)(P.Input,{placeholder:"Search saved tasks...",value:Y,onChange:e=>X(e.target.value),className:"pl-9 bg-gray-800 border-gray-700 text-white focus:border-blue-500"})]}),(0,y.jsxs)(k.Button,{variant:ee?"default":"outline",onClick:()=>et(!ee),className:ee?"bg-yellow-600 hover:bg-yellow-700":"border-gray-700",children:[(0,y.jsx)(tt.Star,{className:`h-4 w-4 mr-2 ${ee?"fill-current":""}`}),"Favorites"]})]}),(0,y.jsx)(O.ScrollArea,{className:"flex-1 -mx-6 px-6",children:(0,y.jsx)("div",{className:"grid gap-3 py-4",children:0===ex().length?(0,y.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,y.jsx)(ti,{className:"h-12 w-12 mx-auto mb-3 opacity-20"}),(0,y.jsx)("p",{children:"No tasks found in library"}),(0,y.jsx)("p",{className:"text-sm",children:"Save tasks from the Review step to build your collection"})]}):ex().map(e=>(0,y.jsx)(A.Card,{className:"bg-gray-800 border-gray-700 hover:border-gray-600 transition-colors",children:(0,y.jsx)(A.CardContent,{className:"p-4",children:(0,y.jsxs)("div",{className:"flex items-start gap-4",children:[(0,y.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(S.Badge,{variant:"outline",className:"bg-gray-900 border-gray-700 text-gray-400",children:e.subject}),(0,y.jsx)(S.Badge,{variant:"secondary",children:"multiple_choice"===e.type?"MC":"SA"}),e.topics.map((e,t)=>(0,y.jsx)("span",{className:"text-xs text-gray-500",children:e},t))]}),(0,y.jsx)("p",{className:"font-medium text-white",children:e.question}),(0,y.jsxs)("div",{className:"text-xs text-gray-500 flex items-center gap-3",children:[(0,y.jsxs)("span",{children:["Used ",e.usedCount," times"]}),(0,y.jsx)("span",{children:"â€¢"}),(0,y.jsxs)("span",{children:["Saved ",new Date(e.savedAt).toLocaleDateString()]})]})]}),(0,y.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,y.jsx)(k.Button,{size:"sm",onClick:()=>em(e),children:"Add to Set"}),(0,y.jsxs)("div",{className:"flex gap-1 justify-end",children:[(0,y.jsx)(k.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>ep(e.id),children:(0,y.jsx)(tt.Star,{className:`h-4 w-4 ${e.isFavorite?"text-yellow-400 fill-current":"text-gray-500"}`})}),(0,y.jsx)(k.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-400 hover:text-red-300",onClick:()=>eg(e.id),children:(0,y.jsx)(e3.Trash2,{className:"h-4 w-4"})})]})]})]})})},e.id))})})]})}),(0,y.jsx)(C.Dialog,{open:d,onOpenChange:e=>{!h&&(u(e),e||(x([]),b(null)))},children:(0,y.jsxs)(C.DialogContent,{className:"max-w-3xl bg-gray-900 text-white border-gray-700",children:[(0,y.jsx)(C.DialogHeader,{children:(0,y.jsxs)(C.DialogTitle,{className:"flex items-center gap-2",children:[(0,y.jsx)(tc.FileUp,{className:"h-5 w-5 text-blue-400"}),"Import Content"]})}),(0,y.jsx)("div",{className:"min-h-[400px] flex flex-col",children:v?h?(0,y.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center p-8",children:[(0,y.jsxs)("div",{className:"w-24 h-24 relative mb-6",children:[(0,y.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-gray-700"}),(0,y.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-blue-500 border-t-transparent animate-spin"}),(0,y.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center font-bold text-lg",children:[p,"%"]})]}),(0,y.jsx)("h3",{className:"text-xl font-medium mb-2",children:"Analyzing Document..."}),(0,y.jsx)("p",{className:"text-gray-400 animate-pulse",children:"Running OCR and extracting questions"}),(0,y.jsxs)("div",{className:"mt-8 text-sm text-gray-500 flex items-center gap-2",children:[(0,y.jsx)(tl.FileText,{className:"h-4 w-4"}),v.name]})]}):(0,y.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-800",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{className:"font-medium",children:"Detected Questions"}),(0,y.jsxs)("p",{className:"text-sm text-gray-400",children:[f.length," items found in ",v.name]})]}),(0,y.jsxs)(k.Button,{variant:"ghost",size:"sm",onClick:()=>b(null),children:[(0,y.jsx)(K.X,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}),(0,y.jsx)(O.ScrollArea,{className:"flex-1 px-6",children:(0,y.jsx)("div",{className:"space-y-4 py-4",children:f.map((e,t)=>(0,y.jsx)(A.Card,{className:"bg-gray-800 border-gray-700",children:(0,y.jsx)(A.CardContent,{className:"p-4",children:(0,y.jsxs)("div",{className:"flex gap-3",children:[(0,y.jsx)("div",{className:"w-6 h-6 rounded-full bg-blue-900/50 flex items-center justify-center text-xs font-bold text-blue-400 shrink-0",children:t+1}),(0,y.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,y.jsx)(P.Input,{value:e.question,onChange:e=>{let s=[...f];s[t].question=e.target.value,x(s)},className:"bg-gray-900 border-gray-600"}),(0,y.jsxs)("div",{className:"flex gap-2",children:[(0,y.jsx)(S.Badge,{variant:"outline",children:e.type}),(0,y.jsx)(S.Badge,{variant:"secondary",children:e.difficulty})]})]})]})})},t))})}),(0,y.jsxs)("div",{className:"p-4 border-t border-gray-800 flex justify-end gap-3",children:[(0,y.jsx)(k.Button,{variant:"outline",onClick:()=>b(null),children:"Back"}),(0,y.jsxs)(k.Button,{onClick:()=>{V(e=>[...e,...f]),u(!1),x([]),b(null),r("review"),E.toast.success("Import Successful",{description:`Added ${f.length} tasks to your set`})},children:["Import ",f.length," Tasks"]})]})]}):(0,y.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center border-2 border-dashed border-gray-700 rounded-lg m-4 bg-gray-800/50 hover:bg-gray-800/80 transition-colors relative",children:[(0,y.jsx)("input",{type:"file",accept:".pdf,.png,.jpg,.jpeg",onChange:e=>{let t=e.target.files?.[0];if(t){if(t.size>5242880)return void E.toast.error("File too large",{description:"Please upload a file smaller than 5MB"});b(t),ey(t)}},className:"absolute inset-0 opacity-0 cursor-pointer"}),(0,y.jsx)("div",{className:"w-20 h-20 rounded-full bg-gray-800 flex items-center justify-center mb-4",children:(0,y.jsx)(to,{className:"h-10 w-10 text-gray-400"})}),(0,y.jsx)("h3",{className:"text-xl font-medium mb-2",children:"Upload Worksheet"}),(0,y.jsxs)("p",{className:"text-gray-400 text-center max-w-sm mb-6",children:["Drag and drop your PDF or Image file here,",(0,y.jsx)("br",{}),"or click to browse"]}),(0,y.jsxs)("div",{className:"flex gap-4 text-sm text-gray-500",children:[(0,y.jsxs)("span",{className:"flex items-center gap-1",children:[(0,y.jsx)(tl.FileText,{className:"h-4 w-4"})," PDF"]}),(0,y.jsxs)("span",{className:"flex items-center gap-1",children:[(0,y.jsx)(tl.FileText,{className:"h-4 w-4"})," PNG"]}),(0,y.jsxs)("span",{className:"flex items-center gap-1",children:[(0,y.jsx)(tl.FileText,{className:"h-4 w-4"})," JPG"]})]})]})})]})}),(0,y.jsx)("div",{className:`fixed inset-y-0 right-0 w-[600px] bg-gray-900 border-l border-gray-800 shadow-2xl transform transition-transform duration-300 z-50 ${M?"translate-x-0":"translate-x-full"}`,children:(0,y.jsx)(sx,{roomId:e,students:t.map(e=>({id:e.id,name:e.name,status:"on_track"===e.status?"active":e.status||"active"})),selectionMode:!0,onAssetsSelect:e=>{L(e),T(!1),E.toast.success(`Selected ${e.length} material(s)`,{description:"Assets ready for AI task generation"})},onClose:()=>T(!1)})})]})}var s_=e.i(336566);function sC({students:e,metrics:t,currentTopic:s="Derivatives and Rates of Change",classDuration:r}){let[a,n]=(0,j.useState)("insights"),[i,o]=(0,j.useState)(null),[l,c]=(0,j.useState)(!1),[d,u]=(0,j.useState)([]),[h,m]=(0,j.useState)([]),p=(0,j.useMemo)(()=>[{id:"prompt-1",context:"When discussing derivatives",question:"What do you think would happen to the slope if we made this curve steeper?",followUps:["Can you explain why?","How does that relate to the derivative?","What would the graph look like?"],difficulty:"medium"},{id:"prompt-2",context:"For students struggling with concepts",question:"Can you explain this concept in your own words?",followUps:["What part is confusing?","How would you explain it to a friend?"],difficulty:"easy"},{id:"prompt-3",context:"Advanced challenge",question:"How would this problem change if we had three variables instead of two?",followUps:["What new challenges would arise?","Which method would still work?"],difficulty:"hard"}],[]),g=(0,j.useMemo)(()=>{let t,s;return(t=[],(s=e.filter(e=>e.engagementScore<50&&"online"===e.status)).length>0&&t.push({id:"insight-1",type:"engagement",title:"Low Engagement Detected",message:`${s.length} student(s) showing low engagement`,suggestion:"Try asking a direct question or use a quick poll to re-engage",priority:"high",timestamp:new Date().toISOString(),acknowledged:!1,actionable:!0,actionLabel:"View Students"}),r>30&&r<35&&t.push({id:"insight-2",type:"pacing",title:"Pacing Alert",message:"You've been on this topic for 30+ minutes",suggestion:"Consider wrapping up with a summary or moving to practice exercises",priority:"medium",timestamp:new Date(Date.now()-3e5).toISOString(),acknowledged:!1,actionable:!0,actionLabel:"Suggest Wrap-up"}),t.push({id:"insight-3",type:"misconception",title:"Common Misconception Alert",message:'3 students may be confusing "derivative" with "slope"',suggestion:"Clarify: Derivative = instantaneous rate, Slope = average rate over interval",priority:"high",timestamp:new Date(Date.now()-6e5).toISOString(),acknowledged:!1,actionable:!0,actionLabel:"Show Explanation"}),t.push({id:"insight-4",type:"socratic",title:"Socratic Opportunity",message:"Students are ready for deeper questioning",suggestion:'Ask: "What would happen if we changed this variable?"',priority:"medium",timestamp:new Date(Date.now()-18e4).toISOString(),acknowledged:!1,actionable:!0,actionLabel:"Use Question"}),t).filter(e=>!h.includes(e.id)).map(e=>({...e,acknowledged:d.includes(e.id)}))},[e,r,d,h]),f=g.filter(e=>!e.acknowledged);return(0,y.jsxs)(A.Card,{className:"h-full flex flex-col",children:[(0,y.jsxs)(A.CardHeader,{className:"pb-3",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-blue-500 rounded-lg flex items-center justify-center",children:(0,y.jsx)(ea.Sparkles,{className:"w-4 h-4 text-white"})}),(0,y.jsxs)("div",{children:[(0,y.jsx)(A.CardTitle,{className:"text-sm font-medium",children:"AI Teaching Assistant"}),(0,y.jsx)("p",{className:"text-xs text-gray-500",children:"Real-time insights & guidance"})]})]}),f.length>0&&(0,y.jsxs)(S.Badge,{variant:"destructive",className:"text-xs",children:[f.length," New"]})]}),(0,y.jsxs)("div",{className:"flex gap-1 mt-3",children:[(0,y.jsxs)(k.Button,{variant:"insights"===a?"default":"ghost",size:"sm",className:"flex-1 text-xs",onClick:()=>n("insights"),children:[(0,y.jsx)(eq.Zap,{className:"w-3 h-3 mr-1"}),"Insights"]}),(0,y.jsxs)(k.Button,{variant:"socratic"===a?"default":"ghost",size:"sm",className:"flex-1 text-xs",onClick:()=>n("socratic"),children:[(0,y.jsx)(eE.HelpCircle,{className:"w-3 h-3 mr-1"}),"Socratic"]}),(0,y.jsxs)(k.Button,{variant:"guide"===a?"default":"ghost",size:"sm",className:"flex-1 text-xs",onClick:()=>n("guide"),children:[(0,y.jsx)(e8.BookOpen,{className:"w-3 h-3 mr-1"}),"Guide"]})]})]}),(0,y.jsx)(A.CardContent,{className:"flex-1 p-0",children:(0,y.jsx)(O.ScrollArea,{className:"h-[calc(100%-20px)]",children:(0,y.jsxs)("div",{className:"px-4 pb-4",children:["insights"===a&&(0,y.jsx)("div",{className:"space-y-3",children:0===g.length?(0,y.jsxs)("div",{className:"text-center py-8",children:[(0,y.jsx)(ea.Sparkles,{className:"w-10 h-10 text-gray-300 mx-auto mb-2"}),(0,y.jsx)("p",{className:"text-sm text-gray-500",children:"No insights yet"}),(0,y.jsx)("p",{className:"text-xs text-gray-400",children:"AI is monitoring the class..."})]}):g.map(e=>(0,y.jsx)("div",{className:(0,L.cn)("p-3 rounded-lg border transition-all",e.acknowledged?"bg-gray-50 border-gray-200 opacity-60":"bg-white border-gray-200 shadow-sm","high"===e.priority&&!e.acknowledged&&"border-l-4 border-l-red-500"),children:(0,y.jsxs)("div",{className:"flex items-start gap-3",children:[(e=>{switch(e){case"guidance":return(0,y.jsx)(e8.BookOpen,{className:"w-4 h-4 text-blue-500"});case"misconception":return(0,y.jsx)(s_.AlertTriangle,{className:"w-4 h-4 text-orange-500"});case"pacing":return(0,y.jsx)(ei.Clock,{className:"w-4 h-4 text-purple-500"});case"engagement":return(0,y.jsx)(eq.Zap,{className:"w-4 h-4 text-yellow-500"});case"socratic":return(0,y.jsx)(eE.HelpCircle,{className:"w-4 h-4 text-green-500"});default:return(0,y.jsx)(ea.Sparkles,{className:"w-4 h-4 text-blue-500"})}})(e.type),(0,y.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsx)("span",{className:"font-medium text-sm",children:e.title}),(0,y.jsx)(S.Badge,{variant:"outline",className:(0,L.cn)("text-xs",(e=>{switch(e){case"high":return"bg-red-100 text-red-700 border-red-200";case"medium":return"bg-yellow-100 text-yellow-700 border-yellow-200";case"low":return"bg-blue-100 text-blue-700 border-blue-200";default:return"bg-gray-100 text-gray-700"}})(e.priority)),children:e.priority})]}),(0,y.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.message}),e.suggestion&&(0,y.jsxs)("div",{className:"mt-2 p-2 bg-blue-50 rounded text-sm text-blue-800",children:[(0,y.jsx)(H.Lightbulb,{className:"w-3 h-3 inline mr-1"}),e.suggestion]}),!e.acknowledged&&(0,y.jsxs)("div",{className:"flex gap-2 mt-3",children:[e.actionable&&(0,y.jsxs)(k.Button,{size:"sm",variant:"outline",className:"flex-1 text-xs",children:[e.actionLabel,(0,y.jsx)(so.ChevronRight,{className:"w-3 h-3 ml-1"})]}),(0,y.jsxs)(k.Button,{size:"sm",variant:"ghost",className:"text-xs",onClick:()=>{var t;return t=e.id,void u(e=>e.includes(t)?e:[...e,t])},children:[(0,y.jsx)(eL.Check,{className:"w-3 h-3 mr-1"}),"Got it"]}),(0,y.jsx)(k.Button,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>{var t;return t=e.id,void m(e=>e.includes(t)?e:[...e,t])},children:(0,y.jsx)(K.X,{className:"w-3 h-3"})})]})]})]})},e.id))}),"socratic"===a&&(0,y.jsx)("div",{className:"space-y-3",children:i?(0,y.jsxs)("div",{className:"space-y-3",children:[(0,y.jsx)(k.Button,{variant:"ghost",size:"sm",className:"text-xs",onClick:()=>{o(null),c(!1)},children:"â† Back to prompts"}),(0,y.jsxs)("div",{className:"p-4 bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg border border-blue-200",children:[(0,y.jsx)(S.Badge,{className:"mb-2 bg-blue-600",children:"Selected Prompt"}),(0,y.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:i.context}),(0,y.jsx)("p",{className:"font-medium text-lg text-gray-800",children:i.question}),(0,y.jsxs)(k.Button,{className:"w-full mt-4 gap-2",onClick:()=>c(!0),children:[(0,y.jsx)(z.MessageCircle,{className:"w-4 h-4"}),"Ask This Question"]}),l&&(0,y.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,y.jsx)("p",{className:"text-xs font-medium text-gray-500",children:"Follow-up questions:"}),i.followUps.map((e,t)=>(0,y.jsx)("button",{className:"w-full text-left p-2 bg-white rounded border hover:border-blue-300 text-sm transition-colors",children:e},t))]})]})]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"p-3 bg-purple-50 rounded-lg border border-purple-200",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,y.jsx)(e8.BookOpen,{className:"w-4 h-4 text-purple-600"}),(0,y.jsx)("span",{className:"font-medium text-sm text-purple-800",children:"Current Topic"})]}),(0,y.jsx)("p",{className:"text-sm text-purple-700",children:s})]}),(0,y.jsx)("p",{className:"text-xs text-gray-500 font-medium mt-4 mb-2",children:"SUGGESTED QUESTIONS"}),p.map(e=>(0,y.jsxs)("button",{className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all",onClick:()=>o(e),children:[(0,y.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,y.jsx)("span",{className:"text-xs text-gray-500",children:e.context}),(0,y.jsx)(S.Badge,{variant:"outline",className:"text-xs",children:e.difficulty})]}),(0,y.jsx)("p",{className:"text-sm font-medium text-gray-800",children:e.question})]},e.id))]})}),"guide"===a&&(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)("div",{className:"p-3 bg-gradient-to-br from-green-50 to-blue-50 rounded-lg border",children:[(0,y.jsxs)("h3",{className:"font-medium text-sm mb-2 flex items-center gap-2",children:[(0,y.jsx)(ef.BarChart3,{className:"w-4 h-4"}),"Lesson Progress"]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,y.jsx)("span",{className:"text-gray-600",children:"Time elapsed"}),(0,y.jsxs)("span",{className:"font-medium",children:[Math.floor(r/60),"h ",r%60,"m"]})]}),(0,y.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,y.jsx)("div",{className:"h-full bg-gradient-to-r from-green-500 to-blue-500 rounded-full",style:{width:`${Math.min(r/90*100,100)}%`}})}),(0,y.jsx)("p",{className:"text-xs text-gray-500",children:r<45?"Early phase - good for introducing concepts":r<75?"Mid-lesson - consider practice activities":"Wrapping up - time for summary and review"}),t&&(0,y.jsxs)("p",{className:"text-xs text-gray-500",children:["Current class engagement: ",t.averageEngagement,"%"]})]})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)("h3",{className:"font-medium text-sm flex items-center gap-2",children:[(0,y.jsx)(ei.Clock,{className:"w-4 h-4"}),"Recommended Next Steps"]}),(0,y.jsxs)("div",{className:"space-y-2",children:[r<30&&(0,y.jsxs)("div",{className:"p-3 bg-white rounded-lg border border-gray-200",children:[(0,y.jsx)("p",{className:"text-sm font-medium",children:"Continue Concept Introduction"}),(0,y.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Use visual examples and ask for student predictions"})]}),(0,y.jsxs)("div",{className:"p-3 bg-white rounded-lg border border-gray-200",children:[(0,y.jsx)("p",{className:"text-sm font-medium",children:"Check for Understanding"}),(0,y.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:'Quick poll: "Rate your confidence 1-5"'})]}),(0,y.jsxs)("div",{className:"p-3 bg-white rounded-lg border border-gray-200",children:[(0,y.jsx)("p",{className:"text-sm font-medium",children:"Practice Exercise"}),(0,y.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Give students 3 minutes to solve independently"})]}),(0,y.jsxs)("div",{className:"p-3 bg-white rounded-lg border border-gray-200",children:[(0,y.jsx)("p",{className:"text-sm font-medium",children:"Breakout Discussion"}),(0,y.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Group students to explain concepts to each other"})]})]})]}),(0,y.jsxs)("div",{className:"p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[(0,y.jsxs)("h3",{className:"font-medium text-sm mb-2 flex items-center gap-2 text-yellow-800",children:[(0,y.jsx)(H.Lightbulb,{className:"w-4 h-4"}),"Teaching Tip"]}),(0,y.jsx)("p",{className:"text-xs text-yellow-700",children:"Students retain 90% of what they teach others. Consider having students explain concepts to the class."})]})]})]})})})]})}var sM=e.i(591768),sT=e.i(875968),sE=e.i(693941);function sA({students:e,classDuration:t}){let[s,r]=(0,j.useState)("overview"),a=Math.round(e.filter(e=>"online"===e.status).reduce((e,t)=>e+t.engagementScore,0)/Math.max(1,e.filter(e=>"online"===e.status).length)),n=Math.round(e.filter(e=>e.chatMessages>0||e.reactions>0).length/Math.max(1,e.length)*100),i=e.filter(e=>e.engagementScore<50&&"online"===e.status),o=e.filter(e=>e.engagementScore>=85&&"online"===e.status),l=[{label:"Avg Engagement",value:a,change:5,trend:"up"},{label:"Participation",value:n,change:3,trend:"up"},{label:"Attention Rate",value:Math.round(e.filter(e=>"high"===e.attentionLevel).length/Math.max(1,e.length)*100),change:-2,trend:"down"}];return(0,y.jsxs)(A.Card,{className:"h-full flex flex-col",children:[(0,y.jsx)(A.CardHeader,{className:"pb-3",children:(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(eH.TrendingUp,{className:"w-4 h-4"}),(0,y.jsx)(A.CardTitle,{className:"text-sm font-medium",children:"Progress Tracking"})]}),(0,y.jsxs)("div",{className:"flex gap-1",children:[(0,y.jsx)(k.Button,{variant:"overview"===s?"default":"ghost",size:"sm",className:"text-xs h-7",onClick:()=>r("overview"),children:"Overview"}),(0,y.jsx)(k.Button,{variant:"individual"===s?"default":"ghost",size:"sm",className:"text-xs h-7",onClick:()=>r("individual"),children:"Students"})]})]})}),(0,y.jsx)(A.CardContent,{className:"flex-1 p-0",children:(0,y.jsx)(O.ScrollArea,{className:"h-[calc(100%-60px)]",children:(0,y.jsx)("div",{className:"px-4 pb-4 space-y-4",children:"overview"===s?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"grid grid-cols-3 gap-2",children:l.map((e,t)=>(0,y.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg text-center",children:[(0,y.jsxs)("p",{className:"text-lg font-bold",children:[e.value,"%"]}),(0,y.jsx)("p",{className:"text-xs text-gray-500",children:e.label}),(0,y.jsxs)("div",{className:"flex items-center justify-center gap-1 mt-1",children:[(e=>{switch(e){case"up":return(0,y.jsx)(sT.ArrowUpRight,{className:"w-4 h-4 text-green-500"});case"down":return(0,y.jsx)(sE.ArrowDownRight,{className:"w-4 h-4 text-red-500"});default:return(0,y.jsx)(eG.Minus,{className:"w-4 h-4 text-gray-400"})}})(e.trend),(0,y.jsxs)("span",{className:(0,L.cn)("text-xs","up"===e.trend?"text-green-600":"down"===e.trend?"text-red-600":"text-gray-500"),children:[e.change>0?"+":"",e.change,"%"]})]})]},t))}),(0,y.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,y.jsxs)("h3",{className:"text-sm font-medium mb-3 flex items-center gap-2",children:[(0,y.jsx)(D.Users,{className:"w-4 h-4"}),"Engagement Distribution"]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("span",{className:"text-xs w-16",children:"High (85%+)"}),(0,y.jsx)("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,y.jsx)("div",{className:"h-full bg-green-500 rounded-full",style:{width:`${o.length/e.length*100}%`}})}),(0,y.jsx)("span",{className:"text-xs w-8 text-right",children:o.length})]}),(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("span",{className:"text-xs w-16",children:"Medium"}),(0,y.jsx)("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,y.jsx)("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${e.filter(e=>e.engagementScore>=50&&e.engagementScore<85).length/e.length*100}%`}})}),(0,y.jsx)("span",{className:"text-xs w-8 text-right",children:e.filter(e=>e.engagementScore>=50&&e.engagementScore<85).length})]}),(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("span",{className:"text-xs w-16",children:"Low (<50%)"}),(0,y.jsx)("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,y.jsx)("div",{className:"h-full bg-red-500 rounded-full",style:{width:`${i.length/e.length*100}%`}})}),(0,y.jsx)("span",{className:"text-xs w-8 text-right",children:i.length})]})]})]}),i.length>0&&(0,y.jsxs)("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200",children:[(0,y.jsxs)("h3",{className:"text-sm font-medium text-red-800 mb-2 flex items-center gap-2",children:[(0,y.jsx)(s_.AlertTriangle,{className:"w-4 h-4"}),"Students Need Attention"]}),(0,y.jsxs)("div",{className:"space-y-2",children:[i.slice(0,3).map(e=>(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsx)("span",{className:"text-sm text-red-700",children:e.name}),(0,y.jsxs)(S.Badge,{variant:"outline",className:"text-xs bg-white",children:[e.engagementScore,"% engagement"]})]},e.id)),i.length>3&&(0,y.jsxs)("p",{className:"text-xs text-red-600",children:["+",i.length-3," more students"]})]})]}),(0,y.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,y.jsxs)("h3",{className:"text-sm font-medium mb-3 flex items-center gap-2",children:[(0,y.jsx)(ei.Clock,{className:"w-4 h-4"}),"Class Activity"]}),(0,y.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,y.jsxs)("div",{className:"flex justify-between",children:[(0,y.jsx)("span",{className:"text-gray-600",children:"Duration"}),(0,y.jsxs)("span",{className:"font-medium",children:[Math.floor(t/60),"h ",t%60,"m"]})]}),(0,y.jsxs)("div",{className:"flex justify-between",children:[(0,y.jsx)("span",{className:"text-gray-600",children:"Messages"}),(0,y.jsx)("span",{className:"font-medium",children:e.reduce((e,t)=>e+t.chatMessages,0)})]}),(0,y.jsxs)("div",{className:"flex justify-between",children:[(0,y.jsx)("span",{className:"text-gray-600",children:"Reactions"}),(0,y.jsx)("span",{className:"font-medium",children:e.reduce((e,t)=>e+t.reactions,0)})]}),(0,y.jsxs)("div",{className:"flex justify-between",children:[(0,y.jsx)("span",{className:"text-gray-600",children:"Hand Raises"}),(0,y.jsx)("span",{className:"font-medium",children:e.filter(e=>e.handRaised).length})]})]})]})]}):(0,y.jsx)("div",{className:"space-y-2",children:e.sort((e,t)=>t.engagementScore-e.engagementScore).map(e=>(0,y.jsxs)("div",{className:(0,L.cn)("p-3 rounded-lg border",e.engagementScore>=85?"bg-green-50 border-green-200":e.engagementScore>=50?"bg-white border-gray-200":"bg-red-50 border-red-200"),children:[(0,y.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("div",{className:(0,L.cn)("w-2 h-2 rounded-full","online"===e.status?"bg-green-500":"idle"===e.status?"bg-yellow-500":"bg-gray-400")}),(0,y.jsx)("span",{className:"font-medium text-sm",children:e.name})]}),(0,y.jsxs)("span",{className:(0,L.cn)("text-sm font-bold",e.engagementScore>=85?"text-green-600":e.engagementScore>=50?"text-blue-600":"text-red-600"),children:[e.engagementScore,"%"]})]}),(0,y.jsx)(sM.Progress,{value:e.engagementScore,className:"h-1.5"}),(0,y.jsxs)("div",{className:"flex items-center gap-3 mt-2 text-xs text-gray-500",children:[(0,y.jsxs)("span",{className:"flex items-center gap-1",children:[(0,y.jsx)(Z.Target,{className:"w-3 h-3"}),e.attentionLevel]}),(0,y.jsx)("span",{children:"â€¢"}),(0,y.jsxs)("span",{children:[e.chatMessages," messages"]}),(0,y.jsx)("span",{children:"â€¢"}),(0,y.jsxs)("span",{children:[e.reactions," reactions"]})]})]},e.id))})})})})]})}var sP=e.i(650702),sI=e.i(791078),sO=e.i(913674),sL=e.i(518696),sD=e.i(894878);function sR(e,t=[]){let s=[],r=()=>{let t=s.map(e=>j.createContext(e));return function(s){let r=s?.[e]||t;return j.useMemo(()=>({[`__scope${e}`]:{...s,[e]:r}}),[s,r])}};return r.scopeName=e,[function(t,r){let a=j.createContext(r),n=s.length;s=[...s,r];let i=t=>{let{scope:s,children:r,...i}=t,o=s?.[e]?.[n]||a,l=j.useMemo(()=>i,Object.values(i));return(0,y.jsx)(o.Provider,{value:l,children:r})};return i.displayName=t+"Provider",[i,function(s,i){let o=i?.[e]?.[n]||a,l=j.useContext(o);if(l)return l;if(void 0!==r)return r;throw Error(`\`${s}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let s=()=>{let s=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let r=s.reduce((t,{useScope:s,scopeName:r})=>{let a=s(e)[`__scope${r}`];return{...t,...a}},{});return j.useMemo(()=>({[`__scope${t.scopeName}`]:r}),[r])}};return s.scopeName=t.scopeName,s}(r,...t)]}e.i(312515);var sB=Symbol("radix.slottable");function sF(e){return j.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===sB}var sz=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{var s,r;let a,n,i,o=(r=s=`Primitive.${t}`,(a=j.forwardRef((e,t)=>{let{children:s,...r}=e;if(j.isValidElement(s)){var a;let e,n,i=(a=s,(n=(e=Object.getOwnPropertyDescriptor(a.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.ref:(n=(e=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.props.ref:a.props.ref||a.ref),o=function(e,t){let s={...t};for(let r in t){let a=e[r],n=t[r];/^on[A-Z]/.test(r)?a&&n?s[r]=(...e)=>{let t=n(...e);return a(...e),t}:a&&(s[r]=a):"style"===r?s[r]={...a,...n}:"className"===r&&(s[r]=[a,n].filter(Boolean).join(" "))}return{...e,...s}}(r,s.props);return s.type!==j.Fragment&&(o.ref=t?(0,sD.composeRefs)(t,i):i),j.cloneElement(s,o)}return j.Children.count(s)>1?j.Children.only(null):null})).displayName=`${r}.SlotClone`,n=a,(i=j.forwardRef((e,t)=>{let{children:s,...r}=e,a=j.Children.toArray(s),i=a.find(sF);if(i){let e=i.props.children,s=a.map(t=>t!==i?t:j.Children.count(e)>1?j.Children.only(null):j.isValidElement(e)?e.props.children:null);return(0,y.jsx)(n,{...r,ref:t,children:j.isValidElement(e)?j.cloneElement(e,void 0,s):null})}return(0,y.jsx)(n,{...r,ref:t,children:s})})).displayName=`${s}.Slot`,i),l=j.forwardRef((e,s)=>{let{asChild:r,...a}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,y.jsx)(r?o:t,{...a,ref:s})});return l.displayName=`Primitive.${t}`,{...e,[t]:l}},{}),s$=e.i(939130),sV=e.i(67343),sU=e.i(422955),sq=e.i(62853),sH=e.i(307003),sJ=e.i(895067),sG="Radio",[sW,sQ]=sR(sG),[sK,sY]=sW(sG),sX=j.forwardRef((e,t)=>{let{__scopeRadio:s,name:r,checked:a=!1,required:n,disabled:i,value:o="on",onCheck:l,form:c,...d}=e,[u,h]=j.useState(null),m=(0,sD.useComposedRefs)(t,e=>h(e)),p=j.useRef(!1),g=!u||c||!!u.closest("form");return(0,y.jsxs)(sK,{scope:s,checked:a,disabled:i,children:[(0,y.jsx)(sz.button,{type:"button",role:"radio","aria-checked":a,"data-state":s2(a),"data-disabled":i?"":void 0,disabled:i,value:o,...d,ref:m,onClick:(0,sL.composeEventHandlers)(e.onClick,e=>{a||l?.(),g&&(p.current=e.isPropagationStopped(),p.current||e.stopPropagation())})}),g&&(0,y.jsx)(s1,{control:u,bubbles:!p.current,name:r,value:o,checked:a,required:n,disabled:i,form:c,style:{transform:"translateX(-100%)"}})]})});sX.displayName=sG;var sZ="RadioIndicator",s0=j.forwardRef((e,t)=>{let{__scopeRadio:s,forceMount:r,...a}=e,n=sY(sZ,s);return(0,y.jsx)(sJ.Presence,{present:r||n.checked,children:(0,y.jsx)(sz.span,{"data-state":s2(n.checked),"data-disabled":n.disabled?"":void 0,...a,ref:t})})});s0.displayName=sZ;var s1=j.forwardRef(({__scopeRadio:e,control:t,checked:s,bubbles:r=!0,...a},n)=>{let i=j.useRef(null),o=(0,sD.useComposedRefs)(i,n),l=(0,sH.usePrevious)(s),c=(0,sq.useSize)(t);return j.useEffect(()=>{let e=i.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(l!==s&&t){let a=new Event("click",{bubbles:r});t.call(e,s),e.dispatchEvent(a)}},[l,s,r]),(0,y.jsx)(sz.input,{type:"radio","aria-hidden":!0,defaultChecked:s,...a,tabIndex:-1,ref:o,style:{...a.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function s2(e){return e?"checked":"unchecked"}s1.displayName="RadioBubbleInput";var s4=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],s5="RadioGroup",[s3,s6]=sR(s5,[s$.createRovingFocusGroupScope,sQ]),s8=(0,s$.createRovingFocusGroupScope)(),s7=sQ(),[s9,re]=s3(s5),rt=j.forwardRef((e,t)=>{let{__scopeRadioGroup:s,name:r,defaultValue:a,value:n,required:i=!1,disabled:o=!1,orientation:l,dir:c,loop:d=!0,onValueChange:u,...h}=e,m=s8(s),p=(0,sU.useDirection)(c),[g,f]=(0,sV.useControllableState)({prop:n,defaultProp:a??null,onChange:u,caller:s5});return(0,y.jsx)(s9,{scope:s,name:r,required:i,disabled:o,value:g,onValueChange:f,children:(0,y.jsx)(s$.Root,{asChild:!0,...m,orientation:l,dir:p,loop:d,children:(0,y.jsx)(sz.div,{role:"radiogroup","aria-required":i,"aria-orientation":l,"data-disabled":o?"":void 0,dir:p,...h,ref:t})})})});rt.displayName=s5;var rs="RadioGroupItem",rr=j.forwardRef((e,t)=>{let{__scopeRadioGroup:s,disabled:r,...a}=e,n=re(rs,s),i=n.disabled||r,o=s8(s),l=s7(s),c=j.useRef(null),d=(0,sD.useComposedRefs)(t,c),u=n.value===a.value,h=j.useRef(!1);return j.useEffect(()=>{let e=e=>{s4.includes(e.key)&&(h.current=!0)},t=()=>h.current=!1;return document.addEventListener("keydown",e),document.addEventListener("keyup",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}},[]),(0,y.jsx)(s$.Item,{asChild:!0,...o,focusable:!i,active:u,children:(0,y.jsx)(sX,{disabled:i,required:n.required,checked:u,...l,...a,name:n.name,ref:d,onCheck:()=>n.onValueChange(a.value),onKeyDown:(0,sL.composeEventHandlers)(e=>{"Enter"===e.key&&e.preventDefault()}),onFocus:(0,sL.composeEventHandlers)(a.onFocus,()=>{h.current&&c.current?.click()})})})});rr.displayName=rs;var ra=j.forwardRef((e,t)=>{let{__scopeRadioGroup:s,...r}=e,a=s7(s);return(0,y.jsx)(s0,{...a,...r,ref:t})});ra.displayName="RadioGroupIndicator";var rn=e.i(74043);let ri=j.forwardRef(({className:e,...t},s)=>(0,y.jsx)(rt,{className:(0,L.cn)("grid gap-2",e),...t,ref:s}));ri.displayName=rt.displayName;let ro=j.forwardRef(({className:e,...t},s)=>(0,y.jsx)(rr,{ref:s,className:(0,L.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:(0,y.jsx)(ra,{className:"flex items-center justify-center",children:(0,y.jsx)(rn.Circle,{className:"h-2.5 w-2.5 fill-current text-current"})})}));ro.displayName=rr.displayName;var rl=e.i(672643),rc=e.i(36438);let rd=(0,ee.default)("cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);var ru=e.i(962825);let rh=[{id:"understanding-check",name:"Understanding Check",icon:"HelpCircle",description:"Quick yes/no check for concept understanding",defaultQuestion:"Do you understand this concept?",type:"true_false",options:["Yes, I understand","No, I need clarification"]},{id:"confidence-rating",name:"Confidence Rating",icon:"Gauge",description:"Rate confidence level on a scale of 1-5",defaultQuestion:"How confident are you with this topic?",type:"rating",options:["1 - Not confident","2","3","4","5 - Very confident"]},{id:"topic-review",name:"Topic Review Vote",icon:"List",description:"Let students vote on what to review next",defaultQuestion:"Which topic should we review next?",type:"multiple_choice",options:["Topic A","Topic B","Topic C","Topic D"]},{id:"ready-to-proceed",name:"Ready to Move On?",icon:"Play",description:"Check if students are ready to continue",defaultQuestion:"Are you ready to move on to the next section?",type:"true_false",options:["Yes, let's continue","No, I need more time"]},{id:"quick-quiz",name:"Quick Quiz",icon:"Brain",description:"Multiple choice question with correct answer",defaultQuestion:"What is the correct answer?",type:"multiple_choice",options:["Option A","Option B","Option C","Option D"]},{id:"word-cloud",name:"Word Cloud",icon:"Cloud",description:"Collect single-word responses from students",defaultQuestion:"What's one word that describes your understanding?",type:"word_cloud"},{id:"short-answer",name:"Short Answer",icon:"MessageSquare",description:"Open-ended question for detailed responses",defaultQuestion:"What questions do you have about this topic?",type:"short_answer"},{id:"pace-check",name:"Pace Check",icon:"Clock",description:"Check if the teaching pace is appropriate",defaultQuestion:"How is the pace of the lesson?",type:"multiple_choice",options:["Too slow","Just right","Too fast","Way too fast"]}];function rm(e){return String.fromCharCode(65+e)}let rp=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899","#06b6d4","#84cc16"],rg={HelpCircle:eE.HelpCircle,Gauge:rl.Gauge,List:e9.List,Play:rc.Play,Brain:X.Brain,Cloud:rd,MessageSquare:eg.MessageSquare,Clock:ei.Clock};function rf({onSubmit:e,onCancel:t}){let[s,r]=(0,j.useState)("template"),[a,n]=(0,j.useState)(null),[i,o]=(0,j.useState)(""),[l,c]=(0,j.useState)("multiple_choice"),[d,u]=(0,j.useState)([{label:"A",text:""},{label:"B",text:""}]),[h,m]=(0,j.useState)(!0),[p,g]=(0,j.useState)(!1),[f,x]=(0,j.useState)(!0),[v,b]=(0,j.useState)(void 0),w=(0,j.useCallback)(e=>{let t=rh.find(t=>t.id===e);t&&(n(e),o(t.defaultQuestion),c(t.type),t.options?u(t.options.map((e,t)=>({label:rm(t),text:e}))):u([{label:"A",text:""},{label:"B",text:""}]),r("customize"))},[]),N=(0,j.useCallback)(()=>{d.length>=6||u(e=>[...e,{label:rm(e.length),text:""}])},[d.length]),S=(0,j.useCallback)(e=>{d.length<=2||u(t=>t.filter((t,s)=>s!==e).map((e,t)=>({...e,label:rm(t)})))},[d.length]),_=(0,j.useCallback)((e,t)=>{u(s=>s.map((s,r)=>r===e?{...s,text:t}:s))},[]),C=(0,j.useCallback)(()=>{!i.trim()||("multiple_choice"===l||"true_false"===l)&&d.some(e=>!e.text.trim())||e({question:i.trim(),type:l,options:d,isAnonymous:h,allowMultiple:p,showResults:f,timeLimit:v})},[i,l,d,h,p,f,v,e]);if("template"===s)return(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,y.jsx)(k.Button,{variant:"ghost",size:"icon",onClick:t,children:(0,y.jsx)(ru.ArrowLeft,{className:"h-4 w-4"})}),(0,y.jsx)("h4",{className:"font-medium",children:"Choose a Template"})]}),(0,y.jsx)("div",{className:"grid grid-cols-2 gap-3",children:rh.map(e=>{let t=rg[e.icon]||eE.HelpCircle;return(0,y.jsxs)("button",{onClick:()=>w(e.id),className:(0,L.cn)("p-4 border rounded-lg text-left transition-all hover:border-blue-500 hover:bg-blue-50",a===e.id&&"border-blue-500 bg-blue-50"),children:[(0,y.jsx)(t,{className:"h-5 w-5 text-blue-600 mb-2"}),(0,y.jsx)("h5",{className:"font-medium text-sm",children:e.name}),(0,y.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.description})]},e.id)})}),(0,y.jsx)(k.Button,{variant:"outline",className:"w-full",onClick:()=>{n(null),r("customize")},children:"Start from Scratch"})]});let M=i.trim()&&("short_answer"===l||"word_cloud"===l||d.every(e=>e.text.trim()));return(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,y.jsx)(k.Button,{variant:"ghost",size:"icon",onClick:()=>r("template"),children:(0,y.jsx)(ru.ArrowLeft,{className:"h-4 w-4"})}),(0,y.jsx)("h4",{className:"font-medium",children:"Customize Poll"})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(e2.Label,{children:"Question"}),(0,y.jsx)(e4.Textarea,{value:i,onChange:e=>o(e.target.value),placeholder:"Enter your question...",className:"min-h-[80px]"})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(e2.Label,{children:"Poll Type"}),(0,y.jsx)(ri,{value:l,onValueChange:e=>c(e),className:"grid grid-cols-2 gap-2",children:[{value:"multiple_choice",label:"Multiple Choice"},{value:"true_false",label:"Yes / No"},{value:"rating",label:"Rating (1-5)"},{value:"short_answer",label:"Short Answer"},{value:"word_cloud",label:"Word Cloud"}].map(e=>(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)(ro,{value:e.value,id:e.value}),(0,y.jsx)(e2.Label,{htmlFor:e.value,className:"text-sm cursor-pointer",children:e.label})]},e.value))})]}),("multiple_choice"===l||"true_false"===l)&&(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsx)(e2.Label,{children:"Options"}),d.length<6&&(0,y.jsxs)(k.Button,{type:"button",variant:"ghost",size:"sm",onClick:N,children:[(0,y.jsx)(Y.Plus,{className:"h-4 w-4 mr-1"}),"Add Option"]})]}),(0,y.jsx)("div",{className:"space-y-2",children:d.map((e,t)=>(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("span",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium text-white shrink-0",style:{backgroundColor:rp[t%rp.length]},children:e.label}),(0,y.jsx)(P.Input,{value:e.text,onChange:e=>_(t,e.target.value),placeholder:`Option ${e.label}`,className:"flex-1"}),d.length>2&&(0,y.jsx)(k.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>S(t),className:"text-red-500 hover:text-red-600 shrink-0",children:(0,y.jsx)(e3.Trash2,{className:"h-4 w-4"})})]},t))})]}),(0,y.jsxs)("div",{className:"space-y-3 pt-2 border-t",children:[(0,y.jsx)("h5",{className:"font-medium text-sm",children:"Settings"}),(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"space-y-0.5",children:[(0,y.jsx)(e2.Label,{className:"text-sm",children:"Anonymous Voting"}),(0,y.jsx)("p",{className:"text-xs text-gray-500",children:"Hide voter identities"})]}),(0,y.jsx)(sO.Switch,{checked:h,onCheckedChange:m})]}),("multiple_choice"===l||"true_false"===l)&&(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"space-y-0.5",children:[(0,y.jsx)(e2.Label,{className:"text-sm",children:"Allow Multiple Selections"}),(0,y.jsx)("p",{className:"text-xs text-gray-500",children:"Voters can choose multiple options"})]}),(0,y.jsx)(sO.Switch,{checked:p,onCheckedChange:g})]}),(0,y.jsxs)("div",{className:"flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"space-y-0.5",children:[(0,y.jsx)(e2.Label,{className:"text-sm",children:"Show Results to Students"}),(0,y.jsx)("p",{className:"text-xs text-gray-500",children:"Display live results to participants"})]}),(0,y.jsx)(sO.Switch,{checked:f,onCheckedChange:x})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)(e2.Label,{className:"text-sm",children:"Time Limit (optional)"}),(0,y.jsx)("div",{className:"flex gap-2",children:[30,60,120,300].map(e=>(0,y.jsx)(k.Button,{type:"button",variant:v===e?"default":"outline",size:"sm",onClick:()=>b(v===e?void 0:e),children:e<60?`${e}s`:`${Math.floor(e/60)}m`},e))})]})]}),(0,y.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,y.jsx)(k.Button,{variant:"outline",onClick:t,className:"flex-1",children:"Cancel"}),(0,y.jsx)(k.Button,{onClick:C,disabled:!M,className:"flex-1",children:"Create Poll"})]})]})}function rx(e,t){let s=e.responses?.length||0,r=t>0?Math.round(s/t*100):0,a=e.options.map(t=>{let r=0;if("rating"===e.type){let s=parseInt(t.label);r=e.responses?.filter(e=>e.rating===s).length||0}else r="word_cloud"===e.type||"short_answer"===e.type?e.responses?.filter(e=>e.textAnswer&&e.textAnswer.trim()).length||0:e.responses?.filter(e=>e.optionIds?.includes(t.id)).length||0;let a=s>0?Math.round(r/s*100):0;return{optionId:t.id,count:r,percentage:a}});return{totalVotes:s,participationRate:r,optionStats:a}}function rv(e){if(!e.startedAt||!e.timeLimit)return null;let t=new Date(e.startedAt).getTime(),s=Date.now()-t;return Math.max(0,Math.floor((1e3*e.timeLimit-s)/1e3))}function ry(e){if("word_cloud"!==e.type&&"short_answer"!==e.type)return[];let t={};return e.responses?.forEach(e=>{e.textAnswer&&e.textAnswer.toLowerCase().split(/\s+/).map(e=>e.replace(/[^\w\u4e00-\u9fff]/g,"")).filter(e=>e.length>0).forEach(e=>{t[e]=(t[e]||0)+1})}),Object.entries(t).map(([e,t])=>({word:e,count:t})).sort((e,t)=>t.count-e.count)}function rb({poll:e,totalStudents:t,onEnd:s}){let r,a,[n,i]=(0,j.useState)(Date.now()),o=rx(e,t),l=rv(e),c=null!==(r=rv(e))&&r<=0;return(0,j.useEffect)(()=>{let e=setInterval(()=>{i(Date.now())},1e3);return()=>clearInterval(e)},[]),(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)("div",{className:"flex items-start justify-between",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)(S.Badge,{className:"bg-green-100 text-green-700 border-green-200 mb-2",children:"â— Live"}),(0,y.jsx)("h4",{className:"font-medium text-gray-900",children:e.question}),(0,y.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[e.type.replace("_"," ")," â€¢ ",e.isAnonymous?"Anonymous":"Named"]})]}),null!==l&&!c&&(0,y.jsxs)("div",{className:"flex items-center gap-1 text-orange-600 bg-orange-50 px-2 py-1 rounded",children:[(0,y.jsx)(ei.Clock,{className:"h-4 w-4"}),(0,y.jsx)("span",{className:"font-mono font-medium",children:(a=Math.floor(l/60),`${a}:${(l%60).toString().padStart(2,"0")}`)})]})]}),(0,y.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,y.jsx)(rS,{icon:(0,y.jsx)(D.Users,{className:"h-4 w-4"}),value:o.totalVotes,label:"Responses"}),(0,y.jsx)(rS,{icon:(0,y.jsx)(eH.TrendingUp,{className:"h-4 w-4"}),value:`${o.participationRate}%`,label:"Participation"}),(0,y.jsx)(rS,{icon:(0,y.jsx)(ef.BarChart3,{className:"h-4 w-4"}),value:t-o.totalVotes,label:"Remaining"})]}),(0,y.jsxs)("div",{className:"space-y-1",children:[(0,y.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,y.jsx)("span",{className:"text-gray-500",children:"Class Participation"}),(0,y.jsxs)("span",{className:"font-medium",children:[o.participationRate,"%"]})]}),(0,y.jsx)(sM.Progress,{value:o.participationRate,className:"h-2"})]}),(0,y.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,y.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"Live Results"}),(()=>{switch(e.type){case"word_cloud":return(0,y.jsx)(rN,{poll:e});case"short_answer":return(0,y.jsx)(rk,{poll:e});case"rating":return(0,y.jsx)(rw,{poll:e,stats:o});default:return(0,y.jsx)(rj,{poll:e,stats:o})}})()]}),(0,y.jsxs)(k.Button,{onClick:s,variant:"destructive",className:"w-full",children:[(0,y.jsx)(ev.Square,{className:"h-4 w-4 mr-2"}),"End Poll"]})]})}function rj({poll:e,stats:t}){let s=Math.max(...t.optionStats.map(e=>e.count),1);return(0,y.jsx)("div",{className:"space-y-3",children:e.options.map((e,r)=>{let a=t.optionStats.find(t=>t.optionId===e.id),n=a?.count||0,i=a?.percentage||0;return(0,y.jsxs)("div",{className:"space-y-1",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("span",{className:"w-5 h-5 rounded-full flex items-center justify-center text-xs font-medium text-white",style:{backgroundColor:r_(r)},children:e.label}),(0,y.jsx)("span",{className:"font-medium",children:e.text}),n===s&&n>0&&n>0&&(0,y.jsx)(S.Badge,{variant:"secondary",className:"text-xs",children:"Leading"})]}),(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsxs)("span",{className:"text-gray-500",children:[n," votes"]}),(0,y.jsxs)("span",{className:"font-medium w-10 text-right",children:[i,"%"]})]})]}),(0,y.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,y.jsx)("div",{className:"h-full transition-all duration-500 ease-out rounded-full",style:{width:`${i}%`,backgroundColor:r_(r)}})})]},e.id)})})}function rw({poll:e,stats:t}){return t.optionStats.map(e=>e.count),(0,y.jsxs)("div",{className:"space-y-3",children:[(0,y.jsx)("div",{className:"flex items-center justify-center gap-1 mb-4",children:[1,2,3,4,5].map(s=>{let r=t.optionStats.find(t=>{let r=e.options.find(e=>e.id===t.optionId);return r&&parseInt(r.label)===s}),a=r?.count||0;return(0,y.jsx)("div",{className:(0,L.cn)("w-10 h-10 rounded-lg flex items-center justify-center font-medium transition-colors",a>0?"bg-blue-500 text-white":"bg-gray-200 text-gray-400"),children:s},s)})}),e.options.map((e,s)=>{let r=t.optionStats.find(t=>t.optionId===e.id),a=r?.count||0,n=r?.percentage||0;return(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("span",{className:"w-8 font-medium text-gray-700",children:e.label}),(0,y.jsx)("div",{className:"flex-1 h-6 bg-gray-200 rounded-full overflow-hidden",children:(0,y.jsx)("div",{className:"h-full bg-blue-500 transition-all duration-500 ease-out rounded-full flex items-center justify-end pr-2",style:{width:`${n}%`},children:n>15&&(0,y.jsx)("span",{className:"text-xs text-white font-medium",children:a})})}),(0,y.jsxs)("span",{className:"w-10 text-right text-sm text-gray-500",children:[n,"%"]})]},e.id)})]})}function rN({poll:e}){let t=ry(e),s=Math.max(...t.map(e=>e.count),1);return 0===t.length?(0,y.jsx)("div",{className:"text-center py-8 text-gray-400",children:"Waiting for responses..."}):(0,y.jsx)("div",{className:"flex flex-wrap gap-2 justify-center p-4",children:t.slice(0,30).map(({word:e,count:t})=>{let r=Math.max(.75,t/s*2),a=Math.max(.5,t/s);return(0,y.jsxs)("span",{className:"inline-block px-2 py-1 rounded-full bg-blue-100 text-blue-800 transition-all",style:{fontSize:`${r}rem`,opacity:a},children:[e,(0,y.jsxs)("span",{className:"text-xs ml-1 opacity-60",children:["(",t,")"]})]},e)})})}function rk({poll:e}){let t=e.responses?.filter(e=>e.textAnswer?.trim())||[];return 0===t.length?(0,y.jsx)("div",{className:"text-center py-8 text-gray-400",children:"Waiting for responses..."}):(0,y.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:t.map((e,t)=>(0,y.jsx)("div",{className:"p-3 bg-white rounded-lg border text-sm",children:e.textAnswer},e.id||t))})}function rS({icon:e,value:t,label:s}){return(0,y.jsxs)("div",{className:"bg-white border rounded-lg p-3 text-center",children:[(0,y.jsx)("div",{className:"flex justify-center text-gray-400 mb-1",children:e}),(0,y.jsx)("div",{className:"text-xl font-bold text-gray-900",children:t}),(0,y.jsx)("div",{className:"text-xs text-gray-500",children:s})]})}function r_(e){let t=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899"];return t[e%t.length]}var rC=e.i(650734),rM=e.i(879534);function rT({polls:e,onReuse:t,onDelete:s}){let[r,a]=(0,j.useState)(new Set);return 0===e.length?(0,y.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,y.jsx)(ef.BarChart3,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,y.jsx)("p",{children:"No completed polls yet"}),(0,y.jsx)("p",{className:"text-sm mt-1",children:"Ended polls will appear here"})]}):(0,y.jsx)("div",{className:"space-y-3",children:e.map(e=>{let n,i,o,l,c,d=r.has(e.id);return(0,y.jsxs)("div",{className:"border rounded-lg bg-white overflow-hidden",children:[(0,y.jsx)("button",{className:"w-full p-3 text-left hover:bg-gray-50 transition-colors",onClick:()=>{var t;return t=e.id,void a(e=>{let s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s})},children:(0,y.jsxs)("div",{className:"flex items-start justify-between",children:[(0,y.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,y.jsx)("p",{className:"font-medium text-gray-900 line-clamp-2",children:e.question}),(0,y.jsxs)("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[(0,y.jsx)(S.Badge,{variant:"secondary",className:"text-xs",children:e.type.replace("_"," ")}),(0,y.jsxs)("span",{className:"text-xs text-gray-500",children:[e.totalResponses||0," responses"]}),(0,y.jsx)("span",{className:"text-xs text-gray-400",children:(n=new Date(e.endedAt||e.createdAt),o=Math.floor((i=new Date().getTime()-n.getTime())/6e4),l=Math.floor(i/36e5),c=Math.floor(i/864e5),o<1?"Just now":o<60?`${o}m ago`:l<24?`${l}h ago`:c<7?`${c}d ago`:n.toLocaleDateString("en-US",{month:"short",day:"numeric"}))})]})]}),(0,y.jsx)("div",{className:"ml-2",children:d?(0,y.jsx)(rC.ChevronUp,{className:"h-4 w-4 text-gray-400"}):(0,y.jsx)(sl.ChevronDown,{className:"h-4 w-4 text-gray-400"})})]})}),d&&(0,y.jsxs)("div",{className:"px-3 pb-3 border-t bg-gray-50",children:[(0,y.jsx)(rE,{poll:e}),(0,y.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,y.jsxs)(k.Button,{size:"sm",variant:"outline",onClick:()=>t(e),className:"flex-1",children:[(0,y.jsx)(rM.RotateCcw,{className:"h-4 w-4 mr-1"}),"Reuse"]}),(0,y.jsx)(k.Button,{size:"sm",variant:"ghost",onClick:()=>s(e.id),className:"text-red-500 hover:text-red-600",children:(0,y.jsx)(e3.Trash2,{className:"h-4 w-4"})})]})]})]},e.id)})})}function rE({poll:e}){let t=rx(e,e.totalResponses||0);return(0,y.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,y.jsxs)("div",{className:"flex gap-4 text-sm",children:[(0,y.jsxs)("div",{className:"flex items-center gap-1 text-gray-600",children:[(0,y.jsx)(D.Users,{className:"h-4 w-4"}),(0,y.jsxs)("span",{children:[t.totalVotes," responses"]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-1 text-gray-600",children:[(0,y.jsx)(ei.Clock,{className:"h-4 w-4"}),(0,y.jsx)("span",{children:e.startedAt&&e.endedAt?`${Math.round((new Date(e.endedAt).getTime()-new Date(e.startedAt).getTime())/1e3)}s`:"N/A"})]})]}),(()=>{switch(e.type){case"word_cloud":return(0,y.jsx)(rI,{poll:e});case"short_answer":return(0,y.jsx)(rO,{poll:e});case"rating":return(0,y.jsx)(rP,{poll:e,stats:t});default:return(0,y.jsx)(rA,{poll:e,stats:t})}})()]})}function rA({poll:e,stats:t}){return(0,y.jsx)("div",{className:"space-y-2",children:e.options.map((e,s)=>{let r=t.optionStats.find(t=>t.optionId===e.id);r?.count;let a=r?.percentage||0;return(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("span",{className:"w-5 h-5 rounded-full flex items-center justify-center text-xs font-medium text-white shrink-0",style:{backgroundColor:rL(s)},children:e.label}),(0,y.jsx)("span",{className:"text-sm flex-1 truncate",children:e.text}),(0,y.jsxs)("div",{className:"flex items-center gap-2 w-24",children:[(0,y.jsx)("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,y.jsx)("div",{className:"h-full rounded-full transition-all",style:{width:`${a}%`,backgroundColor:rL(s)}})}),(0,y.jsxs)("span",{className:"text-xs text-gray-500 w-8 text-right",children:[a,"%"]})]})]},e.id)})})}function rP({poll:e,stats:t}){return(0,y.jsx)("div",{className:"flex items-center justify-center gap-2",children:[1,2,3,4,5].map(s=>{let r=t.optionStats.find(t=>{let r=e.options.find(e=>e.id===t.optionId);return r&&parseInt(r.label)===s}),a=r?.count||0,n=Math.round(a/(t.totalVotes||1)*100);return(0,y.jsxs)("div",{className:"text-center",children:[(0,y.jsx)("div",{className:(0,L.cn)("w-10 h-10 rounded-lg flex items-center justify-center font-medium mb-1",a>0?"bg-blue-500 text-white":"bg-gray-200 text-gray-400"),children:s}),(0,y.jsxs)("div",{className:"text-xs text-gray-500",children:[n,"%"]})]},s)})})}function rI({poll:e}){let t=ry(e);if(0===t.length)return(0,y.jsx)("p",{className:"text-sm text-gray-400 text-center py-4",children:"No responses"});let s=Math.max(...t.map(e=>e.count),1);return(0,y.jsx)("div",{className:"flex flex-wrap gap-2 justify-center",children:t.slice(0,20).map(({word:e,count:t})=>{let r=Math.max(.75,t/s*1.5);return(0,y.jsx)("span",{className:"inline-block px-2 py-1 rounded-full bg-blue-100 text-blue-800",style:{fontSize:`${r}rem`},children:e},e)})})}function rO({poll:e}){let t=e.responses?.filter(e=>e.textAnswer?.trim())||[];return 0===t.length?(0,y.jsx)("p",{className:"text-sm text-gray-400 text-center py-4",children:"No responses"}):(0,y.jsxs)("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:[t.slice(0,10).map((e,t)=>(0,y.jsx)("div",{className:"p-2 bg-white rounded border text-sm",children:e.textAnswer},e.id||t)),t.length>10&&(0,y.jsxs)("p",{className:"text-xs text-gray-400 text-center",children:["+",t.length-10," more responses"]})]})}function rL(e){let t=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899"];return t[e%t.length]}var rD=e.i(783393);function rR({sessionId:t,tutorId:s,totalStudents:r,className:a}){let[n,i]=(0,j.useState)("create"),[o,l]=(0,j.useState)(!1),{activePolls:c,draftPolls:d,closedPolls:u,isLoading:h,error:m,isConnected:p,createPoll:g,startPoll:f,endPoll:x,deletePoll:v}=function(t,s){let r=(0,j.useRef)(null),[a,n]=(0,j.useState)(!1),[i,o]=(0,j.useState)([]),[l,c]=(0,j.useState)(!0),[d,u]=(0,j.useState)(null);(0,j.useEffect)(()=>{if(t)return(async()=>{let a=await e.A(913435).then(e=>e.getSocketToken());if(!a)return;let i=(0,rD.io)("/api/socket",{path:"/api/socket",transports:["websocket","polling"],auth:{token:a}});r.current=i,i.on("connect",()=>{n(!0),s?.userId&&i.emit("join_class",{roomId:t,userId:s.userId,name:s.name||s.role,role:s.role}),i.emit("poll:join",{sessionId:t}),i.emit("poll:list",{sessionId:t},e=>{c(!1),e.success&&e.polls?o(e.polls):u(e.error||"Failed to load polls")})}),i.on("disconnect",()=>{n(!1)}),i.on("connect_error",e=>{u("Connection error: "+e.message),c(!1)})})(),()=>{r.current?.emit("poll:leave",{sessionId:t}),r.current?.disconnect(),r.current=null}},[t,s?.name,s?.role,s?.userId]),(0,j.useEffect)(()=>{let e=r.current;if(!e)return;let t=e=>{o(t=>[...t,e])},s=e=>{o(t=>t.map(t=>t.id===e.id?e:t))},a=e=>{o(t=>t.map(t=>t.id===e.id?{...t,status:"active",startedAt:new Date().toISOString()}:t))},n=e=>{o(t=>t.map(t=>t.id===e.id?{...t,status:"closed",endedAt:new Date().toISOString()}:t))},i=e=>{o(t=>t.filter(t=>t.id!==e))};return e.on("poll:created",t),e.on("poll:updated",s),e.on("poll:started",a),e.on("poll:ended",n),e.on("poll:deleted",i),()=>{e.off("poll:created",t),e.off("poll:updated",s),e.off("poll:started",a),e.off("poll:ended",n),e.off("poll:deleted",i)}},[]);let h=(0,j.useCallback)(e=>{r.current?.emit("poll:create",{sessionId:t,...e})},[t]),m=(0,j.useCallback)(e=>{r.current?.emit("poll:start",{pollId:e,sessionId:t})},[t]),p=(0,j.useCallback)(e=>{r.current?.emit("poll:end",{pollId:e,sessionId:t})},[t]),g=(0,j.useCallback)(e=>{r.current?.emit("poll:delete",{pollId:e,sessionId:t})},[t]),f=(0,j.useCallback)((e,s)=>{r.current?.emit("poll:vote",{pollId:e,sessionId:t,...s})},[t]),x=(0,j.useCallback)(()=>{r.current&&(c(!0),r.current.emit("poll:list",{sessionId:t},e=>{c(!1),e.success&&e.polls&&o(e.polls)}))},[t]),v=i.filter(e=>"active"===e.status),y=i.filter(e=>"draft"===e.status),b=i.filter(e=>"closed"===e.status);return{polls:i,activePolls:v,draftPolls:y,closedPolls:b,isLoading:l,error:d,isConnected:a,createPoll:h,startPoll:m,endPoll:p,deletePoll:g,submitVote:f,refreshPolls:x}}(t,{userId:s,role:"tutor",name:"Tutor"}),b=c[0],w=(0,j.useCallback)(e=>{g(e),l(!1),i("active")},[g]),N=(0,j.useCallback)(e=>{f(e),i("active")},[f]),C=(0,j.useCallback)(e=>{x(e),i("history")},[x]);return h?(0,y.jsx)("div",{className:(0,L.cn)("flex items-center justify-center h-64",a),children:(0,y.jsx)("div",{className:"animate-spin h-8 w-8 border-2 border-blue-600 border-t-transparent rounded-full"})}):m?(0,y.jsx)("div",{className:(0,L.cn)("flex items-center justify-center h-64 text-red-500",a),children:m}):(0,y.jsxs)("div",{className:(0,L.cn)("flex flex-col h-full bg-white rounded-lg border",a),children:[(0,y.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[(0,y.jsx)("h3",{className:"font-semibold text-gray-900",children:"Quick Polls"}),(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(S.Badge,{variant:p?"default":"secondary",children:p?"Connected":"Connecting..."}),c.length>0&&(0,y.jsxs)(S.Badge,{className:"bg-green-100 text-green-700 border-green-200",children:[c.length," Active"]}),d.length>0&&(0,y.jsxs)(S.Badge,{variant:"outline",className:"text-gray-600",children:[d.length," Draft"]})]})]}),(0,y.jsxs)(_.Tabs,{value:n,onValueChange:e=>i(e),className:"flex-1 flex flex-col",children:[!p&&(0,y.jsx)("div",{className:"px-4 pt-3 text-xs text-muted-foreground",children:"Waiting for poll socket connection. Creating or starting polls is disabled until connected."}),(0,y.jsxs)(_.TabsList,{className:"grid w-full grid-cols-3 rounded-none border-b bg-transparent p-0",children:[(0,y.jsx)(_.TabsTrigger,{value:"create",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-blue-600 data-[state=active]:bg-transparent data-[state=active]:shadow-none py-3",children:"Create"}),(0,y.jsxs)(_.TabsTrigger,{value:"active",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-blue-600 data-[state=active]:bg-transparent data-[state=active]:shadow-none py-3",children:["Active",c.length>0&&(0,y.jsx)("span",{className:"ml-2 w-5 h-5 rounded-full bg-blue-600 text-white text-xs flex items-center justify-center",children:c.length})]}),(0,y.jsxs)(_.TabsTrigger,{value:"history",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-blue-600 data-[state=active]:bg-transparent data-[state=active]:shadow-none py-3",children:["History",u.length>0&&(0,y.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(",u.length,")"]})]})]}),(0,y.jsxs)("div",{className:"flex-1 overflow-y-auto p-4",children:[(0,y.jsx)(_.TabsContent,{value:"create",className:"mt-0 h-full",children:o?(0,y.jsx)(rf,{onSubmit:w,onCancel:()=>l(!1)}):(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)(k.Button,{onClick:()=>l(!0),disabled:!p,className:"w-full h-16 text-lg gap-2",children:[(0,y.jsx)("span",{className:"text-2xl",children:"+"}),"Create New Poll"]}),d.length>0&&(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Draft Polls"}),d.map(e=>(0,y.jsx)(rB,{poll:e,onStart:()=>N(e.id),onDelete:()=>v(e.id)},e.id))]})]})}),(0,y.jsx)(_.TabsContent,{value:"active",className:"mt-0 h-full",children:b?(0,y.jsx)(rb,{poll:b,totalStudents:r,onEnd:()=>C(b.id)}):(0,y.jsx)(rF,{icon:"ðŸ“Š",title:"No Active Poll",description:"Create a poll to start collecting responses from students",action:{label:"Create Poll",onClick:()=>i("create")}})}),(0,y.jsx)(_.TabsContent,{value:"history",className:"mt-0 h-full",children:(0,y.jsx)(rT,{polls:u,onReuse:e=>{let{id:t,status:s,createdAt:r,startedAt:a,endedAt:n,responses:i,...o}=e;g({...o,options:o.options.map(e=>({label:e.label,text:e.text}))})},onDelete:v})})]})]})]})}function rB({poll:e,onStart:t,onDelete:s}){return(0,y.jsxs)("div",{className:"p-3 border rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors",children:[(0,y.jsx)("p",{className:"font-medium text-gray-900 line-clamp-2",children:e.question}),(0,y.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[e.type.replace("_"," ")," â€¢ ",e.options.length," options"]}),(0,y.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,y.jsx)(k.Button,{size:"sm",onClick:t,className:"flex-1",children:"Start Poll"}),(0,y.jsx)(k.Button,{size:"sm",variant:"ghost",onClick:s,className:"text-red-500 hover:text-red-600",children:"Delete"})]})]})}function rF({icon:e,title:t,description:s,action:r}){return(0,y.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center p-4",children:[(0,y.jsx)("span",{className:"text-4xl mb-3",children:e}),(0,y.jsx)("h4",{className:"font-medium text-gray-900",children:t}),(0,y.jsx)("p",{className:"text-sm text-gray-500 mt-1 max-w-xs",children:s}),r&&(0,y.jsx)(k.Button,{onClick:r.onClick,className:"mt-4",children:r.label})]})}eE.HelpCircle,rl.Gauge,e9.List,rc.Play,X.Brain,eg.MessageSquare,ei.Clock;let rz=(0,ee.default)("minimize-2",[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]]);function r$({students:e,isOpen:t,onToggle:s,onSelectStudent:r,onSendNudge:a,onInviteToBreakout:n}){let[i,o]=(0,j.useState)("all"),[l,c]=(0,j.useState)("engagement"),[d,u]=(0,j.useState)(!0),h=(0,j.useMemo)(()=>{if(0===e.length)return null;let t=Math.round(e.reduce((e,t)=>e+t.engagementScore,0)/e.length),s=Math.round(e.reduce((e,t)=>e+t.comprehensionEstimate,0)/e.length),r=e.filter(e=>e.engagementScore<50||e.comprehensionEstimate<50).length,a=e.filter(e=>"away"===e.attentionLevel||"inactive"===e.attentionLevel).length;return{avgEngagement:t,avgComprehension:s,strugglingCount:r,inactiveCount:a,totalHandsRaised:e.filter(e=>e.raisedHand).length,totalMessages:e.reduce((e,t)=>e+t.chatMessages,0),classEnergy:t>75?"high":t>50?"moderate":"low"}},[e]),m=(0,j.useMemo)(()=>{let t=[...e];switch(i){case"struggling":t=t.filter(e=>e.engagementScore<50||e.comprehensionEstimate<50);break;case"inactive":t=t.filter(e=>"away"===e.attentionLevel||"inactive"===e.attentionLevel);break;case"engaged":t=t.filter(e=>e.engagementScore>=75&&"focused"===e.attentionLevel)}return t.sort((e,t)=>{switch(l){case"engagement":return t.engagementScore-e.engagementScore;case"attention":let s={focused:3,distracted:2,away:1,inactive:0};return s[t.attentionLevel]-s[e.attentionLevel];case"comprehension":return t.comprehensionEstimate-e.comprehensionEstimate;default:return 0}}),t},[e,i,l]),p=e=>{switch(e){case"focused":return"bg-green-500";case"distracted":return"bg-yellow-500";case"away":return"bg-orange-500";default:return"bg-gray-500"}},g=e=>e>=75?"text-green-500":e>=50?"text-yellow-500":"text-red-500",f=e=>e>=75?"bg-green-500":e>=50?"bg-yellow-500":"bg-red-500";return t?(0,y.jsxs)("div",{className:"w-[400px] bg-slate-900 border-l border-slate-700 flex flex-col h-full",children:[(0,y.jsxs)("div",{className:"p-4 border-b border-slate-700 bg-slate-800",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("div",{className:"bg-blue-600 p-2 rounded-lg",children:(0,y.jsx)(eW.Activity,{className:"h-5 w-5 text-white"})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Live Engagement"}),(0,y.jsx)("p",{className:"text-xs text-slate-400",children:"Real-time student analytics"})]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-1",children:[(0,y.jsx)(k.Button,{variant:"ghost",size:"icon",onClick:()=>u(!d),className:"h-8 w-8",children:d?(0,y.jsx)(sl.ChevronDown,{className:"h-4 w-4"}):(0,y.jsx)(rC.ChevronUp,{className:"h-4 w-4"})}),(0,y.jsx)(k.Button,{variant:"ghost",size:"icon",onClick:s,className:"h-8 w-8",children:(0,y.jsx)(rz,{className:"h-4 w-4"})})]})]}),h&&d&&(0,y.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,y.jsx)(A.Card,{className:"bg-slate-700 border-slate-600",children:(0,y.jsxs)(A.CardContent,{className:"p-2 text-center",children:[(0,y.jsxs)("p",{className:(0,L.cn)("text-xl font-bold",g(h.avgEngagement)),children:[h.avgEngagement,"%"]}),(0,y.jsx)("p",{className:"text-[10px] text-slate-400",children:"Avg Engagement"})]})}),(0,y.jsx)(A.Card,{className:"bg-slate-700 border-slate-600",children:(0,y.jsxs)(A.CardContent,{className:"p-2 text-center",children:[(0,y.jsx)("p",{className:"text-xl font-bold text-blue-400",children:h.totalHandsRaised}),(0,y.jsx)("p",{className:"text-[10px] text-slate-400",children:"Hands Raised"})]})}),(0,y.jsx)(A.Card,{className:"bg-slate-700 border-slate-600",children:(0,y.jsxs)(A.CardContent,{className:"p-2 text-center",children:[(0,y.jsx)("p",{className:(0,L.cn)("text-xl font-bold",h.strugglingCount>0?"text-red-400":"text-green-400"),children:h.strugglingCount}),(0,y.jsx)("p",{className:"text-[10px] text-slate-400",children:"Need Help"})]})})]})]}),(0,y.jsxs)("div",{className:"px-4 py-2 border-b border-slate-700 bg-slate-800/50",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(q.Filter,{className:"h-3 w-3 text-slate-400"}),(0,y.jsx)("div",{className:"flex gap-1 flex-wrap",children:["all","struggling","inactive","engaged"].map(e=>(0,y.jsx)("button",{onClick:()=>o(e),className:(0,L.cn)("px-2 py-0.5 text-[10px] rounded-full transition-colors capitalize",i===e?"bg-blue-600 text-white":"bg-slate-700 text-slate-400 hover:bg-slate-600"),children:e},e))})]}),(0,y.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,y.jsx)("span",{className:"text-[10px] text-slate-500",children:"Sort:"}),(0,y.jsxs)("select",{value:l,onChange:e=>c(e.target.value),className:"text-[10px] bg-slate-700 border border-slate-600 rounded px-2 py-0.5 text-slate-300",children:[(0,y.jsx)("option",{value:"engagement",children:"Engagement"}),(0,y.jsx)("option",{value:"attention",children:"Attention"}),(0,y.jsx)("option",{value:"comprehension",children:"Comprehension"})]})]})]}),(0,y.jsx)(O.ScrollArea,{className:"flex-1",children:(0,y.jsx)("div",{className:"p-4 space-y-3",children:0===m.length?(0,y.jsx)("p",{className:"text-center text-slate-500 text-sm py-8",children:"No students match the current filter"}):m.map(e=>(0,y.jsx)(rV,{student:e,onSelect:()=>r?.(e.studentId),onNudge:()=>a?.(e.studentId),onInviteToBreakout:()=>n?.(e.studentId),getAttentionColor:p,getEngagementColor:g,getProgressColor:f},e.studentId))})}),(0,y.jsx)("div",{className:"p-3 border-t border-slate-700 bg-slate-800",children:(0,y.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[(0,y.jsxs)("span",{children:[e.length," students"]}),(0,y.jsxs)("span",{children:[h?.totalMessages||0," messages"]})]})})]}):(0,y.jsx)(em.TooltipProvider,{children:(0,y.jsxs)(em.Tooltip,{children:[(0,y.jsx)(em.TooltipTrigger,{asChild:!0,children:(0,y.jsxs)(k.Button,{variant:"outline",size:"icon",onClick:s,className:"fixed right-4 top-20 z-40 bg-slate-800 border-slate-700 hover:bg-slate-700",children:[(0,y.jsx)(eW.Activity,{className:"h-4 w-4 text-blue-400"}),h&&h.strugglingCount>0&&(0,y.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full text-[10px] flex items-center justify-center",children:h.strugglingCount})]})}),(0,y.jsx)(em.TooltipContent,{children:(0,y.jsx)("p",{children:"Open Engagement Dashboard"})})]})})}function rV({student:e,onSelect:t,onNudge:s,onInviteToBreakout:r,getAttentionColor:a,getEngagementColor:n,getProgressColor:i}){var o;let l,[c,d]=(0,j.useState)(!1),u=e.engagementScore<50||e.comprehensionEstimate<50,h="away"===e.attentionLevel||"inactive"===e.attentionLevel;return(0,y.jsx)(A.Card,{className:(0,L.cn)("bg-slate-800 border-slate-700 cursor-pointer transition-all hover:border-slate-600",u&&"border-red-800/50 bg-red-900/10",h&&"opacity-70"),onClick:t,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),children:(0,y.jsxs)(A.CardContent,{className:"p-3",children:[(0,y.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white text-xs font-medium",children:e.name.charAt(0).toUpperCase()}),(0,y.jsx)("div",{className:(0,L.cn)("absolute -bottom-0.5 -right-0.5 w-3 h-3 rounded-full border-2 border-slate-800",a(e.attentionLevel))})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"text-sm font-medium text-white",children:e.name}),(0,y.jsxs)("div",{className:"flex items-center gap-1 text-[10px] text-slate-400",children:[(0,y.jsx)("span",{className:"capitalize",children:e.attentionLevel}),(0,y.jsx)("span",{children:"â€¢"}),(0,y.jsxs)("span",{children:[e.timeInSession,"m in session"]})]})]})]}),e.raisedHand&&(0,y.jsxs)(S.Badge,{className:"bg-yellow-600 text-[10px] px-1.5 py-0",children:[(0,y.jsx)(R.Hand,{className:"h-3 w-3 mr-0.5"}),"Raised"]})]}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)("div",{children:[(0,y.jsxs)("div",{className:"flex items-center justify-between text-[10px] mb-1",children:[(0,y.jsxs)("span",{className:"text-slate-400 flex items-center gap-1",children:[(0,y.jsx)(eW.Activity,{className:"h-3 w-3"}),"Engagement"]}),(0,y.jsxs)("span",{className:(0,L.cn)("font-medium",n(e.engagementScore)),children:[e.engagementScore,"%"]})]}),(0,y.jsx)(sM.Progress,{value:e.engagementScore,className:"h-1 bg-slate-700",children:(0,y.jsx)("div",{className:(0,L.cn)("h-full transition-all",i(e.engagementScore)),style:{width:`${e.engagementScore}%`}})})]}),(0,y.jsxs)("div",{children:[(0,y.jsxs)("div",{className:"flex items-center justify-between text-[10px] mb-1",children:[(0,y.jsxs)("span",{className:"text-slate-400 flex items-center gap-1",children:[(0,y.jsx)(X.Brain,{className:"h-3 w-3"}),"Comprehension"]}),(0,y.jsxs)("span",{className:(0,L.cn)("font-medium",n(e.comprehensionEstimate)),children:[e.comprehensionEstimate,"%"]})]}),(0,y.jsx)(sM.Progress,{value:e.comprehensionEstimate,className:"h-1 bg-slate-700",children:(0,y.jsx)("div",{className:(0,L.cn)("h-full transition-all",i(e.comprehensionEstimate)),style:{width:`${e.comprehensionEstimate}%`}})})]}),(0,y.jsxs)("div",{className:"flex items-center justify-between pt-1",children:[(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)(em.TooltipProvider,{children:(0,y.jsxs)(em.Tooltip,{children:[(0,y.jsx)(em.TooltipTrigger,{asChild:!0,children:(0,y.jsxs)("div",{className:"flex items-center gap-1 text-[10px] text-slate-400",children:[(0,y.jsx)(z.MessageCircle,{className:"h-3 w-3"}),e.chatMessages]})}),(0,y.jsx)(em.TooltipContent,{children:(0,y.jsx)("p",{children:"Chat messages"})})]})}),(0,y.jsx)(em.TooltipProvider,{children:(0,y.jsxs)(em.Tooltip,{children:[(0,y.jsx)(em.TooltipTrigger,{asChild:!0,children:(0,y.jsxs)("div",{className:"flex items-center gap-1 text-[10px] text-slate-400",children:[(0,y.jsx)(ts.Eye,{className:"h-3 w-3"}),e.participationCount]})}),(0,y.jsx)(em.TooltipContent,{children:(0,y.jsx)("p",{children:"Recent interactions (5m)"})})]})}),e.struggleIndicators>0&&(0,y.jsx)(em.TooltipProvider,{children:(0,y.jsxs)(em.Tooltip,{children:[(0,y.jsx)(em.TooltipTrigger,{asChild:!0,children:(0,y.jsxs)("div",{className:"flex items-center gap-1 text-[10px] text-red-400",children:[(0,y.jsx)(s_.AlertTriangle,{className:"h-3 w-3"}),e.struggleIndicators]})}),(0,y.jsx)(em.TooltipContent,{children:(0,y.jsx)("p",{children:"Struggle indicators detected"})})]})})]}),(0,y.jsx)("span",{className:"text-[10px] text-slate-500",children:(o=e.lastActivity,(l=Math.floor((Date.now()-new Date(o).getTime())/1e3))<60?"Just now":l<120?"1m ago":l<300?`${Math.floor(l/60)}m ago`:">5m ago")})]})]}),c&&(u||e.raisedHand)&&(0,y.jsxs)("div",{className:"flex gap-2 mt-3 pt-2 border-t border-slate-700",children:[u&&(0,y.jsx)(k.Button,{size:"sm",variant:"outline",className:"flex-1 h-7 text-[10px] border-yellow-600/50 text-yellow-400 hover:bg-yellow-600/10",onClick:e=>{e.stopPropagation(),s()},children:"Send Nudge"}),(0,y.jsx)(k.Button,{size:"sm",variant:"outline",className:"flex-1 h-7 text-[10px] border-blue-600/50 text-blue-400 hover:bg-blue-600/10",onClick:e=>{e.stopPropagation(),r()},children:"1:1 Session"})]})]})})}var rU=/[\\\/_+.#"@\[\(\{&]/,rq=/[\\\/_+.#"@\[\(\{&]/g,rH=/[\s-]/,rJ=/[\s-]/g;function rG(e){return e.toLowerCase().replace(rJ," ")}var rW=e.i(536085),rQ=e.i(752137),rK=e.i(462835),rY='[cmdk-group=""]',rX='[cmdk-group-items=""]',rZ='[cmdk-item=""]',r0=`${rZ}:not([aria-disabled="true"])`,r1="cmdk-item-select",r2="data-value",r4=(e,t,s)=>{var r;return r=e,function e(t,s,r,a,n,i,o){if(i===s.length)return n===t.length?1:.99;var l=`${n},${i}`;if(void 0!==o[l])return o[l];for(var c,d,u,h,m=a.charAt(i),p=r.indexOf(m,n),g=0;p>=0;)(c=e(t,s,r,a,p+1,i+1,o))>g&&(p===n?c*=1:rU.test(t.charAt(p-1))?(c*=.8,(u=t.slice(n,p-1).match(rq))&&n>0&&(c*=Math.pow(.999,u.length))):rH.test(t.charAt(p-1))?(c*=.9,(h=t.slice(n,p-1).match(rJ))&&n>0&&(c*=Math.pow(.999,h.length))):(c*=.17,n>0&&(c*=Math.pow(.999,p-n))),t.charAt(p)!==s.charAt(i)&&(c*=.9999)),(c<.1&&r.charAt(p-1)===a.charAt(i+1)||a.charAt(i+1)===a.charAt(i)&&r.charAt(p-1)!==a.charAt(i))&&.1*(d=e(t,s,r,a,p+1,i+2,o))>c&&(c=.1*d),c>g&&(g=c),p=r.indexOf(m,p+1);return o[l]=g,g}(r=s&&s.length>0?`${r+" "+s.join(" ")}`:r,t,rG(r),rG(t),0,0,{})},r5=j.createContext(void 0),r3=j.createContext(void 0),r6=j.createContext(void 0),r8=j.forwardRef((e,t)=>{let s=ao(()=>{var t,s;return{search:"",value:null!=(s=null!=(t=e.value)?t:e.defaultValue)?s:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=ao(()=>new Set),a=ao(()=>new Map),n=ao(()=>new Map),i=ao(()=>new Set),o=an(e),{label:l,children:c,value:d,onValueChange:u,filter:h,shouldFilter:m,loop:p,disablePointerSelection:g=!1,vimBindings:f=!0,...x}=e,v=(0,rK.useId)(),y=(0,rK.useId)(),b=(0,rK.useId)(),w=j.useRef(null),N=ad();ai(()=>{if(void 0!==d){let e=d.trim();s.current.value=e,k.emit()}},[d]),ai(()=>{N(6,E)},[]);let k=j.useMemo(()=>({subscribe:e=>(i.current.add(e),()=>i.current.delete(e)),snapshot:()=>s.current,setState:(e,t,r)=>{var a,n,i,l;if(!Object.is(s.current[e],t)){if(s.current[e]=t,"search"===e)T(),C(),N(1,M);else if("value"===e){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let e=document.getElementById(b);e?e.focus():null==(a=document.getElementById(v))||a.focus()}if(N(7,()=>{var e;s.current.selectedItemId=null==(e=A())?void 0:e.id,k.emit()}),r||N(5,E),(null==(n=o.current)?void 0:n.value)!==void 0){null==(l=(i=o.current).onValueChange)||l.call(i,null!=t?t:"");return}}k.emit()}},emit:()=>{i.current.forEach(e=>e())}}),[]),S=j.useMemo(()=>({value:(e,t,r)=>{var a;t!==(null==(a=n.current.get(e))?void 0:a.value)&&(n.current.set(e,{value:t,keywords:r}),s.current.filtered.items.set(e,_(t,r)),N(2,()=>{C(),k.emit()}))},item:(e,t)=>(r.current.add(e),t&&(a.current.has(t)?a.current.get(t).add(e):a.current.set(t,new Set([e]))),N(3,()=>{T(),C(),s.current.value||M(),k.emit()}),()=>{n.current.delete(e),r.current.delete(e),s.current.filtered.items.delete(e);let t=A();N(4,()=>{T(),(null==t?void 0:t.getAttribute("id"))===e&&M(),k.emit()})}),group:e=>(a.current.has(e)||a.current.set(e,new Set),()=>{n.current.delete(e),a.current.delete(e)}),filter:()=>o.current.shouldFilter,label:l||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:v,inputId:b,labelId:y,listInnerRef:w}),[]);function _(e,t){var r,a;let n=null!=(a=null==(r=o.current)?void 0:r.filter)?a:r4;return e?n(e,s.current.search,t):0}function C(){if(!s.current.search||!1===o.current.shouldFilter)return;let e=s.current.filtered.items,t=[];s.current.filtered.groups.forEach(s=>{let r=a.current.get(s),n=0;r.forEach(t=>{n=Math.max(e.get(t),n)}),t.push([s,n])});let r=w.current;P().sort((t,s)=>{var r,a;let n=t.getAttribute("id"),i=s.getAttribute("id");return(null!=(r=e.get(i))?r:0)-(null!=(a=e.get(n))?a:0)}).forEach(e=>{let t=e.closest(rX);t?t.appendChild(e.parentElement===t?e:e.closest(`${rX} > *`)):r.appendChild(e.parentElement===r?e:e.closest(`${rX} > *`))}),t.sort((e,t)=>t[1]-e[1]).forEach(e=>{var t;let s=null==(t=w.current)?void 0:t.querySelector(`${rY}[${r2}="${encodeURIComponent(e[0])}"]`);null==s||s.parentElement.appendChild(s)})}function M(){let e=P().find(e=>"true"!==e.getAttribute("aria-disabled")),t=null==e?void 0:e.getAttribute(r2);k.setState("value",t||void 0)}function T(){var e,t,i,l;if(!s.current.search||!1===o.current.shouldFilter){s.current.filtered.count=r.current.size;return}s.current.filtered.groups=new Set;let c=0;for(let a of r.current){let r=_(null!=(t=null==(e=n.current.get(a))?void 0:e.value)?t:"",null!=(l=null==(i=n.current.get(a))?void 0:i.keywords)?l:[]);s.current.filtered.items.set(a,r),r>0&&c++}for(let[e,t]of a.current)for(let r of t)if(s.current.filtered.items.get(r)>0){s.current.filtered.groups.add(e);break}s.current.filtered.count=c}function E(){var e,t,s;let r=A();r&&((null==(e=r.parentElement)?void 0:e.firstChild)===r&&(null==(s=null==(t=r.closest(rY))?void 0:t.querySelector('[cmdk-group-heading=""]'))||s.scrollIntoView({block:"nearest"})),r.scrollIntoView({block:"nearest"}))}function A(){var e;return null==(e=w.current)?void 0:e.querySelector(`${rZ}[aria-selected="true"]`)}function P(){var e;return Array.from((null==(e=w.current)?void 0:e.querySelectorAll(r0))||[])}function I(e){let t=P()[e];t&&k.setState("value",t.getAttribute(r2))}function O(e){var t;let s=A(),r=P(),a=r.findIndex(e=>e===s),n=r[a+e];null!=(t=o.current)&&t.loop&&(n=a+e<0?r[r.length-1]:a+e===r.length?r[0]:r[a+e]),n&&k.setState("value",n.getAttribute(r2))}function L(e){let t=A(),s=null==t?void 0:t.closest(rY),r;for(;s&&!r;)r=null==(s=e>0?function(e,t){let s=e.nextElementSibling;for(;s;){if(s.matches(t))return s;s=s.nextElementSibling}}(s,rY):function(e,t){let s=e.previousElementSibling;for(;s;){if(s.matches(t))return s;s=s.previousElementSibling}}(s,rY))?void 0:s.querySelector(r0);r?k.setState("value",r.getAttribute(r2)):O(e)}let D=()=>I(P().length-1),R=e=>{e.preventDefault(),e.metaKey?D():e.altKey?L(1):O(1)},B=e=>{e.preventDefault(),e.metaKey?I(0):e.altKey?L(-1):O(-1)};return j.createElement(rQ.Primitive.div,{ref:t,tabIndex:-1,...x,"cmdk-root":"",onKeyDown:e=>{var t;null==(t=x.onKeyDown)||t.call(x,e);let s=e.nativeEvent.isComposing||229===e.keyCode;if(!(e.defaultPrevented||s))switch(e.key){case"n":case"j":f&&e.ctrlKey&&R(e);break;case"ArrowDown":R(e);break;case"p":case"k":f&&e.ctrlKey&&B(e);break;case"ArrowUp":B(e);break;case"Home":e.preventDefault(),I(0);break;case"End":e.preventDefault(),D();break;case"Enter":{e.preventDefault();let t=A();if(t){let e=new Event(r1);t.dispatchEvent(e)}}}}},j.createElement("label",{"cmdk-label":"",htmlFor:S.inputId,id:S.labelId,style:ah},l),au(e,e=>j.createElement(r3.Provider,{value:k},j.createElement(r5.Provider,{value:S},e))))}),r7=j.forwardRef((e,t)=>{var s,r;let a=(0,rK.useId)(),n=j.useRef(null),i=j.useContext(r6),o=j.useContext(r5),l=an(e),c=null!=(r=null==(s=l.current)?void 0:s.forceMount)?r:null==i?void 0:i.forceMount;ai(()=>{if(!c)return o.item(a,null==i?void 0:i.id)},[c]);let d=ac(a,n,[e.value,e.children,n],e.keywords),u=j.useContext(r3),h=al(e=>e.value&&e.value===d.current),m=al(e=>!!c||!1===o.filter()||!e.search||e.filtered.items.get(a)>0);function p(){var e,t;g(),null==(t=(e=l.current).onSelect)||t.call(e,d.current)}function g(){u.setState("value",d.current,!0)}if(j.useEffect(()=>{let t=n.current;if(!(!t||e.disabled))return t.addEventListener(r1,p),()=>t.removeEventListener(r1,p)},[m,e.onSelect,e.disabled]),!m)return null;let{disabled:f,value:x,onSelect:v,forceMount:y,keywords:b,...w}=e;return j.createElement(rQ.Primitive.div,{ref:(0,sD.composeRefs)(n,t),...w,id:a,"cmdk-item":"",role:"option","aria-disabled":!!f,"aria-selected":!!h,"data-disabled":!!f,"data-selected":!!h,onPointerMove:f||o.getDisablePointerSelection()?void 0:g,onClick:f?void 0:p},e.children)}),r9=j.forwardRef((e,t)=>{let{heading:s,children:r,forceMount:a,...n}=e,i=(0,rK.useId)(),o=j.useRef(null),l=j.useRef(null),c=(0,rK.useId)(),d=j.useContext(r5),u=al(e=>!!a||!1===d.filter()||!e.search||e.filtered.groups.has(i));ai(()=>d.group(i),[]),ac(i,o,[e.value,e.heading,l]);let h=j.useMemo(()=>({id:i,forceMount:a}),[a]);return j.createElement(rQ.Primitive.div,{ref:(0,sD.composeRefs)(o,t),...n,"cmdk-group":"",role:"presentation",hidden:!u||void 0},s&&j.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:c},s),au(e,e=>j.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":s?c:void 0},j.createElement(r6.Provider,{value:h},e))))}),ae=j.forwardRef((e,t)=>{let{alwaysRender:s,...r}=e,a=j.useRef(null),n=al(e=>!e.search);return s||n?j.createElement(rQ.Primitive.div,{ref:(0,sD.composeRefs)(a,t),...r,"cmdk-separator":"",role:"separator"}):null}),at=j.forwardRef((e,t)=>{let{onValueChange:s,...r}=e,a=null!=e.value,n=j.useContext(r3),i=al(e=>e.search),o=al(e=>e.selectedItemId),l=j.useContext(r5);return j.useEffect(()=>{null!=e.value&&n.setState("search",e.value)},[e.value]),j.createElement(rQ.Primitive.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":o,id:l.inputId,type:"text",value:a?e.value:i,onChange:e=>{a||n.setState("search",e.target.value),null==s||s(e.target.value)}})}),as=j.forwardRef((e,t)=>{let{children:s,label:r="Suggestions",...a}=e,n=j.useRef(null),i=j.useRef(null),o=al(e=>e.selectedItemId),l=j.useContext(r5);return j.useEffect(()=>{if(i.current&&n.current){let e=i.current,t=n.current,s,r=new ResizeObserver(()=>{s=requestAnimationFrame(()=>{let s=e.offsetHeight;t.style.setProperty("--cmdk-list-height",s.toFixed(1)+"px")})});return r.observe(e),()=>{cancelAnimationFrame(s),r.unobserve(e)}}},[]),j.createElement(rQ.Primitive.div,{ref:(0,sD.composeRefs)(n,t),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":r,id:l.listId},au(e,e=>j.createElement("div",{ref:(0,sD.composeRefs)(i,l.listInnerRef),"cmdk-list-sizer":""},e)))}),ar=j.forwardRef((e,t)=>{let{open:s,onOpenChange:r,overlayClassName:a,contentClassName:n,container:i,...o}=e;return j.createElement(rW.Root,{open:s,onOpenChange:r},j.createElement(rW.Portal,{container:i},j.createElement(rW.Overlay,{"cmdk-overlay":"",className:a}),j.createElement(rW.Content,{"aria-label":e.label,"cmdk-dialog":"",className:n},j.createElement(r8,{ref:t,...o}))))}),aa=Object.assign(r8,{List:as,Item:r7,Input:at,Group:r9,Separator:ae,Dialog:ar,Empty:j.forwardRef((e,t)=>al(e=>0===e.filtered.count)?j.createElement(rQ.Primitive.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),Loading:j.forwardRef((e,t)=>{let{progress:s,children:r,label:a="Loading...",...n}=e;return j.createElement(rQ.Primitive.div,{ref:t,...n,"cmdk-loading":"",role:"progressbar","aria-valuenow":s,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},au(e,e=>j.createElement("div",{"aria-hidden":!0},e)))})});function an(e){let t=j.useRef(e);return ai(()=>{t.current=e}),t}var ai="u"<typeof window?j.useEffect:j.useLayoutEffect;function ao(e){let t=j.useRef();return void 0===t.current&&(t.current=e()),t}function al(e){let t=j.useContext(r3),s=()=>e(t.snapshot());return j.useSyncExternalStore(t.subscribe,s,s)}function ac(e,t,s,r=[]){let a=j.useRef(),n=j.useContext(r5);return ai(()=>{var i;let o=(()=>{var e;for(let t of s){if("string"==typeof t)return t.trim();if("object"==typeof t&&"current"in t)return t.current?null==(e=t.current.textContent)?void 0:e.trim():a.current}})(),l=r.map(e=>e.trim());n.value(e,o,l),null==(i=t.current)||i.setAttribute(r2,o),a.current=o}),a}var ad=()=>{let[e,t]=j.useState(),s=ao(()=>new Map);return ai(()=>{s.current.forEach(e=>e()),s.current=new Map},[e]),(e,r)=>{s.current.set(e,r),t({})}};function au({asChild:e,children:t},s){let r;return e&&j.isValidElement(t)?j.cloneElement("function"==typeof(r=t.type)?r(t.props):"render"in r?r.render(t.props):t,{ref:t.ref},s(t.props.children)):s(t)}var ah={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};let am=j.forwardRef(({className:e,...t},s)=>(0,y.jsx)(aa,{ref:s,className:(0,L.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));am.displayName=aa.displayName;let ap=({children:e,...t})=>(0,y.jsx)(C.Dialog,{...t,children:(0,y.jsx)(C.DialogContent,{className:"overflow-hidden p-0 shadow-lg",children:(0,y.jsx)(am,{className:"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:e})})}),ag=j.forwardRef(({className:e,...t},s)=>(0,y.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,y.jsx)(U.Search,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,y.jsx)(aa.Input,{ref:s,className:(0,L.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));ag.displayName=aa.Input.displayName;let af=j.forwardRef(({className:e,...t},s)=>(0,y.jsx)(aa.List,{ref:s,className:(0,L.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));af.displayName=aa.List.displayName;let ax=j.forwardRef((e,t)=>(0,y.jsx)(aa.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));ax.displayName=aa.Empty.displayName;let av=j.forwardRef(({className:e,...t},s)=>(0,y.jsx)(aa.Group,{ref:s,className:(0,L.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));av.displayName=aa.Group.displayName;let ay=j.forwardRef(({className:e,...t},s)=>(0,y.jsx)(aa.Separator,{ref:s,className:(0,L.cn)("-mx-1 h-px bg-border",e),...t}));ay.displayName=aa.Separator.displayName;let ab=j.forwardRef(({className:e,...t},s)=>(0,y.jsx)(aa.Item,{ref:s,className:(0,L.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t}));ab.displayName=aa.Item.displayName;var aj=e.i(255114),aw=e.i(212739),aN=e.i(753997),ak=e.i(83301);function aS({isOpen:e,onClose:t,actions:s,recentActions:r=[],placeholder:a="Type a command or search..."}){let[n,i]=(0,j.useState)(""),[o,l]=(0,j.useState)(null);(0,j.useEffect)(()=>{e&&(i(""),l(null))},[e]);let c=(0,j.useMemo)(()=>{let e=s;if(o&&(e=e.filter(e=>e.category===o)),n){let t=n.toLowerCase();e=e.filter(e=>{let s=e.title.toLowerCase().includes(t),r=e.description?.toLowerCase().includes(t),a=e.keywords?.some(e=>e.toLowerCase().includes(t));return s||r||a})}return e},[s,n,o]),d=(0,j.useMemo)(()=>{let e={};return c.forEach(t=>{e[t.category]||(e[t.category]=[]),e[t.category].push(t)}),e},[c]),u=(0,j.useMemo)(()=>r.map(e=>s.find(t=>t.id===e)).filter(Boolean),[r,s]),h={media:{label:"Media Controls",icon:(0,y.jsx)(ew.Mic,{className:"h-4 w-4"})},classroom:{label:"Classroom Tools",icon:(0,y.jsx)(G.LayoutGrid,{className:"h-4 w-4"})},engagement:{label:"Student Engagement",icon:(0,y.jsx)(D.Users,{className:"h-4 w-4"})},session:{label:"Session Management",icon:(0,y.jsx)(ei.Clock,{className:"h-4 w-4"})},navigation:{label:"Navigation",icon:(0,y.jsx)(aj.Presentation,{className:"h-4 w-4"})},system:{label:"System",icon:(0,y.jsx)(aw.Settings,{className:"h-4 w-4"})}},m=(0,j.useCallback)(e=>{e.action(),t()},[t]);return(0,y.jsxs)(ap,{open:e,onOpenChange:t,children:[(0,y.jsx)(C.DialogTitle,{className:"sr-only",children:"Command Palette"}),(0,y.jsx)(ag,{placeholder:a,value:n,onValueChange:i}),(0,y.jsxs)(af,{children:[(0,y.jsx)(ax,{className:"py-6 text-center text-sm text-slate-500",children:(0,y.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,y.jsx)(U.Search,{className:"h-8 w-8 text-slate-400"}),(0,y.jsx)("p",{children:"No commands found"}),(0,y.jsx)("p",{className:"text-xs text-slate-400",children:"Try a different search term"})]})}),u.length>0&&!n&&!o&&(0,y.jsx)(av,{heading:"Recently Used",children:u.slice(0,5).map(e=>(0,y.jsx)(ab,{onSelect:()=>m(e),disabled:e.disabled,className:(0,L.cn)(e.disabled&&"opacity-50 cursor-not-allowed"),children:(0,y.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,y.jsx)("div",{className:"text-slate-400",children:e.icon}),(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("span",{className:"font-medium",children:e.title}),e.badge&&(0,y.jsx)(S.Badge,{variant:"secondary",className:"text-[10px] px-1 py-0",children:e.badge})]}),e.description&&(0,y.jsx)("p",{className:"text-xs text-slate-500",children:e.description})]}),e.shortcut&&(0,y.jsx)("kbd",{className:"text-xs bg-slate-700 px-2 py-0.5 rounded text-slate-300",children:e.shortcut})]})},e.id))}),!n&&!o&&(0,y.jsx)(av,{heading:"Categories",children:(0,y.jsx)("div",{className:"flex flex-wrap gap-2 p-2",children:Object.entries(h).map(([e,{label:t,icon:r}])=>{let a=s.filter(t=>t.category===e).length;return(0,y.jsxs)("button",{onClick:()=>l(e),className:"flex items-center gap-2 px-3 py-1.5 bg-slate-800 hover:bg-slate-700 rounded-lg text-sm transition-colors",children:[r,(0,y.jsx)("span",{className:"capitalize",children:t}),(0,y.jsxs)("span",{className:"text-xs text-slate-500",children:["(",a,")"]})]},e)})})}),o&&(0,y.jsx)(av,{children:(0,y.jsxs)("div",{className:"flex items-center justify-between px-2 py-1",children:[(0,y.jsx)("button",{onClick:()=>l(null),className:"text-xs text-blue-400 hover:text-blue-300",children:"â† Back to all"}),(0,y.jsx)("span",{className:"text-xs text-slate-500",children:h[o]?.label})]})}),(0,y.jsx)(ay,{}),Object.entries(d).map(([e,t])=>(0,y.jsx)(av,{heading:h[e]?.label||e,children:t.map(e=>(0,y.jsx)(ab,{onSelect:()=>m(e),disabled:e.disabled,className:(0,L.cn)(e.disabled&&"opacity-50 cursor-not-allowed"),children:(0,y.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,y.jsx)("div",{className:"text-slate-400",children:e.icon}),(0,y.jsxs)("div",{className:"flex-1",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)("span",{className:"font-medium",children:e.title}),e.badge&&(0,y.jsx)(S.Badge,{variant:"secondary",className:"text-[10px] px-1 py-0",children:e.badge})]}),e.description&&(0,y.jsx)("p",{className:"text-xs text-slate-500",children:e.description})]}),e.shortcut&&(0,y.jsx)("kbd",{className:"text-xs bg-slate-700 px-2 py-0.5 rounded text-slate-300",children:e.shortcut})]})},e.id))},e)),(0,y.jsx)(ay,{}),(0,y.jsxs)("div",{className:"px-3 py-2 text-xs text-slate-500 flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsxs)("span",{className:"flex items-center gap-1",children:[(0,y.jsx)("kbd",{className:"bg-slate-700 px-1.5 rounded",children:"â†‘â†“"}),(0,y.jsx)("span",{children:"Navigate"})]}),(0,y.jsxs)("span",{className:"flex items-center gap-1",children:[(0,y.jsx)("kbd",{className:"bg-slate-700 px-1.5 rounded",children:"â†µ"}),(0,y.jsx)("span",{children:"Select"})]}),(0,y.jsxs)("span",{className:"flex items-center gap-1",children:[(0,y.jsx)("kbd",{className:"bg-slate-700 px-1.5 rounded",children:"esc"}),(0,y.jsx)("span",{children:"Close"})]})]}),(0,y.jsxs)("span",{children:[c.length," commands"]})]})]})]})}var a_=e.i(819724);let aC=(0,ee.default)("chart-no-axes-column",[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]]),aM=(0,ee.default)("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]]),aT=(0,ee.default)("command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]);var aE=e.i(973626);function aA({sessionId:e}){let t=(0,b.useRouter)(),{data:s}=(0,w.useSession)(),[r]=(0,j.useState)(()=>Date.now()),a=(0,j.useCallback)(e=>{u(t=>t.some(t=>t.id===e.userId)?t:[...t,{id:e.userId,name:e.name,status:"online",engagementScore:e.engagement??80,handRaised:!1,attentionLevel:e.engagement>=70?"high":e.engagement>=40?"medium":"low",lastActive:new Date(e.lastActivity??Date.now()).toISOString(),joinedAt:new Date(e.joinedAt??Date.now()).toISOString(),reactions:0,chatMessages:0}])},[]),n=(0,j.useCallback)(e=>{u(t=>t.filter(t=>t.id!==e))},[]),i=s?.user?.id?{roomId:e,userId:s.user.id,name:s.user?.name||"Tutor",role:"tutor",tutorId:s.user.id,onStudentJoined:a,onStudentLeft:n}:void 0,{socket:o}=(0,N.useSocket)(i),[l,c]=(0,j.useState)(!0),[d,u]=(0,j.useState)([]),[h,m]=(0,j.useState)([]),[p,g]=(0,j.useState)([]),[f,x]=(0,j.useState)([]),[v,A]=(0,j.useState)(null),[P,I]=(0,j.useState)([]),[O,L]=(0,j.useState)("Live Class"),[B,z]=(0,j.useState)("General"),[$,U]=(0,j.useState)(null),[q,H]=(0,j.useState)(null),[Q,K]=(0,j.useState)(!1),[Y,X]=(0,j.useState)(!1),[Z,ee]=(0,j.useState)(!1),[et,es]=(0,j.useState)(!1),[er,ea]=(0,j.useState)(0),[en,ei]=(0,j.useState)(!1),[eo,el]=(0,j.useState)(!1),[ec,ed]=(0,j.useState)(!1),[eu,eh]=(0,j.useState)("students"),[em,ep]=(0,j.useState)(null),[eg,ex]=(0,j.useState)(!1),ev=(0,j.useRef)(!1),ey=`live-class-recording-notice:${e}`,eb=(0,j.useRef)(null);(0,j.useEffect)(()=>{if(!et)return void ea(0);let e=setInterval(()=>{ea(e=>e+1)},1e3);return()=>clearInterval(e)},[et]);let{isOpen:eC,setIsOpen:eT}=function(e="cmd+k"){let[t,s]=(0,j.useState)(!1);return(0,j.useEffect)(()=>{let e=e=>{(navigator.platform.toUpperCase().indexOf("MAC")>=0?e.metaKey:e.ctrlKey)&&"k"===e.key.toLowerCase()&&(e.preventDefault(),s(e=>!e)),"Escape"===e.key&&s(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),{isOpen:t,setIsOpen:s}}("cmd+k");(0,j.useEffect)(()=>{if(!s?.user?.id)return;let r=s.user.id;if(eb.current?.sessionId===e&&eb.current?.userId===r)return;let a=!1;return eb.current={sessionId:e,userId:r},(async()=>{c(!0);try{let t,s=await fetch("/api/csrf",{credentials:"include"}),r=await s.json().catch(()=>({})),n=r?.token??null;await fetch(`/api/tutor/classes/${e}`,{method:"POST",headers:{"Content-Type":"application/json",...n&&{"X-CSRF-Token":n}},credentials:"include"});let i=await fetch(`/api/tutor/classes/${e}`,{credentials:"include"});if(!i.ok){let e=await i.text().catch(()=>"");throw Error(e||`Failed to load class (${i.status})`)}let o=await i.json();if(a)return;L(o.session.title||"Live Class"),z(o.session.subject||"General"),U(o.session.roomId||null),H(o.session.linkedCourseId||null),u(o.students||[]),m([]),g((o.students||[]).filter(e=>e.handRaised).map(e=>({id:`hand-${e.id}`,studentId:e.id,studentName:e.name,priority:"normal",raisedAt:e.lastActive||new Date().toISOString(),status:"pending"}))),x(o.messages||[]),A(o.metrics||{totalStudents:(t=o.students||[]).length,activeStudents:t.filter(e=>"online"===e.status).length,averageEngagement:Math.round(t.filter(e=>"online"===e.status).reduce((e,t)=>e+t.engagementScore,0)/Math.max(1,t.filter(e=>"online"===e.status).length)),participationRate:0,totalChatMessages:t.reduce((e,t)=>e+t.chatMessages,0),classDuration:0,classStartTime:new Date().toISOString(),veryEngaged:t.filter(e=>e.engagementScore>=85).length,engaged:t.filter(e=>e.engagementScore>=60&&e.engagementScore<85).length,passive:t.filter(e=>e.engagementScore>=30&&e.engagementScore<60).length,disengaged:t.filter(e=>e.engagementScore<30).length,engagementTrend:"stable"}),I(o.alerts||[])}catch(e){eb.current=null,a||(E.toast.error(e instanceof Error?e.message:"Failed to load live class session"),t.push("/tutor/live-class"))}finally{a||c(!1)}})(),()=>{a=!0}},[s?.user?.id,e,t]);let eE=(0,j.useMemo)(()=>d.map(e=>{let t;switch(e.attentionLevel){case"high":t="focused";break;case"medium":t="distracted";break;default:t="idle"===e.status?"away":"inactive"}return{studentId:e.id,name:e.name,engagementScore:e.engagementScore,attentionLevel:t,participationCount:e.reactions+e.chatMessages,comprehensionEstimate:e.engagementScore,lastActivity:new Date(e.lastActive),raisedHand:e.handRaised,chatMessages:e.chatMessages,whiteboardInteractions:0,timeInSession:Math.floor((r-new Date(e.joinedAt).getTime())/6e4),struggleIndicators:2*(e.engagementScore<50)}}),[d,r]),eP=(0,j.useCallback)(async t=>{let s=t?null:$;await fetch(`/api/tutor/live-sessions/${e}/recording`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({isRecording:t,recordingUrl:s})})},[$,e]),eI=(0,j.useCallback)(async()=>{if(!(await fetch(`/api/tutor/live-sessions/${e}/replay-artifact/generate`,{method:"POST",credentials:"include"})).ok)throw Error("Replay artifact generation failed")},[e]),eO=(0,j.useCallback)(async()=>{try{if(et){es(!1),await eP(!1),E.toast.success("Recording stopped. Building transcript and AI lesson summary..."),await eI(),E.toast.success("Replay artifact ready");return}es(!0),ea(0),await eP(!0),E.toast.success("Recording started")}catch(e){es(!1),ea(0),E.toast.error(e instanceof Error?e.message:"Recording action failed")}},[eI,et,eP]),eL=(0,j.useMemo)(()=>{var e;return[{id:"toggle-audio",title:(e={isAudioEnabled:!Q,isVideoEnabled:!Y,isScreenSharing:Z,isRecording:et,studentsRaisingHands:p.filter(e=>"pending"===e.status).length,onToggleAudio:()=>{K(!Q),E.toast.success(Q?"Microphone unmuted":"Microphone muted")},onToggleVideo:()=>{X(!Y),E.toast.success(Y?"Video started":"Video stopped")},onToggleScreenShare:()=>{ee(!Z),E.toast.success(Z?"Screen sharing stopped":"Screen sharing started")},onToggleRecording:()=>{eO()},onMuteAll:()=>{E.toast.success("All students muted")},onCallAttention:()=>{E.toast.success("Attention request sent to all students")},onOpenWhiteboard:()=>{E.toast.info("Whiteboard opened")},onOpenBreakouts:()=>{E.toast.info("Navigate to Rooms tab for breakout management")},onOpenEngagement:()=>{ei(!0),E.toast.success("Engagement Dashboard opened")},onOpenPolls:()=>{E.toast.info("Navigate to Polls tab to create polls")},onSendBroadcast:()=>{E.toast.info("Use Chat Monitor to send messages")},onLeaveClass:()=>{el(!0)}}).isAudioEnabled?"Mute Microphone":"Unmute Microphone",description:e.isAudioEnabled?"Turn off your microphone":"Turn on your microphone",icon:e.isAudioEnabled?(0,y.jsx)(ew.Mic,{className:"h-4 w-4"}):(0,y.jsx)(F.MicOff,{className:"h-4 w-4"}),shortcut:"âŒ˜M",keywords:["mute","unmute","mic","audio"],category:"media",action:e.onToggleAudio},{id:"toggle-video",title:e.isVideoEnabled?"Stop Video":"Start Video",description:e.isVideoEnabled?"Turn off your camera":"Turn on your camera",icon:e.isVideoEnabled?(0,y.jsx)(eN.Video,{className:"h-4 w-4"}):(0,y.jsx)(ek,{className:"h-4 w-4"}),shortcut:"âŒ˜V",keywords:["camera","video","on","off"],category:"media",action:e.onToggleVideo},{id:"toggle-screen",title:e.isScreenSharing?"Stop Screen Share":"Share Screen",description:e.isScreenSharing?"Stop sharing your screen":"Share your screen with students",icon:e.isScreenSharing?(0,y.jsx)(e_,{className:"h-4 w-4"}):(0,y.jsx)(eS,{className:"h-4 w-4"}),shortcut:"âŒ˜S",keywords:["screen","share","present","display"],category:"media",action:e.onToggleScreenShare},{id:"open-whiteboard",title:"Open Whiteboard",description:"Launch the collaborative whiteboard",icon:(0,y.jsx)(G.LayoutGrid,{className:"h-4 w-4"}),keywords:["whiteboard","draw","sketch","board"],category:"classroom",action:e.onOpenWhiteboard},...e.onOpenPolls?[{id:"open-polls",title:"Create Quick Poll",description:"Launch an interactive poll for students",icon:(0,y.jsx)(ef.BarChart3,{className:"h-4 w-4"}),shortcut:"âŒ˜P",keywords:["poll","quiz","vote","question"],category:"classroom",action:e.onOpenPolls,badge:"New"}]:[],{id:"open-breakouts",title:"Manage Breakout Rooms",description:"Create and manage breakout sessions",icon:(0,y.jsx)(D.Users,{className:"h-4 w-4"}),keywords:["breakout","groups","rooms","small group"],category:"classroom",action:e.onOpenBreakouts},{id:"view-engagement",title:"View Engagement Dashboard",description:"See real-time student engagement analytics",icon:(0,y.jsx)(ef.BarChart3,{className:"h-4 w-4"}),keywords:["engagement","analytics","students","attention"],category:"engagement",action:e.onOpenEngagement},{id:"call-attention",title:"Call for Attention",description:"Send notification to all students to focus",icon:(0,y.jsx)(J.Bell,{className:"h-4 w-4"}),keywords:["attention","focus","alert","notify"],category:"engagement",action:e.onCallAttention},{id:"mute-all",title:"Mute All Students",description:"Mute all student microphones",icon:(0,y.jsx)(ak.VolumeX,{className:"h-4 w-4"}),keywords:["mute","all","students","quiet"],category:"engagement",action:e.onMuteAll},{id:"send-broadcast",title:"Send Broadcast Message",description:"Send a message to all students",icon:(0,y.jsx)(eM.Send,{className:"h-4 w-4"}),shortcut:"âŒ˜B",keywords:["broadcast","message","announce","chat"],category:"engagement",action:e.onSendBroadcast},{id:"toggle-recording",title:e.isRecording?"Stop Recording":"Start Recording",description:e.isRecording?"Stop session recording":"Record this session",icon:e.isRecording?(0,y.jsx)(aN.Pause,{className:"h-4 w-4"}):(0,y.jsx)(rc.Play,{className:"h-4 w-4"}),keywords:["record","save","capture","video"],category:"session",action:e.onToggleRecording},{id:"leave-class",title:"Leave Classroom",description:"Exit the current session",icon:(0,y.jsx)(V.LogOut,{className:"h-4 w-4"}),shortcut:"âŒ˜Q",keywords:["leave","exit","quit","end"],category:"system",action:e.onLeaveClass}]},[Q,Y,Z,et,p,eO]),eD=(0,j.useCallback)(e=>{u(t=>t.map(t=>t.id===e?{...t,handRaised:!1}:t)),g(t=>t.map(t=>t.studentId===e?{...t,status:"answered"}:t))},[]),eB=(0,j.useCallback)(e=>{g(t=>t.map(t=>t.id===e?{...t,status:"acknowledged"}:t))},[]),eF=(0,j.useCallback)((e,t,s="socratic")=>{let r=d.find(t=>t.id===e);r&&E.toast.success(`Hint sent to ${r.name}`,{description:"socratic"===s?"Socratic hint delivered":"Encouragement sent"})},[d]),ez=(0,j.useCallback)(e=>{let t=d.find(t=>t.id===e);t&&E.toast.success(`Nudge sent to ${t.name}`,{description:"Remember to ask questions if you need help!"})},[d]),e$=(0,j.useCallback)(e=>{let t=d.find(t=>t.id===e);t&&E.toast.success(`${t.name} invited to breakout room`)},[d]),eV=(0,j.useCallback)((e,t)=>{u(s=>s.map(s=>s.id===e?{...s,breakoutRoomId:t}:s)),m(s=>s.map(s=>{if(s.id===t){let t=d.find(t=>t.id===e);if(t&&!s.participants.find(t=>t.userId===e)){let e={id:t.id,userId:t.id,name:t.name,role:"student",joinedAt:new Date().toISOString(),isOnline:"online"===t.status,isMuted:!1,isVideoOff:!1,isScreenSharing:!1,engagementScore:t.engagementScore,attentionLevel:t.attentionLevel,handRaised:t.handRaised};return{...s,participants:[...s.participants,e]}}}return s}))},[d]),eq=(0,j.useCallback)(e=>{u(t=>t.map(t=>t.id===e?{...t,breakoutRoomId:void 0}:t)),m(t=>t.map(t=>({...t,participants:t.participants.filter(t=>t.userId!==e)})))},[]),eJ=(0,j.useCallback)(e=>{ep(e),ex(!0)},[]),eG=(0,j.useCallback)(()=>{ex(!1),ep(null)},[]),eW=(0,j.useCallback)(e=>{m(t=>t.map(t=>t.id===e?{...t,status:"closed"}:t)),u(t=>t.map(t=>t.breakoutRoomId===e?{...t,breakoutRoomId:void 0}:t)),E.toast.success("Breakout room ended")},[]),eQ=(0,j.useCallback)((e,t)=>{E.toast.success(`Extended room time by ${t} minutes`)},[]),eY=(0,j.useCallback)(e=>{x(t=>t.map(t=>t.id===e?{...t,isPinned:!t.isPinned}:t))},[]),eX=(0,j.useCallback)(async()=>{if(et)try{await eP(!1),await eI()}catch{}t.push("/tutor/dashboard")},[eI,et,eP,t]),eZ=(0,j.useCallback)(()=>{ed(!1),window.localStorage.setItem(ey,"1")},[ey]);if((0,j.useEffect)(()=>{l||ev.current||(ev.current=!0,"1"!==window.localStorage.getItem(ey)&&ed(!0),eO())},[eO,l,ey]),l)return(0,y.jsx)("div",{className:"h-screen flex items-center justify-center bg-gray-50",children:(0,y.jsxs)("div",{className:"text-center",children:[(0,y.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"}),(0,y.jsx)("p",{className:"text-gray-600",children:"Loading live session..."})]})});let e0=d.filter(e=>"online"===e.status).length,e1=p.filter(e=>"pending"===e.status).length,e2=d.filter(e=>e.engagementScore<50).length;return(0,y.jsxs)("div",{className:"h-screen flex flex-col bg-gray-50",children:[(0,y.jsxs)("header",{className:"bg-white border-b px-4 py-3 flex items-center justify-between shrink-0",children:[(0,y.jsxs)("div",{className:"flex items-center gap-4",children:[(0,y.jsx)(k.Button,{variant:"ghost",size:"icon",onClick:()=>t.back(),children:(0,y.jsx)(ru.ArrowLeft,{className:"w-5 h-5"})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h1",{className:"font-semibold text-lg",children:O}),(0,y.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,y.jsxs)("span",{className:"flex items-center gap-1",children:[(0,y.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Live"]}),(0,y.jsx)("span",{children:"â€¢"}),(0,y.jsxs)("span",{children:["Session ID: ",e]})]})]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-4",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsxs)(S.Badge,{variant:"secondary",className:"gap-1",children:[(0,y.jsx)(D.Users,{className:"w-3 h-3"}),e0,"/",d.length]}),e1>0&&(0,y.jsxs)(S.Badge,{variant:"destructive",className:"gap-1",children:[(0,y.jsx)(R.Hand,{className:"w-3 h-3"}),e1]}),e2>0&&(0,y.jsxs)(S.Badge,{variant:"outline",className:"gap-1 border-orange-400 text-orange-600",children:[(0,y.jsx)(eH.TrendingUp,{className:"w-3 h-3"}),e2," struggling"]})]}),(0,y.jsx)(M.Separator,{orientation:"vertical",className:"h-6"}),(0,y.jsxs)(T.DropdownMenu,{children:[(0,y.jsx)(T.DropdownMenuTrigger,{asChild:!0,children:(0,y.jsxs)(k.Button,{variant:"outline",size:"sm",className:"gap-1",children:[(0,y.jsx)(aM,{className:"h-4 w-4"}),(0,y.jsx)("span",{className:"hidden sm:inline",children:"Tools"}),(0,y.jsx)(so.ChevronRight,{className:"h-3 w-3 opacity-80 rotate-90"})]})}),(0,y.jsxs)(T.DropdownMenuContent,{align:"end",className:"w-48",children:[(0,y.jsxs)(T.DropdownMenuItem,{onClick:()=>eT(!0),className:"gap-2",children:[(0,y.jsx)(aT,{className:"h-4 w-4"}),"Command Palette",(0,y.jsx)("kbd",{className:"ml-auto text-[10px] bg-muted px-1 rounded",children:"âŒ˜K"})]}),(0,y.jsxs)(T.DropdownMenuItem,{onClick:()=>ei(!en),className:"gap-2",children:[(0,y.jsx)(ef.BarChart3,{className:"h-4 w-4"}),"Engagement Dashboard",en&&(0,y.jsx)("span",{className:"ml-auto text-green-600",children:"âœ“"})]})]})]}),(0,y.jsx)(M.Separator,{orientation:"vertical",className:"h-6"}),(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(k.Button,{variant:Q?"destructive":"outline",size:"icon",onClick:()=>K(!Q),children:Q?(0,y.jsx)(F.MicOff,{className:"w-4 h-4"}):(0,y.jsx)(ew.Mic,{className:"w-4 h-4"})}),(0,y.jsx)(k.Button,{variant:Y?"destructive":"outline",size:"icon",onClick:()=>X(!Y),children:Y?(0,y.jsx)(ek,{className:"w-4 h-4"}):(0,y.jsx)(eN.Video,{className:"w-4 h-4"})}),(0,y.jsx)(k.Button,{variant:Z?"default":"outline",size:"icon",onClick:()=>ee(!Z),children:(0,y.jsx)(eS,{className:"w-4 h-4"})}),(0,y.jsxs)(k.Button,{variant:et?"destructive":"outline",size:"sm",className:"gap-2",onClick:()=>void eO(),children:[(0,y.jsx)(a_.Radio,{className:et?"w-4 h-4 animate-pulse":"w-4 h-4"}),et?"Stop Recording":"Start Recording"]}),et&&(0,y.jsxs)(S.Badge,{variant:"destructive",className:"gap-1",children:["REC ",Math.floor(er/60),"m ",String(er%60).padStart(2,"0"),"s"]})]}),(0,y.jsx)(M.Separator,{orientation:"vertical",className:"h-6"}),(0,y.jsxs)(k.Button,{variant:"destructive",className:"gap-2",onClick:()=>el(!0),children:[(0,y.jsx)(V.LogOut,{className:"w-4 h-4"}),"End Class"]})]})]}),(0,y.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,y.jsx)("div",{className:"flex-1 p-4 overflow-hidden",children:(0,y.jsxs)(_.Tabs,{value:eu,onValueChange:eh,className:"h-full flex flex-col",children:[(0,y.jsx)("div",{className:"w-full overflow-x-auto pb-1",children:(0,y.jsxs)(_.TabsList,{className:"inline-flex min-w-max bg-muted p-1 rounded-lg gap-1",children:[(0,y.jsxs)(_.TabsTrigger,{value:"students",onClick:()=>eh("students"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,y.jsx)(D.Users,{className:"w-3 h-3"}),"Students"]}),(0,y.jsxs)(_.TabsTrigger,{value:"progress",onClick:()=>eh("progress"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,y.jsx)(eH.TrendingUp,{className:"w-3 h-3"}),"Progress"]}),(0,y.jsxs)(_.TabsTrigger,{value:"rooms",onClick:()=>eh("rooms"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,y.jsx)(G.LayoutGrid,{className:"w-3 h-3"}),"Rooms"]}),(0,y.jsxs)(_.TabsTrigger,{value:"polls",onClick:()=>eh("polls"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,y.jsx)(aC,{className:"w-3 h-3"}),"Polls"]}),(0,y.jsxs)(_.TabsTrigger,{value:"whiteboard",onClick:()=>eh("whiteboard"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,y.jsx)(aM,{className:"w-3 h-3"}),"Whiteboard"]}),(0,y.jsxs)(_.TabsTrigger,{value:"math",onClick:()=>eh("math"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,y.jsx)(aE.Calculator,{className:"w-3 h-3"}),"Math"]}),(0,y.jsxs)(_.TabsTrigger,{value:"course-dev",onClick:()=>eh("course-dev"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,y.jsx)(e6.GraduationCap,{className:"w-3 h-3"}),"Course Dev"]}),(0,y.jsxs)(_.TabsTrigger,{value:"analytics",onClick:()=>eh("analytics"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,y.jsx)(ef.BarChart3,{className:"w-3 h-3"}),"Analytics"]})]})}),(0,y.jsx)(_.TabsContent,{value:"students",className:"flex-1 mt-4 overflow-hidden",children:(0,y.jsx)(W,{students:d,breakoutRooms:h,onCallOn:eD,onAssignToRoom:eV,onRemoveFromRoom:eq,onPushHint:eF,onSendNudge:ez,onInviteToBreakout:e$})}),(0,y.jsx)(_.TabsContent,{value:"progress",className:"flex-1 mt-4 overflow-hidden",children:(0,y.jsx)(sA,{students:d,classDuration:v?.classDuration||0})}),(0,y.jsx)(_.TabsContent,{value:"rooms",className:"flex-1 mt-4 overflow-hidden",children:(0,y.jsx)(ej,{sessionId:e,tutorId:s?.user?.id||"tutor-1",tutorName:s?.user?.name||"Tutor",students:d,onRoomsChange:m,onJoinRoom:eJ})}),(0,y.jsx)(_.TabsContent,{value:"polls",className:"flex-1 mt-4 overflow-hidden",children:(0,y.jsx)(rR,{sessionId:e,tutorId:s?.user?.id||"tutor-1",totalStudents:d.length})}),(0,y.jsx)(_.TabsContent,{value:"whiteboard",className:"flex-1 mt-4 overflow-hidden",children:(0,y.jsx)(sP.MultiLayerWhiteboardInterface,{sessionId:e,roomId:$||e,initialCourseId:q,classSubject:B,students:d.map(e=>({id:e.id,name:e.name,status:e.status,engagement:e.engagementScore})),isSocketConnected:!!o})}),(0,y.jsx)(_.TabsContent,{value:"math",className:"flex-1 mt-4 overflow-hidden",children:(0,y.jsx)(sI.MathBoardHost,{sessionId:`math-${e}`,socket:o,userId:s?.user?.id,userName:s?.user?.name||"Tutor",role:"tutor",className:"h-full"})}),(0,y.jsx)(_.TabsContent,{value:"analytics",className:"flex-1 mt-4 overflow-hidden",children:(0,y.jsx)("div",{className:"h-full overflow-auto",children:v&&(0,y.jsx)(eK,{metrics:v,alerts:P})})}),(0,y.jsx)(_.TabsContent,{value:"course-dev",className:"flex-1 mt-4 overflow-hidden",children:(0,y.jsx)(sS,{roomId:e,students:d.map(e=>({id:e.id,name:e.name,userId:e.id,status:e.status}))})})]})}),(0,y.jsxs)("div",{className:"w-[400px] p-4 pl-0 flex flex-col gap-4 overflow-hidden",children:[(0,y.jsx)("div",{className:"h-[40%] min-h-0",children:(0,y.jsx)(sC,{students:d,metrics:v,classDuration:v?.classDuration||0,currentTopic:B})}),(0,y.jsx)("div",{className:"flex-1 min-h-0",children:(0,y.jsx)(eR,{handRaises:p,onAcknowledge:eB,onAnswer:e=>{let t=p.find(t=>t.id===e);t&&eD(t.studentId)}})}),(0,y.jsx)("div",{className:"flex-1 min-h-0",children:(0,y.jsx)(eU,{messages:f,students:d,socket:o,roomId:e,onPinMessage:eY})})]}),en&&(0,y.jsx)("div",{className:"absolute right-4 top-20 w-96 z-50",children:(0,y.jsx)(r$,{students:eE,isOpen:en,onToggle:()=>ei(!1),onSelectStudent:e=>{E.toast.info(`Selected student: ${e}`)},onSendNudge:ez,onInviteToBreakout:e$})})]}),(0,y.jsx)(eA,{room:em,isOpen:eg,onClose:eG,userId:s?.user?.id||"tutor-1",userName:s?.user?.name||"Tutor",role:"tutor",onEndRoom:eW,onExtendTime:eQ}),(0,y.jsx)(aS,{isOpen:eC,onClose:()=>eT(!1),actions:eL}),(0,y.jsx)(C.Dialog,{open:eo,onOpenChange:el,children:(0,y.jsxs)(C.DialogContent,{children:[(0,y.jsxs)(C.DialogHeader,{children:[(0,y.jsx)(C.DialogTitle,{children:"End Class?"}),(0,y.jsx)(C.DialogDescription,{children:"Are you sure you want to end this live session? All students will be disconnected."})]}),(0,y.jsxs)(C.DialogFooter,{className:"gap-2",children:[(0,y.jsx)(k.Button,{variant:"outline",onClick:()=>el(!1),children:"Cancel"}),(0,y.jsx)(k.Button,{variant:"destructive",onClick:eX,children:"End Class"})]})]})}),(0,y.jsx)(C.Dialog,{modal:!1,open:ec,onOpenChange:e=>{e||eZ()},children:(0,y.jsxs)(C.DialogContent,{children:[(0,y.jsxs)(C.DialogHeader,{children:[(0,y.jsx)(C.DialogTitle,{children:"Class Recording Is On By Default"}),(0,y.jsx)(C.DialogDescription,{children:"This session is being recorded to generate a transcript, AI lesson summary, and replay artifact for quality review, student revision, and attendance/missed-lesson continuity."})]}),(0,y.jsx)(C.DialogFooter,{children:(0,y.jsx)(k.Button,{onClick:eZ,children:"Understood"})})]})})]})}function aP(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;s[r]=e[r]}return s}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)s=n[r],-1===t.indexOf(s)&&({}).propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}function aI(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function aO(e){return(aO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aL(e){var t=function(e,t){if("object"!=aO(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t||"default");if("object"!=aO(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==aO(t)?t:t+""}function aD(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,aL(r.key),r)}}function aR(e,t,s){return t&&aD(e.prototype,t),s&&aD(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function aB(e,t){if(t&&("object"==aO(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aF(e){return(aF=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function az(e,t){return(az=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function a$(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&az(e,t)}function aV(e,t,s){return(t=aL(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function aU(e,t,s,r,a,n,i){try{var o=e[n](i),l=o.value}catch(e){return void s(e)}o.done?t(l):Promise.resolve(l).then(r,a)}function aq(e){return function(){var t=this,s=arguments;return new Promise(function(r,a){var n=e.apply(t,s);function i(e){aU(n,r,a,i,o,"next",e)}function o(e){aU(n,r,a,i,o,"throw",e)}i(void 0)})}}function aH(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}function aJ(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var s=null==e?null:"u">typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=s){var r,a,n,i,o=[],l=!0,c=!1;try{if(n=(s=s.call(e)).next,0===t){if(Object(s)!==s)return;l=!1}else for(;!(l=(r=n.call(s)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=s.return&&(i=s.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return aH(e,t);var s=({}).toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?aH(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var aG,aW={exports:{}},aQ=function(){if(aG)return aW.exports;aG=1;var e,t="object"==typeof Reflect?Reflect:null,s=t&&"function"==typeof t.apply?t.apply:function(e,t,s){return Function.prototype.apply.call(e,t,s)};e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}aW.exports=a,aW.exports.once=function(e,t){return new Promise(function(s,r){function a(s){e.removeListener(t,n),r(s)}function n(){"function"==typeof e.removeListener&&e.removeListener("error",a),s([].slice.call(arguments))}p(e,t,n,{once:!0}),"error"!==t&&"function"==typeof e.on&&p(e,"error",a,{once:!0})})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var n=10;function i(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function o(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function l(e,t,s,r){var a,n,l;if(i(s),void 0===(n=e._events)?(n=e._events=Object.create(null),e._eventsCount=0):(void 0!==n.newListener&&(e.emit("newListener",t,s.listener?s.listener:s),n=e._events),l=n[t]),void 0===l)l=n[t]=s,++e._eventsCount;else if("function"==typeof l?l=n[t]=r?[s,l]:[l,s]:r?l.unshift(s):l.push(s),(a=o(e))>0&&l.length>a&&!l.warned){l.warned=!0;var c=Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=l.length,console&&console.warn&&console.warn(c)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,s){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:s},a=c.bind(r);return a.listener=s,r.wrapFn=a,a}function u(e,t,s){var r=e._events;if(void 0===r)return[];var a=r[t];return void 0===a?[]:"function"==typeof a?s?[a.listener||a]:[a]:s?function(e){for(var t=Array(e.length),s=0;s<t.length;++s)t[s]=e[s].listener||e[s];return t}(a):m(a,a.length)}function h(e){var t=this._events;if(void 0!==t){var s=t[e];if("function"==typeof s)return 1;if(void 0!==s)return s.length}return 0}function m(e,t){for(var s=Array(t),r=0;r<t;++r)s[r]=e[r];return s}function p(e,t,s,r){if("function"==typeof e.on)r.once?e.once(t,s):e.on(t,s);else{if("function"!=typeof e.addEventListener)throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function a(n){r.once&&e.removeEventListener(t,a),s(n)})}}return Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return n},set:function(e){if("number"!=typeof e||e<0||r(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");n=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return o(this)},a.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var a="error"===e,n=this._events;if(void 0!==n)a=a&&void 0===n.error;else if(!a)return!1;if(a){if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var i,o=Error("Unhandled error."+(i?" ("+i.message+")":""));throw o.context=i,o}var l=n[e];if(void 0===l)return!1;if("function"==typeof l)s(l,this,t);else{var c=l.length,d=m(l,c);for(r=0;r<c;++r)s(d[r],this,t)}return!0},a.prototype.addListener=function(e,t){return l(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return l(this,e,t,!0)},a.prototype.once=function(e,t){return i(t),this.on(e,d(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return i(t),this.prependListener(e,d(this,e,t)),this},a.prototype.removeListener=function(e,t){var s,r,a,n,o;if(i(t),void 0===(r=this._events)||void 0===(s=r[e]))return this;if(s===t||s.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,s.listener||t));else if("function"!=typeof s){for(a=-1,n=s.length-1;n>=0;n--)if(s[n]===t||s[n].listener===t){o=s[n].listener,a=n;break}if(a<0)return this;0===a?s.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(s,a),1===s.length&&(r[e]=s[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,s,r;if(void 0===(s=this._events))return this;if(void 0===s.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==s[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete s[e]),this;if(0==arguments.length){var a,n=Object.keys(s);for(r=0;r<n.length;++r)"removeListener"!==(a=n[r])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=s[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return u(this,e,!0)},a.prototype.rawListeners=function(e){return u(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},a.prototype.listenerCount=h,a.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},aW.exports}(),aK=aQ&&aQ.__esModule&&Object.prototype.hasOwnProperty.call(aQ,"default")?aQ.default:aQ,aY=Object.prototype.hasOwnProperty;function aX(e,t,s){for(s of e.keys())if(aZ(s,t))return s}function aZ(e,t){var s,r,a;if(e===t)return!0;if(e&&t&&(s=e.constructor)===t.constructor){if(s===Date)return e.getTime()===t.getTime();if(s===RegExp)return e.toString()===t.toString();if(s===Array){if((r=e.length)===t.length)for(;r--&&aZ(e[r],t[r]););return -1===r}if(s===Set){if(e.size!==t.size)return!1;for(r of e)if((a=r)&&"object"==typeof a&&!(a=aX(t,a))||!t.has(a))return!1;return!0}if(s===Map){if(e.size!==t.size)return!1;for(r of e)if((a=r[0])&&"object"==typeof a&&!(a=aX(t,a))||!aZ(r[1],t.get(a)))return!1;return!0}if(s===ArrayBuffer)e=new Uint8Array(e),t=new Uint8Array(t);else if(s===DataView){if((r=e.byteLength)===t.byteLength)for(;r--&&e.getInt8(r)===t.getInt8(r););return -1===r}if(ArrayBuffer.isView(e)){if((r=e.byteLength)===t.byteLength)for(;r--&&e[r]===t[r];);return -1===r}if(!s||"object"==typeof e){for(s in r=0,e)if(aY.call(e,s)&&++r&&!aY.call(t,s)||!(s in t)||!aZ(e[s],t[s]))return!1;return Object.keys(t).length===r}}return e!=e&&t!=t}let a0={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},a1={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},a2={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},a4={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},a5={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class a3{static getFirstMatch(e,t){let s=t.match(e);return s&&s.length>0&&s[1]||""}static getSecondMatch(e,t){let s=t.match(e);return s&&s.length>1&&s[2]||""}static matchAndReturnConst(e,t,s){if(e.test(t))return s}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){let t=e.split(".").splice(0,2).map(e=>parseInt(e,10)||0);if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){let t=e.split(".").splice(0,2).map(e=>parseInt(e,10)||0);if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,t,s=!1){let r=a3.getVersionPrecision(e),a=a3.getVersionPrecision(t),n=Math.max(r,a),i=0,o=a3.map([e,t],e=>{let t=n-a3.getVersionPrecision(e),s=e+Array(t+1).join(".0");return a3.map(s.split("."),e=>Array(20-e.length).join("0")+e).reverse()});for(s&&(i=n-Math.min(r,a)),n-=1;n>=i;){if(o[0][n]>o[1][n])return 1;if(o[0][n]===o[1][n]){if(n===i)return 0;n-=1}else if(o[0][n]<o[1][n])return -1}}static map(e,t){let s,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(s=0;s<e.length;s+=1)r.push(t(e[s]));return r}static find(e,t){let s,r;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(s=0,r=e.length;s<r;s+=1){let r=e[s];if(t(r,s))return r}}static assign(e,...t){return Object.assign(e,...t)}static getBrowserAlias(e){return a0[e]}static getBrowserTypeByAlias(e){return a1[e]||""}}let a6=/version\/(\d+(\.?_?\d+)+)/i,a8=[{test:[/googlebot/i],describe(e){let t={name:"Googlebot"},s=a3.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||a3.getFirstMatch(a6,e);return s&&(t.version=s),t}},{test:[/opera/i],describe(e){let t={name:"Opera"},s=a3.getFirstMatch(a6,e)||a3.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/opr\/|opios/i],describe(e){let t={name:"Opera"},s=a3.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||a3.getFirstMatch(a6,e);return s&&(t.version=s),t}},{test:[/SamsungBrowser/i],describe(e){let t={name:"Samsung Internet for Android"},s=a3.getFirstMatch(a6,e)||a3.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/Whale/i],describe(e){let t={name:"NAVER Whale Browser"},s=a3.getFirstMatch(a6,e)||a3.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/MZBrowser/i],describe(e){let t={name:"MZ Browser"},s=a3.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||a3.getFirstMatch(a6,e);return s&&(t.version=s),t}},{test:[/focus/i],describe(e){let t={name:"Focus"},s=a3.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||a3.getFirstMatch(a6,e);return s&&(t.version=s),t}},{test:[/swing/i],describe(e){let t={name:"Swing"},s=a3.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||a3.getFirstMatch(a6,e);return s&&(t.version=s),t}},{test:[/coast/i],describe(e){let t={name:"Opera Coast"},s=a3.getFirstMatch(a6,e)||a3.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(e){let t={name:"Opera Touch"},s=a3.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||a3.getFirstMatch(a6,e);return s&&(t.version=s),t}},{test:[/yabrowser/i],describe(e){let t={name:"Yandex Browser"},s=a3.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||a3.getFirstMatch(a6,e);return s&&(t.version=s),t}},{test:[/ucbrowser/i],describe(e){let t={name:"UC Browser"},s=a3.getFirstMatch(a6,e)||a3.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/Maxthon|mxios/i],describe(e){let t={name:"Maxthon"},s=a3.getFirstMatch(a6,e)||a3.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/epiphany/i],describe(e){let t={name:"Epiphany"},s=a3.getFirstMatch(a6,e)||a3.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/puffin/i],describe(e){let t={name:"Puffin"},s=a3.getFirstMatch(a6,e)||a3.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/sleipnir/i],describe(e){let t={name:"Sleipnir"},s=a3.getFirstMatch(a6,e)||a3.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/k-meleon/i],describe(e){let t={name:"K-Meleon"},s=a3.getFirstMatch(a6,e)||a3.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/micromessenger/i],describe(e){let t={name:"WeChat"},s=a3.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||a3.getFirstMatch(a6,e);return s&&(t.version=s),t}},{test:[/qqbrowser/i],describe(e){let t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},s=a3.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||a3.getFirstMatch(a6,e);return s&&(t.version=s),t}},{test:[/msie|trident/i],describe(e){let t={name:"Internet Explorer"},s=a3.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/\sedg\//i],describe(e){let t={name:"Microsoft Edge"},s=a3.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/edg([ea]|ios)/i],describe(e){let t={name:"Microsoft Edge"},s=a3.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/vivaldi/i],describe(e){let t={name:"Vivaldi"},s=a3.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/seamonkey/i],describe(e){let t={name:"SeaMonkey"},s=a3.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/sailfish/i],describe(e){let t={name:"Sailfish"},s=a3.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return s&&(t.version=s),t}},{test:[/silk/i],describe(e){let t={name:"Amazon Silk"},s=a3.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/phantom/i],describe(e){let t={name:"PhantomJS"},s=a3.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/slimerjs/i],describe(e){let t={name:"SlimerJS"},s=a3.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(e){let t={name:"BlackBerry"},s=a3.getFirstMatch(a6,e)||a3.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/(web|hpw)[o0]s/i],describe(e){let t={name:"WebOS Browser"},s=a3.getFirstMatch(a6,e)||a3.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/bada/i],describe(e){let t={name:"Bada"},s=a3.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/tizen/i],describe(e){let t={name:"Tizen"},s=a3.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||a3.getFirstMatch(a6,e);return s&&(t.version=s),t}},{test:[/qupzilla/i],describe(e){let t={name:"QupZilla"},s=a3.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||a3.getFirstMatch(a6,e);return s&&(t.version=s),t}},{test:[/firefox|iceweasel|fxios/i],describe(e){let t={name:"Firefox"},s=a3.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/electron/i],describe(e){let t={name:"Electron"},s=a3.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/MiuiBrowser/i],describe(e){let t={name:"Miui"},s=a3.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/chromium/i],describe(e){let t={name:"Chromium"},s=a3.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||a3.getFirstMatch(a6,e);return s&&(t.version=s),t}},{test:[/chrome|crios|crmo/i],describe(e){let t={name:"Chrome"},s=a3.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/GSA/i],describe(e){let t={name:"Google Search"},s=a3.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test(e){let t=!e.test(/like android/i),s=e.test(/android/i);return t&&s},describe(e){let t={name:"Android Browser"},s=a3.getFirstMatch(a6,e);return s&&(t.version=s),t}},{test:[/playstation 4/i],describe(e){let t={name:"PlayStation 4"},s=a3.getFirstMatch(a6,e);return s&&(t.version=s),t}},{test:[/safari|applewebkit/i],describe(e){let t={name:"Safari"},s=a3.getFirstMatch(a6,e);return s&&(t.version=s),t}},{test:[/.*/i],describe(e){let t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:a3.getFirstMatch(t,e),version:a3.getSecondMatch(t,e)}}}];var a7=[{test:[/Roku\/DVP/],describe(e){let t=a3.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:a4.Roku,version:t}}},{test:[/windows phone/i],describe(e){let t=a3.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:a4.WindowsPhone,version:t}}},{test:[/windows /i],describe(e){let t=a3.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),s=a3.getWindowsVersionName(t);return{name:a4.Windows,version:t,versionName:s}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(e){let t={name:a4.iOS},s=a3.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return s&&(t.version=s),t}},{test:[/macintosh/i],describe(e){let t=a3.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),s=a3.getMacOSVersionName(t),r={name:a4.MacOS,version:t};return s&&(r.versionName=s),r}},{test:[/(ipod|iphone|ipad)/i],describe(e){let t=a3.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:a4.iOS,version:t}}},{test(e){let t=!e.test(/like android/i),s=e.test(/android/i);return t&&s},describe(e){let t=a3.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),s=a3.getAndroidVersionName(t),r={name:a4.Android,version:t};return s&&(r.versionName=s),r}},{test:[/(web|hpw)[o0]s/i],describe(e){let t=a3.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),s={name:a4.WebOS};return t&&t.length&&(s.version=t),s}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(e){let t=a3.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||a3.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||a3.getFirstMatch(/\bbb(\d+)/i,e);return{name:a4.BlackBerry,version:t}}},{test:[/bada/i],describe(e){let t=a3.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:a4.Bada,version:t}}},{test:[/tizen/i],describe(e){let t=a3.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:a4.Tizen,version:t}}},{test:[/linux/i],describe:()=>({name:a4.Linux})},{test:[/CrOS/],describe:()=>({name:a4.ChromeOS})},{test:[/PlayStation 4/],describe(e){let t=a3.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:a4.PlayStation4,version:t}}}],a9=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(e){let t=a3.getFirstMatch(/(can-l01)/i,e)&&"Nova",s={type:a2.mobile,vendor:"Huawei"};return t&&(s.model=t),s}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:a2.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:a2.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:()=>({type:a2.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:a2.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:a2.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:a2.tablet})},{test(e){let t=e.test(/ipod|iphone/i),s=e.test(/like (ipod|iphone)/i);return t&&!s},describe(e){let t=a3.getFirstMatch(/(ipod|iphone)/i,e);return{type:a2.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:a2.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:a2.mobile})},{test:e=>"blackberry"===e.getBrowserName(!0),describe:()=>({type:a2.mobile,vendor:"BlackBerry"})},{test:e=>"bada"===e.getBrowserName(!0),describe:()=>({type:a2.mobile})},{test:e=>"windows phone"===e.getBrowserName(),describe:()=>({type:a2.mobile,vendor:"Microsoft"})},{test(e){let t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:()=>({type:a2.tablet})},{test:e=>"android"===e.getOSName(!0),describe:()=>({type:a2.mobile})},{test:e=>"macos"===e.getOSName(!0),describe:()=>({type:a2.desktop,vendor:"Apple"})},{test:e=>"windows"===e.getOSName(!0),describe:()=>({type:a2.desktop})},{test:e=>"linux"===e.getOSName(!0),describe:()=>({type:a2.desktop})},{test:e=>"playstation 4"===e.getOSName(!0),describe:()=>({type:a2.tv})},{test:e=>"roku"===e.getOSName(!0),describe:()=>({type:a2.tv})}],ne=[{test:e=>"microsoft edge"===e.getBrowserName(!0),describe(e){if(/\sedg\//i.test(e))return{name:a5.Blink};let t=a3.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:a5.EdgeHTML,version:t}}},{test:[/trident/i],describe(e){let t={name:a5.Trident},s=a3.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:e=>e.test(/presto/i),describe(e){let t={name:a5.Presto},s=a3.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test(e){let t=e.test(/gecko/i),s=e.test(/like gecko/i);return t&&!s},describe(e){let t={name:a5.Gecko},s=a3.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:a5.Blink})},{test:[/(apple)?webkit/i],describe(e){let t={name:a5.WebKit},s=a3.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return s&&(t.version=s),t}}];class nt{constructor(e,t=!1){if(null==e||""===e)throw Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};let e=a3.find(a8,e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some(e=>this.test(e));throw Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};let e=a3.find(a7,e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some(e=>this.test(e));throw Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){let{name:t}=this.getOS();return e?String(t).toLowerCase()||"":t||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){let{type:t}=this.getPlatform();return e?String(t).toLowerCase()||"":t||""}parsePlatform(){this.parsedResult.platform={};let e=a3.find(a9,e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some(e=>this.test(e));throw Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};let e=a3.find(ne,e=>{if("function"==typeof e.test)return e.test(this);if(e.test instanceof Array)return e.test.some(e=>this.test(e));throw Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return a3.assign({},this.parsedResult)}satisfies(e){let t={},s=0,r={},a=0;if(Object.keys(e).forEach(n=>{let i=e[n];"string"==typeof i?(r[n]=i,a+=1):"object"==typeof i&&(t[n]=i,s+=1)}),s>0){let e=Object.keys(t),s=a3.find(e,e=>this.isOS(e));if(s){let e=this.satisfies(t[s]);if(void 0!==e)return e}let r=a3.find(e,e=>this.isPlatform(e));if(r){let e=this.satisfies(t[r]);if(void 0!==e)return e}}if(a>0){let e=Object.keys(r),t=a3.find(e,e=>this.isBrowser(e,!0));if(void 0!==t)return this.compareVersion(r[t])}}isBrowser(e,t=!1){let s=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),a=a3.getBrowserTypeByAlias(r);return t&&a&&(r=a.toLowerCase()),r===s}compareVersion(e){let t=[0],s=e,r=!1,a=this.getBrowserVersion();if("string"==typeof a)return">"===e[0]||"<"===e[0]?(s=e.substr(1),"="===e[1]?(r=!0,s=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?s=e.substr(1):"~"===e[0]&&(r=!0,s=e.substr(1)),t.indexOf(a3.compareVersions(a,s,r))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,t=!1){return this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(e=>this.is(e))}}class ns{static getParser(e,t=!1){if("string"!=typeof e)throw Error("UserAgent should be a string");return new nt(e,t)}static parse(e){return new nt(e).getResult()}static get BROWSER_MAP(){return a1}static get ENGINE_MAP(){return a5}static get OS_MAP(){return a4}static get PLATFORMS_MAP(){return a2}}function nr(){return Date.now()+Math.random().toString()}function na(){throw Error("Method must be implemented in subclass")}function nn(e,t){return null!=t&&t.proxyUrl?t.proxyUrl+("/"===t.proxyUrl.slice(-1)?"":"/")+e.substring(8):e}function ni(e){return null!=e&&e.callObjectBundleUrlOverride?e.callObjectBundleUrlOverride:nn("https://c.daily.co/call-machine/versioned/".concat("0.87.0","/static/call-machine-object-bundle.js"),e)}function no(e){try{new URL(e)}catch(e){return!1}return!0}let nl="u"<typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,nc="8.55.0",nd=globalThis;function nu(e,t,s){let r=s||nd,a=r.__SENTRY__=r.__SENTRY__||{},n=a[nc]=a[nc]||{};return n[e]||(n[e]=t())}let nh="u"<typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,nm=["debug","info","warn","error","log","assert","trace"],np={};function ng(e){if(!("console"in nd))return e();let t=nd.console,s={},r=Object.keys(np);r.forEach(e=>{let r=np[e];s[e]=t[e],t[e]=r});try{return e()}finally{r.forEach(e=>{t[e]=s[e]})}}let nf=nu("logger",function(){let e=!1,t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return nh?nm.forEach(s=>{t[s]=(...t)=>{e&&ng(()=>{nd.console[s](`Sentry Logger [${s}]:`,...t)})}}):nm.forEach(e=>{t[e]=()=>{}}),t}),nx=/\(error: (.*)\)/,nv=/captureMessage|captureException/;function ny(e){return e[e.length-1]||{}}let nb="<anonymous>";function nj(e){try{return e&&"function"==typeof e&&e.name||nb}catch(e){return nb}}function nw(e){let t=e.exception;if(t){let e=[];try{return t.values.forEach(t=>{t.stacktrace.frames&&e.push(...t.stacktrace.frames)}),e}catch(e){return}}}let nN={},nk={};function nS(e,t){nN[e]=nN[e]||[],nN[e].push(t)}function n_(e,t){if(!nk[e]){nk[e]=!0;try{t()}catch(t){nh&&nf.error(`Error while instrumenting ${e}`,t)}}}function nC(e,t){let s=e&&nN[e];if(s)for(let r of s)try{r(t)}catch(t){nh&&nf.error(`Error while triggering instrumentation handler.
Type: ${e}
Name: ${nj(r)}
Error:`,t)}}let nM=null;function nT(){nM=nd.onerror,nd.onerror=function(e,t,s,r,a){return nC("error",{column:r,error:a,line:s,msg:e,url:t}),!!nM&&nM.apply(this,arguments)},nd.onerror.__SENTRY_INSTRUMENTED__=!0}let nE=null;function nA(){nE=nd.onunhandledrejection,nd.onunhandledrejection=function(e){return nC("unhandledrejection",e),!nE||nE.apply(this,arguments)},nd.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function nP(){return nI(nd),nd}function nI(e){let t=e.__SENTRY__=e.__SENTRY__||{};return t.version=t.version||nc,t[nc]=t[nc]||{}}let nO=Object.prototype.toString;function nL(e){switch(nO.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return nH(e,Error)}}function nD(e,t){return nO.call(e)===`[object ${t}]`}function nR(e){return nD(e,"ErrorEvent")}function nB(e){return nD(e,"DOMError")}function nF(e){return nD(e,"String")}function nz(e){return"object"==typeof e&&null!==e&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function n$(e){return null===e||nz(e)||"object"!=typeof e&&"function"!=typeof e}function nV(e){return nD(e,"Object")}function nU(e){return"u">typeof Event&&nH(e,Event)}function nq(e){return!!(e&&e.then&&"function"==typeof e.then)}function nH(e,t){try{return e instanceof t}catch(e){return!1}}function nJ(e){return!("object"!=typeof e||null===e||!e.__isVue&&!e._isVue)}function nG(e,t={}){if(!e)return"<unknown>";try{let s,r=e,a=[],n=0,i=0,o=Array.isArray(t)?t:t.keyAttrs,l=!Array.isArray(t)&&t.maxStringLength||80;for(;r&&n++<5&&(s=function(e,t){let s=[];if(!e||!e.tagName)return"";if(nd.HTMLElement&&e instanceof HTMLElement&&e.dataset){if(e.dataset.sentryComponent)return e.dataset.sentryComponent;if(e.dataset.sentryElement)return e.dataset.sentryElement}s.push(e.tagName.toLowerCase());let r=t&&t.length?t.filter(t=>e.getAttribute(t)).map(t=>[t,e.getAttribute(t)]):null;if(r&&r.length)r.forEach(e=>{s.push(`[${e[0]}="${e[1]}"]`)});else{e.id&&s.push(`#${e.id}`);let t=e.className;if(t&&nF(t))for(let e of t.split(/\s+/))s.push(`.${e}`)}for(let t of["aria-label","type","name","title","alt"]){let r=e.getAttribute(t);r&&s.push(`[${t}="${r}"]`)}return s.join("")}(r,o),!("html"===s||n>1&&i+3*a.length+s.length>=l));)a.push(s),i+=s.length,r=r.parentNode;return a.reverse().join(" > ")}catch(e){return"<unknown>"}}function nW(e,t=0){return"string"!=typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function nQ(e,t){if(!Array.isArray(e))return"";let s=[];for(let t=0;t<e.length;t++){let r=e[t];try{nJ(r)?s.push("[VueViewModel]"):s.push(String(r))}catch(e){s.push("[value cannot be serialized]")}}return s.join(t)}function nK(e,t=[],s=!1){return t.some(t=>(function(e,t,s=!1){return!!nF(e)&&(nD(t,"RegExp")?t.test(e):!!nF(t)&&(s?e===t:e.includes(t)))})(e,t,s))}function nY(e,t,s){if(!(t in e))return;let r=e[t],a=s(r);"function"==typeof a&&nZ(a,r);try{e[t]=a}catch(s){nh&&nf.log(`Failed to replace method "${t}" in object`,e)}}function nX(e,t,s){try{Object.defineProperty(e,t,{value:s,writable:!0,configurable:!0})}catch(s){nh&&nf.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function nZ(e,t){try{let s=t.prototype||{};e.prototype=t.prototype=s,nX(e,"__sentry_original__",t)}catch(e){}}function n0(e){return e.__sentry_original__}function n1(e){if(nL(e))return{message:e.message,name:e.name,stack:e.stack,...n4(e)};if(nU(e)){let t={type:e.type,target:n2(e.target),currentTarget:n2(e.currentTarget),...n4(e)};return"u">typeof CustomEvent&&nH(e,CustomEvent)&&(t.detail=e.detail),t}return e}function n2(e){try{return"u">typeof Element&&nH(e,Element)?nG(e):Object.prototype.toString.call(e)}catch(e){return"<unknown>"}}function n4(e){if("object"==typeof e&&null!==e){let t={};for(let s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}return{}}function n5(e){return function e(t,s){if(function(e){if(!nV(e))return!1;try{let t=Object.getPrototypeOf(e).constructor.name;return!t||"Object"===t}catch(e){return!0}}(t)){let r=s.get(t);if(void 0!==r)return r;let a={};for(let r of(s.set(t,a),Object.getOwnPropertyNames(t)))void 0!==t[r]&&(a[r]=e(t[r],s));return a}if(Array.isArray(t)){let r=s.get(t);if(void 0!==r)return r;let a=[];return s.set(t,a),t.forEach(t=>{a.push(e(t,s))}),a}return t}(e,new Map)}function n3(){return Date.now()/1e3}let n6=function(){let{performance:e}=nd;if(!e||!e.now)return n3;let t=Date.now()-e.now(),s=null==e.timeOrigin?t:e.timeOrigin;return()=>(s+e.now())/1e3}();function n8(){let e=nd.crypto||nd.msCrypto,t=()=>16*Math.random();try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(t=()=>{let t=new Uint8Array(1);return e.getRandomValues(t),t[0]})}catch(e){}return"10000000100040008000100000000000".replace(/[018]/g,e=>(e^(15&t())>>e/4).toString(16))}function n7(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function n9(e){let{message:t,event_id:s}=e;if(t)return t;let r=n7(e);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||s||"<unknown>":s||"<unknown>"}function ie(e,t,s){let r=e.exception=e.exception||{},a=r.values=r.values||[],n=a[0]=a[0]||{};n.value||(n.value=t||""),n.type||(n.type=s||"Error")}function it(e,t){let s=n7(e);if(!s)return;let r=s.mechanism;if(s.mechanism={type:"generic",handled:!0,...r,...t},t&&"data"in t){let e={...r&&r.data,...t.data};s.mechanism.data=e}}function is(e){if(function(e){try{return e.__sentry_captured__}catch(e){}}(e))return!0;try{nX(e,"__sentry_captured__",!0)}catch(e){}return!1}function ir(e){return new ii(t=>{t(e)})}function ia(e){return new ii((t,s)=>{s(e)})}(()=>{let{performance:e}=nd;if(!e||!e.now)return;let t=e.now(),s=Date.now(),r=e.timeOrigin?Math.abs(e.timeOrigin+t-s):36e5,a=e.timing&&e.timing.navigationStart,n="number"==typeof a?Math.abs(a+t-s):36e5;(r<36e5||n<36e5)&&r<=n&&e.timeOrigin})(),(u=v||(v={}))[u.PENDING=0]="PENDING",u[u.RESOLVED=1]="RESOLVED",u[u.REJECTED=2]="REJECTED";class ii{constructor(e){ii.prototype.__init.call(this),ii.prototype.__init2.call(this),ii.prototype.__init3.call(this),ii.prototype.__init4.call(this),this._state=v.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(e){this._reject(e)}}then(e,t){return new ii((s,r)=>{this._handlers.push([!1,t=>{if(e)try{s(e(t))}catch(e){r(e)}else s(t)},e=>{if(t)try{s(t(e))}catch(e){r(e)}else r(e)}]),this._executeHandlers()})}catch(e){return this.then(e=>e,e)}finally(e){return new ii((t,s)=>{let r,a;return this.then(t=>{a=!1,r=t,e&&e()},t=>{a=!0,r=t,e&&e()}).then(()=>{a?s(r):t(r)})})}__init(){this._resolve=e=>{this._setResult(v.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(v.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{this._state===v.PENDING&&(nq(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===v.PENDING)return;let e=this._handlers.slice();this._handlers=[],e.forEach(e=>{e[0]||(this._state===v.RESOLVED&&e[1](this._value),this._state===v.REJECTED&&e[2](this._value),e[0]=!0)})}}}function io(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||n6(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:n8()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{let t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}function il(){return n8().substring(16)}function ic(e,t,s=2){if(!t||"object"!=typeof t||s<=0)return t;if(e&&t&&0===Object.keys(t).length)return e;let r={...e};for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=ic(r[e],t[e],s-1));return r}let id="_sentrySpan";function iu(e,t){t?nX(e,id,t):delete e[id]}class ih{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:n8(),spanId:il()}}clone(){let e=new ih;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,iu(e,this[id]),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&io(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;let t="function"==typeof e?e(this):e,[s,r]=t instanceof im?[t.getScopeData(),t.getRequestSession()]:nV(t)?[e,e.requestSession]:[],{tags:a,extra:n,user:i,contexts:o,level:l,fingerprint:c=[],propagationContext:d}=s||{};return this._tags={...this._tags,...a},this._extra={...this._extra,...n},this._contexts={...this._contexts,...o},i&&Object.keys(i).length&&(this._user=i),l&&(this._level=l),c.length&&(this._fingerprint=c),d&&(this._propagationContext=d),r&&(this._requestSession=r),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,iu(this,void 0),this._attachments=[],this.setPropagationContext({traceId:n8()}),this._notifyScopeListeners(),this}addBreadcrumb(e,t){let s="number"==typeof t?t:100;if(s<=0)return this;let r={timestamp:n3(),...e};return this._breadcrumbs.push(r),this._breadcrumbs.length>s&&(this._breadcrumbs=this._breadcrumbs.slice(-s),this._client&&this._client.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:this[id]}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=ic(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext={spanId:il(),...e},this}getPropagationContext(){return this._propagationContext}captureException(e,t){let s=t&&t.event_id?t.event_id:n8();if(!this._client)return nf.warn("No client configured on scope - will not capture exception!"),s;let r=Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:r,...t,event_id:s},this),s}captureMessage(e,t,s){let r=s&&s.event_id?s.event_id:n8();if(!this._client)return nf.warn("No client configured on scope - will not capture message!"),r;let a=Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:a,...s,event_id:r},this),r}captureEvent(e,t){let s=t&&t.event_id?t.event_id:n8();return this._client?this._client.captureEvent(e,{...t,event_id:s},this):nf.warn("No client configured on scope - will not capture event!"),s}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}let im=ih;class ip{constructor(e,t){let s,r;s=e||new im,r=t||new im,this._stack=[{scope:s}],this._isolationScope=r}withScope(e){let t,s=this._pushScope();try{t=e(s)}catch(e){throw this._popScope(),e}return nq(t)?t.then(e=>(this._popScope(),e),e=>{throw this._popScope(),e}):(this._popScope(),t)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){let e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function ig(){let e=nI(nP());return e.stack=e.stack||new ip(nu("defaultCurrentScope",()=>new im),nu("defaultIsolationScope",()=>new im))}function ix(e){return ig().withScope(e)}function iv(e,t){let s=ig();return s.withScope(()=>(s.getStackTop().scope=e,t(e)))}function iy(e){return ig().withScope(()=>e(ig().getIsolationScope()))}function ib(e){let t=nI(e);return t.acs?t.acs:{withIsolationScope:iy,withScope:ix,withSetScope:iv,withSetIsolationScope:(e,t)=>iy(t),getCurrentScope:()=>ig().getScope(),getIsolationScope:()=>ig().getIsolationScope()}}function ij(){return ib(nP()).getCurrentScope()}function iw(){return ib(nP()).getIsolationScope()}function iN(){return ij().getClient()}let ik=/^sentry-/;function iS(e){return e.split(",").map(e=>e.split("=").map(e=>decodeURIComponent(e.trim()))).reduce((e,[t,s])=>(t&&s&&(e[t]=s),e),{})}let i_=!1;function iC(e){return"number"==typeof e?iM(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?iM(e.getTime()):n6()}function iM(e){return e>0x2540be3ff?e/1e3:e}function iT(e){if("function"==typeof e.getSpanJSON)return e.getSpanJSON();try{let{spanId:t,traceId:s}=e.spanContext();if(e.attributes&&e.startTime&&e.name&&e.endTime&&e.status){let{attributes:r,startTime:a,name:n,endTime:i,parentSpanId:o,status:l}=e;return n5({span_id:t,trace_id:s,data:r,description:n,parent_span_id:o,start_timestamp:iC(a),timestamp:iC(i)||void 0,status:function(e){if(e&&0!==e.code)return 1===e.code?"ok":e.message||"unknown_error"}(l),op:r["sentry.op"],origin:r["sentry.origin"],_metrics_summary:function(e){let t=e._sentryMetrics;if(!t)return;let s={};for(let[,[e,r]]of t)(s[e]||(s[e]=[])).push(n5(r));return s}(e)})}return{span_id:t,trace_id:s}}catch(e){return{}}}function iE(e){return e._sentryRootSpan||e}let iA="production";function iP(e,t){let s=t.getOptions(),{publicKey:r}=t.getDsn()||{},a=n5({environment:s.environment||iA,release:s.release,public_key:r,trace_id:e});return t.emit("createDsc",a),a}let iI=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function iO(e,t=!1){let{host:s,path:r,pass:a,port:n,projectId:i,protocol:o,publicKey:l}=e;return`${o}://${l}${t&&a?`:${a}`:""}@${s}${n?`:${n}`:""}/${r?`${r}/`:r}${i}`}function iL(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function iD(t,s=100,r=1/0){try{return function t(s,r,a=1/0,n=1/0,i=function(){let e="function"==typeof WeakSet,t=e?new WeakSet:[];return[function(s){if(e)return!!t.has(s)||(t.add(s),!1);for(let e=0;e<t.length;e++)if(t[e]===s)return!0;return t.push(s),!1},function(s){if(e)t.delete(s);else for(let e=0;e<t.length;e++)if(t[e]===s){t.splice(e,1);break}}]}()){let[o,l]=i;if(null==r||["boolean","string"].includes(typeof r)||"number"==typeof r&&Number.isFinite(r))return r;let c=function(t,s){try{let r;if("domain"===t&&s&&"object"==typeof s&&s._events)return"[Domain]";if("domainEmitter"===t)return"[DomainEmitter]";if(s===e.g)return"[Global]";if("u">typeof window&&s===window)return"[Window]";if("u">typeof document&&s===document)return"[Document]";if(nJ(s))return"[VueViewModel]";if(nV(s)&&"nativeEvent"in s&&"preventDefault"in s&&"stopPropagation"in s)return"[SyntheticEvent]";if("number"==typeof s&&!Number.isFinite(s))return`[${s}]`;if("function"==typeof s)return`[Function: ${nj(s)}]`;if("symbol"==typeof s)return`[${String(s)}]`;if("bigint"==typeof s)return`[BigInt: ${String(s)}]`;let a=(r=Object.getPrototypeOf(s))?r.constructor.name:"null prototype";return/^HTML(\w*)Element$/.test(a)?`[HTMLElement: ${a}]`:`[object ${a}]`}catch(e){return`**non-serializable** (${e})`}}(s,r);if(!c.startsWith("[object "))return c;if(r.__sentry_skip_normalization__)return r;let d="number"==typeof r.__sentry_override_normalization_depth__?r.__sentry_override_normalization_depth__:a;if(0===d)return c.replace("object ","");if(o(r))return"[Circular ~]";if(r&&"function"==typeof r.toJSON)try{return t("",r.toJSON(),d-1,n,i)}catch(e){}let u=Array.isArray(r)?[]:{},h=0,m=n1(r);for(let e in m){if(!Object.prototype.hasOwnProperty.call(m,e))continue;if(h>=n){u[e]="[MaxProperties ~]";break}let s=m[e];u[e]=t(e,s,d-1,n,i),h++}return l(r),u}("",t,s,r)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}function iR(e,t=[]){return[e,t]}function iB(e,t){for(let s of e[1])if(t(s,s[0].type))return!0;return!1}function iF(e){return nd.__SENTRY__&&nd.__SENTRY__.encodePolyfill?nd.__SENTRY__.encodePolyfill(e):(new TextEncoder).encode(e)}let iz={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket",raw_security:"security"};function i$(e){if(!e||!e.sdk)return;let{name:t,version:s}=e.sdk;return{name:t,version:s}}function iV(e,t){let{extra:s,tags:r,user:a,contexts:n,level:i,sdkProcessingMetadata:o,breadcrumbs:l,fingerprint:c,eventProcessors:d,attachments:u,propagationContext:h,transactionName:m,span:p}=t;iU(e,"extra",s),iU(e,"tags",r),iU(e,"user",a),iU(e,"contexts",n),e.sdkProcessingMetadata=ic(e.sdkProcessingMetadata,o,2),i&&(e.level=i),m&&(e.transactionName=m),p&&(e.span=p),l.length&&(e.breadcrumbs=[...e.breadcrumbs,...l]),c.length&&(e.fingerprint=[...e.fingerprint,...c]),d.length&&(e.eventProcessors=[...e.eventProcessors,...d]),u.length&&(e.attachments=[...e.attachments,...u]),e.propagationContext={...e.propagationContext,...h}}function iU(e,t,s){e[t]=ic(e[t],s,1)}let iq=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function iH(e,t){return ij().captureEvent(e,t)}function iJ(e){var t;let s,r,a=iN(),n=iw(),i=ij(),{release:o,environment:l=iA}=a&&a.getOptions()||{},{userAgent:c}=nd.navigator||{},d=(t={release:o,environment:l,user:i.getUser()||n.getUser(),...c&&{userAgent:c},...e},s=n6(),r={sid:n8(),init:!0,timestamp:s,started:s,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>{var e;return e=r,n5({sid:`${e.sid}`,init:e.init,started:new Date(1e3*e.started).toISOString(),timestamp:new Date(1e3*e.timestamp).toISOString(),status:e.status,errors:e.errors,did:"number"==typeof e.did||"string"==typeof e.did?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}},t&&io(r,t),r),u=n.getSession();return u&&"ok"===u.status&&io(u,{status:"exited"}),iG(),n.setSession(d),i.setSession(d),d}function iG(){let e,t=iw(),s=ij(),r=s.getSession()||t.getSession();r&&(e={},"ok"===r.status&&(e={status:"exited"}),io(r,e)),iW(),t.setSession(),s.setSession()}function iW(){let e=iw(),t=ij(),s=iN(),r=t.getSession()||e.getSession();r&&s&&s.captureSession(r)}function iQ(e=!1){e?iG():iW()}let iK=[];function iY(e,t){for(let s of t)s&&s.afterAllSetup&&s.afterAllSetup(e)}function iX(e,t,s){if(s[t.name])nl&&nf.log(`Integration skipped because it was already installed: ${t.name}`);else{if(s[t.name]=t,-1===iK.indexOf(t.name)&&"function"==typeof t.setupOnce&&(t.setupOnce(),iK.push(t.name)),t.setup&&"function"==typeof t.setup&&t.setup(e),"function"==typeof t.preprocessEvent){let s=t.preprocessEvent.bind(t);e.on("preprocessEvent",(t,r)=>s(t,r,e))}if("function"==typeof t.processEvent){let s=t.processEvent.bind(t),r=Object.assign((t,r)=>s(t,r,e),{id:t.name});e.addEventProcessor(r)}nl&&nf.log(`Integration installed: ${t.name}`)}}class iZ extends Error{constructor(e,t="warn"){super(e),this.message=e,this.logLevel=t}}let i0="Not capturing exception because it's already been captured.";class i1{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=function(e){let t="string"==typeof e?function(e){let t=iI.exec(e);if(!t)return void ng(()=>{console.error(`Invalid Sentry Dsn: ${e}`)});let[s,r,a="",n="",i="",o=""]=t.slice(1),l="",c=o,d=c.split("/");if(d.length>1&&(l=d.slice(0,-1).join("/"),c=d.pop()),c){let e=c.match(/^\d+/);e&&(c=e[0])}return iL({host:n,pass:a,path:l,projectId:c,port:i,protocol:s,publicKey:r})}(e):iL(e);if(t&&function(e){if(!nh)return!0;let{port:t,projectId:s,protocol:r}=e;return!(["protocol","publicKey","host","projectId"].find(t=>!e[t]&&(nf.error(`Invalid Sentry Dsn: ${t} missing`),!0))||(s.match(/^\d+$/)?"http"===r||"https"===r?t&&isNaN(parseInt(t,10))&&(nf.error(`Invalid Sentry Dsn: Invalid port ${t}`),1):(nf.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),1):(nf.error(`Invalid Sentry Dsn: Invalid projectId ${s}`),1)))}(t))return t}(e.dsn):nl&&nf.warn("No DSN provided, client will not send events."),this._dsn){const t=function(e,t,s){let r,a,n;return t||`${r=e.protocol?`${e.protocol}:`:"",a=e.port?`:${e.port}`:"",`${r}//${e.host}${a}${e.path?`/${e.path}`:""}/api/`}${e.projectId}/envelope/?${n={sentry_version:"7"},e.publicKey&&(n.sentry_key=e.publicKey),s&&(n.sentry_client=`${s.name}/${s.version}`),new URLSearchParams(n).toString()}`}(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}const t=["enableTracing","tracesSampleRate","tracesSampler"].find(t=>t in e&&null==e[t]);t&&ng(()=>{console.warn(`[Sentry] Deprecation warning: \`${t}\` is set to undefined, which leads to tracing being enabled. In v9, a value of \`undefined\` will result in tracing being disabled.`)})}captureException(e,t,s){let r=n8();if(is(e))return nl&&nf.log(i0),r;let a={event_id:r,...t};return this._process(this.eventFromException(e,a).then(e=>this._captureEvent(e,a,s))),a.event_id}captureMessage(e,t,s,r){let a={event_id:n8(),...s},n=nz(e)?e:String(e),i=n$(e)?this.eventFromMessage(n,t,a):this.eventFromException(e,a);return this._process(i.then(e=>this._captureEvent(e,a,r))),a.event_id}captureEvent(e,t,s){let r=n8();if(t&&t.originalException&&is(t.originalException))return nl&&nf.log(i0),r;let a={event_id:r,...t},n=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,a,n||s)),a.event_id}captureSession(e){"string"!=typeof e.release?nl&&nf.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),io(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){let t=this._transport;return t?(this.emit("flush"),this._isClientDoneProcessing(e).then(s=>t.flush(e).then(e=>s&&e))):ir(!0)}close(e){return this.flush(e).then(e=>(this.getOptions().enabled=!1,this.emit("close"),e))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){let t=this._integrations[e.name];iX(this,e,this._integrations),t||iY(this,[e])}sendEvent(e,t={}){var s,r,a,n;let i,o,l,c;this.emit("beforeSendEvent",e,t);let d=(s=this._dsn,r=this._options._metadata,a=this._options.tunnel,i=i$(r),o=e.type&&"replay_event"!==e.type?e.type:"event",(n=r&&r.sdk)&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||n.name,e.sdk.version=e.sdk.version||n.version,e.sdk.integrations=[...e.sdk.integrations||[],...n.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...n.packages||[]]),l=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext,c={event_id:e.event_id,sent_at:(new Date).toISOString(),...i&&{sdk:i},...!!a&&s&&{dsn:iO(s)},...l&&{trace:n5({...l})}},delete e.sdkProcessingMetadata,iR(c,[[{type:o},e]]));for(let e of t.attachments||[])d=function(e,t){let[s,r]=e;return[s,[...r,t]]}(d,function(e){let t="string"==typeof e.data?iF(e.data):e.data;return[n5({type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),t]}(e));let u=this.sendEnvelope(d);u&&u.then(t=>this.emit("afterSendEvent",e,t),null)}sendSession(e){var t,s,r;let a,n=(t=this._dsn,s=this._options._metadata,r=this._options.tunnel,a=i$(s),iR({sent_at:(new Date).toISOString(),...a&&{sdk:a},...!!r&&t&&{dsn:iO(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]]));this.sendEnvelope(n)}recordDroppedEvent(e,t,s){if(this._options.sendClientReports){let r="number"==typeof s?s:1,a=`${e}:${t}`;nl&&nf.log(`Recording outcome: "${a}"${r>1?` (${r} times)`:""}`),this._outcomes[a]=(this._outcomes[a]||0)+r}}on(e,t){let s=this._hooks[e]=this._hooks[e]||[];return s.push(t),()=>{let e=s.indexOf(t);e>-1&&s.splice(e,1)}}emit(e,...t){let s=this._hooks[e];s&&s.forEach(e=>e(...t))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,e=>(nl&&nf.error("Error while sending envelope:",e),e)):(nl&&nf.error("Transport disabled"),ir({}))}_setupIntegrations(){var e;let t,{integrations:s}=this._options;this._integrations=(e=this,t={},s.forEach(s=>{s&&iX(e,s,t)}),t),iY(this,s)}_updateSessionFromEvent(e,t){let s="fatal"===t.level,r=!1,a=t.exception&&t.exception.values;if(a)for(let e of(r=!0,a)){let t=e.mechanism;if(t&&!1===t.handled){s=!0;break}}let n="ok"===e.status;(n&&0===e.errors||n&&s)&&(io(e,{...s&&{status:"crashed"},errors:e.errors||Number(r||s)}),this.captureSession(e))}_isClientDoneProcessing(e){return new ii(t=>{let s=0,r=setInterval(()=>{0==this._numProcessing?(clearInterval(r),t(!0)):(s+=1,e&&s>=e&&(clearInterval(r),t(!1)))},1)})}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,s=ij(),i=iw()){let o=this.getOptions(),l=Object.keys(this._integrations);return!t.integrations&&l.length>0&&(t.integrations=l),this.emit("preprocessEvent",e,t),e.type||i.setLastEventId(e.event_id||t.event_id),(function(e,t,s,i,o,l){let{normalizeDepth:c=3,normalizeMaxBreadth:d=1e3}=e,u={...t,event_id:t.event_id||s.event_id||n8(),timestamp:t.timestamp||n3()},h=s.integrations||e.integrations.map(e=>e.name);!function(e,t){let{environment:s,release:r,dist:a,maxValueLength:n=250}=t;e.environment=e.environment||s||iA,!e.release&&r&&(e.release=r),!e.dist&&a&&(e.dist=a),e.message&&(e.message=nW(e.message,n));let i=e.exception&&e.exception.values&&e.exception.values[0];i&&i.value&&(i.value=nW(i.value,n));let o=e.request;o&&o.url&&(o.url=nW(o.url,n))}(u,e),h.length>0&&(u.sdk=u.sdk||{},u.sdk.integrations=[...u.sdk.integrations||[],...h]),o&&o.emit("applyFrameMetadata",t),void 0===t.type&&function(e,t){let s=function(e){let t=nd._sentryDebugIds;if(!t)return{};let s=Object.keys(t);return n&&s.length===a||(a=s.length,n=s.reduce((s,a)=>{r||(r={});let n=r[a];if(n)s[n[0]]=n[1];else{let n=e(a);for(let e=n.length-1;e>=0;e--){let i=n[e],o=i&&i.filename,l=t[a];if(o&&l){s[o]=l,r[a]=[o,l];break}}}return s},{})),n}(t);try{e.exception.values.forEach(e=>{e.stacktrace.frames.forEach(e=>{s&&e.filename&&(e.debug_id=s[e.filename])})})}catch(e){}}(u,e.stackParser);let m=function(e,t){if(!t)return e;let s=e?e.clone():new im;return s.update(t),s}(i,s.captureContext);s.mechanism&&it(u,s.mechanism);let p=o?o.getEventProcessors():[],g=nu("globalScope",()=>new im).getScopeData();l&&iV(g,l.getScopeData()),m&&iV(g,m.getScopeData());let f=[...s.attachments||[],...g.attachments];return f.length&&(s.attachments=f),function(e,t){let s,r,{fingerprint:a,span:n,breadcrumbs:i,sdkProcessingMetadata:o}=t;!function(e,t){let{extra:s,tags:r,user:a,contexts:n,level:i,transactionName:o}=t,l=n5(s);l&&Object.keys(l).length&&(e.extra={...l,...e.extra});let c=n5(r);c&&Object.keys(c).length&&(e.tags={...c,...e.tags});let d=n5(a);d&&Object.keys(d).length&&(e.user={...d,...e.user});let u=n5(n);u&&Object.keys(u).length&&(e.contexts={...u,...e.contexts}),i&&(e.level=i),o&&"transaction"!==e.type&&(e.transaction=o)}(e,t),n&&(e.contexts={trace:function(e){let{spanId:t,traceId:s,isRemote:r}=e.spanContext();return n5({parent_span_id:r?t:iT(e).parent_span_id,span_id:r?il():t,trace_id:s})}(n),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:function(e){let t=iN();if(!t)return{};let s=iE(e),r=s._frozenDsc;if(r)return r;let a=s.spanContext().traceState,n=a&&a.get("sentry.dsc"),i=n&&function(e){let t=function(e){if(e&&(nF(e)||Array.isArray(e)))return Array.isArray(e)?e.reduce((e,t)=>(Object.entries(iS(t)).forEach(([t,s])=>{e[t]=s}),e),{}):iS(e)}(e);if(!t)return;let s=Object.entries(t).reduce((e,[t,s])=>(t.match(ik)&&(e[t.slice(7)]=s),e),{});return Object.keys(s).length>0?s:void 0}(n);if(i)return i;let o=iP(e.spanContext().traceId,t),l=iT(s),c=l.data||{},d=c["sentry.sample_rate"];null!=d&&(o.sample_rate=`${d}`);let u=c["sentry.source"],h=l.description;return"url"!==u&&h&&(o.transaction=h),function(e){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;let t=iN(),s=t&&t.getOptions();return!!s&&(s.enableTracing||"tracesSampleRate"in s||"tracesSampler"in s)}()&&(o.sampled=String(function(e){let{traceFlags:t}=e.spanContext();return 1===t}(s))),t.emit("createDsc",o,s),o}(n),...e.sdkProcessingMetadata},(s=iT(iE(n)).description)&&!e.transaction&&"transaction"===e.type&&(e.transaction=s)),e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],a&&(e.fingerprint=e.fingerprint.concat(a)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint,r=[...e.breadcrumbs||[],...i],e.breadcrumbs=r.length?r:void 0,e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...o}}(u,g),(function e(t,s,r,a=0){return new ii((n,i)=>{let o=t[a];if(null===s||"function"!=typeof o)n(s);else{let l=o({...s},r);nl&&o.id&&null===l&&nf.log(`Event processor "${o.id}" dropped event`),nq(l)?l.then(s=>e(t,s,r,a+1).then(n)).then(null,i):e(t,l,r,a+1).then(n).then(null,i)}})})([...p,...g.eventProcessors],u,s).then(e=>(e&&function(e){let t={};try{e.exception.values.forEach(e=>{e.stacktrace.frames.forEach(e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)})})}catch(e){}if(0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];let s=e.debug_meta.images;Object.entries(t).forEach(([e,t])=>{s.push({type:"sourcemap",code_file:e,debug_id:t})})}(e),"number"==typeof c&&c>0?function(e,t,s){if(!e)return null;let r={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(e=>({...e,...e.data&&{data:iD(e.data,t,s)}}))},...e.user&&{user:iD(e.user,t,s)},...e.contexts&&{contexts:iD(e.contexts,t,s)},...e.extra&&{extra:iD(e.extra,t,s)}};return e.contexts&&e.contexts.trace&&r.contexts&&(r.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(r.contexts.trace.data=iD(e.contexts.trace.data,t,s))),e.spans&&(r.spans=e.spans.map(e=>({...e,...e.data&&{data:iD(e.data,t,s)}}))),e.contexts&&e.contexts.flags&&r.contexts&&(r.contexts.flags=iD(e.contexts.flags,3,s)),r}(e,c,d):e))})(o,e,t,s,this,i).then(e=>{let t;return null===e?e:(e.contexts={trace:function(e){let{traceId:t,spanId:s,parentSpanId:r}=e.getPropagationContext();return n5({trace_id:t,span_id:s,parent_span_id:r})}(s),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:(t=s.getPropagationContext()).dsc||iP(t.traceId,this),...e.sdkProcessingMetadata},e)})}_captureEvent(e,t={},s){return this._processEvent(e,t,s).then(e=>e.event_id,e=>{nl&&(e instanceof iZ&&"log"===e.logLevel?nf.log(e.message):nf.warn(e))})}_processEvent(e,t,s){let r=this.getOptions(),{sampleRate:a}=r,n=i4(e),i=i2(e),o=e.type||"error",l=`before send for type \`${o}\``,c=void 0===a?void 0:function(e){if("boolean"==typeof e)return Number(e);let t="string"==typeof e?parseFloat(e):e;if(!("number"!=typeof t||isNaN(t)||t<0||t>1))return t;nl&&nf.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(e)} of type ${JSON.stringify(typeof e)}.`)}(a);if(i&&"number"==typeof c&&Math.random()>c)return this.recordDroppedEvent("sample_rate","error",e),ia(new iZ(`Discarding event because it's not included in the random sample (sampling rate = ${a})`,"log"));let d="replay_event"===o?"replay":o,u=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,t,s,u).then(s=>{if(null===s)throw this.recordDroppedEvent("event_processor",d,e),new iZ("An event processor returned `null`, will not send event.","log");if(t.data&&!0===t.data.__sentry__)return s;var a=function(e,t,s,r){let{beforeSend:a,beforeSendTransaction:n,beforeSendSpan:i}=t;if(i2(s)&&a)return a(s,r);if(i4(s)){if(s.spans&&i){let t=[];for(let r of s.spans){let s=i(r);s?t.push(s):(i_||(ng(()=>{console.warn("[Sentry] Deprecation warning: Returning null from `beforeSendSpan` will be disallowed from SDK version 9.0.0 onwards. The callback will only support mutating spans. To drop certain spans, configure the respective integrations directly.")}),i_=!0),e.recordDroppedEvent("before_send","span"))}s.spans=t}if(n){if(s.spans){let e=s.spans.length;s.sdkProcessingMetadata={...s.sdkProcessingMetadata,spanCountBeforeProcessing:e}}return n(s,r)}}return s}(this,r,s,t);let n=`${l} must return \`null\` or a valid event.`;if(nq(a))return a.then(e=>{if(!nV(e)&&null!==e)throw new iZ(n);return e},e=>{throw new iZ(`${l} rejected with ${e}`)});if(!nV(a)&&null!==a)throw new iZ(n);return a}).then(r=>{if(null===r){if(this.recordDroppedEvent("before_send",d,e),n){let t=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",t)}throw new iZ(`${l} returned \`null\`, will not send event.`,"log")}let a=s&&s.getSession();if(!n&&a&&this._updateSessionFromEvent(a,r),n){let e=(r.sdkProcessingMetadata&&r.sdkProcessingMetadata.spanCountBeforeProcessing||0)-(r.spans?r.spans.length:0);e>0&&this.recordDroppedEvent("before_send","span",e)}let i=r.transaction_info;return n&&i&&r.transaction!==e.transaction&&(r.transaction_info={...i,source:"custom"}),this.sendEvent(r,t),r}).then(null,e=>{if(e instanceof iZ)throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),new iZ(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${e}`)})}_process(e){this._numProcessing++,e.then(e=>(this._numProcessing--,e),e=>(this._numProcessing--,e))}_clearOutcomes(){let e=this._outcomes;return this._outcomes={},Object.entries(e).map(([e,t])=>{let[s,r]=e.split(":");return{reason:s,category:r,quantity:t}})}_flushOutcomes(){var e,t;nl&&nf.log("Flushing outcomes...");let s=this._clearOutcomes();if(0===s.length)return void(nl&&nf.log("No outcomes to send"));if(!this._dsn)return void(nl&&nf.log("No dsn provided, will not send outcomes"));nl&&nf.log("Sending outcomes:",s);let r=iR((e=this._options.tunnel&&iO(this._dsn))?{dsn:e}:{},[[{type:"client_report"},{timestamp:t||n3(),discarded_events:s}]]);this.sendEnvelope(r)}}function i2(e){return void 0===e.type}function i4(e){return"transaction"===e.type}function i5(e,t){if("event"===t||"transaction"===t)return Array.isArray(e)?e[1]:void 0}function i3(e,t){let s=iN(),r=iw();if(!s)return;let{beforeBreadcrumb:a=null,maxBreadcrumbs:n=100}=s.getOptions();if(n<=0)return;let i={timestamp:n3(),...e},o=a?ng(()=>a(i,t)):i;null!==o&&(s.emit&&s.emit("beforeAddBreadcrumb",o,t),r.addBreadcrumb(o,n))}let i6=new WeakMap,i8=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",'can\'t redefine non-configurable property "solana"',"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/];function i7(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch(e){}return t?function(e=[]){for(let t=e.length-1;t>=0;t--){let s=e[t];if(s&&"<anonymous>"!==s.filename&&"[native code]"!==s.filename)return s.filename||null}return null}(t):null}catch(t){return nl&&nf.error(`Cannot extract url for event ${n9(e)}`),null}}function i9(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,..."AggregateError"===e.type&&{is_exception_group:!0},exception_id:t}}function oe(e,t,s,r){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:s,parent_id:r}}function ot(e){if(!e)return{};let t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};let s=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:s,hash:r,relative:t[5]+s+r}}function os(){"console"in nd&&nm.forEach(function(e){e in nd.console&&nY(nd.console,e,function(t){return np[e]=t,function(...t){nC("console",{args:t,level:e});let s=np[e];s&&s.apply(nd.console,t)}})})}function or(e,t){let s=nw(e),r=nw(t);if(!s&&!r)return!0;if(s&&!r||!s&&r||r.length!==s.length)return!1;for(let e=0;e<r.length;e++){let t=r[e],a=s[e];if(t.filename!==a.filename||t.lineno!==a.lineno||t.colno!==a.colno||t.function!==a.function)return!1}return!0}function oa(e,t){let s=e.fingerprint,r=t.fingerprint;if(!s&&!r)return!0;if(s&&!r||!s&&r)return!1;try{return s.join("")===r.join("")}catch(e){return!1}}function on(e){return e.exception&&e.exception.values&&e.exception.values[0]}function oi(e){return void 0===e?void 0:e>=400&&e<500?"warning":e>=500?"error":void 0}function oo(e){return e&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function ol(e,t){return!!e&&"object"==typeof e&&!!e[t]}function oc(e){return"string"==typeof e?e:e?ol(e,"url")?e.url:e.toString?e.toString():"":""}let od=0;function ou(e,t={}){if("function"!=typeof e)return e;try{let t=e.__sentry_wrapped__;if(t)return"function"==typeof t?t:e;if(n0(e))return e}catch(t){return e}let s=function(...s){try{let r=s.map(e=>ou(e,t));return e.apply(this,r)}catch(e){throw od++,setTimeout(()=>{od--}),function(...e){let t=ib(nP());if(2===e.length){let[s,r]=e;return s?t.withSetScope(s,r):t.withScope(r)}t.withScope(e[0])}(r=>{var a;r.addEventProcessor(e=>(t.mechanism&&(ie(e,void 0,void 0),it(e,t.mechanism)),e.extra={...e.extra,arguments:s},e)),ij().captureException(e,function(e){if(e)return e instanceof im||"function"==typeof e||Object.keys(e).some(e=>iq.includes(e))?{captureContext:e}:e}(a))}),e}};try{for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=e[t])}catch(e){}nZ(s,e),nX(e,"__sentry_wrapped__",s);try{Object.getOwnPropertyDescriptor(s,"name").configurable&&Object.defineProperty(s,"name",{get:()=>e.name})}catch(e){}return s}let oh="u"<typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function om(e,t){var s,r;let a,n,i=og(e,t),o={type:!(a=(s=t)&&s.name)&&ox(s)?s.message&&Array.isArray(s.message)&&2==s.message.length?s.message[0]:"WebAssembly.Exception":a,value:(n=(r=t)&&r.message)?n.error&&"string"==typeof n.error.message?n.error.message:ox(r)&&Array.isArray(r.message)&&2==r.message.length?r.message[1]:n:"No error message"};return i.length&&(o.stacktrace={frames:i}),void 0===o.type&&""===o.value&&(o.value="Unrecoverable error caught"),o}function op(e,t){return{exception:{values:[om(e,t)]}}}function og(e,t){let s=t.stacktrace||t.stack||"",r=t&&of.test(t.message)?1:0,a="number"==typeof t.framesToPop?t.framesToPop:0;try{return e(s,r,a)}catch(e){}return[]}let of=/Minified React error #\d+;/i;function ox(e){return"u">typeof WebAssembly&&void 0!==WebAssembly.Exception&&e instanceof WebAssembly.Exception}function ov(e,t,s,r,a){let n;if(nR(t)&&t.error)return op(e,t.error);if(nB(t)||nD(t,"DOMException")){if("stack"in t)n=op(e,t);else{let a=t.name||(nB(t)?"DOMError":"DOMException"),i=t.message?`${a}: ${t.message}`:a;ie(n=oy(e,i,s,r),i)}return"code"in t&&(n.tags={...n.tags,"DOMException.code":`${t.code}`}),n}return nL(t)?op(e,t):(nV(t)||nU(t)?it(n=function(e,t,s,r){let a=iN(),n=a&&a.getOptions().normalizeDepth,i=function(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let s=e[t];if(s instanceof Error)return s}}(t),o={__serialized__:function e(t,s=3,r=102400){let a=iD(t,s);return~-encodeURI(JSON.stringify(a)).split(/%..|./).length>r?e(t,s-1,r):a}(t,n)};if(i)return{exception:{values:[om(e,i)]},extra:o};let l={exception:{values:[{type:nU(t)?t.constructor.name:r?"UnhandledRejection":"Error",value:function(e,{isUnhandledRejection:t}){let s=function(e,t=40){let s=Object.keys(n1(e));s.sort();let r=s[0];if(!r)return"[object has no keys]";if(r.length>=t)return nW(r,t);for(let e=s.length;e>0;e--){let r=s.slice(0,e).join(", ");if(!(r.length>t))return e===s.length?r:nW(r,t)}return""}(e),r=t?"promise rejection":"exception";return nR(e)?`Event \`ErrorEvent\` captured as ${r} with message \`${e.message}\``:nU(e)?`Event \`${function(e){try{let t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch(e){}}(e)}\` (type=${e.type}) captured as ${r}`:`Object captured as ${r} with keys: ${s}`}(t,{isUnhandledRejection:r})}]},extra:o};if(s){let t=og(e,s);t.length&&(l.exception.values[0].stacktrace={frames:t})}return l}(e,t,s,a),{synthetic:!0}):(ie(n=oy(e,t,s,r),`${t}`,void 0),it(n,{synthetic:!0})),n)}function oy(e,t,s,r){let a={};if(r&&s){let r=og(e,s);r.length&&(a.exception={values:[{value:t,stacktrace:{frames:r}}]}),it(a,{synthetic:!0})}if(nz(t)){let{__sentry_template_string__:e,__sentry_template_values__:s}=t;return a.logentry={message:e,params:s},a}return a.message=t,a}class ob extends i1{constructor(e){const t={parentSpanIsAlwaysRootSpan:!0,...e};!function(e,t,s=[t],r="npm"){let a=e._metadata||{};a.sdk||(a.sdk={name:`sentry.javascript.${t}`,packages:s.map(e=>({name:`${r}:@sentry/${e}`,version:nc})),version:nc}),e._metadata=a}(t,"browser",["browser"],nd.SENTRY_SDK_SOURCE||"npm"),super(t),t.sendClientReports&&nd.document&&nd.document.addEventListener("visibilitychange",()=>{"hidden"===nd.document.visibilityState&&this._flushOutcomes()})}eventFromException(e,t){var s,r;let a;return s=this._options.stackParser,r=this._options.attachStacktrace,it(a=ov(s,e,t&&t.syntheticException||void 0,r)),a.level="error",t&&t.event_id&&(a.event_id=t.event_id),ir(a)}eventFromMessage(e,t="info",s){return function(e,t,s="info",r,a){let n=oy(e,t,r&&r.syntheticException||void 0,a);return n.level=s,r&&r.event_id&&(n.event_id=r.event_id),ir(n)}(this._options.stackParser,e,t,s,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled())return void(oh&&nf.warn("SDK not enabled, will not capture user feedback."));let t=function(e,{metadata:t,tunnel:s,dsn:r}){return iR({event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&t.sdk&&{sdk:{name:t.sdk.name,version:t.sdk.version}},...!!s&&!!r&&{dsn:iO(r)}},[[{type:"user_report"},e]])}(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(t)}_prepareEvent(e,t,s){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,s)}}let oj="u"<typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function ow(){if(!nd.document)return;let e=nC.bind(null,"dom"),t=oN(e,!0);nd.document.addEventListener("click",t,!1),nd.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(t=>{let s=nd[t],r=s&&s.prototype;r&&r.hasOwnProperty&&r.hasOwnProperty("addEventListener")&&(nY(r,"addEventListener",function(t){return function(s,r,a){if("click"===s||"keypress"==s)try{let r=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},n=r[s]=r[s]||{refCount:0};if(!n.handler){let r=oN(e);n.handler=r,t.call(this,s,r,a)}n.refCount++}catch(e){}return t.call(this,s,r,a)}}),nY(r,"removeEventListener",function(e){return function(t,s,r){if("click"===t||"keypress"==t)try{let s=this.__sentry_instrumentation_handlers__||{},a=s[t];a&&(a.refCount--,a.refCount<=0&&(e.call(this,t,a.handler,r),a.handler=void 0,delete s[t]),0===Object.keys(s).length&&delete this.__sentry_instrumentation_handlers__)}catch(e){}return e.call(this,t,s,r)}}))})}function oN(e,t=!1){return s=>{var r;if(!s||s._sentryCaptured)return;let a=function(e){try{return e.target}catch(e){return null}}(s);if(r=s.type,"keypress"===r&&(!a||!a.tagName||"INPUT"!==a.tagName&&"TEXTAREA"!==a.tagName&&!a.isContentEditable))return;nX(s,"_sentryCaptured",!0),a&&!a._sentryId&&nX(a,"_sentryId",n8());let n="keypress"===s.type?"input":s.type;!function(e){if(e.type!==l)return!1;try{if(!e.target||e.target._sentryId!==c)return!1}catch(e){}return!0}(s)&&(e({event:s,name:n,global:t}),l=s.type,c=a?a._sentryId:void 0),clearTimeout(o),o=nd.setTimeout(()=>{c=void 0,l=void 0},1e3)}}function ok(e){let t="history";nS(t,e),n_(t,oS)}function oS(){let e,t,s;if(t=(e=nd.chrome)&&e.app&&e.app.runtime,s="history"in nd&&!!nd.history.pushState&&!!nd.history.replaceState,t||!s)return;let r=nd.onpopstate;function a(e){return function(...t){let s=t.length>2?t[2]:void 0;if(s){let e=d,t=String(s);d=t,nC("history",{from:e,to:t})}return e.apply(this,t)}}nd.onpopstate=function(...e){let t=nd.location.href,s=d;if(d=t,nC("history",{from:s,to:t}),r)try{return r.apply(this,e)}catch(e){}},nY(nd.history,"pushState",a),nY(nd.history,"replaceState",a)}let o_={},oC="__sentry_xhr_v3__";function oM(){if(!nd.XMLHttpRequest)return;let e=XMLHttpRequest.prototype;e.open=new Proxy(e.open,{apply(e,t,s){let r=Error(),a=1e3*n6(),n=nF(s[0])?s[0].toUpperCase():void 0,i=function(e){if(nF(e))return e;try{return e.toString()}catch(e){}}(s[1]);if(!n||!i)return e.apply(t,s);t[oC]={method:n,url:i,request_headers:{}},"POST"===n&&i.match(/sentry_key/)&&(t.__sentry_own_request__=!0);let o=()=>{let e=t[oC];if(e&&4===t.readyState){try{e.status_code=t.status}catch(e){}nC("xhr",{endTimestamp:1e3*n6(),startTimestamp:a,xhr:t,virtualError:r})}};return"onreadystatechange"in t&&"function"==typeof t.onreadystatechange?t.onreadystatechange=new Proxy(t.onreadystatechange,{apply:(e,t,s)=>(o(),e.apply(t,s))}):t.addEventListener("readystatechange",o),t.setRequestHeader=new Proxy(t.setRequestHeader,{apply(e,t,s){let[r,a]=s,n=t[oC];return n&&nF(r)&&nF(a)&&(n.request_headers[r.toLowerCase()]=a),e.apply(t,s)}}),e.apply(t,s)}}),e.send=new Proxy(e.send,{apply(e,t,s){let r=t[oC];return r&&(void 0!==s[0]&&(r.body=s[0]),nC("xhr",{startTimestamp:1e3*n6(),xhr:t})),e.apply(t,s)}})}function oT(e,t=function(e){let t=o_[e];if(t)return t;let s=nd[e];if(oo(s))return o_[e]=s.bind(nd);let r=nd.document;if(r&&"function"==typeof r.createElement)try{let t=r.createElement("iframe");t.hidden=!0,r.head.appendChild(t);let a=t.contentWindow;a&&a[e]&&(s=a[e]),r.head.removeChild(t)}catch(t){oj&&nf.warn(`Could not create sandbox iframe for ${e} check, bailing to window.${e}: `,t)}return s?o_[e]=s.bind(nd):s}("fetch")){let s=0,r=0;return function(e,t,s=function(e){let t=[];function s(e){return t.splice(t.indexOf(e),1)[0]||Promise.resolve(void 0)}return{$:t,add:function(r){if(!(void 0===e||t.length<e))return ia(new iZ("Not adding Promise because buffer limit was reached."));let a=r();return -1===t.indexOf(a)&&t.push(a),a.then(()=>s(a)).then(null,()=>s(a).then(null,()=>{})),a},drain:function(e){return new ii((s,r)=>{let a=t.length;if(!a)return s(!0);let n=setTimeout(()=>{e&&e>0&&s(!1)},e);t.forEach(e=>{ir(e).then(()=>{--a||(clearTimeout(n),s(!0))},r)})})}}}(e.bufferSize||64)){let r={};return{send:function(a){let n=[];if(iB(a,(t,s)=>{let a=iz[s];if(function(e,t,s=Date.now()){return(e[t]||e.all||0)>s}(r,a)){let r=i5(t,s);e.recordDroppedEvent("ratelimit_backoff",a,r)}else n.push(t)}),0===n.length)return ir({});let i=iR(a[0],n),o=t=>{iB(i,(s,r)=>{let a=i5(s,r);e.recordDroppedEvent(t,iz[r],a)})};return s.add(()=>t({body:function(e){let[t,s]=e,r=JSON.stringify(t);function a(e){"string"==typeof r?r="string"==typeof e?r+e:[iF(r),e]:r.push("string"==typeof e?iF(e):e)}for(let e of s){let[t,s]=e;if(a(`
${JSON.stringify(t)}
`),"string"==typeof s||s instanceof Uint8Array)a(s);else{let e;try{e=JSON.stringify(s)}catch(t){e=JSON.stringify(iD(s))}a(e)}}return"string"==typeof r?r:function(e){let t=new Uint8Array(e.reduce((e,t)=>e+t.length,0)),s=0;for(let r of e)t.set(r,s),s+=r.length;return t}(r)}(i)}).then(e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&nl&&nf.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),r=function(e,{statusCode:t,headers:s},r=Date.now()){let a={...e},n=s&&s["x-sentry-rate-limits"],i=s&&s["retry-after"];if(n)for(let e of n.trim().split(",")){let[t,s,,,n]=e.split(":",5),i=parseInt(t,10),o=1e3*(isNaN(i)?60:i);if(s)for(let e of s.split(";"))"metric_bucket"===e&&n&&!n.split(";").includes("custom")||(a[e]=r+o);else a.all=r+o}else i?a.all=r+function(e,t=Date.now()){let s=parseInt(`${e}`,10);if(!isNaN(s))return 1e3*s;let r=Date.parse(`${e}`);return isNaN(r)?6e4:r-t}(i,r):429===t&&(a.all=r+6e4);return a}(r,e),e),e=>{throw o("network_error"),e})).then(e=>e,e=>{if(e instanceof iZ)return nl&&nf.error("Skipped sending event because buffer is full."),o("queue_overflow"),ir({});throw e})},flush:e=>s.drain(e)}}(e,function(a){let n=a.body.length;s+=n,r++;let i={body:a.body,method:"POST",referrerPolicy:"origin",headers:e.headers,keepalive:s<=6e4&&r<15,...e.fetchOptions};if(!t)return o_.fetch=void 0,ia("No fetch implementation available");try{return t(e.url,i).then(e=>(s-=n,r--,{statusCode:e.status,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")}}))}catch(e){return o_.fetch=void 0,s-=n,r--,ia(e)}})}function oE(e,t,s,r){let a={filename:e,function:"<anonymous>"===t?"?":t,in_app:!0};return void 0!==s&&(a.lineno=s),void 0!==r&&(a.colno=r),a}let oA=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,oP=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,oI=/\((\S*)(?::(\d+))(?::(\d+))\)/,oO=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,oL=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,oD=function(...e){let t=e.sort((e,t)=>e[0]-t[0]).map(e=>e[1]);return(e,s=0,r=0)=>{let a=[],n=e.split("\n");for(let e=s;e<n.length;e++){let s=n[e];if(s.length>1024)continue;let i=nx.test(s)?s.replace(nx,"$1"):s;if(!i.match(/\S*Error: /)){for(let e of t){let t=e(i);if(t){a.push(t);break}}if(a.length>=50+r)break}}var i=a.slice(r);if(!i.length)return[];let o=Array.from(i);return/sentryWrapped/.test(ny(o).function||"")&&o.pop(),o.reverse(),nv.test(ny(o).function||"")&&(o.pop(),nv.test(ny(o).function||"")&&o.pop()),o.slice(0,50).map(e=>({...e,filename:e.filename||ny(o).filename,function:e.function||"?"}))}}([30,e=>{let t=oA.exec(e);if(t){let[,e,s,r]=t;return oE(e,"?",+s,+r)}let s=oP.exec(e);if(s){if(s[2]&&0===s[2].indexOf("eval")){let e=oI.exec(s[2]);e&&(s[2]=e[1],s[3]=e[2],s[4]=e[3])}let[e,t]=oR(s[1]||"?",s[2]);return oE(t,e,s[3]?+s[3]:void 0,s[4]?+s[4]:void 0)}}],[50,e=>{let t=oO.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){let e=oL.exec(t[3]);e&&(t[1]=t[1]||"eval",t[3]=e[1],t[4]=e[2],t[5]="")}let e=t[3],s=t[1]||"?";return[s,e]=oR(s,e),oE(e,s,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}]),oR=(e,t)=>{let s=-1!==e.indexOf("safari-extension"),r=-1!==e.indexOf("safari-web-extension");return s||r?[-1!==e.indexOf("@")?e.split("@")[0]:"?",s?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]},oB=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"];function oF(e){return function(...t){let s=t[0];return t[0]=ou(s,{mechanism:{data:{function:nj(e)},handled:!1,type:"instrument"}}),e.apply(this,t)}}function oz(e){return function(t){return e.apply(this,[ou(t,{mechanism:{data:{function:"requestAnimationFrame",handler:nj(e)},handled:!1,type:"instrument"}})])}}function o$(e){return function(...t){let s=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(e=>{e in s&&"function"==typeof s[e]&&nY(s,e,function(t){let s={mechanism:{data:{function:e,handler:nj(t)},handled:!1,type:"instrument"}},r=n0(t);return r&&(s.mechanism.data.handler=nj(r)),ou(t,s)})}),e.apply(this,t)}}function oV(e){let t=nd[e],s=t&&t.prototype;s&&s.hasOwnProperty&&s.hasOwnProperty("addEventListener")&&(nY(s,"addEventListener",function(t){return function(s,r,a){try{"function"==typeof r.handleEvent&&(r.handleEvent=ou(r.handleEvent,{mechanism:{data:{function:"handleEvent",handler:nj(r),target:e},handled:!1,type:"instrument"}}))}catch(e){}return t.apply(this,[s,ou(r,{mechanism:{data:{function:"addEventListener",handler:nj(r),target:e},handled:!1,type:"instrument"}}),a])}}),nY(s,"removeEventListener",function(e){return function(t,s,r){try{let a=s.__sentry_wrapped__;a&&e.call(this,t,a,r)}catch(e){}return e.call(this,t,s,r)}}))}function oU(e){oh&&nf.log(`Global Handler attached: ${e}`)}function oq(){let e=iN();return e&&e.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}var oH="loading",oJ="loaded",oG="joining-meeting",oW="joined-meeting",oQ="left-meeting",oK="error",oY="unknown",oX="no-room",oZ="loaded",o0="recording-started",o1="recording-stopped",o2="fullscreen",o4="exited-fullscreen",o5="input-settings-updated",o3="nonfatal-error",o6="error",o8="iframe-call-message",o7="local-screen-start",o9="daily-method-update-live-streaming-endpoints",le="transmit-log",lt="daily-custom-track",ls={NONE:"none",BGBLUR:"background-blur",BGIMAGE:"background-image",FACE_DETECTION:"face-detection"},lr={NONE:"none",NOISE_CANCELLATION:"noise-cancellation"},la={PLAY:"play",PAUSE:"pause"},ln=["jpg","png","jpeg"],li="sip-call-transfer";function lo(){return!ll()&&"u">typeof window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""}function ll(){return"u">typeof navigator&&navigator.product&&"ReactNative"===navigator.product}function lc(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia}function ld(){if(ll()||!document)return!1;var e=document.createElement("iframe");return!!e.requestFullscreen||!!e.webkitRequestFullscreen}var lu="none",lh=function(){try{var e,t=document.createElement("canvas"),s=!1;(e=t.getContext("webgl2",{failIfMajorPerformanceCaveat:!0}))||(s=!0,e=t.getContext("webgl2"));var r=null!=e;return t.remove(),r?s?"software":"hardware":lu}catch(e){return lu}}();function lm(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!ll()&&lh!==lu&&(e?!lx()&&["Chrome","Firefox"].includes(lv()):function(){if(lx())return!1;var e=lv();if("Safari"===e){var t=lN();if(t.major<15||15===t.major&&t.minor<4)return!1}return"Chrome"===e?lb().major>=77:"Firefox"===e?lk().major>=97:["Chrome","Firefox","Safari"].includes(e)}())}function lp(){if(ll()||lf()||"u"<typeof AudioWorkletNode)return!1;switch(lv()){case"Chrome":case"Firefox":return!0;case"Safari":var e=ly();return e.major>17||17===e.major&&e.minor>=4}return!1}function lg(){return lc()&&"u">typeof MediaStreamTrack&&!function(){var e,t=lv();if(!lo())return!0;switch(t){case"Chrome":return(e=lb()).major&&e.major>0&&e.major<75;case"Firefox":return(e=lk()).major<91;case"Safari":return(e=lN()).major<13||13===e.major&&e.minor<1;default:return!0}}()}function lf(){return lo().match(/Linux; Android/)}function lx(){var e,t=lo(),s=t.match(/Mac/)&&(!ll()&&"u">typeof window&&null!=(e=window)&&null!=(e=e.navigator)&&e.maxTouchPoints?window.navigator.maxTouchPoints:0)>=5;return!!(t.match(/Mobi/)||t.match(/Android/)||s)||!!lo().match(/DailyAnd\//)||void 0}function lv(){if("u">typeof window){var e=lo();return lj()?"Safari":e.indexOf("Edge")>-1?"Edge":e.match(/Chrome\//)?"Chrome":e.indexOf("Safari")>-1||lw()?"Safari":e.indexOf("Firefox")>-1?"Firefox":e.indexOf("MSIE")>-1||e.indexOf(".NET")>-1?"IE":"Unknown Browser"}}function ly(){switch(lv()){case"Chrome":return lb();case"Safari":return lN();case"Firefox":return lk();case"Edge":var e=0,t=0;if("u">typeof window){var s=lo().match(/Edge\/(\d+).(\d+)/);if(s)try{e=parseInt(s[1]),t=parseInt(s[2])}catch(e){}}return{major:e,minor:t}}}function lb(){var e=0,t=0,s=0,r=0,a=!1;if("u">typeof window){var n=lo(),i=n.match(/Chrome\/(\d+).(\d+).(\d+).(\d+)/);if(i)try{e=parseInt(i[1]),t=parseInt(i[2]),s=parseInt(i[3]),r=parseInt(i[4]),a=n.indexOf("OPR/")>-1}catch(e){}}return{major:e,minor:t,build:s,patch:r,opera:a}}function lj(){return!!lo().match(/iPad|iPhone|iPod/i)&&lc()}function lw(){return lo().indexOf("AppleWebKit/605.1.15")>-1}function lN(){var e=0,t=0,s=0;if("u">typeof window){var r=lo().match(/Version\/(\d+).(\d+)(.(\d+))?/);if(r)try{e=parseInt(r[1]),t=parseInt(r[2]),s=parseInt(r[4])}catch(e){}else(lj()||lw())&&(e=14,t=0,s=3)}return{major:e,minor:t,point:s}}function lk(){var e=0,t=0;if("u">typeof window){var s=lo().match(/Firefox\/(\d+).(\d+)/);if(s)try{e=parseInt(s[1]),t=parseInt(s[2])}catch(e){}}return{major:e,minor:t}}var lS=aR(function e(){aI(this,e)},[{key:"addListenerForMessagesFromCallMachine",value:function(e,t,s){na()}},{key:"addListenerForMessagesFromDailyJs",value:function(e,t,s){na()}},{key:"sendMessageToCallMachine",value:function(e,t,s,r){na()}},{key:"sendMessageToDailyJs",value:function(e,t){na()}},{key:"removeListener",value:function(e){na()}}]);function l_(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function lC(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l_(Object(s),!0).forEach(function(t){aV(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l_(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function lM(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(lM=function(){return!!e})()}var lT=function(){function e(){var t,s,r;return aI(this,e),s=aF(s=e),(t=aB(this,lM()?Reflect.construct(s,r||[],aF(this).constructor):s.apply(this,r)))._wrappedListeners={},t._messageCallbacks={},t}return a$(e,lS),aR(e,[{key:"addListenerForMessagesFromCallMachine",value:function(e,t,s){var r=this,a=function(a){if(a.data&&"iframe-call-message"===a.data.what&&(!a.data.callClientId||a.data.callClientId===t)&&(!a.data.from||"module"!==a.data.from)){var n=lC({},a.data);if(delete n.from,n.callbackStamp&&r._messageCallbacks[n.callbackStamp]){var i=n.callbackStamp;r._messageCallbacks[i].call(s,n),delete r._messageCallbacks[i]}delete n.what,delete n.callbackStamp,e.call(s,n)}};this._wrappedListeners[e]=a,window.addEventListener("message",a)}},{key:"addListenerForMessagesFromDailyJs",value:function(e,t,s){var r=function(r){var a;if(!(!r.data||r.data.what!==o8||!r.data.action||r.data.from&&"module"!==r.data.from||r.data.callClientId&&t&&r.data.callClientId!==t||null!=r&&null!=(a=r.data)&&a.callFrameId)){var n=r.data;e.call(s,n)}};this._wrappedListeners[e]=r,window.addEventListener("message",r)}},{key:"sendMessageToCallMachine",value:function(e,t,s,r){if(!s)throw Error("undefined callClientId. Are you trying to use a DailyCall instance previously destroyed?");var a=lC({},e);if(a.what=o8,a.from="module",a.callClientId=s,t){var n=nr();this._messageCallbacks[n]=t,a.callbackStamp=n}var i=r?r.contentWindow:window,o=this._callMachineTargetOrigin(r);o&&i.postMessage(a,o)}},{key:"sendMessageToDailyJs",value:function(e,t){e.what=o8,e.callClientId=t,e.from="embedded",window.postMessage(e,this._targetOriginFromWindowLocation())}},{key:"removeListener",value:function(e){var t=this._wrappedListeners[e];t&&(window.removeEventListener("message",t),delete this._wrappedListeners[e])}},{key:"forwardPackagedMessageToCallMachine",value:function(e,t,s){var r=lC({},e);r.callClientId=s;var a=t?t.contentWindow:window,n=this._callMachineTargetOrigin(t);n&&a.postMessage(r,n)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(e,t){var s=function(s){!s.data||"iframe-call-message"!==s.data.what||s.data.callClientId&&s.data.callClientId!==t||s.data.from&&"module"===s.data.from||e(s.data)};return this._wrappedListeners[e]=s,window.addEventListener("message",s),e}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(e){var t=this._wrappedListeners[e];t&&(window.removeEventListener("message",t),delete this._wrappedListeners[e])}},{key:"_callMachineTargetOrigin",value:function(e){return e?e.src?new URL(e.src).origin:void 0:this._targetOriginFromWindowLocation()}},{key:"_targetOriginFromWindowLocation",value:function(){return"file:"===window.location.protocol?"*":window.location.origin}}])}();function lE(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function lA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(lA=function(){return!!e})()}var lP=function(){function t(){var s,r,a;return aI(this,t),r=aF(r=t),s=aB(this,lA()?Reflect.construct(r,a||[],aF(this).constructor):r.apply(this,a)),e.g.callMachineToDailyJsEmitter=e.g.callMachineToDailyJsEmitter||new aQ.EventEmitter,e.g.dailyJsToCallMachineEmitter=e.g.dailyJsToCallMachineEmitter||new aQ.EventEmitter,s._wrappedListeners={},s._messageCallbacks={},s}return a$(t,lS),aR(t,[{key:"addListenerForMessagesFromCallMachine",value:function(t,s,r){this._addListener(t,e.g.callMachineToDailyJsEmitter,s,r,"received call machine message")}},{key:"addListenerForMessagesFromDailyJs",value:function(t,s,r){this._addListener(t,e.g.dailyJsToCallMachineEmitter,s,r,"received daily-js message")}},{key:"sendMessageToCallMachine",value:function(t,s,r){this._sendMessage(t,e.g.dailyJsToCallMachineEmitter,r,s,"sending message to call machine")}},{key:"sendMessageToDailyJs",value:function(t,s){this._sendMessage(t,e.g.callMachineToDailyJsEmitter,s,null,"sending message to daily-js")}},{key:"removeListener",value:function(t){var s=this._wrappedListeners[t];s&&(e.g.callMachineToDailyJsEmitter.removeListener("message",s),e.g.dailyJsToCallMachineEmitter.removeListener("message",s),delete this._wrappedListeners[t])}},{key:"_addListener",value:function(e,t,s,r,a){var n=this,i=function(t){if(t.callClientId===s){if(t.callbackStamp&&n._messageCallbacks[t.callbackStamp]){var a=t.callbackStamp;n._messageCallbacks[a].call(r,t),delete n._messageCallbacks[a]}e.call(r,t)}};this._wrappedListeners[e]=i,t.addListener("message",i)}},{key:"_sendMessage",value:function(e,t,s,r,a){var n=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?lE(Object(s),!0).forEach(function(t){aV(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):lE(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({},e);if(n.callClientId=s,r){var i=nr();this._messageCallbacks[i]=r,n.callbackStamp=i}t.emit("message",n)}}])}(),lI="replace",lO="shallow-merge",lL=[lI,lO],lD=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=t.data,r=t.mergeStrategy,a=void 0===r?lI:r;aI(this,e),e._validateMergeStrategy(a),e._validateData(s,a),this.mergeStrategy=a,this.data=s}return aR(e,[{key:"isNoOp",value:function(){return e.isNoOpUpdate(this.data,this.mergeStrategy)}}],[{key:"isNoOpUpdate",value:function(e,t){return 0===Object.keys(e).length&&t===lO}},{key:"_validateMergeStrategy",value:function(e){if(!lL.includes(e))throw Error("Unrecognized mergeStrategy provided. Options are: [".concat(lL,"]"))}},{key:"_validateData",value:function(e,t){if(!function(e){if(null==e||"object"!==aO(e))return!1;var t=Object.getPrototypeOf(e);return null==t||t===Object.prototype}(e))throw Error("Meeting session data must be a plain (map-like) object");try{if(s=JSON.stringify(e),t===lI){var s,r=JSON.parse(s);aZ(r,e)||console.warn("The meeting session data provided will be modified when serialized.",r,e)}else if(t===lO){for(var a in e)if(Object.hasOwnProperty.call(e,a)&&void 0!==e[a]){var n=JSON.parse(JSON.stringify(e[a]));aZ(e[a],n)||console.warn("At least one key in the meeting session data provided will be modified when serialized.",n,e[a])}}}catch(e){throw Error("Meeting session data must be serializable to JSON: ".concat(e))}if(s.length>102400)throw Error("Meeting session data is too large (".concat(s.length," characters). Maximum size suppported is ").concat(102400,"."))}}])}();function lR(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(lR=function(){return!!e})()}function lB(e){var t="function"==typeof Map?new Map:void 0;return(lB=function(e){if(null===e||!function(e){try{return -1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,s)}function s(){return function(e,t,s){if(lR())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var a=new(e.bind.apply(e,r));return s&&az(a,s.prototype),a}(e,arguments,aF(this).constructor)}return s.prototype=Object.create(e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),az(s,e)})(e)}function lF(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(lF=function(){return!!e})()}function lz(e){var t,s=null==(t=window._daily)?void 0:t.pendings;if(s){var r=s.indexOf(e);-1!==r&&s.splice(r,1)}}var l$=aR(function e(t){aI(this,e),this._currentLoad=null,this._callClientId=t},[{key:"load",value:function(){var e,t=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;this.loaded?(window._daily.instances[this._callClientId].callMachine.reset(),r(!0)):(e=this._callClientId,window._daily.pendings.push(e),this._currentLoad&&this._currentLoad.cancel(),this._currentLoad=new lV(s,function(){r(!1)},function(e,s){s||lz(t._callClientId),a(e,s)}),this._currentLoad.start())}},{key:"cancel",value:function(){this._currentLoad&&this._currentLoad.cancel(),lz(this._callClientId)}},{key:"loaded",get:function(){return this._currentLoad&&this._currentLoad.succeeded}}]),lV=aR(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;aI(this,e),this._attemptsRemaining=3,this._currentAttempt=null,this._dailyConfig=t,this._successCallback=s,this._failureCallback=r},[{key:"start",value:function(){var e=this;if(!this._currentAttempt){var t=function(s){e._currentAttempt.cancelled||(e._attemptsRemaining--,e._failureCallback(s,e._attemptsRemaining>0),e._attemptsRemaining<=0||setTimeout(function(){e._currentAttempt.cancelled||(e._currentAttempt=new lq(e._dailyConfig,e._successCallback,t),e._currentAttempt.start())},3e3))};this._currentAttempt=new lq(this._dailyConfig,this._successCallback,t),this._currentAttempt.start()}}},{key:"cancel",value:function(){this._currentAttempt&&this._currentAttempt.cancel()}},{key:"cancelled",get:function(){return this._currentAttempt&&this._currentAttempt.cancelled}},{key:"succeeded",get:function(){return this._currentAttempt&&this._currentAttempt.succeeded}}]),lU=function(){function e(){var t,s;return aI(this,e),s=arguments,t=aF(t=e),aB(this,lF()?Reflect.construct(t,s||[],aF(this).constructor):t.apply(this,s))}return a$(e,lB(Error)),aR(e)}(),lq=aR(function e(t,s,r){aI(this,e),this._loadAttemptImpl=ll()||!t.avoidEval?new lH(t,s,r):new lJ(t,s,r)},[{key:"start",value:(h=aq(function*(){return this._loadAttemptImpl.start()}),function(){return h.apply(this,arguments)})},{key:"cancel",value:function(){this._loadAttemptImpl.cancel()}},{key:"cancelled",get:function(){return this._loadAttemptImpl.cancelled}},{key:"succeeded",get:function(){return this._loadAttemptImpl.succeeded}}]),lH=aR(function e(t,s,r){aI(this,e),this.cancelled=!1,this.succeeded=!1,this._networkTimedOut=!1,this._networkTimeout=null,this._iosCache="u">typeof iOSCallObjectBundleCache&&iOSCallObjectBundleCache,this._refetchHeaders=null,this._dailyConfig=t,this._successCallback=s,this._failureCallback=r},[{key:"start",value:(f=aq(function*(){var e=ni(this._dailyConfig);(yield this._tryLoadFromIOSCache(e))||this._loadFromNetwork(e)}),function(){return f.apply(this,arguments)})},{key:"cancel",value:function(){clearTimeout(this._networkTimeout),this.cancelled=!0}},{key:"_tryLoadFromIOSCache",value:(g=aq(function*(e){if(!this._iosCache)return!1;try{var t=yield this._iosCache.get(e);return!!this.cancelled||!!t&&(t.code?(Function('"use strict";'+t.code)(),this.succeeded=!0,this._successCallback(),!0):(this._refetchHeaders=t.refetchHeaders,!1))}catch(e){return!1}}),function(e){return g.apply(this,arguments)})},{key:"_loadFromNetwork",value:(p=aq(function*(e){var t=this;this._networkTimeout=setTimeout(function(){t._networkTimedOut=!0,t._failureCallback({msg:"Timed out (>".concat(2e4," ms) when loading call object bundle ").concat(e),type:"timeout"})},2e4);try{var s=this._refetchHeaders?{headers:this._refetchHeaders}:{},r=yield fetch(e,s);if(clearTimeout(this._networkTimeout),this.cancelled||this._networkTimedOut)throw new lU;var a=yield this._getBundleCodeFromResponse(e,r);if(this.cancelled)throw new lU;Function('"use strict";'+a)(),this._iosCache&&this._iosCache.set(e,a,r.headers),this.succeeded=!0,this._successCallback()}catch(t){if(clearTimeout(this._networkTimeout),t instanceof lU||this.cancelled||this._networkTimedOut)return;this._failureCallback({msg:"Failed to load call object bundle ".concat(e,": ").concat(t),type:t.message})}}),function(e){return p.apply(this,arguments)})},{key:"_getBundleCodeFromResponse",value:(m=aq(function*(e,t){if(t.ok)return yield t.text();if(this._iosCache&&304===t.status)return(yield this._iosCache.renew(e,t.headers)).code;throw Error("Received ".concat(t.status," response"))}),function(e,t){return m.apply(this,arguments)})}]),lJ=aR(function e(t,s,r){aI(this,e),this.cancelled=!1,this.succeeded=!1,this._dailyConfig=t,this._successCallback=s,this._failureCallback=r,this._attemptId=nr(),this._networkTimeout=null,this._scriptElement=null},[{key:"start",value:function(){window._dailyCallMachineLoadWaitlist||(window._dailyCallMachineLoadWaitlist=new Set);var e=ni(this._dailyConfig);"object"===("u"<typeof document?"undefined":aO(document))?this._startLoading(e):this._failureCallback({msg:"Call object bundle must be loaded in a DOM/web context",type:"missing context"})}},{key:"cancel",value:function(){this._stopLoading(),this.cancelled=!0}},{key:"_startLoading",value:function(e){var t=this;this._signUpForCallMachineLoadWaitlist(),this._networkTimeout=setTimeout(function(){t._stopLoading(),t._failureCallback({msg:"Timed out (>".concat(2e4," ms) when loading call object bundle ").concat(e),type:"timeout"})},2e4);var s=document.getElementsByTagName("head")[0],r=document.createElement("script");this._scriptElement=r,r.onload=function(){t._stopLoading(),t.succeeded=!0,t._successCallback()},r.onerror=function(e){t._stopLoading(),t._failureCallback({msg:"Failed to load call object bundle ".concat(e.target.src),type:e.message})},r.src=e,s.appendChild(r)}},{key:"_stopLoading",value:function(){this._withdrawFromCallMachineLoadWaitlist(),clearTimeout(this._networkTimeout),this._scriptElement&&(this._scriptElement.onload=null,this._scriptElement.onerror=null)}},{key:"_signUpForCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.add(this._attemptId)}},{key:"_withdrawFromCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.delete(this._attemptId)}}]),lG=function(e,t,s){return!0===lQ(e.local,t,s)},lW=function(e,t,s,r){var a=lK(e,t,s,r);return a&&a.pendingTrack},lQ=function(e,t,s){if(!e)return!1;var r=function(e){switch(e){case"avatar":return!0;case"staged":return e;default:return!!e}},a=e.public.subscribedTracks;return a&&a[t]?r(-1===["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo"].indexOf(s)&&a[t].custom?[!0,"staged"].includes(a[t].custom)?a[t].custom:a[t].custom[s]:a[t][s]):!a||r(a.ALL)},lK=function(e,t,s,r){var a=Object.values(e.streams||{}).filter(function(e){return e.participantId===t&&e.type===s&&e.pendingTrack&&e.pendingTrack.kind===r}).sort(function(e,t){return new Date(t.starttime)-new Date(e.starttime)});return a&&a[0]},lY=function(e,t){var s=e.local.public.customTracks;if(s&&s[t])return s[t].track};function lX(e,t){for(var s=t.getState(),r=0,a=["cam","screen"];r<a.length;r++)for(var n=a[r],i=0,o=["video","audio"];i<o.length;i++){var l=o[i],c="cam"===n?l:"screen".concat(l.charAt(0).toUpperCase()+l.slice(1)),d=e.tracks[c];if(d){var u=e.local?s.local.streams&&s.local.streams[n]&&s.local.streams[n].stream&&s.local.streams[n].stream["get".concat("video"===l?"Video":"Audio","Tracks")]()[0]:lW(s,e.session_id,n,l);"playable"===d.state&&(d.track=u),d.persistentTrack=u}}}function lZ(e,t){try{var s,r=t.getState();for(var a in e.tracks){if(s=a,!["video","audio","screenVideo","screenAudio"].includes(s)){var n=e.tracks[a].kind;if(n){var i=e.tracks[a];if(i){var o=e.local?lY(r,a):lW(r,e.session_id,a,n);"playable"===i.state&&(e.tracks[a].track=o),i.persistentTrack=o}}else console.error("unknown type for custom track")}}}catch(e){console.error(e)}}function l0(e,t,s){var r=s.getState();if(e.local){if(e.audio)try{e.audioTrack=r.local.streams.cam.stream.getAudioTracks()[0],e.audioTrack||(e.audio=!1)}catch(e){}if(e.video)try{e.videoTrack=r.local.streams.cam.stream.getVideoTracks()[0],e.videoTrack||(e.video=!1)}catch(e){}if(e.screen)try{e.screenVideoTrack=r.local.streams.screen.stream.getVideoTracks()[0],e.screenAudioTrack=r.local.streams.screen.stream.getAudioTracks()[0],e.screenVideoTrack||e.screenAudioTrack||(e.screen=!1)}catch(e){}}else{var a=!0;try{var n=r.participants[e.session_id];n&&n.public&&n.public.rtcType&&"peer-to-peer"===n.public.rtcType.impl&&n.private&&!["connected","completed"].includes(n.private.peeringState)&&(a=!1)}catch(e){console.error(e)}if(!a)return e.audio=!1,e.audioTrack=!1,e.video=!1,e.videoTrack=!1,e.screen=!1,void(e.screenTrack=!1);try{if(r.streams,e.audio&&lG(r,e.session_id,"cam-audio")){var i=lW(r,e.session_id,"cam","audio");i&&(t&&t.audioTrack&&t.audioTrack.id===i.id?e.audioTrack=i:i.muted||(e.audioTrack=i)),e.audioTrack||(e.audio=!1)}if(e.video&&lG(r,e.session_id,"cam-video")){var o=lW(r,e.session_id,"cam","video");o&&(t&&t.videoTrack&&t.videoTrack.id===o.id?e.videoTrack=o:o.muted||(e.videoTrack=o)),e.videoTrack||(e.video=!1)}if(e.screen&&lG(r,e.session_id,"screen-audio")){var l=lW(r,e.session_id,"screen","audio");l&&(t&&t.screenAudioTrack&&t.screenAudioTrack.id===l.id?e.screenAudioTrack=l:l.muted||(e.screenAudioTrack=l))}if(e.screen&&lG(r,e.session_id,"screen-video")){var c=lW(r,e.session_id,"screen","video");c&&(t&&t.screenVideoTrack&&t.screenVideoTrack.id===c.id?e.screenVideoTrack=c:c.muted||(e.screenVideoTrack=c))}e.screenVideoTrack||e.screenAudioTrack||(e.screen=!1)}catch(e){console.error("unexpected error matching up tracks",e)}}}function l1(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}var l2=new Map,l4=null;function l5(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}var l3=new Map,l6=null;function l8(){var e;return ll()||void 0!==(null==(e=navigator.mediaDevices)?void 0:e.ondevicechange)}var l7=new Set;function l9(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function ce(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l9(Object(s),!0).forEach(function(t){aV(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l9(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var ct=Object.freeze({VIDEO:"video",AUDIO:"audio",SCREEN_VIDEO:"screenVideo",SCREEN_AUDIO:"screenAudio",CUSTOM_VIDEO:"customVideo",CUSTOM_AUDIO:"customAudio"}),cs=Object.freeze({PARTICIPANTS:"participants",STREAMING:"streaming",TRANSCRIPTION:"transcription"}),cr=Object.values(ct),ca=["v","a","sv","sa","cv","ca"];Object.freeze(cr.reduce(function(e,t,s){return e[t]=ca[s],e},{})),Object.freeze(ca.reduce(function(e,t,s){return e[t]=cr[s],e},{}));var cn=[ct.VIDEO,ct.AUDIO,ct.SCREEN_VIDEO,ct.SCREEN_AUDIO],ci=Object.values(cs),co=["p","s","t"];Object.freeze(ci.reduce(function(e,t,s){return e[t]=co[s],e},{})),Object.freeze(co.reduce(function(e,t,s){return e[t]=ci[s],e},{}));var cl=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=t.base,r=t.byUserId,a=t.byParticipantId;aI(this,e),this.base=s,this.byUserId=r,this.byParticipantId=a}return aR(e,[{key:"clone",value:function(){var t=new e;if(this.base instanceof cc?t.base=this.base.clone():t.base=this.base,void 0!==this.byUserId)for(var s in t.byUserId={},this.byUserId){var r=this.byUserId[s];t.byUserId[s]=r instanceof cc?r.clone():r}if(void 0!==this.byParticipantId)for(var a in t.byParticipantId={},this.byParticipantId){var n=this.byParticipantId[a];t.byParticipantId[a]=n instanceof cc?n.clone():n}return t}},{key:"toJSONObject",value:function(){var e={};if("boolean"==typeof this.base?e.base=this.base:this.base instanceof cc&&(e.base=this.base.toJSONObject()),void 0!==this.byUserId)for(var t in e.byUserId={},this.byUserId){var s=this.byUserId[t];e.byUserId[t]=s instanceof cc?s.toJSONObject():s}if(void 0!==this.byParticipantId)for(var r in e.byParticipantId={},this.byParticipantId){var a=this.byParticipantId[r];e.byParticipantId[r]=a instanceof cc?a.toJSONObject():a}return e}},{key:"toMinifiedJSONObject",value:function(){var e={};if(void 0!==this.base&&("boolean"==typeof this.base?e.b=this.base:e.b=this.base.toMinifiedJSONObject()),void 0!==this.byUserId)for(var t in e.u={},this.byUserId){var s=this.byUserId[t];e.u[t]="boolean"==typeof s?s:s.toMinifiedJSONObject()}if(void 0!==this.byParticipantId)for(var r in e.p={},this.byParticipantId){var a=this.byParticipantId[r];e.p[r]="boolean"==typeof a?a:a.toMinifiedJSONObject()}return e}},{key:"normalize",value:function(){return this.base instanceof cc&&(this.base=this.base.normalize()),this.byUserId&&(this.byUserId=Object.fromEntries(Object.entries(this.byUserId).map(function(e){var t=aJ(e,2),s=t[0],r=t[1];return[s,r instanceof cc?r.normalize():r]}))),this.byParticipantId&&(this.byParticipantId=Object.fromEntries(Object.entries(this.byParticipantId).map(function(e){var t=aJ(e,2),s=t[0],r=t[1];return[s,r instanceof cc?r.normalize():r]}))),this}}],[{key:"fromJSONObject",value:function(t){var s,r,a;if(void 0!==t.base&&(s="boolean"==typeof t.base?t.base:cc.fromJSONObject(t.base)),void 0!==t.byUserId)for(var n in r={},t.byUserId){var i=t.byUserId[n];r[n]="boolean"==typeof i?i:cc.fromJSONObject(i)}if(void 0!==t.byParticipantId)for(var o in a={},t.byParticipantId){var l=t.byParticipantId[o];a[o]="boolean"==typeof l?l:cc.fromJSONObject(l)}return new e({base:s,byUserId:r,byParticipantId:a})}},{key:"fromMinifiedJSONObject",value:function(t){var s,r,a;if(void 0!==t.b&&(s="boolean"==typeof t.b?t.b:cc.fromMinifiedJSONObject(t.b)),void 0!==t.u)for(var n in r={},t.u){var i=t.u[n];r[n]="boolean"==typeof i?i:cc.fromMinifiedJSONObject(i)}if(void 0!==t.p)for(var o in a={},t.p){var l=t.p[o];a[o]="boolean"==typeof l?l:cc.fromMinifiedJSONObject(l)}return new e({base:s,byUserId:r,byParticipantId:a})}},{key:"validateJSONObject",value:function(e){if("object"!==aO(e))return[!1,"canReceive must be an object"];for(var t=["base","byUserId","byParticipantId"],s=0,r=Object.keys(e);s<r.length;s++){var a=r[s];if(!t.includes(a))return[!1,"canReceive can only contain keys (".concat(t.join(", "),")")];if("base"===a){var n=aJ(cc.validateJSONObject(e.base,!0),2),i=n[0],o=n[1];if(!i)return[!1,o]}else{if("object"!==aO(e[a]))return[!1,"invalid (non-object) value for field '".concat(a,"' in canReceive")];for(var l=0,c=Object.values(e[a]);l<c.length;l++){var d=c[l],u=aJ(cc.validateJSONObject(d),2),h=u[0],m=u[1];if(!h)return[!1,m]}}}return[!0]}}])}(),cc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=t.video,r=t.audio,a=t.screenVideo,n=t.screenAudio,i=t.customVideo,o=t.customAudio;aI(this,e),this.video=s,this.audio=r,this.screenVideo=a,this.screenAudio=n,this.customVideo=i,this.customAudio=o}return aR(e,[{key:"clone",value:function(){var t=new e;return void 0!==this.video&&(t.video=this.video),void 0!==this.audio&&(t.audio=this.audio),void 0!==this.screenVideo&&(t.screenVideo=this.screenVideo),void 0!==this.screenAudio&&(t.screenAudio=this.screenAudio),void 0!==this.customVideo&&(t.customVideo=ce({},this.customVideo)),void 0!==this.customAudio&&(t.customAudio=ce({},this.customAudio)),t}},{key:"toJSONObject",value:function(){var e={};return void 0!==this.video&&(e.video=this.video),void 0!==this.audio&&(e.audio=this.audio),void 0!==this.screenVideo&&(e.screenVideo=this.screenVideo),void 0!==this.screenAudio&&(e.screenAudio=this.screenAudio),void 0!==this.customVideo&&(e.customVideo=ce({},this.customVideo)),void 0!==this.customAudio&&(e.customAudio=ce({},this.customAudio)),e}},{key:"toMinifiedJSONObject",value:function(){var e={};return void 0!==this.video&&(e.v=this.video),void 0!==this.audio&&(e.a=this.audio),void 0!==this.screenVideo&&(e.sv=this.screenVideo),void 0!==this.screenAudio&&(e.sa=this.screenAudio),void 0!==this.customVideo&&(e.cv=ce({},this.customVideo)),void 0!==this.customAudio&&(e.ca=ce({},this.customAudio)),e}},{key:"normalize",value:function(){function e(e,t){return e&&1===Object.keys(e).length&&e["*"]===t}return!(!0!==this.video||!0!==this.audio||!0!==this.screenVideo||!0!==this.screenAudio||!e(this.customVideo,!0)||!e(this.customAudio,!0))||(!1!==this.video||!1!==this.audio||!1!==this.screenVideo||!1!==this.screenAudio||!e(this.customVideo,!1)||!e(this.customAudio,!1))&&this}}],[{key:"fromBoolean",value:function(t){return new e({video:t,audio:t,screenVideo:t,screenAudio:t,customVideo:{"*":t},customAudio:{"*":t}})}},{key:"fromJSONObject",value:function(t){return new e({video:t.video,audio:t.audio,screenVideo:t.screenVideo,screenAudio:t.screenAudio,customVideo:void 0!==t.customVideo?ce({},t.customVideo):void 0,customAudio:void 0!==t.customAudio?ce({},t.customAudio):void 0})}},{key:"fromMinifiedJSONObject",value:function(t){return new e({video:t.v,audio:t.a,screenVideo:t.sv,screenAudio:t.sa,customVideo:t.cv,customAudio:t.ca})}},{key:"validateJSONObject",value:function(e,t){if("boolean"==typeof e)return[!0];if("object"!==aO(e))return[!1,"invalid (non-object, non-boolean) value in canReceive"];for(var s=Object.keys(e),r=0;r<s.length;r++){var a=s[r];if(!cr.includes(a))return[!1,"invalid media type '".concat(a,"' in canReceive")];if(cn.includes(a)){if("boolean"!=typeof e[a])return[!1,"invalid (non-boolean) value for media type '".concat(a,"' in canReceive")]}else{if("object"!==aO(e[a]))return[!1,"invalid (non-object) value for media type '".concat(a,"' in canReceive")];for(var n=0,i=Object.values(e[a]);n<i.length;n++)if("boolean"!=typeof i[n])return[!1,"invalid (non-boolean) value for entry within '".concat(a,"' in canReceive")];if(t&&void 0===e[a]["*"])return[!1,'canReceive "base" permission must specify "*" as an entry within \''.concat(a,"'")]}}return t&&s.length!==cr.length?[!1,'canReceive "base" permission must specify all media types: '.concat(cr.join(", ")," (or be set to a boolean shorthand)")]:[!0]}}])}(),cd=["result"],cu=["preserveIframe"];function ch(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function cm(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ch(Object(s),!0).forEach(function(t){aV(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ch(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function cp(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(cp=function(){return!!e})()}function cg(e,t){var s="u">typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!s){if(Array.isArray(e)||(s=function(e,t){if(e){if("string"==typeof e)return cf(e,void 0);var s=({}).toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?cf(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){s&&(e=s);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,o=!1;return{s:function(){s=s.call(e)},n:function(){var e=s.next();return i=e.done,e},e:function(e){o=!0,n=e},f:function(){try{i||null==s.return||s.return()}finally{if(o)throw n}}}}function cf(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}var cx={},cv="video",cy=ll()?{data:{}}:{data:{},topology:"none"},cb={present:0,hidden:0},cj={maxBitrate:{min:1e5,max:25e5},maxFramerate:{min:1,max:30},scaleResolutionDownBy:{min:1,max:8}},cw=Object.keys(cj),cN=["state","volume","simulcastEncodings"],ck={androidInCallNotification:{title:"string",subtitle:"string",iconName:"string",disableForCustomOverride:"boolean"},disableAutoDeviceManagement:{audio:"boolean",video:"boolean"}},cS={id:{iconPath:"string",iconPathDarkMode:"string",label:"string",tooltip:"string",visualState:"'default' | 'sidebar-open' | 'active'"}},c_={id:{allow:"string",controlledBy:"'*' | 'owners' | string[]",csp:"string",iconURL:"string",label:"string",loading:"'eager' | 'lazy'",location:"'main' | 'sidebar'",name:"string",referrerPolicy:"string",sandbox:"string",src:"string",srcdoc:"string",shared:"string[] | 'owners' | boolean"}},cC={customIntegrations:{validate:cQ,help:cG()},customTrayButtons:{validate:cW,help:"customTrayButtons should be a dictionary of the type ".concat(JSON.stringify(cS))},url:{validate:function(e){return"string"==typeof e},help:"url should be a string"},baseUrl:{validate:function(e){return"string"==typeof e},help:"baseUrl should be a string"},token:{validate:function(e){return"string"==typeof e},help:"token should be a string",queryString:"t"},dailyConfig:{validate:function(e,t){try{return t.validateDailyConfig(e),!0}catch(e){console.error("Failed to validate dailyConfig",e)}return!1},help:"Unsupported dailyConfig. Check error logs for detailed info."},reactNativeConfig:{validate:function(e){return function e(t,s){if(void 0===s)return!1;switch(aO(s)){case"string":return aO(t)===s;case"object":if("object"!==aO(t))return!1;for(var r in t)if(!e(t[r],s[r]))return!1;return!0;default:return!1}}(e,ck)},help:"reactNativeConfig should look like ".concat(JSON.stringify(ck),", all fields optional")},lang:{validate:function(e){return["da","de","en-us","en","es","fi","fr","it","jp","ka","nl","no","pl","pt","pt-BR","ru","sv","tr","user"].includes(e)},help:"language not supported. Options are: da, de, en-us, en, es, fi, fr, it, jp, ka, nl, no, pl, pt, pt-BR, ru, sv, tr, user"},userName:!0,userData:{validate:function(e){try{return cz(e),!0}catch(e){return console.error(e),!1}},help:"invalid userData type provided"},startVideoOff:!0,startAudioOff:!0,allowLocalVideo:!0,allowLocalAudio:!0,activeSpeakerMode:!0,showLeaveButton:!0,showLocalVideo:!0,showParticipantsBar:!0,showFullscreenButton:!0,showUserNameChangeUI:!0,iframeStyle:!0,customLayout:!0,cssFile:!0,cssText:!0,bodyClass:!0,videoSource:{validate:function(e,t){var s;if("boolean"==typeof e)return t._preloadCache.allowLocalVideo=e,!0;if(e instanceof MediaStreamTrack)t._sharedTracks.videoTrack=e,s={customTrack:lt};else{if(delete t._sharedTracks.videoTrack,"string"!=typeof e)return console.error("videoSource must be a MediaStreamTrack, boolean, or a string"),!1;s={deviceId:e}}return t._updatePreloadCacheInputSettings({video:{settings:s}},!1),!0}},audioSource:{validate:function(e,t){var s;if("boolean"==typeof e)return t._preloadCache.allowLocalAudio=e,!0;if(e instanceof MediaStreamTrack)t._sharedTracks.audioTrack=e,s={customTrack:lt};else{if(delete t._sharedTracks.audioTrack,"string"!=typeof e)return console.error("audioSource must be a MediaStreamTrack, boolean, or a string"),!1;s={deviceId:e}}return t._updatePreloadCacheInputSettings({audio:{settings:s}},!1),!0}},subscribeToTracksAutomatically:{validate:function(e,t){return t._preloadCache.subscribeToTracksAutomatically=e,!0}},theme:{validate:function(e){var t=["accent","accentText","background","backgroundAccent","baseText","border","mainAreaBg","mainAreaBgAccent","mainAreaText","supportiveText"],s=function(e){for(var s=0,r=Object.keys(e);s<r.length;s++){var a=r[s];if(!t.includes(a))return console.error('unsupported color "'.concat(a,'". Valid colors: ').concat(t.join(", "))),!1;if(!e[a].match(/^#[0-9a-f]{6}|#[0-9a-f]{3}$/i))return console.error("".concat(a,' theme color should be provided in valid hex color format. Received: "').concat(e[a],'"')),!1}return!0};return"object"===aO(e)&&("light"in e&&"dark"in e||"colors"in e)?"light"in e&&"dark"in e?"colors"in e.light?"colors"in e.dark?s(e.light.colors)&&s(e.dark.colors):(console.error('Dark theme is missing "colors" property.',e),!1):(console.error('Light theme is missing "colors" property.',e),!1):s(e.colors):(console.error('Theme must contain either both "light" and "dark" properties, or "colors".',e),!1)},help:"unsupported theme configuration. Check error logs for detailed info."},layoutConfig:{validate:function(e){if("grid"in e){var t=e.grid;if("maxTilesPerPage"in t){if(!Number.isInteger(t.maxTilesPerPage))return console.error("grid.maxTilesPerPage should be an integer. You passed ".concat(t.maxTilesPerPage,".")),!1;if(t.maxTilesPerPage>49)return console.error("grid.maxTilesPerPage can't be larger than 49 without sacrificing browser performance. Please contact us at https://www.daily.co/contact to talk about your use case."),!1}if("minTilesPerPage"in t){if(!Number.isInteger(t.minTilesPerPage))return console.error("grid.minTilesPerPage should be an integer. You passed ".concat(t.minTilesPerPage,".")),!1;if(t.minTilesPerPage<1)return console.error("grid.minTilesPerPage can't be lower than 1."),!1;if("maxTilesPerPage"in t&&t.minTilesPerPage>t.maxTilesPerPage)return console.error("grid.minTilesPerPage can't be higher than grid.maxTilesPerPage."),!1}}return!0},help:"unsupported layoutConfig. Check error logs for detailed info."},receiveSettings:{validate:function(e){return c$(e,{allowAllParticipantsKey:!1})},help:cJ({allowAllParticipantsKey:!1})},sendSettings:{validate:function(e,t){return!!function(e,t){try{return t.validateUpdateSendSettings(e),!0}catch(e){return console.error("Failed to validate send settings",e),!1}}(e,t)&&(t._preloadCache.sendSettings=e,!0)},help:"Invalid sendSettings provided. Check error logs for detailed info."},inputSettings:{validate:function(e,t){var s;return!!cV(e)&&(t._inputSettings||(t._inputSettings={}),cU(e,null==(s=t.properties)?void 0:s.dailyConfig,t._sharedTracks),t._updatePreloadCacheInputSettings(e,!0),!0)},help:cH()},layout:{validate:function(e){return"custom-v1"===e||"browser"===e||"none"===e},help:'layout may only be set to "custom-v1"',queryString:"layout"},emb:{queryString:"emb"},embHref:{queryString:"embHref"},dailyJsVersion:{queryString:"dailyJsVersion"},proxy:{queryString:"proxy"},strictMode:!0,allowMultipleCallInstances:!0},cM={styles:{validate:function(e){for(var t in e)if("cam"!==t&&"screen"!==t)return!1;if(e.cam){for(var s in e.cam)if("div"!==s&&"video"!==s)return!1}if(e.screen){for(var r in e.screen)if("div"!==r&&"video"!==r)return!1}return!0},help:"styles format should be a subset of: { cam: {div: {}, video: {}}, screen: {div: {}, video: {}} }"},setSubscribedTracks:{validate:function(e,t){if(t._preloadCache.subscribeToTracksAutomatically)return!1;var s=[!0,!1,"staged"];if(s.includes(e)||!ll()&&"avatar"===e)return!0;var r=["audio","video","screenAudio","screenVideo","rmpAudio","rmpVideo"],a=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var n in e)if("custom"===n){if(!s.includes(e[n])&&!a(e[n],!0))return!1}else{var i=!t&&!r.includes(n),o=!s.includes(e[n]);if(i||o)return!1}return!0};return a(e)},help:"setSubscribedTracks cannot be used when setSubscribeToTracksAutomatically is enabled, and should be of the form: "+"true".concat(ll()?"":" | 'avatar'"," | false | 'staged' | { [audio: true|false|'staged'], [video: true|false|'staged'], [screenAudio: true|false|'staged'], [screenVideo: true|false|'staged'] }")},setAudio:!0,setVideo:!0,setScreenShare:{validate:function(e){return!1===e},help:"setScreenShare must be false, as it's only meant for stopping remote participants' screen shares"},eject:!0,updatePermissions:{validate:function(e){for(var t=0,s=Object.entries(e);t<s.length;t++){var r=aJ(s[t],2),a=r[0],n=r[1];switch(a){case"hasPresence":if("boolean"!=typeof n)return!1;break;case"canSend":if(n instanceof Set||n instanceof Array||Array.isArray(n)){var i,o=["video","audio","screenVideo","screenAudio","customVideo","customAudio"],l=cg(n);try{for(l.s();!(i=l.n()).done;){var c=i.value;if(!o.includes(c))return!1}}catch(e){l.e(e)}finally{l.f()}}else if("boolean"!=typeof n)return!1;(n instanceof Array||Array.isArray(n))&&(e.canSend=new Set(n));break;case"canReceive":var d=aJ(cl.validateJSONObject(n),2),u=d[0],h=d[1];if(!u)return console.error(h),!1;break;case"canAdmin":if(n instanceof Set||n instanceof Array||Array.isArray(n)){var m,p=["participants","streaming","transcription"],g=cg(n);try{for(g.s();!(m=g.n()).done;){var f=m.value;if(!p.includes(f))return!1}}catch(e){g.e(e)}finally{g.f()}}else if("boolean"!=typeof n)return!1;(n instanceof Array||Array.isArray(n))&&(e.canAdmin=new Set(n));break;default:return!1}}return!0},help:"updatePermissions can take hasPresence, canSend, canReceive, and canAdmin permissions. hasPresence must be a boolean. canSend can be a boolean or an Array or Set of media types (video, audio, screenVideo, screenAudio, customVideo, customAudio). canReceive must be an object specifying base, byUserId, and/or byParticipantId fields (see documentation for more details). canAdmin can be a boolean or an Array or Set of admin types (participants, streaming, transcription)."}};function cT(e){if(e.extension){if("string"!=typeof e.extension)throw Error("Error starting dial out: extension must be a string");if(e.extension.length>20)throw Error("Error starting dial out: extension length must be less than or equal to 20")}if(e.waitBeforeExtensionDialSec){if("number"!=typeof e.waitBeforeExtensionDialSec)throw Error("Error starting dial out: waitBeforeExtensionDialSec must be a number");if(e.waitBeforeExtensionDialSec>60)throw Error("Error starting dial out: waitBeforeExtensionDialSec must be less than or equal to 60");if(!e.extension)throw Error("Error starting dial out: waitBeforeExtensionDialSec requires a phoneNumber and extension")}}function cE(e,t){var s={};for(var r in e)if(e[r]instanceof MediaStreamTrack)console.warn("MediaStreamTrack found in props or cache.",r),s[r]=lt;else if("dailyConfig"===r){if(e[r].modifyLocalSdpHook){var a=window._daily.instances[t].customCallbacks||{};a.modifyLocalSdpHook=e[r].modifyLocalSdpHook,window._daily.instances[t].customCallbacks=a,delete e[r].modifyLocalSdpHook}if(e[r].modifyRemoteSdpHook){var n=window._daily.instances[t].customCallbacks||{};n.modifyRemoteSdpHook=e[r].modifyRemoteSdpHook,window._daily.instances[t].customCallbacks=n,delete e[r].modifyRemoteSdpHook}s[r]=e[r]}else s[r]=e[r];return s}function cA(e){var t=arguments.length>2?arguments[2]:void 0;if(e!==oW){var s="".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"This daily-js method"," only supported after join.");throw t&&(s+=" ".concat(t)),console.error(s),Error(s)}}function cP(e,t){return[oG,oW].includes(e)||t}function cI(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"This daily-js method",r=arguments.length>3?arguments[3]:void 0;if(cP(e,t)){var a="".concat(s," not supported after joining a meeting.");throw r&&(a+=" ".concat(r)),console.error(a),Error(a)}}function cO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"This daily-js method",s=arguments.length>2?arguments[2]:void 0;if(!e){var r="".concat(t,arguments.length>3&&void 0!==arguments[3]&&arguments[3]?" requires preAuth() or startCamera() to initialize call state.":" requires preAuth(), startCamera(), or join() to initialize call state.");throw s&&(r+=" ".concat(s)),console.error(r),Error(r)}}function cL(e){if(e){var t="A pre-call quality test is in progress. Please try ".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"This daily-js method"," again once testing has completed. Use stopTestCallQuality() to end it early.");throw console.error(t),Error(t)}}function cD(e){if(!e){var t="".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"This daily-js method"," is only supported on custom callObject instances");throw console.error(t),Error(t)}}function cR(e){if(e){var t="".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"This daily-js method"," is only supported as part of Daily's Prebuilt");throw console.error(t),Error(t)}}function cB(){if(ll())throw Error("This daily-js method is not currently supported in React Native")}function cF(){if(!ll())throw Error("This daily-js method is only supported in React Native")}function cz(e){var t;if(void 0===e)return!0;if("string"==typeof e)t=e;else try{t=JSON.stringify(e),aZ(JSON.parse(t),e)||console.warn("The userData provided will be modified when serialized.")}catch(e){throw Error("userData must be serializable to JSON: ".concat(e))}if(t.length>4096)throw Error("userData is too large (".concat(t.length," characters). Maximum size suppported is ").concat(4096,"."));return!0}function c$(e,t){for(var s=t.allowAllParticipantsKey,r=function(e){return!!(void 0===e.layer||Number.isInteger(e.layer)&&e.layer>=0||"inherit"===e.layer)},a=0,n=Object.entries(e);a<n.length;a++){var i=aJ(n[a],2),o=i[0],l=i[1];if(!function(e){var t=["local"];return s||t.push("*"),e&&!t.includes(e)}(o)||!(l&&!(l.video&&!r(l.video))&&!(l.screenVideo&&!r(l.screenVideo))))return!1}return!0}function cV(e){if("object"!==aO(e))return!1;for(var t=0,s=Object.entries(e);t<s.length;t++){var r=aJ(s[t],2),a=r[0],n=r[1];switch(a){case"video":if("object"!==aO(n))return!1;for(var i=0,o=Object.entries(n);i<o.length;i++){var l=aJ(o[i],2),c=l[0],d=l[1];switch(c){case"processor":if(!function(e){if(ll())return console.warn("Video processing is not yet supported in React Native"),!1;var t,s=["type","config"];return!!e&&"object"===aO(e)&&!!("string"==typeof(t=e.type)&&(Object.values(ls).includes(t)||(console.error("inputSettings video processor type invalid"),0)))&&(!e.config||"object"===aO(e.config)&&!!function(e,t){var s,r=Object.keys(t);if(0===r.length)return!0;var a="invalid object in inputSettings -> video -> processor -> config";switch(e){case ls.BGBLUR:return r.length>1||"strength"!==r[0]?(console.error(a),!1):!("number"!=typeof t.strength||t.strength<=0||t.strength>1||isNaN(t.strength))||(console.error("".concat(a,"; expected: {0 < strength <= 1}, got: ").concat(t.strength)),!1);case ls.BGIMAGE:return!(void 0!==t.source&&!("default"===t.source?(t.type="default",!0):t.source instanceof ArrayBuffer||(no(t.source)?(t.type="url",!!function(e){var t=new URL(e),s=t.pathname;if("data:"===t.protocol)try{var r=s.substring(s.indexOf(":")+1,s.indexOf(";")).split("/")[1];return ln.includes(r)}catch(e){return console.error("failed to deduce blob content type",e),!1}var a=s.split(".").at(-1).toLowerCase().trim();return ln.includes(a)}(t.source)||(console.error("invalid image type; supported types: [".concat(ln.join(", "),"]")),!1)):isNaN(s=Number(t.source))||!Number.isInteger(s)||s<=0||s>10?(console.error("invalid image selection; must be an int, > 0, <= ".concat(10)),!1):(t.type="daily-preselect",!0))));default:return!0}}(e.type,e.config))&&(Object.keys(e).filter(function(e){return!s.includes(e)}).forEach(function(t){console.warn("invalid key inputSettings -> video -> processor : ".concat(t)),delete e[t]}),!0)}(d))return!1;break;case"settings":if(!cq(d))return!1;break;default:return!1}}break;case"audio":if("object"!==aO(n))return!1;for(var u=0,h=Object.entries(n);u<h.length;u++){var m=aJ(h[u],2),p=m[0],g=m[1];switch(p){case"processor":if(!function(e){if(ll())return console.warn("Video processing is not yet supported in React Native"),!1;var t,s=["type"];return!!e&&"object"===aO(e)&&(Object.keys(e).filter(function(e){return!s.includes(e)}).forEach(function(t){console.warn("invalid key inputSettings -> audio -> processor : ".concat(t)),delete e[t]}),!!("string"==typeof(t=e.type)&&(Object.values(lr).includes(t)||(console.error("inputSettings audio processor type invalid"),0))))}(g))return!1;break;case"settings":if(!cq(g))return!1;break;default:return!1}}break;default:return!1}}return!0}function cU(e,t,s){var r,a=[];e.video&&e.video.processor&&(lm(null!=(r=null==t?void 0:t.useLegacyVideoProcessor)&&r)||(e.video.settings?delete e.video.processor:delete e.video,a.push("video"))),e.audio&&e.audio.processor&&(lp()||(e.audio.settings?delete e.audio.processor:delete e.audio,a.push("audio"))),a.length>0&&console.error("Ignoring settings for browser- or platform-unsupported input processor(s): ".concat(a.join(", "))),e.audio&&e.audio.settings&&(e.audio.settings.customTrack?(s.audioTrack=e.audio.settings.customTrack,e.audio.settings={customTrack:lt}):delete s.audioTrack),e.video&&e.video.settings&&(e.video.settings.customTrack?(s.videoTrack=e.video.settings.customTrack,e.video.settings={customTrack:lt}):delete s.videoTrack)}function cq(e){return"object"===aO(e)&&(!e.customTrack||e.customTrack instanceof MediaStreamTrack)}function cH(){var e=Object.values(ls).join(" | "),t=Object.values(lr).join(" | ");return"inputSettings must be of the form: { video?: { processor?: { type: [ ".concat(e," ], config?: {} } }, audio?: { processor: {type: [ ").concat(t," ] } } }")}function cJ(e){var t=e.allowAllParticipantsKey;return"receiveSettings must be of the form { [<remote participant id> | ".concat("base").concat(t?' | "'.concat("*",'"'):"","]: ")+'{ [video: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]], [screenVideo: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]] }}}'}function cG(){return"customIntegrations should be an object of type ".concat(JSON.stringify(c_),".")}function cW(e){if(e&&"object"!==aO(e)||Array.isArray(e))return console.error("customTrayButtons should be an Object of the type ".concat(JSON.stringify(cS),".")),!1;if(e)for(var t=0,s=Object.entries(e);t<s.length;t++)for(var r=aJ(s[t],1)[0],a=0,n=Object.entries(e[r]);a<n.length;a++){var i=aJ(n[a],2),o=i[0],l=i[1],c=cS.id[o];if(!c)return console.error("customTrayButton does not support key ".concat(o)),!1;switch(o){case"iconPath":case"iconPathDarkMode":if(!no(l))return console.error("customTrayButton ".concat(o," should be a url.")),!1;break;case"visualState":if(!["default","sidebar-open","active"].includes(l))return console.error("customTrayButton ".concat(o," should be ").concat(c,". Got: ").concat(l)),!1;break;default:if(aO(l)!==c)return console.error("customTrayButton ".concat(o," should be a ").concat(c,".")),!1}}return!0}function cQ(e){if(!e||e&&"object"!==aO(e)||Array.isArray(e))return console.error(cG()),!1;for(var t=function(e){return"".concat(e," should be ").concat(c_.id[e])},s=function(e,t){return console.error("customIntegration ".concat(e,": ").concat(t))},r=0,a=Object.entries(e);r<a.length;r++){var n=aJ(a[r],1)[0];if(!("label"in e[n]))return s(n,"label is required"),!1;if(!("location"in e[n]))return s(n,"location is required"),!1;if(!("src"in e[n])&&!("srcdoc"in e[n]))return s(n,"src or srcdoc is required"),!1;for(var i=0,o=Object.entries(e[n]);i<o.length;i++){var l=aJ(o[i],2),c=l[0],d=l[1];switch(c){case"allow":case"csp":case"name":case"referrerPolicy":case"sandbox":if("string"!=typeof d)return s(n,t(c)),!1;break;case"iconURL":if(!no(d))return s(n,"".concat(c," should be a url")),!1;break;case"src":if("srcdoc"in e[n])return s(n,"cannot have both src and srcdoc"),!1;if(!no(d))return s(n,'src "'.concat(d,'" is not a valid URL')),!1;break;case"srcdoc":if("src"in e[n])return s(n,"cannot have both src and srcdoc"),!1;if("string"!=typeof d)return s(n,t(c)),!1;break;case"location":if(!["main","sidebar"].includes(d))return s(n,t(c)),!1;break;case"controlledBy":if("*"!==d&&"owners"!==d&&(!Array.isArray(d)||d.some(function(e){return"string"!=typeof e})))return s(n,t(c)),!1;break;case"shared":if((!Array.isArray(d)||d.some(function(e){return"string"!=typeof e}))&&"owners"!==d&&"boolean"!=typeof d)return s(n,t(c)),!1;break;default:if(!c_.id[c])return console.error("customIntegration does not support key ".concat(c)),!1}}}return!0}function cK(e,t){var s=e.sessionId,r=e.toEndPoint,a=e.callerId,n=e.useSipRefer;if(!s||!r)throw Error("".concat(t,"() requires a sessionId and toEndPoint"));if("string"!=typeof s||"string"!=typeof r)throw Error("Invalid paramater: sessionId and toEndPoint must be of type string");if(n&&!r.startsWith("sip:"))throw Error('"toEndPoint" must be a "sip" address');if(!r.startsWith("sip:")&&!r.startsWith("+"))throw Error("toEndPoint: ".concat(r,' must starts with either "sip:" or "+"'));if(a&&"string"!=typeof a)throw Error("callerId must be of type string");if(a&&!r.startsWith("+"))throw Error("callerId is only valid when transferring to a PSTN number")}function cY(e){if("object"!==aO(e))throw Error('RemoteMediaPlayerSettings: must be "object" type');if(e.state&&!Object.values(la).includes(e.state))throw Error("Invalid value for RemoteMediaPlayerSettings.state, valid values are: "+JSON.stringify(la));if(e.volume){if("number"!=typeof e.volume)throw Error('RemoteMediaPlayerSettings.volume: must be "number" type');if(e.volume<0||e.volume>2)throw Error("RemoteMediaPlayerSettings.volume: must be between 0.0 - 2.0")}}function cX(e,t,s){return!("number"!=typeof e||e<t||e>s)}function cZ(e,t){return e&&!t&&delete e.data,e}function c0(){let e=(0,b.useParams)().sessionId;return(0,y.jsx)(aA,{sessionId:e})}Promise.any||(Promise.any=(x=aq(function*(e){return new Promise(function(t,s){var r=[];e.forEach(function(a){return Promise.resolve(a).then(function(e){t(e)}).catch(function(t){r.push(t),r.length===e.length&&s(r)})})})}),function(e){return x.apply(this,arguments)})),function(){var e,t,s,r,a,n,o,l,c,d,u,h,m,p,g,f,x,v,y,b,j,w,N,k,S,_,C,M,T,E,A,P,I,O,L,D,R,B;function F(e){var t,s,r,a,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(aI(this,F),a=aF(a=F),aV(r=aB(this,cp()?Reflect.construct(a,n||[],aF(this).constructor):a.apply(this,n)),"startListeningForDeviceChanges",function(){var e;e=r.handleDeviceChange,l8()?l2.has(e)||(l2.set(e,{}),navigator.mediaDevices.enumerateDevices().then(function(t){var s;l2.has(e)&&(l2.get(e).lastDevicesString=JSON.stringify(t),l4||(s=aq(function*(){var e,t=yield navigator.mediaDevices.enumerateDevices(),s=function(e,t){var s="u">typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!s){if(Array.isArray(e)||(s=function(e,t){if(e){if("string"==typeof e)return l1(e,void 0);var s=({}).toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?l1(e,void 0):void 0}}(e))){s&&(e=s);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,o=!1;return{s:function(){s=s.call(e)},n:function(){var e=s.next();return i=e.done,e},e:function(e){o=!0,n=e},f:function(){try{i||null==s.return||s.return()}finally{if(o)throw n}}}}(l2.keys());try{for(s.s();!(e=s.n()).done;){var r=e.value,a=JSON.stringify(t);a!==l2.get(r).lastDevicesString&&(l2.get(r).lastDevicesString=a,r(t))}}catch(e){s.e(e)}finally{s.f()}}),l4=function(){return s.apply(this,arguments)},navigator.mediaDevices.addEventListener("devicechange",l4)))}).catch(function(){})):l3.has(e)||(l3.set(e,{}),navigator.mediaDevices.enumerateDevices().then(function(t){l3.has(e)&&(l3.get(e).lastDevicesString=JSON.stringify(t),l6||(l6=setInterval(aq(function*(){var e,t=yield navigator.mediaDevices.enumerateDevices(),s=function(e,t){var s="u">typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!s){if(Array.isArray(e)||(s=function(e,t){if(e){if("string"==typeof e)return l5(e,void 0);var s=({}).toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?l5(e,void 0):void 0}}(e))){s&&(e=s);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,o=!1;return{s:function(){s=s.call(e)},n:function(){var e=s.next();return i=e.done,e},e:function(e){o=!0,n=e},f:function(){try{i||null==s.return||s.return()}finally{if(o)throw n}}}}(l3.keys());try{for(s.s();!(e=s.n()).done;){var r=e.value,a=JSON.stringify(t);a!==l3.get(r).lastDevicesString&&(l3.get(r).lastDevicesString=a,r(t))}}catch(e){s.e(e)}finally{s.f()}}),3e3)))}))}),aV(r,"stopListeningForDeviceChanges",function(){var e;e=r.handleDeviceChange,l8()?l2.has(e)&&(l2.delete(e),0===l2.size&&l4&&(navigator.mediaDevices.removeEventListener("devicechange",l4),l4=null)):l3.has(e)&&(l3.delete(e),0===l3.size&&l6&&(clearInterval(l6),l6=null))}),aV(r,"handleDeviceChange",function(e){e=e.map(function(e){return JSON.parse(JSON.stringify(e))}),r.emitDailyJSEvent({action:"available-devices-updated",availableDevices:e})}),aV(r,"handleNativeAppStateChange",(t=aq(function*(e){"destroyed"===e?(console.warn("App has been destroyed before leaving the meeting. Cleaning up all the resources!"),yield r.destroy()):r.disableReactNativeAutoDeviceManagement("video")||("active"===e?r.camUnmutedBeforeLosingNativeActiveState&&r.setLocalVideo(!0):(r.camUnmutedBeforeLosingNativeActiveState=r.localVideo(),r.camUnmutedBeforeLosingNativeActiveState&&r.setLocalVideo(!1)))}),function(e){return t.apply(this,arguments)})),aV(r,"handleNativeAudioFocusChange",function(e){r.disableReactNativeAutoDeviceManagement("audio")||(r._hasNativeAudioFocus=e,r.toggleParticipantAudioBasedOnNativeAudioFocus(),r._hasNativeAudioFocus?r.micUnmutedBeforeLosingNativeAudioFocus&&r.setLocalAudio(!0):(r.micUnmutedBeforeLosingNativeAudioFocus=r.localAudio(),r.setLocalAudio(!1)))}),aV(r,"handleNativeSystemScreenCaptureStop",function(){r.stopScreenShare()}),!lg()&&!ll())throw Error("WebRTC not supported or suppressed");if(r.strictMode=void 0===i.strictMode||i.strictMode,r.allowMultipleCallInstances=null!=(s=i.allowMultipleCallInstances)&&s,Object.keys(cx).length&&(r._logDuplicateInstanceAttempt(),!r.allowMultipleCallInstances)){if(r.strictMode)throw Error("Duplicate DailyIframe instances are not allowed");console.warn("Using strictMode: false to allow multiple call instances is now deprecated. Set `allowMultipleCallInstances: true`")}if(window._daily||(window._daily={pendings:[],instances:{}}),r.callClientId=nr(),cx[r.callClientId]=r,window._daily.instances[r.callClientId]={},r._sharedTracks={},window._daily.instances[r.callClientId].tracks=r._sharedTracks,i.dailyJsVersion=F.version(),r._iframe=e,r._callObjectMode="none"===i.layout&&!r._iframe,r._preloadCache={subscribeToTracksAutomatically:!0,outputDeviceId:null,inputSettings:null,sendSettings:null,videoTrackForNetworkConnectivityTest:null,videoTrackForConnectionQualityTest:null},void 0!==i.showLocalVideo?r._callObjectMode?console.error("showLocalVideo is not available in call object mode"):r._showLocalVideo=!!i.showLocalVideo:r._showLocalVideo=!0,void 0!==i.showParticipantsBar?r._callObjectMode?console.error("showParticipantsBar is not available in call object mode"):r._showParticipantsBar=!!i.showParticipantsBar:r._showParticipantsBar=!0,void 0!==i.customIntegrations?r._callObjectMode?console.error("customIntegrations is not available in call object mode"):r._customIntegrations=i.customIntegrations:r._customIntegrations={},void 0!==i.customTrayButtons?r._callObjectMode?console.error("customTrayButtons is not available in call object mode"):r._customTrayButtons=i.customTrayButtons:r._customTrayButtons={},void 0!==i.activeSpeakerMode?r._callObjectMode?console.error("activeSpeakerMode is not available in call object mode"):r._activeSpeakerMode=!!i.activeSpeakerMode:r._activeSpeakerMode=!1,i.receiveSettings?r._callObjectMode?r._receiveSettings=i.receiveSettings:console.error("receiveSettings is only available in call object mode"):r._receiveSettings={},r.validateProperties(i),r.properties=cm({},i),r._inputSettings||(r._inputSettings={}),r._callObjectLoader=r._callObjectMode?new l$(r.callClientId):null,r._callState="new",r._isPreparingToJoin=!1,r._accessState={access:oY},r._meetingSessionSummary={},r._finalSummaryOfPrevSession={},r._meetingSessionState=cZ(cy,r._callObjectMode),r._nativeInCallAudioMode=cv,r._participants={},r._isScreenSharing=!1,r._participantCounts=cb,r._rmpPlayerState={},r._waitingParticipants={},r._network={threshold:"good",quality:100,networkState:"unknown",stats:{}},r._activeSpeaker={},r._localAudioLevel=0,r._isLocalAudioLevelObserverRunning=!1,r._remoteParticipantsAudioLevel={},r._isRemoteParticipantsAudioLevelObserverRunning=!1,r._maxAppMessageSize=4096,r._messageChannel=ll()?new lP:new lT,r._iframe&&(r._iframe.requestFullscreen?r._iframe.addEventListener("fullscreenchange",function(){document.fullscreenElement===r._iframe?(r.emitDailyJSEvent({action:o2}),r.sendMessageToCallMachine({action:o2})):(r.emitDailyJSEvent({action:o4}),r.sendMessageToCallMachine({action:o4}))}):r._iframe.webkitRequestFullscreen&&r._iframe.addEventListener("webkitfullscreenchange",function(){document.webkitFullscreenElement===r._iframe?(r.emitDailyJSEvent({action:o2}),r.sendMessageToCallMachine({action:o2})):(r.emitDailyJSEvent({action:o4}),r.sendMessageToCallMachine({action:o4}))})),ll()){var o=r.nativeUtils();o.addAudioFocusChangeListener&&o.removeAudioFocusChangeListener&&o.addAppStateChangeListener&&o.removeAppStateChangeListener&&o.addSystemScreenCaptureStopListener&&o.removeSystemScreenCaptureStopListener||console.warn("expected (add|remove)(AudioFocusChange|AppActiveStateChange|SystemScreenCaptureStop)Listener to be available in React Native"),r._hasNativeAudioFocus=!0,o.addAudioFocusChangeListener(r.handleNativeAudioFocusChange),o.addAppStateChangeListener(r.handleNativeAppStateChange),o.addSystemScreenCaptureStopListener(r.handleNativeSystemScreenCaptureStop)}return r._callObjectMode&&r.startListeningForDeviceChanges(),r._messageChannel.addListenerForMessagesFromCallMachine(r.handleMessageFromCallMachine,r.callClientId,r),r}a$(F,aK),aR(F,[{key:"destroy",value:(B=aq(function*(){try{yield this.leave()}catch(e){}var e,t=this._iframe;if(t){var s=t.parentElement;s&&s.removeChild(t)}if(this._messageChannel.removeListener(this.handleMessageFromCallMachine),ll()){var r=this.nativeUtils();r.removeAudioFocusChangeListener(this.handleNativeAudioFocusChange),r.removeAppStateChangeListener(this.handleNativeAppStateChange),r.removeSystemScreenCaptureStopListener(this.handleNativeSystemScreenCaptureStop)}this._callObjectMode&&this.stopListeningForDeviceChanges(),this.resetMeetingDependentVars(),this._destroyed=!0,this.emitDailyJSEvent({action:"call-instance-destroyed"}),delete cx[this.callClientId],(null==(e=window)||null==(e=e._daily)?void 0:e.instances)&&delete window._daily.instances[this.callClientId],this.strictMode&&(this.callClientId=void 0)}),function(){return B.apply(this,arguments)})},{key:"isDestroyed",value:function(){return!!this._destroyed}},{key:"loadCss",value:function(e){var t=e.bodyClass,s=e.cssFile,r=e.cssText;return cB(),this.sendMessageToCallMachine({action:"load-css",cssFile:this.absoluteUrl(s),bodyClass:t,cssText:r}),this}},{key:"iframe",value:function(){return cB(),this._iframe}},{key:"meetingState",value:function(){return this._callState}},{key:"accessState",value:function(){return cD(this._callObjectMode,"accessState()"),this._accessState}},{key:"participants",value:function(){return this._participants}},{key:"participantCounts",value:function(){return this._participantCounts}},{key:"waitingParticipants",value:function(){return cD(this._callObjectMode,"waitingParticipants()"),this._waitingParticipants}},{key:"validateParticipantProperties",value:function(e,t){for(var s in t){if(!cM[s])throw Error("unrecognized updateParticipant property ".concat(s));if(cM[s].validate&&!cM[s].validate(t[s],this,this._participants[e]))throw Error(cM[s].help)}}},{key:"updateParticipant",value:function(e,t){return this._participants.local&&this._participants.local.session_id===e&&(e="local"),e&&t&&(this.validateParticipantProperties(e,t),this.sendMessageToCallMachine({action:"update-participant",id:e,properties:t})),this}},{key:"updateParticipants",value:function(e){var t=this._participants.local&&this._participants.local.session_id;for(var s in e)s===t&&(s="local"),s&&e[s]&&this.validateParticipantProperties(s,e[s]);return this.sendMessageToCallMachine({action:"update-participants",participants:e}),this}},{key:"updateWaitingParticipant",value:(R=aq(function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(cD(this._callObjectMode,"updateWaitingParticipant()"),cA(this._callState,"updateWaitingParticipant()"),"string"!=typeof t||"object"!==aO(s))throw Error("updateWaitingParticipant() must take an id string and a updates object");return new Promise(function(r,a){e.sendMessageToCallMachine({action:"daily-method-update-waiting-participant",id:t,updates:s},function(e){e.error&&a(e.error),e.id||a(Error("unknown error in updateWaitingParticipant()")),r({id:e.id})})})}),function(){return R.apply(this,arguments)})},{key:"updateWaitingParticipants",value:(D=aq(function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(cD(this._callObjectMode,"updateWaitingParticipants()"),cA(this._callState,"updateWaitingParticipants()"),"object"!==aO(t))throw Error("updateWaitingParticipants() must take a mapping between ids and update objects");return new Promise(function(s,r){e.sendMessageToCallMachine({action:"daily-method-update-waiting-participants",updatesById:t},function(e){e.error&&r(e.error),e.ids||r(Error("unknown error in updateWaitingParticipants()")),s({ids:e.ids})})})}),function(){return D.apply(this,arguments)})},{key:"requestAccess",value:(L=aq(function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=t.access,r=void 0===s?{level:"full"}:s,a=t.name,n=void 0===a?"":a;return cD(this._callObjectMode,"requestAccess()"),cA(this._callState,"requestAccess()"),new Promise(function(t,s){e.sendMessageToCallMachine({action:"daily-method-request-access",access:r,name:n},function(e){e.error&&s(e.error),e.access||s(Error("unknown error in requestAccess()")),t({access:e.access,granted:e.granted})})})}),function(){return L.apply(this,arguments)})},{key:"localAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.audio.state):null}},{key:"localVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.video.state):null}},{key:"setLocalAudio",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"forceDiscardTrack"in t&&(ll()?(console.warn("forceDiscardTrack option not supported in React Native; ignoring"),t={}):e&&(console.warn("forceDiscardTrack option only supported when calling setLocalAudio(false); ignoring"),t={})),this.sendMessageToCallMachine({action:"local-audio",state:e,options:t}),this}},{key:"localScreenAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenAudio.state):null}},{key:"localScreenVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenVideo.state):null}},{key:"updateScreenShare",value:function(e){if(this._isScreenSharing)return this.sendMessageToCallMachine({action:"local-screen-update",options:e}),this;console.warn("There is no screen share in progress. Try calling startScreenShare first.")}},{key:"setLocalVideo",value:function(e){return this.sendMessageToCallMachine({action:"local-video",state:e}),this}},{key:"_setAllowLocalAudio",value:function(e){if(this._preloadCache.allowLocalAudio=e,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-audio",state:e}),this}},{key:"_setAllowLocalVideo",value:function(e){if(this._preloadCache.allowLocalVideo=e,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-video",state:e}),this}},{key:"getReceiveSettings",value:(O=aq(function*(e){var t=this,s=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).showInheritedValues,r=void 0!==s&&s;if(cD(this._callObjectMode,"getReceiveSettings()"),!this._callMachineInitialized)return this._receiveSettings;switch(aO(e)){case"string":return new Promise(function(s){t.sendMessageToCallMachine({action:"get-single-participant-receive-settings",id:e,showInheritedValues:r},function(e){s(e.receiveSettings)})});case"undefined":return this._receiveSettings;default:throw Error('first argument to getReceiveSettings() must be a participant id (or "base"), or there should be no arguments')}}),function(e){return O.apply(this,arguments)})},{key:"updateReceiveSettings",value:(I=aq(function*(e){var t=this;if(cD(this._callObjectMode,"updateReceiveSettings()"),!c$(e,{allowAllParticipantsKey:!0}))throw Error(cJ({allowAllParticipantsKey:!0}));return cA(this._callState,"updateReceiveSettings()","To specify receive settings earlier, use the receiveSettings config property."),new Promise(function(s){t.sendMessageToCallMachine({action:"update-receive-settings",receiveSettings:e},function(e){s({receiveSettings:e.receiveSettings})})})}),function(e){return I.apply(this,arguments)})},{key:"_prepInputSettingsForSharing",value:function(e,t){if(e){var s={};if(e.audio){e.audio.settings&&(!Object.keys(e.audio.settings).length&&t||(s.audio={settings:cm({},e.audio.settings)})),t&&null!=(r=s.audio)&&null!=(r=r.settings)&&r.customTrack&&(s.audio.settings={customTrack:this._sharedTracks.audioTrack});var r,a,n,i="none"===(null==(a=e.audio.processor)?void 0:a.type)&&(null==(n=e.audio.processor)?void 0:n._isDefaultWhenNone);if(e.audio.processor&&!i){var o=cm({},e.audio.processor);delete o._isDefaultWhenNone,s.audio=cm(cm({},s.audio),{},{processor:o})}}if(e.video){e.video.settings&&(!Object.keys(e.video.settings).length&&t||(s.video={settings:cm({},e.video.settings)})),t&&null!=(l=s.video)&&null!=(l=l.settings)&&l.customTrack&&(s.video.settings={customTrack:this._sharedTracks.videoTrack});var l,c,d,u="none"===(null==(c=e.video.processor)?void 0:c.type)&&(null==(d=e.video.processor)?void 0:d._isDefaultWhenNone);if(e.video.processor&&!u){var h=cm({},e.video.processor);delete h._isDefaultWhenNone,s.video=cm(cm({},s.video),{},{processor:h})}}return s}}},{key:"getInputSettings",value:function(){var e=this;return cB(),new Promise(function(t){t(e._getInputSettings())})}},{key:"_getInputSettings",value:function(){var e,t,s,r,a,n,i={processor:{type:"none",_isDefaultWhenNone:!0}};this._inputSettings?(e=(null==(s=this._inputSettings)?void 0:s.video)||i,t=(null==(r=this._inputSettings)?void 0:r.audio)||i):(e=(null==(a=this._preloadCache)||null==(a=a.inputSettings)?void 0:a.video)||i,t=(null==(n=this._preloadCache)||null==(n=n.inputSettings)?void 0:n.audio)||i);var o={audio:t,video:e};return this._prepInputSettingsForSharing(o,!0)}},{key:"_updatePreloadCacheInputSettings",value:function(e,t){var s,r,a,n,i,o,l=this._inputSettings||{},c={};e.video?((c.video={},e.video.settings)?(c.video.settings={},t||e.video.settings.customTrack||null==(a=l.video)||!a.settings?c.video.settings=e.video.settings:c.video.settings=cm(cm({},l.video.settings),e.video.settings),Object.keys(c.video.settings).length||delete c.video.settings):null!=(s=l.video)&&s.settings&&(c.video.settings=l.video.settings),e.video.processor?c.video.processor=e.video.processor:null!=(r=l.video)&&r.processor&&(c.video.processor=l.video.processor)):l.video&&(c.video=l.video),e.audio?((c.audio={},e.audio.settings)?(c.audio.settings={},t||e.audio.settings.customTrack||null==(o=l.audio)||!o.settings?c.audio.settings=e.audio.settings:c.audio.settings=cm(cm({},l.audio.settings),e.audio.settings),Object.keys(c.audio.settings).length||delete c.audio.settings):null!=(n=l.audio)&&n.settings&&(c.audio.settings=l.audio.settings),e.audio.processor?c.audio.processor=e.audio.processor:null!=(i=l.audio)&&i.processor&&(c.audio.processor=l.audio.processor)):l.audio&&(c.audio=l.audio),this._maybeUpdateInputSettings(c)}},{key:"_devicesFromInputSettings",value:function(e){var t,s,r=(null==e||null==(t=e.video)||null==(t=t.settings)?void 0:t.deviceId)||null,a=(null==e||null==(s=e.audio)||null==(s=s.settings)?void 0:s.deviceId)||null,n=this._preloadCache.outputDeviceId||null;return{camera:r?{deviceId:r}:{},mic:a?{deviceId:a}:{},speaker:n?{deviceId:n}:{}}}},{key:"updateInputSettings",value:(P=aq(function*(e){var t=this;return cB(),cV(e)?e.video||e.audio?(cU(e,this.properties.dailyConfig,this._sharedTracks),this._callObjectMode&&!this._callMachineInitialized?(this._updatePreloadCacheInputSettings(e,!0),this._getInputSettings()):new Promise(function(s,r){t.sendMessageToCallMachine({action:"update-input-settings",inputSettings:e},function(a){if(a.error)r(a.error);else{if(a.returnPreloadCache)return t._updatePreloadCacheInputSettings(e,!0),void s(t._getInputSettings());t._maybeUpdateInputSettings(a.inputSettings),s(t._prepInputSettingsForSharing(a.inputSettings,!0))}})})):this._getInputSettings():(console.error(cH()),Promise.reject(cH()))}),function(e){return P.apply(this,arguments)})},{key:"setBandwidth",value:function(e){var t=e.kbs,s=e.trackConstraints;if(cB(),this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-bandwidth",kbs:t,trackConstraints:s}),this}},{key:"getDailyLang",value:function(){var e=this;if(cB(),this._callMachineInitialized)return new Promise(function(t){e.sendMessageToCallMachine({action:"get-daily-lang"},function(e){delete e.action,delete e.callbackStamp,t(e)})})}},{key:"setDailyLang",value:function(e){return cB(),this.sendMessageToCallMachine({action:"set-daily-lang",lang:e}),this}},{key:"setProxyUrl",value:function(e){return this.sendMessageToCallMachine({action:"set-proxy-url",proxyUrl:e}),this}},{key:"setIceConfig",value:function(e){return this.sendMessageToCallMachine({action:"set-ice-config",iceConfig:e}),this}},{key:"meetingSessionSummary",value:function(){return[oQ,oK].includes(this._callState)?this._finalSummaryOfPrevSession:this._meetingSessionSummary}},{key:"getMeetingSession",value:(A=aq(function*(){var e=this;return console.warn("getMeetingSession() is deprecated: use meetingSessionSummary(), which will return immediately"),cA(this._callState,"getMeetingSession()"),new Promise(function(t){e.sendMessageToCallMachine({action:"get-meeting-session"},function(e){delete e.action,delete e.callbackStamp,t(e)})})}),function(){return A.apply(this,arguments)})},{key:"meetingSessionState",value:function(){return cA(this._callState,"meetingSessionState"),this._meetingSessionState}},{key:"setMeetingSessionData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"replace";cD(this._callObjectMode,"setMeetingSessionData()"),cA(this._callState,"setMeetingSessionData");try{new lD({data:e,mergeStrategy:t})}catch(e){throw console.error(e),e}try{this.sendMessageToCallMachine({action:"set-session-data",data:e,mergeStrategy:t})}catch(e){throw Error("Error setting meeting session data: ".concat(e))}}},{key:"setUserName",value:function(e,t){var s=this;return this.properties.userName=e,new Promise(function(r){s.sendMessageToCallMachine({action:"set-user-name",name:null!=e?e:"",thisMeetingOnly:ll()||!!t&&!!t.thisMeetingOnly},function(e){delete e.action,delete e.callbackStamp,r(e)})})}},{key:"setUserData",value:(E=aq(function*(e){var t=this;try{cz(e)}catch(e){throw console.error(e),e}if(this.properties.userData=e,this._callMachineInitialized)return new Promise(function(s){try{t.sendMessageToCallMachine({action:"set-user-data",userData:e},function(e){delete e.action,delete e.callbackStamp,s(e)})}catch(e){throw Error("Error setting user data: ".concat(e))}})}),function(e){return E.apply(this,arguments)})},{key:"validateAudioLevelInterval",value:function(e){if(e&&(e<100||"number"!=typeof e))throw Error("The interval must be a number greater than or equal to 100 milliseconds.")}},{key:"startLocalAudioLevelObserver",value:function(e){var t=this;if("u"<typeof AudioWorkletNode&&!ll())throw Error("startLocalAudioLevelObserver() is not supported on this browser");if(this.validateAudioLevelInterval(e),this._callMachineInitialized)return this._isLocalAudioLevelObserverRunning=!0,new Promise(function(s,r){t.sendMessageToCallMachine({action:"start-local-audio-level-observer",interval:e},function(e){t._isLocalAudioLevelObserverRunning=!e.error,e.error?r({error:e.error}):s()})});this._preloadCache.localAudioLevelObserver={enabled:!0,interval:e}}},{key:"isLocalAudioLevelObserverRunning",value:function(){return this._isLocalAudioLevelObserverRunning}},{key:"stopLocalAudioLevelObserver",value:function(){this._preloadCache.localAudioLevelObserver=null,this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-local-audio-level-observer"})}},{key:"startRemoteParticipantsAudioLevelObserver",value:function(e){var t=this;if(this.validateAudioLevelInterval(e),this._callMachineInitialized)return this._isRemoteParticipantsAudioLevelObserverRunning=!0,new Promise(function(s,r){t.sendMessageToCallMachine({action:"start-remote-participants-audio-level-observer",interval:e},function(e){t._isRemoteParticipantsAudioLevelObserverRunning=!e.error,e.error?r({error:e.error}):s()})});this._preloadCache.remoteParticipantsAudioLevelObserver={enabled:!0,interval:e}}},{key:"isRemoteParticipantsAudioLevelObserverRunning",value:function(){return this._isRemoteParticipantsAudioLevelObserverRunning}},{key:"stopRemoteParticipantsAudioLevelObserver",value:function(){this._preloadCache.remoteParticipantsAudioLevelObserver=null,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-remote-participants-audio-level-observer"})}},{key:"startCamera",value:(T=aq(function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(cD(this._callObjectMode,"startCamera()"),cI(this._callState,this._isPreparingToJoin,"startCamera()","Did you mean to use setLocalAudio() and/or setLocalVideo() instead?"),this.needsLoad())try{yield this.load(t)}catch(e){return Promise.reject(e)}else{if(this._didPreAuth){if(t.url&&t.url!==this.properties.url)return console.error("url in startCamera() is different than the one used in preAuth()"),Promise.reject();if(t.token&&t.token!==this.properties.token)return console.error("token in startCamera() is different than the one used in preAuth()"),Promise.reject()}this.validateProperties(t),this.properties=cm(cm({},this.properties),t)}return new Promise(function(t,s){e._preloadCache.inputSettings=e._prepInputSettingsForSharing(e._inputSettings,!1),e.sendMessageToCallMachine({action:"start-camera",properties:cE(e.properties,e.callClientId),preloadCache:cE(e._preloadCache,e.callClientId)},function(e){e.error?s(e.error):t({camera:e.camera,mic:e.mic,speaker:e.speaker})})})}),function(){return T.apply(this,arguments)})},{key:"validateCustomTrack",value:function(e,t,s){if(s&&s.length>50)throw Error("Custom track `trackName` must not be more than 50 characters");if(t&&"music"!==t&&"speech"!==t&&!(t instanceof Object))throw Error("Custom track `mode` must be either `music` | `speech` | `DailyMicAudioModeSettings` or `undefined`");if(s&&["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo","customVideoDefaults"].includes(s))throw Error("Custom track `trackName` must not match a track name already used by daily: cam-audio, cam-video, customVideoDefaults, screen-video, screen-audio, rmpAudio, rmpVideo");if(!(e instanceof MediaStreamTrack))throw Error("Custom tracks provided must be instances of MediaStreamTrack")}},{key:"startCustomTrack",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{track:track,mode:mode,trackName:trackName,ignoreAudioLevel:ignoreAudioLevel};return cB(),cA(this._callState,"startCustomTrack()"),this.validateCustomTrack(t.track,t.mode,t.trackName),new Promise(function(s,r){e._sharedTracks.customTrack=t.track,t.track=lt,e.sendMessageToCallMachine({action:"start-custom-track",properties:t},function(e){e.error?r({error:e.error}):s(e.mediaTag)})})}},{key:"stopCustomTrack",value:function(e){var t=this;return cB(),cA(this._callState,"stopCustomTrack()"),new Promise(function(s){t.sendMessageToCallMachine({action:"stop-custom-track",mediaTag:e},function(e){s(e.mediaTag)})})}},{key:"setCamera",value:function(e){var t=this;return cF(),cO(this._callMachineInitialized,"setCamera()"),new Promise(function(s){t.sendMessageToCallMachine({action:"set-camera",cameraDeviceId:e},function(e){s({device:e.device})})})}},{key:"setAudioDevice",value:(M=aq(function*(e){return cF(),this.nativeUtils().setAudioDevice(e),{deviceId:yield this.nativeUtils().getAudioDevice()}}),function(e){return M.apply(this,arguments)})},{key:"cycleCamera",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(s){e.sendMessageToCallMachine({action:"cycle-camera",properties:t},function(e){s({device:e.device})})})}},{key:"cycleMic",value:function(){var e=this;return cB(),new Promise(function(t){e.sendMessageToCallMachine({action:"cycle-mic"},function(e){t({device:e.device})})})}},{key:"getCameraFacingMode",value:function(){var e=this;return cF(),new Promise(function(t){e.sendMessageToCallMachine({action:"get-camera-facing-mode"},function(e){t(e.facingMode)})})}},{key:"setInputDevicesAsync",value:(C=aq(function*(e){var t=this,s=e.audioDeviceId,r=e.videoDeviceId,a=e.audioSource,n=e.videoSource;if(cB(),void 0!==a&&(s=a),void 0!==n&&(r=n),"boolean"==typeof s&&(this._setAllowLocalAudio(s),s=void 0),"boolean"==typeof r&&(this._setAllowLocalVideo(r),r=void 0),!s&&!r)return yield this.getInputDevices();var i={};return s&&(s instanceof MediaStreamTrack?(this._sharedTracks.audioTrack=s,i.audio={settings:{customTrack:s=lt}}):(delete this._sharedTracks.audioTrack,i.audio={settings:{deviceId:s}})),r&&(r instanceof MediaStreamTrack?(this._sharedTracks.videoTrack=r,i.video={settings:{customTrack:r=lt}}):(delete this._sharedTracks.videoTrack,i.video={settings:{deviceId:r}})),this._callObjectMode&&this.needsLoad()?(this._updatePreloadCacheInputSettings(i,!1),this._devicesFromInputSettings(this._inputSettings)):new Promise(function(e){t.sendMessageToCallMachine({action:"set-input-devices",audioDeviceId:s,videoDeviceId:r},function(s){(delete s.action,delete s.callbackStamp,s.returnPreloadCache)?(t._updatePreloadCacheInputSettings(i,!1),e(t._devicesFromInputSettings(t._inputSettings))):e(s)})})}),function(e){return C.apply(this,arguments)})},{key:"setOutputDeviceAsync",value:(_=aq(function*(e){var t=this,s=e.outputDeviceId;if(cB(),!s||"string"!=typeof s)throw Error("outputDeviceId must be provided and must be a valid device id");return this._preloadCache.outputDeviceId=s,this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise(function(e,r){t.sendMessageToCallMachine({action:"set-output-device",outputDeviceId:s},function(s){if(delete s.action,delete s.callbackStamp,s.error){var a=Error(s.error.message);return a.type=s.error.type,void r(a)}s.returnPreloadCache?e(t._devicesFromInputSettings(t._inputSettings)):e(s)})})}),function(e){return _.apply(this,arguments)})},{key:"getInputDevices",value:(S=aq(function*(){var e=this;return this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise(function(t){e.sendMessageToCallMachine({action:"get-input-devices"},function(s){s.returnPreloadCache?t(e._devicesFromInputSettings(e._inputSettings)):t({camera:s.camera,mic:s.mic,speaker:s.speaker})})})}),function(){return S.apply(this,arguments)})},{key:"nativeInCallAudioMode",value:function(){return cF(),this._nativeInCallAudioMode}},{key:"setNativeInCallAudioMode",value:function(e){if(cF(),[cv,"voice"].includes(e)){if(e!==this._nativeInCallAudioMode)return this._nativeInCallAudioMode=e,!this.disableReactNativeAutoDeviceManagement("audio")&&cP(this._callState,this._isPreparingToJoin)&&this.nativeUtils().setAudioMode(this._nativeInCallAudioMode),this}else console.error("invalid in-call audio mode specified: ",e)}},{key:"preAuth",value:(k=aq(function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(cD(this._callObjectMode,"preAuth()"),cI(this._callState,this._isPreparingToJoin,"preAuth()"),this.needsLoad()&&(yield this.load(t)),!t.url)throw Error("preAuth() requires at least a url to be provided");return this.validateProperties(t),this.properties=cm(cm({},this.properties),t),new Promise(function(t,s){e._preloadCache.inputSettings=e._prepInputSettingsForSharing(e._inputSettings,!1),e.sendMessageToCallMachine({action:"daily-method-preauth",properties:cE(e.properties,e.callClientId),preloadCache:cE(e._preloadCache,e.callClientId)},function(r){return r.error?s(r.error):r.access?(e._didPreAuth=!0,void t({access:r.access})):s(Error("unknown error in preAuth()"))})})}),function(){return k.apply(this,arguments)})},{key:"load",value:(N=aq(function*(e){var t=this;if(this.needsLoad()){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw Error("Use after destroy");if(e&&(this.validateProperties(e),this.properties=cm(cm({},this.properties),e)),!this._callObjectMode&&!this.properties.url)throw Error("can't load iframe meeting because url property isn't set");return this._updateCallState(oH),this.emitDailyJSEvent({action:"loading"}),this._callObjectMode?new Promise(function(e,s){t._callObjectLoader.cancel();var r=Date.now();t._callObjectLoader.load(t.properties.dailyConfig,function(s){t._bundleLoadTime=s?"no-op":Date.now()-r,t._updateCallState(oJ),s&&t.emitDailyJSEvent({action:oZ}),e()},function(e,r){if(t.emitDailyJSEvent({action:"load-attempt-failed"}),!r){t._updateCallState(oK),t.resetMeetingDependentVars();var a={action:o6,errorMsg:e.msg,error:{type:"connection-error",msg:"Failed to load call object bundle.",details:{on:"load",sourceError:e,bundleUrl:ni(t.properties.dailyConfig)}}};t._maybeSendToSentry(a),t.emitDailyJSEvent(a),s(e.msg)}})}):(this._iframe.src=nn(this.assembleMeetingUrl(),this.properties.dailyConfig),new Promise(function(e,s){t._loadedCallback=function(r){t._callState!==oK?(t._updateCallState(oJ),(t.properties.cssFile||t.properties.cssText)&&t.loadCss(t.properties),e()):s(r)}}))}}),function(e){return N.apply(this,arguments)})},{key:"join",value:(w=aq(function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._testCallInProgress&&this.stopTestCallQuality(),!t.url&&!this.properties.url){var s="No room URL has been provided";return console.error(s),Promise.reject(Error(s))}var r=!1;if(this.needsLoad()){this.updateIsPreparingToJoin(!0);try{yield this.load(t)}catch(e){return this.updateIsPreparingToJoin(!1),Promise.reject(e)}}else{if(r=!(!this.properties.cssFile&&!this.properties.cssText),this._didPreAuth){if(t.url&&t.url!==this.properties.url)return console.error("url in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject();if(t.token&&t.token!==this.properties.token)return console.error("token in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject()}if(t.url&&!this._callObjectMode&&t.url&&t.url!==this.properties.url)return console.error("url in join() is different than the one used in load() (".concat(this.properties.url," -> ").concat(t.url,")")),this.updateIsPreparingToJoin(!1),Promise.reject();this.validateProperties(t),this.properties=cm(cm({},this.properties),t)}return void 0!==t.showLocalVideo&&(this._callObjectMode?console.error("showLocalVideo is not available in callObject mode"):this._showLocalVideo=!!t.showLocalVideo),void 0!==t.showParticipantsBar&&(this._callObjectMode?console.error("showParticipantsBar is not available in callObject mode"):this._showParticipantsBar=!!t.showParticipantsBar),this._callState===oW||this._callState===oG?(console.warn("already joined meeting, call leave() before joining again"),void this.updateIsPreparingToJoin(!1)):(this._updateCallState(oG,!1),this.emitDailyJSEvent({action:"joining-meeting"}),this._preloadCache.inputSettings=this._prepInputSettingsForSharing(this._inputSettings||{},!1),this.sendMessageToCallMachine({action:"join-meeting",properties:cE(this.properties,this.callClientId),preloadCache:cE(this._preloadCache,this.callClientId)},function(t){t.error&&e._joinedCallback&&(e._joinedCallback(null,t.error),e._joinedCallback=null)}),new Promise(function(t,s){e._joinedCallback=function(a,n){if(e._callState!==oK){if(n)return e._updateCallState(oQ),void s(n);if(e._updateCallState(oW),a)for(var i in a){if(e._callObjectMode){var o=e._callMachine().store;lX(a[i],o),lZ(a[i],o),l0(a[i],e._participants[i],o)}e._participants[i]=cm({},a[i]),e.toggleParticipantAudioBasedOnNativeAudioFocus()}r&&e.loadCss(e.properties),t(a)}else s(n)}}))}),function(){return w.apply(this,arguments)})},{key:"leave",value:(j=aq(function*(){var e=this;return this._testCallInProgress&&this.stopTestCallQuality(),new Promise(function(t){e._callState===oQ||e._callState===oK?t():e._callObjectLoader&&!e._callObjectLoader.loaded?(e._callObjectLoader.cancel(),e._updateCallState(oQ),e.resetMeetingDependentVars(),e.emitDailyJSEvent({action:oQ}),t()):(e._resolveLeave=t,e.sendMessageToCallMachine({action:"leave-meeting"}))})}),function(){return j.apply(this,arguments)})},{key:"startScreenShare",value:(b=aq(function*(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(cO(this._callMachineInitialized,"startScreenShare()"),t.screenVideoSendSettings&&this._validateVideoSendSettings("screenVideo",t.screenVideoSendSettings),t.mediaStream&&(this._sharedTracks.screenMediaStream=t.mediaStream,t.mediaStream=lt),"u">typeof DailyNativeUtils&&void 0!==DailyNativeUtils.isIOS&&DailyNativeUtils.isIOS){var s=this.nativeUtils();if(yield s.isScreenBeingCaptured())return void this.emitDailyJSEvent({action:o3,type:"screen-share-error",errorMsg:"Could not start the screen sharing. The screen is already been captured!"});s.setSystemScreenCaptureStartCallback(function(){s.setSystemScreenCaptureStartCallback(null),e.sendMessageToCallMachine({action:o7,captureOptions:t})}),s.presentSystemScreenCapturePrompt()}else this.sendMessageToCallMachine({action:o7,captureOptions:t})}),function(){return b.apply(this,arguments)})},{key:"stopScreenShare",value:function(){cO(this._callMachineInitialized,"stopScreenShare()"),this.sendMessageToCallMachine({action:"local-screen-stop"})}},{key:"startRecording",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type;if(t&&"cloud"!==t&&"cloud-audio-only"!==t&&"raw-tracks"!==t&&"local"!==t)throw Error("invalid type: ".concat(t,", allowed values 'cloud', 'cloud-audio-only', 'raw-tracks', or 'local'"));this.sendMessageToCallMachine(cm({action:"local-recording-start"},e))}},{key:"updateRecording",value:function(e){var t=e.layout,s=e.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-recording",layout:void 0===t?{preset:"default"}:t,instanceId:s})}},{key:"stopRecording",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sendMessageToCallMachine(cm({action:"local-recording-stop"},e))}},{key:"startLiveStreaming",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sendMessageToCallMachine(cm({action:"daily-method-start-live-streaming"},e))}},{key:"updateLiveStreaming",value:function(e){var t=e.layout,s=e.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming",layout:void 0===t?{preset:"default"}:t,instanceId:s})}},{key:"addLiveStreamingEndpoints",value:function(e){var t=e.endpoints,s=e.instanceId;this.sendMessageToCallMachine({action:o9,endpointsOp:"add-endpoints",endpoints:t,instanceId:s})}},{key:"removeLiveStreamingEndpoints",value:function(e){var t=e.endpoints,s=e.instanceId;this.sendMessageToCallMachine({action:o9,endpointsOp:"remove-endpoints",endpoints:t,instanceId:s})}},{key:"stopLiveStreaming",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sendMessageToCallMachine(cm({action:"daily-method-stop-live-streaming"},e))}},{key:"validateDailyConfig",value:function(e){e.camSimulcastEncodings&&(console.warn("camSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide camera simulcast settings."),this.validateSimulcastEncodings(e.camSimulcastEncodings)),e.screenSimulcastEncodings&&console.warn("screenSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide screen simulcast settings."),lf()&&e.noAutoDefaultDeviceChange&&console.warn("noAutoDefaultDeviceChange is not supported on Android, and will be ignored.")}},{key:"validateSimulcastEncodings",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){if(!(e instanceof Array||Array.isArray(e)))throw Error("encodings must be an Array");if(!cX(e.length,1,3))throw Error("encodings must be an Array with between 1 to ".concat(3," layers"));for(var r=0;r<e.length;r++){var a=e[r];for(var n in this._validateEncodingLayerHasValidProperties(a),a)if(cw.includes(n)){if("number"!=typeof a[n])throw Error("".concat(n," must be a number"));if(t){var i=t[n],o=i.min,l=i.max;if(!cX(a[n],o,l))throw Error("".concat(n," value not in range. valid range: ").concat(o," to ").concat(l))}}else if(!["active","scalabilityMode"].includes(n))throw Error("Invalid key ".concat(n,", valid keys are:")+Object.values(cw));if(s&&!a.hasOwnProperty("maxBitrate"))throw Error("maxBitrate is not specified")}}}},{key:"startRemoteMediaPlayer",value:(y=aq(function*(e){var t=this,s=e.url,r=e.settings,a=void 0===r?{state:la.PLAY}:r;try{!function(e){if("string"!=typeof e)throw Error('url parameter must be "string" type')}(s),cY(a),function(e){for(var t in e)if(!cN.includes(t))throw Error("Invalid key ".concat(t,", valid keys are: ").concat(cN));e.simulcastEncodings&&this.validateSimulcastEncodings(e.simulcastEncodings,cj,!0)}(a)}catch(e){throw console.error("invalid argument Error: ".concat(e)),console.error('startRemoteMediaPlayer arguments must be of the form:\n  { url: "playback url",\n  settings?:\n  {state: "play"|"pause", simulcastEncodings?: [{}] } }'),e}return new Promise(function(e,r){t.sendMessageToCallMachine({action:"daily-method-start-remote-media-player",url:s,settings:a},function(t){t.error?r({error:t.error,errorMsg:t.errorMsg}):e({session_id:t.session_id,remoteMediaPlayerState:{state:t.state,settings:t.settings}})})})}),function(e){return y.apply(this,arguments)})},{key:"stopRemoteMediaPlayer",value:(v=aq(function*(e){var t=this;if("string"!=typeof e)throw Error(" remotePlayerID must be of type string");return new Promise(function(s,r){t.sendMessageToCallMachine({action:"daily-method-stop-remote-media-player",session_id:e},function(e){e.error?r({error:e.error,errorMsg:e.errorMsg}):s()})})}),function(e){return v.apply(this,arguments)})},{key:"updateRemoteMediaPlayer",value:(x=aq(function*(e){var t=this,s=e.session_id,r=e.settings;try{cY(r)}catch(e){throw console.error("invalid argument Error: ".concat(e)),console.error('updateRemoteMediaPlayer arguments must be of the form:\n  session_id: "participant session",\n  { settings?: {state: "play"|"pause"} }'),e}return new Promise(function(e,a){t.sendMessageToCallMachine({action:"daily-method-update-remote-media-player",session_id:s,settings:r},function(t){t.error?a({error:t.error,errorMsg:t.errorMsg}):e({session_id:t.session_id,remoteMediaPlayerState:{state:t.state,settings:t.settings}})})})}),function(e){return x.apply(this,arguments)})},{key:"startTranscription",value:function(e){cA(this._callState,"startTranscription()"),this.sendMessageToCallMachine(cm({action:"daily-method-start-transcription"},e))}},{key:"updateTranscription",value:function(e){if(cA(this._callState,"updateTranscription()"),!e)throw Error("updateTranscription Error: options is mandatory");if("object"!==aO(e))throw Error("updateTranscription Error: options must be object type");if(e.participants&&!Array.isArray(e.participants))throw Error("updateTranscription Error: participants must be an array");this.sendMessageToCallMachine(cm({action:"daily-method-update-transcription"},e))}},{key:"stopTranscription",value:function(e){if(cA(this._callState,"stopTranscription()"),e&&"object"!==aO(e))throw Error("stopTranscription Error: options must be object type");if(e&&!e.instanceId)throw Error('"instanceId" not provided');this.sendMessageToCallMachine(cm({action:"daily-method-stop-transcription"},e))}},{key:"startDialOut",value:(f=aq(function*(e){var t=this;cA(this._callState,"startDialOut()");var s=function(e){if(e){if(!Array.isArray(e))throw Error("Error starting dial out: audio codec must be an array");if(e.length<=0)throw Error("Error starting dial out: audio codec array specified but empty");e.forEach(function(e){if("string"!=typeof e)throw Error("Error starting dial out: audio codec must be a string");if("OPUS"!==e&&"PCMU"!==e&&"PCMA"!==e&&"G722"!==e)throw Error("Error starting dial out: audio codec must be one of OPUS, PCMU, PCMA, G722")})}};if(!e.sipUri&&!e.phoneNumber)throw Error("Error starting dial out: either a sip uri or phone number must be provided");if(e.sipUri&&e.phoneNumber)throw Error("Error starting dial out: only one of sip uri or phone number must be provided");if(e.sipUri){if("string"!=typeof e.sipUri)throw Error("Error starting dial out: sipUri must be a string");if(!e.sipUri.startsWith("sip:"))throw Error("Error starting dial out: Invalid SIP URI, must start with 'sip:'");if(e.video&&"boolean"!=typeof e.video)throw Error("Error starting dial out: video must be a boolean value");var r=e.codecs;if(r&&(s(r.audio),r.video)){if(!Array.isArray(r.video))throw Error("Error starting dial out: video codec must be an array");if(r.video.length<=0)throw Error("Error starting dial out: video codec array specified but empty");r.video.forEach(function(e){if("string"!=typeof e)throw Error("Error starting dial out: video codec must be a string");if("H264"!==e&&"VP8"!==e)throw Error("Error starting dial out: video codec must be H264 or VP8")})}}if(e.phoneNumber){if("string"!=typeof e.phoneNumber)throw Error("Error starting dial out: phoneNumber must be a string");if(!/^\+\d{1,}$/.test(e.phoneNumber))throw Error("Error starting dial out: Invalid phone number, must be valid phone number as per E.164");e.codecs&&s(e.codecs.audio)}if(e.callerId){if("string"!=typeof e.callerId)throw Error("Error starting dial out: callerId must be a string");if(e.sipUri)throw Error("Error starting dial out: callerId not allowed with sipUri")}if(e.displayName){if("string"!=typeof e.displayName)throw Error("Error starting dial out: displayName must be a string");if(e.displayName.length>=200)throw Error("Error starting dial out: displayName length must be less than 200")}if(e.userId){if("string"!=typeof e.userId)throw Error("Error starting dial out: userId must be a string");if(e.userId.length>36)throw Error("Error starting dial out: userId length must be less than or equal to 36")}if(cT(e),e.permissions&&e.permissions.canReceive){var a=aJ(cl.validateJSONObject(e.permissions.canReceive),2),n=a[0],i=a[1];if(!n)throw Error(i)}if(e.provider){if("daily"!==e.provider)throw Error("Error: provider can be set only to 'daily', got: ".concat(e.provider));if(e.phoneNumber)throw Error("Error starting dial out: provider valid only for sipUri, not phoneNumber");console.warn("(pre-beta) provider=daily is currently in pre-beta, things might break!")}return new Promise(function(s,r){t.sendMessageToCallMachine(cm({action:"dialout-start"},e),function(e){e.error?r(e.error):s(e)})})}),function(e){return f.apply(this,arguments)})},{key:"stopDialOut",value:function(e){var t=this;return cA(this._callState,"stopDialOut()"),new Promise(function(s,r){t.sendMessageToCallMachine(cm({action:"dialout-stop"},e),function(e){e.error?r(e.error):s(e)})})}},{key:"sipCallTransfer",value:(g=aq(function*(e){var t=this;if(cA(this._callState,"sipCallTransfer()"),!e)throw Error("sipCallTransfer() requires a sessionId and toEndPoint");return e.useSipRefer=!1,cK(e,"sipCallTransfer"),cT(e),new Promise(function(s,r){t.sendMessageToCallMachine(cm({action:li},e),function(e){e.error?r(e.error):s(e)})})}),function(e){return g.apply(this,arguments)})},{key:"sipRefer",value:(p=aq(function*(e){var t=this;if(cA(this._callState,"sipRefer()"),!e)throw Error("sessionId and toEndPoint are mandatory parameter");return e.useSipRefer=!0,cK(e,"sipRefer"),new Promise(function(s,r){t.sendMessageToCallMachine(cm({action:li},e),function(e){e.error?r(e.error):s(e)})})}),function(e){return p.apply(this,arguments)})},{key:"sendDTMF",value:(m=aq(function*(e){var t=this;return cA(this._callState,"sendDTMF()"),function(e){var t=e.sessionId,s=e.tones;if(!t||!s)throw Error("sessionId and tones are mandatory parameter");if("string"!=typeof t||"string"!=typeof s)throw Error("sessionId and tones should be of string type");if(s.length>20)throw Error("tones string must be upto 20 characters");var r=s.match(/[^0-9A-D*#]/g);if(r&&r[0])throw Error("".concat(r[0]," is not valid DTMF tone"))}(e),new Promise(function(s,r){t.sendMessageToCallMachine(cm({action:"send-dtmf"},e),function(e){e.error?r(e.error):s(e)})})}),function(e){return m.apply(this,arguments)})},{key:"getNetworkStats",value:function(){var e=this;return this._callState!==oW?Promise.resolve(cm({stats:{latest:{}}},this._network)):new Promise(function(t){e.sendMessageToCallMachine({action:"get-calc-stats"},function(s){t(cm(cm({},e._network),{},{stats:s.stats}))})})}},{key:"testWebsocketConnectivity",value:(h=aq(function*(){var e=this;if(cL(this._testCallInProgress,"testWebsocketConnectivity()"),this.needsLoad())try{yield this.load()}catch(e){return Promise.reject(e)}return new Promise(function(t,s){e.sendMessageToCallMachine({action:"test-websocket-connectivity"},function(e){e.error?s(e.error):t(e.results)})})}),function(){return h.apply(this,arguments)})},{key:"abortTestWebsocketConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-websocket-connectivity"})}},{key:"_validateVideoTrackForNetworkTests",value:function(e){return e?e instanceof MediaStreamTrack?!!(e&&"live"===e.readyState&&(!e.muted||l7.has(e.id)))||(console.error("Video track is not playable. This test needs a live video track."),!1):(console.error("Video track needs to be of type `MediaStreamTrack`."),!1):(console.error("Missing video track. You must provide a video track in order to run this test."),!1)}},{key:"testCallQuality",value:(u=aq(function*(){var e=this;cB(),cD(this._callObjectMode,"testCallQuality()"),cO(this._callMachineInitialized,"testCallQuality()",null,!0),cI(this._callState,this._isPreparingToJoin,"testCallQuality()");var t=this._testCallAlreadyInProgress,s=function(s){t||(e._testCallInProgress=s)};if(s(!0),this.needsLoad())try{var r=this._callState;yield this.load(),this._callState=r}catch(e){return s(!1),Promise.reject(e)}return new Promise(function(t){e.sendMessageToCallMachine({action:"test-call-quality",dailyJsVersion:e.properties.dailyJsVersion},function(r){var a=r.results,n=a.result,i=aP(a,cd);if("failed"===n){var o,l=cm({},i);null!=(o=i.error)&&o.details?(i.error.details=JSON.parse(i.error.details),l.error=cm(cm({},l.error),{},{details:cm({},l.error.details)}),l.error.details.duringTest="testCallQuality"):(l.error=l.error?cm({},l.error):{},l.error.details={duringTest:"testCallQuality"}),e._maybeSendToSentry(l)}s(!1),t(cm({result:n},i))})})}),function(){return u.apply(this,arguments)})},{key:"stopTestCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-call-quality"})}},{key:"testConnectionQuality",value:(d=aq(function*(e){ll()?(console.warn("testConnectionQuality() is deprecated: use testPeerToPeerCallQuality() instead"),t=yield this.testPeerToPeerCallQuality(e)):(console.warn("testConnectionQuality() is deprecated: use testCallQuality() instead"),t=yield this.testCallQuality());var t,s={result:t.result,secondsElapsed:t.secondsElapsed};return t.data&&(s.data={maxRTT:t.data.maxRoundTripTime,packetLoss:t.data.avgRecvPacketLoss}),s}),function(e){return d.apply(this,arguments)})},{key:"testPeerToPeerCallQuality",value:(c=aq(function*(e){var t=this;if(cL(this._testCallInProgress,"testPeerToPeerCallQuality()"),this.needsLoad())try{yield this.load()}catch(e){return Promise.reject(e)}var s=e.videoTrack,r=e.duration;if(!this._validateVideoTrackForNetworkTests(s))throw Error("Video track error");return this._sharedTracks.videoTrackForConnectionQualityTest=s,new Promise(function(e,s){t.sendMessageToCallMachine({action:"test-p2p-call-quality",duration:r},function(t){t.error?s(t.error):e(t.results)})})}),function(e){return c.apply(this,arguments)})},{key:"stopTestConnectionQuality",value:function(){ll()?(console.warn("stopTestConnectionQuality() is deprecated: use testPeerToPeerCallQuality() and stopTestPeerToPeerCallQuality() instead"),this.stopTestPeerToPeerCallQuality()):(console.warn("stopTestConnectionQuality() is deprecated: use testCallQuality() and stopTestCallQuality() instead"),this.stopTestCallQuality())}},{key:"stopTestPeerToPeerCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-p2p-call-quality"})}},{key:"testNetworkConnectivity",value:(l=aq(function*(e){var t=this;if(cL(this._testCallInProgress,"testNetworkConnectivity()"),this.needsLoad())try{yield this.load()}catch(e){return Promise.reject(e)}if(!this._validateVideoTrackForNetworkTests(e))throw Error("Video track error");return this._sharedTracks.videoTrackForNetworkConnectivityTest=e,new Promise(function(e,s){t.sendMessageToCallMachine({action:"test-network-connectivity"},function(t){t.error?s(t.error):e(t.results)})})}),function(e){return l.apply(this,arguments)})},{key:"abortTestNetworkConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-network-connectivity"})}},{key:"getCpuLoadStats",value:function(){var e=this;return new Promise(function(t){e._callState===oW?e.sendMessageToCallMachine({action:"get-cpu-load-stats"},function(e){t(e.cpuStats)}):t({cpuLoadState:void 0,cpuLoadStateReason:void 0,stats:{}})})}},{key:"_validateEncodingLayerHasValidProperties",value:function(e){var t;if(!((null==(t=Object.keys(e))?void 0:t.length)>0))throw Error("Empty encoding is not allowed. At least one of these valid keys should be specified:"+Object.values(cw))}},{key:"_validateVideoSendSettings",value:function(e,t){var s="screenVideo"===e?["default-screen-video","detail-optimized","motion-optimized","motion-and-detail-balanced"]:["default-video","bandwidth-optimized","bandwidth-and-quality-balanced","quality-optimized","adaptive-2-layers","adaptive-3-layers"],r="Video send settings should be either an object or one of the supported presets: ".concat(s.join());if("string"==typeof t){if(!s.includes(t))throw Error(r)}else{if("object"!==aO(t))throw Error(r);if(!t.maxQuality&&!t.encodings&&void 0===t.allowAdaptiveLayers)throw Error("Video send settings must contain at least maxQuality, allowAdaptiveLayers or encodings attribute");if(t.maxQuality&&-1===["low","medium","high"].indexOf(t.maxQuality))throw Error("maxQuality must be either low, medium or high");if(t.encodings){var a=!1;switch(Object.keys(t.encodings).length){case 1:a=!t.encodings.low;break;case 2:a=!t.encodings.low||!t.encodings.medium;break;case 3:a=!t.encodings.low||!t.encodings.medium||!t.encodings.high;break;default:a=!0}if(a)throw Error("Encodings must be defined as: low, low and medium, or low, medium and high.");t.encodings.low&&this._validateEncodingLayerHasValidProperties(t.encodings.low),t.encodings.medium&&this._validateEncodingLayerHasValidProperties(t.encodings.medium),t.encodings.high&&this._validateEncodingLayerHasValidProperties(t.encodings.high)}}}},{key:"validateUpdateSendSettings",value:function(e){var t=this;if(!e||0===Object.keys(e).length)throw Error("Send settings must contain at least information for one track!");Object.entries(e).forEach(function(e){var s=aJ(e,2),r=s[0],a=s[1];t._validateVideoSendSettings(r,a)})}},{key:"updateSendSettings",value:function(e){var t=this;return this.validateUpdateSendSettings(e),this.needsLoad()?(this._preloadCache.sendSettings=e,{sendSettings:this._preloadCache.sendSettings}):new Promise(function(s,r){t.sendMessageToCallMachine({action:"update-send-settings",sendSettings:e},function(e){e.error?r(e.error):s(e.sendSettings)})})}},{key:"getSendSettings",value:function(){return this._sendSettings||this._preloadCache.sendSettings}},{key:"getLocalAudioLevel",value:function(){return this._localAudioLevel}},{key:"getRemoteParticipantsAudioLevel",value:function(){return this._remoteParticipantsAudioLevel}},{key:"getActiveSpeaker",value:function(){return cB(),this._activeSpeaker}},{key:"setActiveSpeakerMode",value:function(e){return cB(),this.sendMessageToCallMachine({action:"set-active-speaker-mode",enabled:e}),this}},{key:"activeSpeakerMode",value:function(){return cB(),this._activeSpeakerMode}},{key:"subscribeToTracksAutomatically",value:function(){return this._preloadCache.subscribeToTracksAutomatically}},{key:"setSubscribeToTracksAutomatically",value:function(e){return cA(this._callState,"setSubscribeToTracksAutomatically()","Use the subscribeToTracksAutomatically configuration property."),this._preloadCache.subscribeToTracksAutomatically=e,this.sendMessageToCallMachine({action:"daily-method-subscribe-to-tracks-automatically",enabled:e}),this}},{key:"enumerateDevices",value:(o=aq(function*(){var e=this;if(this._callObjectMode){var t=yield navigator.mediaDevices.enumerateDevices();return"Firefox"===lv()&&ly().major>115&&ly().major<123&&(t=t.filter(function(e){return"audiooutput"!==e.kind})),{devices:t.map(function(e){var t=JSON.parse(JSON.stringify(e));if(!ll()&&"videoinput"===e.kind&&e.getCapabilities){var s,r=e.getCapabilities();t.facing=(null==r||null==(s=r.facingMode)?void 0:s.length)>=1?r.facingMode[0]:void 0}return t})}}return new Promise(function(t){e.sendMessageToCallMachine({action:"enumerate-devices"},function(e){t({devices:e.devices})})})}),function(){return o.apply(this,arguments)})},{key:"sendAppMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*";if(cA(this._callState,"sendAppMessage()"),JSON.stringify(e).length>this._maxAppMessageSize)throw Error("Message data too large. Max size is "+this._maxAppMessageSize);return this.sendMessageToCallMachine({action:"app-msg",data:e,to:t}),this}},{key:"addFakeParticipant",value:function(e){return cB(),cA(this._callState,"addFakeParticipant()"),this.sendMessageToCallMachine(cm({action:"add-fake-participant"},e)),this}},{key:"setShowNamesMode",value:function(e){return cR(this._callObjectMode,"setShowNamesMode()"),cB(),e&&"always"!==e&&"never"!==e?console.error('setShowNamesMode argument should be "always", "never", or false'):this.sendMessageToCallMachine({action:"set-show-names",mode:e}),this}},{key:"setShowLocalVideo",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return cR(this._callObjectMode,"setShowLocalVideo()"),cB(),cA(this._callState,"setShowLocalVideo()"),"boolean"!=typeof e?console.error("setShowLocalVideo only accepts a boolean value"):(this.sendMessageToCallMachine({action:"set-show-local-video",show:e}),this._showLocalVideo=e),this}},{key:"showLocalVideo",value:function(){return cR(this._callObjectMode,"showLocalVideo()"),cB(),this._showLocalVideo}},{key:"setShowParticipantsBar",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return cR(this._callObjectMode,"setShowParticipantsBar()"),cB(),cA(this._callState,"setShowParticipantsBar()"),"boolean"!=typeof e?console.error("setShowParticipantsBar only accepts a boolean value"):(this.sendMessageToCallMachine({action:"set-show-participants-bar",show:e}),this._showParticipantsBar=e),this}},{key:"showParticipantsBar",value:function(){return cR(this._callObjectMode,"showParticipantsBar()"),cB(),this._showParticipantsBar}},{key:"customIntegrations",value:function(){return cB(),cR(this._callObjectMode,"customIntegrations()"),this._customIntegrations}},{key:"setCustomIntegrations",value:function(e){return cB(),cR(this._callObjectMode,"setCustomIntegrations()"),cA(this._callState,"setCustomIntegrations()"),cQ(e)&&(this.sendMessageToCallMachine({action:"set-custom-integrations",integrations:e}),this._customIntegrations=e),this}},{key:"startCustomIntegrations",value:function(e){var t=this;if(cB(),cR(this._callObjectMode,"startCustomIntegrations()"),cA(this._callState,"startCustomIntegrations()"),Array.isArray(e)&&e.some(function(e){return"string"!=typeof e})||!Array.isArray(e)&&"string"!=typeof e)return console.error("startCustomIntegrations() only accepts string | string[]"),this;var s="string"==typeof e?[e]:e,r=s.filter(function(e){return!(e in t._customIntegrations)});return r.length?console.error("Can't find custom integration(s): \"".concat(r.join(", "),'"')):this.sendMessageToCallMachine({action:"start-custom-integrations",ids:s}),this}},{key:"stopCustomIntegrations",value:function(e){var t=this;if(cB(),cR(this._callObjectMode,"stopCustomIntegrations()"),cA(this._callState,"stopCustomIntegrations()"),Array.isArray(e)&&e.some(function(e){return"string"!=typeof e})||!Array.isArray(e)&&"string"!=typeof e)return console.error("stopCustomIntegrations() only accepts string | string[]"),this;var s="string"==typeof e?[e]:e,r=s.filter(function(e){return!(e in t._customIntegrations)});return r.length?console.error("Can't find custom integration(s): \"".concat(r.join(", "),'"')):this.sendMessageToCallMachine({action:"stop-custom-integrations",ids:s}),this}},{key:"customTrayButtons",value:function(){return cR(this._callObjectMode,"customTrayButtons()"),cB(),this._customTrayButtons}},{key:"updateCustomTrayButtons",value:function(e){return cR(this._callObjectMode,"updateCustomTrayButtons()"),cB(),cA(this._callState,"updateCustomTrayButtons()"),cW(e)?(this.sendMessageToCallMachine({action:"update-custom-tray-buttons",btns:e}),this._customTrayButtons=e):console.error("updateCustomTrayButtons only accepts a dictionary of the type ".concat(JSON.stringify(cS))),this}},{key:"theme",value:function(){return cR(this._callObjectMode,"theme()"),this.properties.theme}},{key:"setTheme",value:function(e){var t=this;return cR(this._callObjectMode,"setTheme()"),new Promise(function(s,r){try{t.validateProperties({theme:e}),t.properties.theme=cm({},e),t.sendMessageToCallMachine({action:"set-theme",theme:t.properties.theme});try{t.emitDailyJSEvent({action:"theme-updated",theme:t.properties.theme})}catch(e){console.log("could not emit 'theme-updated'",e)}s(t.properties.theme)}catch(e){r(e)}})}},{key:"requestFullscreen",value:(n=aq(function*(){if(cB(),this._iframe&&!document.fullscreenElement&&ld())try{(yield this._iframe.requestFullscreen)?this._iframe.requestFullscreen():this._iframe.webkitRequestFullscreen()}catch(e){console.log("could not make video call fullscreen",e)}}),function(){return n.apply(this,arguments)})},{key:"exitFullscreen",value:function(){cB(),document.fullscreenElement?document.exitFullscreen():document.webkitFullscreenElement&&document.webkitExitFullscreen()}},{key:"getSidebarView",value:(a=aq(function*(){var e=this;return this._callObjectMode?(console.error("getSidebarView is not available in callObject mode"),Promise.resolve(null)):new Promise(function(t){e.sendMessageToCallMachine({action:"get-sidebar-view"},function(e){t(e.view)})})}),function(){return a.apply(this,arguments)})},{key:"setSidebarView",value:function(e){return this._callObjectMode?console.error("setSidebarView is not available in callObject mode"):this.sendMessageToCallMachine({action:"set-sidebar-view",view:e}),this}},{key:"room",value:(r=aq(function*(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeRoomConfigDefaults,s=void 0===t||t;return this._accessState.access===oY||this.needsLoad()?this.properties.url?{roomUrlPendingJoin:this.properties.url}:null:new Promise(function(t){e.sendMessageToCallMachine({action:"lib-room-info",includeRoomConfigDefaults:s},function(e){delete e.action,delete e.callbackStamp,t(e)})})}),function(){return r.apply(this,arguments)})},{key:"geo",value:(s=aq(function*(){try{var e=yield fetch("https://gs.daily.co/_ks_/x-swsl/:");return{current:(yield e.json()).geo}}catch(e){return console.error("geo lookup failed",e),{current:""}}}),function(){return s.apply(this,arguments)})},{key:"setNetworkTopology",value:(t=aq(function*(e){var t=this;return cB(),cA(this._callState,"setNetworkTopology()"),new Promise(function(s,r){t.sendMessageToCallMachine({action:"set-network-topology",opts:e},function(e){e.error?r({error:e.error}):s({workerId:e.workerId})})})}),function(e){return t.apply(this,arguments)})},{key:"getNetworkTopology",value:(e=aq(function*(){var e=this;return new Promise(function(t,s){e.needsLoad()&&t({topology:"none"}),e.sendMessageToCallMachine({action:"get-network-topology"},function(e){e.error?s({error:e.error}):t({topology:e.topology})})})}),function(){return e.apply(this,arguments)})},{key:"setPlayNewParticipantSound",value:function(e){if(cB(),"number"!=typeof e&&!0!==e&&!1!==e)throw Error("argument to setShouldPlayNewParticipantSound should be true, false, or a number, but is ".concat(e));this.sendMessageToCallMachine({action:"daily-method-set-play-ding",arg:e})}},{key:"on",value:function(e,t){return aK.prototype.on.call(this,e,t)}},{key:"once",value:function(e,t){return aK.prototype.once.call(this,e,t)}},{key:"off",value:function(e,t){return aK.prototype.off.call(this,e,t)}},{key:"validateProperties",value:function(e){var t,s;if(null!=e&&null!=(t=e.dailyConfig)&&t.userMediaAudioConstraints){ll()||console.warn("userMediaAudioConstraints is deprecated. You can override constraints with inputSettings.audio.settings, found in DailyCallOptions.");var r,a,n=e.inputSettings||{};n.audio=(null==(r=e.inputSettings)?void 0:r.audio)||{},n.audio.settings=(null==(a=e.inputSettings)||null==(a=a.audio)?void 0:a.settings)||{},n.audio.settings=cm(cm({},n.audio.settings),e.dailyConfig.userMediaAudioConstraints),e.inputSettings=n,delete e.dailyConfig.userMediaAudioConstraints}if(null!=e&&null!=(s=e.dailyConfig)&&s.userMediaVideoConstraints){ll()||console.warn("userMediaVideoConstraints is deprecated. You can override constraints with inputSettings.video.settings, found in DailyCallOptions.");var i,o,l=e.inputSettings||{};l.video=(null==(i=e.inputSettings)?void 0:i.video)||{},l.video.settings=(null==(o=e.inputSettings)||null==(o=o.video)?void 0:o.settings)||{},l.video.settings=cm(cm({},l.video.settings),e.dailyConfig.userMediaVideoConstraints),e.inputSettings=l,delete e.dailyConfig.userMediaVideoConstraints}for(var c in e)if(cC[c]){if(cC[c].validate&&!cC[c].validate(e[c],this))throw Error("property '".concat(c,"': ").concat(cC[c].help))}else console.warn("Ignoring unrecognized property '".concat(c,"'")),delete e[c]}},{key:"assembleMeetingUrl",value:function(){var e,t,s=cm(cm({},this.properties),{},{emb:this.callClientId,embHref:encodeURIComponent(window.location.href),proxy:null!=(e=this.properties.dailyConfig)&&e.proxyUrl?encodeURIComponent(null==(t=this.properties.dailyConfig)?void 0:t.proxyUrl):void 0}),r=s.url.match(/\?/)?"&":"?";return s.url+r+Object.keys(cC).filter(function(e){return cC[e].queryString&&void 0!==s[e]}).map(function(e){return"".concat(cC[e].queryString,"=").concat(s[e])}).join("&")}},{key:"needsLoad",value:function(){return["new",oH,oQ,oK].includes(this._callState)}},{key:"sendMessageToCallMachine",value:function(e,t){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw Error("Use after destroy");this._messageChannel.sendMessageToCallMachine(e,t,this.callClientId,this._iframe)}},{key:"forwardPackagedMessageToCallMachine",value:function(e){this._messageChannel.forwardPackagedMessageToCallMachine(e,this._iframe,this.callClientId)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(e){return this._messageChannel.addListenerForPackagedMessagesFromCallMachine(e,this.callClientId)}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(e){this._messageChannel.removeListenerForPackagedMessagesFromCallMachine(e)}},{key:"handleMessageFromCallMachine",value:function(e){switch(e.action){case"iframe-ready-for-launch-config":this.sendMessageToCallMachine(cm({action:"iframe-launch-config"},this.properties));break;case"call-machine-initialized":this._callMachineInitialized=!0;var t={action:le,level:"log",code:1011,stats:{event:"bundle load",time:"no-op"===this._bundleLoadTime?0:this._bundleLoadTime,preLoaded:"no-op"===this._bundleLoadTime,url:ni(this.properties.dailyConfig)}};this.sendMessageToCallMachine(t),this._delayDuplicateInstanceLog&&this._logDuplicateInstanceAttempt();break;case oZ:this._loadedCallback&&(this._loadedCallback(),this._loadedCallback=null),this.emitDailyJSEvent(e);break;case"joined-meeting":var s,r=cm({},e);delete r.internal,this._maxAppMessageSize=(null==(s=e.internal)?void 0:s._maxAppMessageSize)||4096,this._joinedCallback&&(this._joinedCallback(e.participants),this._joinedCallback=null),this.emitDailyJSEvent(r);break;case"participant-joined":case"participant-updated":if(this._callState===oQ)return;if(e.participant&&e.participant.session_id){var a=e.participant.local?"local":e.participant.session_id;if(this._callObjectMode){var n=this._callMachine().store;lX(e.participant,n),lZ(e.participant,n),l0(e.participant,this._participants[a],n)}try{this.maybeParticipantTracksStopped(this._participants[a],e.participant),this.maybeParticipantTracksStarted(this._participants[a],e.participant),this.maybeEventRecordingStopped(this._participants[a],e.participant),this.maybeEventRecordingStarted(this._participants[a],e.participant)}catch(e){console.error("track events error",e)}this.compareEqualForParticipantUpdateEvent(e.participant,this._participants[a])||(this._participants[a]=cm({},e.participant),this.toggleParticipantAudioBasedOnNativeAudioFocus(),this.emitDailyJSEvent(e))}break;case"participant-left":if(e.participant&&e.participant.session_id){var i=this._participants[e.participant.session_id];i&&this.maybeParticipantTracksStopped(i,null),delete this._participants[e.participant.session_id],this.emitDailyJSEvent(e)}break;case"participant-counts-updated":aZ(this._participantCounts,e.participantCounts)||(this._participantCounts=e.participantCounts,this.emitDailyJSEvent(e));break;case"access-state-updated":var o={access:e.access};e.awaitingAccess&&(o.awaitingAccess=e.awaitingAccess),aZ(this._accessState,o)||(this._accessState=o,this.emitDailyJSEvent(e));break;case"meeting-session-summary-updated":if(e.meetingSession){this._meetingSessionSummary=e.meetingSession,this.emitDailyJSEvent(e);var l=cm(cm({},e),{},{action:"meeting-session-updated"});this.emitDailyJSEvent(l)}break;case o6:this._iframe&&!e.preserveIframe&&(this._iframe.src=""),this._updateCallState(oK),this.resetMeetingDependentVars(),this._loadedCallback&&(this._loadedCallback(e.errorMsg),this._loadedCallback=null),e.preserveIframe;var c,d=aP(e,cu);null!=d&&null!=(c=d.error)&&c.details&&(d.error.details=JSON.parse(d.error.details)),this._maybeSendToSentry(e),this._joinedCallback&&(this._joinedCallback(null,d),this._joinedCallback=null),this.emitDailyJSEvent(d);break;case"left-meeting":this._callState!==oK&&this._updateCallState(oQ),this.resetMeetingDependentVars(),this._resolveLeave&&(this._resolveLeave(),this._resolveLeave=null),this.emitDailyJSEvent(e);break;case"selected-devices-updated":e.devices&&this.emitDailyJSEvent(e);break;case"network-quality-change":var u=e.state,h=e.threshold,m=e.quality,p=u.state,g=u.reasons;p===this._network.networkState&&aZ(g,this._network.networkStateReasons)&&h===this._network.threshold&&m===this._network.quality||(this._network.networkState=p,this._network.networkStateReasons=g,this._network.quality=m,this._network.threshold=h,e.networkState=p,g.length&&(e.networkStateReasons=g),delete e.state,this.emitDailyJSEvent(e));break;case"cpu-load-change":e&&e.cpuLoadState&&this.emitDailyJSEvent(e);break;case"face-counts-updated":e&&void 0!==e.faceCounts&&this.emitDailyJSEvent(e);break;case"active-speaker-change":var f=e.activeSpeaker;this._activeSpeaker.peerId!==f.peerId&&(this._activeSpeaker.peerId=f.peerId,this.emitDailyJSEvent({action:e.action,activeSpeaker:this._activeSpeaker}));break;case"show-local-video-changed":if(this._callObjectMode)return;var x=e.show;this._showLocalVideo=x,this.emitDailyJSEvent({action:e.action,show:x});break;case"active-speaker-mode-change":var v=e.enabled;this._activeSpeakerMode!==v&&(this._activeSpeakerMode=v,this.emitDailyJSEvent({action:e.action,enabled:this._activeSpeakerMode}));break;case"waiting-participant-added":case"waiting-participant-updated":case"waiting-participant-removed":this._waitingParticipants=e.allWaitingParticipants,this.emitDailyJSEvent({action:e.action,participant:e.participant});break;case"receive-settings-updated":aZ(this._receiveSettings,e.receiveSettings)||(this._receiveSettings=e.receiveSettings,this.emitDailyJSEvent({action:e.action,receiveSettings:e.receiveSettings}));break;case o5:this._maybeUpdateInputSettings(e.inputSettings);break;case"send-settings-updated":aZ(this._sendSettings,e.sendSettings)||(this._sendSettings=e.sendSettings,this._preloadCache.sendSettings=null,this.emitDailyJSEvent({action:e.action,sendSettings:e.sendSettings}));break;case"local-audio-level":this._localAudioLevel=e.audioLevel,this._preloadCache.localAudioLevelObserver=null,this.emitDailyJSEvent(e);break;case"remote-participants-audio-level":this._remoteParticipantsAudioLevel=e.participantsAudioLevel,this._preloadCache.remoteParticipantsAudioLevelObserver=null,this.emitDailyJSEvent(e);break;case"remote-media-player-started":var y=e.session_id;this._rmpPlayerState[y]=e.playerState,this.emitDailyJSEvent(e);break;case"remote-media-player-stopped":delete this._rmpPlayerState[e.session_id],this.emitDailyJSEvent(e);break;case"remote-media-player-updated":var b=e.session_id,j=this._rmpPlayerState[b];j&&this.compareEqualForRMPUpdateEvent(j,e.remoteMediaPlayerState)||(this._rmpPlayerState[b]=e.remoteMediaPlayerState,this.emitDailyJSEvent(e));break;case"custom-button-click":case"sidebar-view-changed":case"pip-started":case"pip-stopped":this.emitDailyJSEvent(e);break;case"meeting-session-state-updated":var w=this._meetingSessionState.topology!==(e.meetingSessionState&&e.meetingSessionState.topology);this._meetingSessionState=cZ(e.meetingSessionState,this._callObjectMode),(this._callObjectMode||w)&&this.emitDailyJSEvent(e);break;case"local-screen-share-started":this._isScreenSharing=!0,this.emitDailyJSEvent(e);break;case"local-screen-share-stopped":case"local-screen-share-canceled":this._isScreenSharing=!1,this.emitDailyJSEvent(e);break;case o0:case o1:case"recording-stats":case"recording-error":case"recording-upload-completed":case"transcription-started":case"transcription-stopped":case"transcription-error":case"started-camera":case"camera-error":case"app-message":case"transcription-message":case"test-completed":case"network-connection":case"recording-data":case"live-streaming-started":case"live-streaming-updated":case"live-streaming-stopped":case"live-streaming-error":case o3:case"lang-updated":case"dialin-ready":case"dialin-connected":case"dialin-error":case"dialin-stopped":case"dialin-warning":case"dialout-connected":case"dialout-answered":case"dialout-error":case"dialout-stopped":case"dialout-warning":this.emitDailyJSEvent(e);break;case"request-fullscreen":this.requestFullscreen();break;case"request-exit-fullscreen":this.exitFullscreen()}}},{key:"maybeEventRecordingStopped",value:function(e,t){var s="record";e&&(t.local||!1!==t[s]||e[s]===t[s]||this.emitDailyJSEvent({action:o1}))}},{key:"maybeEventRecordingStarted",value:function(e,t){var s="record";e&&(t.local||!0!==t[s]||e[s]===t[s]||this.emitDailyJSEvent({action:o0}))}},{key:"_trackStatePlayable",value:function(e){return!(!e||"playable"!==e.state)}},{key:"_trackChanged",value:function(e,t){return(null==e?void 0:e.id)!==(null==t?void 0:t.id)}},{key:"maybeEventTrackStopped",value:function(e,t,s){var r,a,n=null!=(r=null==t?void 0:t.tracks[e])?r:null,i=null!=(a=null==s?void 0:s.tracks[e])?a:null,o=null==n?void 0:n.track;if(o){var l=this._trackStatePlayable(n),c=this._trackStatePlayable(i),d=this._trackChanged(o,null==i?void 0:i.track);l&&(c&&!d||this.emitDailyJSEvent({action:"track-stopped",track:o,participant:null!=s?s:t,type:e}))}}},{key:"maybeEventTrackStarted",value:function(e,t,s){var r,a,n=null!=(r=null==t?void 0:t.tracks[e])?r:null,i=null!=(a=null==s?void 0:s.tracks[e])?a:null,o=null==i?void 0:i.track;if(o){var l=this._trackStatePlayable(n),c=this._trackStatePlayable(i),d=this._trackChanged(null==n?void 0:n.track,o);c&&(l&&!d||this.emitDailyJSEvent({action:"track-started",track:o,participant:s,type:e}))}}},{key:"maybeParticipantTracksStopped",value:function(e,t){if(e)for(var s in e.tracks)this.maybeEventTrackStopped(s,e,t)}},{key:"maybeParticipantTracksStarted",value:function(e,t){if(t)for(var s in t.tracks)this.maybeEventTrackStarted(s,e,t)}},{key:"compareEqualForRMPUpdateEvent",value:function(e,t){var s,r;return e.state===t.state&&(null==(s=e.settings)?void 0:s.volume)===(null==(r=t.settings)?void 0:r.volume)}},{key:"emitDailyJSEvent",value:function(e){try{e.callClientId=this.callClientId,this.emit(e.action,e)}catch(t){console.log("could not emit",e,t)}}},{key:"compareEqualForParticipantUpdateEvent",value:function(e,t){return!!aZ(e,t)&&(!e.videoTrack||!t.videoTrack||e.videoTrack.id===t.videoTrack.id&&e.videoTrack.muted===t.videoTrack.muted&&e.videoTrack.enabled===t.videoTrack.enabled)&&(!e.audioTrack||!t.audioTrack||e.audioTrack.id===t.audioTrack.id&&e.audioTrack.muted===t.audioTrack.muted&&e.audioTrack.enabled===t.audioTrack.enabled)}},{key:"nativeUtils",value:function(){return ll()?"u"<typeof DailyNativeUtils?(console.warn("in React Native, DailyNativeUtils is expected to be available"),null):DailyNativeUtils:null}},{key:"updateIsPreparingToJoin",value:function(e){this._updateCallState(this._callState,e)}},{key:"_updateCallState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._isPreparingToJoin;if(e!==this._callState||t!==this._isPreparingToJoin){var s=this._callState,r=this._isPreparingToJoin;this._callState=e,this._isPreparingToJoin=t;var a=this._callState===oW;this.updateShowAndroidOngoingMeetingNotification(a);var n=cP(s,r),i=cP(this._callState,this._isPreparingToJoin);n!==i&&(this.updateKeepDeviceAwake(i),this.updateDeviceAudioMode(i),this.updateNoOpRecordingEnsuringBackgroundContinuity(i))}}},{key:"resetMeetingDependentVars",value:function(){this._participants={},this._participantCounts=cb,this._waitingParticipants={},this._activeSpeaker={},this._activeSpeakerMode=!1,this._didPreAuth=!1,this._accessState={access:oY},this._finalSummaryOfPrevSession=this._meetingSessionSummary,this._meetingSessionSummary={},this._meetingSessionState=cZ(cy,this._callObjectMode),this._isScreenSharing=!1,this._receiveSettings={},this._inputSettings=void 0,this._sendSettings={},this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this._maxAppMessageSize=4096,this._callMachineInitialized=!1,this._bundleLoadTime=void 0,this._preloadCache}},{key:"updateKeepDeviceAwake",value:function(e){ll()&&this.nativeUtils().setKeepDeviceAwake(e,this.callClientId)}},{key:"updateDeviceAudioMode",value:function(e){if(ll()&&!this.disableReactNativeAutoDeviceManagement("audio")){var t=e?this._nativeInCallAudioMode:"idle";this.nativeUtils().setAudioMode(t)}}},{key:"updateShowAndroidOngoingMeetingNotification",value:function(e){if(ll()&&this.nativeUtils().setShowOngoingMeetingNotification){var t,s,r,a;if(this.properties.reactNativeConfig&&this.properties.reactNativeConfig.androidInCallNotification){var n=this.properties.reactNativeConfig.androidInCallNotification;t=n.title,s=n.subtitle,r=n.iconName,a=n.disableForCustomOverride}a&&(e=!1),this.nativeUtils().setShowOngoingMeetingNotification(e,t,s,r,this.callClientId)}}},{key:"updateNoOpRecordingEnsuringBackgroundContinuity",value:function(e){ll()&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity(e)}},{key:"toggleParticipantAudioBasedOnNativeAudioFocus",value:function(){var e;if(ll()){var t=null==(e=this._callMachine())||null==(e=e.store)?void 0:e.getState();for(var s in null==t?void 0:t.streams){var r=t.streams[s];r&&r.pendingTrack&&"audio"===r.pendingTrack.kind&&(r.pendingTrack.enabled=this._hasNativeAudioFocus)}}}},{key:"disableReactNativeAutoDeviceManagement",value:function(e){return this.properties.reactNativeConfig&&this.properties.reactNativeConfig.disableAutoDeviceManagement&&this.properties.reactNativeConfig.disableAutoDeviceManagement[e]}},{key:"absoluteUrl",value:function(e){if(void 0!==e){var t=document.createElement("a");return t.href=e,t.href}}},{key:"sayHello",value:function(){var e="hello, world.";return console.log(e),e}},{key:"_logUseAfterDestroy",value:function(){var e=Object.values(cx)[0];if(this.needsLoad())if(e&&!e.needsLoad()){var t={action:le,level:"error",code:this.strictMode?9995:9997};e.sendMessageToCallMachine(t)}else this.strictMode||console.error("You are are attempting to use a call instance that was previously destroyed, which is unsupported. Please remove `strictMode: false` from your constructor properties to enable strict mode to track down and fix this unsupported usage.");else{var s={action:le,level:"error",code:this.strictMode?9995:9997};this._messageChannel.sendMessageToCallMachine(s,null,this.callClientId,this._iframe)}}},{key:"_logDuplicateInstanceAttempt",value:function(){for(var e=0,t=Object.values(cx);e<t.length;e++){var s=t[e];s._callMachineInitialized?(s.sendMessageToCallMachine({action:le,level:"warn",code:this.allowMultipleCallInstances?9993:9992}),s._delayDuplicateInstanceLog=!1):s._delayDuplicateInstanceLog=!0}}},{key:"_maybeSendToSentry",value:function(e){let t,s;if(!(null!=(o=e.error)&&o.type&&(!["connection-error","end-of-life",oX].includes(e.error.type)||e.error.type===oX&&e.error.msg.includes("deleted")))){var r=null!=(l=this.properties)&&l.url?new URL(this.properties.url):void 0,a="production";r&&r.host.includes(".staging.daily")&&(a="staging");var n,o,l,c,d,u,h,m,p,g,f=new ob({dsn:"https://f10f1c81e5d44a4098416c0867a8b740@o77906.ingest.sentry.io/168844",transport:oT,stackParser:oD,integrations:(n={},s=[((e={})=>({name:"InboundFilters",processEvent:(t,s,r)=>!function(e,t){var s;return t.ignoreInternal&&function(e){try{return"SentryError"===e.exception.values[0].type}catch(e){}return!1}(e)?(nl&&nf.warn(`Event dropped due to being internal Sentry Error.
Event: ${n9(e)}`),!0):(s=t.ignoreErrors,!e.type&&s&&s.length&&(function(e){let t,s=[];e.message&&s.push(e.message);try{t=e.exception.values[e.exception.values.length-1]}catch(e){}return t&&t.value&&(s.push(t.value),t.type&&s.push(`${t.type}: ${t.value}`)),s})(e).some(e=>nK(e,s)))?(nl&&nf.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${n9(e)}`),!0):e.type||!e.exception||!e.exception.values||0===e.exception.values.length||e.message||e.exception.values.some(e=>e.stacktrace||e.type&&"Error"!==e.type||e.value)?!function(e,t){if("transaction"!==e.type||!t||!t.length)return!1;let s=e.transaction;return!!s&&nK(s,t)}(e,t.ignoreTransactions)?!function(e,t){if(!t||!t.length)return!1;let s=i7(e);return!!s&&nK(s,t)}(e,t.denyUrls)?!function(e,t){if(!t||!t.length)return!0;let s=i7(e);return!s||nK(s,t)}(e,t.allowUrls)&&(nl&&nf.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${n9(e)}.
Url: ${i7(e)}`),!0):(nl&&nf.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${n9(e)}.
Url: ${i7(e)}`),!0):(nl&&nf.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${n9(e)}`),!0):(nl&&nf.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${n9(e)}`),!0)}(t,function(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:i8],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[]],ignoreInternal:void 0===e.ignoreInternal||e.ignoreInternal}}(e,r.getOptions()))?t:null}))(),{name:"FunctionToString",setupOnce(){i=Function.prototype.toString;try{Function.prototype.toString=function(...e){let t=n0(this),s=i6.has(iN())&&void 0!==t?t:this;return i.apply(s,e)}}catch(e){}},setup(e){i6.set(e,!0)}},((e={})=>{let t={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e};return{name:"BrowserApiErrors",setupOnce(){t.setTimeout&&nY(nd,"setTimeout",oF),t.setInterval&&nY(nd,"setInterval",oF),t.requestAnimationFrame&&nY(nd,"requestAnimationFrame",oz),t.XMLHttpRequest&&"XMLHttpRequest"in nd&&nY(XMLHttpRequest.prototype,"send",o$);let e=t.eventTarget;e&&(Array.isArray(e)?e:oB).forEach(oV)}}})(),((e={})=>{let t={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e};return{name:"Breadcrumbs",setup(e){var s;let r,a;t.console&&(nS(r="console",function(t){var s;if(iN()!==e)return;let r={category:"console",data:{arguments:t.args,logger:"console"},level:"warn"===(s=t.level)?"warning":["fatal","error","warning","log","info","debug"].includes(s)?s:"log",message:nQ(t.args," ")};if("assert"===t.level){if(!1!==t.args[0])return;r.message=`Assertion failed: ${nQ(t.args.slice(1)," ")||"console.assert"}`,r.data.arguments=t.args.slice(1)}i3(r,{input:t.args,level:t.level})}),n_(r,os)),t.dom&&(s=t.dom,nS("dom",function(t){if(iN()!==e)return;let r,a,n="object"==typeof s?s.serializeAttribute:void 0,i="object"==typeof s&&"number"==typeof s.maxStringLength?s.maxStringLength:void 0;i&&i>1024&&(oh&&nf.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${i} was configured. Sentry will use 1024 instead.`),i=1024),"string"==typeof n&&(n=[n]);try{let e=t.event,s=e&&e.target?e.target:e;r=nG(s,{keyAttrs:n,maxStringLength:i}),a=function(e){if(!nd.HTMLElement)return null;let t=e;for(let e=0;e<5&&t;e++){if(t instanceof HTMLElement){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}t=t.parentNode}return null}(s)}catch(e){r="<unknown>"}if(0===r.length)return;let o={category:`ui.${t.name}`,message:r};a&&(o.data={"ui.component_name":a}),i3(o,{event:t.event,name:t.name,global:t.global})}),n_("dom",ow)),t.xhr&&(nS("xhr",function(t){if(iN()!==e)return;let{startTimestamp:s,endTimestamp:r}=t,a=t.xhr[oC];if(!s||!r||!a)return;let{method:n,url:i,status_code:o,body:l}=a,c={xhr:t.xhr,input:l,startTimestamp:s,endTimestamp:r};i3({category:"xhr",data:{method:n,url:i,status_code:o},type:"http",level:oi(o)},c)}),n_("xhr",oM)),t.fetch&&(nS(a="fetch",function(t){if(iN()!==e)return;let{startTimestamp:s,endTimestamp:r}=t;if(r&&(!t.fetchData.url.match(/sentry_key/)||"POST"!==t.fetchData.method))if(t.error)i3({category:"fetch",data:t.fetchData,level:"error",type:"http"},{data:t.error,input:t.args,startTimestamp:s,endTimestamp:r});else{let e=t.response,a={...t.fetchData,status_code:e&&e.status},n={input:t.args,response:e,startTimestamp:s,endTimestamp:r};i3({category:"fetch",data:a,type:"http",level:oi(a.status_code)},n)}}),n_(a,()=>(function(e,t=!1){(!t||function(){if("string"==typeof EdgeRuntime)return!0;if(!function(){if(!("fetch"in nd))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(e){return!1}}())return!1;if(oo(nd.fetch))return!0;let e=!1,t=nd.document;if(t&&"function"==typeof t.createElement)try{let s=t.createElement("iframe");s.hidden=!0,t.head.appendChild(s),s.contentWindow&&s.contentWindow.fetch&&(e=oo(s.contentWindow.fetch)),t.head.removeChild(s)}catch(e){nh&&nf.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return e}())&&nY(nd,"fetch",function(t){return function(...s){let r=Error(),{method:a,url:n}=function(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){let[t,s]=e;return{url:oc(t),method:ol(s,"method")?String(s.method).toUpperCase():"GET"}}let t=e[0];return{url:oc(t),method:ol(t,"method")?String(t.method).toUpperCase():"GET"}}(s),i={args:s,fetchData:{method:a,url:n},startTimestamp:1e3*n6(),virtualError:r};return e||nC("fetch",{...i}),t.apply(nd,s).then(async e=>(nC("fetch",{...i,endTimestamp:1e3*n6(),response:e}),e),e=>{throw nC("fetch",{...i,endTimestamp:1e3*n6(),error:e}),nL(e)&&void 0===e.stack&&(e.stack=r.stack,nX(e,"framesToPop",1)),e})}})})(void 0,void 0))),t.history&&ok(function(t){if(iN()!==e)return;let s=t.from,r=t.to,a=ot(nd.location.href),n=s?ot(s):void 0,i=ot(r);n&&n.path||(n=a),a.protocol===i.protocol&&a.host===i.host&&(r=i.relative),a.protocol===n.protocol&&a.host===n.host&&(s=n.relative),i3({category:"navigation",data:{from:s,to:r}})}),t.sentry&&e.on("beforeSendEvent",function(t){iN()===e&&i3({category:"sentry."+("transaction"===t.type?"transaction":"event"),event_id:t.event_id,level:t.level,message:n9(t)},{event:t})})}}})(),((e={})=>{let t={onerror:!0,onunhandledrejection:!0,...e};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(e){let s,r;t.onerror&&(nS(s="error",t=>{var s;let r,a,n,i,o,l,{stackParser:c,attachStacktrace:d}=oq();if(iN()!==e||od>0)return;let{msg:u,url:h,line:m,column:p,error:g}=t,f=(s=ov(c,g||u,void 0,d,!1),o=(i=(n=(a=(r=s.exception=s.exception||{}).values=r.values||[])[0]=a[0]||{}).stacktrace=n.stacktrace||{}).frames=i.frames||[],l=nF(h)&&h.length>0?h:function(){try{return nd.document.location.href}catch(e){return""}}(),0===o.length&&o.push({colno:p,filename:l,function:"?",in_app:!0,lineno:m}),s);f.level="error",iH(f,{originalException:g,mechanism:{handled:!1,type:"onerror"}})}),n_(s,nT),oU("onerror")),t.onunhandledrejection&&(nS(r="unhandledrejection",t=>{let{stackParser:s,attachStacktrace:r}=oq();if(iN()!==e||od>0)return;let a=function(e){if(n$(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch(e){}return e}(t),n=n$(a)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(a)}`}]}}:ov(s,a,void 0,r,!0);n.level="error",iH(n,{originalException:a,mechanism:{handled:!1,type:"onunhandledrejection"}})}),n_(r,nA),oU("onunhandledrejection"))}}})(),((e={})=>{let t=e.limit||5,s=e.key||"cause";return{name:"LinkedErrors",preprocessEvent(e,r,a){let n=a.getOptions();!function(e,t,s=250,r,a,n,i){if(!(n.exception&&n.exception.values&&i&&nH(i.originalException,Error)))return;let o=n.exception.values.length>0?n.exception.values[n.exception.values.length-1]:void 0;o&&(n.exception.values=(function e(t,s,r,a,n,i,o,l){if(i.length>=r+1)return i;let c=[...i];if(nH(a[n],Error)){i9(o,l);let i=t(s,a[n]),d=c.length;oe(i,n,d,l),c=e(t,s,r,a[n],n,[i,...c],i,d)}return Array.isArray(a.errors)&&a.errors.forEach((a,i)=>{if(nH(a,Error)){i9(o,l);let d=t(s,a),u=c.length;oe(d,`errors[${i}]`,u,l),c=e(t,s,r,a,n,[d,...c],d,u)}}),c})(e,t,a,i.originalException,r,n.exception.values,o,0).map(e=>(e.value&&(e.value=nW(e.value,s)),e)))}(om,n.stackParser,n.maxValueLength,s,t,e,r)}}})(),{name:"Dedupe",processEvent(e){if(e.type)return e;try{if(function(e,t){let s,r,a,n;return!!t&&(s=e.message,r=t.message,!!((s||r)&&(!s||r)&&(s||!r)&&s===r&&oa(e,t)&&or(e,t))&&!!1||(a=on(t),n=on(e),!!(a&&n&&a.type===n.type&&a.value===n.value&&oa(e,t)&&or(e,t))))}(e,t))return nl&&nf.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(e){}return t=e}},{name:"HttpContext",preprocessEvent(e){if(!nd.navigator&&!nd.location&&!nd.document)return;let t=e.request&&e.request.url||nd.location&&nd.location.href,{referrer:s}=nd.document||{},{userAgent:r}=nd.navigator||{},a={...e.request&&e.request.headers,...s&&{Referer:s},...r&&{"User-Agent":r}},n={...e.request,...t&&{url:t},headers:a};e.request=n}}],!1!==n.autoSessionTracking&&s.push({name:"BrowserSession",setupOnce(){void 0!==nd.document?(iJ({ignoreDuration:!0}),iQ(),ok(({from:e,to:t})=>{void 0!==e&&e!==t&&(iJ({ignoreDuration:!0}),iQ())})):oh&&nf.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.")}}),s).filter(function(e){return!["BrowserApiErrors","Breadcrumbs","GlobalHandlers"].includes(e.name)}),environment:a}),x=new im;if(x.setClient(f),f.init(),this.session_id&&x.setExtra("sessionId",this.session_id),this.properties){var v=cm({},this.properties);v.userName=v.userName?"[Filtered]":void 0,v.userData=v.userData?"[Filtered]":void 0,v.token=v.token?"[Filtered]":void 0,x.setExtra("properties",v)}if(r){var y=r.searchParams.get("domain");if(!y){var b=r.host.match(/(.*?)\./);y=b&&b[1]||""}y&&x.setTag("domain",y)}e.error&&(x.setTag("fatalErrorType",e.error.type),x.setExtra("errorDetails",e.error.details),(null==(u=e.error.details)?void 0:u.uri)&&x.setTag("serverAddress",e.error.details.uri),(null==(h=e.error.details)?void 0:h.workerGroup)&&x.setTag("workerGroup",e.error.details.workerGroup),(null==(m=e.error.details)?void 0:m.geoGroup)&&x.setTag("geoGroup",e.error.details.geoGroup),(null==(p=e.error.details)?void 0:p.on)&&x.setTag("connectionAttempt",e.error.details.on),null!=(g=e.error.details)&&g.bundleUrl&&(x.setTag("bundleUrl",e.error.details.bundleUrl),x.setTag("bundleError",e.error.details.sourceError.type))),x.setTags({callMode:this._callObjectMode?ll()?"reactNative":null!=(c=this.properties)&&null!=(c=c.dailyConfig)&&null!=(c=c.callMode)&&c.includes("prebuilt")?this.properties.dailyConfig.callMode:"custom":"prebuilt-frame",version:F.version()});var j=(null==(d=e.error)?void 0:d.msg)||e.errorMsg;x.captureException(Error(j))}}},{key:"_callMachine",value:function(){var e;return null==(e=window._daily)||null==(e=e.instances)||null==(e=e[this.callClientId])?void 0:e.callMachine}},{key:"_maybeUpdateInputSettings",value:function(e){if(!aZ(this._inputSettings,e)){var t=this._getInputSettings();this._inputSettings=e;var s=this._getInputSettings();aZ(t,s)||this.emitDailyJSEvent({action:o5,inputSettings:s})}}}],[{key:"supportedBrowser",value:function(){if(ll())return{supported:!0,mobile:!0,name:"React Native",version:null,supportsScreenShare:!0,supportsSfu:!0,supportsVideoProcessing:!1,supportsAudioProcessing:!1};var e=ns.getParser(lo());return{supported:!!lg(),mobile:"mobile"===e.getPlatformType(),name:e.getBrowserName(),version:e.getBrowserVersion(),supportsFullscreen:!!ld(),supportsScreenShare:!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia&&(function(e,t){if(!e||!t)return!0;switch(e){case"Chrome":return t.major>=75;case"Safari":return RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection")&&(13!==t.major||0!==t.minor||0!==t.point);case"Firefox":return t.major>=67}return!0}(lv(),ly())||ll())),supportsSfu:!!lg(),supportsVideoProcessing:lm(),supportsAudioProcessing:lp()}}},{key:"version",value:function(){return"0.87.0"}},{key:"createCallObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.layout="none",new F(null,e)}},{key:"wrap",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(cB(),!e||!e.contentWindow||"string"!=typeof e.src)throw Error("DailyIframe::Wrap needs an iframe-like first argument");return t.layout||(t.customLayout?t.layout="custom-v1":t.layout="browser"),new F(e,t)}},{key:"createFrame",value:function(e,t){cB(),e&&t?(s=e,r=t):e&&e.append?(s=e,r={}):(s=document.body,r=e||{});var s,r,a=r.iframeStyle;a||(a=s===document.body?{position:"fixed",border:"1px solid black",backgroundColor:"white",width:"375px",height:"450px",right:"1em",bottom:"1em"}:{border:0,width:"100%",height:"100%"});var n=document.createElement("iframe");window.navigator&&window.navigator.userAgent.match(/Chrome\/61\./)?n.allow="microphone, camera":n.allow="microphone; camera; autoplay; display-capture; screen-wake-lock; compute-pressure;",n.style.visibility="hidden",s.appendChild(n),n.style.visibility=null,Object.keys(a).forEach(function(e){return n.style[e]=a[e]}),r.layout||(r.customLayout?r.layout="custom-v1":r.layout="browser");try{return new F(n,r)}catch(e){throw s.removeChild(n),e}}},{key:"createTransparentFrame",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};cB();var t=document.createElement("iframe");return t.allow="microphone; camera; autoplay",t.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      border: 0;\n      pointer-events: none;\n    ",document.body.appendChild(t),e.layout||(e.layout="custom-v1"),F.wrap(t,e)}},{key:"getCallInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return e?cx[e]:Object.values(cx)[0]}}])}(),e.i(325867),e.i(182126),e.s(["default",()=>c0],86034)}]);

//# debugId=9f6566da-ba62-b3f1-a9c0-f3abacecc72d
//# sourceMappingURL=fd764afc147a1c8d.js.map