{
  "version": 3,
  "sources": [],
  "debugId": "7df8ee69-dfa9-a504-8c63-3622aa7a4260",
  "sections": [
    {"offset": {"line": 1, "column": 0}, "map": {"version":3,"sources":["../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/lib/payments/chinese-gateways.ts","../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/lib/payments/wechat-pay-client.ts","../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/lib/payments/alipay-client.ts","../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/lib/payments/airwallex.ts","../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/lib/payments/hitpay.ts","../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/lib/payments/factory.ts","../../../../../../ADK_WORKSPACE/TutorMekimi/tutorme-app/src/lib/payments/index.ts"],"sourcesContent":["/**\n * Enterprise Chinese Payment Gateway Integration\n * Multi-gateway system for Chinese market (CNY, Asia/Shanghai, PBOC compliance)\n *\n * Supported gateways:\n * - WeChat Pay (微信支付) - QR code Native payments\n * - Alipay (支付宝) - Page pay, mobile wallet\n * - UnionPay (银联) - Bank card payments\n * - Bank Transfer (银行转账) - B2B payments\n */\n\n/** Asia/Shanghai timezone for all Chinese payment timing */\nexport const CHINESE_TIMEZONE = 'Asia/Shanghai'\n\n/** Default currency for Chinese market - 人民币 */\nexport const CHINESE_CURRENCY = 'CNY'\n\n/** Country code for China */\nexport const CHINA_COUNTRY_CODE = 'CN'\n\n/** Performance targets (milliseconds) */\nexport const PERFORMANCE_TARGETS = {\n  PAYMENT_PROCESSING_MS: 2000,\n  QR_CODE_GENERATION_MS: 1000,\n  WEBHOOK_RESPONSE_MS: 500,\n} as const\n\n/** Chinese gateway types */\nexport type ChineseGatewayType = 'WECHAT_PAY' | 'ALIPAY' | 'UNIONPAY' | 'BANK_TRANSFER'\n\n/** UnionPay integration config (for future implementation) */\nexport const UNIONPAY_CONFIG = {\n  DOMAIN: process.env.UNIONPAY_DOMAIN || 'https://gateway.95516.com',\n  MERCHANT_ID: process.env.UNIONPAY_MERCHANT_ID,\n  CURRENCY: CHINESE_CURRENCY,\n  COUNTRY: CHINA_COUNTRY_CODE,\n} as const\n\n/** Bank transfer config for B2B payments */\nexport const BANK_TRANSFER_CONFIG = {\n  CURRENCY: CHINESE_CURRENCY,\n  SUPPORTED_BANKS: ['ICBC', 'CCB', 'ABC', 'BOC', 'CMB'] as const,\n  SETTLEMENT_DAYS: 1,\n} as const\n\n/**\n * Chinese error messages for payment failures (PBOC compliance, user-friendly)\n */\nexport const CHINESE_ERROR_MESSAGES: Record<string, string> = {\n  // WeChat Pay\n  WECHAT_PAY_INVALID_CONFIG: '微信支付配置错误，请联系客服',\n  WECHAT_PAY_SIGN_FAILED: '微信支付签名验证失败',\n  WECHAT_PAY_ORDER_FAILED: '微信支付下单失败，请稍后重试',\n  WECHAT_PAY_QR_EXPIRED: '支付二维码已过期，请刷新后重试',\n  WECHAT_PAY_USER_CANCEL: '用户已取消支付',\n\n  // Alipay\n  ALIPAY_INVALID_CONFIG: '支付宝配置错误，请联系客服',\n  ALIPAY_SIGN_FAILED: '支付宝签名验证失败',\n  ALIPAY_ORDER_FAILED: '支付宝下单失败，请稍后重试',\n  ALIPAY_USER_CANCEL: '用户已取消支付',\n\n  // UnionPay\n  UNIONPAY_INVALID_CONFIG: '银联支付配置错误，请联系客服',\n  UNIONPAY_ORDER_FAILED: '银联支付下单失败，请稍后重试',\n\n  // Bank Transfer\n  BANK_TRANSFER_INVALID: '银行转账信息无效',\n  BANK_TRANSFER_PENDING: '银行转账处理中，请等待到账',\n\n  // Generic\n  PAYMENT_TIMEOUT: '支付超时，请重试',\n  PAYMENT_AMOUNT_INVALID: '支付金额无效',\n  PAYMENT_NETWORK_ERROR: '网络异常，请检查网络后重试',\n  PAYMENT_SYSTEM_ERROR: '支付系统繁忙，请稍后重试',\n  FRAUD_DETECTION: '交易存在风险，请联系客服核实',\n  MFA_REQUIRED: '需要二次验证以完成支付',\n}\n\n/**\n * Get Chinese error message by key, with fallback\n */\nexport function getChineseErrorMessage(key: string, fallback?: string): string {\n  return CHINESE_ERROR_MESSAGES[key] ?? fallback ?? CHINESE_ERROR_MESSAGES.PAYMENT_SYSTEM_ERROR\n}\n\n/**\n * Mobile wallet compatibility flags\n */\nexport interface MobileWalletSupport {\n  wechat: boolean\n  alipay: boolean\n  unionPay: boolean\n  applePay: boolean\n}\n\n/**\n * Chinese payment metadata for compliance\n */\nexport interface ChinesePaymentMetadata {\n  gateway: ChineseGatewayType\n  currency: typeof CHINESE_CURRENCY\n  timezone: typeof CHINESE_TIMEZONE\n  country: typeof CHINA_COUNTRY_CODE\n  /** PBOC transaction reference if applicable */\n  pbocRef?: string\n  /** Fraud detection score 0-100 */\n  fraudScore?: number\n  /** MFA required flag */\n  mfaRequired?: boolean\n}\n\n/**\n * Check if amount is valid for Chinese market (min 0.01 CNY)\n */\nexport function isValidChineseAmount(amount: number): boolean {\n  return typeof amount === 'number' && amount >= 0.01 && amount < 1_000_000\n}\n\n/**\n * Convert CNY to fen (分) for WeChat Pay API (integer)\n */\nexport function cnyToFen(cny: number): number {\n  return Math.round(cny * 100)\n}\n\n/**\n * Convert fen to CNY\n */\nexport function fenToCny(fen: number): number {\n  return fen / 100\n}\n\n/**\n * Format amount for Alipay (2 decimal places string)\n */\nexport function formatAlipayAmount(cny: number): string {\n  return cny.toFixed(2)\n}\n","/**\n * Enterprise WeChat Pay SDK - Native QR Code Payments\n * API v3: https://pay.weixin.qq.com/docs/merchant/apis/native-payment/native-prepay.html\n *\n * Features:\n * - QR code generation for in-app payments (<1s target)\n * - SHA256-RSA signing (PBOC compliant)\n * - CNY (人民币) currency, CN country\n * - Chinese error messages\n */\n\nimport crypto from 'crypto'\nimport type {\n  CreatePaymentRequest,\n  PaymentResponse,\n  PaymentGateway,\n  WebhookResult,\n  RefundResponse,\n} from './types'\nimport {\n  CHINESE_CURRENCY,\n  cnyToFen,\n  getChineseErrorMessage,\n  isValidChineseAmount,\n} from './chinese-gateways'\n\n/** WeChat Pay API v3 config */\nexport const WECHAT_PAY_CONFIG = {\n  APP_ID: process.env.WECHAT_APP_ID,\n  MCH_ID: process.env.WECHAT_MCH_ID,\n  DOMAIN: 'https://api.mch.weixin.qq.com',\n  SANDBOX_DOMAIN: 'https://api.mch.weixin.qq.com',\n  CURRENCY: 'CNY',\n  COUNTRY: 'CN',\n} as const\n\nfunction getWeChatPayDomain(): string {\n  const env = process.env.WECHAT_PAY_ENV || 'production'\n  return env === 'sandbox' ? WECHAT_PAY_CONFIG.SANDBOX_DOMAIN : WECHAT_PAY_CONFIG.DOMAIN\n}\n\nfunction getPrivateKey(): string {\n  const key = process.env.WECHAT_PAY_PRIVATE_KEY\n  if (!key) {\n    throw new Error(getChineseErrorMessage('WECHAT_PAY_INVALID_CONFIG'))\n  }\n  return key.replace(/\\\\n/g, '\\n')\n}\n\nfunction getApiV3Key(): string {\n  const key = process.env.WECHAT_PAY_API_V3_KEY\n  if (!key) {\n    throw new Error(getChineseErrorMessage('WECHAT_PAY_INVALID_CONFIG'))\n  }\n  return key\n}\n\n/**\n * Build WeChat Pay v3 Authorization header (WECHATPAY2-SHA256-RSA2048)\n */\nfunction buildAuthorization(\n  method: string,\n  url: string,\n  body: string,\n  privateKey: string\n): string {\n  const timestamp = Math.floor(Date.now() / 1000).toString()\n  const nonce = crypto.randomBytes(16).toString('hex')\n  const message = `${method}\\n${url}\\n${timestamp}\\n${nonce}\\n${body}\\n`\n  const sign = crypto.createSign('RSA-SHA256').update(message).sign(privateKey, 'base64')\n  return `WECHATPAY2-SHA256-RSA2048 mchid=\"${WECHAT_PAY_CONFIG.MCH_ID}\",nonce_str=\"${nonce}\",timestamp=\"${timestamp}\",signature=\"${sign}\"`\n}\n\n/**\n * Verify WeChat Pay webhook signature (RSA-SHA256 with platform certificate)\n * Set WECHAT_PAY_PLATFORM_PUBLIC_KEY for production verification\n */\nfunction verifyWebhookSignature(\n  body: string,\n  signature: string,\n  timestamp: string,\n  nonce: string\n): boolean {\n  const platformCert = process.env.WECHAT_PAY_PLATFORM_PUBLIC_KEY\n  if (!platformCert) {\n    return true\n  }\n  const publicKey = platformCert.replace(/\\\\n/g, '\\n')\n  const message = `${timestamp}\\n${nonce}\\n${body}\\n`\n  try {\n    return crypto.createVerify('RSA-SHA256').update(message).verify(publicKey, signature, 'base64')\n  } catch {\n    return false\n  }\n}\n\n/**\n * Decrypt WeChat Pay webhook resource (AES-256-GCM)\n */\nfunction decryptWebhookResource(ciphertext: string, nonce: string, associatedData: string): string {\n  const apiV3Key = getApiV3Key()\n  const key = Buffer.from(apiV3Key, 'utf8')\n  const iv = Buffer.from(nonce, 'utf8')\n  const authTag = Buffer.from(ciphertext.slice(-24), 'base64')\n  const data = Buffer.from(ciphertext.slice(0, -24), 'base64')\n  const decipher = crypto.createDecipheriv('aes-256-gcm', key, iv, { authTagLength: 16 })\n  decipher.setAuthTag(authTag)\n  decipher.setAAD(Buffer.from(associatedData, 'utf8'))\n  return decipher.update(data) + decipher.final('utf8')\n}\n\nexport class WeChatPayClient implements PaymentGateway {\n  async createPayment(request: CreatePaymentRequest): Promise<PaymentResponse> {\n    const appId = WECHAT_PAY_CONFIG.APP_ID\n    const mchId = WECHAT_PAY_CONFIG.MCH_ID\n    if (!appId || !mchId) {\n      throw new Error(getChineseErrorMessage('WECHAT_PAY_INVALID_CONFIG'))\n    }\n\n    const amount = request.amount\n    if (!isValidChineseAmount(amount)) {\n      throw new Error(getChineseErrorMessage('PAYMENT_AMOUNT_INVALID'))\n    }\n\n    const outTradeNo = `T${Date.now()}${Math.random().toString(36).slice(2, 9)}`\n    const baseUrl = process.env.NEXT_PUBLIC_APP_URL || ''\n    const notifyUrl =\n      process.env.WECHAT_PAY_NOTIFY_URL || `${baseUrl}/api/payments/webhooks/wechat-pay`\n\n    const body = {\n      appid: appId,\n      mchid: mchId,\n      description: request.description.slice(0, 127),\n      out_trade_no: outTradeNo,\n      notify_url: notifyUrl,\n      amount: {\n        total: cnyToFen(amount),\n        currency: request.currency || CHINESE_CURRENCY,\n      },\n    }\n\n    const path = '/v3/pay/transactions/native'\n    const fullUrl = `${getWeChatPayDomain()}${path}`\n    const bodyStr = JSON.stringify(body)\n    const privateKey = getPrivateKey()\n    const auth = buildAuthorization('POST', path, bodyStr, privateKey)\n\n    const startTime = Date.now()\n    const res = await fetch(fullUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Accept: 'application/json',\n        'User-Agent': 'TutorMe-WeChatPay/1.0',\n        Authorization: auth,\n      },\n      body: bodyStr,\n    })\n\n    if (Date.now() - startTime > 2000) {\n      throw new Error(getChineseErrorMessage('PAYMENT_TIMEOUT'))\n    }\n\n    const data = (await res.json()) as {\n      code_url?: string\n      error_code?: string\n      errcode?: string\n      errmsg?: string\n    }\n\n    if (!res.ok || data.errcode || data.error_code) {\n      const errMsg = data.errmsg || data.errcode || `HTTP ${res.status}`\n      throw new Error(getChineseErrorMessage('WECHAT_PAY_ORDER_FAILED', errMsg))\n    }\n\n    const codeUrl = data.code_url\n    if (!codeUrl) {\n      throw new Error(getChineseErrorMessage('WECHAT_PAY_ORDER_FAILED'))\n    }\n\n    return {\n      paymentId: outTradeNo,\n      checkoutUrl: codeUrl,\n      status: 'CREATED',\n    }\n  }\n\n  verifyWebhook(payload: unknown, signature: string): boolean {\n    const headers = typeof payload === 'object' && payload !== null && 'headers' in payload\n      ? (payload as { headers: Record<string, string> }).headers\n      : null\n    const rawBody = typeof payload === 'object' && payload !== null && 'rawBody' in payload\n      ? (payload as { rawBody: string }).rawBody\n      : typeof payload === 'string'\n        ? payload\n        : JSON.stringify(payload)\n\n    const wechatSignature = headers?.['wechatpay-signature'] ?? signature\n    const timestamp = headers?.['wechatpay-timestamp'] ?? ''\n    const nonce = headers?.['wechatpay-nonce'] ?? ''\n\n    const sigMatch = wechatSignature.match(/timestamp=\"([^\"]+)\",nonce=\"([^\"]+)\",signature=\"([^\"]+)\"/)\n    if (!sigMatch) return false\n\n    const [, ts, n, sig] = sigMatch\n    return verifyWebhookSignature(rawBody, sig, ts, n)\n  }\n\n  async processWebhook(payload: unknown): Promise<WebhookResult> {\n    const body = payload as {\n      event_type?: string\n      resource?: {\n        ciphertext?: string\n        nonce?: string\n        associated_data?: string\n      }\n    }\n\n    const eventType = body?.event_type || 'unknown'\n    const resource = body?.resource\n    if (!resource?.ciphertext) {\n      return { success: false, eventType, error: getChineseErrorMessage('WECHAT_PAY_SIGN_FAILED') }\n    }\n\n    try {\n      const decrypted = decryptWebhookResource(\n        resource.ciphertext,\n        resource.nonce || '',\n        resource.associated_data || ''\n      )\n      const data = JSON.parse(decrypted) as {\n        out_trade_no?: string\n        trade_state?: string\n        transaction_id?: string\n      }\n\n      const paymentId = data.out_trade_no\n      const tradeState = data.trade_state\n\n      const statusMap: Record<string, string> = {\n        SUCCESS: 'completed',\n        REFUND: 'refunded',\n        NOTPAY: 'pending',\n        CLOSED: 'cancelled',\n        REVOKED: 'cancelled',\n        USERPAYING: 'processing',\n        PAYERROR: 'failed',\n      }\n      const status = tradeState ? statusMap[tradeState] || tradeState : 'unknown'\n\n      return {\n        success: true,\n        paymentId: paymentId || '',\n        eventType,\n        status,\n      }\n    } catch {\n      return { success: false, eventType, error: getChineseErrorMessage('WECHAT_PAY_SIGN_FAILED') }\n    }\n  }\n\n  async refundPayment(paymentId: string, amount?: number): Promise<RefundResponse> {\n    const mchId = WECHAT_PAY_CONFIG.MCH_ID\n    if (!mchId) {\n      return {\n        refundId: '',\n        status: 'failed',\n        error: getChineseErrorMessage('WECHAT_PAY_INVALID_CONFIG'),\n      }\n    }\n\n    const outRefundNo = `R${Date.now()}${Math.random().toString(36).slice(2, 9)}`\n    const body: Record<string, unknown> = {\n      out_trade_no: paymentId,\n      out_refund_no: outRefundNo,\n      reason: '用户申请退款',\n      amount: {\n        refund: amount != null ? cnyToFen(amount) : undefined,\n        total: amount != null ? cnyToFen(amount) : undefined,\n        currency: CHINESE_CURRENCY,\n      },\n    }\n\n    const path = '/v3/refund/domestic/refunds'\n    const fullUrl = `${getWeChatPayDomain()}${path}`\n    const bodyStr = JSON.stringify(body)\n    const privateKey = getPrivateKey()\n    const auth = buildAuthorization('POST', path, bodyStr, privateKey)\n\n    const res = await fetch(fullUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Accept: 'application/json',\n        Authorization: auth,\n      },\n      body: bodyStr,\n    })\n\n    const data = (await res.json()) as {\n      refund_id?: string\n      status?: string\n      errcode?: string\n      errmsg?: string\n    }\n\n    if (!res.ok || data.errcode) {\n      return {\n        refundId: '',\n        status: 'failed',\n        error: data.errmsg || getChineseErrorMessage('WECHAT_PAY_ORDER_FAILED'),\n      }\n    }\n\n    return {\n      refundId: data.refund_id || outRefundNo,\n      status: data.status || 'PROCESSING',\n      amountRefunded: amount,\n    }\n  }\n}\n","/**\n * Enterprise Alipay SDK - Page Pay & Mobile Wallet\n * https://opendocs.alipay.com/open/270/105898\n *\n * Features:\n * - PC web page payment (alipay.trade.page.pay)\n * - CNY (人民币), Asia/Shanghai timezone\n * - RSA2 (SHA256WithRSA) signing\n * - Chinese error messages\n */\n\nimport crypto from 'crypto'\nimport type {\n  CreatePaymentRequest,\n  PaymentResponse,\n  PaymentGateway,\n  WebhookResult,\n  RefundResponse,\n} from './types'\nimport {\n  CHINESE_CURRENCY,\n  CHINESE_TIMEZONE,\n  formatAlipayAmount,\n  getChineseErrorMessage,\n  isValidChineseAmount,\n} from './chinese-gateways'\n\n/** Alipay API config */\nexport const ALIPAY_CONFIG = {\n  APP_ID: process.env.ALIPAY_APP_ID,\n  DOMAIN: 'https://openapi.alipay.com',\n  SANDBOX_DOMAIN: 'https://openapi-sandbox.dl.alipaydev.com',\n  CURRENCY: CHINESE_CURRENCY,\n  TIMEZONE: CHINESE_TIMEZONE,\n} as const\n\nfunction getAlipayDomain(): string {\n  const env = process.env.ALIPAY_ENV || 'production'\n  return env === 'sandbox' ? ALIPAY_CONFIG.SANDBOX_DOMAIN : ALIPAY_CONFIG.DOMAIN\n}\n\nfunction getPrivateKey(): string {\n  const key = process.env.ALIPAY_PRIVATE_KEY\n  if (!key) {\n    throw new Error(getChineseErrorMessage('ALIPAY_INVALID_CONFIG'))\n  }\n  return key.replace(/\\\\n/g, '\\n')\n}\n\n/**\n * Build Alipay RSA2 signature\n */\nfunction sign(params: Record<string, string>, privateKey: string): string {\n  const sortedKeys = Object.keys(params).sort()\n  const signStr = sortedKeys\n    .filter((k) => params[k] !== '' && params[k] != null)\n    .map((k) => `${k}=${params[k]}`)\n    .join('&')\n  return crypto.createSign('RSA-SHA256').update(signStr).sign(privateKey, 'base64')\n}\n\n/**\n * Verify Alipay webhook/return signature\n */\nfunction verifySign(params: Record<string, string>, signature: string, publicKey: string): boolean {\n  const signType = params.sign_type || 'RSA2'\n  if (signType !== 'RSA2') return false\n  const sortedKeys = Object.keys(params)\n    .filter((k) => k !== 'sign' && k !== 'sign_type')\n    .sort()\n  const signStr = sortedKeys\n    .filter((k) => params[k] !== '' && params[k] != null)\n    .map((k) => `${k}=${params[k]}`)\n    .join('&')\n  try {\n    return crypto.createVerify('RSA-SHA256').update(signStr).verify(publicKey, signature, 'base64')\n  } catch {\n    return false\n  }\n}\n\nexport class AlipayClient implements PaymentGateway {\n  async createPayment(request: CreatePaymentRequest): Promise<PaymentResponse> {\n    const appId = ALIPAY_CONFIG.APP_ID\n    if (!appId) {\n      throw new Error(getChineseErrorMessage('ALIPAY_INVALID_CONFIG'))\n    }\n\n    const amount = request.amount\n    if (!isValidChineseAmount(amount)) {\n      throw new Error(getChineseErrorMessage('PAYMENT_AMOUNT_INVALID'))\n    }\n\n    const outTradeNo = `A${Date.now()}${Math.random().toString(36).slice(2, 9)}`\n    const baseUrl = process.env.NEXT_PUBLIC_APP_URL || ''\n    const returnUrl = request.successUrl ?? `${baseUrl}/payment/success`\n    const notifyUrl =\n      process.env.ALIPAY_NOTIFY_URL || `${baseUrl}/api/payments/webhooks/alipay`\n\n    const bizContent = {\n      out_trade_no: outTradeNo,\n      total_amount: formatAlipayAmount(amount),\n      subject: request.description.slice(0, 256),\n      product_code: 'FAST_INSTANT_TRADE_PAY',\n    }\n\n    const params: Record<string, string> = {\n      app_id: appId,\n      method: 'alipay.trade.page.pay',\n      format: 'JSON',\n      charset: 'utf-8',\n      sign_type: 'RSA2',\n      timestamp: new Date().toISOString().replace(/\\\\.\\d{3}Z$/, 'Z'),\n      version: '1.0',\n      return_url: returnUrl,\n      notify_url: notifyUrl,\n      biz_content: JSON.stringify(bizContent),\n    }\n\n    const signature = sign(params, getPrivateKey())\n    params.sign = signature\n\n    const gateway = `${getAlipayDomain()}/gateway.do`\n    const query = Object.entries(params)\n      .map(([k, v]) => `${encodeURIComponent(k)}=${encodeURIComponent(v)}`)\n      .join('&')\n    const checkoutUrl = `${gateway}?${query}`\n\n    return {\n      paymentId: outTradeNo,\n      checkoutUrl,\n      status: 'WAIT_BUYER_PAY',\n    }\n  }\n\n  verifyWebhook(payload: unknown, signature: string): boolean {\n    const params = (typeof payload === 'object' && payload !== null ? payload : {}) as Record<string, string>\n    const sig = params.sign ?? signature\n    const publicKey = process.env.ALIPAY_PUBLIC_KEY\n    if (!publicKey) return false\n    return verifySign(params, sig, publicKey.replace(/\\\\n/g, '\\n'))\n  }\n\n  async processWebhook(payload: unknown): Promise<WebhookResult> {\n    const body = payload as Record<string, string>\n    const tradeStatus = body.trade_status\n    const outTradeNo = body.out_trade_no\n\n    if (!outTradeNo) {\n      return { success: false, eventType: 'notify', error: getChineseErrorMessage('ALIPAY_SIGN_FAILED') }\n    }\n\n    const statusMap: Record<string, string> = {\n      WAIT_BUYER_PAY: 'pending',\n      TRADE_CLOSED: 'cancelled',\n      TRADE_SUCCESS: 'completed',\n      TRADE_FINISHED: 'completed',\n    }\n    const status = tradeStatus ? statusMap[tradeStatus] || tradeStatus : 'unknown'\n\n    return {\n      success: true,\n      paymentId: outTradeNo,\n      eventType: 'trade.notify',\n      status,\n    }\n  }\n\n  async refundPayment(paymentId: string, amount?: number): Promise<RefundResponse> {\n    const appId = ALIPAY_CONFIG.APP_ID\n    if (!appId) {\n      return {\n        refundId: '',\n        status: 'failed',\n        error: getChineseErrorMessage('ALIPAY_INVALID_CONFIG'),\n      }\n    }\n\n    const refundNo = `R${Date.now()}${Math.random().toString(36).slice(2, 9)}`\n    const bizContent: Record<string, string> = {\n      out_trade_no: paymentId,\n      refund_amount: amount != null ? formatAlipayAmount(amount) : '0',\n      out_request_no: refundNo,\n    }\n\n    const params: Record<string, string> = {\n      app_id: appId,\n      method: 'alipay.trade.refund',\n      format: 'JSON',\n      charset: 'utf-8',\n      sign_type: 'RSA2',\n      timestamp: new Date().toISOString().replace(/\\\\.\\d{3}Z$/, 'Z'),\n      version: '1.0',\n      biz_content: JSON.stringify(bizContent),\n    }\n\n    const signature = sign(params, getPrivateKey())\n    params.sign = signature\n\n    const gateway = `${getAlipayDomain()}/gateway.do`\n    const query = Object.entries(params)\n      .map(([k, v]) => `${encodeURIComponent(k)}=${encodeURIComponent(v)}`)\n      .join('&')\n\n    const startTime = Date.now()\n    const res = await fetch(gateway, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n      body: query,\n    })\n\n    if (Date.now() - startTime > 2000) {\n      return {\n        refundId: '',\n        status: 'failed',\n        error: getChineseErrorMessage('PAYMENT_TIMEOUT'),\n      }\n    }\n\n    const data = (await res.json()) as {\n      alipay_trade_refund_response?: { code?: string; msg?: string; sub_code?: string }\n    }\n    const resp = data.alipay_trade_refund_response\n    if (!resp || resp.code !== '10000') {\n      return {\n        refundId: '',\n        status: 'failed',\n        error: resp?.sub_code || resp?.msg || getChineseErrorMessage('ALIPAY_ORDER_FAILED'),\n      }\n    }\n\n    return {\n      refundId: refundNo,\n      status: 'completed',\n      amountRefunded: amount,\n    }\n  }\n}\n","/**\n * Airwallex payment gateway implementation\n * - OAuth2-style token authentication (login with API key, use Bearer token)\n * - Create payment intent\n * - Webhook signature verification (HMAC-SHA256 of timestamp + raw body)\n * - Refund via payment_attempt_id (store attempt_id from webhook for refunds)\n */\n\nimport crypto from 'crypto'\nimport type {\n  CreatePaymentRequest,\n  PaymentResponse,\n  PaymentGateway,\n  WebhookResult,\n  RefundResponse\n} from './types'\n\nconst SANDBOX_BASE = 'https://api-demo.airwallex.com'\nconst PRODUCTION_BASE = 'https://api.airwallex.com'\n\ninterface TokenCache {\n  token: string\n  expiresAt: number\n}\n\nlet tokenCache: TokenCache | null = null\n\nfunction getBaseUrl(): string {\n  const env = process.env.AIRWALLEX_ENV || 'sandbox'\n  return env === 'production' ? PRODUCTION_BASE : SANDBOX_BASE\n}\n\nasync function getAccessToken(): Promise<string> {\n  const now = Date.now()\n  if (tokenCache && tokenCache.expiresAt > now + 60_000) {\n    return tokenCache.token\n  }\n\n  const clientId = process.env.AIRWALLEX_CLIENT_ID\n  const apiKey = process.env.AIRWALLEX_API_KEY\n  if (!clientId || !apiKey) {\n    throw new Error('Airwallex: AIRWALLEX_CLIENT_ID and AIRWALLEX_API_KEY are required')\n  }\n\n  const base = getBaseUrl()\n  const res = await fetch(`${base}/api/v1/authentication/login`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      Accept: 'application/json',\n      'x-client-id': clientId,\n      'x-api-key': apiKey\n    }\n  })\n\n  if (!res.ok) {\n    const text = await res.text()\n    throw new Error(`Airwallex auth failed: ${res.status} ${text}`)\n  }\n\n  const data = (await res.json()) as { token?: string; expires_at?: string }\n  const token = data.token\n  const expiresAt = data.expires_at\n  if (!token) {\n    throw new Error('Airwallex: no token in auth response')\n  }\n\n  const expiresAtMs = expiresAt ? new Date(expiresAt).getTime() : Date.now() + 25 * 60 * 1000\n  tokenCache = { token, expiresAt: expiresAtMs }\n  return token\n}\n\n/**\n * For Airwallex webhook verification, pass an object with rawBody and timestamp:\n * { rawBody: string, timestamp: string } (timestamp from x-timestamp header).\n * If payload is a string, it is treated as rawBody and timestamp must be in signature header context\n * (caller should pass timestamp separately - we don't have it in the interface, so we require the object form).\n */\nfunction getRawBodyAndTimestamp(payload: unknown): { rawBody: string; timestamp: string } | null {\n  if (payload && typeof payload === 'object' && 'rawBody' in payload && 'timestamp' in payload) {\n    const rawBody = (payload as { rawBody: unknown }).rawBody\n    const timestamp = (payload as { timestamp: unknown }).timestamp\n    if (typeof rawBody === 'string' && typeof timestamp === 'string') {\n      return { rawBody, timestamp }\n    }\n  }\n  return null\n}\n\nexport class AirwallexGateway implements PaymentGateway {\n  async createPayment(request: CreatePaymentRequest): Promise<PaymentResponse> {\n    const token = await getAccessToken()\n    const base = getBaseUrl()\n    const requestId = `req_${Date.now()}_${Math.random().toString(36).slice(2, 9)}`\n\n    const defaultReturn = process.env.PAYMENT_SUCCESS_URL || `${process.env.NEXT_PUBLIC_APP_URL || ''}/payment/success`\n    const returnUrl = request.successUrl ?? defaultReturn\n    const body = {\n      request_id: requestId,\n      amount: request.amount,\n      currency: request.currency.toUpperCase(),\n      merchant_order_id: request.bookingId ?? (request.curriculumId ? `course:${request.curriculumId}` : 'payment'),\n      return_url: returnUrl\n    }\n\n    const res = await fetch(`${base}/api/v1/pa/payment_intents/create`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${token}`,\n        'x-client-id': process.env.AIRWALLEX_CLIENT_ID!\n      },\n      body: JSON.stringify(body)\n    })\n\n    if (!res.ok) {\n      const text = await res.text()\n      throw new Error(`Airwallex create payment intent failed: ${res.status} ${text}`)\n    }\n\n    const data = (await res.json()) as {\n      id?: string\n      status?: string\n      client_secret?: string\n      url?: string\n    }\n\n    const paymentId = data.id\n    if (!paymentId) {\n      throw new Error('Airwallex: no payment intent id in response')\n    }\n\n    const checkoutUrl =\n      data.url ||\n      `${process.env.NEXT_PUBLIC_APP_URL || ''}/payment/checkout?intent_id=${paymentId}&client_secret=${encodeURIComponent(data.client_secret || '')}`\n\n    return {\n      paymentId,\n      checkoutUrl,\n      status: data.status || 'REQUIRES_PAYMENT_METHOD'\n    }\n  }\n\n  verifyWebhook(payload: unknown, signature: string): boolean {\n    const secret = process.env.AIRWALLEX_WEBHOOK_SECRET\n    if (!secret) {\n      return false\n    }\n    const parsed = getRawBodyAndTimestamp(payload)\n    if (!parsed) {\n      return false\n    }\n    const { rawBody, timestamp } = parsed\n    const policy = `${timestamp}${rawBody}`\n    const expected = crypto.createHmac('sha256', secret).update(policy).digest('hex')\n    return crypto.timingSafeEqual(Buffer.from(expected, 'hex'), Buffer.from(signature, 'hex'))\n  }\n\n  async processWebhook(payload: unknown): Promise<WebhookResult> {\n    const body = payload as { name?: string; data?: { id?: string; status?: string; payment_attempt_id?: string } }\n    const eventName = body?.name || ''\n    const data = body?.data\n\n    if (!data) {\n      return { success: false, eventType: eventName, error: 'Missing event data' }\n    }\n\n    const paymentId = data.id\n    const status = data.status\n\n    if (eventName === 'payment_intent.succeeded') {\n      return {\n        success: true,\n        paymentId,\n        eventType: eventName,\n        status: status || 'succeeded'\n      }\n    }\n\n    if (eventName === 'payment_intent.cancelled' || eventName === 'payment_intent.failed') {\n      return {\n        success: true,\n        paymentId,\n        eventType: eventName,\n        status: status || 'cancelled'\n      }\n    }\n\n    return {\n      success: true,\n      paymentId,\n      eventType: eventName,\n      status\n    }\n  }\n\n  async refundPayment(paymentId: string, amount?: number): Promise<RefundResponse> {\n    const token = await getAccessToken()\n    const base = getBaseUrl()\n    const requestId = `refund_${Date.now()}_${Math.random().toString(36).slice(2, 9)}`\n\n    const body: Record<string, unknown> = {\n      payment_attempt_id: paymentId,\n      reason: 'customer_requested',\n      request_id: requestId\n    }\n    if (amount != null && amount > 0) {\n      body.amount = amount\n    }\n\n    const res = await fetch(`${base}/api/v1/pa/refunds/create`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${token}`,\n        'x-client-id': process.env.AIRWALLEX_CLIENT_ID!\n      },\n      body: JSON.stringify(body)\n    })\n\n    if (!res.ok) {\n      const text = await res.text()\n      return {\n        refundId: '',\n        status: 'failed',\n        error: `Airwallex refund failed: ${res.status} ${text}`\n      }\n    }\n\n    const data = (await res.json()) as { id?: string; status?: string; amount?: number }\n    return {\n      refundId: data.id || requestId,\n      status: data.status || 'RECEIVED',\n      amountRefunded: data.amount\n    }\n  }\n}\n","/**\n * Hitpay payment gateway implementation\n * - Create payment request (POST /v1/payment-requests)\n * - HMAC signature verification (Hitpay-Signature: SHA-256 derived from salt)\n * - Webhook processing (charge.created, payment_request.completed, etc.)\n * - Refund (POST /v1/refund)\n */\n\nimport crypto from 'crypto'\nimport type {\n  CreatePaymentRequest,\n  PaymentResponse,\n  PaymentGateway,\n  WebhookResult,\n  RefundResponse\n} from './types'\n\nconst SANDBOX_BASE = 'https://api.sandbox.hit-pay.com'\nconst PRODUCTION_BASE = 'https://api.hit-pay.com'\n\nfunction getBaseUrl(): string {\n  const env = process.env.HITPAY_ENV || 'sandbox'\n  return env === 'production' ? PRODUCTION_BASE : SANDBOX_BASE\n}\n\nexport class HitpayGateway implements PaymentGateway {\n  async createPayment(request: CreatePaymentRequest): Promise<PaymentResponse> {\n    const apiKey = process.env.HITPAY_API_KEY\n    if (!apiKey) {\n      throw new Error('Hitpay: HITPAY_API_KEY is required')\n    }\n\n    const base = getBaseUrl()\n    const defaultRedirect = process.env.PAYMENT_SUCCESS_URL || `${process.env.NEXT_PUBLIC_APP_URL || ''}/payment/success`\n    const redirectUrl = request.successUrl ?? defaultRedirect\n    const webhookUrl = process.env.HITPAY_WEBHOOK_URL || `${process.env.NEXT_PUBLIC_APP_URL || ''}/api/payments/webhooks/hitpay`\n\n    const body = {\n      amount: request.amount,\n      currency: request.currency.toLowerCase(),\n      email: request.studentEmail,\n      purpose: request.description,\n      reference_number: request.bookingId ?? (request.curriculumId ? `course:${request.curriculumId}` : 'payment'),\n      redirect_url: redirectUrl,\n      webhook: webhookUrl\n    }\n\n    const res = await fetch(`${base}/v1/payment-requests`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-BUSINESS-API-KEY': apiKey\n      },\n      body: JSON.stringify(body)\n    })\n\n    if (!res.ok) {\n      const text = await res.text()\n      throw new Error(`Hitpay create payment failed: ${res.status} ${text}`)\n    }\n\n    const data = (await res.json()) as {\n      id?: string\n      status?: string\n      url?: string\n    }\n\n    const paymentId = data.id\n    if (!paymentId) {\n      throw new Error('Hitpay: no payment request id in response')\n    }\n\n    const checkoutUrl = data.url || ''\n\n    return {\n      paymentId,\n      checkoutUrl,\n      status: data.status || 'pending'\n    }\n  }\n\n  /**\n   * Verify Hitpay webhook signature.\n   * Pass the raw request body string as payload and the Hitpay-Signature header value as signature.\n   * Hitpay uses HMAC-SHA256 with the salt as key and the JSON payload as message.\n   */\n  verifyWebhook(payload: unknown, signature: string): boolean {\n    const salt = process.env.HITPAY_SALT\n    if (!salt) {\n      return false\n    }\n    const rawBody = typeof payload === 'string' ? payload : JSON.stringify(payload)\n    const expected = crypto.createHmac('sha256', salt).update(rawBody).digest('hex')\n    if (expected.length !== signature.length) {\n      return false\n    }\n    return crypto.timingSafeEqual(Buffer.from(expected, 'hex'), Buffer.from(signature, 'hex'))\n  }\n\n  async processWebhook(payload: unknown): Promise<WebhookResult> {\n    const body = payload as {\n      id?: string\n      status?: string\n      payment_request_id?: string\n      amount?: number\n    }\n\n    const paymentId = body?.id || body?.payment_request_id\n    const status = body?.status\n\n    if (!paymentId) {\n      return { success: false, eventType: 'unknown', error: 'Missing payment id in webhook' }\n    }\n\n    const statusMap: Record<string, string> = {\n      succeeded: 'succeeded',\n      completed: 'completed',\n      paid: 'completed',\n      pending: 'pending',\n      failed: 'failed',\n      expired: 'expired',\n      canceled: 'cancelled',\n      cancelled: 'cancelled',\n      partially_refunded: 'partially_refunded',\n      refunded: 'refunded'\n    }\n    const normalizedStatus = status ? statusMap[status.toLowerCase()] || status : 'unknown'\n\n    return {\n      success: true,\n      paymentId,\n      eventType: 'payment_request.completed',\n      status: normalizedStatus\n    }\n  }\n\n  async refundPayment(paymentId: string, amount?: number): Promise<RefundResponse> {\n    const apiKey = process.env.HITPAY_API_KEY\n    if (!apiKey) {\n      return { refundId: '', status: 'failed', error: 'Hitpay: HITPAY_API_KEY is required' }\n    }\n\n    const base = getBaseUrl()\n    const body: { payment_id: string; amount?: number } = { payment_id: paymentId }\n    if (amount != null && amount > 0) {\n      body.amount = amount\n    }\n\n    const res = await fetch(`${base}/v1/refund`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'X-BUSINESS-API-KEY': apiKey\n      },\n      body: JSON.stringify(body)\n    })\n\n    if (!res.ok) {\n      const text = await res.text()\n      return {\n        refundId: '',\n        status: 'failed',\n        error: `Hitpay refund failed: ${res.status} ${text}`\n      }\n    }\n\n    const data = (await res.json()) as { id?: string; status?: string; amount_refunded?: number }\n    return {\n      refundId: data.id || '',\n      status: data.status || 'succeeded',\n      amountRefunded: data.amount_refunded\n    }\n  }\n}\n","/**\n * Payment gateway factory\n * Returns the appropriate gateway implementation for the given provider.\n */\n\nimport type { PaymentGateway } from './types'\nimport { AirwallexGateway } from './airwallex'\nimport { HitpayGateway } from './hitpay'\n\nexport type GatewayName = 'AIRWALLEX' | 'HITPAY'\n\nexport function getPaymentGateway(gateway: GatewayName): PaymentGateway {\n  switch (gateway) {\n    case 'AIRWALLEX':\n      return new AirwallexGateway()\n    case 'HITPAY':\n      return new HitpayGateway()\n    default:\n      throw new Error(`Unsupported payment gateway: ${gateway}`)\n  }\n}\n","export * from './types'\nexport { AirwallexGateway } from './airwallex'\nexport { HitpayGateway } from './hitpay'\nexport { getPaymentGateway, type GatewayName } from './factory'\nexport * from './chinese-gateways'\nexport { WeChatPayClient, WECHAT_PAY_CONFIG } from './wechat-pay-client'\nexport { AlipayClient, ALIPAY_CONFIG } from './alipay-client'\n"],"names":[],"mappings":"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"}}]
}