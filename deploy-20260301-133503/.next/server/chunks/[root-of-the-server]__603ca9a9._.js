;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="21043a7e-9f34-dc43-b57c-daf7bee9e8bf")}catch(e){}}();
module.exports=[683459,e=>e.a(async(t,r)=>{try{var i=e.i(620971),a=e.i(384030),n=e.i(738597);e.i(688768);var l=e.i(257357),u=e.i(909105),o=e.i(997103),s=t([a,n]);[a,n]=s.then?(await s)():s;let c=(0,a.withAuth)(async(e,t)=>{let r=await n.drizzleDb.select({curriculumId:l.curriculum.id,curriculumName:l.curriculum.name,curriculumSubject:l.curriculum.subject,curriculumDescription:l.curriculum.description,lastActivity:l.curriculumEnrollment.lastActivity,enrollmentSource:l.curriculumEnrollment.enrollmentSource}).from(l.curriculumEnrollment).innerJoin(l.curriculum,(0,u.eq)(l.curriculumEnrollment.curriculumId,l.curriculum.id)).where((0,u.eq)(l.curriculumEnrollment.studentId,t.user.id)),a=await n.drizzleDb.select().from(l.quizAttempt).where((0,u.eq)(l.quizAttempt.studentId,t.user.id)).orderBy((0,o.desc)(l.quizAttempt.completedAt)).limit(10),s=a.length>0?a.reduce((e,t)=>e+t.score/t.maxScore*100,0)/a.length:0,c=new Map;for(let e of r){let r=e.curriculumId;if(!c.has(r)){let e=(await n.drizzleDb.select().from(l.curriculumModule).where((0,u.eq)(l.curriculumModule.curriculumId,r))).map(e=>e.id),i=e.length>0?await n.drizzleDb.select().from(l.curriculumLesson).where((0,u.inArray)(l.curriculumLesson.moduleId,e)):[],a=(await n.drizzleDb.select().from(l.curriculumLessonProgress).where((0,u.eq)(l.curriculumLessonProgress.studentId,t.user.id))).filter(e=>"COMPLETED"===e.status&&i.some(t=>t.id===e.lessonId)).length;c.set(r,{total:i.length,completed:a})}}let d=r.map(e=>{var t,r;let{total:i,completed:a}=c.get(e.curriculumId)??{total:0,completed:0},n=i>0?Math.round(a/i*100):0,l=(t=e.curriculumSubject,r=s,(({english:["Grammar","Vocabulary","Writing","Reading Comprehension","Speaking"],math:["Algebra","Geometry","Calculus","Statistics","Problem Solving"],physics:["Mechanics","Thermodynamics","Electricity","Waves","Quantum"],chemistry:["Organic","Inorganic","Physical","Analytical","Biochemistry"],biology:["Cell Biology","Genetics","Ecology","Anatomy","Evolution"],history:["Ancient","Medieval","Modern","World Wars","Civilizations"],cs:["Programming","Algorithms","Data Structures","Databases","Web Dev"]})[t.toLowerCase()]||["Skill 1","Skill 2","Skill 3","Skill 4"]).map((e,t)=>({name:e,score:Math.min(100,Math.max(20,Math.round(r-8+4*t)))})));return{id:e.curriculumId,name:e.curriculumName,subject:e.curriculumSubject,description:e.curriculumDescription,progress:n,completedLessons:a,totalLessons:i,skills:l,confidence:Math.round(s),lastStudied:e.lastActivity?new Date(e.lastActivity).toLocaleDateString():null,enrollmentSource:e.enrollmentSource??null}});return i.NextResponse.json({subjects:d})},{role:"STUDENT"});e.s(["GET",0,c]),r()}catch(e){r(e)}},!1),30523,e=>e.a(async(t,r)=>{try{var i=e.i(78315),a=e.i(586961),n=e.i(196657),l=e.i(899733),u=e.i(233979),o=e.i(631683),s=e.i(840960),c=e.i(711373),d=e.i(699699),p=e.i(521140),m=e.i(205260),h=e.i(500249),v=e.i(431740),R=e.i(82608),g=e.i(635207),y=e.i(193695);e.i(708038);var E=e.i(447430),w=e.i(683459),f=t([w]);[w]=f.then?(await f)():f;let C=new i.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/student/subjects/route",pathname:"/api/student/subjects",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/ADK_WORKSPACE/TutorMekimi/tutorme-app/src/app/api/student/subjects/route.ts",nextConfigOutput:"",userland:w}),{workAsyncStorage:_,workUnitAsyncStorage:S,serverHooks:x}=C;function A(){return(0,n.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:S})}async function b(e,t,r){C.isDev&&(0,l.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let i="/api/student/subjects/route";i=i.replace(/\/index$/,"")||"/";let n=await C.prepare(e,t,{srcPage:i,multiZoneDraftMode:!1});if(!n)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:w,params:f,nextConfig:A,parsedUrl:b,isDraftMode:_,prerenderManifest:S,routerServerContext:x,isOnDemandRevalidate:P,revalidateOnlyGenerated:T,resolvedPathname:D,clientReferenceManifest:I,serverActionsManifest:M}=n,N=(0,s.normalizeAppPath)(i),k=!!(S.dynamicRoutes[N]||S.routes[D]),O=async()=>((null==x?void 0:x.render404)?await x.render404(e,t,b,!1):t.end("This page could not be found"),null);if(k&&!_){let e=!!S.routes[D],t=S.dynamicRoutes[N];if(t&&!1===t.fallback&&!e){if(A.experimental.adapterPath)return await O();throw new y.NoFallbackError}}let q=null;!k||C.isDev||_||(q=D,q="/index"===q?"/":q);let j=!0===C.isDev||!k,H=k&&!j;M&&I&&(0,o.setManifestsSingleton)({page:i,clientReferenceManifest:I,serverActionsManifest:M});let U=e.method||"GET",z=(0,u.getTracer)(),L=z.getActiveScopeSpan(),K={params:f,prerenderManifest:S,renderOpts:{experimental:{authInterrupts:!!A.experimental.authInterrupts},cacheComponents:!!A.cacheComponents,supportsDynamicResponse:j,incrementalCache:(0,l.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:A.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,i,a)=>C.onRequestError(e,t,i,a,x)},sharedContext:{buildId:w}},W=new c.NodeNextRequest(e),$=new c.NodeNextResponse(t),B=d.NextRequestAdapter.fromNodeNextRequest(W,(0,d.signalFromNodeResponse)(t));try{let n=async e=>C.handle(B,K).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=z.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${U} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${U} ${i}`)}),o=!!(0,l.getRequestMeta)(e,"minimalMode"),s=async l=>{var u,s;let c=async({previousCacheEntry:a})=>{try{if(!o&&P&&T&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await n(l);e.fetchMetrics=K.renderOpts.fetchMetrics;let u=K.renderOpts.pendingWaitUntil;u&&r.waitUntil&&(r.waitUntil(u),u=void 0);let s=K.renderOpts.collectedTags;if(!k)return await (0,h.sendResponse)(W,$,i,K.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,v.toNodeOutgoingHttpHeaders)(i.headers);s&&(t[g.NEXT_CACHE_TAGS_HEADER]=s),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==K.renderOpts.collectedRevalidate&&!(K.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&K.renderOpts.collectedRevalidate,a=void 0===K.renderOpts.collectedExpire||K.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:K.renderOpts.collectedExpire;return{value:{kind:E.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==a?void 0:a.isStale)&&await C.onRequestError(e,t,{routerKind:"App Router",routePath:i,routeType:"route",revalidateReason:(0,m.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:P})},!1,x),t}},d=await C.handleResponse({req:e,nextConfig:A,cacheKey:q,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:S,isRoutePPREnabled:!1,isOnDemandRevalidate:P,revalidateOnlyGenerated:T,responseGenerator:c,waitUntil:r.waitUntil,isMinimalMode:o});if(!k)return null;if((null==d||null==(u=d.value)?void 0:u.kind)!==E.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(s=d.value)?void 0:s.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",P?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),_&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,v.fromNodeOutgoingHttpHeaders)(d.value.headers);return o&&k||p.delete(g.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,R.getCacheControlHeader)(d.cacheControl)),await (0,h.sendResponse)(W,$,new Response(d.value.body,{headers:p,status:d.value.status||200})),null};L?await s(L):await z.withPropagatedContext(e.headers,()=>z.trace(p.BaseServerSpan.handleRequest,{spanName:`${U} ${i}`,kind:u.SpanKind.SERVER,attributes:{"http.method":U,"http.target":e.url}},s))}catch(t){if(t instanceof y.NoFallbackError||await C.onRequestError(e,t,{routerKind:"App Router",routePath:N,routeType:"route",revalidateReason:(0,m.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:P})},!1,x),k)throw t;return await (0,h.sendResponse)(W,$,new Response(null,{status:500})),null}}e.s(["handler",()=>b,"patchFetch",()=>A,"routeModule",()=>C,"serverHooks",()=>x,"workAsyncStorage",()=>_,"workUnitAsyncStorage",()=>S]),r()}catch(e){r(e)}},!1),412171,e=>{e.v(t=>Promise.all(["server/chunks/b1c00_TutorMekimi_tutorme-app_src_lib_security_suspicious-activity_ts_7865686f._.js"].map(t=>e.l(t))).then(()=>t(145830)))},443460,e=>{e.v(t=>Promise.all(["server/chunks/[externals]_ioredis_c74819ca._.js"].map(t=>e.l(t))).then(()=>t(693545)))},571363,e=>{e.v(t=>Promise.all(["server/chunks/ADK_WORKSPACE_TutorMekimi_tutorme-app_src_lib_security_api-key_ts_45091e81._.js"].map(t=>e.l(t))).then(()=>t(175922)))}];

//# debugId=21043a7e-9f34-dc43-b57c-daf7bee9e8bf
//# sourceMappingURL=%5Broot-of-the-server%5D__603ca9a9._.js.map