;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="86ae7f26-1193-03e1-f6ea-f1917544e80b")}catch(e){}}();
module.exports=[349111,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={callServer:function(){return f.callServer},createServerReference:function(){return h.createServerReference},findSourceMapURL:function(){return g.findSourceMapURL}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(30887),g=a.r(5391),h=a.r(669531)},98919,a=>{"use strict";let b,c,d,e,f,g,h,i,j,k;var l,m,n,o,p,q,r,s,t=a.i(260576),u=a.i(454069),v=a.i(741510),w=a.i(326684),x=a.i(680233),y=a.i(88684),z=a.i(333340),A=a.i(868606),B=a.i(263805),C=a.i(637757),D=a.i(962337),E=a.i(846438),F=a.i(113098),G=a.i(981354),H=a.i(164504),I=a.i(185407),J=a.i(494176),K=a.i(147779),L=a.i(711503),M=a.i(784276),N=a.i(808967),O=a.i(60390),P=a.i(845279),Q=a.i(309402),R=a.i(458588),S=a.i(934469),T=a.i(11894),U=a.i(324666),V=a.i(50169);function W({students:a,breakoutRooms:b,onCallOn:c,onAssignToRoom:d,onRemoveFromRoom:e,onPushHint:f,onSendNudge:g,onInviteToBreakout:h}){let[i,j]=(0,v.useState)(""),[k,l]=(0,v.useState)("all"),m=a.filter(a=>{let b=a.name.toLowerCase().includes(i.toLowerCase()),c="all"===k||"online"===k&&"online"===a.status||"away"===k&&("idle"===a.status||"away"===a.status)||"hand-raised"===k&&a.handRaised;return b&&c}),n=a.filter(a=>"online"===a.status).length,o=a.filter(a=>a.handRaised).length;return(0,t.jsxs)(F.Card,{className:"h-full flex flex-col",children:[(0,t.jsxs)(F.CardHeader,{className:"pb-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(K.Users,{className:"w-4 h-4"}),(0,t.jsx)(F.CardTitle,{className:"text-sm font-medium",children:"Students"}),(0,t.jsxs)(z.Badge,{variant:"secondary",className:"text-xs",children:[n,"/",a.length]})]}),o>0&&(0,t.jsxs)(z.Badge,{variant:"destructive",className:"gap-1",children:[(0,t.jsx)(L.Hand,{className:"w-3 h-3"}),o]})]}),(0,t.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(R.Search,{className:"absolute left-2.5 top-2.5 w-4 h-4 text-gray-400"}),(0,t.jsx)(G.Input,{placeholder:"Search students...",value:i,onChange:a=>j(a.target.value),className:"pl-9 h-9"})]}),(0,t.jsxs)(D.DropdownMenu,{children:[(0,t.jsx)(D.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(y.Button,{variant:"outline",size:"icon",className:"h-9 w-9",children:(0,t.jsx)(S.Filter,{className:"w-4 h-4"})})}),(0,t.jsxs)(D.DropdownMenuContent,{align:"end",children:[(0,t.jsx)(D.DropdownMenuItem,{onClick:()=>l("all"),children:"All Students"}),(0,t.jsx)(D.DropdownMenuItem,{onClick:()=>l("online"),children:"Online Only"}),(0,t.jsx)(D.DropdownMenuItem,{onClick:()=>l("away"),children:"Idle/Away"}),(0,t.jsx)(D.DropdownMenuItem,{onClick:()=>l("hand-raised"),children:"Hand Raised"})]})]})]})]}),(0,t.jsx)(F.CardContent,{className:"flex-1 p-0",children:(0,t.jsx)(I.ScrollArea,{className:"h-[calc(100%-100px)]",children:(0,t.jsx)("div",{className:"space-y-1 px-4 pb-4",children:0===m.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(K.Users,{className:"w-10 h-10 text-gray-300 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"No students found"})]}):m.map(a=>{var i;return(0,t.jsxs)("div",{className:(0,J.cn)("flex items-center gap-3 p-3 rounded-lg border transition-all",a.handRaised?"bg-yellow-50 border-yellow-200":"bg-white border-gray-100 hover:border-gray-200"),children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(H.Avatar,{className:"w-10 h-10",children:(0,t.jsx)(H.AvatarFallback,{className:"bg-blue-100 text-blue-700 text-sm",children:a.name.split(" ").map(a=>a[0]).join("")})}),(0,t.jsx)("span",{className:(0,J.cn)("absolute bottom-0 right-0 w-3 h-3 rounded-full border-2 border-white",(a=>{switch(a){case"online":return"bg-green-500";case"idle":return"bg-yellow-500";case"away":return"bg-orange-500";default:return"bg-gray-400"}})(a.status))})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-medium text-sm truncate",children:a.name}),a.handRaised&&(0,t.jsx)(L.Hand,{className:"w-4 h-4 text-yellow-600 animate-pulse"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[(0,t.jsxs)("span",{className:(0,J.cn)("font-medium",(i=a.engagementScore)>=80?"text-green-600":i>=60?"text-blue-600":i>=40?"text-yellow-600":"text-red-600"),children:[a.engagementScore,"% engaged"]}),a.breakoutRoomId&&(0,t.jsx)("span",{className:"text-blue-600",children:b.find(b=>b.id===a.breakoutRoomId)?.name})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[a.handRaised&&(0,t.jsx)(y.Button,{size:"sm",variant:"ghost",className:"h-8 text-yellow-700 hover:text-yellow-800 hover:bg-yellow-100",onClick:()=>c?.(a.id),children:"Call On"}),(0,t.jsxs)(D.DropdownMenu,{children:[(0,t.jsx)(D.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(y.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,t.jsx)(M.MoreVertical,{className:"w-4 h-4"})})}),(0,t.jsxs)(D.DropdownMenuContent,{align:"end",children:[(0,t.jsxs)(D.DropdownMenuItem,{onClick:()=>c?.(a.id),children:[(0,t.jsx)(O.MessageCircle,{className:"w-4 h-4 mr-2"}),"Send Message"]}),b.length>0&&!a.breakoutRoomId&&(0,t.jsx)(D.DropdownMenuItem,{asChild:!0,children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(P.UserPlus,{className:"w-4 h-4 mr-2"}),"Assign to Room",(0,t.jsx)("div",{className:"absolute left-full top-0 ml-1 bg-white border rounded-lg shadow-lg p-1 min-w-[120px]",children:b.map(b=>(0,t.jsx)("button",{className:"w-full text-left px-2 py-1 text-sm hover:bg-gray-100 rounded",onClick:()=>d?.(a.id,b.id),children:b.name},b.id))})]})}),a.breakoutRoomId&&(0,t.jsxs)(D.DropdownMenuItem,{onClick:()=>e?.(a.id),children:[(0,t.jsx)(Q.LogOut,{className:"w-4 h-4 mr-2"}),"Remove from Room"]}),(0,t.jsxs)(D.DropdownMenuItem,{onClick:()=>f?.(a.id,"Remember to think about the key concept we discussed.","socratic"),children:[(0,t.jsx)(T.Lightbulb,{className:"w-4 h-4 mr-2"}),"Send Socratic Hint"]}),(0,t.jsxs)(D.DropdownMenuItem,{onClick:()=>g?.(a.id),children:[(0,t.jsx)(U.Bell,{className:"w-4 h-4 mr-2"}),"Send Nudge"]}),b.length>0&&(0,t.jsxs)(D.DropdownMenuItem,{onClick:()=>h?.(a.id),children:[(0,t.jsx)(V.LayoutGrid,{className:"w-4 h-4 mr-2"}),"Invite to Breakout"]}),(0,t.jsxs)(D.DropdownMenuItem,{className:"text-red-600",children:[(0,t.jsx)(N.MicOff,{className:"w-4 h-4 mr-2"}),"Mute"]})]})]})]})]},a.id)})})})})]})}var X=a.i(206209),Y=a.i(656247),Z=a.i(595484),$=a.i(970034),_=a.i(458563),aa=a.i(293357);let ab=(0,aa.default)("shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]);var ac=a.i(712959),ad=a.i(560467),ae=a.i(226886);let af=(0,aa.default)("door-open",[["path",{d:"M11 20H2",key:"nlcfvz"}],["path",{d:"M11 4.562v16.157a1 1 0 0 0 1.242.97L19 20V5.562a2 2 0 0 0-1.515-1.94l-4-1A2 2 0 0 0 11 4.561z",key:"au4z13"}],["path",{d:"M11 4H8a2 2 0 0 0-2 2v14",key:"74r1mk"}],["path",{d:"M14 12h.01",key:"1jfl7z"}],["path",{d:"M22 20h-3",key:"vhrsz"}]]);var ag=a.i(50730);let ah=[{key:"random",label:"Random",description:"Mix students randomly",icon:ab},{key:"skill_based",label:"Skill Based",description:"Group by performance level",icon:_.Target},{key:"social",label:"Social/Mixed",description:"Mix abilities for peer teaching",icon:P.UserPlus},{key:"manual",label:"Manual",description:"You assign students",icon:ac.Settings2},{key:"self_select",label:"Self Select",description:"Students choose groups",icon:K.Users}];function ai({config:a,setConfig:b,suggestion:c,students:d,onCreate:e,onCancel:f}){let g=d.filter(a=>"online"===a.status);return(0,t.jsx)("div",{className:"h-full flex flex-col bg-gray-50 p-6 overflow-auto",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto w-full space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,t.jsx)(ae.Sparkles,{className:"h-6 w-6 text-purple-600"}),"Create Breakout Rooms"]}),(0,t.jsx)("p",{className:"text-gray-500",children:"Configure and start breakout sessions"})]}),(0,t.jsxs)(y.Button,{variant:"outline",onClick:f,children:[(0,t.jsx)(Y.X,{className:"h-4 w-4 mr-1"}),"Cancel"]})]}),c&&(0,t.jsxs)(F.Card,{className:"bg-purple-50 border-purple-200",children:[(0,t.jsx)(F.CardHeader,{children:(0,t.jsxs)(F.CardTitle,{className:"text-purple-900 text-base flex items-center gap-2",children:[(0,t.jsx)($.Brain,{className:"h-5 w-5 text-purple-600"}),"AI Grouping Suggestion",(0,t.jsxs)(z.Badge,{variant:"secondary",className:"ml-2",children:[Math.round(100*c.confidence),"% confidence"]})]})}),(0,t.jsxs)(F.CardContent,{children:[(0,t.jsx)("p",{className:"text-sm text-purple-800 mb-3",children:c.description}),(0,t.jsx)("div",{className:"space-y-2",children:c.groups.map((a,b)=>(0,t.jsxs)("div",{className:"p-3 bg-white rounded-lg border border-purple-100",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsxs)("span",{className:"text-sm font-medium",children:["Group ",b+1]}),(0,t.jsxs)(z.Badge,{variant:"outline",className:"text-[10px]",children:[a.members.length," members"]}),(0,t.jsxs)("div",{className:"flex gap-1 ml-auto",children:[a.skillProfile.beginners>0&&(0,t.jsxs)(z.Badge,{className:"text-[10px] bg-blue-100 text-blue-700",children:[a.skillProfile.beginners," B"]}),a.skillProfile.intermediate>0&&(0,t.jsxs)(z.Badge,{className:"text-[10px] bg-green-100 text-green-700",children:[a.skillProfile.intermediate," I"]}),a.skillProfile.advanced>0&&(0,t.jsxs)(z.Badge,{className:"text-[10px] bg-purple-100 text-purple-700",children:[a.skillProfile.advanced," A"]})]})]}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:a.rationale}),(0,t.jsxs)("p",{className:"text-xs text-green-600 mt-1",children:["Expected: ",a.predictedOutcome]})]},b))})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,t.jsxs)(F.Card,{children:[(0,t.jsx)(F.CardHeader,{children:(0,t.jsx)(F.CardTitle,{className:"text-base",children:"Room Configuration"})}),(0,t.jsxs)(F.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Number of Rooms"}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(y.Button,{variant:"outline",size:"icon",onClick:()=>b({...a,roomCount:Math.max(1,a.roomCount-1)}),children:(0,t.jsx)(Y.X,{className:"h-4 w-4"})}),(0,t.jsx)("span",{className:"text-2xl font-bold w-12 text-center",children:a.roomCount}),(0,t.jsx)(y.Button,{variant:"outline",size:"icon",onClick:()=>b({...a,roomCount:Math.min(10,a.roomCount+1)}),children:(0,t.jsx)(Z.Plus,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Students per Room"}),(0,t.jsxs)(X.Select,{value:a.participantsPerRoom.toString(),onValueChange:c=>b({...a,participantsPerRoom:parseInt(c)}),children:[(0,t.jsx)(X.SelectTrigger,{children:(0,t.jsx)(X.SelectValue,{})}),(0,t.jsxs)(X.SelectContent,{children:[(0,t.jsx)(X.SelectItem,{value:"2",children:"2 students"}),(0,t.jsx)(X.SelectItem,{value:"3",children:"3 students"}),(0,t.jsx)(X.SelectItem,{value:"4",children:"4 students"}),(0,t.jsx)(X.SelectItem,{value:"5",children:"5 students"}),(0,t.jsx)(X.SelectItem,{value:"6",children:"6 students"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Time Limit (minutes)"}),(0,t.jsxs)(X.Select,{value:a.timeLimit.toString(),onValueChange:c=>b({...a,timeLimit:parseInt(c)}),children:[(0,t.jsx)(X.SelectTrigger,{children:(0,t.jsx)(X.SelectValue,{})}),(0,t.jsxs)(X.SelectContent,{children:[(0,t.jsx)(X.SelectItem,{value:"5",children:"5 minutes"}),(0,t.jsx)(X.SelectItem,{value:"10",children:"10 minutes"}),(0,t.jsx)(X.SelectItem,{value:"15",children:"15 minutes"}),(0,t.jsx)(X.SelectItem,{value:"20",children:"20 minutes"}),(0,t.jsx)(X.SelectItem,{value:"30",children:"30 minutes"}),(0,t.jsx)(X.SelectItem,{value:"45",children:"45 minutes"})]})]})]})]})]}),(0,t.jsxs)(F.Card,{children:[(0,t.jsx)(F.CardHeader,{children:(0,t.jsx)(F.CardTitle,{className:"text-base",children:"Distribution Strategy"})}),(0,t.jsxs)(F.CardContent,{className:"space-y-3",children:[ah.map(({key:c,label:d,description:e,icon:f})=>(0,t.jsx)("button",{onClick:()=>b({...a,distributionMode:c}),className:(0,J.cn)("w-full p-3 rounded-lg border text-left transition-colors",a.distributionMode===c?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"),children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[a.distributionMode===c&&(0,t.jsx)(ad.CheckCircle,{className:"h-5 w-5 text-blue-600"}),(0,t.jsx)("div",{className:(0,J.cn)("text-gray-400",a.distributionMode===c&&"text-blue-600"),children:(0,t.jsx)(f,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-sm",children:d}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e})]})]})},c)),(0,t.jsx)("div",{className:"pt-4 border-t",children:(0,t.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:a.aiAssistantEnabled,onChange:c=>b({...a,aiAssistantEnabled:c.target.checked}),className:"w-5 h-5 rounded border-gray-300"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"block text-sm font-medium",children:"Enable AI Assistant in rooms"}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"AI will monitor and assist students"})]})]})})]})]})]}),(0,t.jsx)(F.Card,{className:"bg-gray-50 border-gray-200",children:(0,t.jsx)(F.CardContent,{className:"p-4",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(K.Users,{className:"h-5 w-5 text-gray-400"}),(0,t.jsxs)("span",{className:"text-sm",children:[(0,t.jsx)("strong",{children:g.length})," students available"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(af,{className:"h-5 w-5 text-gray-400"}),(0,t.jsxs)("span",{className:"text-sm",children:[(0,t.jsx)("strong",{children:a.roomCount})," rooms"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ag.Clock,{className:"h-5 w-5 text-gray-400"}),(0,t.jsxs)("span",{className:"text-sm",children:[(0,t.jsx)("strong",{children:a.timeLimit})," minutes"]})]})]})})})}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(y.Button,{variant:"outline",className:"flex-1",onClick:f,children:"Cancel"}),(0,t.jsxs)(y.Button,{className:"flex-1",onClick:e,children:[(0,t.jsx)(af,{className:"h-4 w-4 mr-2"}),"Create ",a.roomCount," Room",1!==a.roomCount?"s":""]})]})]})})}let aj=[{id:"discuss",title:"Group Discussion",description:"Discuss the key concepts covered in today's lesson. Share your understanding and ask clarifying questions.",type:"discussion"},{id:"problem",title:"Problem Solving",description:"Work together to solve the assigned problem set. Each member should contribute their approach.",type:"problem"},{id:"peer-teach",title:"Peer Teaching",description:"Each student takes turns explaining a concept to the group. Teach each other!",type:"discussion"},{id:"project",title:"Mini Project",description:"Collaborate on creating a presentation or solution to the given challenge.",type:"project"}],ak=(0,aa.default)("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]]);var al=a.i(619886);function am({room:a,unassignedStudents:b,onAssignStudent:c,onRemoveStudent:d,onJoinRoom:e,onExtendTime:f,onAssignTask:g}){var h;let i,[j,k]=(0,v.useState)(!1);return(0,t.jsxs)("div",{className:"h-full flex flex-col p-4",children:[(0,t.jsx)(F.Card,{className:"mb-4",children:(0,t.jsx)(F.CardHeader,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)(F.CardTitle,{className:"text-lg",children:a.name}),(a=>{switch(a){case"active":return(0,t.jsx)(z.Badge,{className:"bg-green-500",children:"Active"});case"forming":return(0,t.jsx)(z.Badge,{variant:"outline",className:"border-blue-500 text-blue-600",children:"Forming"});case"paused":return(0,t.jsx)(z.Badge,{variant:"outline",className:"border-yellow-500 text-yellow-600",children:"Paused"});case"closed":return(0,t.jsx)(z.Badge,{variant:"secondary",children:"Closed"});default:return(0,t.jsx)(z.Badge,{variant:"outline",children:a})}})(a.status),a.aiEnabled&&(0,t.jsxs)(z.Badge,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-200",children:[(0,t.jsx)($.Brain,{className:"h-3 w-3 mr-1"}),"AI"]})]}),a.topic&&(0,t.jsx)("p",{className:"text-sm text-gray-500",children:a.topic})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:"active"===a.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:(0,J.cn)("flex items-center gap-1 px-2 py-1 rounded text-sm font-medium",a.timeRemaining<60?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:[(0,t.jsx)(ag.Clock,{className:"h-4 w-4"}),(i=Math.floor((h=a.timeRemaining)/60),`${i}:${(h%60).toString().padStart(2,"0")}`)]}),(0,t.jsxs)(y.Button,{onClick:()=>e(a),children:[(0,t.jsx)(ak,{className:"h-4 w-4 mr-2"}),"Join Room"]})]})})]})})}),(0,t.jsxs)("div",{className:"flex-1 grid grid-cols-2 gap-4 min-h-0",children:[(0,t.jsxs)(F.Card,{className:"flex flex-col",children:[(0,t.jsx)(F.CardHeader,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(F.CardTitle,{className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(K.Users,{className:"h-4 w-4"}),"Students (",a.participants.filter(a=>"student"===a.role).length,")"]}),b.length>0&&(0,t.jsxs)(y.Button,{variant:"ghost",size:"sm",onClick:()=>k(!j),children:[(0,t.jsx)(P.UserPlus,{className:"h-4 w-4 mr-1"}),"Add"]})]})}),(0,t.jsx)(F.CardContent,{className:"flex-1 overflow-hidden",children:(0,t.jsx)(I.ScrollArea,{className:"h-full",children:(0,t.jsxs)("div",{className:"space-y-2",children:[0===a.participants.filter(a=>"student"===a.role).length?(0,t.jsx)("p",{className:"text-sm text-gray-400 italic",children:"No students assigned"}):a.participants.filter(a=>"student"===a.role).map(b=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:(0,J.cn)("w-2 h-2 rounded-full",b.isOnline?"bg-green-500":"bg-gray-400")}),(0,t.jsx)("span",{className:"text-sm",children:b.name}),b.handRaised&&(0,t.jsx)(al.AlertCircle,{className:"h-3 w-3 text-yellow-500"})]}),(0,t.jsx)(y.Button,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>d(a.id,b.userId),children:(0,t.jsx)(Q.LogOut,{className:"h-3 w-3 text-gray-400"})})]},b.id)),j&&b.length>0&&(0,t.jsxs)("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[(0,t.jsx)("h4",{className:"text-sm font-medium mb-2 text-blue-900",children:"Add Students"}),(0,t.jsx)("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:b.map(d=>(0,t.jsxs)("button",{className:"w-full text-left px-2 py-1.5 text-sm hover:bg-blue-100 rounded flex items-center gap-2",onClick:()=>{c(a.id,d.id),1===b.length&&k(!1)},children:[(0,t.jsx)(Z.Plus,{className:"h-3 w-3"}),d.name]},d.id))})]})]})})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(F.Card,{children:[(0,t.jsx)(F.CardHeader,{className:"pb-3",children:(0,t.jsx)(F.CardTitle,{className:"text-sm font-medium",children:"Assigned Task"})}),(0,t.jsxs)(F.CardContent,{children:[a.assignedTask?(0,t.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,t.jsx)("p",{className:"font-medium text-sm",children:a.assignedTask.title}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:a.assignedTask.description})]}):(0,t.jsx)("p",{className:"text-sm text-gray-400 italic",children:"No task assigned"}),(0,t.jsxs)("div",{className:"mt-3 space-y-1",children:[(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Assign a task:"}),aj.map(b=>(0,t.jsx)("button",{onClick:()=>g(a.id,b),className:"w-full text-left p-2 text-xs bg-gray-50 hover:bg-gray-100 rounded transition-colors",children:(0,t.jsx)("span",{className:"font-medium",children:b.title})},b.id))]})]})]}),"active"===a.status&&(0,t.jsxs)(F.Card,{children:[(0,t.jsx)(F.CardHeader,{className:"pb-3",children:(0,t.jsxs)(F.CardTitle,{className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(ag.Clock,{className:"h-4 w-4"}),"Extend Time"]})}),(0,t.jsx)(F.CardContent,{children:(0,t.jsx)("div",{className:"flex gap-2",children:[5,10,15,30].map(b=>(0,t.jsxs)(y.Button,{size:"sm",variant:"outline",className:"flex-1 text-xs",onClick:()=>f(a.id,b),children:["+",b,"m"]},b))})})]}),(0,t.jsxs)(F.Card,{children:[(0,t.jsx)(F.CardHeader,{className:"pb-3",children:(0,t.jsx)(F.CardTitle,{className:"text-sm font-medium",children:"Metrics"})}),(0,t.jsx)(F.CardContent,{children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,t.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,t.jsx)("p",{className:"text-gray-500 text-xs",children:"Messages"}),(0,t.jsx)("p",{className:"font-medium",children:a.metrics.messagesExchanged})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,t.jsx)("p",{className:"text-gray-500 text-xs",children:"Engagement"}),(0,t.jsxs)("p",{className:"font-medium",children:[a.metrics.avgEngagement,"%"]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,t.jsx)("p",{className:"text-gray-500 text-xs",children:"Participation"}),(0,t.jsxs)("p",{className:"font-medium",children:[a.metrics.participationRate,"%"]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-2 rounded",children:[(0,t.jsx)("p",{className:"text-gray-500 text-xs",children:"Topic Focus"}),(0,t.jsxs)("p",{className:"font-medium",children:[a.metrics.topicAdherence,"%"]})]})]})})]}),a.alerts.length>0&&(0,t.jsxs)(F.Card,{className:"border-red-200",children:[(0,t.jsx)(F.CardHeader,{className:"pb-3",children:(0,t.jsxs)(F.CardTitle,{className:"text-sm font-medium flex items-center gap-2 text-red-700",children:[(0,t.jsx)(al.AlertCircle,{className:"h-4 w-4"}),"Alerts (",a.alerts.length,")"]})}),(0,t.jsx)(F.CardContent,{children:(0,t.jsx)("div",{className:"space-y-2",children:a.alerts.slice(0,3).map((a,b)=>(0,t.jsxs)("div",{className:(0,J.cn)("p-2 rounded text-xs","high"===a.severity?"bg-red-50 text-red-700":"medium"===a.severity?"bg-yellow-50 text-yellow-700":"bg-blue-50 text-blue-700"),children:[(0,t.jsxs)("span",{className:"font-medium",children:[a.type,":"]})," ",a.message]},b))})})]})]})]})]})}var an=a.i(94261),ao=a.i(939471),ap=a.i(856187),aq=a.i(946685);function ar({rooms:a,onSelectRoom:b,onJoinRoom:c}){return(0,t.jsx)("div",{className:"h-full p-4 overflow-auto",children:(0,t.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(a=>{var d;let e;return(0,t.jsxs)(F.Card,{className:(0,J.cn)("cursor-pointer transition-all hover:shadow-md",a.alerts.length>0&&"border-yellow-400"),onClick:()=>b(a.id),children:[(0,t.jsxs)(F.CardHeader,{className:"pb-3",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:(0,J.cn)("w-3 h-3 rounded-full",(a=>{switch(a){case"active":return"bg-green-500";case"forming":return"bg-blue-500";case"paused":return"bg-yellow-500";case"closed":return"bg-gray-500";default:return"bg-gray-400"}})(a.status))}),(0,t.jsx)(F.CardTitle,{className:"text-base",children:a.name})]}),(0,t.jsx)(an.TooltipProvider,{children:(0,t.jsxs)(an.Tooltip,{children:[(0,t.jsx)(an.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(y.Button,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:b=>{b.stopPropagation(),c(a)},disabled:"active"!==a.status,children:(0,t.jsx)(ak,{className:"h-4 w-4"})})}),(0,t.jsx)(an.TooltipContent,{children:(0,t.jsx)("p",{children:"Join Room"})})]})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,t.jsx)(K.Users,{className:"h-3 w-3"}),a.participants.length," participants",a.aiEnabled&&(0,t.jsxs)(z.Badge,{variant:"secondary",className:"text-xs bg-purple-100 text-purple-700",children:[(0,t.jsx)($.Brain,{className:"h-3 w-3 mr-1"}),"AI"]})]})]}),(0,t.jsxs)(F.CardContent,{className:"space-y-3",children:[a.assignedTask&&(0,t.jsxs)("div",{className:"p-2 bg-gray-50 rounded text-xs",children:[(0,t.jsx)("p",{className:"font-medium text-gray-700",children:a.assignedTask.title}),(0,t.jsx)("p",{className:"text-gray-500 truncate",children:a.assignedTask.description})]}),"active"===a.status&&(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-[10px]",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 text-gray-500",children:[(0,t.jsx)(ap.MessageSquare,{className:"h-3 w-3"}),a.metrics.messagesExchanged," msgs"]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-gray-500",children:[(0,t.jsx)(aq.BarChart3,{className:"h-3 w-3"}),Math.round(a.metrics.avgEngagement),"% engaged"]})]}),"active"===a.status&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)(ao.Timer,{className:(0,J.cn)("h-4 w-4",a.timeRemaining<60?"text-red-500":"text-gray-400")}),(0,t.jsx)("span",{className:(0,J.cn)(a.timeRemaining<60?"text-red-600 font-medium":"text-gray-600"),children:(e=Math.floor((d=a.timeRemaining)/60),`${e}:${(d%60).toString().padStart(2,"0")}`)})]}),a.alerts.length>0&&(0,t.jsxs)("div",{className:"space-y-1",children:[a.alerts.slice(0,2).map((a,b)=>(0,t.jsxs)("div",{className:(0,J.cn)("flex items-center gap-2 text-xs px-2 py-1 rounded","high"===a.severity?"bg-red-50 text-red-700":"medium"===a.severity?"bg-yellow-50 text-yellow-700":"bg-blue-50 text-blue-700"),children:[(0,t.jsx)("span",{children:(a=>{switch(a){case"confusion":return"â“";case"conflict":return"âš ï¸";case"off_topic":return"ðŸŽ¯";case"need_help":return"ðŸ†˜";case"quiet":return"ðŸ”‡";default:return"ðŸ””"}})(a.type)}),(0,t.jsx)("span",{className:"truncate",children:a.message})]},b)),a.alerts.length>2&&(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["+",a.alerts.length-2," more alerts"]})]})]})]},a.id)})})})}var as=a.i(700857),at=a.i(832692);let au=(0,aa.default)("megaphone",[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]]);function av({sessionId:a,tutorId:b,tutorName:c,students:d,onRoomsChange:e,onJoinRoom:f}){let{rooms:g,createRooms:h,endAllRooms:i,assignStudent:j,removeStudent:k,broadcastMessage:l,extendTime:m,assignTask:n}=function({sessionId:a,userId:b,userName:c,role:d}){let{socket:e,isConnected:f}=(0,x.useSocket)(),[g,h]=(0,v.useState)([]),i=(0,v.useRef)([]),j=(0,v.useCallback)(a=>({id:a.id,userId:a.userId||a.id,name:a.name,role:a.role||"student",joinedAt:a.joinedAt||new Date().toISOString(),isOnline:a.isOnline??!0,isMuted:a.isMuted??!1,isVideoOff:a.isVideoOff??!1,isScreenSharing:a.isScreenSharing??!1,engagementScore:a.engagementScore??0,attentionLevel:a.attentionLevel||"medium",handRaised:a.handRaised??!1}),[]),k=(0,v.useCallback)(b=>({id:b.id,name:b.name,mainRoomId:b.mainRoomId||a,participants:(b.participants||[]).map(a=>j(a)),maxParticipants:b.maxParticipants??6,status:b.status||"forming",timeRemaining:b.timeRemaining??b.timeLimit??0,timeLimit:b.timeLimit??b.timeRemaining??0,startedAt:b.startedAt,endsAt:b.endsAt,aiEnabled:b.aiEnabled??!0,aiMode:b.aiMode||"passive",assignedTask:b.assignedTask,topic:b.topic,alerts:b.alerts||[],metrics:b.metrics||{messagesExchanged:0,avgEngagement:0,participationRate:0,topicAdherence:0,lastUpdated:new Date().toISOString()},videoRoom:b.videoRoom,messages:b.messages||[]}),[j,a]);(0,v.useEffect)(()=>{i.current=g},[g]),(0,v.useEffect)(()=>{if(e&&f)return e.emit("breakout:join_coordination",{mainRoomId:a,userId:b,name:c,role:d}),e.emit("join_breakout_coordination",{mainRoomId:a,userId:b,name:c,role:d}),()=>{e.emit("breakout:leave_coordination",{mainRoomId:a,userId:b}),e.emit("breakout_leave_coordination",{mainRoomId:a,userId:b})}},[e,f,a,b,c,d]),(0,v.useEffect)(()=>{if(!e)return;let a=a=>{h(a.rooms.map(k))},b=a=>{h(b=>[...b,k(a.room)])},c=a=>{h(b=>b.filter(b=>b.id!==a.roomId))},d=a=>{h(b=>b.map(b=>b.id===a.roomId?{...b,participants:[...b.participants,j(a.participant)]}:b))},f=a=>{let b=a.userId||a.participantId;b&&h(c=>c.map(c=>c.id===a.roomId?{...c,participants:c.participants.filter(a=>a.userId!==b)}:c))},g=a=>{h(b=>b.map(b=>b.id===a.roomId?{...b,timeRemaining:a.secondsRemaining}:b))},i=a=>{h(b=>b.map(b=>b.id===a.roomId?{...b,timeRemaining:a.newTimeRemaining}:b))},l=a=>{let b={id:a.alert.id||`${a.roomId}-${Date.now()}`,type:a.alert.type,message:a.alert.message,timestamp:a.alert.timestamp||new Date().toISOString(),severity:a.alert.severity||"medium",participantId:a.alert.participantId,acknowledged:a.alert.acknowledged??!1};h(c=>c.map(c=>c.id===a.roomId?{...c,alerts:[...c.alerts,b]}:c))},m=a=>{let b="content"in a?a:{id:a.id,roomId:a.roomId,senderId:a.senderId,senderName:a.senderName,senderRole:"student",content:a.message,timestamp:"number"==typeof a.timestamp?new Date(a.timestamp).toISOString():a.timestamp,type:"text"};h(a=>a.map(a=>a.id===b.roomId?{...a,messages:[...a.messages,b],metrics:{...a.metrics,messagesExchanged:a.metrics.messagesExchanged+1}}:a))},n=a=>{h(b=>b.map(b=>b.id===a.roomId?{...b,metrics:{...b.metrics,...a.metrics}}:b))};return e.on("breakout:rooms_updated",a),e.on("breakout_rooms_created",a),e.on("breakout:room_created",b),e.on("breakout:room_ended",c),e.on("breakout:participant_joined",d),e.on("breakout_participant_joined",d),e.on("breakout:participant_left",f),e.on("breakout_participant_left",f),e.on("breakout:countdown",g),e.on("breakout_countdown",g),e.on("breakout:time_extended",i),e.on("breakout:alert",l),e.on("breakout_alert",l),e.on("breakout:message",m),e.on("breakout_message",m),e.on("breakout:metrics_update",n),()=>{e.off("breakout:rooms_updated",a),e.off("breakout_rooms_created",a),e.off("breakout:room_created",b),e.off("breakout:room_ended",c),e.off("breakout:participant_joined",d),e.off("breakout_participant_joined",d),e.off("breakout:participant_left",f),e.off("breakout_participant_left",f),e.off("breakout:countdown",g),e.off("breakout_countdown",g),e.off("breakout:time_extended",i),e.off("breakout:alert",l),e.off("breakout_alert",l),e.off("breakout:message",m),e.off("breakout_message",m),e.off("breakout:metrics_update",n)}},[e,k,j]);let l=(0,v.useCallback)(b=>{e?.emit("breakout:create",{mainRoomId:a,config:b}),e?.emit("breakout_create",{mainRoomId:a,config:b})},[e,a]),m=(0,v.useCallback)(a=>{e?.emit("breakout:join",{roomId:a,userId:b,name:c,role:d}),e?.emit("breakout_join",{roomId:a,userId:b,name:c,role:d})},[e,b,c,d]),n=(0,v.useCallback)(a=>{e?.emit("breakout:leave",{roomId:a,userId:b}),e?.emit("breakout_leave",{roomId:a,userId:b})},[e,b]),o=(0,v.useCallback)(a=>{e?.emit("breakout:end",{roomId:a})},[e]),p=(0,v.useCallback)(()=>{e?.emit("breakout:end_all",{mainRoomId:a}),e?.emit("breakout_close",{mainRoomId:a})},[e,a]),q=(0,v.useCallback)((a,b)=>{e?.emit("breakout:assign",{roomId:a,studentId:b})},[e]),r=(0,v.useCallback)((a,b)=>{e?.emit("breakout:remove",{roomId:a,studentId:b})},[e]),s=(0,v.useCallback)(()=>{e?.emit("breakout:rotate",{sessionId:a})},[e,a]),t=(0,v.useCallback)((a,b,c)=>{e?.emit("breakout:message",{roomId:a,content:b,type:c}),e?.emit("breakout_message",{roomId:a,message:b,type:c})},[e]),u=(0,v.useCallback)((b,c,d)=>{e?.emit("breakout:broadcast",{mainRoomId:a,message:b,target:c,roomIds:d}),e?.emit("breakout_broadcast",{mainRoomId:a,message:b,target:c,roomIds:d})},[e,a]),w=(0,v.useCallback)((a,b)=>{e?.emit("breakout:extend",{roomId:a,minutes:b})},[e]),y=(0,v.useCallback)((a,b)=>{e?.emit("breakout:assign_task",{roomId:a,task:b})},[e]),z=(0,v.useCallback)((a,b)=>{e?.emit("breakout:toggle_ai",{roomId:a,enabled:b})},[e]),A=(0,v.useCallback)(a=>{e?.emit("breakout:request_help",{roomId:a}),e?.emit("breakout_request_help",{roomId:a,userId:b})},[e,b]),B=(0,v.useCallback)((a,b)=>{e?.emit("breakout:raise_hand",{roomId:a,raised:b})},[e]);return{rooms:g,isConnected:f,createRooms:l,joinRoom:m,leaveRoom:n,endRoom:o,endAllRooms:p,assignStudent:q,removeStudent:r,rotateGroups:s,sendMessage:t,broadcastMessage:u,extendTime:w,assignTask:y,toggleAI:z,requestHelp:A,raiseHand:B,updateVideoState:(0,v.useCallback)((a,b)=>{e?.emit("breakout:video_state",{roomId:a,...b})},[e]),acknowledgeAlert:(0,v.useCallback)((a,b)=>{e?.emit("breakout:acknowledge_alert",{roomId:a,alertId:b})},[e])}}({sessionId:a,userId:b,userName:c,role:"tutor"}),[o,p]=(0,v.useState)(null),[q,r]=(0,v.useState)(!1),[s,u]=(0,v.useState)(""),[w,B]=(0,v.useState)({roomCount:3,participantsPerRoom:4,distributionMode:"random",timeLimit:15,aiAssistantEnabled:!0,aiMode:"passive"}),{suggestion:C}=function({students:a,config:b}){let c=(0,v.useCallback)(()=>{if(a.length<4)return;let{roomCount:c,distributionMode:d}=b,e=a.filter(a=>"beginner"===a.skillLevel||void 0!==a.recentPerformance&&a.recentPerformance<60),f=a.filter(a=>"intermediate"===a.skillLevel||void 0!==a.recentPerformance&&a.recentPerformance>=60&&a.recentPerformance<80),g=a.filter(a=>"advanced"===a.skillLevel||void 0!==a.recentPerformance&&a.recentPerformance>=80),h=a.filter(a=>!a.skillLevel&&void 0===a.recentPerformance);switch(d){case"skill_based":{if(0===e.length&&0===g.length)return;let a=[];if(e.length>0)for(let b=0;b<Math.min(c,Math.ceil(e.length/4));b++){let c=4*b,d=e.slice(c,c+4).map(a=>a.id);d.length>0&&a.push({roomIndex:a.length,members:d,rationale:"Beginners can work at a comfortable pace with foundational support",predictedOutcome:"Higher confidence and reduced frustration",skillProfile:{beginners:d.length,intermediate:0,advanced:0}})}if(f.length>0&&a.length<c)for(let b=0;b<Math.min(c-a.length,Math.ceil(f.length/4));b++){let c=4*b,d=f.slice(c,c+4).map(a=>a.id);d.length>0&&a.push({roomIndex:a.length,members:d,rationale:"Intermediate students can build on existing knowledge",predictedOutcome:"Steady progress with peer collaboration",skillProfile:{beginners:0,intermediate:d.length,advanced:0}})}if(g.length>0&&a.length<c)for(let b=0;b<Math.min(c-a.length,Math.ceil(g.length/4));b++){let c=4*b,d=g.slice(c,c+4).map(a=>a.id);d.length>0&&a.push({roomIndex:a.length,members:d,rationale:"Advanced students can tackle complex challenges",predictedOutcome:"Deeper exploration and leadership development",skillProfile:{beginners:0,intermediate:0,advanced:d.length}})}return{type:"skill_based",description:"Group students by similar skill levels for targeted instruction",confidence:.85,groups:a}}case"social":{let a=[];for(let b=0;b<c;b++){let c=[],d=Math.min(2,e.length-c.length);for(let a=0;a<d;a++){let a=e.find(a=>!c.includes(a.id));a&&c.push(a.id)}let i=Math.min(2,4-c.length);for(let a=0;a<i;a++){let a=f.find(a=>!c.includes(a.id));a&&c.push(a.id)}if(c.length<4&&g.length>0){let a=g.find(a=>!c.includes(a.id));a&&c.push(a.id)}for(;c.length<3&&h.length>0;){let a=h.find(a=>!c.includes(a.id));a&&c.push(a.id)}c.length>=2&&a.push({roomIndex:b,members:c,rationale:"Balanced group with mentorship opportunities",predictedOutcome:"Enhanced learning through teaching and diverse perspectives",skillProfile:{beginners:c.filter(a=>e.some(b=>b.id===a)).length,intermediate:c.filter(a=>f.some(b=>b.id===a)).length,advanced:c.filter(a=>g.some(b=>b.id===a)).length}})}return{type:"social",description:"Mix skill levels to promote peer teaching and collaboration",confidence:.8,groups:a}}case"random":{let d=[...a].sort(()=>Math.random()-.5),h=[];for(let a=0;a<c;a++){let c=a*b.participantsPerRoom,i=d.slice(c,c+b.participantsPerRoom).map(a=>a.id);i.length>0&&h.push({roomIndex:a,members:i,rationale:"Random distribution for unbiased group formation",predictedOutcome:"Natural group dynamics and diverse interactions",skillProfile:{beginners:i.filter(a=>e.some(b=>b.id===a)).length,intermediate:i.filter(a=>f.some(b=>b.id===a)).length,advanced:i.filter(a=>g.some(b=>b.id===a)).length}})}return{type:"random",description:"Randomly distribute students across groups",confidence:.7,groups:h}}default:return}},[a,b]);return{suggestion:(0,v.useMemo)(()=>{if("manual"!==b.distributionMode&&"self_select"!==b.distributionMode)return c()},[c,b.distributionMode])}}({students:d,config:w}),D=(0,v.useMemo)(()=>g.find(a=>a.id===o),[g,o]),F=(0,v.useMemo)(()=>d.filter(a=>!g.some(b=>b.participants.some(b=>b.userId===a.id))&&"online"===a.status),[d,g]),H=(0,v.useMemo)(()=>g.filter(a=>"active"===a.status),[g]),L=(0,v.useMemo)(()=>g.reduce((a,b)=>a+b.alerts.filter(a=>!a.acknowledged).length,0),[g]);(0,v.useEffect)(()=>{e?.(g)},[g,e]);let M=(0,v.useCallback)(()=>{h(C?{...w,suggestedGroups:C}:w),r(!1),E.toast.success(`Creating ${w.roomCount} breakout rooms...`)},[h,w,C]),N=(0,v.useCallback)(()=>{confirm("Are you sure you want to end all breakout sessions?")&&(i(),E.toast.success("Ending all breakout sessions..."))},[i]),O=(0,v.useCallback)(()=>{s.trim()&&(l(s,"all"),u(""),E.toast.success("Broadcast sent to all rooms"))},[l,s]),P=(0,v.useCallback)(a=>{f?.(a)},[f]),Q=(0,v.useCallback)((a,b)=>{n(a,b),E.toast.success(`Task assigned: ${b.title}`)},[n]);return q?(0,t.jsx)(ai,{config:w,setConfig:B,suggestion:C,students:d,onCreate:M,onCancel:()=>r(!1)}):0===g.length?(0,t.jsxs)("div",{className:"h-full flex flex-col bg-gray-50",children:[(0,t.jsxs)("div",{className:"p-4 border-b bg-white flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"bg-blue-600 p-2 rounded-lg",children:(0,t.jsx)(at.Grid3X3,{className:"h-5 w-5 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Breakout Rooms"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Manage small group sessions"})]})]}),(0,t.jsxs)(y.Button,{onClick:()=>r(!0),children:[(0,t.jsx)(Z.Plus,{className:"h-4 w-4 mr-2"}),"Create Rooms"]})]}),(0,t.jsx)("div",{className:"flex-1 flex items-center justify-center p-6",children:(0,t.jsxs)("div",{className:"text-center max-w-md",children:[(0,t.jsx)("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(at.Grid3X3,{className:"h-10 w-10 text-gray-400"})}),(0,t.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"No Breakout Rooms"}),(0,t.jsx)("p",{className:"text-gray-500 mb-6",children:"Create breakout rooms to split students into smaller groups for focused discussions or activities."}),(0,t.jsx)("div",{className:"flex items-center justify-center gap-4 text-sm text-gray-500",children:(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(K.Users,{className:"h-4 w-4"}),d.filter(a=>"online"===a.status).length," students available"]})})]})})]}):(0,t.jsxs)("div",{className:"h-full flex flex-col bg-gray-50",children:[(0,t.jsxs)("div",{className:"px-4 py-3 border-b bg-white flex items-center justify-between shrink-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"bg-blue-600 p-2 rounded-lg",children:(0,t.jsx)(at.Grid3X3,{className:"h-5 w-5 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Breakout Rooms"}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[g.length," rooms â€¢ ",g.reduce((a,b)=>a+b.participants.length,0)," students",L>0&&(0,t.jsxs)("span",{className:"ml-2 text-red-600",children:["â€¢ ",L," alert",1!==L?"s":""]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[H.length>0&&(0,t.jsxs)(y.Button,{variant:"outline",onClick:N,className:"text-red-600 border-red-200 hover:bg-red-50",children:[(0,t.jsx)(as.Square,{className:"h-4 w-4 mr-2"}),"End All"]}),(0,t.jsxs)(y.Button,{onClick:()=>r(!0),children:[(0,t.jsx)(Z.Plus,{className:"h-4 w-4 mr-2"}),"Add Room"]})]})]}),(0,t.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,t.jsxs)("div",{className:"w-64 border-r bg-white flex flex-col shrink-0",children:[(0,t.jsx)("div",{className:"p-3 border-b",children:(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-700",children:"Rooms"})}),(0,t.jsx)(I.ScrollArea,{className:"flex-1",children:(0,t.jsx)("div",{className:"p-2 space-y-1",children:g.map(a=>(0,t.jsxs)("button",{onClick:()=>p(a.id),className:(0,J.cn)("w-full text-left p-3 rounded-lg border transition-all",o===a.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"font-medium text-sm",children:a.name}),(a=>{switch(a){case"active":return(0,t.jsx)(z.Badge,{className:"bg-green-500",children:"Active"});case"forming":return(0,t.jsx)(z.Badge,{variant:"outline",className:"border-blue-500 text-blue-600",children:"Forming"});case"paused":return(0,t.jsx)(z.Badge,{variant:"outline",className:"border-yellow-500 text-yellow-600",children:"Paused"});case"closed":return(0,t.jsx)(z.Badge,{variant:"secondary",children:"Closed"});default:return(0,t.jsx)(z.Badge,{variant:"outline",children:a})}})(a.status)]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,t.jsx)(K.Users,{className:"h-3 w-3"}),a.participants.length,a.aiEnabled&&(0,t.jsxs)(z.Badge,{variant:"outline",className:"text-[10px] h-4 px-1",children:[(0,t.jsx)($.Brain,{className:"h-2 w-2 mr-0.5"}),"AI"]})]}),a.alerts.length>0&&(0,t.jsxs)("div",{className:"mt-1 flex items-center gap-1 text-xs text-red-600",children:[(0,t.jsx)(al.AlertCircle,{className:"h-3 w-3"}),a.alerts.length," alert",1!==a.alerts.length?"s":""]})]},a.id))})}),(0,t.jsx)("div",{className:"p-3 border-t bg-gray-50",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-center",children:[(0,t.jsxs)("div",{className:"bg-white p-2 rounded border",children:[(0,t.jsx)("p",{className:"text-lg font-bold",children:H.length}),(0,t.jsx)("p",{className:"text-[10px] text-gray-500",children:"Active"})]}),(0,t.jsxs)("div",{className:"bg-white p-2 rounded border",children:[(0,t.jsx)("p",{className:"text-lg font-bold",children:L}),(0,t.jsx)("p",{className:"text-[10px] text-gray-500",children:"Alerts"})]})]})})]}),(0,t.jsx)("div",{className:"flex-1 overflow-hidden",children:D?(0,t.jsx)(am,{room:D,unassignedStudents:F,onAssignStudent:j,onRemoveStudent:k,onJoinRoom:P,onExtendTime:m,onAssignTask:Q}):(0,t.jsx)(ar,{rooms:g,onSelectRoom:p,onJoinRoom:P})}),(0,t.jsx)("div",{className:"w-80 border-l bg-white flex flex-col shrink-0",children:(0,t.jsxs)(A.Tabs,{defaultValue:"broadcast",className:"flex-1 flex flex-col",children:[(0,t.jsxs)(A.TabsList,{className:"grid w-full grid-cols-3 mx-2 mt-2",children:[(0,t.jsxs)(A.TabsTrigger,{value:"broadcast",className:"text-xs",children:[(0,t.jsx)(au,{className:"h-3 w-3 mr-1"}),"Broadcast"]}),(0,t.jsxs)(A.TabsTrigger,{value:"alerts",className:"text-xs",children:[(0,t.jsx)(al.AlertCircle,{className:"h-3 w-3 mr-1"}),"Alerts",L>0&&(0,t.jsx)("span",{className:"ml-1 bg-red-500 text-white text-[10px] px-1 rounded-full",children:L})]}),(0,t.jsxs)(A.TabsTrigger,{value:"stats",className:"text-xs",children:[(0,t.jsx)(aq.BarChart3,{className:"h-3 w-3 mr-1"}),"Stats"]})]}),(0,t.jsx)(A.TabsContent,{value:"broadcast",className:"flex-1 flex flex-col m-0 p-4",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(G.Input,{placeholder:"Message to all rooms...",value:s,onChange:a=>u(a.target.value),onKeyDown:a=>"Enter"===a.key&&O()}),(0,t.jsxs)(y.Button,{className:"w-full",onClick:O,disabled:!s.trim(),children:[(0,t.jsx)(au,{className:"h-4 w-4 mr-2"}),"Broadcast to All"]}),(0,t.jsxs)("div",{className:"pt-2 border-t",children:[(0,t.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"Quick Messages"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:["5 min left!","Wrap up soon","Great work!","Need help?"].map(a=>(0,t.jsx)("button",{onClick:()=>{l(a,"all"),E.toast.success(`Sent: "${a}"`)},className:"text-xs px-2 py-1 bg-gray-100 hover:bg-gray-200 rounded text-gray-600 transition-colors",children:a},a))})]})]})}),(0,t.jsx)(A.TabsContent,{value:"alerts",className:"flex-1 m-0 p-4",children:(0,t.jsx)(I.ScrollArea,{className:"h-full",children:(0,t.jsx)("div",{className:"space-y-2",children:0===g.flatMap(a=>a.alerts.filter(a=>!a.acknowledged).map(b=>({...b,roomName:a.name,roomId:a.id}))).length?(0,t.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,t.jsx)(ad.CheckCircle,{className:"h-8 w-8 mx-auto mb-2 text-green-500"}),(0,t.jsx)("p",{className:"text-sm",children:"No active alerts"})]}):g.flatMap(a=>a.alerts.filter(a=>!a.acknowledged).map(b=>({...b,roomName:a.name,roomId:a.id}))).sort((a,b)=>{let c={high:3,medium:2,low:1};return c[b.severity]-c[a.severity]}).map((a,b)=>(0,t.jsxs)("div",{className:(0,J.cn)("p-3 rounded-lg border text-sm","high"===a.severity?"bg-red-50 border-red-200 text-red-800":"medium"===a.severity?"bg-yellow-50 border-yellow-200 text-yellow-800":"bg-blue-50 border-blue-200 text-blue-800"),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{children:(a=>{switch(a){case"confusion":return"â“";case"conflict":return"âš ï¸";case"off_topic":return"ðŸŽ¯";case"need_help":return"ðŸ†˜";case"quiet":return"ðŸ”‡";default:return"ðŸ””"}})(a.type)}),(0,t.jsx)("span",{className:"font-medium",children:a.roomName}),(0,t.jsx)(z.Badge,{variant:"outline",className:"text-[10px] ml-auto",children:a.severity})]}),(0,t.jsx)("p",{children:a.message})]},b))})})}),(0,t.jsx)(A.TabsContent,{value:"stats",className:"flex-1 m-0 p-4",children:(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg text-center border",children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:H.length}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Active Rooms"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg text-center border",children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:L}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Active Alerts"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg text-center border",children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:g.reduce((a,b)=>a+b.metrics.messagesExchanged,0)}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Messages"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg text-center border",children:[(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[Math.round(g.reduce((a,b)=>a+b.metrics.avgEngagement,0)/Math.max(g.length,1)),"%"]}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Avg Engagement"})]})]})})})]})})]})]})}var aw=a.i(633600),ax=a.i(927910);let ay=(0,aa.default)("video-off",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),az=(0,aa.default)("monitor-up",[["path",{d:"m9 10 3-3 3 3",key:"11gsxs"}],["path",{d:"M12 13V7",key:"h0r20n"}],["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"M8 21h8",key:"1ev6f3"}]]),aA=(0,aa.default)("monitor-off",[["path",{d:"M12 17v4",key:"1riwvh"}],["path",{d:"M17 17H4a2 2 0 0 1-2-2V5a2 2 0 0 1 1.184-1.826",key:"cv7jms"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8 21h8",key:"1ev6f3"}],["path",{d:"M8.656 3H20a2 2 0 0 1 2 2v10a2 2 0 0 1-.293 1.042",key:"z8ni2w"}]]),aB=(0,aa.default)("phone-off",[["path",{d:"M10.1 13.9a14 14 0 0 0 3.732 2.668 1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2 18 18 0 0 1-12.728-5.272",key:"1wngk7"}],["path",{d:"M22 2 2 22",key:"y4kqgn"}],["path",{d:"M4.76 13.582A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 .244.473",key:"10hv5p"}]]);var aC=a.i(815350),aD=a.i(302402),aE=a.i(318095);function aF({room:a,isOpen:b,userId:c,userName:d,role:e,onClose:f,onEndRoom:g,onExtendTime:h,onSendMessage:i,onRequestHelp:j,onRaiseHand:k}){var l;let m,[n,o]=(0,v.useState)("video"),[p,q]=(0,v.useState)({}),[r,s]=(0,v.useState)(""),[u,w]=(0,v.useState)(!1),[x,C]=(0,v.useState)(!1),[D,F]=(0,v.useState)(!1),[H,M]=(0,v.useState)(!1),O=(0,v.useRef)(null),P=(0,v.useMemo)(()=>a?p[a.id]??a.messages:[],[a,p]);if((0,v.useEffect)(()=>{O.current?.scrollIntoView({behavior:"smooth"})},[P]),!a)return null;let Q="tutor"===e,R=()=>{if(!r.trim())return;let b={id:`msg-${Date.now()}`,roomId:a.id,senderId:c,senderName:d,senderRole:e,content:r,timestamp:new Date().toISOString(),type:"text"};q(c=>({...c,[a.id]:[...c[a.id]||a.messages,b]})),i?.(a.id,r),s("")};return(0,t.jsx)(B.Dialog,{open:b,onOpenChange:a=>!a&&f(),children:(0,t.jsxs)(B.DialogContent,{className:"max-w-6xl w-[95vw] h-[90vh] p-0 gap-0 overflow-hidden",children:[(0,t.jsx)(B.DialogHeader,{className:"px-6 py-4 border-b bg-white shrink-0",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)(B.DialogTitle,{className:"text-gray-900 text-lg flex items-center gap-2",children:[(0,t.jsx)(K.Users,{className:"h-5 w-5 text-blue-600"}),a.name]}),(0,t.jsx)(z.Badge,{variant:"secondary",className:(0,J.cn)("active"===a.status?"bg-green-100 text-green-700":"forming"===a.status?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:a.status.charAt(0).toUpperCase()+a.status.slice(1)}),a.aiEnabled&&(0,t.jsxs)(z.Badge,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-200",children:[(0,t.jsx)($.Brain,{className:"h-3 w-3 mr-1"}),"AI Active"]}),a.assignedTask&&(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:["Task: ",a.assignedTask.title]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:(0,J.cn)("flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-medium",a.timeRemaining<60?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:[(0,t.jsx)(ao.Timer,{className:"h-4 w-4"}),(m=Math.floor((l=a.timeRemaining)/60),`${m}:${(l%60).toString().padStart(2,"0")}`)]}),Q&&(0,t.jsx)("div",{className:"flex items-center gap-1",children:(0,t.jsx)(y.Button,{variant:"outline",size:"sm",className:"h-8 px-2",onClick:()=>h?.(a.id,5),children:"+5m"})}),Q&&(0,t.jsxs)(y.Button,{variant:"destructive",size:"sm",onClick:()=>{confirm(`Are you sure you want to end ${a.name}? All participants will return to the main room.`)&&(g?.(a.id),f())},className:"gap-1",children:[(0,t.jsx)(aB,{className:"h-4 w-4"}),"End Room"]})]})]})}),(0,t.jsx)("div",{className:"flex flex-1 overflow-hidden bg-gray-50",children:(0,t.jsxs)(A.Tabs,{value:n,onValueChange:o,className:"flex-1 flex flex-col",children:[(0,t.jsx)("div",{className:"bg-white border-b px-4",children:(0,t.jsxs)(A.TabsList,{className:"bg-transparent h-12",children:[(0,t.jsxs)(A.TabsTrigger,{value:"video",className:"data-[state=active]:bg-gray-100 text-gray-600 data-[state=active]:text-gray-900 gap-2",children:[(0,t.jsx)(ax.Video,{className:"h-4 w-4"}),"Video"]}),(0,t.jsxs)(A.TabsTrigger,{value:"chat",className:"data-[state=active]:bg-gray-100 text-gray-600 data-[state=active]:text-gray-900 gap-2",children:[(0,t.jsx)(ap.MessageSquare,{className:"h-4 w-4"}),"Chat",P.filter(a=>"text"===a.type).length>0&&(0,t.jsx)(z.Badge,{variant:"secondary",className:"text-[10px] h-4 px-1",children:P.filter(a=>"text"===a.type).length})]}),(0,t.jsxs)(A.TabsTrigger,{value:"participants",className:"data-[state=active]:bg-gray-100 text-gray-600 data-[state=active]:text-gray-900 gap-2",children:[(0,t.jsx)(K.Users,{className:"h-4 w-4"}),"Participants (",a.participants.length,")"]})]})}),(0,t.jsxs)(A.TabsContent,{value:"video",className:"flex-1 m-0 flex flex-col",children:[(0,t.jsx)("div",{className:"flex-1 p-4 overflow-auto",children:(0,t.jsxs)("div",{className:(0,J.cn)("grid gap-3 h-full",a.participants.length<=1?"grid-cols-1":a.participants.length<=2||a.participants.length<=4?"grid-cols-2":"grid-cols-3"),children:[(0,t.jsx)(aG,{participant:{id:c,userId:c,name:`${d} (You)`,role:e,isOnline:!0,isMuted:u,isVideoOff:x,isScreenSharing:D,engagementScore:100,attentionLevel:"high",handRaised:H,joinedAt:new Date().toISOString()},isSelf:!0}),a.participants.filter(a=>a.userId!==c).map((a,b)=>(0,t.jsx)(aG,{participant:a,index:b},a.id))]})}),(0,t.jsxs)("div",{className:"px-6 py-4 bg-white border-t flex items-center justify-center gap-4",children:[(0,t.jsx)(y.Button,{variant:u?"destructive":"outline",size:"icon",onClick:()=>w(!u),className:"h-12 w-12 rounded-full",children:u?(0,t.jsx)(N.MicOff,{className:"h-5 w-5"}):(0,t.jsx)(aw.Mic,{className:"h-5 w-5"})}),(0,t.jsx)(y.Button,{variant:x?"destructive":"outline",size:"icon",onClick:()=>C(!x),className:"h-12 w-12 rounded-full",children:x?(0,t.jsx)(ay,{className:"h-5 w-5"}):(0,t.jsx)(ax.Video,{className:"h-5 w-5"})}),(0,t.jsx)(y.Button,{variant:D?"default":"outline",size:"icon",onClick:()=>F(!D),className:(0,J.cn)("h-12 w-12 rounded-full",D&&"bg-blue-600"),children:D?(0,t.jsx)(aA,{className:"h-5 w-5"}):(0,t.jsx)(az,{className:"h-5 w-5"})}),!Q&&(0,t.jsx)(y.Button,{variant:H?"default":"outline",size:"icon",onClick:()=>{let b=!H;M(b),k?.(a.id,b),b&&E.toast.success("Hand raised")},className:(0,J.cn)("h-12 w-12 rounded-full",H&&"bg-yellow-500"),children:(0,t.jsx)(L.Hand,{className:"h-5 w-5"})}),!Q&&(0,t.jsx)(y.Button,{variant:"outline",size:"icon",onClick:()=>{j?.(a.id),E.toast.success("Help request sent to tutor")},className:"h-12 w-12 rounded-full text-blue-600 border-blue-200",children:(0,t.jsx)(aE.HelpCircle,{className:"h-5 w-5"})}),(0,t.jsx)(y.Button,{variant:"destructive",size:"icon",onClick:f,className:"h-12 w-12 rounded-full",children:(0,t.jsx)(aB,{className:"h-5 w-5"})})]})]}),(0,t.jsxs)(A.TabsContent,{value:"chat",className:"flex-1 m-0 flex flex-col bg-white",children:[(0,t.jsx)(I.ScrollArea,{className:"flex-1 p-4",children:(0,t.jsxs)("div",{className:"space-y-4",children:[0===P.length?(0,t.jsxs)("div",{className:"text-center text-gray-400 py-8",children:[(0,t.jsx)(ap.MessageSquare,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{children:"No messages yet"}),(0,t.jsx)("p",{className:"text-sm",children:"Start the conversation!"})]}):P.map(a=>(0,t.jsx)(aH,{message:a,isSelf:a.senderId===c},a.id)),(0,t.jsx)("div",{ref:O})]})}),(0,t.jsxs)("div",{className:"p-4 bg-gray-50 border-t",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(G.Input,{placeholder:"Type a message...",value:r,onChange:a=>s(a.target.value),onKeyDown:a=>"Enter"===a.key&&R(),className:"bg-white"}),(0,t.jsxs)(y.Button,{onClick:R,disabled:!r.trim(),className:"gap-2",children:[(0,t.jsx)(aC.Send,{className:"h-4 w-4"}),"Send"]})]}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:Q?"Your messages will be visible to all students in this room":"Your messages will be visible to everyone in this room"})]})]}),(0,t.jsx)(A.TabsContent,{value:"participants",className:"flex-1 m-0 bg-white",children:(0,t.jsx)(I.ScrollArea,{className:"h-full p-4",children:(0,t.jsx)("div",{className:"space-y-2",children:0===a.participants.length?(0,t.jsxs)("div",{className:"text-center text-gray-400 py-8",children:[(0,t.jsx)(K.Users,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{children:"No participants in this room"})]}):a.participants.map(a=>(0,t.jsx)(aI,{participant:a},a.id))})})})]})})]})})}function aG({participant:a,isSelf:b=!1,index:c=0}){let d=["bg-red-500","bg-green-500","bg-yellow-500","bg-purple-500","bg-pink-500","bg-indigo-500"],e=b?"bg-blue-600":d[c%d.length];return(0,t.jsxs)("div",{className:"relative bg-gray-900 rounded-xl overflow-hidden aspect-video flex items-center justify-center",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:(0,J.cn)("w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-2",e),children:(0,t.jsx)("span",{className:"text-white text-2xl font-bold",children:a.name.charAt(0).toUpperCase()})}),(0,t.jsx)("p",{className:"text-white font-medium",children:a.name}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-1 mt-1",children:[b&&(0,t.jsx)(z.Badge,{variant:"outline",className:"text-blue-400 border-blue-400",children:"You"}),"tutor"===a.role&&(0,t.jsxs)(z.Badge,{variant:"outline",className:"text-yellow-400 border-yellow-400",children:[(0,t.jsx)(aD.Crown,{className:"h-3 w-3 mr-1"}),"Tutor"]})]})]}),(0,t.jsxs)("div",{className:"absolute bottom-3 left-3 flex gap-2",children:[a.isMuted&&(0,t.jsx)("div",{className:"bg-red-600 p-1.5 rounded-full",children:(0,t.jsx)(N.MicOff,{className:"h-4 w-4 text-white"})}),a.isVideoOff&&(0,t.jsx)("div",{className:"bg-red-600 p-1.5 rounded-full",children:(0,t.jsx)(ay,{className:"h-4 w-4 text-white"})}),a.isScreenSharing&&(0,t.jsx)("div",{className:"bg-blue-600 p-1.5 rounded-full",children:(0,t.jsx)(az,{className:"h-4 w-4 text-white"})})]}),a.handRaised&&(0,t.jsx)("div",{className:"absolute top-3 right-3 bg-yellow-500 p-2 rounded-full animate-pulse",children:(0,t.jsx)(L.Hand,{className:"h-4 w-4 text-white"})}),!b&&(0,t.jsx)("div",{className:"absolute top-3 left-3",children:(0,t.jsxs)(z.Badge,{variant:"outline",className:(0,J.cn)("text-xs",a.engagementScore>=80?"bg-green-600/50 text-green-400 border-green-500":a.engagementScore>=50?"bg-yellow-600/50 text-yellow-400 border-yellow-500":"bg-red-600/50 text-red-400 border-red-500"),children:[a.engagementScore,"%"]})})]})}function aH({message:a,isSelf:b}){let c="ai"===a.senderRole||"system"===a.type;return(0,t.jsxs)("div",{className:(0,J.cn)("flex gap-3",b&&"flex-row-reverse",c&&"justify-center"),children:[!c&&(0,t.jsx)("div",{className:(0,J.cn)("w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold shrink-0",b?"bg-blue-600 text-white":"tutor"===a.senderRole?"bg-yellow-500 text-white":"bg-gray-200 text-gray-700"),children:a.senderName.charAt(0).toUpperCase()}),(0,t.jsxs)("div",{className:(0,J.cn)("max-w-[70%]",b&&"text-right",c&&"text-center w-full"),children:[!c&&(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{className:(0,J.cn)("text-sm font-medium",b?"text-blue-600":"tutor"===a.senderRole?"text-yellow-600":"text-gray-700"),children:a.senderName}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:new Date(a.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,t.jsx)("div",{className:(0,J.cn)("inline-block px-3 py-2 rounded-lg text-sm text-left",c?"bg-purple-100 text-purple-800 italic":b?"bg-blue-600 text-white":"tutor"===a.senderRole?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",a.isQuestion&&!b&&!c&&"border-l-4 border-yellow-500"),children:a.content})]})]})}function aI({participant:a}){return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:(0,J.cn)("w-10 h-10 rounded-full flex items-center justify-center font-bold text-white","tutor"===a.role?"bg-yellow-500":a.isOnline?"bg-green-500":"bg-gray-400"),children:a.name.charAt(0).toUpperCase()}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("p",{className:"font-medium",children:a.name}),"tutor"===a.role&&(0,t.jsxs)(z.Badge,{variant:"outline",className:"text-[10px]",children:[(0,t.jsx)(aD.Crown,{className:"h-3 w-3 mr-1"}),"Tutor"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,t.jsx)("span",{className:(0,J.cn)("w-2 h-2 rounded-full",a.isOnline?"bg-green-500":"bg-gray-400")}),a.isOnline?"Online":"Offline",a.handRaised&&(0,t.jsx)("span",{className:"text-yellow-600 flex items-center gap-1",children:"â€¢ Hand raised"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(z.Badge,{variant:"outline",className:(0,J.cn)("text-xs",a.engagementScore>=80?"text-green-600 border-green-500":a.engagementScore>=50?"text-yellow-600 border-yellow-500":"text-red-600 border-red-500"),children:[a.engagementScore,"% engaged"]}),"low"===a.attentionLevel&&(0,t.jsx)(z.Badge,{variant:"outline",className:"text-xs text-red-600 border-red-500",children:"Attention"})]})]})}var aJ=a.i(395743);let aK=(0,aa.default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);function aL({handRaises:a,onAcknowledge:b,onAnswer:c}){let d=[...a].sort((a,b)=>{if(a.status!==b.status)return"pending"===a.status?-1:1;if(a.priority!==b.priority){let c={high:3,normal:2,low:1};return c[b.priority]-c[a.priority]}return new Date(a.raisedAt).getTime()-new Date(b.raisedAt).getTime()}),e=a.filter(a=>"pending"===a.status).length;return(0,t.jsxs)(F.Card,{className:"h-full flex flex-col",children:[(0,t.jsx)(F.CardHeader,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(L.Hand,{className:"w-4 h-4"}),(0,t.jsx)(F.CardTitle,{className:"text-sm font-medium",children:"Hand Raises"})]}),e>0&&(0,t.jsxs)(z.Badge,{variant:"destructive",className:"text-xs",children:[e," Pending"]})]})}),(0,t.jsx)(F.CardContent,{className:"flex-1 p-0",children:0===d.length?(0,t.jsx)("div",{className:"h-full flex items-center justify-center text-center p-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)(L.Hand,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"No hand raises yet"}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Students can raise hands to ask questions"})]})}):(0,t.jsx)(I.ScrollArea,{className:"h-[calc(100%-60px)]",children:(0,t.jsx)("div",{className:"space-y-2 px-4 pb-4",children:d.map(a=>(0,t.jsx)("div",{className:(0,J.cn)("p-3 rounded-lg border transition-all","pending"===a.status?"bg-white border-yellow-200 shadow-sm":"acknowledged"===a.status?"bg-blue-50 border-blue-200":"bg-green-50 border-green-200 opacity-70"),children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(H.Avatar,{className:"w-8 h-8",children:(0,t.jsx)(H.AvatarFallback,{className:"text-xs bg-blue-100 text-blue-700",children:a.studentName.split(" ").map(a=>a[0]).join("")})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("p",{className:"font-medium text-sm",children:a.studentName}),(a=>{switch(a){case"pending":return(0,t.jsx)(z.Badge,{variant:"outline",className:"animate-pulse",children:"Waiting"});case"acknowledged":return(0,t.jsx)(z.Badge,{variant:"secondary",children:"Acknowledged"});case"answered":return(0,t.jsx)(z.Badge,{variant:"default",className:"bg-green-600",children:"Answered"})}})(a.status)]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,t.jsx)(z.Badge,{variant:"outline",className:(0,J.cn)("text-xs",(a=>{switch(a){case"high":return"bg-red-100 text-red-700 border-red-200";case"normal":return"bg-yellow-100 text-yellow-700 border-yellow-200";case"low":return"bg-blue-100 text-blue-700 border-blue-200";default:return"bg-gray-100 text-gray-700"}})(a.priority)),children:a.priority.charAt(0).toUpperCase()+a.priority.slice(1)}),(0,t.jsxs)("span",{className:"text-xs text-gray-500 flex items-center gap-1",children:[(0,t.jsx)(ag.Clock,{className:"w-3 h-3"}),(a=>{let b=Math.floor((Date.now()-new Date(a).getTime())/1e3);if(b<60)return`${b}s`;let c=Math.floor(b/60);return`${c}m ${b%60}s`})(a.raisedAt)]})]}),a.topic&&(0,t.jsxs)("p",{className:"text-xs text-gray-600 mt-2",children:["Topic: ",a.topic]}),"pending"===a.status&&(0,t.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,t.jsxs)(y.Button,{size:"sm",variant:"outline",className:"flex-1 text-xs",onClick:()=>b?.(a.id),children:[(0,t.jsx)(aK,{className:"w-3 h-3 mr-1"}),"Acknowledge"]}),(0,t.jsxs)(y.Button,{size:"sm",className:"flex-1 text-xs bg-green-600 hover:bg-green-700",onClick:()=>c?.(a.id),children:[(0,t.jsx)(aJ.Check,{className:"w-3 h-3 mr-1"}),"Answer"]})]})]})]})},a.id))})})})]})}var aM=a.i(74469),aN=a.i(660192);let aO=(0,aa.default)("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),aP=(0,aa.default)("frown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),aQ=(0,aa.default)("meh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);function aR({messages:a,students:b,socket:c,roomId:d,onPinMessage:e}){let[f,g]=(0,v.useState)("all"),[h,i]=(0,v.useState)(""),[j,k]=(0,v.useState)(a),l=(0,v.useRef)(null);(0,v.useEffect)(()=>{k(a)},[a]),(0,v.useEffect)(()=>{if(!c)return;let a=a=>{k(b=>[...b,{id:a.id,studentId:a.userId,studentName:a.name,content:a.text,timestamp:a.timestamp,sentiment:"neutral",isQuestion:a.text.includes("?")}])};return c.on("chat_message",a),()=>{c.off("chat_message",a)}},[c,b]),(0,v.useEffect)(()=>{l.current&&(l.current.scrollTop=l.current.scrollHeight)},[a]);let m=j.filter(a=>"questions"===f?a.isQuestion||"confused"===a.sentiment:"pinned"!==f||a.isPinned),n=j.filter(a=>a.isQuestion||"confused"===a.sentiment).length,o=j.filter(a=>a.isPinned).length,p=()=>{if(h.trim()){if(!c)return void E.toast.error("Not connected to class");c.emit("tutor_broadcast",{text:h,targetGroup:"all"}),k(a=>[...a,{id:`tutor-${Date.now()}`,studentId:"tutor",studentName:"You",content:h,timestamp:new Date().toISOString(),sentiment:"neutral"}]),i("")}};return(0,t.jsxs)(F.Card,{className:"h-full flex flex-col",children:[(0,t.jsxs)(F.CardHeader,{className:"pb-2",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ap.MessageSquare,{className:"w-4 h-4"}),(0,t.jsx)(F.CardTitle,{className:"text-sm font-medium",children:"Chat"})]})}),(0,t.jsxs)("div",{className:"flex gap-1 mt-2",children:[(0,t.jsx)(y.Button,{variant:"all"===f?"default":"ghost",size:"sm",className:"flex-1 text-xs h-7",onClick:()=>g("all"),children:"All"}),(0,t.jsxs)(y.Button,{variant:"questions"===f?"default":"ghost",size:"sm",className:"flex-1 text-xs h-7",onClick:()=>g("questions"),children:[(0,t.jsx)(aE.HelpCircle,{className:"w-3 h-3 mr-1"}),"Questions (",n,")"]}),(0,t.jsxs)(y.Button,{variant:"pinned"===f?"default":"ghost",size:"sm",className:"flex-1 text-xs h-7",onClick:()=>g("pinned"),children:[(0,t.jsx)(aM.Pin,{className:"w-3 h-3 mr-1"}),"Pinned (",o,")"]})]})]}),(0,t.jsxs)(F.CardContent,{className:"flex-1 p-0 flex flex-col",children:[(0,t.jsx)(I.ScrollArea,{className:"flex-1 px-4",ref:l,children:(0,t.jsx)("div",{className:"space-y-3 py-2",children:0===m.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(ap.MessageSquare,{className:"w-10 h-10 text-gray-300 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"questions"===f?"No questions yet":"pinned"===f?"No pinned messages":"No messages yet"})]}):m.map(a=>(0,t.jsx)("div",{className:(0,J.cn)("p-3 rounded-lg border text-sm",(a=>{switch(a){case"positive":return"bg-green-50 border-green-200";case"negative":return"bg-red-50 border-red-200";case"confused":return"bg-orange-50 border-orange-200";case"question":return"bg-blue-50 border-blue-200";default:return"bg-white"}})(a.sentiment),a.isPinned&&"border-yellow-300 shadow-sm"),children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-medium text-xs",children:a.studentName}),(a=>{switch(a){case"positive":return(0,t.jsx)(aO,{className:"w-3 h-3 text-green-500"});case"negative":return(0,t.jsx)(aP,{className:"w-3 h-3 text-red-500"});case"confused":return(0,t.jsx)(al.AlertCircle,{className:"w-3 h-3 text-orange-500"});case"question":return(0,t.jsx)(aE.HelpCircle,{className:"w-3 h-3 text-blue-500"});default:return(0,t.jsx)(aQ,{className:"w-3 h-3 text-gray-400"})}})(a.sentiment),a.isQuestion&&(0,t.jsx)(z.Badge,{variant:"outline",className:"text-xs px-1 py-0 h-4",children:"Question"})]}),(0,t.jsx)("p",{className:"mt-1 text-gray-700",children:a.content}),(0,t.jsx)("span",{className:"text-xs text-gray-400 mt-1",children:new Date(a.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,t.jsx)(y.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 shrink-0",onClick:()=>e?.(a.id),children:a.isPinned?(0,t.jsx)(aN.PinOff,{className:"w-3 h-3 text-yellow-600"}):(0,t.jsx)(aM.Pin,{className:"w-3 h-3 text-gray-400"})})]})},a.id))})}),(0,t.jsx)("div",{className:"p-3 border-t mt-auto",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(G.Input,{placeholder:"Broadcast message...",value:h,onChange:a=>i(a.target.value),onKeyDown:a=>"Enter"===a.key&&p(),className:"flex-1 text-sm"}),(0,t.jsx)(y.Button,{size:"icon",onClick:p,children:(0,t.jsx)(aC.Send,{className:"w-4 h-4"})})]})})]})]})}var aS=a.i(425798),aT=a.i(844194),aU=a.i(308557),aV=a.i(609931),aW=a.i(253583),aX=a.i(739056);function aY({metrics:a,alerts:b}){let c=Math.round(a.veryEngaged/a.totalStudents*100),d=Math.round(a.engaged/a.totalStudents*100),e=Math.round(a.passive/a.totalStudents*100),f=Math.round(a.disengaged/a.totalStudents*100);return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsx)(F.Card,{children:(0,t.jsxs)(F.CardContent,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Avg. Engagement"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[a.averageEngagement,"%"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(a=>{switch(a){case"up":return(0,t.jsx)(aT.TrendingUp,{className:"w-4 h-4 text-green-500"});case"down":return(0,t.jsx)(aU.TrendingDown,{className:"w-4 h-4 text-red-500"});default:return(0,t.jsx)(aV.Minus,{className:"w-4 h-4 text-gray-400"})}})(a.engagementTrend),(0,t.jsx)("span",{className:(0,J.cn)("text-xs font-medium","up"===a.engagementTrend?"text-green-600":"down"===a.engagementTrend?"text-red-600":"text-gray-600"),children:"up"===a.engagementTrend?"+5%":"down"===a.engagementTrend?"-3%":"0%"})]})]}),(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,t.jsx)(aW.Activity,{className:"w-3 h-3 text-gray-400"}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"Last 5 min avg"})]})]})}),(0,t.jsx)(F.Card,{children:(0,t.jsxs)(F.CardContent,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Participation"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[a.participationRate,"%"]})]}),(0,t.jsx)(ap.MessageSquare,{className:"w-5 h-5 text-blue-500"})]}),(0,t.jsx)("div",{className:"mt-2 flex items-center gap-2",children:(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:[a.totalChatMessages," messages sent"]})})]})}),(0,t.jsx)(F.Card,{children:(0,t.jsxs)(F.CardContent,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Active Students"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:a.activeStudents})]}),(0,t.jsx)(K.Users,{className:"w-5 h-5 text-green-500"})]}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:["of ",a.totalStudents," total"]})})]})}),(0,t.jsx)(F.Card,{children:(0,t.jsxs)(F.CardContent,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Class Duration"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[Math.floor(a.classDuration/60),":",(a.classDuration%60).toString().padStart(2,"0")]})]}),(0,t.jsx)(ag.Clock,{className:"w-5 h-5 text-purple-500"})]}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:["Started ",new Date(a.classStartTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})})]})})]}),(0,t.jsxs)(F.Card,{children:[(0,t.jsx)(F.CardHeader,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(aX.PieChart,{className:"w-4 h-4"}),(0,t.jsx)(F.CardTitle,{className:"text-sm font-medium",children:"Engagement Distribution"})]})}),(0,t.jsx)(F.CardContent,{className:"pt-0",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-20 text-xs font-medium text-gray-600",children:"Very Engaged"}),(0,t.jsx)("div",{className:"flex-1 h-3 bg-gray-100 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-green-500 rounded-full transition-all",style:{width:`${c}%`}})}),(0,t.jsxs)("span",{className:"w-10 text-xs text-right",children:[c,"%"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-20 text-xs font-medium text-gray-600",children:"Engaged"}),(0,t.jsx)("div",{className:"flex-1 h-3 bg-gray-100 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-blue-500 rounded-full transition-all",style:{width:`${d}%`}})}),(0,t.jsxs)("span",{className:"w-10 text-xs text-right",children:[d,"%"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-20 text-xs font-medium text-gray-600",children:"Passive"}),(0,t.jsx)("div",{className:"flex-1 h-3 bg-gray-100 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-yellow-500 rounded-full transition-all",style:{width:`${e}%`}})}),(0,t.jsxs)("span",{className:"w-10 text-xs text-right",children:[e,"%"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-20 text-xs font-medium text-gray-600",children:"Disengaged"}),(0,t.jsx)("div",{className:"flex-1 h-3 bg-gray-100 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-red-500 rounded-full transition-all",style:{width:`${f}%`}})}),(0,t.jsxs)("span",{className:"w-10 text-xs text-right",children:[f,"%"]})]})]})})]}),(0,t.jsxs)(F.Card,{children:[(0,t.jsx)(F.CardHeader,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(aS.Zap,{className:"w-4 h-4"}),(0,t.jsx)(F.CardTitle,{className:"text-sm font-medium",children:"Attention Alerts"})]}),b.filter(a=>!a.acknowledged).length>0&&(0,t.jsxs)(z.Badge,{variant:"destructive",className:"text-xs",children:[b.filter(a=>!a.acknowledged).length," Active"]})]})}),(0,t.jsx)(F.CardContent,{className:"pt-0",children:0===b.length?(0,t.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No alerts - class is going smoothly!"}):(0,t.jsx)("div",{className:"space-y-2",children:b.slice(0,5).map(a=>(0,t.jsx)("div",{className:(0,J.cn)("p-3 rounded-lg border text-sm",(a=>{switch(a){case"high":return"bg-red-100 text-red-700 border-red-200";case"medium":return"bg-orange-100 text-orange-700 border-orange-200";case"low":return"bg-blue-100 text-blue-700 border-blue-200";default:return"bg-gray-100 text-gray-700"}})(a.severity),!a.acknowledged&&"animate-pulse"),children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(al.AlertCircle,{className:"w-4 h-4 mt-0.5 shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:a.title}),(0,t.jsx)("p",{className:"text-xs opacity-80 mt-0.5",children:a.message}),(0,t.jsx)("p",{className:"text-xs opacity-60 mt-1",children:new Date(a.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},a.id))})})]})]})}var aZ=a.i(349111);let a$=(0,aZ.createServerReference)("6075ea928940b65dcbc7525ac536b6af51f44c2ca9",aZ.callServer,void 0,aZ.findSourceMapURL,"saveLibraryTask"),a_=(0,aZ.createServerReference)("6017248195ec7c3ab658cb291969eb1d7204b818d2",aZ.callServer,void 0,aZ.findSourceMapURL,"toggleFavoriteTask"),a0=(0,aZ.createServerReference)("605cbe0e97c422211686962a28abdc3076feaf4335",aZ.callServer,void 0,aZ.findSourceMapURL,"deleteLibraryTask"),a1=(0,aZ.createServerReference)("40f91213c9db900c19d33be7a667f471dacdd61736",aZ.callServer,void 0,aZ.findSourceMapURL,"incrementTaskUsage");var a2=a.i(529004),a3=a.i(763485),a4=a.i(479680),a5=a.i(143650),a6=a.i(209347),a7=a.i(342621),a8=a.i(926388),a9=a.i(283284),ba=a.i(897541),bb=a.i(562117),bc=a.i(294532),bd=a.i(36094);let be=(0,aa.default)("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var bf=a.i(318153);let bg=(0,aa.default)("folder-heart",[["path",{d:"M10.638 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v3.417",key:"10r6g4"}],["path",{d:"M14.62 18.8A2.25 2.25 0 1 1 18 15.836a2.25 2.25 0 1 1 3.38 2.966l-2.626 2.856a.998.998 0 0 1-1.507 0z",key:"15cy7q"}]]),bh=(0,aa.default)("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);var bi=a.i(361749),bj=a.i(951869);function bk({groupSize:a,panelElement:b,styleProp:c}){let d,[e,f]=function(a){switch(typeof a){case"number":return[a,"px"];case"string":{let b=parseFloat(a);return a.endsWith("%")?[b,"%"]:a.endsWith("px")?[b,"px"]:a.endsWith("rem")?[b,"rem"]:a.endsWith("em")?[b,"em"]:a.endsWith("vh")?[b,"vh"]:a.endsWith("vw")?[b,"vw"]:[b,"%"]}}}(c);switch(f){case"%":d=e/100*a;break;case"px":d=e;break;case"rem":d=e*parseFloat(getComputedStyle(b.ownerDocument.body).fontSize);break;case"em":d=e*parseFloat(getComputedStyle(b).fontSize);break;case"vh":d=e/100*window.innerHeight;break;case"vw":d=e/100*window.innerWidth}return d}function bl(a){return parseFloat(a.toFixed(3))}function bm({group:a}){let{orientation:b,panels:c}=a;return c.reduce((a,c)=>a+="horizontal"===b?c.element.offsetWidth:c.element.offsetHeight,0)}function bn(a){let{panels:b}=a,c=bm({group:a});return 0===c?b.map(a=>({collapsedSize:0,collapsible:!0===a.panelConstraints.collapsible,defaultSize:void 0,disabled:a.panelConstraints.disabled,minSize:0,maxSize:100,panelId:a.id})):b.map(a=>{let b,{element:d,panelConstraints:e}=a,f=0;void 0!==e.collapsedSize&&(f=bl(bk({groupSize:c,panelElement:d,styleProp:e.collapsedSize})/c*100)),void 0!==e.defaultSize&&(b=bl(bk({groupSize:c,panelElement:d,styleProp:e.defaultSize})/c*100));let g=0;void 0!==e.minSize&&(g=bl(bk({groupSize:c,panelElement:d,styleProp:e.minSize})/c*100));let h=100;return void 0!==e.maxSize&&(h=bl(bk({groupSize:c,panelElement:d,styleProp:e.maxSize})/c*100)),{collapsedSize:f,collapsible:!0===e.collapsible,defaultSize:b,disabled:e.disabled,minSize:g,maxSize:h,panelId:a.id}})}function bo(a,b="Assertion error"){if(!a)throw Error(b)}function bp(a,b){return Array.from(b).sort("horizontal"===a?bq:br)}function bq(a,b){let c=a.element.offsetLeft-b.element.offsetLeft;return 0!==c?c:a.element.offsetWidth-b.element.offsetWidth}function br(a,b){let c=a.element.offsetTop-b.element.offsetTop;return 0!==c?c:a.element.offsetHeight-b.element.offsetHeight}function bs(a){return null!==a&&"object"==typeof a&&"nodeType"in a&&a.nodeType===Node.ELEMENT_NODE}function bt(a,b){return{x:a.x>=b.left&&a.x<=b.right?0:Math.min(Math.abs(a.x-b.left),Math.abs(a.x-b.right)),y:a.y>=b.top&&a.y<=b.bottom?0:Math.min(Math.abs(a.y-b.top),Math.abs(a.y-b.bottom))}}function bu(a){let{element:c,orientation:d,panels:e,separators:f}=a,g=bp(d,Array.from(c.children).filter(bs).map(a=>({element:a}))).map(({element:a})=>a),h=[],i=!1,j=!1,k=-1,l=-1,m=0,n,o=[];{let a=-1;for(let b of g)b.hasAttribute("data-panel")&&(a++,null===b.ariaDisabled&&(m++,-1===k&&(k=a),l=a))}if(m>1){let c=-1;for(let m of g)if(m.hasAttribute("data-panel")){c++;let f=e.find(a=>a.element===m);if(f){if(n){let e,g=n.element.getBoundingClientRect(),p=m.getBoundingClientRect();if(j){let a="horizontal"===d?new DOMRect(g.right,g.top,0,g.height):new DOMRect(g.left,g.bottom,g.width,0),b="horizontal"===d?new DOMRect(p.left,p.top,0,p.height):new DOMRect(p.left,p.top,p.width,0);switch(o.length){case 0:e=[a,b];break;case 1:{let c=o[0],f=function({orientation:a,rects:b,targetRect:c}){let d={x:c.x+c.width/2,y:c.y+c.height/2},e,f=Number.MAX_VALUE;for(let c of b){let{x:b,y:g}=bt(d,c),h="horizontal"===a?b:g;h<f&&(f=h,e=c)}return bo(e,"No rect found"),e}({orientation:d,rects:[g,p],targetRect:c.element.getBoundingClientRect()});e=[c,f===g?b:a];break}default:e=o}}else e=o.length?o:["horizontal"===d?new DOMRect(g.right,p.top,p.left-g.right,p.height):new DOMRect(p.left,g.bottom,p.width,p.top-g.bottom)];for(let d of e){let e="width"in d?d:d.element.getBoundingClientRect(),g=(void 0===b&&(b="function"==typeof matchMedia&&!!matchMedia("(pointer:coarse)").matches),b)?a.resizeTargetMinimumSize.coarse:a.resizeTargetMinimumSize.fine;if(e.width<g){let a=g-e.width;e=new DOMRect(e.x-a/2,e.y,e.width+a,e.height)}if(e.height<g){let a=g-e.height;e=new DOMRect(e.x,e.y-a/2,e.width,e.height+a)}let j=c<=k||c>l;i||j||h.push({group:a,groupSize:bm({group:a}),panels:[n,f],separator:"width"in d?void 0:d,rect:e}),i=!1}}j=!1,n=f,o=[]}}else if(m.hasAttribute("data-separator")){null!==m.ariaDisabled&&(i=!0);let a=f.find(a=>a.element===m);a?o.push(a):(n=void 0,o=[])}else j=!0}return h}function bv(a,b,c=0){return Math.abs(bl(a)-bl(b))<=c}let bw={cursorFlags:0,interactionState:{state:"inactive"},mountedGroups:new Map},bx=new class{#a={};addListener(a,b){let c=this.#a[a];return void 0===c?this.#a[a]=[b]:c.includes(b)||c.push(b),()=>{this.removeListener(a,b)}}emit(a,b){let c=this.#a[a];if(void 0!==c)if(1===c.length)c[0].call(null,b);else{let a=!1,d=null,e=Array.from(c);for(let c=0;c<e.length;c++){let f=e[c];try{f.call(null,b)}catch(b){null===d&&(a=!0,d=b)}}if(a)throw d}}removeAllListeners(){this.#a={}}removeListener(a,b){let c=this.#a[a];if(void 0!==c){let a=c.indexOf(b);a>=0&&c.splice(a,1)}}};function by(a){let b="function"==typeof a?a(bw):a;if(bw===b)return bw;let c=bw;return bw={...bw,...b},void 0!==b.cursorFlags&&bx.emit("cursorFlagsChange",bw.cursorFlags),void 0!==b.interactionState&&bx.emit("interactionStateChange",bw.interactionState),void 0!==b.mountedGroups&&(bw.mountedGroups.forEach((a,b)=>{a.derivedPanelConstraints.forEach(d=>{if(d.collapsible){let{layout:e}=c.mountedGroups.get(b)??{};if(e){let c=bv(d.collapsedSize,a.layout[d.panelId]),f=bv(d.collapsedSize,e[d.panelId]);c&&!f&&(b.inMemoryLastExpandedPanelSizes[d.panelId]=e[d.panelId])}}})}),bx.emit("mountedGroupsChange",bw.mountedGroups)),bw}let bz=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function bA(a){let b=a.length;for(;b--;){let c=a[b];if(bo(c,"Missing node"),function(a){let b,c=getComputedStyle(a);return!!("fixed"===c.position||"auto"!==c.zIndex&&("static"!==c.position||"flex"===(b=getComputedStyle(bD(a)??a).display)||"inline-flex"===b)||1>+c.opacity||"transform"in c&&"none"!==c.transform||"webkitTransform"in c&&"none"!==c.webkitTransform||"mixBlendMode"in c&&"normal"!==c.mixBlendMode||"filter"in c&&"none"!==c.filter||"webkitFilter"in c&&"none"!==c.webkitFilter||"isolation"in c&&"isolate"===c.isolation||bz.test(c.willChange)||"touch"===c.webkitOverflowScrolling)}(c))return c}return null}function bB(a){return a&&Number(getComputedStyle(a).zIndex)||0}function bC(a){let b=[];for(;a;)b.push(a),a=bD(a);return b}function bD(a){let{parentNode:b}=a;return null!==b&&"object"==typeof b&&"nodeType"in b&&b.nodeType===Node.DOCUMENT_FRAGMENT_NODE?b.host:b}function bE(a,b){let c=[];return b.forEach((b,d)=>{if(d.disabled)return;let e=bu(d),f=function(a,b,c){let d,e={x:1/0,y:1/0};for(let f of b){let b=bt(c,f.rect);switch(a){case"horizontal":b.x<=e.x&&(d=f,e=b);break;case"vertical":b.y<=e.y&&(d=f,e=b)}}return d?{distance:e,hitRegion:d}:void 0}(d.orientation,e,{x:a.clientX,y:a.clientY});f&&f.distance.x<=0&&f.distance.y<=0&&function({groupElement:a,hitRegion:b,pointerEventTarget:c}){if(!bs(c)||c.contains(a)||a.contains(c))return!0;if(function(a,b){let c;if(a===b)throw Error("Cannot compare node with itself");let d={a:bC(a),b:bC(b)};for(;d.a.at(-1)===d.b.at(-1);)c=d.a.pop(),d.b.pop();bo(c,"Stacking order can only be calculated for elements with a common ancestor");let e={a:bB(bA(d.a)),b:bB(bA(d.b))};if(e.a===e.b){let a=c.childNodes,b={a:d.a.at(-1),b:d.b.at(-1)},e=a.length;for(;e--;){let c=a[e];if(c===b.a)return 1;if(c===b.b)return -1}}return Math.sign(e.a-e.b)}(c,a)>0){let e=c;for(;e;){var d;if(e.contains(a))break;if(d=e.getBoundingClientRect(),d.x<b.x+b.width&&d.x+d.width>b.x&&d.y<b.y+b.height&&d.y+d.height>b.y)return!1;e=e.parentElement}}return!0}({groupElement:d.element,hitRegion:f.hitRegion.rect,pointerEventTarget:a.target})&&c.push(f.hitRegion)}),c}function bF(a,b){return bv(a,b)?0:a>b?1:-1}function bG({overrideDisabledPanels:a,panelConstraints:b,prevSize:c,size:d}){let{collapsedSize:e=0,collapsible:f,disabled:g,maxSize:h=100,minSize:i=0}=b;return g&&!a?c:(0>bF(d,i)&&(d=f&&0>bF(d,(e+i)/2)?e:i),bl(d=Math.min(h,d)))}function bH({delta:a,initialLayout:b,panelConstraints:c,pivotIndices:d,prevLayout:e,trigger:f}){if(bv(a,0))return b;let g="imperative-api"===f,h=Object.values(b),i=Object.values(e),j=[...h],[k,l]=d;bo(null!=k,"Invalid first pivot index"),bo(null!=l,"Invalid second pivot index");let m=0;if("keyboard"===f){{let b=a<0?l:k,d=c[b];bo(d,`Panel constraints not found for index ${b}`);let{collapsedSize:e=0,collapsible:f,minSize:g=0}=d;if(f){let c=h[b];if(bo(null!=c,`Previous layout not found for panel index ${b}`),bv(c,e)){let b=g-c;bF(b,Math.abs(a))>0&&(a=a<0?0-b:b)}}}{let b=a<0?k:l,d=c[b];bo(d,`No panel constraints found for index ${b}`);let{collapsedSize:e=0,collapsible:f,minSize:g=0}=d;if(f){let c=h[b];if(bo(null!=c,`Previous layout not found for panel index ${b}`),bv(c,g)){let b=c-e;bF(b,Math.abs(a))>0&&(a=a<0?0-b:b)}}}}else{let b=a<0?l:k,d=c[b];bo(d,`Panel constraints not found for index ${b}`);let e=h[b],{collapsible:f,collapsedSize:g,minSize:i}=d;if(f&&0>bF(e,i))if(a>0){let b=i-g;0>bF(e+a,i)&&(a=0>=bF(a,b/2)?0:b)}else{let b=i-g;0>bF(e-a,i)&&(a=bF(100+a,100-b/2)>0?0:-b)}}{let b=a<0?1:-1,d=a<0?l:k,e=0;for(;;){let a=h[d];if(bo(null!=a,`Previous layout not found for panel index ${d}`),e+=bG({overrideDisabledPanels:g,panelConstraints:c[d],prevSize:a,size:100})-a,(d+=b)<0||d>=c.length)break}let f=Math.min(Math.abs(a),Math.abs(e));a=a<0?0-f:f}{let b=a<0?k:l;for(;b>=0&&b<c.length;){let d=Math.abs(a)-Math.abs(m),e=h[b];bo(null!=e,`Previous layout not found for panel index ${b}`);let f=e-d,i=bG({overrideDisabledPanels:g,panelConstraints:c[b],prevSize:e,size:f});if(!bv(e,i)&&(m+=e-i,j[b]=i,m.toFixed(3).localeCompare(Math.abs(a).toFixed(3),void 0,{numeric:!0})>=0))break;a<0?b--:b++}}if(function(a,b){if(a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0}(i,j))return e;{let b=a<0?l:k,d=h[b];bo(null!=d,`Previous layout not found for panel index ${b}`);let e=d+m,f=bG({overrideDisabledPanels:g,panelConstraints:c[b],prevSize:d,size:e});if(j[b]=f,!bv(f,e)){let b=e-f,d=a<0?l:k;for(;d>=0&&d<c.length;){let e=j[d];bo(null!=e,`Previous layout not found for panel index ${d}`);let f=e+b,h=bG({overrideDisabledPanels:g,panelConstraints:c[d],prevSize:e,size:f});if(bv(e,h)||(b-=h-e,j[d]=h),bv(b,0))break;a>0?d--:d++}}}if(!bv(Object.values(j).reduce((a,b)=>b+a,0),100,.1))return e;let n=Object.keys(e);return j.reduce((a,b,c)=>(a[n[c]]=b,a),{})}function bI(a,b){if(Object.keys(a).length!==Object.keys(b).length)return!1;for(let c in a)if(void 0===b[c]||0!==bF(a[c],b[c]))return!1;return!0}function bJ({layout:a,panelConstraints:b}){let c=Object.values(a),d=[...c],e=d.reduce((a,b)=>a+b,0);if(d.length!==b.length)throw Error(`Invalid ${b.length} panel layout: ${d.map(a=>`${a}%`).join(", ")}`);if(!bv(e,100)&&d.length>0)for(let a=0;a<b.length;a++){let b=d[a];bo(null!=b,`No layout data found for index ${a}`);let c=100/e*b;d[a]=c}let f=0;for(let a=0;a<b.length;a++){let e=c[a];bo(null!=e,`No layout data found for index ${a}`);let g=d[a];bo(null!=g,`No layout data found for index ${a}`);let h=bG({overrideDisabledPanels:!0,panelConstraints:b[a],prevSize:e,size:g});g!=h&&(f+=g-h,d[a]=h)}if(!bv(f,0))for(let a=0;a<b.length;a++){let c=d[a];bo(null!=c,`No layout data found for index ${a}`);let e=c+f,g=bG({overrideDisabledPanels:!0,panelConstraints:b[a],prevSize:c,size:e});if(c!==g&&(f-=g-c,d[a]=g,bv(f,0)))break}let g=Object.keys(a);return d.reduce((a,b,c)=>(a[g[c]]=b,a),{})}function bK({groupId:a,panelId:b}){let c=()=>{let{mountedGroups:b}=bw;for(let[c,{defaultLayoutDeferred:d,derivedPanelConstraints:e,layout:f,separatorToPanels:g}]of b)if(c.id===a)return{defaultLayoutDeferred:d,derivedPanelConstraints:e,group:c,layout:f,separatorToPanels:g};throw Error(`Group ${a} not found`)},d=()=>{let a=c().derivedPanelConstraints.find(a=>a.panelId===b);if(void 0!==a)return a;throw Error(`Panel constraints not found for Panel ${b}`)},e=()=>{let a=c().group.panels.find(a=>a.id===b);if(void 0!==a)return a;throw Error(`Layout not found for Panel ${b}`)},f=()=>{let a=c().layout[b];if(void 0!==a)return a;throw Error(`Layout not found for Panel ${b}`)},g=a=>{let d=f();if(a===d)return;let{defaultLayoutDeferred:e,derivedPanelConstraints:g,group:h,layout:i,separatorToPanels:j}=c(),k=h.panels.findIndex(a=>a.id===b),l=k===h.panels.length-1,m=bJ({layout:bH({delta:l?d-a:a-d,initialLayout:i,panelConstraints:g,pivotIndices:l?[k-1,k]:[k,k+1],prevLayout:i,trigger:"imperative-api"}),panelConstraints:g});bI(i,m)||by(a=>({mountedGroups:new Map(a.mountedGroups).set(h,{defaultLayoutDeferred:e,derivedPanelConstraints:g,layout:m,separatorToPanels:j})}))};return{collapse:()=>{let{collapsible:a,collapsedSize:b}=d(),{mutableValues:c}=e(),h=f();a&&h!==b&&(c.expandToSize=h,g(b))},expand:()=>{let{collapsible:a,collapsedSize:b,minSize:c}=d(),{mutableValues:h}=e(),i=f();if(a&&i===b){let a=h.expandToSize??c;0===a&&(a=1),g(a)}},getSize:()=>{let{group:a}=c(),b=f(),{element:d}=e();return{asPercentage:b,inPixels:"horizontal"===a.orientation?d.offsetWidth:d.offsetHeight}},isCollapsed:()=>{let{collapsible:a,collapsedSize:b}=d(),c=f();return a&&bv(b,c)},resize:a=>{if(f()!==a){let b;switch(typeof a){case"number":{let{group:d}=c();b=bl(a/bm({group:d})*100);break}case"string":b=parseFloat(a)}g(b)}}}}function bL(a){if(a.defaultPrevented)return;let{mountedGroups:b}=bw;bE(a,b).forEach(b=>{if(b.separator){let c=b.panels.find(a=>void 0!==a.panelConstraints.defaultSize);if(c){let d=c.panelConstraints.defaultSize,e=bK({groupId:b.group.id,panelId:c.id});e&&void 0!==d&&(e.resize(d),a.preventDefault())}}})}function bM(a){let{mountedGroups:b}=bw;for(let[c]of b)if(c.separators.some(b=>b.element===a))return c;throw Error("Could not find parent Group for separator element")}function bN({groupId:a}){let b=()=>{let{mountedGroups:b}=bw;for(let[c,d]of b)if(c.id===a)return{group:c,...d};throw Error(`Could not find Group with id "${a}"`)};return{getLayout(){let{defaultLayoutDeferred:a,layout:c}=b();return a?{}:c},setLayout(a){let{defaultLayoutDeferred:c,derivedPanelConstraints:d,group:e,layout:f,separatorToPanels:g}=b(),h=bJ({layout:a,panelConstraints:d});if(c)return f;if(!bI(f,h)){by(a=>({mountedGroups:new Map(a.mountedGroups).set(e,{defaultLayoutDeferred:c,derivedPanelConstraints:d,layout:h,separatorToPanels:g})}));let a=e.panels.map(({id:a})=>a).join(",");e.inMemoryLayouts[a]=h}return h}}}function bO(a){let{mountedGroups:b}=bw,c=b.get(a);return bo(c,`Mounted Group ${a.id} not found`),c}function bP(a,b){let c=bM(a),d=bO(c),e=c.separators.find(b=>b.element===a);bo(e,"Matching separator not found");let f=d.separatorToPanels.get(e);bo(f,"Matching panels not found");let g=f.map(a=>c.panels.indexOf(a)),h=bN({groupId:c.id}).getLayout(),i=bJ({layout:bH({delta:b,initialLayout:h,panelConstraints:d.derivedPanelConstraints,pivotIndices:g,prevLayout:h,trigger:"keyboard"}),panelConstraints:d.derivedPanelConstraints});bI(h,i)||by(a=>({mountedGroups:new Map(a.mountedGroups).set(c,{defaultLayoutDeferred:d.defaultLayoutDeferred,derivedPanelConstraints:d.derivedPanelConstraints,layout:i,separatorToPanels:d.separatorToPanels})}))}function bQ(a){if(a.defaultPrevented)return;let b=a.currentTarget,c=bM(b);if(!c.disabled)switch(a.key){case"ArrowDown":a.preventDefault(),"vertical"===c.orientation&&bP(b,5);break;case"ArrowLeft":a.preventDefault(),"horizontal"===c.orientation&&bP(b,-5);break;case"ArrowRight":a.preventDefault(),"horizontal"===c.orientation&&bP(b,5);break;case"ArrowUp":a.preventDefault(),"vertical"===c.orientation&&bP(b,-5);break;case"End":a.preventDefault(),bP(b,100);break;case"Enter":{a.preventDefault();let c=bM(b),{derivedPanelConstraints:d,layout:e,separatorToPanels:f}=bO(c),g=c.separators.find(a=>a.element===b);bo(g,"Matching separator not found");let h=f.get(g);bo(h,"Matching panels not found");let i=h[0],j=d.find(a=>a.panelId===i.id);if(bo(j,"Panel metadata not found"),j.collapsible){let a=e[i.id];bP(b,(j.collapsedSize===a?c.inMemoryLastExpandedPanelSizes[i.id]??j.minSize:j.collapsedSize)-a)}break}case"F6":{a.preventDefault();let c=bM(b).separators.map(a=>a.element),d=Array.from(c).findIndex(b=>b===a.currentTarget);bo(null!==d,"Index not found");let e=a.shiftKey?d>0?d-1:c.length-1:d+1<c.length?d+1:0;c[e].focus();break}case"Home":a.preventDefault(),bP(b,-100)}}function bR(a){if(a.defaultPrevented||"mouse"===a.pointerType&&a.button>0)return;let{mountedGroups:b}=bw,c=bE(a,b),d=new Map,e=!1;c.forEach(a=>{a.separator&&(e||(e=!0,a.separator.element.focus()));let c=b.get(a.group);c&&d.set(a.group,c.layout)}),by({interactionState:{hitRegions:c,initialLayoutMap:d,pointerDownAtPoint:{x:a.clientX,y:a.clientY},state:"active"}}),c.length&&a.preventDefault()}let bS=a=>a,bT=()=>{};function bU(){return void 0===c&&(c=!1),c}let bV=new WeakMap;function bW(a){if(null===a.defaultView||void 0===a.defaultView)return;let{prevStyle:b,styleSheet:c}=bV.get(a)??{};void 0===c&&(c=new a.defaultView.CSSStyleSheet,a.adoptedStyleSheets.push(c));let{cursorFlags:d,interactionState:e}=bw;switch(e.state){case"active":case"hover":{let a=function({cursorFlags:a,groups:b,state:c}){let d=0,e=0;switch(c){case"active":case"hover":b.forEach(a=>{if(!a.disableCursor)switch(a.orientation){case"horizontal":d++;break;case"vertical":e++}})}if(0!==d||0!==e){if("active"===c&&a&&bU()){let b=(4&a)!=0,c=(8&a)!=0;if((1&a)!=0)return b?"se-resize":c?"ne-resize":"e-resize";if((2&a)!=0)return b?"sw-resize":c?"nw-resize":"w-resize";if(b)return"s-resize";if(c)return"n-resize"}return bU()?d>0&&e>0?"move":d>0?"ew-resize":"ns-resize":d>0&&e>0?"grab":d>0?"col-resize":"row-resize"}}({cursorFlags:d,groups:e.hitRegions.map(a=>a.group),state:e.state}),f=`*, *:hover {cursor: ${a} !important; }`;if(b===f)return;b=f,a?0===c.cssRules.length?c.insertRule(f):c.replaceSync(f):1===c.cssRules.length&&c.deleteRule(0);break}case"inactive":b=void 0,1===c.cssRules.length&&c.deleteRule(0)}bV.set(a,{prevStyle:b,styleSheet:c})}function bX({document:a,event:b,hitRegions:c,initialLayoutMap:d,mountedGroups:e,pointerDownAtPoint:f,prevCursorFlags:g}){let h=0,i=new Map(e);c.forEach(a=>{let{group:c,groupSize:g}=a,{disableCursor:j,orientation:k,panels:l}=c,m=0;m=f?"horizontal"===k?(b.clientX-f.x)/g*100:(b.clientY-f.y)/g*100:"horizontal"===k?b.clientX<0?-100:100:b.clientY<0?-100:100;let n=d.get(c),{defaultLayoutDeferred:o,derivedPanelConstraints:p,layout:q,separatorToPanels:r}=e.get(c)??{defaultLayoutDeferred:!1};if(p&&n&&q&&r){let b=bH({delta:m,initialLayout:n,panelConstraints:p,pivotIndices:a.panels.map(a=>l.indexOf(a)),prevLayout:q,trigger:"mouse-or-touch"});if(bI(b,q)){if(0!==m&&!j)switch(k){case"horizontal":h|=m<0?1:2;break;case"vertical":h|=m<0?4:8}}else{i.set(a.group,{defaultLayoutDeferred:o,derivedPanelConstraints:p,layout:b,separatorToPanels:r});let c=a.group.panels.map(({id:a})=>a).join(",");a.group.inMemoryLayouts[c]=b}}});let j=0;0===b.movementX?j|=3&g:j|=3&h,0===b.movementY?j|=12&g:j|=12&h,by({cursorFlags:j,mountedGroups:i}),bW(a)}function bY(a){let{cursorFlags:b,interactionState:c,mountedGroups:d}=bw;"active"===c.state&&bX({document:a.currentTarget,event:a,hitRegions:c.hitRegions,initialLayoutMap:c.initialLayoutMap,mountedGroups:d,prevCursorFlags:b})}function bZ(a){if(a.defaultPrevented)return;let{cursorFlags:b,interactionState:c,mountedGroups:d}=bw;if("active"===c.state){if(0===a.buttons){by(a=>"inactive"===a.interactionState.state?a:{cursorFlags:0,interactionState:{state:"inactive"}}),by(a=>({mountedGroups:new Map(a.mountedGroups)}));return}bX({document:a.currentTarget,event:a,hitRegions:c.hitRegions,initialLayoutMap:c.initialLayoutMap,mountedGroups:d,pointerDownAtPoint:c.pointerDownAtPoint,prevCursorFlags:b})}else{let b=bE(a,d);0===b.length?"inactive"!==c.state&&by({interactionState:{state:"inactive"}}):by({interactionState:{hitRegions:b,state:"hover"}}),bW(a.currentTarget)}}function b$(a){if(a.relatedTarget instanceof HTMLIFrameElement){let{interactionState:a}=bw;"hover"===a.state&&by({interactionState:{state:"inactive"}})}}function b_(a){if(a.defaultPrevented||"mouse"===a.pointerType&&a.button>0)return;let{interactionState:b}=bw;"active"===b.state&&(by({cursorFlags:0,interactionState:{state:"inactive"}}),b.hitRegions.length>0&&(bW(a.currentTarget),by(a=>({mountedGroups:new Map(a.mountedGroups)})),a.preventDefault()))}function b0(a){let b=0,c=0,d={};for(let e of a)if(void 0!==e.defaultSize){b++;let a=bl(e.defaultSize);c+=a,d[e.panelId]=a}else d[e.panelId]=void 0;let e=a.length-b;if(0!==e){let b=bl((100-c)/e);for(let c of a)void 0===c.defaultSize&&(d[c.panelId]=b)}return d}let b1=new Map;function b2(a){let b=(0,v.useId)();return`${a??b}`}let b3=v.useEffect;function b4(a){let b=(0,v.useRef)(a);return b3(()=>{b.current=a},[a]),(0,v.useCallback)((...a)=>b.current?.(...a),[b])}function b5(...a){return b4(b=>{a.forEach(a=>{if(a)switch(typeof a){case"function":a(b);break;case"object":a.current=b}})})}function b6(a){let b=(0,v.useRef)({...a});return b3(()=>{for(let c in a)b.current[c]=a[c]},[a]),b.current}let b7=(0,v.createContext)(null);function b8({children:a,className:b,defaultLayout:c,disableCursor:d,disabled:e,elementRef:f,groupRef:g,id:h,onLayoutChange:i,onLayoutChanged:j,orientation:k="horizontal",resizeTargetMinimumSize:l={coarse:20,fine:10},style:m,...n}){let o,p=(0,v.useRef)({onLayoutChange:{},onLayoutChanged:{}}),q=b4(a=>{bI(p.current.onLayoutChange,a)||(p.current.onLayoutChange=a,i?.(a))}),r=b4(a=>{bI(p.current.onLayoutChanged,a)||(p.current.onLayoutChanged=a,j?.(a))}),s=b2(h),u=(0,v.useRef)(null),[w,x]=function(){let[a,b]=(0,v.useState)({});return[a,(0,v.useCallback)(()=>b({}),[])]}(),y=(0,v.useRef)({lastExpandedPanelSizes:{},layouts:{},panels:[],resizeTargetMinimumSize:l,separators:[]}),z=b5(u,f);o=(0,v.useRef)({getLayout:()=>({}),setLayout:bS}),(0,v.useImperativeHandle)(g,()=>o.current,[]),b3(()=>{Object.assign(o.current,bN({groupId:s}))});let A=b4((a,b)=>{let{interactionState:d,mountedGroups:e}=bw;for(let c of e.keys())if(c.id===a){let a=e.get(c);if(a){let e=!1;return"active"===d.state&&(e=d.hitRegions.some(a=>a.group===c)),{flexGrow:a.layout[b]??1,pointerEvents:e?"none":void 0}}}return{flexGrow:c?.[b]??1}}),B=b6({defaultLayout:c,disableCursor:d}),C=(0,v.useMemo)(()=>({get disableCursor(){return!!B.disableCursor},getPanelStyles:A,id:s,orientation:k,registerPanel:a=>{let b=y.current;return b.panels=bp(k,[...b.panels,a]),x(),()=>{b.panels=b.panels.filter(b=>b!==a),x()}},registerSeparator:a=>{let b=y.current;return b.separators=bp(k,[...b.separators,a]),x(),()=>{b.separators=b.separators.filter(b=>b!==a),x()}},togglePanelDisabled:(a,b)=>{let c=y.current.panels.find(b=>b.id===a);c&&(c.panelConstraints.disabled=b);let{mountedGroups:d}=bw;for(let a of d.keys())if(a.id===s){let b=d.get(a);b&&(b.derivedPanelConstraints=bn(a))}},toggleSeparatorDisabled:(a,b)=>{let c=y.current.separators.find(b=>b.id===a);c&&(c.disabled=b)}}),[A,s,x,k,B]),D=(0,v.useRef)(null);return b3(()=>{let a,b,c,d,f,g,h,i,j,l,m,n,o,p=u.current;if(null===p)return;let t=y.current;if(void 0!==B.defaultLayout&&Object.keys(B.defaultLayout).length===t.panels.length)for(let b of(a={},t.panels)){let c=B.defaultLayout[b.id];void 0!==c&&(a[b.id]=c)}let v={defaultLayout:a,disableCursor:!!B.disableCursor,disabled:!!e,element:p,id:s,inMemoryLastExpandedPanelSizes:y.current.lastExpandedPanelSizes,inMemoryLayouts:y.current.layouts,orientation:k,panels:t.panels,resizeTargetMinimumSize:t.resizeTargetMinimumSize,separators:t.separators};D.current=v;let w=(b=!0,bo(v.element.ownerDocument.defaultView,"Cannot register an unmounted Group"),c=v.element.ownerDocument.defaultView.ResizeObserver,d=new Set,f=new Set,(g=new c(a=>{for(let c of a){let{borderBoxSize:a,target:d}=c;if(d===v.element){if(b){if(0===bm({group:v}))return;by(a=>{let b=a.mountedGroups.get(v);if(b){let c=bn(v),d=b.defaultLayoutDeferred?b0(c):b.layout,e=bJ({layout:d,panelConstraints:c});return!b.defaultLayoutDeferred&&bI(d,e)&&function(a,b){if(Object.keys(a).length!==Object.keys(b).length)return!1;for(let c in a)if(a[c]!==b[c])return!1;return!0}(b.derivedPanelConstraints,c)?a:{mountedGroups:new Map(a.mountedGroups).set(v,{defaultLayoutDeferred:!1,derivedPanelConstraints:c,layout:e,separatorToPanels:b.separatorToPanels})}}return a})}}else!function(a,b,c){if(!c[0])return;let d=a.panels.find(a=>a.element===b);if(!d||!d.onResize)return;let e=bm({group:a}),f="horizontal"===a.orientation?d.element.offsetWidth:d.element.offsetHeight,g=d.mutableValues.prevSize,h={asPercentage:bl(f/e*100),inPixels:f};d.mutableValues.prevSize=h,d.onResize(h,d.id,g)}(v,d,a)}})).observe(v.element),v.panels.forEach(a=>{bo(!d.has(a.id),`Panel ids must be unique; id "${a.id}" was used more than once`),d.add(a.id),a.onResize&&g.observe(a.element)}),h=bm({group:v}),i=bn(v),j=v.panels.map(({id:a})=>a).join(","),(l=v.defaultLayout)&&(function(a,b){let c=a.map(a=>a.id),d=Object.keys(b);if(c.length!==d.length)return!1;for(let a of c)if(!d.includes(a))return!1;return!0}(v.panels,l)||(l=void 0)),m=bJ({layout:v.inMemoryLayouts[j]??l??b0(i),panelConstraints:i}),n=bu(v),o=v.element.ownerDocument,by(a=>{let b=new Map;return b1.set(o,(b1.get(o)??0)+1),n.forEach(a=>{a.separator&&b.set(a.separator,a.panels)}),{mountedGroups:new Map(a.mountedGroups).set(v,{defaultLayoutDeferred:0===h,derivedPanelConstraints:i,layout:m,separatorToPanels:b})}}),v.separators.forEach(a=>{bo(!f.has(a.id),`Separator ids must be unique; id "${a.id}" was used more than once`),f.add(a.id),a.element.addEventListener("keydown",bQ)}),1===b1.get(o)&&(o.addEventListener("dblclick",bL,!0),o.addEventListener("pointerdown",bR,!0),o.addEventListener("pointerleave",bY),o.addEventListener("pointermove",bZ),o.addEventListener("pointerout",b$),o.addEventListener("pointerup",b_,!0)),function(){b=!1,b1.set(o,Math.max(0,(b1.get(o)??0)-1)),by(a=>{let b=new Map(a.mountedGroups);return b.delete(v),{mountedGroups:b}}),v.separators.forEach(a=>{a.element.removeEventListener("keydown",bQ)}),b1.get(o)||(o.removeEventListener("dblclick",bL,!0),o.removeEventListener("pointerdown",bR,!0),o.removeEventListener("pointerleave",bY),o.removeEventListener("pointermove",bZ),o.removeEventListener("pointerout",b$),o.removeEventListener("pointerup",b_,!0)),g.disconnect()}),x=bw.mountedGroups.get(v);if(x){let{defaultLayoutDeferred:a,derivedPanelConstraints:b,layout:c}=x;!a&&b.length>0&&(q(c),r(c))}let z=bx.addListener("interactionStateChange",a=>{a.state}),A=bx.addListener("mountedGroupsChange",a=>{let b=a.get(v);if(b){let{defaultLayoutDeferred:a,derivedPanelConstraints:c,layout:d}=b;if(a||0===c.length)return;let{interactionState:e}=bw,f="active"!==e.state;q(d),f&&r(d)}});return()=>{D.current=null,w(),z(),A()}},[e,s,r,q,k,w,B]),(0,v.useEffect)(()=>{let a=D.current;a&&(a.defaultLayout=c,a.disableCursor=!!d)}),(0,t.jsx)(b7.Provider,{value:C,children:(0,t.jsx)("div",{...n,className:b,"data-group":!0,"data-testid":s,id:s,ref:z,style:{height:"100%",width:"100%",overflow:"hidden",...m,display:"flex",flexDirection:"horizontal"===k?"row":"column",flexWrap:"nowrap",touchAction:"horizontal"===k?"pan-y":"pan-x"},children:a})})}function b9(){let a=(0,v.useContext)(b7);return bo(a,"Group Context not found; did you render a Panel or Separator outside of a Group?"),a}function ca({children:a,className:b,collapsedSize:c="0%",collapsible:d=!1,defaultSize:e,disabled:f,elementRef:g,id:h,maxSize:i="100%",minSize:j="0%",onResize:k,panelRef:l,style:m,...n}){let o=!!h,p=b2(h),q=b6({disabled:f}),r=(0,v.useRef)(null),s=b5(r,g),{getPanelStyles:u,id:w,orientation:x,registerPanel:y,togglePanelDisabled:z}=b9(),A=null!==k,B=b4((a,b,c)=>{k?.(a,h,c)});b3(()=>{let a=r.current;if(null!==a)return y({element:a,id:p,idIsStable:o,mutableValues:{expandToSize:void 0,prevSize:void 0},onResize:A?B:void 0,panelConstraints:{collapsedSize:c,collapsible:d,defaultSize:e,disabled:q.disabled,maxSize:i,minSize:j}})},[c,d,e,A,p,o,i,j,B,y,q]),(0,v.useEffect)(()=>{z(p,!!f)},[f,p,z]),function(a,b){let{id:c}=b9(),d=(0,v.useRef)({collapse:bT,expand:bT,getSize:()=>({asPercentage:0,inPixels:0}),isCollapsed:()=>!1,resize:bT});(0,v.useImperativeHandle)(b,()=>d.current,[]),b3(()=>{Object.assign(d.current,bK({groupId:c,panelId:a}))})}(p,l);let C=(0,v.useSyncExternalStore)(a=>(bx.addListener("mountedGroupsChange",a),()=>{bx.removeListener("mountedGroupsChange",a)}),()=>JSON.stringify(u(w,p)),()=>JSON.stringify(u(w,p)));return(0,t.jsx)("div",{...n,"aria-disabled":f||void 0,"data-panel":!0,"data-testid":p,id:p,ref:s,style:{...cb,display:"flex",flexBasis:0,flexShrink:1,overflow:"hidden",...JSON.parse(C)},children:(0,t.jsx)("div",{className:b,style:{maxHeight:"100%",maxWidth:"100%",flexGrow:1,...m,touchAction:"horizontal"===x?"pan-y":"pan-x"},children:a})})}b8.displayName="Group",ca.displayName="Panel";let cb={minHeight:0,maxHeight:"100%",height:"auto",minWidth:0,maxWidth:"100%",width:"auto",border:"none",borderWidth:0,padding:0,margin:0};function cc({children:a,className:b,disabled:c,elementRef:d,id:e,style:f,...g}){let h,i=b2(e),j=b6({disabled:c}),[k,l]=(0,v.useState)({}),[m,n]=(0,v.useState)("inactive"),o=(0,v.useRef)(null),p=b5(o,d),{disableCursor:q,id:r,orientation:s,registerSeparator:u,toggleSeparatorDisabled:w}=b9();return b3(()=>{let a=o.current;if(null!==a){let b={disabled:j.disabled,element:a,id:i},c=u(b),d=bx.addListener("interactionStateChange",a=>{n("inactive"!==a.state&&a.hitRegions.some(a=>a.separator===b)?a.state:"inactive")}),e=bx.addListener("mountedGroupsChange",a=>{a.forEach(({derivedPanelConstraints:a,layout:c,separatorToPanels:d},e)=>{if(e.id===r){let f=d.get(b);if(f){let b=f[0],d=e.panels.indexOf(b);l(function({layout:a,panelConstraints:b,panelId:c,panelIndex:d}){let e,f,g=a[c],h=b.find(a=>a.panelId===c);if(h){let i=h.maxSize,j=h.collapsible?h.collapsedSize:h.minSize,k=[d,d+1];f=bJ({layout:bH({delta:j-g,initialLayout:a,panelConstraints:b,pivotIndices:k,prevLayout:a}),panelConstraints:b})[c],e=bJ({layout:bH({delta:i-g,initialLayout:a,panelConstraints:b,pivotIndices:k,prevLayout:a}),panelConstraints:b})[c]}return{valueControls:c,valueMax:e,valueMin:f,valueNow:g}}({layout:c,panelConstraints:a,panelId:b.id,panelIndex:d}))}}})});return()=>{d(),e(),c()}}},[r,i,u,j]),(0,v.useEffect)(()=>{w(i,!!c)},[c,i,w]),c&&!q&&(h="not-allowed"),(0,t.jsx)("div",{...g,"aria-controls":k.valueControls,"aria-disabled":c||void 0,"aria-orientation":"horizontal"===s?"vertical":"horizontal","aria-valuemax":k.valueMax,"aria-valuemin":k.valueMin,"aria-valuenow":k.valueNow,children:a,className:b,"data-separator":c?"disabled":m,"data-testid":i,id:i,ref:p,role:"separator",style:{flexBasis:"auto",cursor:h,...f,flexGrow:0,flexShrink:0,touchAction:"none"},tabIndex:c?void 0:0})}cc.displayName="Separator";let cd=(0,aa.default)("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);var ce=a.i(229020);let cf=(0,aa.default)("clipboard-check",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]),cg=(0,aa.default)("sticky-note",[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]]);var ch=a.i(892094),ci=a.i(801728),cj=a.i(923266),ck=a.i(268067),cl=a.i(640132);let cm=(0,aa.default)("panels-top-left",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]),cn={subject:a6.GraduationCap,lesson:a7.BookOpen,task:a8.FileQuestion,assessment:cf,note:cg},co={subject:"bg-blue-500/20 text-blue-400 border-blue-500/50",lesson:"bg-green-500/20 text-green-400 border-green-500/50",task:"bg-orange-500/20 text-orange-400 border-orange-500/50",assessment:"bg-purple-500/20 text-purple-400 border-purple-500/50",note:"bg-yellow-500/20 text-yellow-400 border-yellow-500/50"},cp={subject:"Subject",lesson:"Lesson",task:"Task",assessment:"Assessment",note:"Note"},cq=[{id:"sub-1",name:"Mathematics",type:"subject",parentId:null,createdAt:new Date("2026-01-15"),updatedAt:new Date("2026-02-10"),description:"Mathematics curriculum materials",metadata:{topic:"math"}},{id:"les-1",name:"Algebra Basics",type:"lesson",parentId:"sub-1",createdAt:new Date("2026-01-16"),updatedAt:new Date("2026-01-20"),description:"Introduction to algebra",metadata:{topic:"algebra",tags:["variables","equations"]}},{id:"les-2",name:"Linear Equations",type:"lesson",parentId:"sub-1",createdAt:new Date("2026-01-18"),updatedAt:new Date("2026-01-25"),metadata:{topic:"algebra",tags:["linear_equations"]}},{id:"task-101",name:"Quadratic Formula Practice",type:"task",parentId:"les-1",createdAt:new Date,updatedAt:new Date,description:"Targeted practice for finding roots.",metadata:{topic:"quadratic_equations",tags:["finding_roots"],difficulty:"hard"}},{id:"task-1",name:"Practice Problems Set 1",type:"task",parentId:"les-1",createdAt:new Date("2026-01-17"),updatedAt:new Date("2026-01-17"),metadata:{taskType:"multiple_choice",difficulty:"beginner"}},{id:"task-2",name:"Quiz: Variables",type:"task",parentId:"les-1",createdAt:new Date("2026-01-19"),updatedAt:new Date("2026-01-19"),metadata:{taskType:"short_answer",difficulty:"intermediate"}},{id:"assess-1",name:"Algebra Mid-Assessment",type:"assessment",parentId:"sub-1",createdAt:new Date("2026-01-30"),updatedAt:new Date("2026-02-01"),metadata:{duration:45}},{id:"note-1",name:"Teaching Notes",type:"note",parentId:"les-1",createdAt:new Date("2026-01-16"),updatedAt:new Date("2026-02-05"),content:"Focus on real-world examples. Students struggle with negative numbers."},{id:"sub-2",name:"Physics",type:"subject",parentId:null,createdAt:new Date("2026-01-10"),updatedAt:new Date("2026-02-08"),description:"Physics curriculum"},{id:"les-3",name:"Mechanics",type:"lesson",parentId:"sub-2",createdAt:new Date("2026-01-12"),updatedAt:new Date("2026-01-15"),metadata:{tags:["force","motion"]}},{id:"task-3",name:"Force Problems",type:"task",parentId:"les-3",createdAt:new Date("2026-01-13"),updatedAt:new Date("2026-01-14"),metadata:{difficulty:"intermediate"}}];function cr({roomId:a,students:b=[],onAssetSelect:c,onAssetCreate:d,onAssetDelete:e,selectionMode:f,onAssetsSelect:g,onClose:h}){let[i,j]=(0,v.useState)(cq),[k,l]=(0,v.useState)(new Set(["sub-1","sub-2"])),[m,n]=(0,v.useState)(""),[o,p]=(0,v.useState)(null),[q,r]=(0,v.useState)("tree"),[s,u]=(0,v.useState)(new Set),w=(0,v.useMemo)(()=>{let a=new Set;return(b.forEach(b=>{"struggling"===b.status&&b.struggles&&b.struggles.forEach(b=>a.add(b.toLowerCase())),"struggling"===b.status&&(a.add("quadratic_equations"),a.add("finding_roots"))}),0===a.size)?[]:i.filter(b=>{let c=b.metadata?.topic&&a.has(b.metadata.topic.toLowerCase()),d=b.metadata?.tags?.some(b=>a.has(b.toLowerCase())),e=a.has(b.name.toLowerCase());return c||d||e})},[i,b]),x=(0,v.useMemo)(()=>i.filter(a=>null===a.parentId).sort((a,b)=>{let c="subject"===a.type||"lesson"===a.type,d="subject"===b.type||"lesson"===b.type;return c&&!d?-1:!c&&d?1:a.name.localeCompare(b.name)}),[i]),A=(0,v.useMemo)(()=>m?i.filter(a=>a.name.toLowerCase().includes(m.toLowerCase())||a.description?.toLowerCase().includes(m.toLowerCase())):null,[i,m]),C=(a,b=null)=>{let c={id:`${a}-${Date.now()}`,name:`New ${cp[a]}`,type:a,parentId:b,createdAt:new Date,updatedAt:new Date};j(a=>[...a,c]),b&&l(a=>new Set(a).add(b)),E.toast.success(`Created new ${cp[a]}`),d?.(c)},F=({type:a,isOpen:b})=>{let c="subject"===a||"lesson"===a?b?ce.FolderOpen:cd:cn[a];return(0,t.jsx)(c,{className:"h-4 w-4"})},H=(a,b=0)=>{let d,g="subject"===a.type||"lesson"===a.type,h=k.has(a.id),m=g?(d=a.id,i.filter(a=>a.parentId===d).sort((a,b)=>a.name.localeCompare(b.name))):[],n=m.length>0,q=o?.id===a.id;return(0,t.jsxs)("div",{className:"select-none",children:[(0,t.jsxs)("div",{className:`group flex items-center gap-2 px-3 py-2 my-0.5 rounded-lg cursor-pointer transition-all duration-200 border border-transparent
            ${q?"bg-blue-600/20 border-blue-500/30 text-white shadow-sm backdrop-blur-sm":"hover:bg-white/5 hover:border-white/10 text-gray-300"}`,style:{paddingLeft:`${12+16*b}px`},onClick:()=>{var b;g&&(b=a.id,l(a=>{let c=new Set(a);return c.has(b)?c.delete(b):c.add(b),c})),p(a),c?.(a)},children:[g&&n?h?(0,t.jsx)(ci.ChevronDown,{className:"h-4 w-4 text-gray-500"}):(0,t.jsx)(ch.ChevronRight,{className:"h-4 w-4 text-gray-500"}):(0,t.jsx)("span",{className:"w-4"}),f&&!g&&(0,t.jsx)("input",{type:"checkbox",className:"mr-2",checked:s.has(a.id),onClick:a=>a.stopPropagation(),onChange:b=>{var c,d;return c=a.id,d=b.target.checked,void u(a=>{let b=new Set(a);return d?b.add(c):b.delete(c),b})}}),(0,t.jsx)("span",{className:`p-1.5 rounded-md border ${co[a.type]}`,children:(0,t.jsx)(F,{type:a.type,isOpen:h})}),(0,t.jsx)("span",{className:"flex-1 truncate text-sm font-medium",children:a.name}),a.metadata?.difficulty&&(0,t.jsx)(z.Badge,{variant:"outline",className:`text-[10px] px-1 h-5 ${"hard"===a.metadata.difficulty?"border-red-500/50 text-red-400":"intermediate"===a.metadata.difficulty?"border-yellow-500/50 text-yellow-400":"border-green-500/50 text-green-400"}`,children:a.metadata.difficulty}),(0,t.jsxs)(D.DropdownMenu,{children:[(0,t.jsx)(D.DropdownMenuTrigger,{asChild:!0,onClick:a=>a.stopPropagation(),children:(0,t.jsx)(y.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)(M.MoreVertical,{className:"h-3 w-3"})})}),(0,t.jsxs)(D.DropdownMenuContent,{align:"end",className:"bg-gray-800 border-gray-700 text-gray-200",children:[(0,t.jsxs)(D.DropdownMenuItem,{onClick:b=>{b.stopPropagation(),p(a)},children:[(0,t.jsx)(bc.Eye,{className:"h-4 w-4 mr-2"}),"Preview"]}),(0,t.jsxs)(D.DropdownMenuItem,{onClick:a=>a.stopPropagation(),children:[(0,t.jsx)(ck.Edit,{className:"h-4 w-4 mr-2"}),"Rename"]}),(0,t.jsxs)(D.DropdownMenuItem,{onClick:a=>a.stopPropagation(),children:[(0,t.jsx)(cl.Download,{className:"h-4 w-4 mr-2"}),"Download"]}),(0,t.jsxs)(D.DropdownMenuItem,{className:"text-red-400 focus:text-red-400 focus:bg-red-900/20",onClick:b=>{let c;return b.stopPropagation(),void((c=a=>{i.filter(b=>b.parentId===a).forEach(a=>c(a.id)),j(b=>b.filter(b=>b.id!==a))})(a.id),E.toast.success("Asset deleted"),e?.(a.id))},children:[(0,t.jsx)(a5.Trash2,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]}),g&&h&&n&&(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute left-[20px] top-0 bottom-0 w-px bg-gray-800",style:{left:`${19+16*b}px`}}),m.map(a=>H(a,b+1))]})]},a.id)};return(0,t.jsxs)("div",{className:"h-full flex flex-col bg-black/40 backdrop-blur-xl border-l border-white/10 text-white shadow-2xl",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-white/10 shrink-0 bg-white/5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"bg-gradient-to-br from-amber-500 to-orange-600 p-2.5 rounded-xl shadow-lg shadow-orange-900/20 shrink-0",children:(0,t.jsx)(cj.Layers,{className:"h-5 w-5 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-400",children:"Smart Assets"}),(0,t.jsx)("p",{className:"text-xs text-gray-400",children:"AI-Curated Materials"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,t.jsx)(y.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full hover:bg-white/10",onClick:()=>r("tree"===q?"list":"tree"),children:(0,t.jsx)(cm,{className:"h-4 w-4"})}),(0,t.jsxs)(B.Dialog,{children:[(0,t.jsx)(B.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(y.Button,{size:"sm",className:"bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-900/20 border border-blue-400/20",children:[(0,t.jsx)(Z.Plus,{className:"h-4 w-4 mr-2"}),"New"]})}),(0,t.jsxs)(B.DialogContent,{className:"bg-gray-900/95 border-gray-700 text-white backdrop-blur-xl",children:[(0,t.jsx)(B.DialogHeader,{children:(0,t.jsx)(B.DialogTitle,{children:"Create New Asset"})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[(0,t.jsxs)(y.Button,{variant:"outline",className:"h-auto py-4 flex flex-col items-center gap-2 hover:bg-white/5 border-gray-700",onClick:()=>C("subject"),children:[(0,t.jsx)(a6.GraduationCap,{className:"h-6 w-6 text-blue-400"}),(0,t.jsx)("span",{children:"Subject"})]}),(0,t.jsxs)(y.Button,{variant:"outline",className:"h-auto py-4 flex flex-col items-center gap-2 hover:bg-white/5 border-gray-700",onClick:()=>C("lesson"),children:[(0,t.jsx)(a7.BookOpen,{className:"h-6 w-6 text-green-400"}),(0,t.jsx)("span",{children:"Lesson"})]}),(0,t.jsxs)(y.Button,{variant:"outline",className:"h-auto py-4 flex flex-col items-center gap-2 hover:bg-white/5 border-gray-700",onClick:()=>C("task"),children:[(0,t.jsx)(a8.FileQuestion,{className:"h-6 w-6 text-orange-400"}),(0,t.jsx)("span",{children:"Task"})]}),(0,t.jsxs)(y.Button,{variant:"outline",className:"h-auto py-4 flex flex-col items-center gap-2 hover:bg-white/5 border-gray-700",onClick:()=>C("assessment"),children:[(0,t.jsx)(cf,{className:"h-6 w-6 text-purple-400"}),(0,t.jsx)("span",{children:"Assessment"})]}),(0,t.jsxs)(y.Button,{variant:"outline",className:"h-auto py-4 flex flex-col items-center gap-2 col-span-2 hover:bg-white/5 border-gray-700",onClick:()=>C("note"),children:[(0,t.jsx)(cg,{className:"h-6 w-6 text-yellow-400"}),(0,t.jsx)("span",{children:"Note"})]})]})]})]}),f&&h&&(0,t.jsx)(y.Button,{variant:"ghost",size:"sm",onClick:h,className:"text-gray-400 hover:text-white",children:(0,t.jsx)(Y.X,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)(R.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-500 group-focus-within:text-blue-400 transition-colors"}),(0,t.jsx)(G.Input,{placeholder:"Search assets...",value:m,onChange:a=>n(a.target.value),className:"pl-10 bg-black/20 border-white/10 text-white focus:bg-black/40 focus:border-blue-500/50 transition-all rounded-xl"})]})]}),(0,t.jsxs)(b8,{orientation:"horizontal",className:"flex-1 min-h-0",children:[(0,t.jsx)(ca,{defaultSize:60,minSize:30,children:(0,t.jsxs)(I.ScrollArea,{className:"h-full",children:[w.length>0&&!m&&(0,t.jsxs)("div",{className:"p-4 pb-2 border-b border-white/5 bg-gradient-to-b from-blue-900/10 to-transparent",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3 text-blue-300",children:[(0,t.jsx)(ae.Sparkles,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Recommended for Class"})]}),(0,t.jsx)("div",{className:"space-y-1",children:w.map(a=>H(a))})]}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3 text-gray-500",children:[(0,t.jsx)(cd,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider",children:"All Library"})]}),m?A&&A.length>0?(0,t.jsx)("div",{className:"space-y-1",children:A.map(a=>H(a,0))}):(0,t.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,t.jsx)(R.Search,{className:"h-12 w-12 mx-auto mb-3 opacity-20"}),(0,t.jsx)("p",{children:"No assets found"})]}):(0,t.jsx)("div",{className:"space-y-1",children:x.length>0?x.map(a=>(0,t.jsx)("div",{className:"group",children:H(a,0)},a.id)):(0,t.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,t.jsx)(cd,{className:"h-12 w-12 mx-auto mb-3 opacity-20"}),(0,t.jsx)("p",{children:"No assets yet"}),(0,t.jsx)(y.Button,{variant:"link",onClick:()=>C("subject"),children:"Create Subject"})]})})]})]})}),(0,t.jsx)(cc,{className:"w-1 bg-white/5 hover:bg-blue-500/50 transition-colors cursor-col-resize active:bg-blue-600"}),o&&(0,t.jsx)(ca,{defaultSize:40,minSize:20,children:(0,t.jsxs)("div",{className:"h-full flex flex-col bg-black/20 backdrop-blur-md border-l border-white/5",children:[(0,t.jsxs)(I.ScrollArea,{className:"flex-1 p-5",children:[(0,t.jsxs)("div",{className:"flex items-start gap-4 mb-6",children:[(0,t.jsx)("div",{className:`p-3 rounded-xl shadow-lg ${co[o.type]}`,children:(0,t.jsx)(F,{type:o.type})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0 pt-1",children:[(0,t.jsx)("h3",{className:"font-bold text-lg leading-tight truncate text-white",children:o.name}),(0,t.jsx)("p",{className:"text-xs text-blue-300/80 mt-1 uppercase tracking-wide font-medium",children:cp[o.type]})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[o.description&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Description"}),(0,t.jsx)("p",{className:"text-sm text-gray-300 leading-relaxed bg-white/5 p-3 rounded-lg border border-white/5",children:o.description})]}),o.metadata&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[o.metadata.taskType&&(0,t.jsxs)("div",{className:"bg-white/5 p-2 rounded border border-white/5",children:[(0,t.jsx)("span",{className:"block text-[10px] text-gray-500 uppercase",children:"Type"}),(0,t.jsx)("span",{className:"text-sm capitalize",children:o.metadata.taskType.replace("_"," ")})]}),o.metadata.difficulty&&(0,t.jsxs)("div",{className:"bg-white/5 p-2 rounded border border-white/5",children:[(0,t.jsx)("span",{className:"block text-[10px] text-gray-500 uppercase",children:"Difficulty"}),(0,t.jsx)("span",{className:`text-sm capitalize font-medium ${"hard"===o.metadata.difficulty?"text-red-400":"intermediate"===o.metadata.difficulty?"text-yellow-400":"text-green-400"}`,children:o.metadata.difficulty})]}),o.metadata.duration&&(0,t.jsxs)("div",{className:"bg-white/5 p-2 rounded border border-white/5",children:[(0,t.jsx)("span",{className:"block text-[10px] text-gray-500 uppercase",children:"Duration"}),(0,t.jsxs)("span",{className:"text-sm",children:[o.metadata.duration," min"]})]}),o.metadata.topic&&(0,t.jsxs)("div",{className:"bg-white/5 p-2 rounded border border-white/5",children:[(0,t.jsx)("span",{className:"block text-[10px] text-gray-500 uppercase",children:"Topic"}),(0,t.jsx)("span",{className:"text-sm capitalize",children:o.metadata.topic})]})]})]}),o.content&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:"Preview"}),(0,t.jsx)("div",{className:"bg-black/40 p-4 rounded-lg text-sm font-mono text-gray-300 max-h-60 overflow-y-auto border border-white/10 shadow-inner",children:o.content})]})]})]}),(0,t.jsxs)("div",{className:"p-4 border-t border-white/10 bg-black/20 backdrop-blur-sm space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between text-[10px] text-gray-500 font-medium uppercase tracking-wider",children:[(0,t.jsxs)("span",{children:["Created ",o.createdAt.toLocaleDateString()]}),(0,t.jsxs)("span",{children:["Updated ",o.updatedAt.toLocaleDateString()]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(y.Button,{variant:"outline",className:"flex-1 border-white/10 hover:bg-white/5 text-gray-300",children:[(0,t.jsx)(ck.Edit,{className:"h-4 w-4 mr-2"})," Edit"]}),(0,t.jsxs)(y.Button,{className:"flex-1 bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-900/20",children:[(0,t.jsx)(aS.Zap,{className:"h-4 w-4 mr-2"})," Open"]})]})]})]})})]}),(0,t.jsxs)("div",{className:"p-2 border-t border-white/10 bg-black/30 backdrop-blur-sm shrink-0 flex justify-between items-center text-[10px] text-gray-500 uppercase tracking-wider font-medium px-4",children:[(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)("span",{children:[i.filter(a=>"subject"===a.type).length," Subjects"]}),(0,t.jsxs)("span",{children:[i.filter(a=>"lesson"===a.type).length," Lessons"]}),(0,t.jsxs)("span",{children:[i.filter(a=>"task"===a.type).length," Tasks"]})]}),(0,t.jsxs)("span",{children:[i.length," Assets"]})]}),f&&(0,t.jsxs)("div",{className:"p-4 border-t border-white/10 bg-black/40 backdrop-blur-sm flex justify-between items-center",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-400",children:[s.size," selected"]}),(0,t.jsxs)(y.Button,{onClick:()=>{let a=i.filter(a=>s.has(a.id));g?.(a)},disabled:0===s.size,size:"sm",className:"bg-purple-600 hover:bg-purple-500",children:["Select ",s.size>0?`(${s.size})`:""]})]})]})}let cs=new Map,ct=new Map,cu=new Map,cv=new Map,cw="student-1";cs.set(cw,{id:cw,name:"Sarah Chen",age:16,level:"B1",learningStyle:"visual",interests:["music","technology","travel"],goals:["improve_pronunciation","vocabulary_expansion"],preferredVoice:{gender:"female",accent:"us"}}),ct.set(cw,{currentMood:"neutral",energyLevel:80,recentStruggles:[],masteredTopics:["present_perfect","basic_greetings"],activeTopics:["conditionals","phrasal_verbs"]}),cu.set(cw,[]);class cx{static async getStudentContext(a){let b=cs.get(a);return b?{profile:b,state:ct.get(a)||this.getInitialState(),signals:(cu.get(a)||[]).filter(a=>!a.expiresAt||a.expiresAt>Date.now())}:null}static appendTranscript(a,b){let c=cv.get(a)||[];cv.set(a,[...c,b])}static getTranscript(a){return cv.get(a)||[]}static async recordSignal(a,b){let c={...b,id:Math.random().toString(36).substring(7),timestamp:Date.now()},d=cu.get(a)||[];cu.set(a,[...d,c]),"struggle_detected"===b.type&&await this.updateState(a,a=>(a.recentStruggles.push({topic:b.context?.topic||"unknown",errorType:b.context?.errorType||"general",severity:b.context?.severity||5,detectedAt:Date.now()}),a.recentStruggles.length>5&&a.recentStruggles.shift(),a))}static async updateState(a,b){let c=b({...ct.get(a)||this.getInitialState()});ct.set(a,c)}static getInitialState(){return{currentMood:"neutral",energyLevel:100,recentStruggles:[],masteredTopics:[],activeTopics:[]}}static async processClassSummary(a,b){await this.recordSignal(a,{source:"classroom_ta",type:"topic_requested",content:`Completed class on ${b.topic}. Status: ${b.status}`,context:b}),await this.updateState(a,a=>(b.struggles&&Array.isArray(b.struggles)&&b.struggles.forEach(b=>{a.recentStruggles.push({topic:b,errorType:"general",severity:7,detectedAt:Date.now()})}),b.topic&&!a.activeTopics.includes(b.topic)&&a.activeTopics.push(b.topic),a))}static async recordQuizResult(a,b){let c=b.score/b.maxScore;await this.recordSignal(a,{source:"personal_tutor",type:c>=.7?"mastery_achieved":"struggle_detected",content:`Quiz on ${b.topic}: ${b.score}/${b.maxScore} (${Math.round(100*c)}%)`,context:b}),await this.updateState(a,a=>(c<.7?(!a.recentStruggles.find(a=>a.topic===b.topic)&&(a.recentStruggles.push({topic:b.topic,errorType:"general",severity:Math.round((1-c)*10),detectedAt:Date.now()}),a.recentStruggles.length>10&&a.recentStruggles.shift()),a.activeTopics.includes(b.topic)||a.activeTopics.push(b.topic)):c>=.85&&(a.masteredTopics.includes(b.topic)||a.masteredTopics.push(b.topic),a.recentStruggles=a.recentStruggles.filter(a=>a.topic!==b.topic)),a))}}let cy=[{id:"math-algebra",name:"Math: Algebra Practice",subject:"Mathematics",topics:"Algebra, Linear Equations, Solving for Variables",difficulty:"intermediate",count:5,icon:"ðŸ“"},{id:"science-forces",name:"Science: Forces & Motion",subject:"Physics",topics:"Newton's Laws, Force, Acceleration, Friction",difficulty:"intermediate",count:8,icon:"âš›ï¸"},{id:"reading-comp",name:"Reading Comprehension",subject:"English",topics:"Main Idea, Inference, Context Clues",difficulty:"beginner",count:6,icon:"ðŸ“š"},{id:"math-geometry",name:"Geometry Basics",subject:"Mathematics",topics:"Area, Perimeter, Circles, Triangles",difficulty:"beginner",count:7,icon:"ðŸ“"}];function cz({roomId:a,students:b}){let[c,d]=(0,v.useState)("generate"),[e,f]=(0,v.useState)(!1),[g,h]=(0,v.useState)(null),[i,j]=(0,v.useState)(new Set),[k,l]=(0,v.useState)(!1),[m,n]=(0,v.useState)(!1),[o,p]=(0,v.useState)(0),[q,r]=(0,v.useState)([]),[s,u]=(0,v.useState)(null),[w,x]=(0,v.useState)("lesson_transcript"),[C,D]=(0,v.useState)(!1),[H,J]=(0,v.useState)([]),[L,M]=(0,v.useState)("practice"),[N,O]=(0,v.useState)({title:"",timeLimit:30,passingScore:70,shuffle:!0}),[P,Q]=(0,v.useState)([]),[S,T]=(0,v.useState)("grid"),[U,W]=(0,v.useState)(!1),[Z,$]=(0,v.useState)(""),[aa,ab]=(0,v.useState)(!1),[ac,af]=(0,v.useState)({tasks:[],version:1}),[ah,ai]=(0,v.useState)({subject:"",topics:"",difficulty:"intermediate",count:5,distributionMode:"personalized",questionType:"mixed"});(0,v.useEffect)(()=>{try{let a=localStorage.getItem("coursedev-preferences");if(a){let b=JSON.parse(a);b.recentSubject&&ai(a=>({...a,subject:b.recentSubject,topics:b.recentTopics||"",difficulty:b.preferredDifficulty||"intermediate"}))}}catch(a){console.error("Failed to load preferences:",a)}},[]);let aj=()=>{try{localStorage.setItem("coursedev-preferences",JSON.stringify({recentSubject:ah.subject,recentTopics:ah.topics,preferredDifficulty:ah.difficulty,lastUsed:new Date().toISOString()}))}catch(a){console.error("Failed to save preferences:",a)}},ak=async()=>{if(!ah.subject||!ah.topics)return void E.toast.error("Please fill in subject and topics");if("uploaded_documents"===w&&0===H.length)return void E.toast.error("Please select materials",{description:'Click "Browse & Select Materials" to choose documents'});f(!0),aj();let b="";if("lesson_transcript"===w){b=`Generate tasks based on today's classroom lesson about ${ah.subject}. Focus on the key concepts covered: ${ah.topics}. `;let c=cx.getTranscript(a);if(c.length>0){let a=c.map(a=>`${a.speaker}: ${a.text}`).join("\n");b+=`
LATEST TRANSCRIPT:
${a}
`}else b+=`
(No active transcript found for this session yet)
`;b+="Use the lesson content as the primary source. "}else if("uploaded_documents"===w)b=`Generate tasks based on the following uploaded materials:
`,H.forEach(a=>{b+=`
--- Document: ${a.name} ---
`,b+=a.content||a.description||"(No text content available)",b+=`
----------------
`}),b+=`
Subject: ${ah.subject}. Topics to cover: ${ah.topics}. `,b+="Use only the content from these documents. ";else if("all_sources"===w){b=`Generate comprehensive tasks for ${ah.subject} covering ${ah.topics}. `;let c=cx.getTranscript(a);if(c.length>0){let a=c.map(a=>`${a.speaker}: ${a.text}`).join("\n");b+=`
LATEST TRANSCRIPT:
${a}
`}H.length>0&&(b+=`
REFERENCE MATERIALS:
`,H.forEach(a=>{b+=`${a.name}: ${a.content||a.description||"No content"}
`})),b+="Use lesson content, provided materials, and your general knowledge. "}setTimeout(()=>{let a=Array.from({length:ah.count},(a,c)=>{let d=ah.questionType;return"mixed"===d&&(d=c%2==0?"multiple_choice":"short_answer"),{id:`task-${Date.now()}-${c}`,type:"multiple_choice"===d?"multiple_choice":"short_answer",question:`${"lesson_transcript"===w?"[From Lesson]":"uploaded_documents"===w?"[From Docs]":"[All Sources]"} Sample ${ah.subject} question ${c+1} (${d}) about ${ah.topics.split(",")[0]?.trim()||"topic"}`,options:"multiple_choice"===d?["Option A","Option B","Option C","Option D"]:void 0,correctAnswer:"multiple_choice"===d?"Option A":void 0,explanation:`This tests understanding of core concepts. ${b.substring(0,100)}...`,difficulty:ah.difficulty}});Q(a),d("review"),f(!1);let c="lesson_transcript"===w?"lesson transcript":"uploaded_documents"===w?`${H.length} document(s)`:"all sources";E.toast.success(`Generated ${a.length} tasks from ${c}`)},1500)},al=async a=>{ah.subject&&ah.topics?(f(!0),aj(),setTimeout(()=>{let c=ah.count,d="all"===a?b:b.filter(a=>"struggling"===a.status);E.toast.success(`âœ… Generated ${c} tasks and assigned to ${d.length} student${1!==d.length?"s":""}!`,{description:"struggling"===a?"Helping struggling students":"Assigned to all students",duration:4e3}),f(!1)},1500)):E.toast.error("Please fill in subject and topics first")},am=async a=>{(0,v.startTransition)(async()=>{try{let b=await a$({...a,subject:ah.subject,topics:ah.topics.split(",").map(a=>a.trim())});af(a=>({...a,tasks:[...a.tasks,b]})),E.toast.success("Task saved to library")}catch(a){E.toast.error("Failed to save task")}})},an=async a=>{let b={...a,id:`task-${Date.now()}`};Q(a=>[...a,b]),(0,v.startTransition)(async()=>{await a1(a.id),af(b=>({...b,tasks:b.tasks.map(b=>b.id===a.id?{...b,usedCount:b.usedCount+1,lastUsed:new Date().toISOString()}:b)}))}),E.toast.success("Task added from library")},ao=async a=>{af(b=>({...b,tasks:b.tasks.map(b=>b.id===a?{...b,isFavorite:!b.isFavorite}:b)})),(0,v.startTransition)(async()=>{try{await a_(a)}catch(b){af(b=>({...b,tasks:b.tasks.map(b=>b.id===a?{...b,isFavorite:!b.isFavorite}:b)})),E.toast.error("Failed to update favorite")}})},ap=async a=>{af(b=>({...b,tasks:b.tasks.filter(b=>b.id!==a)})),(0,v.startTransition)(async()=>{try{await a0(a),E.toast.success("Task removed from library")}catch(a){af(ac),E.toast.error("Failed to delete task")}})},ar=()=>{let a=ac.tasks;if(aa&&(a=a.filter(a=>a.isFavorite)),Z){let b=Z.toLowerCase();a=a.filter(a=>a.question.toLowerCase().includes(b)||a.subject.toLowerCase().includes(b)||a.topics.some(a=>a.toLowerCase().includes(b)))}return a.sort((a,b)=>a.isFavorite!==b.isFavorite?a.isFavorite?-1:1:b.usedCount-a.usedCount)},at=async a=>{n(!0),p(0);let b=setInterval(()=>{p(a=>a>=90?(clearInterval(b),90):a+10)},200);await new Promise(a=>setTimeout(a,2e3)),clearInterval(b),p(100);let c=[{id:`imported-${Date.now()}-1`,question:"What is the primary function of the mitochondria?",type:"multiple_choice",options:["Energy production","Protein synthesis","Waste disposal","Cell division"],correctAnswer:"Energy production",subject:"Biology",topics:["Cell Biology"],difficulty:"intermediate"},{id:`imported-${Date.now()}-2`,question:"Describe the process of osmosis.",type:"short_answer",subject:"Biology",topics:["Cell Biology"],difficulty:"intermediate"},{id:`imported-${Date.now()}-3`,question:"Which organelle is known as the 'brain' of the cell?",type:"multiple_choice",options:["Nucleus","Ribosome","Golgi apparatus","Endoplasmic reticulum"],correctAnswer:"Nucleus",subject:"Biology",topics:["Cell Biology"],difficulty:"beginner"}];r(c),n(!1),E.toast.success("Analysis Complete",{description:`Extracted ${c.length} questions from ${a.name}`})},au={total:b.length,onTrack:b.filter(a=>"on_track"===a.status).length,needHelp:b.filter(a=>"needs_help"===a.status).length,struggling:b.filter(a=>"struggling"===a.status).length};return(0,t.jsxs)("div",{className:"h-full flex flex-col bg-gray-900 text-white",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-700 bg-gray-800",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("button",{onClick:()=>d("generate"),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${"generate"===c?"bg-blue-600 text-white":"text-gray-400 hover:text-white"}`,children:[(0,t.jsx)("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-sm ${"generate"===c?"bg-white text-blue-600":"bg-gray-700"}`,children:"1"}),(0,t.jsx)("span",{className:"font-medium",children:"Configure"})]}),(0,t.jsx)("div",{className:"w-8 h-px bg-gray-700"}),(0,t.jsxs)("button",{onClick:()=>P.length>0&&d("review"),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${"review"===c?"bg-blue-600 text-white":P.length>0?"text-gray-400 hover:text-white":"text-gray-600 cursor-not-allowed"}`,children:[(0,t.jsx)("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-sm ${"review"===c?"bg-white text-blue-600":P.length>0?"bg-gray-700":"bg-gray-800"}`,children:"2"}),(0,t.jsx)("span",{className:"font-medium",children:"Review"}),P.length>0&&(0,t.jsx)(z.Badge,{className:"bg-blue-500",children:P.length})]}),(0,t.jsx)("div",{className:"w-8 h-px bg-gray-700"}),(0,t.jsxs)("button",{onClick:()=>P.length>0&&d("assign"),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${"assign"===c?"bg-blue-600 text-white":P.length>0?"text-gray-400 hover:text-white":"text-gray-600 cursor-not-allowed"}`,children:[(0,t.jsx)("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-sm ${"assign"===c?"bg-white text-blue-600":P.length>0?"bg-gray-700":"bg-gray-800"}`,children:"3"}),(0,t.jsx)("span",{className:"font-medium",children:"Assign"})]})]})}),(0,t.jsxs)("div",{className:"flex-1 overflow-hidden",children:["generate"===c&&(0,t.jsxs)("div",{className:"h-full flex",children:[(0,t.jsx)("div",{className:"flex-1 p-6 overflow-auto",children:(0,t.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Task Configuration"}),(0,t.jsx)("p",{className:"text-gray-400",children:"Configure AI to generate personalized learning tasks"})]}),(0,t.jsxs)(F.Card,{className:"bg-gradient-to-br from-blue-900/30 to-purple-900/30 border-blue-700",children:[(0,t.jsxs)(F.CardHeader,{children:[(0,t.jsxs)(F.CardTitle,{className:"text-white text-base flex items-center gap-2",children:[(0,t.jsx)(ae.Sparkles,{className:"h-5 w-5 text-yellow-400"}),"Quick Start Templates"]}),(0,t.jsx)(F.CardDescription,{className:"text-gray-300",children:"Load pre-configured templates to get started instantly"})]}),(0,t.jsx)(F.CardContent,{children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[cy.map(a=>(0,t.jsx)("button",{onClick:()=>{ai(b=>({...b,subject:a.subject,topics:a.topics,difficulty:a.difficulty,count:a.count,distributionMode:"personalized"})),E.toast.success(`Loaded template: ${a.name}`)},className:"p-4 rounded-lg border-2 border-gray-600 bg-gray-800 hover:border-blue-500 hover:bg-gray-700 transition-all text-left group",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)("span",{className:"text-2xl",children:a.icon}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-semibold text-sm group-hover:text-blue-400 transition-colors",children:a.name}),(0,t.jsxs)("div",{className:"text-xs text-gray-400",children:[a.count," tasks â€¢ ",a.difficulty]})]})]})},a.id)),(0,t.jsxs)("button",{onClick:()=>D(!0),className:"p-4 rounded-lg border-2 border-dashed border-gray-600 bg-gray-800/50 hover:border-purple-500 hover:bg-gray-800 transition-all text-left group flex flex-col justify-center items-center gap-2",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-full bg-purple-900/30 flex items-center justify-center group-hover:scale-110 transition-transform",children:(0,t.jsx)(bf.Library,{className:"h-6 w-6 text-purple-400"})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"font-semibold text-sm group-hover:text-purple-400 transition-colors",children:"Browse & Select Materials"}),(0,t.jsx)("div",{className:"text-xs text-gray-400",children:"From Assets Panel"})]})]})]})})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,t.jsx)("div",{className:"w-full border-t border-gray-700"})}),(0,t.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,t.jsx)("span",{className:"px-4 bg-gray-900 text-gray-400",children:"OR BUILD CUSTOM"})})]}),(0,t.jsxs)(F.Card,{className:"bg-gradient-to-br from-purple-900/20 to-blue-900/20 border-purple-700/50",children:[(0,t.jsxs)(F.CardHeader,{children:[(0,t.jsxs)(F.CardTitle,{className:"text-white text-base flex items-center gap-2",children:[(0,t.jsx)(_.Target,{className:"h-5 w-5 text-purple-400"}),"AI Source Selection"]}),(0,t.jsx)(F.CardDescription,{className:"text-gray-300",children:"Choose where AI should generate tasks from"})]}),(0,t.jsxs)(F.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("button",{onClick:()=>x("lesson_transcript"),className:`w-full p-4 rounded-lg border-2 transition-all text-left ${"lesson_transcript"===w?"border-purple-500 bg-purple-900/30":"border-gray-600 bg-gray-800 hover:border-gray-500"}`,children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${"lesson_transcript"===w?"border-purple-500":"border-gray-500"}`,children:"lesson_transcript"===w&&(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-purple-500"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-semibold text-white",children:"Lesson Transcript"}),(0,t.jsx)("div",{className:"text-sm text-gray-400",children:"Generate from today's classroom session"})]})]})}),(0,t.jsx)("button",{onClick:()=>x("uploaded_documents"),className:`w-full p-4 rounded-lg border-2 transition-all text-left ${"uploaded_documents"===w?"border-purple-500 bg-purple-900/30":"border-gray-600 bg-gray-800 hover:border-gray-500"}`,children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${"uploaded_documents"===w?"border-purple-500":"border-gray-500"}`,children:"uploaded_documents"===w&&(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-purple-500"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-semibold text-white",children:"Uploaded Documents"}),(0,t.jsxs)("div",{className:"text-sm text-gray-400",children:["Generate from selected materials",H.length>0&&` (${H.length} selected)`]})]})]})}),(0,t.jsx)("button",{onClick:()=>x("all_sources"),className:`w-full p-4 rounded-lg border-2 transition-all text-left ${"all_sources"===w?"border-purple-500 bg-purple-900/30":"border-gray-600 bg-gray-800 hover:border-gray-500"}`,children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${"all_sources"===w?"border-purple-500":"border-gray-500"}`,children:"all_sources"===w&&(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-purple-500"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-semibold text-white",children:"All Sources"}),(0,t.jsx)("div",{className:"text-sm text-gray-400",children:"Lesson + Documents + General Knowledge"})]})]})})]}),H.length>0&&(0,t.jsxs)("div",{className:"mt-4 p-3 bg-gray-800/50 rounded-lg border border-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(bi.FileText,{className:"h-4 w-4 text-purple-400"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Selected Materials:"})]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:H.map((a,b)=>(0,t.jsx)(z.Badge,{variant:"outline",className:"bg-purple-900/30 text-purple-300 border-purple-700",children:a.name||`Asset ${b+1}`},b))})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,t.jsxs)(F.Card,{className:"bg-gray-800 border-gray-700",children:[(0,t.jsx)(F.CardHeader,{children:(0,t.jsxs)(F.CardTitle,{className:"text-white text-base flex items-center gap-2",children:[(0,t.jsx)(a7.BookOpen,{className:"h-4 w-4 text-blue-400"}),"Subject & Topics"]})}),(0,t.jsxs)(F.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a2.Label,{className:"text-gray-300",children:"Subject"}),(0,t.jsx)(G.Input,{placeholder:"e.g., Mathematics",value:ah.subject,onChange:a=>ai({...ah,subject:a.target.value}),className:"bg-gray-700 border-gray-600 text-white"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a2.Label,{className:"text-gray-300",children:"Topics"}),(0,t.jsx)(a3.Textarea,{placeholder:"e.g., Algebra, Linear Equations, Quadratic Functions",value:ah.topics,onChange:a=>ai({...ah,topics:a.target.value}),className:"bg-gray-700 border-gray-600 text-white min-h-[100px]"})]})]})]}),(0,t.jsxs)(F.Card,{className:"bg-gray-800 border-gray-700",children:[(0,t.jsx)(F.CardHeader,{children:(0,t.jsxs)(F.CardTitle,{className:"text-white text-base flex items-center gap-2",children:[(0,t.jsx)(aq.BarChart3,{className:"h-4 w-4 text-green-400"}),"Settings"]})}),(0,t.jsxs)(F.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(a2.Label,{className:"text-gray-300",children:"Difficulty"}),(0,t.jsxs)(y.Button,{variant:"ghost",size:"sm",onClick:()=>{let a=b.length;if(0===a)return;let c=b.filter(a=>"struggling"===a.status).length,d=b.filter(a=>"on_track"===a.status).length,e="intermediate",f="";c/a>.3?(e="beginner",f=`Detected ${Math.round(c/a*100)}% struggling students. Suggesting Beginner difficulty.`):d/a>.6?(e="advanced",f=`Detected ${Math.round(d/a*100)}% on-track students. Suggesting Advanced difficulty.`):(e="intermediate",f="Class performance is balanced. Suggesting Intermediate difficulty."),ai(a=>({...a,difficulty:e})),E.toast.success("Difficulty Adjusted",{description:f})},className:"h-6 text-xs text-blue-400 hover:text-blue-300 px-2",children:[(0,t.jsx)(ae.Sparkles,{className:"h-3 w-3 mr-1"}),"Auto-detect"]})]}),(0,t.jsxs)(X.Select,{value:ah.difficulty,onValueChange:a=>ai({...ah,difficulty:a}),children:[(0,t.jsx)(X.SelectTrigger,{className:"bg-gray-700 border-gray-600 text-white",children:(0,t.jsx)(X.SelectValue,{})}),(0,t.jsxs)(X.SelectContent,{children:[(0,t.jsx)(X.SelectItem,{value:"beginner",children:"Beginner"}),(0,t.jsx)(X.SelectItem,{value:"intermediate",children:"Intermediate"}),(0,t.jsx)(X.SelectItem,{value:"advanced",children:"Advanced"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a2.Label,{className:"text-gray-300",children:"Distribution Mode"}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-2",children:[{key:"uniform",label:"Same for all students"},{key:"personalized",label:"Personalized to each student"},{key:"clustered",label:"By performance cluster"}].map(({key:a,label:b})=>(0,t.jsx)("button",{onClick:()=>ai({...ah,distributionMode:a}),className:`p-3 rounded-lg border text-left transition-colors ${ah.distributionMode===a?"border-blue-500 bg-blue-500/20":"border-gray-600 bg-gray-700 hover:bg-gray-600"}`,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[ah.distributionMode===a&&(0,t.jsx)(ad.CheckCircle,{className:"h-4 w-4 text-blue-400"}),(0,t.jsx)("span",{className:"text-sm",children:b})]})},a))})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(a2.Label,{className:"text-gray-300",children:["Number of Tasks: ",ah.count]}),(0,t.jsx)("input",{type:"range",min:1,max:20,value:ah.count,onChange:a=>ai({...ah,count:parseInt(a.target.value)}),className:"w-full"})]})]})]})]}),(ah.subject||ah.topics)&&(0,t.jsxs)(F.Card,{className:"bg-gray-800 border-blue-600 border-2",children:[(0,t.jsxs)(F.CardHeader,{children:[(0,t.jsxs)(F.CardTitle,{className:"text-white text-sm flex items-center gap-2",children:[(0,t.jsx)(bc.Eye,{className:"h-4 w-4 text-blue-400"}),"Live Preview"]}),(0,t.jsx)(F.CardDescription,{className:"text-gray-400 text-xs",children:"Sample question based on your configuration"})]}),(0,t.jsx)(F.CardContent,{children:(0,t.jsxs)("div",{className:"bg-gray-700 p-4 rounded-lg",children:[(0,t.jsx)("p",{className:"text-sm text-gray-300 mb-3",children:(()=>{if(!ah.subject||!ah.topics)return null;let a=ah.topics.split(",")[0]?.trim()||"topic";return`Solve for x: 2x + 5 = 13 (${a})`})()}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("div",{className:"text-xs px-3 py-2 rounded bg-gray-600 text-gray-300",children:"A. x = 3"}),(0,t.jsx)("div",{className:"text-xs px-3 py-2 rounded bg-green-900/50 border border-green-700 text-green-300",children:"B. x = 4 âœ“"}),(0,t.jsx)("div",{className:"text-xs px-3 py-2 rounded bg-gray-600 text-gray-300",children:"C. x = 8"}),(0,t.jsx)("div",{className:"text-xs px-3 py-2 rounded bg-gray-600 text-gray-300",children:"D. x = 9"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-3",children:"ðŸ’¡ This is a sample. Actual questions will vary."})]})})]}),(0,t.jsx)(y.Button,{onClick:ak,disabled:e||!ah.subject||!ah.topics,className:"w-full h-12 text-lg bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a4.Loader2,{className:"h-5 w-5 mr-2 animate-spin"}),"Generating Tasks..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ae.Sparkles,{className:"h-5 w-5 mr-2"}),"Generate ",ah.count," Tasks"]})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)(y.Button,{variant:"outline",onClick:()=>al("all"),disabled:e||!ah.subject||!ah.topics,className:"h-10 border-blue-600 text-blue-400 hover:bg-blue-600/20",children:[(0,t.jsx)(aS.Zap,{className:"h-4 w-4 mr-2"}),"Quick Assign to All"]}),(0,t.jsxs)(y.Button,{variant:"outline",onClick:()=>al("struggling"),disabled:e||!ah.subject||!ah.topics||0===au.struggling,className:"h-10 border-red-600 text-red-400 hover:bg-red-600/20",children:[(0,t.jsx)(ba.Heart,{className:"h-4 w-4 mr-2"}),"Help Struggling ",au.struggling>0&&`(${au.struggling})`]})]}),(0,t.jsx)("p",{className:"text-xs text-center text-gray-500",children:"âš¡ Quick Assign skips review and assigns tasks immediately"})]})]})}),(0,t.jsxs)("div",{className:"w-72 border-l border-gray-700 bg-gray-800 p-6",children:[(0,t.jsxs)("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[(0,t.jsx)(K.Users,{className:"h-4 w-4"}),"Students (",au.total,")"]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-900/30 rounded-lg",children:[(0,t.jsx)("span",{className:"text-green-400",children:"On Track"}),(0,t.jsx)("span",{className:"font-bold text-green-400",children:au.onTrack})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-yellow-900/30 rounded-lg",children:[(0,t.jsx)("span",{className:"text-yellow-400",children:"Need Help"}),(0,t.jsx)("span",{className:"font-bold text-yellow-400",children:au.needHelp})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-red-900/30 rounded-lg",children:[(0,t.jsx)("span",{className:"text-red-400",children:"Struggling"}),(0,t.jsx)("span",{className:"font-bold text-red-400",children:au.struggling})]})]})]})]}),"review"===c&&(0,t.jsxs)("div",{className:"h-full flex flex-col",children:[(0,t.jsxs)("div",{className:"px-6 py-3 border-b border-gray-700 bg-gray-800 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>{i.size===P.length?j(new Set):j(new Set(P.map(a=>a.id)))},className:"p-1 hover:bg-gray-700 rounded",children:i.size===P.length?(0,t.jsx)(be,{className:"h-4 w-4 text-blue-400"}):(0,t.jsx)(as.Square,{className:"h-4 w-4 text-gray-400"})}),(0,t.jsx)("h3",{className:"font-semibold",children:i.size>0?(0,t.jsxs)("span",{children:[i.size," of ",P.length," Selected"]}):(0,t.jsxs)("span",{children:[P.length," Tasks Generated"]})})]}),i.size>0&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(y.Button,{variant:"outline",size:"sm",onClick:()=>{Q(a=>a.filter(a=>!i.has(a.id))),E.toast.success(`Deleted ${i.size} tasks`),j(new Set)},className:"h-8 border-red-600 text-red-400",children:[(0,t.jsx)(a5.Trash2,{className:"h-3 w-3 mr-1"}),"Delete"]}),(0,t.jsxs)(X.Select,{onValueChange:a=>{Q(b=>b.map(b=>i.has(b.id)?{...b,difficulty:a}:b)),E.toast.success(`Updated ${i.size} tasks to ${a}`),j(new Set)},children:[(0,t.jsx)(X.SelectTrigger,{className:"h-8 w-32 bg-gray-700",children:(0,t.jsx)(X.SelectValue,{placeholder:"Difficulty"})}),(0,t.jsxs)(X.SelectContent,{children:[(0,t.jsx)(X.SelectItem,{value:"beginner",children:"Set Easy"}),(0,t.jsx)(X.SelectItem,{value:"intermediate",children:"Set Medium"}),(0,t.jsx)(X.SelectItem,{value:"advanced",children:"Set Hard"})]})]})]}),(0,t.jsxs)(y.Button,{variant:"outline",size:"sm",onClick:()=>W(!0),className:"h-8 border-blue-500 text-blue-400 bg-blue-500/10 hover:bg-blue-500/20",children:[(0,t.jsx)(bf.Library,{className:"h-4 w-4 mr-2"}),"Library"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-gray-700 rounded-lg p-1",children:[(0,t.jsx)("button",{onClick:()=>T("grid"),className:`p-1.5 rounded ${"grid"===S?"bg-gray-600":""}`,children:(0,t.jsx)(V.LayoutGrid,{className:"h-4 w-4"})}),(0,t.jsx)("button",{onClick:()=>T("list"),className:`p-1.5 rounded ${"list"===S?"bg-gray-600":""}`,children:(0,t.jsx)(a9.List,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(y.Button,{variant:"outline",onClick:()=>d("generate"),children:"Back"}),(0,t.jsxs)(y.Button,{onClick:()=>d("assign"),children:["Continue to Assign",(0,t.jsx)(aC.Send,{className:"h-4 w-4 ml-2"})]})]})]}),(0,t.jsx)(I.ScrollArea,{className:"flex-1 p-6",children:(0,t.jsx)("div",{className:"grid"===S?"grid grid-cols-2 lg:grid-cols-3 gap-4":"space-y-3",children:P.map((a,b)=>(0,t.jsxs)(F.Card,{className:"bg-gray-800 border-gray-700",children:[(0,t.jsx)(F.CardHeader,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsx)("button",{onClick:()=>{let b=new Set(i);b.has(a.id)?b.delete(a.id):b.add(a.id),j(b)},className:"mr-3 mt-1",children:i.has(a.id)?(0,t.jsx)(be,{className:"h-5 w-5 text-blue-400"}):(0,t.jsx)(as.Square,{className:"h-5 w-5 text-gray-500"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(z.Badge,{className:"mb-2",variant:"multiple_choice"===a.type?"default":"secondary",children:"multiple_choice"===a.type?"Multiple Choice":"Short Answer"}),(0,t.jsxs)(F.CardTitle,{className:"text-white text-sm",children:["Task ",b+1]})]}),(0,t.jsxs)("div",{className:"flex gap-1 shrink-0",children:[(0,t.jsx)(y.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-yellow-500 hover:text-yellow-400 hover:bg-yellow-500/10",onClick:()=>am(a),title:"Save to Library",children:(0,t.jsx)(bb.Star,{className:"h-4 w-4"})}),(0,t.jsx)(y.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>(a=>{let b=P.find(b=>b.id===a);if(b){let a={...b,id:`task-${Date.now()}`};Q(b=>[...b,a]),E.toast.success("Task duplicated")}})(a.id),title:"Duplicate",children:(0,t.jsx)(bd.Copy,{className:"h-4 w-4"})}),(0,t.jsx)(y.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-400",onClick:()=>{var b;return b=a.id,void(Q(a=>a.filter(a=>a.id!==b)),j(a=>{let c=new Set(a);return c.delete(b),c}),E.toast.success("Task deleted"))},title:"Delete",children:(0,t.jsx)(a5.Trash2,{className:"h-4 w-4"})})]})]})}),(0,t.jsxs)(F.CardContent,{className:"space-y-3",children:[g===a.id?(0,t.jsx)(G.Input,{value:a.question,onChange:b=>{var c,d;return c=a.id,d={question:b.target.value},void Q(a=>a.map(a=>a.id===c?{...a,...d}:a))},onBlur:()=>h(null),autoFocus:!0,className:"bg-gray-700 border-blue-600 text-white"}):(0,t.jsx)("p",{className:"text-sm text-gray-300 cursor-pointer hover:text-blue-400 transition-colors",onClick:()=>h(a.id),title:"Click to edit",children:a.question}),a.options&&(0,t.jsx)("div",{className:"space-y-1",children:a.options.map((b,c)=>(0,t.jsxs)("div",{className:`text-sm px-3 py-1.5 rounded ${b===a.correctAnswer?"bg-green-900/50 text-green-300 border border-green-700":"bg-gray-700 text-gray-400"}`,children:[String.fromCharCode(65+c),". ",b]},c))})]})]},a.id))})})]}),"assign"===c&&(0,t.jsxs)("div",{className:"h-full flex",children:[(0,t.jsx)("div",{className:"flex-1 p-6 overflow-auto",children:(0,t.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Assign Tasks"}),(0,t.jsx)("p",{className:"text-gray-400",children:"Choose how students will receive this content"})]}),(0,t.jsxs)(A.Tabs,{value:L,onValueChange:a=>M(a),className:"w-full",children:[(0,t.jsxs)(A.TabsList,{className:"grid w-full grid-cols-2 bg-gray-800",children:[(0,t.jsx)(A.TabsTrigger,{value:"practice",children:"Practice Assignment"}),(0,t.jsx)(A.TabsTrigger,{value:"exam",children:"Formal Assessment (Exam)"})]}),(0,t.jsx)(A.TabsContent,{value:"practice",className:"mt-6 space-y-6",children:(0,t.jsxs)("div",{className:"grid gap-4",children:[(0,t.jsx)(F.Card,{className:"bg-gray-800 border-gray-700 hover:border-blue-500 transition-colors cursor-pointer",children:(0,t.jsx)(F.CardContent,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-full bg-blue-600 flex items-center justify-center",children:(0,t.jsx)(a6.GraduationCap,{className:"h-6 w-6"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-lg",children:"All Students"}),(0,t.jsx)("p",{className:"text-gray-400",children:"Assign to everyone in the session"})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:au.total}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"students"})]})]})})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(F.Card,{className:"bg-gray-800 border-gray-700 hover:border-green-500 transition-colors cursor-pointer",children:(0,t.jsx)(F.CardContent,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-600 flex items-center justify-center",children:(0,t.jsx)(ad.CheckCircle,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold",children:"On Track"}),(0,t.jsxs)("p",{className:"text-sm text-gray-400",children:[au.onTrack," students"]})]})]})})}),(0,t.jsx)(F.Card,{className:"bg-gray-800 border-gray-700 hover:border-yellow-500 transition-colors cursor-pointer",children:(0,t.jsx)(F.CardContent,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-yellow-600 flex items-center justify-center",children:(0,t.jsx)(ag.Clock,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Need Help"}),(0,t.jsxs)("p",{className:"text-sm text-gray-400",children:[au.needHelp," students"]})]})]})})})]}),(0,t.jsx)(F.Card,{className:"bg-gray-800 border-gray-700 hover:border-red-500 transition-colors cursor-pointer",children:(0,t.jsx)(F.CardContent,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-red-600 flex items-center justify-center",children:(0,t.jsx)(a8.FileQuestion,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Struggling Students"}),(0,t.jsxs)("p",{className:"text-sm text-gray-400",children:[au.struggling," students need extra support"]})]})]})})})]})}),(0,t.jsxs)(A.TabsContent,{value:"exam",className:"mt-6 space-y-6",children:[(0,t.jsxs)(F.Card,{className:"bg-gray-800 border-gray-700",children:[(0,t.jsxs)(F.CardHeader,{children:[(0,t.jsxs)(F.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(_.Target,{className:"h-5 w-5 text-red-500"}),"Exam Configuration"]}),(0,t.jsx)(F.CardDescription,{children:"Configure settings for this formal assessment"})]}),(0,t.jsxs)(F.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a2.Label,{children:"Assessment Title"}),(0,t.jsx)(G.Input,{placeholder:"e.g., Unit 4 Mid-Term Exam",value:N.title,onChange:a=>O({...N,title:a.target.value}),className:"bg-gray-900 border-gray-600"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a2.Label,{children:"Time Limit (minutes)"}),(0,t.jsx)(G.Input,{type:"number",value:N.timeLimit,onChange:a=>O({...N,timeLimit:parseInt(a.target.value)}),className:"bg-gray-900 border-gray-600"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a2.Label,{children:"Passing Score (%)"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("input",{type:"range",min:"50",max:"100",step:"5",value:N.passingScore,onChange:a=>O({...N,passingScore:parseInt(a.target.value)}),className:"flex-1"}),(0,t.jsxs)("span",{className:"font-bold w-12 text-right",children:[N.passingScore,"%"]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 pt-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:N.shuffle,onChange:a=>O({...N,shuffle:a.target.checked}),id:"shuffle",className:"w-4 h-4 rounded border-gray-600 bg-gray-900 text-blue-600 focus:ring-blue-500"}),(0,t.jsx)(a2.Label,{htmlFor:"shuffle",className:"cursor-pointer",children:"Randomize question order for each student"})]})]})]}),(0,t.jsxs)("div",{className:"bg-blue-900/20 border border-blue-800 rounded-lg p-4 flex gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-blue-900/50 rounded h-fit",children:(0,t.jsx)(_.Target,{className:"h-5 w-5 text-blue-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-blue-300",children:"Exam Mode Active"}),(0,t.jsx)("p",{className:"text-sm text-blue-200/70 mt-1",children:"Students will see a timer and receive a grade upon completion. Answers will be hidden until the exam is closed."})]})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(y.Button,{variant:"outline",className:"flex-1",onClick:()=>d("review"),children:"Back"}),(0,t.jsx)(y.Button,{className:`flex-1 ${"exam"===L?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"}`,onClick:()=>{if("exam"===L&&!N.title)return void E.toast.error("Missing Title",{description:"Please provide a title for the exam"});let a="exam"===L?`Exam "${N.title}" Published!`:"Practice tasks assigned successfully!",b="exam"===L?`Time limit: ${N.timeLimit} mins â€¢ Passing: ${N.passingScore}%`:`Assigned to ${au.total} students`;E.toast.success(a,{description:b})},children:"exam"===L?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(_.Target,{className:"h-4 w-4 mr-2"}),"Publish Assessment"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(aC.Send,{className:"h-4 w-4 mr-2"}),"Assign Tasks"]})})]})]})}),(0,t.jsxs)("div",{className:"w-72 border-l border-gray-700 bg-gray-800 p-6",children:[(0,t.jsx)("h3",{className:"font-semibold mb-4",children:"Assignment Summary"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Tasks:"}),(0,t.jsx)("span",{className:"font-medium",children:P.length})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Subject:"}),(0,t.jsx)("span",{className:"font-medium",children:ah.subject||"Not set"})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Difficulty:"}),(0,t.jsx)("span",{className:"font-medium capitalize",children:ah.difficulty})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Mode:"}),(0,t.jsx)("span",{className:"font-medium capitalize",children:ah.distributionMode})]})]})]})]})]}),(0,t.jsx)(B.Dialog,{open:U,onOpenChange:W,children:(0,t.jsxs)(B.DialogContent,{className:"max-w-4xl h-[600px] bg-gray-900 text-white border-gray-700 flex flex-col",children:[(0,t.jsx)(B.DialogHeader,{children:(0,t.jsxs)(B.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(bf.Library,{className:"h-5 w-5 text-blue-400"}),"Task Library"]})}),(0,t.jsxs)("div",{className:"flex gap-4 py-4 border-b border-gray-800",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(R.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,t.jsx)(G.Input,{placeholder:"Search saved tasks...",value:Z,onChange:a=>$(a.target.value),className:"pl-9 bg-gray-800 border-gray-700 text-white focus:border-blue-500"})]}),(0,t.jsxs)(y.Button,{variant:aa?"default":"outline",onClick:()=>ab(!aa),className:aa?"bg-yellow-600 hover:bg-yellow-700":"border-gray-700",children:[(0,t.jsx)(bb.Star,{className:`h-4 w-4 mr-2 ${aa?"fill-current":""}`}),"Favorites"]})]}),(0,t.jsx)(I.ScrollArea,{className:"flex-1 -mx-6 px-6",children:(0,t.jsx)("div",{className:"grid gap-3 py-4",children:0===ar().length?(0,t.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,t.jsx)(bg,{className:"h-12 w-12 mx-auto mb-3 opacity-20"}),(0,t.jsx)("p",{children:"No tasks found in library"}),(0,t.jsx)("p",{className:"text-sm",children:"Save tasks from the Review step to build your collection"})]}):ar().map(a=>(0,t.jsx)(F.Card,{className:"bg-gray-800 border-gray-700 hover:border-gray-600 transition-colors",children:(0,t.jsx)(F.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(z.Badge,{variant:"outline",className:"bg-gray-900 border-gray-700 text-gray-400",children:a.subject}),(0,t.jsx)(z.Badge,{variant:"secondary",children:"multiple_choice"===a.type?"MC":"SA"}),a.topics.map((a,b)=>(0,t.jsx)("span",{className:"text-xs text-gray-500",children:a},b))]}),(0,t.jsx)("p",{className:"font-medium text-white",children:a.question}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 flex items-center gap-3",children:[(0,t.jsxs)("span",{children:["Used ",a.usedCount," times"]}),(0,t.jsx)("span",{children:"â€¢"}),(0,t.jsxs)("span",{children:["Saved ",new Date(a.savedAt).toLocaleDateString()]})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)(y.Button,{size:"sm",onClick:()=>an(a),children:"Add to Set"}),(0,t.jsxs)("div",{className:"flex gap-1 justify-end",children:[(0,t.jsx)(y.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>ao(a.id),children:(0,t.jsx)(bb.Star,{className:`h-4 w-4 ${a.isFavorite?"text-yellow-400 fill-current":"text-gray-500"}`})}),(0,t.jsx)(y.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-400 hover:text-red-300",onClick:()=>ap(a.id),children:(0,t.jsx)(a5.Trash2,{className:"h-4 w-4"})})]})]})]})})},a.id))})})]})}),(0,t.jsx)(B.Dialog,{open:k,onOpenChange:a=>{!m&&(l(a),a||(r([]),u(null)))},children:(0,t.jsxs)(B.DialogContent,{className:"max-w-3xl bg-gray-900 text-white border-gray-700",children:[(0,t.jsx)(B.DialogHeader,{children:(0,t.jsxs)(B.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(bj.FileUp,{className:"h-5 w-5 text-blue-400"}),"Import Content"]})}),(0,t.jsx)("div",{className:"min-h-[400px] flex flex-col",children:s?m?(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center p-8",children:[(0,t.jsxs)("div",{className:"w-24 h-24 relative mb-6",children:[(0,t.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-gray-700"}),(0,t.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-blue-500 border-t-transparent animate-spin"}),(0,t.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center font-bold text-lg",children:[o,"%"]})]}),(0,t.jsx)("h3",{className:"text-xl font-medium mb-2",children:"Analyzing Document..."}),(0,t.jsx)("p",{className:"text-gray-400 animate-pulse",children:"Running OCR and extracting questions"}),(0,t.jsxs)("div",{className:"mt-8 text-sm text-gray-500 flex items-center gap-2",children:[(0,t.jsx)(bi.FileText,{className:"h-4 w-4"}),s.name]})]}):(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-800",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium",children:"Detected Questions"}),(0,t.jsxs)("p",{className:"text-sm text-gray-400",children:[q.length," items found in ",s.name]})]}),(0,t.jsxs)(y.Button,{variant:"ghost",size:"sm",onClick:()=>u(null),children:[(0,t.jsx)(Y.X,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}),(0,t.jsx)(I.ScrollArea,{className:"flex-1 px-6",children:(0,t.jsx)("div",{className:"space-y-4 py-4",children:q.map((a,b)=>(0,t.jsx)(F.Card,{className:"bg-gray-800 border-gray-700",children:(0,t.jsx)(F.CardContent,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("div",{className:"w-6 h-6 rounded-full bg-blue-900/50 flex items-center justify-center text-xs font-bold text-blue-400 shrink-0",children:b+1}),(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsx)(G.Input,{value:a.question,onChange:a=>{let c=[...q];c[b].question=a.target.value,r(c)},className:"bg-gray-900 border-gray-600"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(z.Badge,{variant:"outline",children:a.type}),(0,t.jsx)(z.Badge,{variant:"secondary",children:a.difficulty})]})]})]})})},b))})}),(0,t.jsxs)("div",{className:"p-4 border-t border-gray-800 flex justify-end gap-3",children:[(0,t.jsx)(y.Button,{variant:"outline",onClick:()=>u(null),children:"Back"}),(0,t.jsxs)(y.Button,{onClick:()=>{Q(a=>[...a,...q]),l(!1),r([]),u(null),d("review"),E.toast.success("Import Successful",{description:`Added ${q.length} tasks to your set`})},children:["Import ",q.length," Tasks"]})]})]}):(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center border-2 border-dashed border-gray-700 rounded-lg m-4 bg-gray-800/50 hover:bg-gray-800/80 transition-colors relative",children:[(0,t.jsx)("input",{type:"file",accept:".pdf,.png,.jpg,.jpeg",onChange:a=>{let b=a.target.files?.[0];if(b){if(b.size>5242880)return void E.toast.error("File too large",{description:"Please upload a file smaller than 5MB"});u(b),at(b)}},className:"absolute inset-0 opacity-0 cursor-pointer"}),(0,t.jsx)("div",{className:"w-20 h-20 rounded-full bg-gray-800 flex items-center justify-center mb-4",children:(0,t.jsx)(bh,{className:"h-10 w-10 text-gray-400"})}),(0,t.jsx)("h3",{className:"text-xl font-medium mb-2",children:"Upload Worksheet"}),(0,t.jsxs)("p",{className:"text-gray-400 text-center max-w-sm mb-6",children:["Drag and drop your PDF or Image file here,",(0,t.jsx)("br",{}),"or click to browse"]}),(0,t.jsxs)("div",{className:"flex gap-4 text-sm text-gray-500",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(bi.FileText,{className:"h-4 w-4"})," PDF"]}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(bi.FileText,{className:"h-4 w-4"})," PNG"]}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(bi.FileText,{className:"h-4 w-4"})," JPG"]})]})]})})]})}),(0,t.jsx)("div",{className:`fixed inset-y-0 right-0 w-[600px] bg-gray-900 border-l border-gray-800 shadow-2xl transform transition-transform duration-300 z-50 ${C?"translate-x-0":"translate-x-full"}`,children:(0,t.jsx)(cr,{roomId:a,students:b.map(a=>({id:a.id,name:a.name,status:"on_track"===a.status?"active":a.status||"active"})),selectionMode:!0,onAssetsSelect:a=>{J(a),D(!1),E.toast.success(`Selected ${a.length} material(s)`,{description:"Assets ready for AI task generation"})},onClose:()=>D(!1)})})]})}var cA=a.i(121538);function cB({students:a,metrics:b,currentTopic:c="Derivatives and Rates of Change",classDuration:d}){let[e,f]=(0,v.useState)("insights"),[g,h]=(0,v.useState)(null),[i,j]=(0,v.useState)(!1),[k,l]=(0,v.useState)([]),[m,n]=(0,v.useState)([]),o=(0,v.useMemo)(()=>[{id:"prompt-1",context:"When discussing derivatives",question:"What do you think would happen to the slope if we made this curve steeper?",followUps:["Can you explain why?","How does that relate to the derivative?","What would the graph look like?"],difficulty:"medium"},{id:"prompt-2",context:"For students struggling with concepts",question:"Can you explain this concept in your own words?",followUps:["What part is confusing?","How would you explain it to a friend?"],difficulty:"easy"},{id:"prompt-3",context:"Advanced challenge",question:"How would this problem change if we had three variables instead of two?",followUps:["What new challenges would arise?","Which method would still work?"],difficulty:"hard"}],[]),p=(0,v.useMemo)(()=>{let b,c;return(b=[],(c=a.filter(a=>a.engagementScore<50&&"online"===a.status)).length>0&&b.push({id:"insight-1",type:"engagement",title:"Low Engagement Detected",message:`${c.length} student(s) showing low engagement`,suggestion:"Try asking a direct question or use a quick poll to re-engage",priority:"high",timestamp:new Date().toISOString(),acknowledged:!1,actionable:!0,actionLabel:"View Students"}),d>30&&d<35&&b.push({id:"insight-2",type:"pacing",title:"Pacing Alert",message:"You've been on this topic for 30+ minutes",suggestion:"Consider wrapping up with a summary or moving to practice exercises",priority:"medium",timestamp:new Date(Date.now()-3e5).toISOString(),acknowledged:!1,actionable:!0,actionLabel:"Suggest Wrap-up"}),b.push({id:"insight-3",type:"misconception",title:"Common Misconception Alert",message:'3 students may be confusing "derivative" with "slope"',suggestion:"Clarify: Derivative = instantaneous rate, Slope = average rate over interval",priority:"high",timestamp:new Date(Date.now()-6e5).toISOString(),acknowledged:!1,actionable:!0,actionLabel:"Show Explanation"}),b.push({id:"insight-4",type:"socratic",title:"Socratic Opportunity",message:"Students are ready for deeper questioning",suggestion:'Ask: "What would happen if we changed this variable?"',priority:"medium",timestamp:new Date(Date.now()-18e4).toISOString(),acknowledged:!1,actionable:!0,actionLabel:"Use Question"}),b).filter(a=>!m.includes(a.id)).map(a=>({...a,acknowledged:k.includes(a.id)}))},[a,d,k,m]),q=p.filter(a=>!a.acknowledged);return(0,t.jsxs)(F.Card,{className:"h-full flex flex-col",children:[(0,t.jsxs)(F.CardHeader,{className:"pb-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-blue-500 rounded-lg flex items-center justify-center",children:(0,t.jsx)(ae.Sparkles,{className:"w-4 h-4 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(F.CardTitle,{className:"text-sm font-medium",children:"AI Teaching Assistant"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Real-time insights & guidance"})]})]}),q.length>0&&(0,t.jsxs)(z.Badge,{variant:"destructive",className:"text-xs",children:[q.length," New"]})]}),(0,t.jsxs)("div",{className:"flex gap-1 mt-3",children:[(0,t.jsxs)(y.Button,{variant:"insights"===e?"default":"ghost",size:"sm",className:"flex-1 text-xs",onClick:()=>f("insights"),children:[(0,t.jsx)(aS.Zap,{className:"w-3 h-3 mr-1"}),"Insights"]}),(0,t.jsxs)(y.Button,{variant:"socratic"===e?"default":"ghost",size:"sm",className:"flex-1 text-xs",onClick:()=>f("socratic"),children:[(0,t.jsx)(aE.HelpCircle,{className:"w-3 h-3 mr-1"}),"Socratic"]}),(0,t.jsxs)(y.Button,{variant:"guide"===e?"default":"ghost",size:"sm",className:"flex-1 text-xs",onClick:()=>f("guide"),children:[(0,t.jsx)(a7.BookOpen,{className:"w-3 h-3 mr-1"}),"Guide"]})]})]}),(0,t.jsx)(F.CardContent,{className:"flex-1 p-0",children:(0,t.jsx)(I.ScrollArea,{className:"h-[calc(100%-20px)]",children:(0,t.jsxs)("div",{className:"px-4 pb-4",children:["insights"===e&&(0,t.jsx)("div",{className:"space-y-3",children:0===p.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(ae.Sparkles,{className:"w-10 h-10 text-gray-300 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"No insights yet"}),(0,t.jsx)("p",{className:"text-xs text-gray-400",children:"AI is monitoring the class..."})]}):p.map(a=>(0,t.jsx)("div",{className:(0,J.cn)("p-3 rounded-lg border transition-all",a.acknowledged?"bg-gray-50 border-gray-200 opacity-60":"bg-white border-gray-200 shadow-sm","high"===a.priority&&!a.acknowledged&&"border-l-4 border-l-red-500"),children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(a=>{switch(a){case"guidance":return(0,t.jsx)(a7.BookOpen,{className:"w-4 h-4 text-blue-500"});case"misconception":return(0,t.jsx)(cA.AlertTriangle,{className:"w-4 h-4 text-orange-500"});case"pacing":return(0,t.jsx)(ag.Clock,{className:"w-4 h-4 text-purple-500"});case"engagement":return(0,t.jsx)(aS.Zap,{className:"w-4 h-4 text-yellow-500"});case"socratic":return(0,t.jsx)(aE.HelpCircle,{className:"w-4 h-4 text-green-500"});default:return(0,t.jsx)(ae.Sparkles,{className:"w-4 h-4 text-blue-500"})}})(a.type),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"font-medium text-sm",children:a.title}),(0,t.jsx)(z.Badge,{variant:"outline",className:(0,J.cn)("text-xs",(a=>{switch(a){case"high":return"bg-red-100 text-red-700 border-red-200";case"medium":return"bg-yellow-100 text-yellow-700 border-yellow-200";case"low":return"bg-blue-100 text-blue-700 border-blue-200";default:return"bg-gray-100 text-gray-700"}})(a.priority)),children:a.priority})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:a.message}),a.suggestion&&(0,t.jsxs)("div",{className:"mt-2 p-2 bg-blue-50 rounded text-sm text-blue-800",children:[(0,t.jsx)(T.Lightbulb,{className:"w-3 h-3 inline mr-1"}),a.suggestion]}),!a.acknowledged&&(0,t.jsxs)("div",{className:"flex gap-2 mt-3",children:[a.actionable&&(0,t.jsxs)(y.Button,{size:"sm",variant:"outline",className:"flex-1 text-xs",children:[a.actionLabel,(0,t.jsx)(ch.ChevronRight,{className:"w-3 h-3 ml-1"})]}),(0,t.jsxs)(y.Button,{size:"sm",variant:"ghost",className:"text-xs",onClick:()=>{var b;return b=a.id,void l(a=>a.includes(b)?a:[...a,b])},children:[(0,t.jsx)(aJ.Check,{className:"w-3 h-3 mr-1"}),"Got it"]}),(0,t.jsx)(y.Button,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>{var b;return b=a.id,void n(a=>a.includes(b)?a:[...a,b])},children:(0,t.jsx)(Y.X,{className:"w-3 h-3"})})]})]})]})},a.id))}),"socratic"===e&&(0,t.jsx)("div",{className:"space-y-3",children:g?(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(y.Button,{variant:"ghost",size:"sm",className:"text-xs",onClick:()=>{h(null),j(!1)},children:"â† Back to prompts"}),(0,t.jsxs)("div",{className:"p-4 bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg border border-blue-200",children:[(0,t.jsx)(z.Badge,{className:"mb-2 bg-blue-600",children:"Selected Prompt"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:g.context}),(0,t.jsx)("p",{className:"font-medium text-lg text-gray-800",children:g.question}),(0,t.jsxs)(y.Button,{className:"w-full mt-4 gap-2",onClick:()=>j(!0),children:[(0,t.jsx)(O.MessageCircle,{className:"w-4 h-4"}),"Ask This Question"]}),i&&(0,t.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-gray-500",children:"Follow-up questions:"}),g.followUps.map((a,b)=>(0,t.jsx)("button",{className:"w-full text-left p-2 bg-white rounded border hover:border-blue-300 text-sm transition-colors",children:a},b))]})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"p-3 bg-purple-50 rounded-lg border border-purple-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(a7.BookOpen,{className:"w-4 h-4 text-purple-600"}),(0,t.jsx)("span",{className:"font-medium text-sm text-purple-800",children:"Current Topic"})]}),(0,t.jsx)("p",{className:"text-sm text-purple-700",children:c})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 font-medium mt-4 mb-2",children:"SUGGESTED QUESTIONS"}),o.map(a=>(0,t.jsxs)("button",{className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all",onClick:()=>h(a),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"text-xs text-gray-500",children:a.context}),(0,t.jsx)(z.Badge,{variant:"outline",className:"text-xs",children:a.difficulty})]}),(0,t.jsx)("p",{className:"text-sm font-medium text-gray-800",children:a.question})]},a.id))]})}),"guide"===e&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"p-3 bg-gradient-to-br from-green-50 to-blue-50 rounded-lg border",children:[(0,t.jsxs)("h3",{className:"font-medium text-sm mb-2 flex items-center gap-2",children:[(0,t.jsx)(aq.BarChart3,{className:"w-4 h-4"}),"Lesson Progress"]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Time elapsed"}),(0,t.jsxs)("span",{className:"font-medium",children:[Math.floor(d/60),"h ",d%60,"m"]})]}),(0,t.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-gradient-to-r from-green-500 to-blue-500 rounded-full",style:{width:`${Math.min(d/90*100,100)}%`}})}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:d<45?"Early phase - good for introducing concepts":d<75?"Mid-lesson - consider practice activities":"Wrapping up - time for summary and review"}),b&&(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["Current class engagement: ",b.averageEngagement,"%"]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("h3",{className:"font-medium text-sm flex items-center gap-2",children:[(0,t.jsx)(ag.Clock,{className:"w-4 h-4"}),"Recommended Next Steps"]}),(0,t.jsxs)("div",{className:"space-y-2",children:[d<30&&(0,t.jsxs)("div",{className:"p-3 bg-white rounded-lg border border-gray-200",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:"Continue Concept Introduction"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Use visual examples and ask for student predictions"})]}),(0,t.jsxs)("div",{className:"p-3 bg-white rounded-lg border border-gray-200",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:"Check for Understanding"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:'Quick poll: "Rate your confidence 1-5"'})]}),(0,t.jsxs)("div",{className:"p-3 bg-white rounded-lg border border-gray-200",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:"Practice Exercise"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Give students 3 minutes to solve independently"})]}),(0,t.jsxs)("div",{className:"p-3 bg-white rounded-lg border border-gray-200",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:"Breakout Discussion"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Group students to explain concepts to each other"})]})]})]}),(0,t.jsxs)("div",{className:"p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[(0,t.jsxs)("h3",{className:"font-medium text-sm mb-2 flex items-center gap-2 text-yellow-800",children:[(0,t.jsx)(T.Lightbulb,{className:"w-4 h-4"}),"Teaching Tip"]}),(0,t.jsx)("p",{className:"text-xs text-yellow-700",children:"Students retain 90% of what they teach others. Consider having students explain concepts to the class."})]})]})]})})})]})}var cC=a.i(724403),cD=a.i(139362),cE=a.i(752479);function cF({students:a,classDuration:b}){let[c,d]=(0,v.useState)("overview"),e=Math.round(a.filter(a=>"online"===a.status).reduce((a,b)=>a+b.engagementScore,0)/Math.max(1,a.filter(a=>"online"===a.status).length)),f=Math.round(a.filter(a=>a.chatMessages>0||a.reactions>0).length/Math.max(1,a.length)*100),g=a.filter(a=>a.engagementScore<50&&"online"===a.status),h=a.filter(a=>a.engagementScore>=85&&"online"===a.status),i=[{label:"Avg Engagement",value:e,change:5,trend:"up"},{label:"Participation",value:f,change:3,trend:"up"},{label:"Attention Rate",value:Math.round(a.filter(a=>"high"===a.attentionLevel).length/Math.max(1,a.length)*100),change:-2,trend:"down"}];return(0,t.jsxs)(F.Card,{className:"h-full flex flex-col",children:[(0,t.jsx)(F.CardHeader,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(aT.TrendingUp,{className:"w-4 h-4"}),(0,t.jsx)(F.CardTitle,{className:"text-sm font-medium",children:"Progress Tracking"})]}),(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)(y.Button,{variant:"overview"===c?"default":"ghost",size:"sm",className:"text-xs h-7",onClick:()=>d("overview"),children:"Overview"}),(0,t.jsx)(y.Button,{variant:"individual"===c?"default":"ghost",size:"sm",className:"text-xs h-7",onClick:()=>d("individual"),children:"Students"})]})]})}),(0,t.jsx)(F.CardContent,{className:"flex-1 p-0",children:(0,t.jsx)(I.ScrollArea,{className:"h-[calc(100%-60px)]",children:(0,t.jsx)("div",{className:"px-4 pb-4 space-y-4",children:"overview"===c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2",children:i.map((a,b)=>(0,t.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg text-center",children:[(0,t.jsxs)("p",{className:"text-lg font-bold",children:[a.value,"%"]}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:a.label}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-1 mt-1",children:[(a=>{switch(a){case"up":return(0,t.jsx)(cD.ArrowUpRight,{className:"w-4 h-4 text-green-500"});case"down":return(0,t.jsx)(cE.ArrowDownRight,{className:"w-4 h-4 text-red-500"});default:return(0,t.jsx)(aV.Minus,{className:"w-4 h-4 text-gray-400"})}})(a.trend),(0,t.jsxs)("span",{className:(0,J.cn)("text-xs","up"===a.trend?"text-green-600":"down"===a.trend?"text-red-600":"text-gray-500"),children:[a.change>0?"+":"",a.change,"%"]})]})]},b))}),(0,t.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("h3",{className:"text-sm font-medium mb-3 flex items-center gap-2",children:[(0,t.jsx)(K.Users,{className:"w-4 h-4"}),"Engagement Distribution"]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xs w-16",children:"High (85%+)"}),(0,t.jsx)("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-green-500 rounded-full",style:{width:`${h.length/a.length*100}%`}})}),(0,t.jsx)("span",{className:"text-xs w-8 text-right",children:h.length})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xs w-16",children:"Medium"}),(0,t.jsx)("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${a.filter(a=>a.engagementScore>=50&&a.engagementScore<85).length/a.length*100}%`}})}),(0,t.jsx)("span",{className:"text-xs w-8 text-right",children:a.filter(a=>a.engagementScore>=50&&a.engagementScore<85).length})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xs w-16",children:"Low (<50%)"}),(0,t.jsx)("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-red-500 rounded-full",style:{width:`${g.length/a.length*100}%`}})}),(0,t.jsx)("span",{className:"text-xs w-8 text-right",children:g.length})]})]})]}),g.length>0&&(0,t.jsxs)("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200",children:[(0,t.jsxs)("h3",{className:"text-sm font-medium text-red-800 mb-2 flex items-center gap-2",children:[(0,t.jsx)(cA.AlertTriangle,{className:"w-4 h-4"}),"Students Need Attention"]}),(0,t.jsxs)("div",{className:"space-y-2",children:[g.slice(0,3).map(a=>(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-red-700",children:a.name}),(0,t.jsxs)(z.Badge,{variant:"outline",className:"text-xs bg-white",children:[a.engagementScore,"% engagement"]})]},a.id)),g.length>3&&(0,t.jsxs)("p",{className:"text-xs text-red-600",children:["+",g.length-3," more students"]})]})]}),(0,t.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("h3",{className:"text-sm font-medium mb-3 flex items-center gap-2",children:[(0,t.jsx)(ag.Clock,{className:"w-4 h-4"}),"Class Activity"]}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Duration"}),(0,t.jsxs)("span",{className:"font-medium",children:[Math.floor(b/60),"h ",b%60,"m"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Messages"}),(0,t.jsx)("span",{className:"font-medium",children:a.reduce((a,b)=>a+b.chatMessages,0)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Reactions"}),(0,t.jsx)("span",{className:"font-medium",children:a.reduce((a,b)=>a+b.reactions,0)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Hand Raises"}),(0,t.jsx)("span",{className:"font-medium",children:a.filter(a=>a.handRaised).length})]})]})]})]}):(0,t.jsx)("div",{className:"space-y-2",children:a.sort((a,b)=>b.engagementScore-a.engagementScore).map(a=>(0,t.jsxs)("div",{className:(0,J.cn)("p-3 rounded-lg border",a.engagementScore>=85?"bg-green-50 border-green-200":a.engagementScore>=50?"bg-white border-gray-200":"bg-red-50 border-red-200"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:(0,J.cn)("w-2 h-2 rounded-full","online"===a.status?"bg-green-500":"idle"===a.status?"bg-yellow-500":"bg-gray-400")}),(0,t.jsx)("span",{className:"font-medium text-sm",children:a.name})]}),(0,t.jsxs)("span",{className:(0,J.cn)("text-sm font-bold",a.engagementScore>=85?"text-green-600":a.engagementScore>=50?"text-blue-600":"text-red-600"),children:[a.engagementScore,"%"]})]}),(0,t.jsx)(cC.Progress,{value:a.engagementScore,className:"h-1.5"}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mt-2 text-xs text-gray-500",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(_.Target,{className:"w-3 h-3"}),a.attentionLevel]}),(0,t.jsx)("span",{children:"â€¢"}),(0,t.jsxs)("span",{children:[a.chatMessages," messages"]}),(0,t.jsx)("span",{children:"â€¢"}),(0,t.jsxs)("span",{children:[a.reactions," reactions"]})]})]},a.id))})})})})]})}var cG=a.i(254454),cH=a.i(870769),cI=a.i(354248),cJ=a.i(452881),cK=a.i(87411);function cL(a,b=[]){let c=[],d=()=>{let b=c.map(a=>v.createContext(a));return function(c){let d=c?.[a]||b;return v.useMemo(()=>({[`__scope${a}`]:{...c,[a]:d}}),[c,d])}};return d.scopeName=a,[function(b,d){let e=v.createContext(d),f=c.length;c=[...c,d];let g=b=>{let{scope:c,children:d,...g}=b,h=c?.[a]?.[f]||e,i=v.useMemo(()=>g,Object.values(g));return(0,t.jsx)(h.Provider,{value:i,children:d})};return g.displayName=b+"Provider",[g,function(c,g){let h=g?.[a]?.[f]||e,i=v.useContext(h);if(i)return i;if(void 0!==d)return d;throw Error(`\`${c}\` must be used within \`${b}\``)}]},function(...a){let b=a[0];if(1===a.length)return b;let c=()=>{let c=a.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){let d=c.reduce((b,{useScope:c,scopeName:d})=>{let e=c(a)[`__scope${d}`];return{...b,...e}},{});return v.useMemo(()=>({[`__scope${b.scopeName}`]:d}),[d])}};return c.scopeName=b.scopeName,c}(d,...b)]}a.i(715631);var cM=Symbol("radix.slottable");function cN(a){return v.isValidElement(a)&&"function"==typeof a.type&&"__radixId"in a.type&&a.type.__radixId===cM}var cO=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,b)=>{var c,d;let e,f,g,h=(d=c=`Primitive.${b}`,(e=v.forwardRef((a,b)=>{let{children:c,...d}=a;if(v.isValidElement(c)){var e;let a,f,g=(e=c,(f=(a=Object.getOwnPropertyDescriptor(e.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.ref:(f=(a=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.props.ref:e.props.ref||e.ref),h=function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{let b=f(...a);return e(...a),b}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(d,c.props);return c.type!==v.Fragment&&(h.ref=b?(0,cK.composeRefs)(b,g):g),v.cloneElement(c,h)}return v.Children.count(c)>1?v.Children.only(null):null})).displayName=`${d}.SlotClone`,f=e,(g=v.forwardRef((a,b)=>{let{children:c,...d}=a,e=v.Children.toArray(c),g=e.find(cN);if(g){let a=g.props.children,c=e.map(b=>b!==g?b:v.Children.count(a)>1?v.Children.only(null):v.isValidElement(a)?a.props.children:null);return(0,t.jsx)(f,{...d,ref:b,children:v.isValidElement(a)?v.cloneElement(a,void 0,c):null})}return(0,t.jsx)(f,{...d,ref:b,children:c})})).displayName=`${c}.Slot`,g),i=v.forwardRef((a,c)=>{let{asChild:d,...e}=a;return(0,t.jsx)(d?h:b,{...e,ref:c})});return i.displayName=`Primitive.${b}`,{...a,[b]:i}},{}),cP=a.i(742196),cQ=a.i(568268),cR=a.i(169853),cS=a.i(321493),cT=a.i(428125),cU=a.i(594721),cV="Radio",[cW,cX]=cL(cV),[cY,cZ]=cW(cV),c$=v.forwardRef((a,b)=>{let{__scopeRadio:c,name:d,checked:e=!1,required:f,disabled:g,value:h="on",onCheck:i,form:j,...k}=a,[l,m]=v.useState(null),n=(0,cK.useComposedRefs)(b,a=>m(a)),o=v.useRef(!1),p=!l||j||!!l.closest("form");return(0,t.jsxs)(cY,{scope:c,checked:e,disabled:g,children:[(0,t.jsx)(cO.button,{type:"button",role:"radio","aria-checked":e,"data-state":c2(e),"data-disabled":g?"":void 0,disabled:g,value:h,...k,ref:n,onClick:(0,cJ.composeEventHandlers)(a.onClick,a=>{e||i?.(),p&&(o.current=a.isPropagationStopped(),o.current||a.stopPropagation())})}),p&&(0,t.jsx)(c1,{control:l,bubbles:!o.current,name:d,value:h,checked:e,required:f,disabled:g,form:j,style:{transform:"translateX(-100%)"}})]})});c$.displayName=cV;var c_="RadioIndicator",c0=v.forwardRef((a,b)=>{let{__scopeRadio:c,forceMount:d,...e}=a,f=cZ(c_,c);return(0,t.jsx)(cU.Presence,{present:d||f.checked,children:(0,t.jsx)(cO.span,{"data-state":c2(f.checked),"data-disabled":f.disabled?"":void 0,...e,ref:b})})});c0.displayName=c_;var c1=v.forwardRef(({__scopeRadio:a,control:b,checked:c,bubbles:d=!0,...e},f)=>{let g=v.useRef(null),h=(0,cK.useComposedRefs)(g,f),i=(0,cT.usePrevious)(c),j=(0,cS.useSize)(b);return v.useEffect(()=>{let a=g.current;if(!a)return;let b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(i!==c&&b){let e=new Event("click",{bubbles:d});b.call(a,c),a.dispatchEvent(e)}},[i,c,d]),(0,t.jsx)(cO.input,{type:"radio","aria-hidden":!0,defaultChecked:c,...e,tabIndex:-1,ref:h,style:{...e.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function c2(a){return a?"checked":"unchecked"}c1.displayName="RadioBubbleInput";var c3=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],c4="RadioGroup",[c5,c6]=cL(c4,[cP.createRovingFocusGroupScope,cX]),c7=(0,cP.createRovingFocusGroupScope)(),c8=cX(),[c9,da]=c5(c4),db=v.forwardRef((a,b)=>{let{__scopeRadioGroup:c,name:d,defaultValue:e,value:f,required:g=!1,disabled:h=!1,orientation:i,dir:j,loop:k=!0,onValueChange:l,...m}=a,n=c7(c),o=(0,cR.useDirection)(j),[p,q]=(0,cQ.useControllableState)({prop:f,defaultProp:e??null,onChange:l,caller:c4});return(0,t.jsx)(c9,{scope:c,name:d,required:g,disabled:h,value:p,onValueChange:q,children:(0,t.jsx)(cP.Root,{asChild:!0,...n,orientation:i,dir:o,loop:k,children:(0,t.jsx)(cO.div,{role:"radiogroup","aria-required":g,"aria-orientation":i,"data-disabled":h?"":void 0,dir:o,...m,ref:b})})})});db.displayName=c4;var dc="RadioGroupItem",dd=v.forwardRef((a,b)=>{let{__scopeRadioGroup:c,disabled:d,...e}=a,f=da(dc,c),g=f.disabled||d,h=c7(c),i=c8(c),j=v.useRef(null),k=(0,cK.useComposedRefs)(b,j),l=f.value===e.value,m=v.useRef(!1);return v.useEffect(()=>{let a=a=>{c3.includes(a.key)&&(m.current=!0)},b=()=>m.current=!1;return document.addEventListener("keydown",a),document.addEventListener("keyup",b),()=>{document.removeEventListener("keydown",a),document.removeEventListener("keyup",b)}},[]),(0,t.jsx)(cP.Item,{asChild:!0,...h,focusable:!g,active:l,children:(0,t.jsx)(c$,{disabled:g,required:f.required,checked:l,...i,...e,name:f.name,ref:k,onCheck:()=>f.onValueChange(e.value),onKeyDown:(0,cJ.composeEventHandlers)(a=>{"Enter"===a.key&&a.preventDefault()}),onFocus:(0,cJ.composeEventHandlers)(e.onFocus,()=>{m.current&&j.current?.click()})})})});dd.displayName=dc;var de=v.forwardRef((a,b)=>{let{__scopeRadioGroup:c,...d}=a,e=c8(c);return(0,t.jsx)(c0,{...e,...d,ref:b})});de.displayName="RadioGroupIndicator";var df=a.i(879442);let dg=v.forwardRef(({className:a,...b},c)=>(0,t.jsx)(db,{className:(0,J.cn)("grid gap-2",a),...b,ref:c}));dg.displayName=db.displayName;let dh=v.forwardRef(({className:a,...b},c)=>(0,t.jsx)(dd,{ref:c,className:(0,J.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),...b,children:(0,t.jsx)(de,{className:"flex items-center justify-center",children:(0,t.jsx)(df.Circle,{className:"h-2.5 w-2.5 fill-current text-current"})})}));dh.displayName=dd.displayName;var di=a.i(34462),dj=a.i(849639);let dk=(0,aa.default)("cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);var dl=a.i(414030);let dm=[{id:"understanding-check",name:"Understanding Check",icon:"HelpCircle",description:"Quick yes/no check for concept understanding",defaultQuestion:"Do you understand this concept?",type:"true_false",options:["Yes, I understand","No, I need clarification"]},{id:"confidence-rating",name:"Confidence Rating",icon:"Gauge",description:"Rate confidence level on a scale of 1-5",defaultQuestion:"How confident are you with this topic?",type:"rating",options:["1 - Not confident","2","3","4","5 - Very confident"]},{id:"topic-review",name:"Topic Review Vote",icon:"List",description:"Let students vote on what to review next",defaultQuestion:"Which topic should we review next?",type:"multiple_choice",options:["Topic A","Topic B","Topic C","Topic D"]},{id:"ready-to-proceed",name:"Ready to Move On?",icon:"Play",description:"Check if students are ready to continue",defaultQuestion:"Are you ready to move on to the next section?",type:"true_false",options:["Yes, let's continue","No, I need more time"]},{id:"quick-quiz",name:"Quick Quiz",icon:"Brain",description:"Multiple choice question with correct answer",defaultQuestion:"What is the correct answer?",type:"multiple_choice",options:["Option A","Option B","Option C","Option D"]},{id:"word-cloud",name:"Word Cloud",icon:"Cloud",description:"Collect single-word responses from students",defaultQuestion:"What's one word that describes your understanding?",type:"word_cloud"},{id:"short-answer",name:"Short Answer",icon:"MessageSquare",description:"Open-ended question for detailed responses",defaultQuestion:"What questions do you have about this topic?",type:"short_answer"},{id:"pace-check",name:"Pace Check",icon:"Clock",description:"Check if the teaching pace is appropriate",defaultQuestion:"How is the pace of the lesson?",type:"multiple_choice",options:["Too slow","Just right","Too fast","Way too fast"]}];function dn(a){return String.fromCharCode(65+a)}let dp=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899","#06b6d4","#84cc16"],dq={HelpCircle:aE.HelpCircle,Gauge:di.Gauge,List:a9.List,Play:dj.Play,Brain:$.Brain,Cloud:dk,MessageSquare:ap.MessageSquare,Clock:ag.Clock};function dr({onSubmit:a,onCancel:b}){let[c,d]=(0,v.useState)("template"),[e,f]=(0,v.useState)(null),[g,h]=(0,v.useState)(""),[i,j]=(0,v.useState)("multiple_choice"),[k,l]=(0,v.useState)([{label:"A",text:""},{label:"B",text:""}]),[m,n]=(0,v.useState)(!0),[o,p]=(0,v.useState)(!1),[q,r]=(0,v.useState)(!0),[s,u]=(0,v.useState)(void 0),w=(0,v.useCallback)(a=>{let b=dm.find(b=>b.id===a);b&&(f(a),h(b.defaultQuestion),j(b.type),b.options?l(b.options.map((a,b)=>({label:dn(b),text:a}))):l([{label:"A",text:""},{label:"B",text:""}]),d("customize"))},[]),x=(0,v.useCallback)(()=>{k.length>=6||l(a=>[...a,{label:dn(a.length),text:""}])},[k.length]),z=(0,v.useCallback)(a=>{k.length<=2||l(b=>b.filter((b,c)=>c!==a).map((a,b)=>({...a,label:dn(b)})))},[k.length]),A=(0,v.useCallback)((a,b)=>{l(c=>c.map((c,d)=>d===a?{...c,text:b}:c))},[]),B=(0,v.useCallback)(()=>{!g.trim()||("multiple_choice"===i||"true_false"===i)&&k.some(a=>!a.text.trim())||a({question:g.trim(),type:i,options:k,isAnonymous:m,allowMultiple:o,showResults:q,timeLimit:s})},[g,i,k,m,o,q,s,a]);if("template"===c)return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)(y.Button,{variant:"ghost",size:"icon",onClick:b,children:(0,t.jsx)(dl.ArrowLeft,{className:"h-4 w-4"})}),(0,t.jsx)("h4",{className:"font-medium",children:"Choose a Template"})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3",children:dm.map(a=>{let b=dq[a.icon]||aE.HelpCircle;return(0,t.jsxs)("button",{onClick:()=>w(a.id),className:(0,J.cn)("p-4 border rounded-lg text-left transition-all hover:border-blue-500 hover:bg-blue-50",e===a.id&&"border-blue-500 bg-blue-50"),children:[(0,t.jsx)(b,{className:"h-5 w-5 text-blue-600 mb-2"}),(0,t.jsx)("h5",{className:"font-medium text-sm",children:a.name}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:a.description})]},a.id)})}),(0,t.jsx)(y.Button,{variant:"outline",className:"w-full",onClick:()=>{f(null),d("customize")},children:"Start from Scratch"})]});let C=g.trim()&&("short_answer"===i||"word_cloud"===i||k.every(a=>a.text.trim()));return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)(y.Button,{variant:"ghost",size:"icon",onClick:()=>d("template"),children:(0,t.jsx)(dl.ArrowLeft,{className:"h-4 w-4"})}),(0,t.jsx)("h4",{className:"font-medium",children:"Customize Poll"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a2.Label,{children:"Question"}),(0,t.jsx)(a3.Textarea,{value:g,onChange:a=>h(a.target.value),placeholder:"Enter your question...",className:"min-h-[80px]"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a2.Label,{children:"Poll Type"}),(0,t.jsx)(dg,{value:i,onValueChange:a=>j(a),className:"grid grid-cols-2 gap-2",children:[{value:"multiple_choice",label:"Multiple Choice"},{value:"true_false",label:"Yes / No"},{value:"rating",label:"Rating (1-5)"},{value:"short_answer",label:"Short Answer"},{value:"word_cloud",label:"Word Cloud"}].map(a=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(dh,{value:a.value,id:a.value}),(0,t.jsx)(a2.Label,{htmlFor:a.value,className:"text-sm cursor-pointer",children:a.label})]},a.value))})]}),("multiple_choice"===i||"true_false"===i)&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(a2.Label,{children:"Options"}),k.length<6&&(0,t.jsxs)(y.Button,{type:"button",variant:"ghost",size:"sm",onClick:x,children:[(0,t.jsx)(Z.Plus,{className:"h-4 w-4 mr-1"}),"Add Option"]})]}),(0,t.jsx)("div",{className:"space-y-2",children:k.map((a,b)=>(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium text-white shrink-0",style:{backgroundColor:dp[b%dp.length]},children:a.label}),(0,t.jsx)(G.Input,{value:a.text,onChange:a=>A(b,a.target.value),placeholder:`Option ${a.label}`,className:"flex-1"}),k.length>2&&(0,t.jsx)(y.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>z(b),className:"text-red-500 hover:text-red-600 shrink-0",children:(0,t.jsx)(a5.Trash2,{className:"h-4 w-4"})})]},b))})]}),(0,t.jsxs)("div",{className:"space-y-3 pt-2 border-t",children:[(0,t.jsx)("h5",{className:"font-medium text-sm",children:"Settings"}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(a2.Label,{className:"text-sm",children:"Anonymous Voting"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Hide voter identities"})]}),(0,t.jsx)(cI.Switch,{checked:m,onCheckedChange:n})]}),("multiple_choice"===i||"true_false"===i)&&(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(a2.Label,{className:"text-sm",children:"Allow Multiple Selections"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Voters can choose multiple options"})]}),(0,t.jsx)(cI.Switch,{checked:o,onCheckedChange:p})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(a2.Label,{className:"text-sm",children:"Show Results to Students"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Display live results to participants"})]}),(0,t.jsx)(cI.Switch,{checked:q,onCheckedChange:r})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a2.Label,{className:"text-sm",children:"Time Limit (optional)"}),(0,t.jsx)("div",{className:"flex gap-2",children:[30,60,120,300].map(a=>(0,t.jsx)(y.Button,{type:"button",variant:s===a?"default":"outline",size:"sm",onClick:()=>u(s===a?void 0:a),children:a<60?`${a}s`:`${Math.floor(a/60)}m`},a))})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,t.jsx)(y.Button,{variant:"outline",onClick:b,className:"flex-1",children:"Cancel"}),(0,t.jsx)(y.Button,{onClick:B,disabled:!C,className:"flex-1",children:"Create Poll"})]})]})}function ds(a,b){let c=a.responses?.length||0,d=b>0?Math.round(c/b*100):0,e=a.options.map(b=>{let d=0;if("rating"===a.type){let c=parseInt(b.label);d=a.responses?.filter(a=>a.rating===c).length||0}else d="word_cloud"===a.type||"short_answer"===a.type?a.responses?.filter(a=>a.textAnswer&&a.textAnswer.trim()).length||0:a.responses?.filter(a=>a.optionIds?.includes(b.id)).length||0;let e=c>0?Math.round(d/c*100):0;return{optionId:b.id,count:d,percentage:e}});return{totalVotes:c,participationRate:d,optionStats:e}}function dt(a){if(!a.startedAt||!a.timeLimit)return null;let b=new Date(a.startedAt).getTime(),c=Date.now()-b;return Math.max(0,Math.floor((1e3*a.timeLimit-c)/1e3))}function du(a){if("word_cloud"!==a.type&&"short_answer"!==a.type)return[];let b={};return a.responses?.forEach(a=>{a.textAnswer&&a.textAnswer.toLowerCase().split(/\s+/).map(a=>a.replace(/[^\w\u4e00-\u9fff]/g,"")).filter(a=>a.length>0).forEach(a=>{b[a]=(b[a]||0)+1})}),Object.entries(b).map(([a,b])=>({word:a,count:b})).sort((a,b)=>b.count-a.count)}function dv({poll:a,totalStudents:b,onEnd:c}){let d,e,[f,g]=(0,v.useState)(Date.now()),h=ds(a,b),i=dt(a),j=null!==(d=dt(a))&&d<=0;return(0,v.useEffect)(()=>{let a=setInterval(()=>{g(Date.now())},1e3);return()=>clearInterval(a)},[]),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(z.Badge,{className:"bg-green-100 text-green-700 border-green-200 mb-2",children:"â— Live"}),(0,t.jsx)("h4",{className:"font-medium text-gray-900",children:a.question}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[a.type.replace("_"," ")," â€¢ ",a.isAnonymous?"Anonymous":"Named"]})]}),null!==i&&!j&&(0,t.jsxs)("div",{className:"flex items-center gap-1 text-orange-600 bg-orange-50 px-2 py-1 rounded",children:[(0,t.jsx)(ag.Clock,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"font-mono font-medium",children:(e=Math.floor(i/60),`${e}:${(i%60).toString().padStart(2,"0")}`)})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,t.jsx)(dA,{icon:(0,t.jsx)(K.Users,{className:"h-4 w-4"}),value:h.totalVotes,label:"Responses"}),(0,t.jsx)(dA,{icon:(0,t.jsx)(aT.TrendingUp,{className:"h-4 w-4"}),value:`${h.participationRate}%`,label:"Participation"}),(0,t.jsx)(dA,{icon:(0,t.jsx)(aq.BarChart3,{className:"h-4 w-4"}),value:b-h.totalVotes,label:"Remaining"})]}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Class Participation"}),(0,t.jsxs)("span",{className:"font-medium",children:[h.participationRate,"%"]})]}),(0,t.jsx)(cC.Progress,{value:h.participationRate,className:"h-2"})]}),(0,t.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,t.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"Live Results"}),(()=>{switch(a.type){case"word_cloud":return(0,t.jsx)(dy,{poll:a});case"short_answer":return(0,t.jsx)(dz,{poll:a});case"rating":return(0,t.jsx)(dx,{poll:a,stats:h});default:return(0,t.jsx)(dw,{poll:a,stats:h})}})()]}),(0,t.jsxs)(y.Button,{onClick:c,variant:"destructive",className:"w-full",children:[(0,t.jsx)(as.Square,{className:"h-4 w-4 mr-2"}),"End Poll"]})]})}function dw({poll:a,stats:b}){let c=Math.max(...b.optionStats.map(a=>a.count),1);return(0,t.jsx)("div",{className:"space-y-3",children:a.options.map((a,d)=>{let e=b.optionStats.find(b=>b.optionId===a.id),f=e?.count||0,g=e?.percentage||0;return(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"w-5 h-5 rounded-full flex items-center justify-center text-xs font-medium text-white",style:{backgroundColor:dB(d)},children:a.label}),(0,t.jsx)("span",{className:"font-medium",children:a.text}),f===c&&f>0&&f>0&&(0,t.jsx)(z.Badge,{variant:"secondary",className:"text-xs",children:"Leading"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"text-gray-500",children:[f," votes"]}),(0,t.jsxs)("span",{className:"font-medium w-10 text-right",children:[g,"%"]})]})]}),(0,t.jsx)("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full transition-all duration-500 ease-out rounded-full",style:{width:`${g}%`,backgroundColor:dB(d)}})})]},a.id)})})}function dx({poll:a,stats:b}){return b.optionStats.map(a=>a.count),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"flex items-center justify-center gap-1 mb-4",children:[1,2,3,4,5].map(c=>{let d=b.optionStats.find(b=>{let d=a.options.find(a=>a.id===b.optionId);return d&&parseInt(d.label)===c}),e=d?.count||0;return(0,t.jsx)("div",{className:(0,J.cn)("w-10 h-10 rounded-lg flex items-center justify-center font-medium transition-colors",e>0?"bg-blue-500 text-white":"bg-gray-200 text-gray-400"),children:c},c)})}),a.options.map((a,c)=>{let d=b.optionStats.find(b=>b.optionId===a.id),e=d?.count||0,f=d?.percentage||0;return(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"w-8 font-medium text-gray-700",children:a.label}),(0,t.jsx)("div",{className:"flex-1 h-6 bg-gray-200 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-blue-500 transition-all duration-500 ease-out rounded-full flex items-center justify-end pr-2",style:{width:`${f}%`},children:f>15&&(0,t.jsx)("span",{className:"text-xs text-white font-medium",children:e})})}),(0,t.jsxs)("span",{className:"w-10 text-right text-sm text-gray-500",children:[f,"%"]})]},a.id)})]})}function dy({poll:a}){let b=du(a),c=Math.max(...b.map(a=>a.count),1);return 0===b.length?(0,t.jsx)("div",{className:"text-center py-8 text-gray-400",children:"Waiting for responses..."}):(0,t.jsx)("div",{className:"flex flex-wrap gap-2 justify-center p-4",children:b.slice(0,30).map(({word:a,count:b})=>{let d=Math.max(.75,b/c*2),e=Math.max(.5,b/c);return(0,t.jsxs)("span",{className:"inline-block px-2 py-1 rounded-full bg-blue-100 text-blue-800 transition-all",style:{fontSize:`${d}rem`,opacity:e},children:[a,(0,t.jsxs)("span",{className:"text-xs ml-1 opacity-60",children:["(",b,")"]})]},a)})})}function dz({poll:a}){let b=a.responses?.filter(a=>a.textAnswer?.trim())||[];return 0===b.length?(0,t.jsx)("div",{className:"text-center py-8 text-gray-400",children:"Waiting for responses..."}):(0,t.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:b.map((a,b)=>(0,t.jsx)("div",{className:"p-3 bg-white rounded-lg border text-sm",children:a.textAnswer},a.id||b))})}function dA({icon:a,value:b,label:c}){return(0,t.jsxs)("div",{className:"bg-white border rounded-lg p-3 text-center",children:[(0,t.jsx)("div",{className:"flex justify-center text-gray-400 mb-1",children:a}),(0,t.jsx)("div",{className:"text-xl font-bold text-gray-900",children:b}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:c})]})}function dB(a){let b=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899"];return b[a%b.length]}var dC=a.i(273489),dD=a.i(311514);function dE({polls:a,onReuse:b,onDelete:c}){let[d,e]=(0,v.useState)(new Set);return 0===a.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,t.jsx)(aq.BarChart3,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,t.jsx)("p",{children:"No completed polls yet"}),(0,t.jsx)("p",{className:"text-sm mt-1",children:"Ended polls will appear here"})]}):(0,t.jsx)("div",{className:"space-y-3",children:a.map(a=>{let f,g,h,i,j,k=d.has(a.id);return(0,t.jsxs)("div",{className:"border rounded-lg bg-white overflow-hidden",children:[(0,t.jsx)("button",{className:"w-full p-3 text-left hover:bg-gray-50 transition-colors",onClick:()=>{var b;return b=a.id,void e(a=>{let c=new Set(a);return c.has(b)?c.delete(b):c.add(b),c})},children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-gray-900 line-clamp-2",children:a.question}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[(0,t.jsx)(z.Badge,{variant:"secondary",className:"text-xs",children:a.type.replace("_"," ")}),(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:[a.totalResponses||0," responses"]}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:(f=new Date(a.endedAt||a.createdAt),h=Math.floor((g=new Date().getTime()-f.getTime())/6e4),i=Math.floor(g/36e5),j=Math.floor(g/864e5),h<1?"Just now":h<60?`${h}m ago`:i<24?`${i}h ago`:j<7?`${j}d ago`:f.toLocaleDateString("en-US",{month:"short",day:"numeric"}))})]})]}),(0,t.jsx)("div",{className:"ml-2",children:k?(0,t.jsx)(dC.ChevronUp,{className:"h-4 w-4 text-gray-400"}):(0,t.jsx)(ci.ChevronDown,{className:"h-4 w-4 text-gray-400"})})]})}),k&&(0,t.jsxs)("div",{className:"px-3 pb-3 border-t bg-gray-50",children:[(0,t.jsx)(dF,{poll:a}),(0,t.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,t.jsxs)(y.Button,{size:"sm",variant:"outline",onClick:()=>b(a),className:"flex-1",children:[(0,t.jsx)(dD.RotateCcw,{className:"h-4 w-4 mr-1"}),"Reuse"]}),(0,t.jsx)(y.Button,{size:"sm",variant:"ghost",onClick:()=>c(a.id),className:"text-red-500 hover:text-red-600",children:(0,t.jsx)(a5.Trash2,{className:"h-4 w-4"})})]})]})]},a.id)})})}function dF({poll:a}){let b=ds(a,a.totalResponses||0);return(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,t.jsxs)("div",{className:"flex gap-4 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 text-gray-600",children:[(0,t.jsx)(K.Users,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:[b.totalVotes," responses"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-gray-600",children:[(0,t.jsx)(ag.Clock,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:a.startedAt&&a.endedAt?`${Math.round((new Date(a.endedAt).getTime()-new Date(a.startedAt).getTime())/1e3)}s`:"N/A"})]})]}),(()=>{switch(a.type){case"word_cloud":return(0,t.jsx)(dI,{poll:a});case"short_answer":return(0,t.jsx)(dJ,{poll:a});case"rating":return(0,t.jsx)(dH,{poll:a,stats:b});default:return(0,t.jsx)(dG,{poll:a,stats:b})}})()]})}function dG({poll:a,stats:b}){return(0,t.jsx)("div",{className:"space-y-2",children:a.options.map((a,c)=>{let d=b.optionStats.find(b=>b.optionId===a.id);d?.count;let e=d?.percentage||0;return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"w-5 h-5 rounded-full flex items-center justify-center text-xs font-medium text-white shrink-0",style:{backgroundColor:dK(c)},children:a.label}),(0,t.jsx)("span",{className:"text-sm flex-1 truncate",children:a.text}),(0,t.jsxs)("div",{className:"flex items-center gap-2 w-24",children:[(0,t.jsx)("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full rounded-full transition-all",style:{width:`${e}%`,backgroundColor:dK(c)}})}),(0,t.jsxs)("span",{className:"text-xs text-gray-500 w-8 text-right",children:[e,"%"]})]})]},a.id)})})}function dH({poll:a,stats:b}){return(0,t.jsx)("div",{className:"flex items-center justify-center gap-2",children:[1,2,3,4,5].map(c=>{let d=b.optionStats.find(b=>{let d=a.options.find(a=>a.id===b.optionId);return d&&parseInt(d.label)===c}),e=d?.count||0,f=Math.round(e/(b.totalVotes||1)*100);return(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:(0,J.cn)("w-10 h-10 rounded-lg flex items-center justify-center font-medium mb-1",e>0?"bg-blue-500 text-white":"bg-gray-200 text-gray-400"),children:c}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:[f,"%"]})]},c)})})}function dI({poll:a}){let b=du(a);if(0===b.length)return(0,t.jsx)("p",{className:"text-sm text-gray-400 text-center py-4",children:"No responses"});let c=Math.max(...b.map(a=>a.count),1);return(0,t.jsx)("div",{className:"flex flex-wrap gap-2 justify-center",children:b.slice(0,20).map(({word:a,count:b})=>{let d=Math.max(.75,b/c*1.5);return(0,t.jsx)("span",{className:"inline-block px-2 py-1 rounded-full bg-blue-100 text-blue-800",style:{fontSize:`${d}rem`},children:a},a)})})}function dJ({poll:a}){let b=a.responses?.filter(a=>a.textAnswer?.trim())||[];return 0===b.length?(0,t.jsx)("p",{className:"text-sm text-gray-400 text-center py-4",children:"No responses"}):(0,t.jsxs)("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:[b.slice(0,10).map((a,b)=>(0,t.jsx)("div",{className:"p-2 bg-white rounded border text-sm",children:a.textAnswer},a.id||b)),b.length>10&&(0,t.jsxs)("p",{className:"text-xs text-gray-400 text-center",children:["+",b.length-10," more responses"]})]})}function dK(a){let b=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899"];return b[a%b.length]}var dL=a.i(591137);function dM({sessionId:b,tutorId:c,totalStudents:d,className:e}){let[f,g]=(0,v.useState)("create"),[h,i]=(0,v.useState)(!1),{activePolls:j,draftPolls:k,closedPolls:l,isLoading:m,error:n,isConnected:o,createPoll:p,startPoll:q,endPoll:r,deletePoll:s}=function(b,c){let d=(0,v.useRef)(null),[e,f]=(0,v.useState)(!1),[g,h]=(0,v.useState)([]),[i,j]=(0,v.useState)(!0),[k,l]=(0,v.useState)(null);(0,v.useEffect)(()=>{if(b)return(async()=>{let e=await a.A(443374).then(a=>a.getSocketToken());if(!e)return;let g=(0,dL.io)("/api/socket",{path:"/api/socket",transports:["websocket","polling"],auth:{token:e}});d.current=g,g.on("connect",()=>{f(!0),c?.userId&&g.emit("join_class",{roomId:b,userId:c.userId,name:c.name||c.role,role:c.role}),g.emit("poll:join",{sessionId:b}),g.emit("poll:list",{sessionId:b},a=>{j(!1),a.success&&a.polls?h(a.polls):l(a.error||"Failed to load polls")})}),g.on("disconnect",()=>{f(!1)}),g.on("connect_error",a=>{l("Connection error: "+a.message),j(!1)})})(),()=>{d.current?.emit("poll:leave",{sessionId:b}),d.current?.disconnect(),d.current=null}},[b,c?.name,c?.role,c?.userId]),(0,v.useEffect)(()=>{let a=d.current;if(!a)return;let b=a=>{h(b=>[...b,a])},c=a=>{h(b=>b.map(b=>b.id===a.id?a:b))},e=a=>{h(b=>b.map(b=>b.id===a.id?{...b,status:"active",startedAt:new Date().toISOString()}:b))},f=a=>{h(b=>b.map(b=>b.id===a.id?{...b,status:"closed",endedAt:new Date().toISOString()}:b))},g=a=>{h(b=>b.filter(b=>b.id!==a))};return a.on("poll:created",b),a.on("poll:updated",c),a.on("poll:started",e),a.on("poll:ended",f),a.on("poll:deleted",g),()=>{a.off("poll:created",b),a.off("poll:updated",c),a.off("poll:started",e),a.off("poll:ended",f),a.off("poll:deleted",g)}},[]);let m=(0,v.useCallback)(a=>{d.current?.emit("poll:create",{sessionId:b,...a})},[b]),n=(0,v.useCallback)(a=>{d.current?.emit("poll:start",{pollId:a,sessionId:b})},[b]),o=(0,v.useCallback)(a=>{d.current?.emit("poll:end",{pollId:a,sessionId:b})},[b]),p=(0,v.useCallback)(a=>{d.current?.emit("poll:delete",{pollId:a,sessionId:b})},[b]),q=(0,v.useCallback)((a,c)=>{d.current?.emit("poll:vote",{pollId:a,sessionId:b,...c})},[b]),r=(0,v.useCallback)(()=>{d.current&&(j(!0),d.current.emit("poll:list",{sessionId:b},a=>{j(!1),a.success&&a.polls&&h(a.polls)}))},[b]),s=g.filter(a=>"active"===a.status),t=g.filter(a=>"draft"===a.status),u=g.filter(a=>"closed"===a.status);return{polls:g,activePolls:s,draftPolls:t,closedPolls:u,isLoading:i,error:k,isConnected:e,createPoll:m,startPoll:n,endPoll:o,deletePoll:p,submitVote:q,refreshPolls:r}}(b,{userId:c,role:"tutor",name:"Tutor"}),u=j[0],w=(0,v.useCallback)(a=>{p(a),i(!1),g("active")},[p]),x=(0,v.useCallback)(a=>{q(a),g("active")},[q]),B=(0,v.useCallback)(a=>{r(a),g("history")},[r]);return m?(0,t.jsx)("div",{className:(0,J.cn)("flex items-center justify-center h-64",e),children:(0,t.jsx)("div",{className:"animate-spin h-8 w-8 border-2 border-blue-600 border-t-transparent rounded-full"})}):n?(0,t.jsx)("div",{className:(0,J.cn)("flex items-center justify-center h-64 text-red-500",e),children:n}):(0,t.jsxs)("div",{className:(0,J.cn)("flex flex-col h-full bg-white rounded-lg border",e),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Quick Polls"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(z.Badge,{variant:o?"default":"secondary",children:o?"Connected":"Connecting..."}),j.length>0&&(0,t.jsxs)(z.Badge,{className:"bg-green-100 text-green-700 border-green-200",children:[j.length," Active"]}),k.length>0&&(0,t.jsxs)(z.Badge,{variant:"outline",className:"text-gray-600",children:[k.length," Draft"]})]})]}),(0,t.jsxs)(A.Tabs,{value:f,onValueChange:a=>g(a),className:"flex-1 flex flex-col",children:[!o&&(0,t.jsx)("div",{className:"px-4 pt-3 text-xs text-muted-foreground",children:"Waiting for poll socket connection. Creating or starting polls is disabled until connected."}),(0,t.jsxs)(A.TabsList,{className:"grid w-full grid-cols-3 rounded-none border-b bg-transparent p-0",children:[(0,t.jsx)(A.TabsTrigger,{value:"create",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-blue-600 data-[state=active]:bg-transparent data-[state=active]:shadow-none py-3",children:"Create"}),(0,t.jsxs)(A.TabsTrigger,{value:"active",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-blue-600 data-[state=active]:bg-transparent data-[state=active]:shadow-none py-3",children:["Active",j.length>0&&(0,t.jsx)("span",{className:"ml-2 w-5 h-5 rounded-full bg-blue-600 text-white text-xs flex items-center justify-center",children:j.length})]}),(0,t.jsxs)(A.TabsTrigger,{value:"history",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-blue-600 data-[state=active]:bg-transparent data-[state=active]:shadow-none py-3",children:["History",l.length>0&&(0,t.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(",l.length,")"]})]})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-4",children:[(0,t.jsx)(A.TabsContent,{value:"create",className:"mt-0 h-full",children:h?(0,t.jsx)(dr,{onSubmit:w,onCancel:()=>i(!1)}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(y.Button,{onClick:()=>i(!0),disabled:!o,className:"w-full h-16 text-lg gap-2",children:[(0,t.jsx)("span",{className:"text-2xl",children:"+"}),"Create New Poll"]}),k.length>0&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Draft Polls"}),k.map(a=>(0,t.jsx)(dN,{poll:a,onStart:()=>x(a.id),onDelete:()=>s(a.id)},a.id))]})]})}),(0,t.jsx)(A.TabsContent,{value:"active",className:"mt-0 h-full",children:u?(0,t.jsx)(dv,{poll:u,totalStudents:d,onEnd:()=>B(u.id)}):(0,t.jsx)(dO,{icon:"ðŸ“Š",title:"No Active Poll",description:"Create a poll to start collecting responses from students",action:{label:"Create Poll",onClick:()=>g("create")}})}),(0,t.jsx)(A.TabsContent,{value:"history",className:"mt-0 h-full",children:(0,t.jsx)(dE,{polls:l,onReuse:a=>{let{id:b,status:c,createdAt:d,startedAt:e,endedAt:f,responses:g,...h}=a;p({...h,options:h.options.map(a=>({label:a.label,text:a.text}))})},onDelete:s})})]})]})]})}function dN({poll:a,onStart:b,onDelete:c}){return(0,t.jsxs)("div",{className:"p-3 border rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors",children:[(0,t.jsx)("p",{className:"font-medium text-gray-900 line-clamp-2",children:a.question}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[a.type.replace("_"," ")," â€¢ ",a.options.length," options"]}),(0,t.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,t.jsx)(y.Button,{size:"sm",onClick:b,className:"flex-1",children:"Start Poll"}),(0,t.jsx)(y.Button,{size:"sm",variant:"ghost",onClick:c,className:"text-red-500 hover:text-red-600",children:"Delete"})]})]})}function dO({icon:a,title:b,description:c,action:d}){return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center p-4",children:[(0,t.jsx)("span",{className:"text-4xl mb-3",children:a}),(0,t.jsx)("h4",{className:"font-medium text-gray-900",children:b}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1 max-w-xs",children:c}),d&&(0,t.jsx)(y.Button,{onClick:d.onClick,className:"mt-4",children:d.label})]})}aE.HelpCircle,di.Gauge,a9.List,dj.Play,$.Brain,ap.MessageSquare,ag.Clock;let dP=(0,aa.default)("minimize-2",[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]]);function dQ({students:a,isOpen:b,onToggle:c,onSelectStudent:d,onSendNudge:e,onInviteToBreakout:f}){let[g,h]=(0,v.useState)("all"),[i,j]=(0,v.useState)("engagement"),[k,l]=(0,v.useState)(!0),m=(0,v.useMemo)(()=>{if(0===a.length)return null;let b=Math.round(a.reduce((a,b)=>a+b.engagementScore,0)/a.length),c=Math.round(a.reduce((a,b)=>a+b.comprehensionEstimate,0)/a.length),d=a.filter(a=>a.engagementScore<50||a.comprehensionEstimate<50).length,e=a.filter(a=>"away"===a.attentionLevel||"inactive"===a.attentionLevel).length;return{avgEngagement:b,avgComprehension:c,strugglingCount:d,inactiveCount:e,totalHandsRaised:a.filter(a=>a.raisedHand).length,totalMessages:a.reduce((a,b)=>a+b.chatMessages,0),classEnergy:b>75?"high":b>50?"moderate":"low"}},[a]),n=(0,v.useMemo)(()=>{let b=[...a];switch(g){case"struggling":b=b.filter(a=>a.engagementScore<50||a.comprehensionEstimate<50);break;case"inactive":b=b.filter(a=>"away"===a.attentionLevel||"inactive"===a.attentionLevel);break;case"engaged":b=b.filter(a=>a.engagementScore>=75&&"focused"===a.attentionLevel)}return b.sort((a,b)=>{switch(i){case"engagement":return b.engagementScore-a.engagementScore;case"attention":let c={focused:3,distracted:2,away:1,inactive:0};return c[b.attentionLevel]-c[a.attentionLevel];case"comprehension":return b.comprehensionEstimate-a.comprehensionEstimate;default:return 0}}),b},[a,g,i]),o=a=>{switch(a){case"focused":return"bg-green-500";case"distracted":return"bg-yellow-500";case"away":return"bg-orange-500";default:return"bg-gray-500"}},p=a=>a>=75?"text-green-500":a>=50?"text-yellow-500":"text-red-500",q=a=>a>=75?"bg-green-500":a>=50?"bg-yellow-500":"bg-red-500";return b?(0,t.jsxs)("div",{className:"w-[400px] bg-slate-900 border-l border-slate-700 flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-slate-700 bg-slate-800",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"bg-blue-600 p-2 rounded-lg",children:(0,t.jsx)(aW.Activity,{className:"h-5 w-5 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Live Engagement"}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Real-time student analytics"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(y.Button,{variant:"ghost",size:"icon",onClick:()=>l(!k),className:"h-8 w-8",children:k?(0,t.jsx)(ci.ChevronDown,{className:"h-4 w-4"}):(0,t.jsx)(dC.ChevronUp,{className:"h-4 w-4"})}),(0,t.jsx)(y.Button,{variant:"ghost",size:"icon",onClick:c,className:"h-8 w-8",children:(0,t.jsx)(dP,{className:"h-4 w-4"})})]})]}),m&&k&&(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,t.jsx)(F.Card,{className:"bg-slate-700 border-slate-600",children:(0,t.jsxs)(F.CardContent,{className:"p-2 text-center",children:[(0,t.jsxs)("p",{className:(0,J.cn)("text-xl font-bold",p(m.avgEngagement)),children:[m.avgEngagement,"%"]}),(0,t.jsx)("p",{className:"text-[10px] text-slate-400",children:"Avg Engagement"})]})}),(0,t.jsx)(F.Card,{className:"bg-slate-700 border-slate-600",children:(0,t.jsxs)(F.CardContent,{className:"p-2 text-center",children:[(0,t.jsx)("p",{className:"text-xl font-bold text-blue-400",children:m.totalHandsRaised}),(0,t.jsx)("p",{className:"text-[10px] text-slate-400",children:"Hands Raised"})]})}),(0,t.jsx)(F.Card,{className:"bg-slate-700 border-slate-600",children:(0,t.jsxs)(F.CardContent,{className:"p-2 text-center",children:[(0,t.jsx)("p",{className:(0,J.cn)("text-xl font-bold",m.strugglingCount>0?"text-red-400":"text-green-400"),children:m.strugglingCount}),(0,t.jsx)("p",{className:"text-[10px] text-slate-400",children:"Need Help"})]})})]})]}),(0,t.jsxs)("div",{className:"px-4 py-2 border-b border-slate-700 bg-slate-800/50",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(S.Filter,{className:"h-3 w-3 text-slate-400"}),(0,t.jsx)("div",{className:"flex gap-1 flex-wrap",children:["all","struggling","inactive","engaged"].map(a=>(0,t.jsx)("button",{onClick:()=>h(a),className:(0,J.cn)("px-2 py-0.5 text-[10px] rounded-full transition-colors capitalize",g===a?"bg-blue-600 text-white":"bg-slate-700 text-slate-400 hover:bg-slate-600"),children:a},a))})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,t.jsx)("span",{className:"text-[10px] text-slate-500",children:"Sort:"}),(0,t.jsxs)("select",{value:i,onChange:a=>j(a.target.value),className:"text-[10px] bg-slate-700 border border-slate-600 rounded px-2 py-0.5 text-slate-300",children:[(0,t.jsx)("option",{value:"engagement",children:"Engagement"}),(0,t.jsx)("option",{value:"attention",children:"Attention"}),(0,t.jsx)("option",{value:"comprehension",children:"Comprehension"})]})]})]}),(0,t.jsx)(I.ScrollArea,{className:"flex-1",children:(0,t.jsx)("div",{className:"p-4 space-y-3",children:0===n.length?(0,t.jsx)("p",{className:"text-center text-slate-500 text-sm py-8",children:"No students match the current filter"}):n.map(a=>(0,t.jsx)(dR,{student:a,onSelect:()=>d?.(a.studentId),onNudge:()=>e?.(a.studentId),onInviteToBreakout:()=>f?.(a.studentId),getAttentionColor:o,getEngagementColor:p,getProgressColor:q},a.studentId))})}),(0,t.jsx)("div",{className:"p-3 border-t border-slate-700 bg-slate-800",children:(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[(0,t.jsxs)("span",{children:[a.length," students"]}),(0,t.jsxs)("span",{children:[m?.totalMessages||0," messages"]})]})})]}):(0,t.jsx)(an.TooltipProvider,{children:(0,t.jsxs)(an.Tooltip,{children:[(0,t.jsx)(an.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)(y.Button,{variant:"outline",size:"icon",onClick:c,className:"fixed right-4 top-20 z-40 bg-slate-800 border-slate-700 hover:bg-slate-700",children:[(0,t.jsx)(aW.Activity,{className:"h-4 w-4 text-blue-400"}),m&&m.strugglingCount>0&&(0,t.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full text-[10px] flex items-center justify-center",children:m.strugglingCount})]})}),(0,t.jsx)(an.TooltipContent,{children:(0,t.jsx)("p",{children:"Open Engagement Dashboard"})})]})})}function dR({student:a,onSelect:b,onNudge:c,onInviteToBreakout:d,getAttentionColor:e,getEngagementColor:f,getProgressColor:g}){var h;let i,[j,k]=(0,v.useState)(!1),l=a.engagementScore<50||a.comprehensionEstimate<50,m="away"===a.attentionLevel||"inactive"===a.attentionLevel;return(0,t.jsx)(F.Card,{className:(0,J.cn)("bg-slate-800 border-slate-700 cursor-pointer transition-all hover:border-slate-600",l&&"border-red-800/50 bg-red-900/10",m&&"opacity-70"),onClick:b,onMouseEnter:()=>k(!0),onMouseLeave:()=>k(!1),children:(0,t.jsxs)(F.CardContent,{className:"p-3",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white text-xs font-medium",children:a.name.charAt(0).toUpperCase()}),(0,t.jsx)("div",{className:(0,J.cn)("absolute -bottom-0.5 -right-0.5 w-3 h-3 rounded-full border-2 border-slate-800",e(a.attentionLevel))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-white",children:a.name}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-[10px] text-slate-400",children:[(0,t.jsx)("span",{className:"capitalize",children:a.attentionLevel}),(0,t.jsx)("span",{children:"â€¢"}),(0,t.jsxs)("span",{children:[a.timeInSession,"m in session"]})]})]})]}),a.raisedHand&&(0,t.jsxs)(z.Badge,{className:"bg-yellow-600 text-[10px] px-1.5 py-0",children:[(0,t.jsx)(L.Hand,{className:"h-3 w-3 mr-0.5"}),"Raised"]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-[10px] mb-1",children:[(0,t.jsxs)("span",{className:"text-slate-400 flex items-center gap-1",children:[(0,t.jsx)(aW.Activity,{className:"h-3 w-3"}),"Engagement"]}),(0,t.jsxs)("span",{className:(0,J.cn)("font-medium",f(a.engagementScore)),children:[a.engagementScore,"%"]})]}),(0,t.jsx)(cC.Progress,{value:a.engagementScore,className:"h-1 bg-slate-700",children:(0,t.jsx)("div",{className:(0,J.cn)("h-full transition-all",g(a.engagementScore)),style:{width:`${a.engagementScore}%`}})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-[10px] mb-1",children:[(0,t.jsxs)("span",{className:"text-slate-400 flex items-center gap-1",children:[(0,t.jsx)($.Brain,{className:"h-3 w-3"}),"Comprehension"]}),(0,t.jsxs)("span",{className:(0,J.cn)("font-medium",f(a.comprehensionEstimate)),children:[a.comprehensionEstimate,"%"]})]}),(0,t.jsx)(cC.Progress,{value:a.comprehensionEstimate,className:"h-1 bg-slate-700",children:(0,t.jsx)("div",{className:(0,J.cn)("h-full transition-all",g(a.comprehensionEstimate)),style:{width:`${a.comprehensionEstimate}%`}})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(an.TooltipProvider,{children:(0,t.jsxs)(an.Tooltip,{children:[(0,t.jsx)(an.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)("div",{className:"flex items-center gap-1 text-[10px] text-slate-400",children:[(0,t.jsx)(O.MessageCircle,{className:"h-3 w-3"}),a.chatMessages]})}),(0,t.jsx)(an.TooltipContent,{children:(0,t.jsx)("p",{children:"Chat messages"})})]})}),(0,t.jsx)(an.TooltipProvider,{children:(0,t.jsxs)(an.Tooltip,{children:[(0,t.jsx)(an.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)("div",{className:"flex items-center gap-1 text-[10px] text-slate-400",children:[(0,t.jsx)(bc.Eye,{className:"h-3 w-3"}),a.participationCount]})}),(0,t.jsx)(an.TooltipContent,{children:(0,t.jsx)("p",{children:"Recent interactions (5m)"})})]})}),a.struggleIndicators>0&&(0,t.jsx)(an.TooltipProvider,{children:(0,t.jsxs)(an.Tooltip,{children:[(0,t.jsx)(an.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)("div",{className:"flex items-center gap-1 text-[10px] text-red-400",children:[(0,t.jsx)(cA.AlertTriangle,{className:"h-3 w-3"}),a.struggleIndicators]})}),(0,t.jsx)(an.TooltipContent,{children:(0,t.jsx)("p",{children:"Struggle indicators detected"})})]})})]}),(0,t.jsx)("span",{className:"text-[10px] text-slate-500",children:(h=a.lastActivity,(i=Math.floor((Date.now()-new Date(h).getTime())/1e3))<60?"Just now":i<120?"1m ago":i<300?`${Math.floor(i/60)}m ago`:">5m ago")})]})]}),j&&(l||a.raisedHand)&&(0,t.jsxs)("div",{className:"flex gap-2 mt-3 pt-2 border-t border-slate-700",children:[l&&(0,t.jsx)(y.Button,{size:"sm",variant:"outline",className:"flex-1 h-7 text-[10px] border-yellow-600/50 text-yellow-400 hover:bg-yellow-600/10",onClick:a=>{a.stopPropagation(),c()},children:"Send Nudge"}),(0,t.jsx)(y.Button,{size:"sm",variant:"outline",className:"flex-1 h-7 text-[10px] border-blue-600/50 text-blue-400 hover:bg-blue-600/10",onClick:a=>{a.stopPropagation(),d()},children:"1:1 Session"})]})]})})}var dS=/[\\\/_+.#"@\[\(\{&]/,dT=/[\\\/_+.#"@\[\(\{&]/g,dU=/[\s-]/,dV=/[\s-]/g;function dW(a){return a.toLowerCase().replace(dV," ")}var dX=a.i(729563),dY=a.i(780444),dZ=a.i(828462),d$='[cmdk-group=""]',d_='[cmdk-group-items=""]',d0='[cmdk-item=""]',d1=`${d0}:not([aria-disabled="true"])`,d2="cmdk-item-select",d3="data-value",d4=(a,b,c)=>{var d;return d=a,function a(b,c,d,e,f,g,h){if(g===c.length)return f===b.length?1:.99;var i=`${f},${g}`;if(void 0!==h[i])return h[i];for(var j,k,l,m,n=e.charAt(g),o=d.indexOf(n,f),p=0;o>=0;)(j=a(b,c,d,e,o+1,g+1,h))>p&&(o===f?j*=1:dS.test(b.charAt(o-1))?(j*=.8,(l=b.slice(f,o-1).match(dT))&&f>0&&(j*=Math.pow(.999,l.length))):dU.test(b.charAt(o-1))?(j*=.9,(m=b.slice(f,o-1).match(dV))&&f>0&&(j*=Math.pow(.999,m.length))):(j*=.17,f>0&&(j*=Math.pow(.999,o-f))),b.charAt(o)!==c.charAt(g)&&(j*=.9999)),(j<.1&&d.charAt(o-1)===e.charAt(g+1)||e.charAt(g+1)===e.charAt(g)&&d.charAt(o-1)!==e.charAt(g))&&.1*(k=a(b,c,d,e,o+1,g+2,h))>j&&(j=.1*k),j>p&&(p=j),o=d.indexOf(n,o+1);return h[i]=p,p}(d=c&&c.length>0?`${d+" "+c.join(" ")}`:d,b,dW(d),dW(b),0,0,{})},d5=v.createContext(void 0),d6=v.createContext(void 0),d7=v.createContext(void 0),d8=v.forwardRef((a,b)=>{let c=ei(()=>{var b,c;return{search:"",value:null!=(c=null!=(b=a.value)?b:a.defaultValue)?c:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),d=ei(()=>new Set),e=ei(()=>new Map),f=ei(()=>new Map),g=ei(()=>new Set),h=eg(a),{label:i,children:j,value:k,onValueChange:l,filter:m,shouldFilter:n,loop:o,disablePointerSelection:p=!1,vimBindings:q=!0,...r}=a,s=(0,dZ.useId)(),t=(0,dZ.useId)(),u=(0,dZ.useId)(),w=v.useRef(null),x=el();eh(()=>{if(void 0!==k){let a=k.trim();c.current.value=a,y.emit()}},[k]),eh(()=>{x(6,E)},[]);let y=v.useMemo(()=>({subscribe:a=>(g.current.add(a),()=>g.current.delete(a)),snapshot:()=>c.current,setState:(a,b,d)=>{var e,f,g,i;if(!Object.is(c.current[a],b)){if(c.current[a]=b,"search"===a)D(),B(),x(1,C);else if("value"===a){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let a=document.getElementById(u);a?a.focus():null==(e=document.getElementById(s))||e.focus()}if(x(7,()=>{var a;c.current.selectedItemId=null==(a=F())?void 0:a.id,y.emit()}),d||x(5,E),(null==(f=h.current)?void 0:f.value)!==void 0){null==(i=(g=h.current).onValueChange)||i.call(g,null!=b?b:"");return}}y.emit()}},emit:()=>{g.current.forEach(a=>a())}}),[]),z=v.useMemo(()=>({value:(a,b,d)=>{var e;b!==(null==(e=f.current.get(a))?void 0:e.value)&&(f.current.set(a,{value:b,keywords:d}),c.current.filtered.items.set(a,A(b,d)),x(2,()=>{B(),y.emit()}))},item:(a,b)=>(d.current.add(a),b&&(e.current.has(b)?e.current.get(b).add(a):e.current.set(b,new Set([a]))),x(3,()=>{D(),B(),c.current.value||C(),y.emit()}),()=>{f.current.delete(a),d.current.delete(a),c.current.filtered.items.delete(a);let b=F();x(4,()=>{D(),(null==b?void 0:b.getAttribute("id"))===a&&C(),y.emit()})}),group:a=>(e.current.has(a)||e.current.set(a,new Set),()=>{f.current.delete(a),e.current.delete(a)}),filter:()=>h.current.shouldFilter,label:i||a["aria-label"],getDisablePointerSelection:()=>h.current.disablePointerSelection,listId:s,inputId:u,labelId:t,listInnerRef:w}),[]);function A(a,b){var d,e;let f=null!=(e=null==(d=h.current)?void 0:d.filter)?e:d4;return a?f(a,c.current.search,b):0}function B(){if(!c.current.search||!1===h.current.shouldFilter)return;let a=c.current.filtered.items,b=[];c.current.filtered.groups.forEach(c=>{let d=e.current.get(c),f=0;d.forEach(b=>{f=Math.max(a.get(b),f)}),b.push([c,f])});let d=w.current;G().sort((b,c)=>{var d,e;let f=b.getAttribute("id"),g=c.getAttribute("id");return(null!=(d=a.get(g))?d:0)-(null!=(e=a.get(f))?e:0)}).forEach(a=>{let b=a.closest(d_);b?b.appendChild(a.parentElement===b?a:a.closest(`${d_} > *`)):d.appendChild(a.parentElement===d?a:a.closest(`${d_} > *`))}),b.sort((a,b)=>b[1]-a[1]).forEach(a=>{var b;let c=null==(b=w.current)?void 0:b.querySelector(`${d$}[${d3}="${encodeURIComponent(a[0])}"]`);null==c||c.parentElement.appendChild(c)})}function C(){let a=G().find(a=>"true"!==a.getAttribute("aria-disabled")),b=null==a?void 0:a.getAttribute(d3);y.setState("value",b||void 0)}function D(){var a,b,g,i;if(!c.current.search||!1===h.current.shouldFilter){c.current.filtered.count=d.current.size;return}c.current.filtered.groups=new Set;let j=0;for(let e of d.current){let d=A(null!=(b=null==(a=f.current.get(e))?void 0:a.value)?b:"",null!=(i=null==(g=f.current.get(e))?void 0:g.keywords)?i:[]);c.current.filtered.items.set(e,d),d>0&&j++}for(let[a,b]of e.current)for(let d of b)if(c.current.filtered.items.get(d)>0){c.current.filtered.groups.add(a);break}c.current.filtered.count=j}function E(){var a,b,c;let d=F();d&&((null==(a=d.parentElement)?void 0:a.firstChild)===d&&(null==(c=null==(b=d.closest(d$))?void 0:b.querySelector('[cmdk-group-heading=""]'))||c.scrollIntoView({block:"nearest"})),d.scrollIntoView({block:"nearest"}))}function F(){var a;return null==(a=w.current)?void 0:a.querySelector(`${d0}[aria-selected="true"]`)}function G(){var a;return Array.from((null==(a=w.current)?void 0:a.querySelectorAll(d1))||[])}function H(a){let b=G()[a];b&&y.setState("value",b.getAttribute(d3))}function I(a){var b;let c=F(),d=G(),e=d.findIndex(a=>a===c),f=d[e+a];null!=(b=h.current)&&b.loop&&(f=e+a<0?d[d.length-1]:e+a===d.length?d[0]:d[e+a]),f&&y.setState("value",f.getAttribute(d3))}function J(a){let b=F(),c=null==b?void 0:b.closest(d$),d;for(;c&&!d;)d=null==(c=a>0?function(a,b){let c=a.nextElementSibling;for(;c;){if(c.matches(b))return c;c=c.nextElementSibling}}(c,d$):function(a,b){let c=a.previousElementSibling;for(;c;){if(c.matches(b))return c;c=c.previousElementSibling}}(c,d$))?void 0:c.querySelector(d1);d?y.setState("value",d.getAttribute(d3)):I(a)}let K=()=>H(G().length-1),L=a=>{a.preventDefault(),a.metaKey?K():a.altKey?J(1):I(1)},M=a=>{a.preventDefault(),a.metaKey?H(0):a.altKey?J(-1):I(-1)};return v.createElement(dY.Primitive.div,{ref:b,tabIndex:-1,...r,"cmdk-root":"",onKeyDown:a=>{var b;null==(b=r.onKeyDown)||b.call(r,a);let c=a.nativeEvent.isComposing||229===a.keyCode;if(!(a.defaultPrevented||c))switch(a.key){case"n":case"j":q&&a.ctrlKey&&L(a);break;case"ArrowDown":L(a);break;case"p":case"k":q&&a.ctrlKey&&M(a);break;case"ArrowUp":M(a);break;case"Home":a.preventDefault(),H(0);break;case"End":a.preventDefault(),K();break;case"Enter":{a.preventDefault();let b=F();if(b){let a=new Event(d2);b.dispatchEvent(a)}}}}},v.createElement("label",{"cmdk-label":"",htmlFor:z.inputId,id:z.labelId,style:en},i),em(a,a=>v.createElement(d6.Provider,{value:y},v.createElement(d5.Provider,{value:z},a))))}),d9=v.forwardRef((a,b)=>{var c,d;let e=(0,dZ.useId)(),f=v.useRef(null),g=v.useContext(d7),h=v.useContext(d5),i=eg(a),j=null!=(d=null==(c=i.current)?void 0:c.forceMount)?d:null==g?void 0:g.forceMount;eh(()=>{if(!j)return h.item(e,null==g?void 0:g.id)},[j]);let k=ek(e,f,[a.value,a.children,f],a.keywords),l=v.useContext(d6),m=ej(a=>a.value&&a.value===k.current),n=ej(a=>!!j||!1===h.filter()||!a.search||a.filtered.items.get(e)>0);function o(){var a,b;p(),null==(b=(a=i.current).onSelect)||b.call(a,k.current)}function p(){l.setState("value",k.current,!0)}if(v.useEffect(()=>{let b=f.current;if(!(!b||a.disabled))return b.addEventListener(d2,o),()=>b.removeEventListener(d2,o)},[n,a.onSelect,a.disabled]),!n)return null;let{disabled:q,value:r,onSelect:s,forceMount:t,keywords:u,...w}=a;return v.createElement(dY.Primitive.div,{ref:(0,cK.composeRefs)(f,b),...w,id:e,"cmdk-item":"",role:"option","aria-disabled":!!q,"aria-selected":!!m,"data-disabled":!!q,"data-selected":!!m,onPointerMove:q||h.getDisablePointerSelection()?void 0:p,onClick:q?void 0:o},a.children)}),ea=v.forwardRef((a,b)=>{let{heading:c,children:d,forceMount:e,...f}=a,g=(0,dZ.useId)(),h=v.useRef(null),i=v.useRef(null),j=(0,dZ.useId)(),k=v.useContext(d5),l=ej(a=>!!e||!1===k.filter()||!a.search||a.filtered.groups.has(g));eh(()=>k.group(g),[]),ek(g,h,[a.value,a.heading,i]);let m=v.useMemo(()=>({id:g,forceMount:e}),[e]);return v.createElement(dY.Primitive.div,{ref:(0,cK.composeRefs)(h,b),...f,"cmdk-group":"",role:"presentation",hidden:!l||void 0},c&&v.createElement("div",{ref:i,"cmdk-group-heading":"","aria-hidden":!0,id:j},c),em(a,a=>v.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":c?j:void 0},v.createElement(d7.Provider,{value:m},a))))}),eb=v.forwardRef((a,b)=>{let{alwaysRender:c,...d}=a,e=v.useRef(null),f=ej(a=>!a.search);return c||f?v.createElement(dY.Primitive.div,{ref:(0,cK.composeRefs)(e,b),...d,"cmdk-separator":"",role:"separator"}):null}),ec=v.forwardRef((a,b)=>{let{onValueChange:c,...d}=a,e=null!=a.value,f=v.useContext(d6),g=ej(a=>a.search),h=ej(a=>a.selectedItemId),i=v.useContext(d5);return v.useEffect(()=>{null!=a.value&&f.setState("search",a.value)},[a.value]),v.createElement(dY.Primitive.input,{ref:b,...d,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":i.listId,"aria-labelledby":i.labelId,"aria-activedescendant":h,id:i.inputId,type:"text",value:e?a.value:g,onChange:a=>{e||f.setState("search",a.target.value),null==c||c(a.target.value)}})}),ed=v.forwardRef((a,b)=>{let{children:c,label:d="Suggestions",...e}=a,f=v.useRef(null),g=v.useRef(null),h=ej(a=>a.selectedItemId),i=v.useContext(d5);return v.useEffect(()=>{if(g.current&&f.current){let a=g.current,b=f.current,c,d=new ResizeObserver(()=>{c=requestAnimationFrame(()=>{let c=a.offsetHeight;b.style.setProperty("--cmdk-list-height",c.toFixed(1)+"px")})});return d.observe(a),()=>{cancelAnimationFrame(c),d.unobserve(a)}}},[]),v.createElement(dY.Primitive.div,{ref:(0,cK.composeRefs)(f,b),...e,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":h,"aria-label":d,id:i.listId},em(a,a=>v.createElement("div",{ref:(0,cK.composeRefs)(g,i.listInnerRef),"cmdk-list-sizer":""},a)))}),ee=v.forwardRef((a,b)=>{let{open:c,onOpenChange:d,overlayClassName:e,contentClassName:f,container:g,...h}=a;return v.createElement(dX.Root,{open:c,onOpenChange:d},v.createElement(dX.Portal,{container:g},v.createElement(dX.Overlay,{"cmdk-overlay":"",className:e}),v.createElement(dX.Content,{"aria-label":a.label,"cmdk-dialog":"",className:f},v.createElement(d8,{ref:b,...h}))))}),ef=Object.assign(d8,{List:ed,Item:d9,Input:ec,Group:ea,Separator:eb,Dialog:ee,Empty:v.forwardRef((a,b)=>ej(a=>0===a.filtered.count)?v.createElement(dY.Primitive.div,{ref:b,...a,"cmdk-empty":"",role:"presentation"}):null),Loading:v.forwardRef((a,b)=>{let{progress:c,children:d,label:e="Loading...",...f}=a;return v.createElement(dY.Primitive.div,{ref:b,...f,"cmdk-loading":"",role:"progressbar","aria-valuenow":c,"aria-valuemin":0,"aria-valuemax":100,"aria-label":e},em(a,a=>v.createElement("div",{"aria-hidden":!0},a)))})});function eg(a){let b=v.useRef(a);return eh(()=>{b.current=a}),b}var eh=v.useEffect;function ei(a){let b=v.useRef();return void 0===b.current&&(b.current=a()),b}function ej(a){let b=v.useContext(d6),c=()=>a(b.snapshot());return v.useSyncExternalStore(b.subscribe,c,c)}function ek(a,b,c,d=[]){let e=v.useRef(),f=v.useContext(d5);return eh(()=>{var g;let h=(()=>{var a;for(let b of c){if("string"==typeof b)return b.trim();if("object"==typeof b&&"current"in b)return b.current?null==(a=b.current.textContent)?void 0:a.trim():e.current}})(),i=d.map(a=>a.trim());f.value(a,h,i),null==(g=b.current)||g.setAttribute(d3,h),e.current=h}),e}var el=()=>{let[a,b]=v.useState(),c=ei(()=>new Map);return eh(()=>{c.current.forEach(a=>a()),c.current=new Map},[a]),(a,d)=>{c.current.set(a,d),b({})}};function em({asChild:a,children:b},c){let d;return a&&v.isValidElement(b)?v.cloneElement("function"==typeof(d=b.type)?d(b.props):"render"in d?d.render(b.props):b,{ref:b.ref},c(b.props.children)):c(b)}var en={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};let eo=v.forwardRef(({className:a,...b},c)=>(0,t.jsx)(ef,{ref:c,className:(0,J.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a),...b}));eo.displayName=ef.displayName;let ep=({children:a,...b})=>(0,t.jsx)(B.Dialog,{...b,children:(0,t.jsx)(B.DialogContent,{className:"overflow-hidden p-0 shadow-lg",children:(0,t.jsx)(eo,{className:"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:a})})}),eq=v.forwardRef(({className:a,...b},c)=>(0,t.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,t.jsx)(R.Search,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,t.jsx)(ef.Input,{ref:c,className:(0,J.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",a),...b})]}));eq.displayName=ef.Input.displayName;let er=v.forwardRef(({className:a,...b},c)=>(0,t.jsx)(ef.List,{ref:c,className:(0,J.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",a),...b}));er.displayName=ef.List.displayName;let es=v.forwardRef((a,b)=>(0,t.jsx)(ef.Empty,{ref:b,className:"py-6 text-center text-sm",...a}));es.displayName=ef.Empty.displayName;let et=v.forwardRef(({className:a,...b},c)=>(0,t.jsx)(ef.Group,{ref:c,className:(0,J.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",a),...b}));et.displayName=ef.Group.displayName;let eu=v.forwardRef(({className:a,...b},c)=>(0,t.jsx)(ef.Separator,{ref:c,className:(0,J.cn)("-mx-1 h-px bg-border",a),...b}));eu.displayName=ef.Separator.displayName;let ev=v.forwardRef(({className:a,...b},c)=>(0,t.jsx)(ef.Item,{ref:c,className:(0,J.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...b}));ev.displayName=ef.Item.displayName;var ew=a.i(605398),ex=a.i(290385),ey=a.i(300052),ez=a.i(254919);function eA({isOpen:a,onClose:b,actions:c,recentActions:d=[],placeholder:e="Type a command or search..."}){let[f,g]=(0,v.useState)(""),[h,i]=(0,v.useState)(null);(0,v.useEffect)(()=>{a&&(g(""),i(null))},[a]);let j=(0,v.useMemo)(()=>{let a=c;if(h&&(a=a.filter(a=>a.category===h)),f){let b=f.toLowerCase();a=a.filter(a=>{let c=a.title.toLowerCase().includes(b),d=a.description?.toLowerCase().includes(b),e=a.keywords?.some(a=>a.toLowerCase().includes(b));return c||d||e})}return a},[c,f,h]),k=(0,v.useMemo)(()=>{let a={};return j.forEach(b=>{a[b.category]||(a[b.category]=[]),a[b.category].push(b)}),a},[j]),l=(0,v.useMemo)(()=>d.map(a=>c.find(b=>b.id===a)).filter(Boolean),[d,c]),m={media:{label:"Media Controls",icon:(0,t.jsx)(aw.Mic,{className:"h-4 w-4"})},classroom:{label:"Classroom Tools",icon:(0,t.jsx)(V.LayoutGrid,{className:"h-4 w-4"})},engagement:{label:"Student Engagement",icon:(0,t.jsx)(K.Users,{className:"h-4 w-4"})},session:{label:"Session Management",icon:(0,t.jsx)(ag.Clock,{className:"h-4 w-4"})},navigation:{label:"Navigation",icon:(0,t.jsx)(ew.Presentation,{className:"h-4 w-4"})},system:{label:"System",icon:(0,t.jsx)(ex.Settings,{className:"h-4 w-4"})}},n=(0,v.useCallback)(a=>{a.action(),b()},[b]);return(0,t.jsxs)(ep,{open:a,onOpenChange:b,children:[(0,t.jsx)(B.DialogTitle,{className:"sr-only",children:"Command Palette"}),(0,t.jsx)(eq,{placeholder:e,value:f,onValueChange:g}),(0,t.jsxs)(er,{children:[(0,t.jsx)(es,{className:"py-6 text-center text-sm text-slate-500",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,t.jsx)(R.Search,{className:"h-8 w-8 text-slate-400"}),(0,t.jsx)("p",{children:"No commands found"}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Try a different search term"})]})}),l.length>0&&!f&&!h&&(0,t.jsx)(et,{heading:"Recently Used",children:l.slice(0,5).map(a=>(0,t.jsx)(ev,{onSelect:()=>n(a),disabled:a.disabled,className:(0,J.cn)(a.disabled&&"opacity-50 cursor-not-allowed"),children:(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,t.jsx)("div",{className:"text-slate-400",children:a.icon}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-medium",children:a.title}),a.badge&&(0,t.jsx)(z.Badge,{variant:"secondary",className:"text-[10px] px-1 py-0",children:a.badge})]}),a.description&&(0,t.jsx)("p",{className:"text-xs text-slate-500",children:a.description})]}),a.shortcut&&(0,t.jsx)("kbd",{className:"text-xs bg-slate-700 px-2 py-0.5 rounded text-slate-300",children:a.shortcut})]})},a.id))}),!f&&!h&&(0,t.jsx)(et,{heading:"Categories",children:(0,t.jsx)("div",{className:"flex flex-wrap gap-2 p-2",children:Object.entries(m).map(([a,{label:b,icon:d}])=>{let e=c.filter(b=>b.category===a).length;return(0,t.jsxs)("button",{onClick:()=>i(a),className:"flex items-center gap-2 px-3 py-1.5 bg-slate-800 hover:bg-slate-700 rounded-lg text-sm transition-colors",children:[d,(0,t.jsx)("span",{className:"capitalize",children:b}),(0,t.jsxs)("span",{className:"text-xs text-slate-500",children:["(",e,")"]})]},a)})})}),h&&(0,t.jsx)(et,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between px-2 py-1",children:[(0,t.jsx)("button",{onClick:()=>i(null),className:"text-xs text-blue-400 hover:text-blue-300",children:"â† Back to all"}),(0,t.jsx)("span",{className:"text-xs text-slate-500",children:m[h]?.label})]})}),(0,t.jsx)(eu,{}),Object.entries(k).map(([a,b])=>(0,t.jsx)(et,{heading:m[a]?.label||a,children:b.map(a=>(0,t.jsx)(ev,{onSelect:()=>n(a),disabled:a.disabled,className:(0,J.cn)(a.disabled&&"opacity-50 cursor-not-allowed"),children:(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,t.jsx)("div",{className:"text-slate-400",children:a.icon}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-medium",children:a.title}),a.badge&&(0,t.jsx)(z.Badge,{variant:"secondary",className:"text-[10px] px-1 py-0",children:a.badge})]}),a.description&&(0,t.jsx)("p",{className:"text-xs text-slate-500",children:a.description})]}),a.shortcut&&(0,t.jsx)("kbd",{className:"text-xs bg-slate-700 px-2 py-0.5 rounded text-slate-300",children:a.shortcut})]})},a.id))},a)),(0,t.jsx)(eu,{}),(0,t.jsxs)("div",{className:"px-3 py-2 text-xs text-slate-500 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)("kbd",{className:"bg-slate-700 px-1.5 rounded",children:"â†‘â†“"}),(0,t.jsx)("span",{children:"Navigate"})]}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)("kbd",{className:"bg-slate-700 px-1.5 rounded",children:"â†µ"}),(0,t.jsx)("span",{children:"Select"})]}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)("kbd",{className:"bg-slate-700 px-1.5 rounded",children:"esc"}),(0,t.jsx)("span",{children:"Close"})]})]}),(0,t.jsxs)("span",{children:[j.length," commands"]})]})]})]})}var eB=a.i(957512);let eC=(0,aa.default)("chart-no-axes-column",[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]]),eD=(0,aa.default)("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]]),eE=(0,aa.default)("command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]);var eF=a.i(405275);function eG({sessionId:a}){let b=(0,u.useRouter)(),{data:c}=(0,w.useSession)(),[d]=(0,v.useState)(()=>Date.now()),e=(0,v.useCallback)(a=>{l(b=>b.some(b=>b.id===a.userId)?b:[...b,{id:a.userId,name:a.name,status:"online",engagementScore:a.engagement??80,handRaised:!1,attentionLevel:a.engagement>=70?"high":a.engagement>=40?"medium":"low",lastActive:new Date(a.lastActivity??Date.now()).toISOString(),joinedAt:new Date(a.joinedAt??Date.now()).toISOString(),reactions:0,chatMessages:0}])},[]),f=(0,v.useCallback)(a=>{l(b=>b.filter(b=>b.id!==a))},[]),g=c?.user?.id?{roomId:a,userId:c.user.id,name:c.user?.name||"Tutor",role:"tutor",tutorId:c.user.id,onStudentJoined:e,onStudentLeft:f}:void 0,{socket:h}=(0,x.useSocket)(g),[i,j]=(0,v.useState)(!0),[k,l]=(0,v.useState)([]),[m,n]=(0,v.useState)([]),[o,p]=(0,v.useState)([]),[q,r]=(0,v.useState)([]),[s,F]=(0,v.useState)(null),[G,H]=(0,v.useState)([]),[I,J]=(0,v.useState)("Live Class"),[M,O]=(0,v.useState)("General"),[P,R]=(0,v.useState)(null),[S,T]=(0,v.useState)(null),[X,Y]=(0,v.useState)(!1),[Z,$]=(0,v.useState)(!1),[_,aa]=(0,v.useState)(!1),[ab,ac]=(0,v.useState)(!1),[ad,ae]=(0,v.useState)(0),[af,ag]=(0,v.useState)(!1),[ah,ai]=(0,v.useState)(!1),[aj,ak]=(0,v.useState)(!1),[al,am]=(0,v.useState)("students"),[an,ao]=(0,v.useState)(null),[ap,ar]=(0,v.useState)(!1),as=(0,v.useRef)(!1),at=`live-class-recording-notice:${a}`,au=(0,v.useRef)(null);(0,v.useEffect)(()=>{if(!ab)return void ae(0);let a=setInterval(()=>{ae(a=>a+1)},1e3);return()=>clearInterval(a)},[ab]);let{isOpen:aB,setIsOpen:aD}=function(a="cmd+k"){let[b,c]=(0,v.useState)(!1);return(0,v.useEffect)(()=>{let a=a=>{(navigator.platform.toUpperCase().indexOf("MAC")>=0?a.metaKey:a.ctrlKey)&&"k"===a.key.toLowerCase()&&(a.preventDefault(),c(a=>!a)),"Escape"===a.key&&c(!1)};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[]),{isOpen:b,setIsOpen:c}}("cmd+k");(0,v.useEffect)(()=>{if(!c?.user?.id)return;let d=c.user.id;if(au.current?.sessionId===a&&au.current?.userId===d)return;let e=!1;return au.current={sessionId:a,userId:d},(async()=>{j(!0);try{let b,c=await fetch("/api/csrf",{credentials:"include"}),d=await c.json().catch(()=>({})),f=d?.token??null;await fetch(`/api/tutor/classes/${a}`,{method:"POST",headers:{"Content-Type":"application/json",...f&&{"X-CSRF-Token":f}},credentials:"include"});let g=await fetch(`/api/tutor/classes/${a}`,{credentials:"include"});if(!g.ok){let a=await g.text().catch(()=>"");throw Error(a||`Failed to load class (${g.status})`)}let h=await g.json();if(e)return;J(h.session.title||"Live Class"),O(h.session.subject||"General"),R(h.session.roomId||null),T(h.session.linkedCourseId||null),l(h.students||[]),n([]),p((h.students||[]).filter(a=>a.handRaised).map(a=>({id:`hand-${a.id}`,studentId:a.id,studentName:a.name,priority:"normal",raisedAt:a.lastActive||new Date().toISOString(),status:"pending"}))),r(h.messages||[]),F(h.metrics||{totalStudents:(b=h.students||[]).length,activeStudents:b.filter(a=>"online"===a.status).length,averageEngagement:Math.round(b.filter(a=>"online"===a.status).reduce((a,b)=>a+b.engagementScore,0)/Math.max(1,b.filter(a=>"online"===a.status).length)),participationRate:0,totalChatMessages:b.reduce((a,b)=>a+b.chatMessages,0),classDuration:0,classStartTime:new Date().toISOString(),veryEngaged:b.filter(a=>a.engagementScore>=85).length,engaged:b.filter(a=>a.engagementScore>=60&&a.engagementScore<85).length,passive:b.filter(a=>a.engagementScore>=30&&a.engagementScore<60).length,disengaged:b.filter(a=>a.engagementScore<30).length,engagementTrend:"stable"}),H(h.alerts||[])}catch(a){au.current=null,e||(E.toast.error(a instanceof Error?a.message:"Failed to load live class session"),b.push("/tutor/live-class"))}finally{e||j(!1)}})(),()=>{e=!0}},[c?.user?.id,a,b]);let aE=(0,v.useMemo)(()=>k.map(a=>{let b;switch(a.attentionLevel){case"high":b="focused";break;case"medium":b="distracted";break;default:b="idle"===a.status?"away":"inactive"}return{studentId:a.id,name:a.name,engagementScore:a.engagementScore,attentionLevel:b,participationCount:a.reactions+a.chatMessages,comprehensionEstimate:a.engagementScore,lastActivity:new Date(a.lastActive),raisedHand:a.handRaised,chatMessages:a.chatMessages,whiteboardInteractions:0,timeInSession:Math.floor((d-new Date(a.joinedAt).getTime())/6e4),struggleIndicators:2*(a.engagementScore<50)}}),[k,d]),aG=(0,v.useCallback)(async b=>{let c=b?null:P;await fetch(`/api/tutor/live-sessions/${a}/recording`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({isRecording:b,recordingUrl:c})})},[P,a]),aH=(0,v.useCallback)(async()=>{if(!(await fetch(`/api/tutor/live-sessions/${a}/replay-artifact/generate`,{method:"POST",credentials:"include"})).ok)throw Error("Replay artifact generation failed")},[a]),aI=(0,v.useCallback)(async()=>{try{if(ab){ac(!1),await aG(!1),E.toast.success("Recording stopped. Building transcript and AI lesson summary..."),await aH(),E.toast.success("Replay artifact ready");return}ac(!0),ae(0),await aG(!0),E.toast.success("Recording started")}catch(a){ac(!1),ae(0),E.toast.error(a instanceof Error?a.message:"Recording action failed")}},[aH,ab,aG]),aJ=(0,v.useMemo)(()=>{var a;return[{id:"toggle-audio",title:(a={isAudioEnabled:!X,isVideoEnabled:!Z,isScreenSharing:_,isRecording:ab,studentsRaisingHands:o.filter(a=>"pending"===a.status).length,onToggleAudio:()=>{Y(!X),E.toast.success(X?"Microphone unmuted":"Microphone muted")},onToggleVideo:()=>{$(!Z),E.toast.success(Z?"Video started":"Video stopped")},onToggleScreenShare:()=>{aa(!_),E.toast.success(_?"Screen sharing stopped":"Screen sharing started")},onToggleRecording:()=>{aI()},onMuteAll:()=>{E.toast.success("All students muted")},onCallAttention:()=>{E.toast.success("Attention request sent to all students")},onOpenWhiteboard:()=>{E.toast.info("Whiteboard opened")},onOpenBreakouts:()=>{E.toast.info("Navigate to Rooms tab for breakout management")},onOpenEngagement:()=>{ag(!0),E.toast.success("Engagement Dashboard opened")},onOpenPolls:()=>{E.toast.info("Navigate to Polls tab to create polls")},onSendBroadcast:()=>{E.toast.info("Use Chat Monitor to send messages")},onLeaveClass:()=>{ai(!0)}}).isAudioEnabled?"Mute Microphone":"Unmute Microphone",description:a.isAudioEnabled?"Turn off your microphone":"Turn on your microphone",icon:a.isAudioEnabled?(0,t.jsx)(aw.Mic,{className:"h-4 w-4"}):(0,t.jsx)(N.MicOff,{className:"h-4 w-4"}),shortcut:"âŒ˜M",keywords:["mute","unmute","mic","audio"],category:"media",action:a.onToggleAudio},{id:"toggle-video",title:a.isVideoEnabled?"Stop Video":"Start Video",description:a.isVideoEnabled?"Turn off your camera":"Turn on your camera",icon:a.isVideoEnabled?(0,t.jsx)(ax.Video,{className:"h-4 w-4"}):(0,t.jsx)(ay,{className:"h-4 w-4"}),shortcut:"âŒ˜V",keywords:["camera","video","on","off"],category:"media",action:a.onToggleVideo},{id:"toggle-screen",title:a.isScreenSharing?"Stop Screen Share":"Share Screen",description:a.isScreenSharing?"Stop sharing your screen":"Share your screen with students",icon:a.isScreenSharing?(0,t.jsx)(aA,{className:"h-4 w-4"}):(0,t.jsx)(az,{className:"h-4 w-4"}),shortcut:"âŒ˜S",keywords:["screen","share","present","display"],category:"media",action:a.onToggleScreenShare},{id:"open-whiteboard",title:"Open Whiteboard",description:"Launch the collaborative whiteboard",icon:(0,t.jsx)(V.LayoutGrid,{className:"h-4 w-4"}),keywords:["whiteboard","draw","sketch","board"],category:"classroom",action:a.onOpenWhiteboard},...a.onOpenPolls?[{id:"open-polls",title:"Create Quick Poll",description:"Launch an interactive poll for students",icon:(0,t.jsx)(aq.BarChart3,{className:"h-4 w-4"}),shortcut:"âŒ˜P",keywords:["poll","quiz","vote","question"],category:"classroom",action:a.onOpenPolls,badge:"New"}]:[],{id:"open-breakouts",title:"Manage Breakout Rooms",description:"Create and manage breakout sessions",icon:(0,t.jsx)(K.Users,{className:"h-4 w-4"}),keywords:["breakout","groups","rooms","small group"],category:"classroom",action:a.onOpenBreakouts},{id:"view-engagement",title:"View Engagement Dashboard",description:"See real-time student engagement analytics",icon:(0,t.jsx)(aq.BarChart3,{className:"h-4 w-4"}),keywords:["engagement","analytics","students","attention"],category:"engagement",action:a.onOpenEngagement},{id:"call-attention",title:"Call for Attention",description:"Send notification to all students to focus",icon:(0,t.jsx)(U.Bell,{className:"h-4 w-4"}),keywords:["attention","focus","alert","notify"],category:"engagement",action:a.onCallAttention},{id:"mute-all",title:"Mute All Students",description:"Mute all student microphones",icon:(0,t.jsx)(ez.VolumeX,{className:"h-4 w-4"}),keywords:["mute","all","students","quiet"],category:"engagement",action:a.onMuteAll},{id:"send-broadcast",title:"Send Broadcast Message",description:"Send a message to all students",icon:(0,t.jsx)(aC.Send,{className:"h-4 w-4"}),shortcut:"âŒ˜B",keywords:["broadcast","message","announce","chat"],category:"engagement",action:a.onSendBroadcast},{id:"toggle-recording",title:a.isRecording?"Stop Recording":"Start Recording",description:a.isRecording?"Stop session recording":"Record this session",icon:a.isRecording?(0,t.jsx)(ey.Pause,{className:"h-4 w-4"}):(0,t.jsx)(dj.Play,{className:"h-4 w-4"}),keywords:["record","save","capture","video"],category:"session",action:a.onToggleRecording},{id:"leave-class",title:"Leave Classroom",description:"Exit the current session",icon:(0,t.jsx)(Q.LogOut,{className:"h-4 w-4"}),shortcut:"âŒ˜Q",keywords:["leave","exit","quit","end"],category:"system",action:a.onLeaveClass}]},[X,Z,_,ab,o,aI]),aK=(0,v.useCallback)(a=>{l(b=>b.map(b=>b.id===a?{...b,handRaised:!1}:b)),p(b=>b.map(b=>b.studentId===a?{...b,status:"answered"}:b))},[]),aM=(0,v.useCallback)(a=>{p(b=>b.map(b=>b.id===a?{...b,status:"acknowledged"}:b))},[]),aN=(0,v.useCallback)((a,b,c="socratic")=>{let d=k.find(b=>b.id===a);d&&E.toast.success(`Hint sent to ${d.name}`,{description:"socratic"===c?"Socratic hint delivered":"Encouragement sent"})},[k]),aO=(0,v.useCallback)(a=>{let b=k.find(b=>b.id===a);b&&E.toast.success(`Nudge sent to ${b.name}`,{description:"Remember to ask questions if you need help!"})},[k]),aP=(0,v.useCallback)(a=>{let b=k.find(b=>b.id===a);b&&E.toast.success(`${b.name} invited to breakout room`)},[k]),aQ=(0,v.useCallback)((a,b)=>{l(c=>c.map(c=>c.id===a?{...c,breakoutRoomId:b}:c)),n(c=>c.map(c=>{if(c.id===b){let b=k.find(b=>b.id===a);if(b&&!c.participants.find(b=>b.userId===a)){let a={id:b.id,userId:b.id,name:b.name,role:"student",joinedAt:new Date().toISOString(),isOnline:"online"===b.status,isMuted:!1,isVideoOff:!1,isScreenSharing:!1,engagementScore:b.engagementScore,attentionLevel:b.attentionLevel,handRaised:b.handRaised};return{...c,participants:[...c.participants,a]}}}return c}))},[k]),aS=(0,v.useCallback)(a=>{l(b=>b.map(b=>b.id===a?{...b,breakoutRoomId:void 0}:b)),n(b=>b.map(b=>({...b,participants:b.participants.filter(b=>b.userId!==a)})))},[]),aU=(0,v.useCallback)(a=>{ao(a),ar(!0)},[]),aV=(0,v.useCallback)(()=>{ar(!1),ao(null)},[]),aW=(0,v.useCallback)(a=>{n(b=>b.map(b=>b.id===a?{...b,status:"closed"}:b)),l(b=>b.map(b=>b.breakoutRoomId===a?{...b,breakoutRoomId:void 0}:b)),E.toast.success("Breakout room ended")},[]),aX=(0,v.useCallback)((a,b)=>{E.toast.success(`Extended room time by ${b} minutes`)},[]),aZ=(0,v.useCallback)(a=>{r(b=>b.map(b=>b.id===a?{...b,isPinned:!b.isPinned}:b))},[]),a$=(0,v.useCallback)(async()=>{if(ab)try{await aG(!1),await aH()}catch{}b.push("/tutor/dashboard")},[aH,ab,aG,b]),a_=(0,v.useCallback)(()=>{ak(!1)},[at]);if((0,v.useEffect)(()=>{i||as.current||(as.current=!0,ak(!0),aI())},[aI,i,at]),i)return(0,t.jsx)("div",{className:"h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading live session..."})]})});let a0=k.filter(a=>"online"===a.status).length,a1=o.filter(a=>"pending"===a.status).length,a2=k.filter(a=>a.engagementScore<50).length;return(0,t.jsxs)("div",{className:"h-screen flex flex-col bg-gray-50",children:[(0,t.jsxs)("header",{className:"bg-white border-b px-4 py-3 flex items-center justify-between shrink-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(y.Button,{variant:"ghost",size:"icon",onClick:()=>b.back(),children:(0,t.jsx)(dl.ArrowLeft,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"font-semibold text-lg",children:I}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Live"]}),(0,t.jsx)("span",{children:"â€¢"}),(0,t.jsxs)("span",{children:["Session ID: ",a]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(z.Badge,{variant:"secondary",className:"gap-1",children:[(0,t.jsx)(K.Users,{className:"w-3 h-3"}),a0,"/",k.length]}),a1>0&&(0,t.jsxs)(z.Badge,{variant:"destructive",className:"gap-1",children:[(0,t.jsx)(L.Hand,{className:"w-3 h-3"}),a1]}),a2>0&&(0,t.jsxs)(z.Badge,{variant:"outline",className:"gap-1 border-orange-400 text-orange-600",children:[(0,t.jsx)(aT.TrendingUp,{className:"w-3 h-3"}),a2," struggling"]})]}),(0,t.jsx)(C.Separator,{orientation:"vertical",className:"h-6"}),(0,t.jsxs)(D.DropdownMenu,{children:[(0,t.jsx)(D.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(y.Button,{variant:"outline",size:"sm",className:"gap-1",children:[(0,t.jsx)(eD,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Tools"}),(0,t.jsx)(ch.ChevronRight,{className:"h-3 w-3 opacity-80 rotate-90"})]})}),(0,t.jsxs)(D.DropdownMenuContent,{align:"end",className:"w-48",children:[(0,t.jsxs)(D.DropdownMenuItem,{onClick:()=>aD(!0),className:"gap-2",children:[(0,t.jsx)(eE,{className:"h-4 w-4"}),"Command Palette",(0,t.jsx)("kbd",{className:"ml-auto text-[10px] bg-muted px-1 rounded",children:"âŒ˜K"})]}),(0,t.jsxs)(D.DropdownMenuItem,{onClick:()=>ag(!af),className:"gap-2",children:[(0,t.jsx)(aq.BarChart3,{className:"h-4 w-4"}),"Engagement Dashboard",af&&(0,t.jsx)("span",{className:"ml-auto text-green-600",children:"âœ“"})]})]})]}),(0,t.jsx)(C.Separator,{orientation:"vertical",className:"h-6"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(y.Button,{variant:X?"destructive":"outline",size:"icon",onClick:()=>Y(!X),children:X?(0,t.jsx)(N.MicOff,{className:"w-4 h-4"}):(0,t.jsx)(aw.Mic,{className:"w-4 h-4"})}),(0,t.jsx)(y.Button,{variant:Z?"destructive":"outline",size:"icon",onClick:()=>$(!Z),children:Z?(0,t.jsx)(ay,{className:"w-4 h-4"}):(0,t.jsx)(ax.Video,{className:"w-4 h-4"})}),(0,t.jsx)(y.Button,{variant:_?"default":"outline",size:"icon",onClick:()=>aa(!_),children:(0,t.jsx)(az,{className:"w-4 h-4"})}),(0,t.jsxs)(y.Button,{variant:ab?"destructive":"outline",size:"sm",className:"gap-2",onClick:()=>void aI(),children:[(0,t.jsx)(eB.Radio,{className:ab?"w-4 h-4 animate-pulse":"w-4 h-4"}),ab?"Stop Recording":"Start Recording"]}),ab&&(0,t.jsxs)(z.Badge,{variant:"destructive",className:"gap-1",children:["REC ",Math.floor(ad/60),"m ",String(ad%60).padStart(2,"0"),"s"]})]}),(0,t.jsx)(C.Separator,{orientation:"vertical",className:"h-6"}),(0,t.jsxs)(y.Button,{variant:"destructive",className:"gap-2",onClick:()=>ai(!0),children:[(0,t.jsx)(Q.LogOut,{className:"w-4 h-4"}),"End Class"]})]})]}),(0,t.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,t.jsx)("div",{className:"flex-1 p-4 overflow-hidden",children:(0,t.jsxs)(A.Tabs,{value:al,onValueChange:am,className:"h-full flex flex-col",children:[(0,t.jsx)("div",{className:"w-full overflow-x-auto pb-1",children:(0,t.jsxs)(A.TabsList,{className:"inline-flex min-w-max bg-muted p-1 rounded-lg gap-1",children:[(0,t.jsxs)(A.TabsTrigger,{value:"students",onClick:()=>am("students"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,t.jsx)(K.Users,{className:"w-3 h-3"}),"Students"]}),(0,t.jsxs)(A.TabsTrigger,{value:"progress",onClick:()=>am("progress"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,t.jsx)(aT.TrendingUp,{className:"w-3 h-3"}),"Progress"]}),(0,t.jsxs)(A.TabsTrigger,{value:"rooms",onClick:()=>am("rooms"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,t.jsx)(V.LayoutGrid,{className:"w-3 h-3"}),"Rooms"]}),(0,t.jsxs)(A.TabsTrigger,{value:"polls",onClick:()=>am("polls"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,t.jsx)(eC,{className:"w-3 h-3"}),"Polls"]}),(0,t.jsxs)(A.TabsTrigger,{value:"whiteboard",onClick:()=>am("whiteboard"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,t.jsx)(eD,{className:"w-3 h-3"}),"Whiteboard"]}),(0,t.jsxs)(A.TabsTrigger,{value:"math",onClick:()=>am("math"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,t.jsx)(eF.Calculator,{className:"w-3 h-3"}),"Math"]}),(0,t.jsxs)(A.TabsTrigger,{value:"course-dev",onClick:()=>am("course-dev"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,t.jsx)(a6.GraduationCap,{className:"w-3 h-3"}),"Course Dev"]}),(0,t.jsxs)(A.TabsTrigger,{value:"analytics",onClick:()=>am("analytics"),className:"gap-1 data-[state=active]:bg-white data-[state=active]:shadow-sm text-xs whitespace-nowrap",children:[(0,t.jsx)(aq.BarChart3,{className:"w-3 h-3"}),"Analytics"]})]})}),(0,t.jsx)(A.TabsContent,{value:"students",className:"flex-1 mt-4 overflow-hidden",children:(0,t.jsx)(W,{students:k,breakoutRooms:m,onCallOn:aK,onAssignToRoom:aQ,onRemoveFromRoom:aS,onPushHint:aN,onSendNudge:aO,onInviteToBreakout:aP})}),(0,t.jsx)(A.TabsContent,{value:"progress",className:"flex-1 mt-4 overflow-hidden",children:(0,t.jsx)(cF,{students:k,classDuration:s?.classDuration||0})}),(0,t.jsx)(A.TabsContent,{value:"rooms",className:"flex-1 mt-4 overflow-hidden",children:(0,t.jsx)(av,{sessionId:a,tutorId:c?.user?.id||"tutor-1",tutorName:c?.user?.name||"Tutor",students:k,onRoomsChange:n,onJoinRoom:aU})}),(0,t.jsx)(A.TabsContent,{value:"polls",className:"flex-1 mt-4 overflow-hidden",children:(0,t.jsx)(dM,{sessionId:a,tutorId:c?.user?.id||"tutor-1",totalStudents:k.length})}),(0,t.jsx)(A.TabsContent,{value:"whiteboard",className:"flex-1 mt-4 overflow-hidden",children:(0,t.jsx)(cG.MultiLayerWhiteboardInterface,{sessionId:a,roomId:P||a,initialCourseId:S,classSubject:M,students:k.map(a=>({id:a.id,name:a.name,status:a.status,engagement:a.engagementScore})),isSocketConnected:!!h})}),(0,t.jsx)(A.TabsContent,{value:"math",className:"flex-1 mt-4 overflow-hidden",children:(0,t.jsx)(cH.MathBoardHost,{sessionId:`math-${a}`,socket:h,userId:c?.user?.id,userName:c?.user?.name||"Tutor",role:"tutor",className:"h-full"})}),(0,t.jsx)(A.TabsContent,{value:"analytics",className:"flex-1 mt-4 overflow-hidden",children:(0,t.jsx)("div",{className:"h-full overflow-auto",children:s&&(0,t.jsx)(aY,{metrics:s,alerts:G})})}),(0,t.jsx)(A.TabsContent,{value:"course-dev",className:"flex-1 mt-4 overflow-hidden",children:(0,t.jsx)(cz,{roomId:a,students:k.map(a=>({id:a.id,name:a.name,userId:a.id,status:a.status}))})})]})}),(0,t.jsxs)("div",{className:"w-[400px] p-4 pl-0 flex flex-col gap-4 overflow-hidden",children:[(0,t.jsx)("div",{className:"h-[40%] min-h-0",children:(0,t.jsx)(cB,{students:k,metrics:s,classDuration:s?.classDuration||0,currentTopic:M})}),(0,t.jsx)("div",{className:"flex-1 min-h-0",children:(0,t.jsx)(aL,{handRaises:o,onAcknowledge:aM,onAnswer:a=>{let b=o.find(b=>b.id===a);b&&aK(b.studentId)}})}),(0,t.jsx)("div",{className:"flex-1 min-h-0",children:(0,t.jsx)(aR,{messages:q,students:k,socket:h,roomId:a,onPinMessage:aZ})})]}),af&&(0,t.jsx)("div",{className:"absolute right-4 top-20 w-96 z-50",children:(0,t.jsx)(dQ,{students:aE,isOpen:af,onToggle:()=>ag(!1),onSelectStudent:a=>{E.toast.info(`Selected student: ${a}`)},onSendNudge:aO,onInviteToBreakout:aP})})]}),(0,t.jsx)(aF,{room:an,isOpen:ap,onClose:aV,userId:c?.user?.id||"tutor-1",userName:c?.user?.name||"Tutor",role:"tutor",onEndRoom:aW,onExtendTime:aX}),(0,t.jsx)(eA,{isOpen:aB,onClose:()=>aD(!1),actions:aJ}),(0,t.jsx)(B.Dialog,{open:ah,onOpenChange:ai,children:(0,t.jsxs)(B.DialogContent,{children:[(0,t.jsxs)(B.DialogHeader,{children:[(0,t.jsx)(B.DialogTitle,{children:"End Class?"}),(0,t.jsx)(B.DialogDescription,{children:"Are you sure you want to end this live session? All students will be disconnected."})]}),(0,t.jsxs)(B.DialogFooter,{className:"gap-2",children:[(0,t.jsx)(y.Button,{variant:"outline",onClick:()=>ai(!1),children:"Cancel"}),(0,t.jsx)(y.Button,{variant:"destructive",onClick:a$,children:"End Class"})]})]})}),(0,t.jsx)(B.Dialog,{modal:!1,open:aj,onOpenChange:a=>{a||a_()},children:(0,t.jsxs)(B.DialogContent,{children:[(0,t.jsxs)(B.DialogHeader,{children:[(0,t.jsx)(B.DialogTitle,{children:"Class Recording Is On By Default"}),(0,t.jsx)(B.DialogDescription,{children:"This session is being recorded to generate a transcript, AI lesson summary, and replay artifact for quality review, student revision, and attendance/missed-lesson continuity."})]}),(0,t.jsx)(B.DialogFooter,{children:(0,t.jsx)(y.Button,{onClick:a_,children:"Understood"})})]})})]})}function eH(a,b){if(null==a)return{};var c,d,e=function(a,b){if(null==a)return{};var c={};for(var d in a)if(({}).hasOwnProperty.call(a,d)){if(-1!==b.indexOf(d))continue;c[d]=a[d]}return c}(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],-1===b.indexOf(c)&&({}).propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}function eI(a,b){if(!(a instanceof b))throw TypeError("Cannot call a class as a function")}function eJ(a){return(eJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function eK(a){var b=function(a,b){if("object"!=eJ(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=eJ(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return String(a)}(a,"string");return"symbol"==eJ(b)?b:b+""}function eL(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,eK(d.key),d)}}function eM(a,b,c){return b&&eL(a.prototype,b),c&&eL(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}function eN(a,b){if(b&&("object"==eJ(b)||"function"==typeof b))return b;if(void 0!==b)throw TypeError("Derived constructors may only return object or undefined");if(void 0===a)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function eO(a){return(eO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function eP(a,b){return(eP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a})(a,b)}function eQ(a,b){if("function"!=typeof b&&null!==b)throw TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),b&&eP(a,b)}function eR(a,b,c){return(b=eK(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function eS(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function eT(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){eS(f,d,e,g,h,"next",a)}function h(a){eS(f,d,e,g,h,"throw",a)}g(void 0)})}}function eU(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function eV(a,b){return function(a){if(Array.isArray(a))return a}(a)||function(a,b){var c=null==a?null:"u">typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(null!=c){var d,e,f,g,h=[],i=!0,j=!1;try{if(f=(c=c.call(a)).next,0===b){if(Object(c)!==c)return;i=!1}else for(;!(i=(d=f.call(c)).done)&&(h.push(d.value),h.length!==b);i=!0);}catch(a){j=!0,e=a}finally{try{if(!i&&null!=c.return&&(g=c.return(),Object(g)!==g))return}finally{if(j)throw e}}return h}}(a,b)||function(a,b){if(a){if("string"==typeof a)return eU(a,b);var c=({}).toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?eU(a,b):void 0}}(a,b)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var eW,eX={exports:{}},eY=function(){if(eW)return eX.exports;eW=1;var a,b="object"==typeof Reflect?Reflect:null,c=b&&"function"==typeof b.apply?b.apply:function(a,b,c){return Function.prototype.apply.call(a,b,c)};a=b&&"function"==typeof b.ownKeys?b.ownKeys:Object.getOwnPropertySymbols?function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))}:function(a){return Object.getOwnPropertyNames(a)};var d=Number.isNaN||function(a){return a!=a};function e(){e.init.call(this)}eX.exports=e,eX.exports.once=function(a,b){return new Promise(function(c,d){function e(c){a.removeListener(b,f),d(c)}function f(){"function"==typeof a.removeListener&&a.removeListener("error",e),c([].slice.call(arguments))}o(a,b,f,{once:!0}),"error"!==b&&"function"==typeof a.on&&o(a,"error",e,{once:!0})})},e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var f=10;function g(a){if("function"!=typeof a)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}function h(a){return void 0===a._maxListeners?e.defaultMaxListeners:a._maxListeners}function i(a,b,c,d){var e,f,i;if(g(c),void 0===(f=a._events)?(f=a._events=Object.create(null),a._eventsCount=0):(void 0!==f.newListener&&(a.emit("newListener",b,c.listener?c.listener:c),f=a._events),i=f[b]),void 0===i)i=f[b]=c,++a._eventsCount;else if("function"==typeof i?i=f[b]=d?[c,i]:[i,c]:d?i.unshift(c):i.push(c),(e=h(a))>0&&i.length>e&&!i.warned){i.warned=!0;var j=Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");j.name="MaxListenersExceededWarning",j.emitter=a,j.type=b,j.count=i.length,console&&console.warn&&console.warn(j)}return a}function j(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function k(a,b,c){var d={fired:!1,wrapFn:void 0,target:a,type:b,listener:c},e=j.bind(d);return e.listener=c,d.wrapFn=e,e}function l(a,b,c){var d=a._events;if(void 0===d)return[];var e=d[b];return void 0===e?[]:"function"==typeof e?c?[e.listener||e]:[e]:c?function(a){for(var b=Array(a.length),c=0;c<b.length;++c)b[c]=a[c].listener||a[c];return b}(e):n(e,e.length)}function m(a){var b=this._events;if(void 0!==b){var c=b[a];if("function"==typeof c)return 1;if(void 0!==c)return c.length}return 0}function n(a,b){for(var c=Array(b),d=0;d<b;++d)c[d]=a[d];return c}function o(a,b,c,d){if("function"==typeof a.on)d.once?a.once(b,c):a.on(b,c);else{if("function"!=typeof a.addEventListener)throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a);a.addEventListener(b,function e(f){d.once&&a.removeEventListener(b,e),c(f)})}}return Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(a){if("number"!=typeof a||a<0||d(a))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");f=a}}),e.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(a){if("number"!=typeof a||a<0||d(a))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+a+".");return this._maxListeners=a,this},e.prototype.getMaxListeners=function(){return h(this)},e.prototype.emit=function(a){for(var b=[],d=1;d<arguments.length;d++)b.push(arguments[d]);var e="error"===a,f=this._events;if(void 0!==f)e=e&&void 0===f.error;else if(!e)return!1;if(e){if(b.length>0&&(g=b[0]),g instanceof Error)throw g;var g,h=Error("Unhandled error."+(g?" ("+g.message+")":""));throw h.context=g,h}var i=f[a];if(void 0===i)return!1;if("function"==typeof i)c(i,this,b);else{var j=i.length,k=n(i,j);for(d=0;d<j;++d)c(k[d],this,b)}return!0},e.prototype.addListener=function(a,b){return i(this,a,b,!1)},e.prototype.on=e.prototype.addListener,e.prototype.prependListener=function(a,b){return i(this,a,b,!0)},e.prototype.once=function(a,b){return g(b),this.on(a,k(this,a,b)),this},e.prototype.prependOnceListener=function(a,b){return g(b),this.prependListener(a,k(this,a,b)),this},e.prototype.removeListener=function(a,b){var c,d,e,f,h;if(g(b),void 0===(d=this._events)||void 0===(c=d[a]))return this;if(c===b||c.listener===b)0==--this._eventsCount?this._events=Object.create(null):(delete d[a],d.removeListener&&this.emit("removeListener",a,c.listener||b));else if("function"!=typeof c){for(e=-1,f=c.length-1;f>=0;f--)if(c[f]===b||c[f].listener===b){h=c[f].listener,e=f;break}if(e<0)return this;0===e?c.shift():function(a,b){for(;b+1<a.length;b++)a[b]=a[b+1];a.pop()}(c,e),1===c.length&&(d[a]=c[0]),void 0!==d.removeListener&&this.emit("removeListener",a,h||b)}return this},e.prototype.off=e.prototype.removeListener,e.prototype.removeAllListeners=function(a){var b,c,d;if(void 0===(c=this._events))return this;if(void 0===c.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==c[a]&&(0==--this._eventsCount?this._events=Object.create(null):delete c[a]),this;if(0==arguments.length){var e,f=Object.keys(c);for(d=0;d<f.length;++d)"removeListener"!==(e=f[d])&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(b=c[a]))this.removeListener(a,b);else if(void 0!==b)for(d=b.length-1;d>=0;d--)this.removeListener(a,b[d]);return this},e.prototype.listeners=function(a){return l(this,a,!0)},e.prototype.rawListeners=function(a){return l(this,a,!1)},e.listenerCount=function(a,b){return"function"==typeof a.listenerCount?a.listenerCount(b):m.call(a,b)},e.prototype.listenerCount=m,e.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]},eX.exports}(),eZ=eY&&eY.__esModule&&Object.prototype.hasOwnProperty.call(eY,"default")?eY.default:eY,e$=Object.prototype.hasOwnProperty;function e_(a,b,c){for(c of a.keys())if(e0(c,b))return c}function e0(a,b){var c,d,e;if(a===b)return!0;if(a&&b&&(c=a.constructor)===b.constructor){if(c===Date)return a.getTime()===b.getTime();if(c===RegExp)return a.toString()===b.toString();if(c===Array){if((d=a.length)===b.length)for(;d--&&e0(a[d],b[d]););return -1===d}if(c===Set){if(a.size!==b.size)return!1;for(d of a)if((e=d)&&"object"==typeof e&&!(e=e_(b,e))||!b.has(e))return!1;return!0}if(c===Map){if(a.size!==b.size)return!1;for(d of a)if((e=d[0])&&"object"==typeof e&&!(e=e_(b,e))||!e0(d[1],b.get(e)))return!1;return!0}if(c===ArrayBuffer)a=new Uint8Array(a),b=new Uint8Array(b);else if(c===DataView){if((d=a.byteLength)===b.byteLength)for(;d--&&a.getInt8(d)===b.getInt8(d););return -1===d}if(ArrayBuffer.isView(a)){if((d=a.byteLength)===b.byteLength)for(;d--&&a[d]===b[d];);return -1===d}if(!c||"object"==typeof a){for(c in d=0,a)if(e$.call(a,c)&&++d&&!e$.call(b,c)||!(c in b)||!e0(a[c],b[c]))return!1;return Object.keys(b).length===d}}return a!=a&&b!=b}let e1={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},e2={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},e3={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},e4={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},e5={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class e6{static getFirstMatch(a,b){let c=b.match(a);return c&&c.length>0&&c[1]||""}static getSecondMatch(a,b){let c=b.match(a);return c&&c.length>1&&c[2]||""}static matchAndReturnConst(a,b,c){if(a.test(b))return c}static getWindowsVersionName(a){switch(a){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(a){let b=a.split(".").splice(0,2).map(a=>parseInt(a,10)||0);if(b.push(0),10===b[0])switch(b[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(a){let b=a.split(".").splice(0,2).map(a=>parseInt(a,10)||0);if(b.push(0),!(1===b[0]&&b[1]<5))return 1===b[0]&&b[1]<6?"Cupcake":1===b[0]&&b[1]>=6?"Donut":2===b[0]&&b[1]<2?"Eclair":2===b[0]&&2===b[1]?"Froyo":2===b[0]&&b[1]>2?"Gingerbread":3===b[0]?"Honeycomb":4===b[0]&&b[1]<1?"Ice Cream Sandwich":4===b[0]&&b[1]<4?"Jelly Bean":4===b[0]&&b[1]>=4?"KitKat":5===b[0]?"Lollipop":6===b[0]?"Marshmallow":7===b[0]?"Nougat":8===b[0]?"Oreo":9===b[0]?"Pie":void 0}static getVersionPrecision(a){return a.split(".").length}static compareVersions(a,b,c=!1){let d=e6.getVersionPrecision(a),e=e6.getVersionPrecision(b),f=Math.max(d,e),g=0,h=e6.map([a,b],a=>{let b=f-e6.getVersionPrecision(a),c=a+Array(b+1).join(".0");return e6.map(c.split("."),a=>Array(20-a.length).join("0")+a).reverse()});for(c&&(g=f-Math.min(d,e)),f-=1;f>=g;){if(h[0][f]>h[1][f])return 1;if(h[0][f]===h[1][f]){if(f===g)return 0;f-=1}else if(h[0][f]<h[1][f])return -1}}static map(a,b){let c,d=[];if(Array.prototype.map)return Array.prototype.map.call(a,b);for(c=0;c<a.length;c+=1)d.push(b(a[c]));return d}static find(a,b){let c,d;if(Array.prototype.find)return Array.prototype.find.call(a,b);for(c=0,d=a.length;c<d;c+=1){let d=a[c];if(b(d,c))return d}}static assign(a,...b){return Object.assign(a,...b)}static getBrowserAlias(a){return e1[a]}static getBrowserTypeByAlias(a){return e2[a]||""}}let e7=/version\/(\d+(\.?_?\d+)+)/i,e8=[{test:[/googlebot/i],describe(a){let b={name:"Googlebot"},c=e6.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,a)||e6.getFirstMatch(e7,a);return c&&(b.version=c),b}},{test:[/opera/i],describe(a){let b={name:"Opera"},c=e6.getFirstMatch(e7,a)||e6.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/opr\/|opios/i],describe(a){let b={name:"Opera"},c=e6.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,a)||e6.getFirstMatch(e7,a);return c&&(b.version=c),b}},{test:[/SamsungBrowser/i],describe(a){let b={name:"Samsung Internet for Android"},c=e6.getFirstMatch(e7,a)||e6.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/Whale/i],describe(a){let b={name:"NAVER Whale Browser"},c=e6.getFirstMatch(e7,a)||e6.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/MZBrowser/i],describe(a){let b={name:"MZ Browser"},c=e6.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,a)||e6.getFirstMatch(e7,a);return c&&(b.version=c),b}},{test:[/focus/i],describe(a){let b={name:"Focus"},c=e6.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,a)||e6.getFirstMatch(e7,a);return c&&(b.version=c),b}},{test:[/swing/i],describe(a){let b={name:"Swing"},c=e6.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,a)||e6.getFirstMatch(e7,a);return c&&(b.version=c),b}},{test:[/coast/i],describe(a){let b={name:"Opera Coast"},c=e6.getFirstMatch(e7,a)||e6.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(a){let b={name:"Opera Touch"},c=e6.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,a)||e6.getFirstMatch(e7,a);return c&&(b.version=c),b}},{test:[/yabrowser/i],describe(a){let b={name:"Yandex Browser"},c=e6.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,a)||e6.getFirstMatch(e7,a);return c&&(b.version=c),b}},{test:[/ucbrowser/i],describe(a){let b={name:"UC Browser"},c=e6.getFirstMatch(e7,a)||e6.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/Maxthon|mxios/i],describe(a){let b={name:"Maxthon"},c=e6.getFirstMatch(e7,a)||e6.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/epiphany/i],describe(a){let b={name:"Epiphany"},c=e6.getFirstMatch(e7,a)||e6.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/puffin/i],describe(a){let b={name:"Puffin"},c=e6.getFirstMatch(e7,a)||e6.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/sleipnir/i],describe(a){let b={name:"Sleipnir"},c=e6.getFirstMatch(e7,a)||e6.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/k-meleon/i],describe(a){let b={name:"K-Meleon"},c=e6.getFirstMatch(e7,a)||e6.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/micromessenger/i],describe(a){let b={name:"WeChat"},c=e6.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,a)||e6.getFirstMatch(e7,a);return c&&(b.version=c),b}},{test:[/qqbrowser/i],describe(a){let b={name:/qqbrowserlite/i.test(a)?"QQ Browser Lite":"QQ Browser"},c=e6.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,a)||e6.getFirstMatch(e7,a);return c&&(b.version=c),b}},{test:[/msie|trident/i],describe(a){let b={name:"Internet Explorer"},c=e6.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/\sedg\//i],describe(a){let b={name:"Microsoft Edge"},c=e6.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/edg([ea]|ios)/i],describe(a){let b={name:"Microsoft Edge"},c=e6.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/vivaldi/i],describe(a){let b={name:"Vivaldi"},c=e6.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/seamonkey/i],describe(a){let b={name:"SeaMonkey"},c=e6.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/sailfish/i],describe(a){let b={name:"Sailfish"},c=e6.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,a);return c&&(b.version=c),b}},{test:[/silk/i],describe(a){let b={name:"Amazon Silk"},c=e6.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/phantom/i],describe(a){let b={name:"PhantomJS"},c=e6.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/slimerjs/i],describe(a){let b={name:"SlimerJS"},c=e6.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(a){let b={name:"BlackBerry"},c=e6.getFirstMatch(e7,a)||e6.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/(web|hpw)[o0]s/i],describe(a){let b={name:"WebOS Browser"},c=e6.getFirstMatch(e7,a)||e6.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/bada/i],describe(a){let b={name:"Bada"},c=e6.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/tizen/i],describe(a){let b={name:"Tizen"},c=e6.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,a)||e6.getFirstMatch(e7,a);return c&&(b.version=c),b}},{test:[/qupzilla/i],describe(a){let b={name:"QupZilla"},c=e6.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,a)||e6.getFirstMatch(e7,a);return c&&(b.version=c),b}},{test:[/firefox|iceweasel|fxios/i],describe(a){let b={name:"Firefox"},c=e6.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/electron/i],describe(a){let b={name:"Electron"},c=e6.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/MiuiBrowser/i],describe(a){let b={name:"Miui"},c=e6.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/chromium/i],describe(a){let b={name:"Chromium"},c=e6.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,a)||e6.getFirstMatch(e7,a);return c&&(b.version=c),b}},{test:[/chrome|crios|crmo/i],describe(a){let b={name:"Chrome"},c=e6.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/GSA/i],describe(a){let b={name:"Google Search"},c=e6.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test(a){let b=!a.test(/like android/i),c=a.test(/android/i);return b&&c},describe(a){let b={name:"Android Browser"},c=e6.getFirstMatch(e7,a);return c&&(b.version=c),b}},{test:[/playstation 4/i],describe(a){let b={name:"PlayStation 4"},c=e6.getFirstMatch(e7,a);return c&&(b.version=c),b}},{test:[/safari|applewebkit/i],describe(a){let b={name:"Safari"},c=e6.getFirstMatch(e7,a);return c&&(b.version=c),b}},{test:[/.*/i],describe(a){let b=-1!==a.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:e6.getFirstMatch(b,a),version:e6.getSecondMatch(b,a)}}}];var e9=[{test:[/Roku\/DVP/],describe(a){let b=e6.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,a);return{name:e4.Roku,version:b}}},{test:[/windows phone/i],describe(a){let b=e6.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,a);return{name:e4.WindowsPhone,version:b}}},{test:[/windows /i],describe(a){let b=e6.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,a),c=e6.getWindowsVersionName(b);return{name:e4.Windows,version:b,versionName:c}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(a){let b={name:e4.iOS},c=e6.getSecondMatch(/(Version\/)(\d[\d.]+)/,a);return c&&(b.version=c),b}},{test:[/macintosh/i],describe(a){let b=e6.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,a).replace(/[_\s]/g,"."),c=e6.getMacOSVersionName(b),d={name:e4.MacOS,version:b};return c&&(d.versionName=c),d}},{test:[/(ipod|iphone|ipad)/i],describe(a){let b=e6.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,a).replace(/[_\s]/g,".");return{name:e4.iOS,version:b}}},{test(a){let b=!a.test(/like android/i),c=a.test(/android/i);return b&&c},describe(a){let b=e6.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,a),c=e6.getAndroidVersionName(b),d={name:e4.Android,version:b};return c&&(d.versionName=c),d}},{test:[/(web|hpw)[o0]s/i],describe(a){let b=e6.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,a),c={name:e4.WebOS};return b&&b.length&&(c.version=b),c}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(a){let b=e6.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,a)||e6.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,a)||e6.getFirstMatch(/\bbb(\d+)/i,a);return{name:e4.BlackBerry,version:b}}},{test:[/bada/i],describe(a){let b=e6.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,a);return{name:e4.Bada,version:b}}},{test:[/tizen/i],describe(a){let b=e6.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,a);return{name:e4.Tizen,version:b}}},{test:[/linux/i],describe:()=>({name:e4.Linux})},{test:[/CrOS/],describe:()=>({name:e4.ChromeOS})},{test:[/PlayStation 4/],describe(a){let b=e6.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,a);return{name:e4.PlayStation4,version:b}}}],fa=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(a){let b=e6.getFirstMatch(/(can-l01)/i,a)&&"Nova",c={type:e3.mobile,vendor:"Huawei"};return b&&(c.model=b),c}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:e3.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:e3.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:()=>({type:e3.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:e3.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:e3.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:e3.tablet})},{test(a){let b=a.test(/ipod|iphone/i),c=a.test(/like (ipod|iphone)/i);return b&&!c},describe(a){let b=e6.getFirstMatch(/(ipod|iphone)/i,a);return{type:e3.mobile,vendor:"Apple",model:b}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:e3.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:e3.mobile})},{test:a=>"blackberry"===a.getBrowserName(!0),describe:()=>({type:e3.mobile,vendor:"BlackBerry"})},{test:a=>"bada"===a.getBrowserName(!0),describe:()=>({type:e3.mobile})},{test:a=>"windows phone"===a.getBrowserName(),describe:()=>({type:e3.mobile,vendor:"Microsoft"})},{test(a){let b=Number(String(a.getOSVersion()).split(".")[0]);return"android"===a.getOSName(!0)&&b>=3},describe:()=>({type:e3.tablet})},{test:a=>"android"===a.getOSName(!0),describe:()=>({type:e3.mobile})},{test:a=>"macos"===a.getOSName(!0),describe:()=>({type:e3.desktop,vendor:"Apple"})},{test:a=>"windows"===a.getOSName(!0),describe:()=>({type:e3.desktop})},{test:a=>"linux"===a.getOSName(!0),describe:()=>({type:e3.desktop})},{test:a=>"playstation 4"===a.getOSName(!0),describe:()=>({type:e3.tv})},{test:a=>"roku"===a.getOSName(!0),describe:()=>({type:e3.tv})}],fb=[{test:a=>"microsoft edge"===a.getBrowserName(!0),describe(a){if(/\sedg\//i.test(a))return{name:e5.Blink};let b=e6.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,a);return{name:e5.EdgeHTML,version:b}}},{test:[/trident/i],describe(a){let b={name:e5.Trident},c=e6.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:a=>a.test(/presto/i),describe(a){let b={name:e5.Presto},c=e6.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test(a){let b=a.test(/gecko/i),c=a.test(/like gecko/i);return b&&!c},describe(a){let b={name:e5.Gecko},c=e6.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:e5.Blink})},{test:[/(apple)?webkit/i],describe(a){let b={name:e5.WebKit},c=e6.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,a);return c&&(b.version=c),b}}];class fc{constructor(a,b=!1){if(null==a||""===a)throw Error("UserAgent parameter can't be empty");this._ua=a,this.parsedResult={},!0!==b&&this.parse()}getUA(){return this._ua}test(a){return a.test(this._ua)}parseBrowser(){this.parsedResult.browser={};let a=e6.find(e8,a=>{if("function"==typeof a.test)return a.test(this);if(a.test instanceof Array)return a.test.some(a=>this.test(a));throw Error("Browser's test function is not valid")});return a&&(this.parsedResult.browser=a.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(a){return a?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};let a=e6.find(e9,a=>{if("function"==typeof a.test)return a.test(this);if(a.test instanceof Array)return a.test.some(a=>this.test(a));throw Error("Browser's test function is not valid")});return a&&(this.parsedResult.os=a.describe(this.getUA())),this.parsedResult.os}getOSName(a){let{name:b}=this.getOS();return a?String(b).toLowerCase()||"":b||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(a=!1){let{type:b}=this.getPlatform();return a?String(b).toLowerCase()||"":b||""}parsePlatform(){this.parsedResult.platform={};let a=e6.find(fa,a=>{if("function"==typeof a.test)return a.test(this);if(a.test instanceof Array)return a.test.some(a=>this.test(a));throw Error("Browser's test function is not valid")});return a&&(this.parsedResult.platform=a.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(a){return a?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};let a=e6.find(fb,a=>{if("function"==typeof a.test)return a.test(this);if(a.test instanceof Array)return a.test.some(a=>this.test(a));throw Error("Browser's test function is not valid")});return a&&(this.parsedResult.engine=a.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return e6.assign({},this.parsedResult)}satisfies(a){let b={},c=0,d={},e=0;if(Object.keys(a).forEach(f=>{let g=a[f];"string"==typeof g?(d[f]=g,e+=1):"object"==typeof g&&(b[f]=g,c+=1)}),c>0){let a=Object.keys(b),c=e6.find(a,a=>this.isOS(a));if(c){let a=this.satisfies(b[c]);if(void 0!==a)return a}let d=e6.find(a,a=>this.isPlatform(a));if(d){let a=this.satisfies(b[d]);if(void 0!==a)return a}}if(e>0){let a=Object.keys(d),b=e6.find(a,a=>this.isBrowser(a,!0));if(void 0!==b)return this.compareVersion(d[b])}}isBrowser(a,b=!1){let c=this.getBrowserName().toLowerCase(),d=a.toLowerCase(),e=e6.getBrowserTypeByAlias(d);return b&&e&&(d=e.toLowerCase()),d===c}compareVersion(a){let b=[0],c=a,d=!1,e=this.getBrowserVersion();if("string"==typeof e)return">"===a[0]||"<"===a[0]?(c=a.substr(1),"="===a[1]?(d=!0,c=a.substr(2)):b=[],">"===a[0]?b.push(1):b.push(-1)):"="===a[0]?c=a.substr(1):"~"===a[0]&&(d=!0,c=a.substr(1)),b.indexOf(e6.compareVersions(e,c,d))>-1}isOS(a){return this.getOSName(!0)===String(a).toLowerCase()}isPlatform(a){return this.getPlatformType(!0)===String(a).toLowerCase()}isEngine(a){return this.getEngineName(!0)===String(a).toLowerCase()}is(a,b=!1){return this.isBrowser(a,b)||this.isOS(a)||this.isPlatform(a)}some(a=[]){return a.some(a=>this.is(a))}}class fd{static getParser(a,b=!1){if("string"!=typeof a)throw Error("UserAgent should be a string");return new fc(a,b)}static parse(a){return new fc(a).getResult()}static get BROWSER_MAP(){return e2}static get ENGINE_MAP(){return e5}static get OS_MAP(){return e4}static get PLATFORMS_MAP(){return e3}}function fe(){return Date.now()+Math.random().toString()}function ff(){throw Error("Method must be implemented in subclass")}function fg(a,b){return null!=b&&b.proxyUrl?b.proxyUrl+("/"===b.proxyUrl.slice(-1)?"":"/")+a.substring(8):a}function fh(a){return null!=a&&a.callObjectBundleUrlOverride?a.callObjectBundleUrlOverride:fg("https://c.daily.co/call-machine/versioned/".concat("0.87.0","/static/call-machine-object-bundle.js"),a)}function fi(a){try{new URL(a)}catch(a){return!1}return!0}let fj="u"<typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,fk="8.55.0",fl=globalThis;function fm(a,b,c){let d=c||fl,e=d.__SENTRY__=d.__SENTRY__||{},f=e[fk]=e[fk]||{};return f[a]||(f[a]=b())}let fn="u"<typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,fo=["debug","info","warn","error","log","assert","trace"],fp={};function fq(a){if(!("console"in fl))return a();let b=fl.console,c={},d=Object.keys(fp);d.forEach(a=>{let d=fp[a];c[a]=b[a],b[a]=d});try{return a()}finally{d.forEach(a=>{b[a]=c[a]})}}let fr=fm("logger",function(){let a=!1,b={enable:()=>{a=!0},disable:()=>{a=!1},isEnabled:()=>a};return fn?fo.forEach(c=>{b[c]=(...b)=>{a&&fq(()=>{fl.console[c](`Sentry Logger [${c}]:`,...b)})}}):fo.forEach(a=>{b[a]=()=>{}}),b}),fs=/\(error: (.*)\)/,ft=/captureMessage|captureException/;function fu(a){return a[a.length-1]||{}}let fv="<anonymous>";function fw(a){try{return a&&"function"==typeof a&&a.name||fv}catch(a){return fv}}function fx(a){let b=a.exception;if(b){let a=[];try{return b.values.forEach(b=>{b.stacktrace.frames&&a.push(...b.stacktrace.frames)}),a}catch(a){return}}}let fy={},fz={};function fA(a,b){fy[a]=fy[a]||[],fy[a].push(b)}function fB(a,b){if(!fz[a]){fz[a]=!0;try{b()}catch(b){fn&&fr.error(`Error while instrumenting ${a}`,b)}}}function fC(a,b){let c=a&&fy[a];if(c)for(let d of c)try{d(b)}catch(b){fn&&fr.error(`Error while triggering instrumentation handler.
Type: ${a}
Name: ${fw(d)}
Error:`,b)}}let fD=null;function fE(){fD=fl.onerror,fl.onerror=function(a,b,c,d,e){return fC("error",{column:d,error:e,line:c,msg:a,url:b}),!!fD&&fD.apply(this,arguments)},fl.onerror.__SENTRY_INSTRUMENTED__=!0}let fF=null;function fG(){fF=fl.onunhandledrejection,fl.onunhandledrejection=function(a){return fC("unhandledrejection",a),!fF||fF.apply(this,arguments)},fl.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function fH(){return fI(fl),fl}function fI(a){let b=a.__SENTRY__=a.__SENTRY__||{};return b.version=b.version||fk,b[fk]=b[fk]||{}}let fJ=Object.prototype.toString;function fK(a){switch(fJ.call(a)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return fU(a,Error)}}function fL(a,b){return fJ.call(a)===`[object ${b}]`}function fM(a){return fL(a,"ErrorEvent")}function fN(a){return fL(a,"DOMError")}function fO(a){return fL(a,"String")}function fP(a){return"object"==typeof a&&null!==a&&"__sentry_template_string__"in a&&"__sentry_template_values__"in a}function fQ(a){return null===a||fP(a)||"object"!=typeof a&&"function"!=typeof a}function fR(a){return fL(a,"Object")}function fS(a){return"u">typeof Event&&fU(a,Event)}function fT(a){return!!(a&&a.then&&"function"==typeof a.then)}function fU(a,b){try{return a instanceof b}catch(a){return!1}}function fV(a){return!("object"!=typeof a||null===a||!a.__isVue&&!a._isVue)}function fW(a,b={}){if(!a)return"<unknown>";try{let c,d=a,e=[],f=0,g=0,h=Array.isArray(b)?b:b.keyAttrs,i=!Array.isArray(b)&&b.maxStringLength||80;for(;d&&f++<5&&(c=function(a,b){let c=[];if(!a||!a.tagName)return"";if(fl.HTMLElement&&a instanceof HTMLElement&&a.dataset){if(a.dataset.sentryComponent)return a.dataset.sentryComponent;if(a.dataset.sentryElement)return a.dataset.sentryElement}c.push(a.tagName.toLowerCase());let d=b&&b.length?b.filter(b=>a.getAttribute(b)).map(b=>[b,a.getAttribute(b)]):null;if(d&&d.length)d.forEach(a=>{c.push(`[${a[0]}="${a[1]}"]`)});else{a.id&&c.push(`#${a.id}`);let b=a.className;if(b&&fO(b))for(let a of b.split(/\s+/))c.push(`.${a}`)}for(let b of["aria-label","type","name","title","alt"]){let d=a.getAttribute(b);d&&c.push(`[${b}="${d}"]`)}return c.join("")}(d,h),!("html"===c||f>1&&g+3*e.length+c.length>=i));)e.push(c),g+=c.length,d=d.parentNode;return e.reverse().join(" > ")}catch(a){return"<unknown>"}}function fX(a,b=0){return"string"!=typeof a||0===b||a.length<=b?a:`${a.slice(0,b)}...`}function fY(a,b){if(!Array.isArray(a))return"";let c=[];for(let b=0;b<a.length;b++){let d=a[b];try{fV(d)?c.push("[VueViewModel]"):c.push(String(d))}catch(a){c.push("[value cannot be serialized]")}}return c.join(b)}function fZ(a,b=[],c=!1){return b.some(b=>(function(a,b,c=!1){return!!fO(a)&&(fL(b,"RegExp")?b.test(a):!!fO(b)&&(c?a===b:a.includes(b)))})(a,b,c))}function f$(a,b,c){if(!(b in a))return;let d=a[b],e=c(d);"function"==typeof e&&f0(e,d);try{a[b]=e}catch(c){fn&&fr.log(`Failed to replace method "${b}" in object`,a)}}function f_(a,b,c){try{Object.defineProperty(a,b,{value:c,writable:!0,configurable:!0})}catch(c){fn&&fr.log(`Failed to add non-enumerable property "${b}" to object`,a)}}function f0(a,b){try{let c=b.prototype||{};a.prototype=b.prototype=c,f_(a,"__sentry_original__",b)}catch(a){}}function f1(a){return a.__sentry_original__}function f2(a){if(fK(a))return{message:a.message,name:a.name,stack:a.stack,...f4(a)};if(fS(a)){let b={type:a.type,target:f3(a.target),currentTarget:f3(a.currentTarget),...f4(a)};return"u">typeof CustomEvent&&fU(a,CustomEvent)&&(b.detail=a.detail),b}return a}function f3(a){try{return"u">typeof Element&&fU(a,Element)?fW(a):Object.prototype.toString.call(a)}catch(a){return"<unknown>"}}function f4(a){if("object"==typeof a&&null!==a){let b={};for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b}return{}}function f5(a){return function a(b,c){if(function(a){if(!fR(a))return!1;try{let b=Object.getPrototypeOf(a).constructor.name;return!b||"Object"===b}catch(a){return!0}}(b)){let d=c.get(b);if(void 0!==d)return d;let e={};for(let d of(c.set(b,e),Object.getOwnPropertyNames(b)))void 0!==b[d]&&(e[d]=a(b[d],c));return e}if(Array.isArray(b)){let d=c.get(b);if(void 0!==d)return d;let e=[];return c.set(b,e),b.forEach(b=>{e.push(a(b,c))}),e}return b}(a,new Map)}function f6(){return Date.now()/1e3}let f7=function(){let{performance:a}=fl;if(!a||!a.now)return f6;let b=Date.now()-a.now(),c=null==a.timeOrigin?b:a.timeOrigin;return()=>(c+a.now())/1e3}();function f8(){let a=fl.crypto||fl.msCrypto,b=()=>16*Math.random();try{if(a&&a.randomUUID)return a.randomUUID().replace(/-/g,"");a&&a.getRandomValues&&(b=()=>{let b=new Uint8Array(1);return a.getRandomValues(b),b[0]})}catch(a){}return"10000000100040008000100000000000".replace(/[018]/g,a=>(a^(15&b())>>a/4).toString(16))}function f9(a){return a.exception&&a.exception.values?a.exception.values[0]:void 0}function ga(a){let{message:b,event_id:c}=a;if(b)return b;let d=f9(a);return d?d.type&&d.value?`${d.type}: ${d.value}`:d.type||d.value||c||"<unknown>":c||"<unknown>"}function gb(a,b,c){let d=a.exception=a.exception||{},e=d.values=d.values||[],f=e[0]=e[0]||{};f.value||(f.value=b||""),f.type||(f.type=c||"Error")}function gc(a,b){let c=f9(a);if(!c)return;let d=c.mechanism;if(c.mechanism={type:"generic",handled:!0,...d,...b},b&&"data"in b){let a={...d&&d.data,...b.data};c.mechanism.data=a}}function gd(a){if(function(a){try{return a.__sentry_captured__}catch(a){}}(a))return!0;try{f_(a,"__sentry_captured__",!0)}catch(a){}return!1}function ge(a){return new gg(b=>{b(a)})}function gf(a){return new gg((b,c)=>{c(a)})}(()=>{let{performance:a}=fl;if(!a||!a.now)return;let b=a.now(),c=Date.now(),d=a.timeOrigin?Math.abs(a.timeOrigin+b-c):36e5,e=a.timing&&a.timing.navigationStart,f="number"==typeof e?Math.abs(e+b-c):36e5;(d<36e5||f<36e5)&&d<=f&&a.timeOrigin})(),(l=s||(s={}))[l.PENDING=0]="PENDING",l[l.RESOLVED=1]="RESOLVED",l[l.REJECTED=2]="REJECTED";class gg{constructor(a){gg.prototype.__init.call(this),gg.prototype.__init2.call(this),gg.prototype.__init3.call(this),gg.prototype.__init4.call(this),this._state=s.PENDING,this._handlers=[];try{a(this._resolve,this._reject)}catch(a){this._reject(a)}}then(a,b){return new gg((c,d)=>{this._handlers.push([!1,b=>{if(a)try{c(a(b))}catch(a){d(a)}else c(b)},a=>{if(b)try{c(b(a))}catch(a){d(a)}else d(a)}]),this._executeHandlers()})}catch(a){return this.then(a=>a,a)}finally(a){return new gg((b,c)=>{let d,e;return this.then(b=>{e=!1,d=b,a&&a()},b=>{e=!0,d=b,a&&a()}).then(()=>{e?c(d):b(d)})})}__init(){this._resolve=a=>{this._setResult(s.RESOLVED,a)}}__init2(){this._reject=a=>{this._setResult(s.REJECTED,a)}}__init3(){this._setResult=(a,b)=>{this._state===s.PENDING&&(fT(b)?b.then(this._resolve,this._reject):(this._state=a,this._value=b,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===s.PENDING)return;let a=this._handlers.slice();this._handlers=[],a.forEach(a=>{a[0]||(this._state===s.RESOLVED&&a[1](this._value),this._state===s.REJECTED&&a[2](this._value),a[0]=!0)})}}}function gh(a,b={}){if(b.user&&(!a.ipAddress&&b.user.ip_address&&(a.ipAddress=b.user.ip_address),a.did||b.did||(a.did=b.user.id||b.user.email||b.user.username)),a.timestamp=b.timestamp||f7(),b.abnormal_mechanism&&(a.abnormal_mechanism=b.abnormal_mechanism),b.ignoreDuration&&(a.ignoreDuration=b.ignoreDuration),b.sid&&(a.sid=32===b.sid.length?b.sid:f8()),void 0!==b.init&&(a.init=b.init),!a.did&&b.did&&(a.did=`${b.did}`),"number"==typeof b.started&&(a.started=b.started),a.ignoreDuration)a.duration=void 0;else if("number"==typeof b.duration)a.duration=b.duration;else{let b=a.timestamp-a.started;a.duration=b>=0?b:0}b.release&&(a.release=b.release),b.environment&&(a.environment=b.environment),!a.ipAddress&&b.ipAddress&&(a.ipAddress=b.ipAddress),!a.userAgent&&b.userAgent&&(a.userAgent=b.userAgent),"number"==typeof b.errors&&(a.errors=b.errors),b.status&&(a.status=b.status)}function gi(){return f8().substring(16)}function gj(a,b,c=2){if(!b||"object"!=typeof b||c<=0)return b;if(a&&b&&0===Object.keys(b).length)return a;let d={...a};for(let a in b)Object.prototype.hasOwnProperty.call(b,a)&&(d[a]=gj(d[a],b[a],c-1));return d}let gk="_sentrySpan";function gl(a,b){b?f_(a,gk,b):delete a[gk]}class gm{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:f8(),spanId:gi()}}clone(){let a=new gm;return a._breadcrumbs=[...this._breadcrumbs],a._tags={...this._tags},a._extra={...this._extra},a._contexts={...this._contexts},this._contexts.flags&&(a._contexts.flags={values:[...this._contexts.flags.values]}),a._user=this._user,a._level=this._level,a._session=this._session,a._transactionName=this._transactionName,a._fingerprint=this._fingerprint,a._eventProcessors=[...this._eventProcessors],a._requestSession=this._requestSession,a._attachments=[...this._attachments],a._sdkProcessingMetadata={...this._sdkProcessingMetadata},a._propagationContext={...this._propagationContext},a._client=this._client,a._lastEventId=this._lastEventId,gl(a,this[gk]),a}setClient(a){this._client=a}setLastEventId(a){this._lastEventId=a}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(a){this._scopeListeners.push(a)}addEventProcessor(a){return this._eventProcessors.push(a),this}setUser(a){return this._user=a||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&gh(this._session,{user:a}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(a){return this._requestSession=a,this}setTags(a){return this._tags={...this._tags,...a},this._notifyScopeListeners(),this}setTag(a,b){return this._tags={...this._tags,[a]:b},this._notifyScopeListeners(),this}setExtras(a){return this._extra={...this._extra,...a},this._notifyScopeListeners(),this}setExtra(a,b){return this._extra={...this._extra,[a]:b},this._notifyScopeListeners(),this}setFingerprint(a){return this._fingerprint=a,this._notifyScopeListeners(),this}setLevel(a){return this._level=a,this._notifyScopeListeners(),this}setTransactionName(a){return this._transactionName=a,this._notifyScopeListeners(),this}setContext(a,b){return null===b?delete this._contexts[a]:this._contexts[a]=b,this._notifyScopeListeners(),this}setSession(a){return a?this._session=a:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(a){if(!a)return this;let b="function"==typeof a?a(this):a,[c,d]=b instanceof gn?[b.getScopeData(),b.getRequestSession()]:fR(b)?[a,a.requestSession]:[],{tags:e,extra:f,user:g,contexts:h,level:i,fingerprint:j=[],propagationContext:k}=c||{};return this._tags={...this._tags,...e},this._extra={...this._extra,...f},this._contexts={...this._contexts,...h},g&&Object.keys(g).length&&(this._user=g),i&&(this._level=i),j.length&&(this._fingerprint=j),k&&(this._propagationContext=k),d&&(this._requestSession=d),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,gl(this,void 0),this._attachments=[],this.setPropagationContext({traceId:f8()}),this._notifyScopeListeners(),this}addBreadcrumb(a,b){let c="number"==typeof b?b:100;if(c<=0)return this;let d={timestamp:f6(),...a};return this._breadcrumbs.push(d),this._breadcrumbs.length>c&&(this._breadcrumbs=this._breadcrumbs.slice(-c),this._client&&this._client.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(a){return this._attachments.push(a),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:this[gk]}}setSDKProcessingMetadata(a){return this._sdkProcessingMetadata=gj(this._sdkProcessingMetadata,a,2),this}setPropagationContext(a){return this._propagationContext={spanId:gi(),...a},this}getPropagationContext(){return this._propagationContext}captureException(a,b){let c=b&&b.event_id?b.event_id:f8();if(!this._client)return fr.warn("No client configured on scope - will not capture exception!"),c;let d=Error("Sentry syntheticException");return this._client.captureException(a,{originalException:a,syntheticException:d,...b,event_id:c},this),c}captureMessage(a,b,c){let d=c&&c.event_id?c.event_id:f8();if(!this._client)return fr.warn("No client configured on scope - will not capture message!"),d;let e=Error(a);return this._client.captureMessage(a,b,{originalException:a,syntheticException:e,...c,event_id:d},this),d}captureEvent(a,b){let c=b&&b.event_id?b.event_id:f8();return this._client?this._client.captureEvent(a,{...b,event_id:c},this):fr.warn("No client configured on scope - will not capture event!"),c}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(a=>{a(this)}),this._notifyingListeners=!1)}}let gn=gm;class go{constructor(a,b){let c,d;c=a||new gn,d=b||new gn,this._stack=[{scope:c}],this._isolationScope=d}withScope(a){let b,c=this._pushScope();try{b=a(c)}catch(a){throw this._popScope(),a}return fT(b)?b.then(a=>(this._popScope(),a),a=>{throw this._popScope(),a}):(this._popScope(),b)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){let a=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:a}),a}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function gp(){let a=fI(fH());return a.stack=a.stack||new go(fm("defaultCurrentScope",()=>new gn),fm("defaultIsolationScope",()=>new gn))}function gq(a){return gp().withScope(a)}function gr(a,b){let c=gp();return c.withScope(()=>(c.getStackTop().scope=a,b(a)))}function gs(a){return gp().withScope(()=>a(gp().getIsolationScope()))}function gt(a){let b=fI(a);return b.acs?b.acs:{withIsolationScope:gs,withScope:gq,withSetScope:gr,withSetIsolationScope:(a,b)=>gs(b),getCurrentScope:()=>gp().getScope(),getIsolationScope:()=>gp().getIsolationScope()}}function gu(){return gt(fH()).getCurrentScope()}function gv(){return gt(fH()).getIsolationScope()}function gw(){return gu().getClient()}let gx=/^sentry-/;function gy(a){return a.split(",").map(a=>a.split("=").map(a=>decodeURIComponent(a.trim()))).reduce((a,[b,c])=>(b&&c&&(a[b]=c),a),{})}let gz=!1;function gA(a){return"number"==typeof a?gB(a):Array.isArray(a)?a[0]+a[1]/1e9:a instanceof Date?gB(a.getTime()):f7()}function gB(a){return a>0x2540be3ff?a/1e3:a}function gC(a){if("function"==typeof a.getSpanJSON)return a.getSpanJSON();try{let{spanId:b,traceId:c}=a.spanContext();if(a.attributes&&a.startTime&&a.name&&a.endTime&&a.status){let{attributes:d,startTime:e,name:f,endTime:g,parentSpanId:h,status:i}=a;return f5({span_id:b,trace_id:c,data:d,description:f,parent_span_id:h,start_timestamp:gA(e),timestamp:gA(g)||void 0,status:function(a){if(a&&0!==a.code)return 1===a.code?"ok":a.message||"unknown_error"}(i),op:d["sentry.op"],origin:d["sentry.origin"],_metrics_summary:function(a){let b=a._sentryMetrics;if(!b)return;let c={};for(let[,[a,d]]of b)(c[a]||(c[a]=[])).push(f5(d));return c}(a)})}return{span_id:b,trace_id:c}}catch(a){return{}}}function gD(a){return a._sentryRootSpan||a}let gE="production";function gF(a,b){let c=b.getOptions(),{publicKey:d}=b.getDsn()||{},e=f5({environment:c.environment||gE,release:c.release,public_key:d,trace_id:a});return b.emit("createDsc",e),e}let gG=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function gH(a,b=!1){let{host:c,path:d,pass:e,port:f,projectId:g,protocol:h,publicKey:i}=a;return`${h}://${i}${b&&e?`:${e}`:""}@${c}${f?`:${f}`:""}/${d?`${d}/`:d}${g}`}function gI(a){return{protocol:a.protocol,publicKey:a.publicKey||"",pass:a.pass||"",host:a.host,port:a.port||"",path:a.path||"",projectId:a.projectId}}function gJ(b,c=100,d=1/0){try{return function b(c,d,e=1/0,f=1/0,g=function(){let a="function"==typeof WeakSet,b=a?new WeakSet:[];return[function(c){if(a)return!!b.has(c)||(b.add(c),!1);for(let a=0;a<b.length;a++)if(b[a]===c)return!0;return b.push(c),!1},function(c){if(a)b.delete(c);else for(let a=0;a<b.length;a++)if(b[a]===c){b.splice(a,1);break}}]}()){let[h,i]=g;if(null==d||["boolean","string"].includes(typeof d)||"number"==typeof d&&Number.isFinite(d))return d;let j=function(b,c){try{let d;if("domain"===b&&c&&"object"==typeof c&&c._events)return"[Domain]";if("domainEmitter"===b)return"[DomainEmitter]";if(c===a.g)return"[Global]";if("u">typeof document&&c===document)return"[Document]";if(fV(c))return"[VueViewModel]";if(fR(c)&&"nativeEvent"in c&&"preventDefault"in c&&"stopPropagation"in c)return"[SyntheticEvent]";if("number"==typeof c&&!Number.isFinite(c))return`[${c}]`;if("function"==typeof c)return`[Function: ${fw(c)}]`;if("symbol"==typeof c)return`[${String(c)}]`;if("bigint"==typeof c)return`[BigInt: ${String(c)}]`;let e=(d=Object.getPrototypeOf(c))?d.constructor.name:"null prototype";return/^HTML(\w*)Element$/.test(e)?`[HTMLElement: ${e}]`:`[object ${e}]`}catch(a){return`**non-serializable** (${a})`}}(c,d);if(!j.startsWith("[object "))return j;if(d.__sentry_skip_normalization__)return d;let k="number"==typeof d.__sentry_override_normalization_depth__?d.__sentry_override_normalization_depth__:e;if(0===k)return j.replace("object ","");if(h(d))return"[Circular ~]";if(d&&"function"==typeof d.toJSON)try{return b("",d.toJSON(),k-1,f,g)}catch(a){}let l=Array.isArray(d)?[]:{},m=0,n=f2(d);for(let a in n){if(!Object.prototype.hasOwnProperty.call(n,a))continue;if(m>=f){l[a]="[MaxProperties ~]";break}let c=n[a];l[a]=b(a,c,k-1,f,g),m++}return i(d),l}("",b,c,d)}catch(a){return{ERROR:`**non-serializable** (${a})`}}}function gK(a,b=[]){return[a,b]}function gL(a,b){for(let c of a[1])if(b(c,c[0].type))return!0;return!1}function gM(a){return fl.__SENTRY__&&fl.__SENTRY__.encodePolyfill?fl.__SENTRY__.encodePolyfill(a):(new TextEncoder).encode(a)}let gN={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket",raw_security:"security"};function gO(a){if(!a||!a.sdk)return;let{name:b,version:c}=a.sdk;return{name:b,version:c}}function gP(a,b){let{extra:c,tags:d,user:e,contexts:f,level:g,sdkProcessingMetadata:h,breadcrumbs:i,fingerprint:j,eventProcessors:k,attachments:l,propagationContext:m,transactionName:n,span:o}=b;gQ(a,"extra",c),gQ(a,"tags",d),gQ(a,"user",e),gQ(a,"contexts",f),a.sdkProcessingMetadata=gj(a.sdkProcessingMetadata,h,2),g&&(a.level=g),n&&(a.transactionName=n),o&&(a.span=o),i.length&&(a.breadcrumbs=[...a.breadcrumbs,...i]),j.length&&(a.fingerprint=[...a.fingerprint,...j]),k.length&&(a.eventProcessors=[...a.eventProcessors,...k]),l.length&&(a.attachments=[...a.attachments,...l]),a.propagationContext={...a.propagationContext,...m}}function gQ(a,b,c){a[b]=gj(a[b],c,1)}let gR=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function gS(a,b){return gu().captureEvent(a,b)}function gT(a){var b;let c,d,e=gw(),f=gv(),g=gu(),{release:h,environment:i=gE}=e&&e.getOptions()||{},{userAgent:j}=fl.navigator||{},k=(b={release:h,environment:i,user:g.getUser()||f.getUser(),...j&&{userAgent:j},...a},c=f7(),d={sid:f8(),init:!0,timestamp:c,started:c,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>{var a;return a=d,f5({sid:`${a.sid}`,init:a.init,started:new Date(1e3*a.started).toISOString(),timestamp:new Date(1e3*a.timestamp).toISOString(),status:a.status,errors:a.errors,did:"number"==typeof a.did||"string"==typeof a.did?`${a.did}`:void 0,duration:a.duration,abnormal_mechanism:a.abnormal_mechanism,attrs:{release:a.release,environment:a.environment,ip_address:a.ipAddress,user_agent:a.userAgent}})}},b&&gh(d,b),d),l=f.getSession();return l&&"ok"===l.status&&gh(l,{status:"exited"}),gU(),f.setSession(k),g.setSession(k),k}function gU(){let a,b=gv(),c=gu(),d=c.getSession()||b.getSession();d&&(a={},"ok"===d.status&&(a={status:"exited"}),gh(d,a)),gV(),b.setSession(),c.setSession()}function gV(){let a=gv(),b=gu(),c=gw(),d=b.getSession()||a.getSession();d&&c&&c.captureSession(d)}function gW(a=!1){a?gU():gV()}let gX=[];function gY(a,b){for(let c of b)c&&c.afterAllSetup&&c.afterAllSetup(a)}function gZ(a,b,c){if(c[b.name])fj&&fr.log(`Integration skipped because it was already installed: ${b.name}`);else{if(c[b.name]=b,-1===gX.indexOf(b.name)&&"function"==typeof b.setupOnce&&(b.setupOnce(),gX.push(b.name)),b.setup&&"function"==typeof b.setup&&b.setup(a),"function"==typeof b.preprocessEvent){let c=b.preprocessEvent.bind(b);a.on("preprocessEvent",(b,d)=>c(b,d,a))}if("function"==typeof b.processEvent){let c=b.processEvent.bind(b),d=Object.assign((b,d)=>c(b,d,a),{id:b.name});a.addEventProcessor(d)}fj&&fr.log(`Integration installed: ${b.name}`)}}class g$ extends Error{constructor(a,b="warn"){super(a),this.message=a,this.logLevel=b}}let g_="Not capturing exception because it's already been captured.";class g0{constructor(a){if(this._options=a,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],a.dsn?this._dsn=function(a){let b="string"==typeof a?function(a){let b=gG.exec(a);if(!b)return void fq(()=>{console.error(`Invalid Sentry Dsn: ${a}`)});let[c,d,e="",f="",g="",h=""]=b.slice(1),i="",j=h,k=j.split("/");if(k.length>1&&(i=k.slice(0,-1).join("/"),j=k.pop()),j){let a=j.match(/^\d+/);a&&(j=a[0])}return gI({host:f,pass:e,path:i,projectId:j,port:g,protocol:c,publicKey:d})}(a):gI(a);if(b&&function(a){if(!fn)return!0;let{port:b,projectId:c,protocol:d}=a;return!(["protocol","publicKey","host","projectId"].find(b=>!a[b]&&(fr.error(`Invalid Sentry Dsn: ${b} missing`),!0))||(c.match(/^\d+$/)?"http"===d||"https"===d?b&&isNaN(parseInt(b,10))&&(fr.error(`Invalid Sentry Dsn: Invalid port ${b}`),1):(fr.error(`Invalid Sentry Dsn: Invalid protocol ${d}`),1):(fr.error(`Invalid Sentry Dsn: Invalid projectId ${c}`),1)))}(b))return b}(a.dsn):fj&&fr.warn("No DSN provided, client will not send events."),this._dsn){const b=function(a,b,c){let d,e,f;return b||`${d=a.protocol?`${a.protocol}:`:"",e=a.port?`:${a.port}`:"",`${d}//${a.host}${e}${a.path?`/${a.path}`:""}/api/`}${a.projectId}/envelope/?${f={sentry_version:"7"},a.publicKey&&(f.sentry_key=a.publicKey),c&&(f.sentry_client=`${c.name}/${c.version}`),new URLSearchParams(f).toString()}`}(this._dsn,a.tunnel,a._metadata?a._metadata.sdk:void 0);this._transport=a.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...a.transportOptions,url:b})}const b=["enableTracing","tracesSampleRate","tracesSampler"].find(b=>b in a&&null==a[b]);b&&fq(()=>{console.warn(`[Sentry] Deprecation warning: \`${b}\` is set to undefined, which leads to tracing being enabled. In v9, a value of \`undefined\` will result in tracing being disabled.`)})}captureException(a,b,c){let d=f8();if(gd(a))return fj&&fr.log(g_),d;let e={event_id:d,...b};return this._process(this.eventFromException(a,e).then(a=>this._captureEvent(a,e,c))),e.event_id}captureMessage(a,b,c,d){let e={event_id:f8(),...c},f=fP(a)?a:String(a),g=fQ(a)?this.eventFromMessage(f,b,e):this.eventFromException(a,e);return this._process(g.then(a=>this._captureEvent(a,e,d))),e.event_id}captureEvent(a,b,c){let d=f8();if(b&&b.originalException&&gd(b.originalException))return fj&&fr.log(g_),d;let e={event_id:d,...b},f=(a.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(a,e,f||c)),e.event_id}captureSession(a){"string"!=typeof a.release?fj&&fr.warn("Discarded session because of missing or non-string release"):(this.sendSession(a),gh(a,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(a){let b=this._transport;return b?(this.emit("flush"),this._isClientDoneProcessing(a).then(c=>b.flush(a).then(a=>c&&a))):ge(!0)}close(a){return this.flush(a).then(a=>(this.getOptions().enabled=!1,this.emit("close"),a))}getEventProcessors(){return this._eventProcessors}addEventProcessor(a){this._eventProcessors.push(a)}init(){(this._isEnabled()||this._options.integrations.some(({name:a})=>a.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(a){return this._integrations[a]}addIntegration(a){let b=this._integrations[a.name];gZ(this,a,this._integrations),b||gY(this,[a])}sendEvent(a,b={}){var c,d,e,f;let g,h,i,j;this.emit("beforeSendEvent",a,b);let k=(c=this._dsn,d=this._options._metadata,e=this._options.tunnel,g=gO(d),h=a.type&&"replay_event"!==a.type?a.type:"event",(f=d&&d.sdk)&&(a.sdk=a.sdk||{},a.sdk.name=a.sdk.name||f.name,a.sdk.version=a.sdk.version||f.version,a.sdk.integrations=[...a.sdk.integrations||[],...f.integrations||[]],a.sdk.packages=[...a.sdk.packages||[],...f.packages||[]]),i=a.sdkProcessingMetadata&&a.sdkProcessingMetadata.dynamicSamplingContext,j={event_id:a.event_id,sent_at:(new Date).toISOString(),...g&&{sdk:g},...!!e&&c&&{dsn:gH(c)},...i&&{trace:f5({...i})}},delete a.sdkProcessingMetadata,gK(j,[[{type:h},a]]));for(let a of b.attachments||[])k=function(a,b){let[c,d]=a;return[c,[...d,b]]}(k,function(a){let b="string"==typeof a.data?gM(a.data):a.data;return[f5({type:"attachment",length:b.length,filename:a.filename,content_type:a.contentType,attachment_type:a.attachmentType}),b]}(a));let l=this.sendEnvelope(k);l&&l.then(b=>this.emit("afterSendEvent",a,b),null)}sendSession(a){var b,c,d;let e,f=(b=this._dsn,c=this._options._metadata,d=this._options.tunnel,e=gO(c),gK({sent_at:(new Date).toISOString(),...e&&{sdk:e},...!!d&&b&&{dsn:gH(b)}},["aggregates"in a?[{type:"sessions"},a]:[{type:"session"},a.toJSON()]]));this.sendEnvelope(f)}recordDroppedEvent(a,b,c){if(this._options.sendClientReports){let d="number"==typeof c?c:1,e=`${a}:${b}`;fj&&fr.log(`Recording outcome: "${e}"${d>1?` (${d} times)`:""}`),this._outcomes[e]=(this._outcomes[e]||0)+d}}on(a,b){let c=this._hooks[a]=this._hooks[a]||[];return c.push(b),()=>{let a=c.indexOf(b);a>-1&&c.splice(a,1)}}emit(a,...b){let c=this._hooks[a];c&&c.forEach(a=>a(...b))}sendEnvelope(a){return this.emit("beforeEnvelope",a),this._isEnabled()&&this._transport?this._transport.send(a).then(null,a=>(fj&&fr.error("Error while sending envelope:",a),a)):(fj&&fr.error("Transport disabled"),ge({}))}_setupIntegrations(){var a;let b,{integrations:c}=this._options;this._integrations=(a=this,b={},c.forEach(c=>{c&&gZ(a,c,b)}),b),gY(this,c)}_updateSessionFromEvent(a,b){let c="fatal"===b.level,d=!1,e=b.exception&&b.exception.values;if(e)for(let a of(d=!0,e)){let b=a.mechanism;if(b&&!1===b.handled){c=!0;break}}let f="ok"===a.status;(f&&0===a.errors||f&&c)&&(gh(a,{...c&&{status:"crashed"},errors:a.errors||Number(d||c)}),this.captureSession(a))}_isClientDoneProcessing(a){return new gg(b=>{let c=0,d=setInterval(()=>{0==this._numProcessing?(clearInterval(d),b(!0)):(c+=1,a&&c>=a&&(clearInterval(d),b(!1)))},1)})}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(a,b,c=gu(),g=gv()){let h=this.getOptions(),i=Object.keys(this._integrations);return!b.integrations&&i.length>0&&(b.integrations=i),this.emit("preprocessEvent",a,b),a.type||g.setLastEventId(a.event_id||b.event_id),(function(a,b,c,g,h,i){let{normalizeDepth:j=3,normalizeMaxBreadth:k=1e3}=a,l={...b,event_id:b.event_id||c.event_id||f8(),timestamp:b.timestamp||f6()},m=c.integrations||a.integrations.map(a=>a.name);!function(a,b){let{environment:c,release:d,dist:e,maxValueLength:f=250}=b;a.environment=a.environment||c||gE,!a.release&&d&&(a.release=d),!a.dist&&e&&(a.dist=e),a.message&&(a.message=fX(a.message,f));let g=a.exception&&a.exception.values&&a.exception.values[0];g&&g.value&&(g.value=fX(g.value,f));let h=a.request;h&&h.url&&(h.url=fX(h.url,f))}(l,a),m.length>0&&(l.sdk=l.sdk||{},l.sdk.integrations=[...l.sdk.integrations||[],...m]),h&&h.emit("applyFrameMetadata",b),void 0===b.type&&function(a,b){let c=function(a){let b=fl._sentryDebugIds;if(!b)return{};let c=Object.keys(b);return f&&c.length===e||(e=c.length,f=c.reduce((c,e)=>{d||(d={});let f=d[e];if(f)c[f[0]]=f[1];else{let f=a(e);for(let a=f.length-1;a>=0;a--){let g=f[a],h=g&&g.filename,i=b[e];if(h&&i){c[h]=i,d[e]=[h,i];break}}}return c},{})),f}(b);try{a.exception.values.forEach(a=>{a.stacktrace.frames.forEach(a=>{c&&a.filename&&(a.debug_id=c[a.filename])})})}catch(a){}}(l,a.stackParser);let n=function(a,b){if(!b)return a;let c=a?a.clone():new gn;return c.update(b),c}(g,c.captureContext);c.mechanism&&gc(l,c.mechanism);let o=h?h.getEventProcessors():[],p=fm("globalScope",()=>new gn).getScopeData();i&&gP(p,i.getScopeData()),n&&gP(p,n.getScopeData());let q=[...c.attachments||[],...p.attachments];return q.length&&(c.attachments=q),function(a,b){let c,d,{fingerprint:e,span:f,breadcrumbs:g,sdkProcessingMetadata:h}=b;!function(a,b){let{extra:c,tags:d,user:e,contexts:f,level:g,transactionName:h}=b,i=f5(c);i&&Object.keys(i).length&&(a.extra={...i,...a.extra});let j=f5(d);j&&Object.keys(j).length&&(a.tags={...j,...a.tags});let k=f5(e);k&&Object.keys(k).length&&(a.user={...k,...a.user});let l=f5(f);l&&Object.keys(l).length&&(a.contexts={...l,...a.contexts}),g&&(a.level=g),h&&"transaction"!==a.type&&(a.transaction=h)}(a,b),f&&(a.contexts={trace:function(a){let{spanId:b,traceId:c,isRemote:d}=a.spanContext();return f5({parent_span_id:d?b:gC(a).parent_span_id,span_id:d?gi():b,trace_id:c})}(f),...a.contexts},a.sdkProcessingMetadata={dynamicSamplingContext:function(a){let b=gw();if(!b)return{};let c=gD(a),d=c._frozenDsc;if(d)return d;let e=c.spanContext().traceState,f=e&&e.get("sentry.dsc"),g=f&&function(a){let b=function(a){if(a&&(fO(a)||Array.isArray(a)))return Array.isArray(a)?a.reduce((a,b)=>(Object.entries(gy(b)).forEach(([b,c])=>{a[b]=c}),a),{}):gy(a)}(a);if(!b)return;let c=Object.entries(b).reduce((a,[b,c])=>(b.match(gx)&&(a[b.slice(7)]=c),a),{});return Object.keys(c).length>0?c:void 0}(f);if(g)return g;let h=gF(a.spanContext().traceId,b),i=gC(c),j=i.data||{},k=j["sentry.sample_rate"];null!=k&&(h.sample_rate=`${k}`);let l=j["sentry.source"],m=i.description;return"url"!==l&&m&&(h.transaction=m),function(a){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;let b=gw(),c=b&&b.getOptions();return!!c&&(c.enableTracing||"tracesSampleRate"in c||"tracesSampler"in c)}()&&(h.sampled=String(function(a){let{traceFlags:b}=a.spanContext();return 1===b}(c))),b.emit("createDsc",h,c),h}(f),...a.sdkProcessingMetadata},(c=gC(gD(f)).description)&&!a.transaction&&"transaction"===a.type&&(a.transaction=c)),a.fingerprint=a.fingerprint?Array.isArray(a.fingerprint)?a.fingerprint:[a.fingerprint]:[],e&&(a.fingerprint=a.fingerprint.concat(e)),a.fingerprint&&!a.fingerprint.length&&delete a.fingerprint,d=[...a.breadcrumbs||[],...g],a.breadcrumbs=d.length?d:void 0,a.sdkProcessingMetadata={...a.sdkProcessingMetadata,...h}}(l,p),(function a(b,c,d,e=0){return new gg((f,g)=>{let h=b[e];if(null===c||"function"!=typeof h)f(c);else{let i=h({...c},d);fj&&h.id&&null===i&&fr.log(`Event processor "${h.id}" dropped event`),fT(i)?i.then(c=>a(b,c,d,e+1).then(f)).then(null,g):a(b,i,d,e+1).then(f).then(null,g)}})})([...o,...p.eventProcessors],l,c).then(a=>(a&&function(a){let b={};try{a.exception.values.forEach(a=>{a.stacktrace.frames.forEach(a=>{a.debug_id&&(a.abs_path?b[a.abs_path]=a.debug_id:a.filename&&(b[a.filename]=a.debug_id),delete a.debug_id)})})}catch(a){}if(0===Object.keys(b).length)return;a.debug_meta=a.debug_meta||{},a.debug_meta.images=a.debug_meta.images||[];let c=a.debug_meta.images;Object.entries(b).forEach(([a,b])=>{c.push({type:"sourcemap",code_file:a,debug_id:b})})}(a),"number"==typeof j&&j>0?function(a,b,c){if(!a)return null;let d={...a,...a.breadcrumbs&&{breadcrumbs:a.breadcrumbs.map(a=>({...a,...a.data&&{data:gJ(a.data,b,c)}}))},...a.user&&{user:gJ(a.user,b,c)},...a.contexts&&{contexts:gJ(a.contexts,b,c)},...a.extra&&{extra:gJ(a.extra,b,c)}};return a.contexts&&a.contexts.trace&&d.contexts&&(d.contexts.trace=a.contexts.trace,a.contexts.trace.data&&(d.contexts.trace.data=gJ(a.contexts.trace.data,b,c))),a.spans&&(d.spans=a.spans.map(a=>({...a,...a.data&&{data:gJ(a.data,b,c)}}))),a.contexts&&a.contexts.flags&&d.contexts&&(d.contexts.flags=gJ(a.contexts.flags,3,c)),d}(a,j,k):a))})(h,a,b,c,this,g).then(a=>{let b;return null===a?a:(a.contexts={trace:function(a){let{traceId:b,spanId:c,parentSpanId:d}=a.getPropagationContext();return f5({trace_id:b,span_id:c,parent_span_id:d})}(c),...a.contexts},a.sdkProcessingMetadata={dynamicSamplingContext:(b=c.getPropagationContext()).dsc||gF(b.traceId,this),...a.sdkProcessingMetadata},a)})}_captureEvent(a,b={},c){return this._processEvent(a,b,c).then(a=>a.event_id,a=>{fj&&(a instanceof g$&&"log"===a.logLevel?fr.log(a.message):fr.warn(a))})}_processEvent(a,b,c){let d=this.getOptions(),{sampleRate:e}=d,f=g2(a),g=g1(a),h=a.type||"error",i=`before send for type \`${h}\``,j=void 0===e?void 0:function(a){if("boolean"==typeof a)return Number(a);let b="string"==typeof a?parseFloat(a):a;if(!("number"!=typeof b||isNaN(b)||b<0||b>1))return b;fj&&fr.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(a)} of type ${JSON.stringify(typeof a)}.`)}(e);if(g&&"number"==typeof j&&Math.random()>j)return this.recordDroppedEvent("sample_rate","error",a),gf(new g$(`Discarding event because it's not included in the random sample (sampling rate = ${e})`,"log"));let k="replay_event"===h?"replay":h,l=(a.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(a,b,c,l).then(c=>{if(null===c)throw this.recordDroppedEvent("event_processor",k,a),new g$("An event processor returned `null`, will not send event.","log");if(b.data&&!0===b.data.__sentry__)return c;var e=function(a,b,c,d){let{beforeSend:e,beforeSendTransaction:f,beforeSendSpan:g}=b;if(g1(c)&&e)return e(c,d);if(g2(c)){if(c.spans&&g){let b=[];for(let d of c.spans){let c=g(d);c?b.push(c):(gz||(fq(()=>{console.warn("[Sentry] Deprecation warning: Returning null from `beforeSendSpan` will be disallowed from SDK version 9.0.0 onwards. The callback will only support mutating spans. To drop certain spans, configure the respective integrations directly.")}),gz=!0),a.recordDroppedEvent("before_send","span"))}c.spans=b}if(f){if(c.spans){let a=c.spans.length;c.sdkProcessingMetadata={...c.sdkProcessingMetadata,spanCountBeforeProcessing:a}}return f(c,d)}}return c}(this,d,c,b);let f=`${i} must return \`null\` or a valid event.`;if(fT(e))return e.then(a=>{if(!fR(a)&&null!==a)throw new g$(f);return a},a=>{throw new g$(`${i} rejected with ${a}`)});if(!fR(e)&&null!==e)throw new g$(f);return e}).then(d=>{if(null===d){if(this.recordDroppedEvent("before_send",k,a),f){let b=1+(a.spans||[]).length;this.recordDroppedEvent("before_send","span",b)}throw new g$(`${i} returned \`null\`, will not send event.`,"log")}let e=c&&c.getSession();if(!f&&e&&this._updateSessionFromEvent(e,d),f){let a=(d.sdkProcessingMetadata&&d.sdkProcessingMetadata.spanCountBeforeProcessing||0)-(d.spans?d.spans.length:0);a>0&&this.recordDroppedEvent("before_send","span",a)}let g=d.transaction_info;return f&&g&&d.transaction!==a.transaction&&(d.transaction_info={...g,source:"custom"}),this.sendEvent(d,b),d}).then(null,a=>{if(a instanceof g$)throw a;throw this.captureException(a,{data:{__sentry__:!0},originalException:a}),new g$(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${a}`)})}_process(a){this._numProcessing++,a.then(a=>(this._numProcessing--,a),a=>(this._numProcessing--,a))}_clearOutcomes(){let a=this._outcomes;return this._outcomes={},Object.entries(a).map(([a,b])=>{let[c,d]=a.split(":");return{reason:c,category:d,quantity:b}})}_flushOutcomes(){var a,b;fj&&fr.log("Flushing outcomes...");let c=this._clearOutcomes();if(0===c.length)return void(fj&&fr.log("No outcomes to send"));if(!this._dsn)return void(fj&&fr.log("No dsn provided, will not send outcomes"));fj&&fr.log("Sending outcomes:",c);let d=gK((a=this._options.tunnel&&gH(this._dsn))?{dsn:a}:{},[[{type:"client_report"},{timestamp:b||f6(),discarded_events:c}]]);this.sendEnvelope(d)}}function g1(a){return void 0===a.type}function g2(a){return"transaction"===a.type}function g3(a,b){if("event"===b||"transaction"===b)return Array.isArray(a)?a[1]:void 0}function g4(a,b){let c=gw(),d=gv();if(!c)return;let{beforeBreadcrumb:e=null,maxBreadcrumbs:f=100}=c.getOptions();if(f<=0)return;let g={timestamp:f6(),...a},h=e?fq(()=>e(g,b)):g;null!==h&&(c.emit&&c.emit("beforeAddBreadcrumb",h,b),d.addBreadcrumb(h,f))}let g5=new WeakMap,g6=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",'can\'t redefine non-configurable property "solana"',"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/];function g7(a){try{let b;try{b=a.exception.values[0].stacktrace.frames}catch(a){}return b?function(a=[]){for(let b=a.length-1;b>=0;b--){let c=a[b];if(c&&"<anonymous>"!==c.filename&&"[native code]"!==c.filename)return c.filename||null}return null}(b):null}catch(b){return fj&&fr.error(`Cannot extract url for event ${ga(a)}`),null}}function g8(a,b){a.mechanism=a.mechanism||{type:"generic",handled:!0},a.mechanism={...a.mechanism,..."AggregateError"===a.type&&{is_exception_group:!0},exception_id:b}}function g9(a,b,c,d){a.mechanism=a.mechanism||{type:"generic",handled:!0},a.mechanism={...a.mechanism,type:"chained",source:b,exception_id:c,parent_id:d}}function ha(a){if(!a)return{};let b=a.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!b)return{};let c=b[6]||"",d=b[8]||"";return{host:b[4],path:b[5],protocol:b[2],search:c,hash:d,relative:b[5]+c+d}}function hb(){"console"in fl&&fo.forEach(function(a){a in fl.console&&f$(fl.console,a,function(b){return fp[a]=b,function(...b){fC("console",{args:b,level:a});let c=fp[a];c&&c.apply(fl.console,b)}})})}function hc(a,b){let c=fx(a),d=fx(b);if(!c&&!d)return!0;if(c&&!d||!c&&d||d.length!==c.length)return!1;for(let a=0;a<d.length;a++){let b=d[a],e=c[a];if(b.filename!==e.filename||b.lineno!==e.lineno||b.colno!==e.colno||b.function!==e.function)return!1}return!0}function hd(a,b){let c=a.fingerprint,d=b.fingerprint;if(!c&&!d)return!0;if(c&&!d||!c&&d)return!1;try{return c.join("")===d.join("")}catch(a){return!1}}function he(a){return a.exception&&a.exception.values&&a.exception.values[0]}function hf(a){return void 0===a?void 0:a>=400&&a<500?"warning":a>=500?"error":void 0}function hg(a){return a&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(a.toString())}function hh(a,b){return!!a&&"object"==typeof a&&!!a[b]}function hi(a){return"string"==typeof a?a:a?hh(a,"url")?a.url:a.toString?a.toString():"":""}let hj=0;function hk(a,b={}){if("function"!=typeof a)return a;try{let b=a.__sentry_wrapped__;if(b)return"function"==typeof b?b:a;if(f1(a))return a}catch(b){return a}let c=function(...c){try{let d=c.map(a=>hk(a,b));return a.apply(this,d)}catch(a){throw hj++,setTimeout(()=>{hj--}),function(...a){let b=gt(fH());if(2===a.length){let[c,d]=a;return c?b.withSetScope(c,d):b.withScope(d)}b.withScope(a[0])}(d=>{var e;d.addEventProcessor(a=>(b.mechanism&&(gb(a,void 0,void 0),gc(a,b.mechanism)),a.extra={...a.extra,arguments:c},a)),gu().captureException(a,function(a){if(a)return a instanceof gn||"function"==typeof a||Object.keys(a).some(a=>gR.includes(a))?{captureContext:a}:a}(e))}),a}};try{for(let b in a)Object.prototype.hasOwnProperty.call(a,b)&&(c[b]=a[b])}catch(a){}f0(c,a),f_(a,"__sentry_wrapped__",c);try{Object.getOwnPropertyDescriptor(c,"name").configurable&&Object.defineProperty(c,"name",{get:()=>a.name})}catch(a){}return c}let hl="u"<typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function hm(a,b){var c,d;let e,f,g=ho(a,b),h={type:!(e=(c=b)&&c.name)&&hq(c)?c.message&&Array.isArray(c.message)&&2==c.message.length?c.message[0]:"WebAssembly.Exception":e,value:(f=(d=b)&&d.message)?f.error&&"string"==typeof f.error.message?f.error.message:hq(d)&&Array.isArray(d.message)&&2==d.message.length?d.message[1]:f:"No error message"};return g.length&&(h.stacktrace={frames:g}),void 0===h.type&&""===h.value&&(h.value="Unrecoverable error caught"),h}function hn(a,b){return{exception:{values:[hm(a,b)]}}}function ho(a,b){let c=b.stacktrace||b.stack||"",d=b&&hp.test(b.message)?1:0,e="number"==typeof b.framesToPop?b.framesToPop:0;try{return a(c,d,e)}catch(a){}return[]}let hp=/Minified React error #\d+;/i;function hq(a){return"u">typeof WebAssembly&&void 0!==WebAssembly.Exception&&a instanceof WebAssembly.Exception}function hr(a,b,c,d,e){let f;if(fM(b)&&b.error)return hn(a,b.error);if(fN(b)||fL(b,"DOMException")){if("stack"in b)f=hn(a,b);else{let e=b.name||(fN(b)?"DOMError":"DOMException"),g=b.message?`${e}: ${b.message}`:e;gb(f=hs(a,g,c,d),g)}return"code"in b&&(f.tags={...f.tags,"DOMException.code":`${b.code}`}),f}return fK(b)?hn(a,b):(fR(b)||fS(b)?gc(f=function(a,b,c,d){let e=gw(),f=e&&e.getOptions().normalizeDepth,g=function(a){for(let b in a)if(Object.prototype.hasOwnProperty.call(a,b)){let c=a[b];if(c instanceof Error)return c}}(b),h={__serialized__:function a(b,c=3,d=102400){let e=gJ(b,c);return~-encodeURI(JSON.stringify(e)).split(/%..|./).length>d?a(b,c-1,d):e}(b,f)};if(g)return{exception:{values:[hm(a,g)]},extra:h};let i={exception:{values:[{type:fS(b)?b.constructor.name:d?"UnhandledRejection":"Error",value:function(a,{isUnhandledRejection:b}){let c=function(a,b=40){let c=Object.keys(f2(a));c.sort();let d=c[0];if(!d)return"[object has no keys]";if(d.length>=b)return fX(d,b);for(let a=c.length;a>0;a--){let d=c.slice(0,a).join(", ");if(!(d.length>b))return a===c.length?d:fX(d,b)}return""}(a),d=b?"promise rejection":"exception";return fM(a)?`Event \`ErrorEvent\` captured as ${d} with message \`${a.message}\``:fS(a)?`Event \`${function(a){try{let b=Object.getPrototypeOf(a);return b?b.constructor.name:void 0}catch(a){}}(a)}\` (type=${a.type}) captured as ${d}`:`Object captured as ${d} with keys: ${c}`}(b,{isUnhandledRejection:d})}]},extra:h};if(c){let b=ho(a,c);b.length&&(i.exception.values[0].stacktrace={frames:b})}return i}(a,b,c,e),{synthetic:!0}):(gb(f=hs(a,b,c,d),`${b}`,void 0),gc(f,{synthetic:!0})),f)}function hs(a,b,c,d){let e={};if(d&&c){let d=ho(a,c);d.length&&(e.exception={values:[{value:b,stacktrace:{frames:d}}]}),gc(e,{synthetic:!0})}if(fP(b)){let{__sentry_template_string__:a,__sentry_template_values__:c}=b;return e.logentry={message:a,params:c},e}return e.message=b,e}class ht extends g0{constructor(a){const b={parentSpanIsAlwaysRootSpan:!0,...a};!function(a,b,c=[b],d="npm"){let e=a._metadata||{};e.sdk||(e.sdk={name:`sentry.javascript.${b}`,packages:c.map(a=>({name:`${d}:@sentry/${a}`,version:fk})),version:fk}),a._metadata=e}(b,"browser",["browser"],fl.SENTRY_SDK_SOURCE||"npm"),super(b),b.sendClientReports&&fl.document&&fl.document.addEventListener("visibilitychange",()=>{"hidden"===fl.document.visibilityState&&this._flushOutcomes()})}eventFromException(a,b){var c,d;let e;return c=this._options.stackParser,d=this._options.attachStacktrace,gc(e=hr(c,a,b&&b.syntheticException||void 0,d)),e.level="error",b&&b.event_id&&(e.event_id=b.event_id),ge(e)}eventFromMessage(a,b="info",c){return function(a,b,c="info",d,e){let f=hs(a,b,d&&d.syntheticException||void 0,e);return f.level=c,d&&d.event_id&&(f.event_id=d.event_id),ge(f)}(this._options.stackParser,a,b,c,this._options.attachStacktrace)}captureUserFeedback(a){if(!this._isEnabled())return void(hl&&fr.warn("SDK not enabled, will not capture user feedback."));let b=function(a,{metadata:b,tunnel:c,dsn:d}){return gK({event_id:a.event_id,sent_at:(new Date).toISOString(),...b&&b.sdk&&{sdk:{name:b.sdk.name,version:b.sdk.version}},...!!c&&!!d&&{dsn:gH(d)}},[[{type:"user_report"},a]])}(a,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(b)}_prepareEvent(a,b,c){return a.platform=a.platform||"javascript",super._prepareEvent(a,b,c)}}let hu="u"<typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function hv(){if(!fl.document)return;let a=fC.bind(null,"dom"),b=hw(a,!0);fl.document.addEventListener("click",b,!1),fl.document.addEventListener("keypress",b,!1),["EventTarget","Node"].forEach(b=>{let c=fl[b],d=c&&c.prototype;d&&d.hasOwnProperty&&d.hasOwnProperty("addEventListener")&&(f$(d,"addEventListener",function(b){return function(c,d,e){if("click"===c||"keypress"==c)try{let d=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},f=d[c]=d[c]||{refCount:0};if(!f.handler){let d=hw(a);f.handler=d,b.call(this,c,d,e)}f.refCount++}catch(a){}return b.call(this,c,d,e)}}),f$(d,"removeEventListener",function(a){return function(b,c,d){if("click"===b||"keypress"==b)try{let c=this.__sentry_instrumentation_handlers__||{},e=c[b];e&&(e.refCount--,e.refCount<=0&&(a.call(this,b,e.handler,d),e.handler=void 0,delete c[b]),0===Object.keys(c).length&&delete this.__sentry_instrumentation_handlers__)}catch(a){}return a.call(this,b,c,d)}}))})}function hw(a,b=!1){return c=>{var d;if(!c||c._sentryCaptured)return;let e=function(a){try{return a.target}catch(a){return null}}(c);if(d=c.type,"keypress"===d&&(!e||!e.tagName||"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName&&!e.isContentEditable))return;f_(c,"_sentryCaptured",!0),e&&!e._sentryId&&f_(e,"_sentryId",f8());let f="keypress"===c.type?"input":c.type;!function(a){if(a.type!==i)return!1;try{if(!a.target||a.target._sentryId!==j)return!1}catch(a){}return!0}(c)&&(a({event:c,name:f,global:b}),i=c.type,j=e?e._sentryId:void 0),clearTimeout(h),h=fl.setTimeout(()=>{j=void 0,i=void 0},1e3)}}function hx(a){let b="history";fA(b,a),fB(b,hy)}function hy(){let a,b,c;if(b=(a=fl.chrome)&&a.app&&a.app.runtime,c="history"in fl&&!!fl.history.pushState&&!!fl.history.replaceState,b||!c)return;let d=fl.onpopstate;function e(a){return function(...b){let c=b.length>2?b[2]:void 0;if(c){let a=k,b=String(c);k=b,fC("history",{from:a,to:b})}return a.apply(this,b)}}fl.onpopstate=function(...a){let b=fl.location.href,c=k;if(k=b,fC("history",{from:c,to:b}),d)try{return d.apply(this,a)}catch(a){}},f$(fl.history,"pushState",e),f$(fl.history,"replaceState",e)}let hz={},hA="__sentry_xhr_v3__";function hB(){if(!fl.XMLHttpRequest)return;let a=XMLHttpRequest.prototype;a.open=new Proxy(a.open,{apply(a,b,c){let d=Error(),e=1e3*f7(),f=fO(c[0])?c[0].toUpperCase():void 0,g=function(a){if(fO(a))return a;try{return a.toString()}catch(a){}}(c[1]);if(!f||!g)return a.apply(b,c);b[hA]={method:f,url:g,request_headers:{}},"POST"===f&&g.match(/sentry_key/)&&(b.__sentry_own_request__=!0);let h=()=>{let a=b[hA];if(a&&4===b.readyState){try{a.status_code=b.status}catch(a){}fC("xhr",{endTimestamp:1e3*f7(),startTimestamp:e,xhr:b,virtualError:d})}};return"onreadystatechange"in b&&"function"==typeof b.onreadystatechange?b.onreadystatechange=new Proxy(b.onreadystatechange,{apply:(a,b,c)=>(h(),a.apply(b,c))}):b.addEventListener("readystatechange",h),b.setRequestHeader=new Proxy(b.setRequestHeader,{apply(a,b,c){let[d,e]=c,f=b[hA];return f&&fO(d)&&fO(e)&&(f.request_headers[d.toLowerCase()]=e),a.apply(b,c)}}),a.apply(b,c)}}),a.send=new Proxy(a.send,{apply(a,b,c){let d=b[hA];return d&&(void 0!==c[0]&&(d.body=c[0]),fC("xhr",{startTimestamp:1e3*f7(),xhr:b})),a.apply(b,c)}})}function hC(a,b=function(a){let b=hz[a];if(b)return b;let c=fl[a];if(hg(c))return hz[a]=c.bind(fl);let d=fl.document;if(d&&"function"==typeof d.createElement)try{let b=d.createElement("iframe");b.hidden=!0,d.head.appendChild(b);let e=b.contentWindow;e&&e[a]&&(c=e[a]),d.head.removeChild(b)}catch(b){hu&&fr.warn(`Could not create sandbox iframe for ${a} check, bailing to window.${a}: `,b)}return c?hz[a]=c.bind(fl):c}("fetch")){let c=0,d=0;return function(a,b,c=function(a){let b=[];function c(a){return b.splice(b.indexOf(a),1)[0]||Promise.resolve(void 0)}return{$:b,add:function(d){if(!(void 0===a||b.length<a))return gf(new g$("Not adding Promise because buffer limit was reached."));let e=d();return -1===b.indexOf(e)&&b.push(e),e.then(()=>c(e)).then(null,()=>c(e).then(null,()=>{})),e},drain:function(a){return new gg((c,d)=>{let e=b.length;if(!e)return c(!0);let f=setTimeout(()=>{a&&a>0&&c(!1)},a);b.forEach(a=>{ge(a).then(()=>{--e||(clearTimeout(f),c(!0))},d)})})}}}(a.bufferSize||64)){let d={};return{send:function(e){let f=[];if(gL(e,(b,c)=>{let e=gN[c];if(function(a,b,c=Date.now()){return(a[b]||a.all||0)>c}(d,e)){let d=g3(b,c);a.recordDroppedEvent("ratelimit_backoff",e,d)}else f.push(b)}),0===f.length)return ge({});let g=gK(e[0],f),h=b=>{gL(g,(c,d)=>{let e=g3(c,d);a.recordDroppedEvent(b,gN[d],e)})};return c.add(()=>b({body:function(a){let[b,c]=a,d=JSON.stringify(b);function e(a){"string"==typeof d?d="string"==typeof a?d+a:[gM(d),a]:d.push("string"==typeof a?gM(a):a)}for(let a of c){let[b,c]=a;if(e(`
${JSON.stringify(b)}
`),"string"==typeof c||c instanceof Uint8Array)e(c);else{let a;try{a=JSON.stringify(c)}catch(b){a=JSON.stringify(gJ(c))}e(a)}}return"string"==typeof d?d:function(a){let b=new Uint8Array(a.reduce((a,b)=>a+b.length,0)),c=0;for(let d of a)b.set(d,c),c+=d.length;return b}(d)}(g)}).then(a=>(void 0!==a.statusCode&&(a.statusCode<200||a.statusCode>=300)&&fj&&fr.warn(`Sentry responded with status code ${a.statusCode} to sent event.`),d=function(a,{statusCode:b,headers:c},d=Date.now()){let e={...a},f=c&&c["x-sentry-rate-limits"],g=c&&c["retry-after"];if(f)for(let a of f.trim().split(",")){let[b,c,,,f]=a.split(":",5),g=parseInt(b,10),h=1e3*(isNaN(g)?60:g);if(c)for(let a of c.split(";"))"metric_bucket"===a&&f&&!f.split(";").includes("custom")||(e[a]=d+h);else e.all=d+h}else g?e.all=d+function(a,b=Date.now()){let c=parseInt(`${a}`,10);if(!isNaN(c))return 1e3*c;let d=Date.parse(`${a}`);return isNaN(d)?6e4:d-b}(g,d):429===b&&(e.all=d+6e4);return e}(d,a),a),a=>{throw h("network_error"),a})).then(a=>a,a=>{if(a instanceof g$)return fj&&fr.error("Skipped sending event because buffer is full."),h("queue_overflow"),ge({});throw a})},flush:a=>c.drain(a)}}(a,function(e){let f=e.body.length;c+=f,d++;let g={body:e.body,method:"POST",referrerPolicy:"origin",headers:a.headers,keepalive:c<=6e4&&d<15,...a.fetchOptions};if(!b)return hz.fetch=void 0,gf("No fetch implementation available");try{return b(a.url,g).then(a=>(c-=f,d--,{statusCode:a.status,headers:{"x-sentry-rate-limits":a.headers.get("X-Sentry-Rate-Limits"),"retry-after":a.headers.get("Retry-After")}}))}catch(a){return hz.fetch=void 0,c-=f,d--,gf(a)}})}function hD(a,b,c,d){let e={filename:a,function:"<anonymous>"===b?"?":b,in_app:!0};return void 0!==c&&(e.lineno=c),void 0!==d&&(e.colno=d),e}let hE=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,hF=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,hG=/\((\S*)(?::(\d+))(?::(\d+))\)/,hH=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,hI=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,hJ=function(...a){let b=a.sort((a,b)=>a[0]-b[0]).map(a=>a[1]);return(a,c=0,d=0)=>{let e=[],f=a.split("\n");for(let a=c;a<f.length;a++){let c=f[a];if(c.length>1024)continue;let g=fs.test(c)?c.replace(fs,"$1"):c;if(!g.match(/\S*Error: /)){for(let a of b){let b=a(g);if(b){e.push(b);break}}if(e.length>=50+d)break}}var g=e.slice(d);if(!g.length)return[];let h=Array.from(g);return/sentryWrapped/.test(fu(h).function||"")&&h.pop(),h.reverse(),ft.test(fu(h).function||"")&&(h.pop(),ft.test(fu(h).function||"")&&h.pop()),h.slice(0,50).map(a=>({...a,filename:a.filename||fu(h).filename,function:a.function||"?"}))}}([30,a=>{let b=hE.exec(a);if(b){let[,a,c,d]=b;return hD(a,"?",+c,+d)}let c=hF.exec(a);if(c){if(c[2]&&0===c[2].indexOf("eval")){let a=hG.exec(c[2]);a&&(c[2]=a[1],c[3]=a[2],c[4]=a[3])}let[a,b]=hK(c[1]||"?",c[2]);return hD(b,a,c[3]?+c[3]:void 0,c[4]?+c[4]:void 0)}}],[50,a=>{let b=hH.exec(a);if(b){if(b[3]&&b[3].indexOf(" > eval")>-1){let a=hI.exec(b[3]);a&&(b[1]=b[1]||"eval",b[3]=a[1],b[4]=a[2],b[5]="")}let a=b[3],c=b[1]||"?";return[c,a]=hK(c,a),hD(a,c,b[4]?+b[4]:void 0,b[5]?+b[5]:void 0)}}]),hK=(a,b)=>{let c=-1!==a.indexOf("safari-extension"),d=-1!==a.indexOf("safari-web-extension");return c||d?[-1!==a.indexOf("@")?a.split("@")[0]:"?",c?`safari-extension:${b}`:`safari-web-extension:${b}`]:[a,b]},hL=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"];function hM(a){return function(...b){let c=b[0];return b[0]=hk(c,{mechanism:{data:{function:fw(a)},handled:!1,type:"instrument"}}),a.apply(this,b)}}function hN(a){return function(b){return a.apply(this,[hk(b,{mechanism:{data:{function:"requestAnimationFrame",handler:fw(a)},handled:!1,type:"instrument"}})])}}function hO(a){return function(...b){let c=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(a=>{a in c&&"function"==typeof c[a]&&f$(c,a,function(b){let c={mechanism:{data:{function:a,handler:fw(b)},handled:!1,type:"instrument"}},d=f1(b);return d&&(c.mechanism.data.handler=fw(d)),hk(b,c)})}),a.apply(this,b)}}function hP(a){let b=fl[a],c=b&&b.prototype;c&&c.hasOwnProperty&&c.hasOwnProperty("addEventListener")&&(f$(c,"addEventListener",function(b){return function(c,d,e){try{"function"==typeof d.handleEvent&&(d.handleEvent=hk(d.handleEvent,{mechanism:{data:{function:"handleEvent",handler:fw(d),target:a},handled:!1,type:"instrument"}}))}catch(a){}return b.apply(this,[c,hk(d,{mechanism:{data:{function:"addEventListener",handler:fw(d),target:a},handled:!1,type:"instrument"}}),e])}}),f$(c,"removeEventListener",function(a){return function(b,c,d){try{let e=c.__sentry_wrapped__;e&&a.call(this,b,e,d)}catch(a){}return a.call(this,b,c,d)}}))}function hQ(a){hl&&fr.log(`Global Handler attached: ${a}`)}function hR(){let a=gw();return a&&a.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}var hS="loading",hT="loaded",hU="joining-meeting",hV="joined-meeting",hW="left-meeting",hX="error",hY="unknown",hZ="no-room",h$="loaded",h_="recording-started",h0="recording-stopped",h1="fullscreen",h2="exited-fullscreen",h3="input-settings-updated",h4="nonfatal-error",h5="error",h6="iframe-call-message",h7="local-screen-start",h8="daily-method-update-live-streaming-endpoints",h9="transmit-log",ia="daily-custom-track",ib={NONE:"none",BGBLUR:"background-blur",BGIMAGE:"background-image",FACE_DETECTION:"face-detection"},ic={NONE:"none",NOISE_CANCELLATION:"noise-cancellation"},id={PLAY:"play",PAUSE:"pause"},ie=["jpg","png","jpeg"],ig="sip-call-transfer";function ih(){return!ii(),""}function ii(){return"u">typeof navigator&&navigator.product&&"ReactNative"===navigator.product}function ij(){if(ii()||!document)return!1;var a=document.createElement("iframe");return!!a.requestFullscreen||!!a.webkitRequestFullscreen}var ik="none",il=function(){try{var a,b=document.createElement("canvas"),c=!1;(a=b.getContext("webgl2",{failIfMajorPerformanceCaveat:!0}))||(c=!0,a=b.getContext("webgl2"));var d=null!=a;return b.remove(),d?c?"software":"hardware":ik}catch(a){return ik}}();function im(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!ii()&&il!==ik&&(a?!ir()&&["Chrome","Firefox"].includes(is()):function(){if(ir())return!1;var a=is();if("Safari"===a){var b=iv();if(b.major<15||15===b.major&&b.minor<4)return!1}return"Chrome"===a?iu().major>=77:"Firefox"===a?iw().major>=97:["Chrome","Firefox","Safari"].includes(a)}())}function io(){if(ii()||iq()||"u"<typeof AudioWorkletNode)return!1;switch(is()){case"Chrome":case"Firefox":return!0;case"Safari":var a=it();return a.major>17||17===a.major&&a.minor>=4}return!1}function ip(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&"u">typeof MediaStreamTrack&&!function(){if(is(),!ih())return!0}()}function iq(){return ih().match(/Linux; Android/)}function ir(){var a=ih(),b=a.match(/Mac/)&&(!ii(),!1);return!!(a.match(/Mobi/)||a.match(/Android/)||b)||!!ih().match(/DailyAnd\//)||void 0}function is(){}function it(){switch(is()){case"Chrome":return iu();case"Safari":return iv();case"Firefox":return iw();case"Edge":return{major:0,minor:0}}}function iu(){return{major:0,minor:0,build:0,patch:0,opera:!1}}function iv(){return{major:0,minor:0,point:0}}function iw(){return{major:0,minor:0}}var ix=eM(function a(){eI(this,a)},[{key:"addListenerForMessagesFromCallMachine",value:function(a,b,c){ff()}},{key:"addListenerForMessagesFromDailyJs",value:function(a,b,c){ff()}},{key:"sendMessageToCallMachine",value:function(a,b,c,d){ff()}},{key:"sendMessageToDailyJs",value:function(a,b){ff()}},{key:"removeListener",value:function(a){ff()}}]);function iy(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function iz(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?iy(Object(c),!0).forEach(function(b){eR(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):iy(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function iA(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(iA=function(){return!!a})()}var iB=function(){function a(){var b,c,d;return eI(this,a),c=eO(c=a),(b=eN(this,iA()?Reflect.construct(c,d||[],eO(this).constructor):c.apply(this,d)))._wrappedListeners={},b._messageCallbacks={},b}return eQ(a,ix),eM(a,[{key:"addListenerForMessagesFromCallMachine",value:function(a,b,c){var d=this,e=function(e){if(e.data&&"iframe-call-message"===e.data.what&&(!e.data.callClientId||e.data.callClientId===b)&&(!e.data.from||"module"!==e.data.from)){var f=iz({},e.data);if(delete f.from,f.callbackStamp&&d._messageCallbacks[f.callbackStamp]){var g=f.callbackStamp;d._messageCallbacks[g].call(c,f),delete d._messageCallbacks[g]}delete f.what,delete f.callbackStamp,a.call(c,f)}};this._wrappedListeners[a]=e,window.addEventListener("message",e)}},{key:"addListenerForMessagesFromDailyJs",value:function(a,b,c){var d=function(d){var e;if(!(!d.data||d.data.what!==h6||!d.data.action||d.data.from&&"module"!==d.data.from||d.data.callClientId&&b&&d.data.callClientId!==b||null!=d&&null!=(e=d.data)&&e.callFrameId)){var f=d.data;a.call(c,f)}};this._wrappedListeners[a]=d,window.addEventListener("message",d)}},{key:"sendMessageToCallMachine",value:function(a,b,c,d){if(!c)throw Error("undefined callClientId. Are you trying to use a DailyCall instance previously destroyed?");var e=iz({},a);if(e.what=h6,e.from="module",e.callClientId=c,b){var f=fe();this._messageCallbacks[f]=b,e.callbackStamp=f}var g=d?d.contentWindow:window,h=this._callMachineTargetOrigin(d);h&&g.postMessage(e,h)}},{key:"sendMessageToDailyJs",value:function(a,b){a.what=h6,a.callClientId=b,a.from="embedded",window.postMessage(a,this._targetOriginFromWindowLocation())}},{key:"removeListener",value:function(a){var b=this._wrappedListeners[a];b&&(window.removeEventListener("message",b),delete this._wrappedListeners[a])}},{key:"forwardPackagedMessageToCallMachine",value:function(a,b,c){var d=iz({},a);d.callClientId=c;var e=b?b.contentWindow:window,f=this._callMachineTargetOrigin(b);f&&e.postMessage(d,f)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(a,b){var c=function(c){!c.data||"iframe-call-message"!==c.data.what||c.data.callClientId&&c.data.callClientId!==b||c.data.from&&"module"===c.data.from||a(c.data)};return this._wrappedListeners[a]=c,window.addEventListener("message",c),a}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(a){var b=this._wrappedListeners[a];b&&(window.removeEventListener("message",b),delete this._wrappedListeners[a])}},{key:"_callMachineTargetOrigin",value:function(a){return a?a.src?new URL(a.src).origin:void 0:this._targetOriginFromWindowLocation()}},{key:"_targetOriginFromWindowLocation",value:function(){return"file:"===window.location.protocol?"*":window.location.origin}}])}();function iC(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function iD(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(iD=function(){return!!a})()}var iE=function(){function b(){var c,d,e;return eI(this,b),d=eO(d=b),c=eN(this,iD()?Reflect.construct(d,e||[],eO(this).constructor):d.apply(this,e)),a.g.callMachineToDailyJsEmitter=a.g.callMachineToDailyJsEmitter||new eY.EventEmitter,a.g.dailyJsToCallMachineEmitter=a.g.dailyJsToCallMachineEmitter||new eY.EventEmitter,c._wrappedListeners={},c._messageCallbacks={},c}return eQ(b,ix),eM(b,[{key:"addListenerForMessagesFromCallMachine",value:function(b,c,d){this._addListener(b,a.g.callMachineToDailyJsEmitter,c,d,"received call machine message")}},{key:"addListenerForMessagesFromDailyJs",value:function(b,c,d){this._addListener(b,a.g.dailyJsToCallMachineEmitter,c,d,"received daily-js message")}},{key:"sendMessageToCallMachine",value:function(b,c,d){this._sendMessage(b,a.g.dailyJsToCallMachineEmitter,d,c,"sending message to call machine")}},{key:"sendMessageToDailyJs",value:function(b,c){this._sendMessage(b,a.g.callMachineToDailyJsEmitter,c,null,"sending message to daily-js")}},{key:"removeListener",value:function(b){var c=this._wrappedListeners[b];c&&(a.g.callMachineToDailyJsEmitter.removeListener("message",c),a.g.dailyJsToCallMachineEmitter.removeListener("message",c),delete this._wrappedListeners[b])}},{key:"_addListener",value:function(a,b,c,d,e){var f=this,g=function(b){if(b.callClientId===c){if(b.callbackStamp&&f._messageCallbacks[b.callbackStamp]){var e=b.callbackStamp;f._messageCallbacks[e].call(d,b),delete f._messageCallbacks[e]}a.call(d,b)}};this._wrappedListeners[a]=g,b.addListener("message",g)}},{key:"_sendMessage",value:function(a,b,c,d,e){var f=function(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?iC(Object(c),!0).forEach(function(b){eR(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):iC(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}({},a);if(f.callClientId=c,d){var g=fe();this._messageCallbacks[g]=d,f.callbackStamp=g}b.emit("message",f)}}])}(),iF="replace",iG="shallow-merge",iH=[iF,iG],iI=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=b.data,d=b.mergeStrategy,e=void 0===d?iF:d;eI(this,a),a._validateMergeStrategy(e),a._validateData(c,e),this.mergeStrategy=e,this.data=c}return eM(a,[{key:"isNoOp",value:function(){return a.isNoOpUpdate(this.data,this.mergeStrategy)}}],[{key:"isNoOpUpdate",value:function(a,b){return 0===Object.keys(a).length&&b===iG}},{key:"_validateMergeStrategy",value:function(a){if(!iH.includes(a))throw Error("Unrecognized mergeStrategy provided. Options are: [".concat(iH,"]"))}},{key:"_validateData",value:function(a,b){if(!function(a){if(null==a||"object"!==eJ(a))return!1;var b=Object.getPrototypeOf(a);return null==b||b===Object.prototype}(a))throw Error("Meeting session data must be a plain (map-like) object");try{if(c=JSON.stringify(a),b===iF){var c,d=JSON.parse(c);e0(d,a)||console.warn("The meeting session data provided will be modified when serialized.",d,a)}else if(b===iG){for(var e in a)if(Object.hasOwnProperty.call(a,e)&&void 0!==a[e]){var f=JSON.parse(JSON.stringify(a[e]));e0(a[e],f)||console.warn("At least one key in the meeting session data provided will be modified when serialized.",f,a[e])}}}catch(a){throw Error("Meeting session data must be serializable to JSON: ".concat(a))}if(c.length>102400)throw Error("Meeting session data is too large (".concat(c.length," characters). Maximum size suppported is ").concat(102400,"."))}}])}();function iJ(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(iJ=function(){return!!a})()}function iK(a){var b="function"==typeof Map?new Map:void 0;return(iK=function(a){if(null===a||!function(a){try{return -1!==Function.toString.call(a).indexOf("[native code]")}catch(b){return"function"==typeof a}}(a))return a;if("function"!=typeof a)throw TypeError("Super expression must either be null or a function");if(void 0!==b){if(b.has(a))return b.get(a);b.set(a,c)}function c(){return function(a,b,c){if(iJ())return Reflect.construct.apply(null,arguments);var d=[null];d.push.apply(d,b);var e=new(a.bind.apply(a,d));return c&&eP(e,c.prototype),e}(a,arguments,eO(this).constructor)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),eP(c,a)})(a)}function iL(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(iL=function(){return!!a})()}function iM(a){var b,c=null==(b=window._daily)?void 0:b.pendings;if(c){var d=c.indexOf(a);-1!==d&&c.splice(d,1)}}var iN=eM(function a(b){eI(this,a),this._currentLoad=null,this._callClientId=b},[{key:"load",value:function(){var a,b=this,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=arguments.length>1?arguments[1]:void 0,e=arguments.length>2?arguments[2]:void 0;this.loaded?(window._daily.instances[this._callClientId].callMachine.reset(),d(!0)):(a=this._callClientId,window._daily.pendings.push(a),this._currentLoad&&this._currentLoad.cancel(),this._currentLoad=new iO(c,function(){d(!1)},function(a,c){c||iM(b._callClientId),e(a,c)}),this._currentLoad.start())}},{key:"cancel",value:function(){this._currentLoad&&this._currentLoad.cancel(),iM(this._callClientId)}},{key:"loaded",get:function(){return this._currentLoad&&this._currentLoad.succeeded}}]),iO=eM(function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1?arguments[1]:void 0,d=arguments.length>2?arguments[2]:void 0;eI(this,a),this._attemptsRemaining=3,this._currentAttempt=null,this._dailyConfig=b,this._successCallback=c,this._failureCallback=d},[{key:"start",value:function(){var a=this;if(!this._currentAttempt){var b=function(c){a._currentAttempt.cancelled||(a._attemptsRemaining--,a._failureCallback(c,a._attemptsRemaining>0),a._attemptsRemaining<=0||setTimeout(function(){a._currentAttempt.cancelled||(a._currentAttempt=new iQ(a._dailyConfig,a._successCallback,b),a._currentAttempt.start())},3e3))};this._currentAttempt=new iQ(this._dailyConfig,this._successCallback,b),this._currentAttempt.start()}}},{key:"cancel",value:function(){this._currentAttempt&&this._currentAttempt.cancel()}},{key:"cancelled",get:function(){return this._currentAttempt&&this._currentAttempt.cancelled}},{key:"succeeded",get:function(){return this._currentAttempt&&this._currentAttempt.succeeded}}]),iP=function(){function a(){var b,c;return eI(this,a),c=arguments,b=eO(b=a),eN(this,iL()?Reflect.construct(b,c||[],eO(this).constructor):b.apply(this,c))}return eQ(a,iK(Error)),eM(a)}(),iQ=eM(function a(b,c,d){eI(this,a),this._loadAttemptImpl=ii()||!b.avoidEval?new iR(b,c,d):new iS(b,c,d)},[{key:"start",value:(m=eT(function*(){return this._loadAttemptImpl.start()}),function(){return m.apply(this,arguments)})},{key:"cancel",value:function(){this._loadAttemptImpl.cancel()}},{key:"cancelled",get:function(){return this._loadAttemptImpl.cancelled}},{key:"succeeded",get:function(){return this._loadAttemptImpl.succeeded}}]),iR=eM(function a(b,c,d){eI(this,a),this.cancelled=!1,this.succeeded=!1,this._networkTimedOut=!1,this._networkTimeout=null,this._iosCache="u">typeof iOSCallObjectBundleCache&&iOSCallObjectBundleCache,this._refetchHeaders=null,this._dailyConfig=b,this._successCallback=c,this._failureCallback=d},[{key:"start",value:(q=eT(function*(){var a=fh(this._dailyConfig);(yield this._tryLoadFromIOSCache(a))||this._loadFromNetwork(a)}),function(){return q.apply(this,arguments)})},{key:"cancel",value:function(){clearTimeout(this._networkTimeout),this.cancelled=!0}},{key:"_tryLoadFromIOSCache",value:(p=eT(function*(a){if(!this._iosCache)return!1;try{var b=yield this._iosCache.get(a);return!!this.cancelled||!!b&&(b.code?(Function('"use strict";'+b.code)(),this.succeeded=!0,this._successCallback(),!0):(this._refetchHeaders=b.refetchHeaders,!1))}catch(a){return!1}}),function(a){return p.apply(this,arguments)})},{key:"_loadFromNetwork",value:(o=eT(function*(a){var b=this;this._networkTimeout=setTimeout(function(){b._networkTimedOut=!0,b._failureCallback({msg:"Timed out (>".concat(2e4," ms) when loading call object bundle ").concat(a),type:"timeout"})},2e4);try{var c=this._refetchHeaders?{headers:this._refetchHeaders}:{},d=yield fetch(a,c);if(clearTimeout(this._networkTimeout),this.cancelled||this._networkTimedOut)throw new iP;var e=yield this._getBundleCodeFromResponse(a,d);if(this.cancelled)throw new iP;Function('"use strict";'+e)(),this._iosCache&&this._iosCache.set(a,e,d.headers),this.succeeded=!0,this._successCallback()}catch(b){if(clearTimeout(this._networkTimeout),b instanceof iP||this.cancelled||this._networkTimedOut)return;this._failureCallback({msg:"Failed to load call object bundle ".concat(a,": ").concat(b),type:b.message})}}),function(a){return o.apply(this,arguments)})},{key:"_getBundleCodeFromResponse",value:(n=eT(function*(a,b){if(b.ok)return yield b.text();if(this._iosCache&&304===b.status)return(yield this._iosCache.renew(a,b.headers)).code;throw Error("Received ".concat(b.status," response"))}),function(a,b){return n.apply(this,arguments)})}]),iS=eM(function a(b,c,d){eI(this,a),this.cancelled=!1,this.succeeded=!1,this._dailyConfig=b,this._successCallback=c,this._failureCallback=d,this._attemptId=fe(),this._networkTimeout=null,this._scriptElement=null},[{key:"start",value:function(){window._dailyCallMachineLoadWaitlist||(window._dailyCallMachineLoadWaitlist=new Set);var a=fh(this._dailyConfig);"object"===("u"<typeof document?"undefined":eJ(document))?this._startLoading(a):this._failureCallback({msg:"Call object bundle must be loaded in a DOM/web context",type:"missing context"})}},{key:"cancel",value:function(){this._stopLoading(),this.cancelled=!0}},{key:"_startLoading",value:function(a){var b=this;this._signUpForCallMachineLoadWaitlist(),this._networkTimeout=setTimeout(function(){b._stopLoading(),b._failureCallback({msg:"Timed out (>".concat(2e4," ms) when loading call object bundle ").concat(a),type:"timeout"})},2e4);var c=document.getElementsByTagName("head")[0],d=document.createElement("script");this._scriptElement=d,d.onload=function(){b._stopLoading(),b.succeeded=!0,b._successCallback()},d.onerror=function(a){b._stopLoading(),b._failureCallback({msg:"Failed to load call object bundle ".concat(a.target.src),type:a.message})},d.src=a,c.appendChild(d)}},{key:"_stopLoading",value:function(){this._withdrawFromCallMachineLoadWaitlist(),clearTimeout(this._networkTimeout),this._scriptElement&&(this._scriptElement.onload=null,this._scriptElement.onerror=null)}},{key:"_signUpForCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.add(this._attemptId)}},{key:"_withdrawFromCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.delete(this._attemptId)}}]),iT=function(a,b,c){return!0===iV(a.local,b,c)},iU=function(a,b,c,d){var e=iW(a,b,c,d);return e&&e.pendingTrack},iV=function(a,b,c){if(!a)return!1;var d=function(a){switch(a){case"avatar":return!0;case"staged":return a;default:return!!a}},e=a.public.subscribedTracks;return e&&e[b]?d(-1===["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo"].indexOf(c)&&e[b].custom?[!0,"staged"].includes(e[b].custom)?e[b].custom:e[b].custom[c]:e[b][c]):!e||d(e.ALL)},iW=function(a,b,c,d){var e=Object.values(a.streams||{}).filter(function(a){return a.participantId===b&&a.type===c&&a.pendingTrack&&a.pendingTrack.kind===d}).sort(function(a,b){return new Date(b.starttime)-new Date(a.starttime)});return e&&e[0]},iX=function(a,b){var c=a.local.public.customTracks;if(c&&c[b])return c[b].track};function iY(a,b){for(var c=b.getState(),d=0,e=["cam","screen"];d<e.length;d++)for(var f=e[d],g=0,h=["video","audio"];g<h.length;g++){var i=h[g],j="cam"===f?i:"screen".concat(i.charAt(0).toUpperCase()+i.slice(1)),k=a.tracks[j];if(k){var l=a.local?c.local.streams&&c.local.streams[f]&&c.local.streams[f].stream&&c.local.streams[f].stream["get".concat("video"===i?"Video":"Audio","Tracks")]()[0]:iU(c,a.session_id,f,i);"playable"===k.state&&(k.track=l),k.persistentTrack=l}}}function iZ(a,b){try{var c,d=b.getState();for(var e in a.tracks){if(c=e,!["video","audio","screenVideo","screenAudio"].includes(c)){var f=a.tracks[e].kind;if(f){var g=a.tracks[e];if(g){var h=a.local?iX(d,e):iU(d,a.session_id,e,f);"playable"===g.state&&(a.tracks[e].track=h),g.persistentTrack=h}}else console.error("unknown type for custom track")}}}catch(a){console.error(a)}}function i$(a,b,c){var d=c.getState();if(a.local){if(a.audio)try{a.audioTrack=d.local.streams.cam.stream.getAudioTracks()[0],a.audioTrack||(a.audio=!1)}catch(a){}if(a.video)try{a.videoTrack=d.local.streams.cam.stream.getVideoTracks()[0],a.videoTrack||(a.video=!1)}catch(a){}if(a.screen)try{a.screenVideoTrack=d.local.streams.screen.stream.getVideoTracks()[0],a.screenAudioTrack=d.local.streams.screen.stream.getAudioTracks()[0],a.screenVideoTrack||a.screenAudioTrack||(a.screen=!1)}catch(a){}}else{var e=!0;try{var f=d.participants[a.session_id];f&&f.public&&f.public.rtcType&&"peer-to-peer"===f.public.rtcType.impl&&f.private&&!["connected","completed"].includes(f.private.peeringState)&&(e=!1)}catch(a){console.error(a)}if(!e)return a.audio=!1,a.audioTrack=!1,a.video=!1,a.videoTrack=!1,a.screen=!1,void(a.screenTrack=!1);try{if(d.streams,a.audio&&iT(d,a.session_id,"cam-audio")){var g=iU(d,a.session_id,"cam","audio");g&&(b&&b.audioTrack&&b.audioTrack.id===g.id?a.audioTrack=g:g.muted||(a.audioTrack=g)),a.audioTrack||(a.audio=!1)}if(a.video&&iT(d,a.session_id,"cam-video")){var h=iU(d,a.session_id,"cam","video");h&&(b&&b.videoTrack&&b.videoTrack.id===h.id?a.videoTrack=h:h.muted||(a.videoTrack=h)),a.videoTrack||(a.video=!1)}if(a.screen&&iT(d,a.session_id,"screen-audio")){var i=iU(d,a.session_id,"screen","audio");i&&(b&&b.screenAudioTrack&&b.screenAudioTrack.id===i.id?a.screenAudioTrack=i:i.muted||(a.screenAudioTrack=i))}if(a.screen&&iT(d,a.session_id,"screen-video")){var j=iU(d,a.session_id,"screen","video");j&&(b&&b.screenVideoTrack&&b.screenVideoTrack.id===j.id?a.screenVideoTrack=j:j.muted||(a.screenVideoTrack=j))}a.screenVideoTrack||a.screenAudioTrack||(a.screen=!1)}catch(a){console.error("unexpected error matching up tracks",a)}}}function i_(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}var i0=new Map,i1=null;function i2(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}var i3=new Map,i4=null;function i5(){var a;return ii()||void 0!==(null==(a=navigator.mediaDevices)?void 0:a.ondevicechange)}var i6=new Set;function i7(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function i8(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?i7(Object(c),!0).forEach(function(b){eR(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):i7(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}var i9=Object.freeze({VIDEO:"video",AUDIO:"audio",SCREEN_VIDEO:"screenVideo",SCREEN_AUDIO:"screenAudio",CUSTOM_VIDEO:"customVideo",CUSTOM_AUDIO:"customAudio"}),ja=Object.freeze({PARTICIPANTS:"participants",STREAMING:"streaming",TRANSCRIPTION:"transcription"}),jb=Object.values(i9),jc=["v","a","sv","sa","cv","ca"];Object.freeze(jb.reduce(function(a,b,c){return a[b]=jc[c],a},{})),Object.freeze(jc.reduce(function(a,b,c){return a[b]=jb[c],a},{}));var jd=[i9.VIDEO,i9.AUDIO,i9.SCREEN_VIDEO,i9.SCREEN_AUDIO],je=Object.values(ja),jf=["p","s","t"];Object.freeze(je.reduce(function(a,b,c){return a[b]=jf[c],a},{})),Object.freeze(jf.reduce(function(a,b,c){return a[b]=je[c],a},{}));var jg=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=b.base,d=b.byUserId,e=b.byParticipantId;eI(this,a),this.base=c,this.byUserId=d,this.byParticipantId=e}return eM(a,[{key:"clone",value:function(){var b=new a;if(this.base instanceof jh?b.base=this.base.clone():b.base=this.base,void 0!==this.byUserId)for(var c in b.byUserId={},this.byUserId){var d=this.byUserId[c];b.byUserId[c]=d instanceof jh?d.clone():d}if(void 0!==this.byParticipantId)for(var e in b.byParticipantId={},this.byParticipantId){var f=this.byParticipantId[e];b.byParticipantId[e]=f instanceof jh?f.clone():f}return b}},{key:"toJSONObject",value:function(){var a={};if("boolean"==typeof this.base?a.base=this.base:this.base instanceof jh&&(a.base=this.base.toJSONObject()),void 0!==this.byUserId)for(var b in a.byUserId={},this.byUserId){var c=this.byUserId[b];a.byUserId[b]=c instanceof jh?c.toJSONObject():c}if(void 0!==this.byParticipantId)for(var d in a.byParticipantId={},this.byParticipantId){var e=this.byParticipantId[d];a.byParticipantId[d]=e instanceof jh?e.toJSONObject():e}return a}},{key:"toMinifiedJSONObject",value:function(){var a={};if(void 0!==this.base&&("boolean"==typeof this.base?a.b=this.base:a.b=this.base.toMinifiedJSONObject()),void 0!==this.byUserId)for(var b in a.u={},this.byUserId){var c=this.byUserId[b];a.u[b]="boolean"==typeof c?c:c.toMinifiedJSONObject()}if(void 0!==this.byParticipantId)for(var d in a.p={},this.byParticipantId){var e=this.byParticipantId[d];a.p[d]="boolean"==typeof e?e:e.toMinifiedJSONObject()}return a}},{key:"normalize",value:function(){return this.base instanceof jh&&(this.base=this.base.normalize()),this.byUserId&&(this.byUserId=Object.fromEntries(Object.entries(this.byUserId).map(function(a){var b=eV(a,2),c=b[0],d=b[1];return[c,d instanceof jh?d.normalize():d]}))),this.byParticipantId&&(this.byParticipantId=Object.fromEntries(Object.entries(this.byParticipantId).map(function(a){var b=eV(a,2),c=b[0],d=b[1];return[c,d instanceof jh?d.normalize():d]}))),this}}],[{key:"fromJSONObject",value:function(b){var c,d,e;if(void 0!==b.base&&(c="boolean"==typeof b.base?b.base:jh.fromJSONObject(b.base)),void 0!==b.byUserId)for(var f in d={},b.byUserId){var g=b.byUserId[f];d[f]="boolean"==typeof g?g:jh.fromJSONObject(g)}if(void 0!==b.byParticipantId)for(var h in e={},b.byParticipantId){var i=b.byParticipantId[h];e[h]="boolean"==typeof i?i:jh.fromJSONObject(i)}return new a({base:c,byUserId:d,byParticipantId:e})}},{key:"fromMinifiedJSONObject",value:function(b){var c,d,e;if(void 0!==b.b&&(c="boolean"==typeof b.b?b.b:jh.fromMinifiedJSONObject(b.b)),void 0!==b.u)for(var f in d={},b.u){var g=b.u[f];d[f]="boolean"==typeof g?g:jh.fromMinifiedJSONObject(g)}if(void 0!==b.p)for(var h in e={},b.p){var i=b.p[h];e[h]="boolean"==typeof i?i:jh.fromMinifiedJSONObject(i)}return new a({base:c,byUserId:d,byParticipantId:e})}},{key:"validateJSONObject",value:function(a){if("object"!==eJ(a))return[!1,"canReceive must be an object"];for(var b=["base","byUserId","byParticipantId"],c=0,d=Object.keys(a);c<d.length;c++){var e=d[c];if(!b.includes(e))return[!1,"canReceive can only contain keys (".concat(b.join(", "),")")];if("base"===e){var f=eV(jh.validateJSONObject(a.base,!0),2),g=f[0],h=f[1];if(!g)return[!1,h]}else{if("object"!==eJ(a[e]))return[!1,"invalid (non-object) value for field '".concat(e,"' in canReceive")];for(var i=0,j=Object.values(a[e]);i<j.length;i++){var k=j[i],l=eV(jh.validateJSONObject(k),2),m=l[0],n=l[1];if(!m)return[!1,n]}}}return[!0]}}])}(),jh=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=b.video,d=b.audio,e=b.screenVideo,f=b.screenAudio,g=b.customVideo,h=b.customAudio;eI(this,a),this.video=c,this.audio=d,this.screenVideo=e,this.screenAudio=f,this.customVideo=g,this.customAudio=h}return eM(a,[{key:"clone",value:function(){var b=new a;return void 0!==this.video&&(b.video=this.video),void 0!==this.audio&&(b.audio=this.audio),void 0!==this.screenVideo&&(b.screenVideo=this.screenVideo),void 0!==this.screenAudio&&(b.screenAudio=this.screenAudio),void 0!==this.customVideo&&(b.customVideo=i8({},this.customVideo)),void 0!==this.customAudio&&(b.customAudio=i8({},this.customAudio)),b}},{key:"toJSONObject",value:function(){var a={};return void 0!==this.video&&(a.video=this.video),void 0!==this.audio&&(a.audio=this.audio),void 0!==this.screenVideo&&(a.screenVideo=this.screenVideo),void 0!==this.screenAudio&&(a.screenAudio=this.screenAudio),void 0!==this.customVideo&&(a.customVideo=i8({},this.customVideo)),void 0!==this.customAudio&&(a.customAudio=i8({},this.customAudio)),a}},{key:"toMinifiedJSONObject",value:function(){var a={};return void 0!==this.video&&(a.v=this.video),void 0!==this.audio&&(a.a=this.audio),void 0!==this.screenVideo&&(a.sv=this.screenVideo),void 0!==this.screenAudio&&(a.sa=this.screenAudio),void 0!==this.customVideo&&(a.cv=i8({},this.customVideo)),void 0!==this.customAudio&&(a.ca=i8({},this.customAudio)),a}},{key:"normalize",value:function(){function a(a,b){return a&&1===Object.keys(a).length&&a["*"]===b}return!(!0!==this.video||!0!==this.audio||!0!==this.screenVideo||!0!==this.screenAudio||!a(this.customVideo,!0)||!a(this.customAudio,!0))||(!1!==this.video||!1!==this.audio||!1!==this.screenVideo||!1!==this.screenAudio||!a(this.customVideo,!1)||!a(this.customAudio,!1))&&this}}],[{key:"fromBoolean",value:function(b){return new a({video:b,audio:b,screenVideo:b,screenAudio:b,customVideo:{"*":b},customAudio:{"*":b}})}},{key:"fromJSONObject",value:function(b){return new a({video:b.video,audio:b.audio,screenVideo:b.screenVideo,screenAudio:b.screenAudio,customVideo:void 0!==b.customVideo?i8({},b.customVideo):void 0,customAudio:void 0!==b.customAudio?i8({},b.customAudio):void 0})}},{key:"fromMinifiedJSONObject",value:function(b){return new a({video:b.v,audio:b.a,screenVideo:b.sv,screenAudio:b.sa,customVideo:b.cv,customAudio:b.ca})}},{key:"validateJSONObject",value:function(a,b){if("boolean"==typeof a)return[!0];if("object"!==eJ(a))return[!1,"invalid (non-object, non-boolean) value in canReceive"];for(var c=Object.keys(a),d=0;d<c.length;d++){var e=c[d];if(!jb.includes(e))return[!1,"invalid media type '".concat(e,"' in canReceive")];if(jd.includes(e)){if("boolean"!=typeof a[e])return[!1,"invalid (non-boolean) value for media type '".concat(e,"' in canReceive")]}else{if("object"!==eJ(a[e]))return[!1,"invalid (non-object) value for media type '".concat(e,"' in canReceive")];for(var f=0,g=Object.values(a[e]);f<g.length;f++)if("boolean"!=typeof g[f])return[!1,"invalid (non-boolean) value for entry within '".concat(e,"' in canReceive")];if(b&&void 0===a[e]["*"])return[!1,'canReceive "base" permission must specify "*" as an entry within \''.concat(e,"'")]}}return b&&c.length!==jb.length?[!1,'canReceive "base" permission must specify all media types: '.concat(jb.join(", ")," (or be set to a boolean shorthand)")]:[!0]}}])}(),ji=["result"],jj=["preserveIframe"];function jk(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function jl(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?jk(Object(c),!0).forEach(function(b){eR(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):jk(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function jm(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(jm=function(){return!!a})()}function jn(a,b){var c="u">typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!c){if(Array.isArray(a)||(c=function(a,b){if(a){if("string"==typeof a)return jo(a,void 0);var c=({}).toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?jo(a,void 0):void 0}}(a))||b&&a&&"number"==typeof a.length){c&&(a=c);var d=0,e=function(){};return{s:e,n:function(){return d>=a.length?{done:!0}:{done:!1,value:a[d++]}},e:function(a){throw a},f:e}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var f,g=!0,h=!1;return{s:function(){c=c.call(a)},n:function(){var a=c.next();return g=a.done,a},e:function(a){h=!0,f=a},f:function(){try{g||null==c.return||c.return()}finally{if(h)throw f}}}}function jo(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}var jp={},jq="video",jr=ii()?{data:{}}:{data:{},topology:"none"},js={present:0,hidden:0},jt={maxBitrate:{min:1e5,max:25e5},maxFramerate:{min:1,max:30},scaleResolutionDownBy:{min:1,max:8}},ju=Object.keys(jt),jv=["state","volume","simulcastEncodings"],jw={androidInCallNotification:{title:"string",subtitle:"string",iconName:"string",disableForCustomOverride:"boolean"},disableAutoDeviceManagement:{audio:"boolean",video:"boolean"}},jx={id:{iconPath:"string",iconPathDarkMode:"string",label:"string",tooltip:"string",visualState:"'default' | 'sidebar-open' | 'active'"}},jy={id:{allow:"string",controlledBy:"'*' | 'owners' | string[]",csp:"string",iconURL:"string",label:"string",loading:"'eager' | 'lazy'",location:"'main' | 'sidebar'",name:"string",referrerPolicy:"string",sandbox:"string",src:"string",srcdoc:"string",shared:"string[] | 'owners' | boolean"}},jz={customIntegrations:{validate:jV,help:jT()},customTrayButtons:{validate:jU,help:"customTrayButtons should be a dictionary of the type ".concat(JSON.stringify(jx))},url:{validate:function(a){return"string"==typeof a},help:"url should be a string"},baseUrl:{validate:function(a){return"string"==typeof a},help:"baseUrl should be a string"},token:{validate:function(a){return"string"==typeof a},help:"token should be a string",queryString:"t"},dailyConfig:{validate:function(a,b){try{return b.validateDailyConfig(a),!0}catch(a){console.error("Failed to validate dailyConfig",a)}return!1},help:"Unsupported dailyConfig. Check error logs for detailed info."},reactNativeConfig:{validate:function(a){return function a(b,c){if(void 0===c)return!1;switch(eJ(c)){case"string":return eJ(b)===c;case"object":if("object"!==eJ(b))return!1;for(var d in b)if(!a(b[d],c[d]))return!1;return!0;default:return!1}}(a,jw)},help:"reactNativeConfig should look like ".concat(JSON.stringify(jw),", all fields optional")},lang:{validate:function(a){return["da","de","en-us","en","es","fi","fr","it","jp","ka","nl","no","pl","pt","pt-BR","ru","sv","tr","user"].includes(a)},help:"language not supported. Options are: da, de, en-us, en, es, fi, fr, it, jp, ka, nl, no, pl, pt, pt-BR, ru, sv, tr, user"},userName:!0,userData:{validate:function(a){try{return jM(a),!0}catch(a){return console.error(a),!1}},help:"invalid userData type provided"},startVideoOff:!0,startAudioOff:!0,allowLocalVideo:!0,allowLocalAudio:!0,activeSpeakerMode:!0,showLeaveButton:!0,showLocalVideo:!0,showParticipantsBar:!0,showFullscreenButton:!0,showUserNameChangeUI:!0,iframeStyle:!0,customLayout:!0,cssFile:!0,cssText:!0,bodyClass:!0,videoSource:{validate:function(a,b){var c;if("boolean"==typeof a)return b._preloadCache.allowLocalVideo=a,!0;if(a instanceof MediaStreamTrack)b._sharedTracks.videoTrack=a,c={customTrack:ia};else{if(delete b._sharedTracks.videoTrack,"string"!=typeof a)return console.error("videoSource must be a MediaStreamTrack, boolean, or a string"),!1;c={deviceId:a}}return b._updatePreloadCacheInputSettings({video:{settings:c}},!1),!0}},audioSource:{validate:function(a,b){var c;if("boolean"==typeof a)return b._preloadCache.allowLocalAudio=a,!0;if(a instanceof MediaStreamTrack)b._sharedTracks.audioTrack=a,c={customTrack:ia};else{if(delete b._sharedTracks.audioTrack,"string"!=typeof a)return console.error("audioSource must be a MediaStreamTrack, boolean, or a string"),!1;c={deviceId:a}}return b._updatePreloadCacheInputSettings({audio:{settings:c}},!1),!0}},subscribeToTracksAutomatically:{validate:function(a,b){return b._preloadCache.subscribeToTracksAutomatically=a,!0}},theme:{validate:function(a){var b=["accent","accentText","background","backgroundAccent","baseText","border","mainAreaBg","mainAreaBgAccent","mainAreaText","supportiveText"],c=function(a){for(var c=0,d=Object.keys(a);c<d.length;c++){var e=d[c];if(!b.includes(e))return console.error('unsupported color "'.concat(e,'". Valid colors: ').concat(b.join(", "))),!1;if(!a[e].match(/^#[0-9a-f]{6}|#[0-9a-f]{3}$/i))return console.error("".concat(e,' theme color should be provided in valid hex color format. Received: "').concat(a[e],'"')),!1}return!0};return"object"===eJ(a)&&("light"in a&&"dark"in a||"colors"in a)?"light"in a&&"dark"in a?"colors"in a.light?"colors"in a.dark?c(a.light.colors)&&c(a.dark.colors):(console.error('Dark theme is missing "colors" property.',a),!1):(console.error('Light theme is missing "colors" property.',a),!1):c(a.colors):(console.error('Theme must contain either both "light" and "dark" properties, or "colors".',a),!1)},help:"unsupported theme configuration. Check error logs for detailed info."},layoutConfig:{validate:function(a){if("grid"in a){var b=a.grid;if("maxTilesPerPage"in b){if(!Number.isInteger(b.maxTilesPerPage))return console.error("grid.maxTilesPerPage should be an integer. You passed ".concat(b.maxTilesPerPage,".")),!1;if(b.maxTilesPerPage>49)return console.error("grid.maxTilesPerPage can't be larger than 49 without sacrificing browser performance. Please contact us at https://www.daily.co/contact to talk about your use case."),!1}if("minTilesPerPage"in b){if(!Number.isInteger(b.minTilesPerPage))return console.error("grid.minTilesPerPage should be an integer. You passed ".concat(b.minTilesPerPage,".")),!1;if(b.minTilesPerPage<1)return console.error("grid.minTilesPerPage can't be lower than 1."),!1;if("maxTilesPerPage"in b&&b.minTilesPerPage>b.maxTilesPerPage)return console.error("grid.minTilesPerPage can't be higher than grid.maxTilesPerPage."),!1}}return!0},help:"unsupported layoutConfig. Check error logs for detailed info."},receiveSettings:{validate:function(a){return jN(a,{allowAllParticipantsKey:!1})},help:jS({allowAllParticipantsKey:!1})},sendSettings:{validate:function(a,b){return!!function(a,b){try{return b.validateUpdateSendSettings(a),!0}catch(a){return console.error("Failed to validate send settings",a),!1}}(a,b)&&(b._preloadCache.sendSettings=a,!0)},help:"Invalid sendSettings provided. Check error logs for detailed info."},inputSettings:{validate:function(a,b){var c;return!!jO(a)&&(b._inputSettings||(b._inputSettings={}),jP(a,null==(c=b.properties)?void 0:c.dailyConfig,b._sharedTracks),b._updatePreloadCacheInputSettings(a,!0),!0)},help:jR()},layout:{validate:function(a){return"custom-v1"===a||"browser"===a||"none"===a},help:'layout may only be set to "custom-v1"',queryString:"layout"},emb:{queryString:"emb"},embHref:{queryString:"embHref"},dailyJsVersion:{queryString:"dailyJsVersion"},proxy:{queryString:"proxy"},strictMode:!0,allowMultipleCallInstances:!0},jA={styles:{validate:function(a){for(var b in a)if("cam"!==b&&"screen"!==b)return!1;if(a.cam){for(var c in a.cam)if("div"!==c&&"video"!==c)return!1}if(a.screen){for(var d in a.screen)if("div"!==d&&"video"!==d)return!1}return!0},help:"styles format should be a subset of: { cam: {div: {}, video: {}}, screen: {div: {}, video: {}} }"},setSubscribedTracks:{validate:function(a,b){if(b._preloadCache.subscribeToTracksAutomatically)return!1;var c=[!0,!1,"staged"];if(c.includes(a)||!ii()&&"avatar"===a)return!0;var d=["audio","video","screenAudio","screenVideo","rmpAudio","rmpVideo"],e=function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var f in a)if("custom"===f){if(!c.includes(a[f])&&!e(a[f],!0))return!1}else{var g=!b&&!d.includes(f),h=!c.includes(a[f]);if(g||h)return!1}return!0};return e(a)},help:"setSubscribedTracks cannot be used when setSubscribeToTracksAutomatically is enabled, and should be of the form: "+"true".concat(ii()?"":" | 'avatar'"," | false | 'staged' | { [audio: true|false|'staged'], [video: true|false|'staged'], [screenAudio: true|false|'staged'], [screenVideo: true|false|'staged'] }")},setAudio:!0,setVideo:!0,setScreenShare:{validate:function(a){return!1===a},help:"setScreenShare must be false, as it's only meant for stopping remote participants' screen shares"},eject:!0,updatePermissions:{validate:function(a){for(var b=0,c=Object.entries(a);b<c.length;b++){var d=eV(c[b],2),e=d[0],f=d[1];switch(e){case"hasPresence":if("boolean"!=typeof f)return!1;break;case"canSend":if(f instanceof Set||f instanceof Array||Array.isArray(f)){var g,h=["video","audio","screenVideo","screenAudio","customVideo","customAudio"],i=jn(f);try{for(i.s();!(g=i.n()).done;){var j=g.value;if(!h.includes(j))return!1}}catch(a){i.e(a)}finally{i.f()}}else if("boolean"!=typeof f)return!1;(f instanceof Array||Array.isArray(f))&&(a.canSend=new Set(f));break;case"canReceive":var k=eV(jg.validateJSONObject(f),2),l=k[0],m=k[1];if(!l)return console.error(m),!1;break;case"canAdmin":if(f instanceof Set||f instanceof Array||Array.isArray(f)){var n,o=["participants","streaming","transcription"],p=jn(f);try{for(p.s();!(n=p.n()).done;){var q=n.value;if(!o.includes(q))return!1}}catch(a){p.e(a)}finally{p.f()}}else if("boolean"!=typeof f)return!1;(f instanceof Array||Array.isArray(f))&&(a.canAdmin=new Set(f));break;default:return!1}}return!0},help:"updatePermissions can take hasPresence, canSend, canReceive, and canAdmin permissions. hasPresence must be a boolean. canSend can be a boolean or an Array or Set of media types (video, audio, screenVideo, screenAudio, customVideo, customAudio). canReceive must be an object specifying base, byUserId, and/or byParticipantId fields (see documentation for more details). canAdmin can be a boolean or an Array or Set of admin types (participants, streaming, transcription)."}};function jB(a){if(a.extension){if("string"!=typeof a.extension)throw Error("Error starting dial out: extension must be a string");if(a.extension.length>20)throw Error("Error starting dial out: extension length must be less than or equal to 20")}if(a.waitBeforeExtensionDialSec){if("number"!=typeof a.waitBeforeExtensionDialSec)throw Error("Error starting dial out: waitBeforeExtensionDialSec must be a number");if(a.waitBeforeExtensionDialSec>60)throw Error("Error starting dial out: waitBeforeExtensionDialSec must be less than or equal to 60");if(!a.extension)throw Error("Error starting dial out: waitBeforeExtensionDialSec requires a phoneNumber and extension")}}function jC(a,b){var c={};for(var d in a)if(a[d]instanceof MediaStreamTrack)console.warn("MediaStreamTrack found in props or cache.",d),c[d]=ia;else if("dailyConfig"===d){if(a[d].modifyLocalSdpHook){var e=window._daily.instances[b].customCallbacks||{};e.modifyLocalSdpHook=a[d].modifyLocalSdpHook,window._daily.instances[b].customCallbacks=e,delete a[d].modifyLocalSdpHook}if(a[d].modifyRemoteSdpHook){var f=window._daily.instances[b].customCallbacks||{};f.modifyRemoteSdpHook=a[d].modifyRemoteSdpHook,window._daily.instances[b].customCallbacks=f,delete a[d].modifyRemoteSdpHook}c[d]=a[d]}else c[d]=a[d];return c}function jD(a){var b=arguments.length>2?arguments[2]:void 0;if(a!==hV){var c="".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"This daily-js method"," only supported after join.");throw b&&(c+=" ".concat(b)),console.error(c),Error(c)}}function jE(a,b){return[hU,hV].includes(a)||b}function jF(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"This daily-js method",d=arguments.length>3?arguments[3]:void 0;if(jE(a,b)){var e="".concat(c," not supported after joining a meeting.");throw d&&(e+=" ".concat(d)),console.error(e),Error(e)}}function jG(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"This daily-js method",c=arguments.length>2?arguments[2]:void 0;if(!a){var d="".concat(b,arguments.length>3&&void 0!==arguments[3]&&arguments[3]?" requires preAuth() or startCamera() to initialize call state.":" requires preAuth(), startCamera(), or join() to initialize call state.");throw c&&(d+=" ".concat(c)),console.error(d),Error(d)}}function jH(a){if(a){var b="A pre-call quality test is in progress. Please try ".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"This daily-js method"," again once testing has completed. Use stopTestCallQuality() to end it early.");throw console.error(b),Error(b)}}function jI(a){if(!a){var b="".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"This daily-js method"," is only supported on custom callObject instances");throw console.error(b),Error(b)}}function jJ(a){if(a){var b="".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"This daily-js method"," is only supported as part of Daily's Prebuilt");throw console.error(b),Error(b)}}function jK(){if(ii())throw Error("This daily-js method is not currently supported in React Native")}function jL(){if(!ii())throw Error("This daily-js method is only supported in React Native")}function jM(a){var b;if(void 0===a)return!0;if("string"==typeof a)b=a;else try{b=JSON.stringify(a),e0(JSON.parse(b),a)||console.warn("The userData provided will be modified when serialized.")}catch(a){throw Error("userData must be serializable to JSON: ".concat(a))}if(b.length>4096)throw Error("userData is too large (".concat(b.length," characters). Maximum size suppported is ").concat(4096,"."));return!0}function jN(a,b){for(var c=b.allowAllParticipantsKey,d=function(a){return!!(void 0===a.layer||Number.isInteger(a.layer)&&a.layer>=0||"inherit"===a.layer)},e=0,f=Object.entries(a);e<f.length;e++){var g=eV(f[e],2),h=g[0],i=g[1];if(!function(a){var b=["local"];return c||b.push("*"),a&&!b.includes(a)}(h)||!(i&&!(i.video&&!d(i.video))&&!(i.screenVideo&&!d(i.screenVideo))))return!1}return!0}function jO(a){if("object"!==eJ(a))return!1;for(var b=0,c=Object.entries(a);b<c.length;b++){var d=eV(c[b],2),e=d[0],f=d[1];switch(e){case"video":if("object"!==eJ(f))return!1;for(var g=0,h=Object.entries(f);g<h.length;g++){var i=eV(h[g],2),j=i[0],k=i[1];switch(j){case"processor":if(!function(a){if(ii())return console.warn("Video processing is not yet supported in React Native"),!1;var b,c=["type","config"];return!!a&&"object"===eJ(a)&&!!("string"==typeof(b=a.type)&&(Object.values(ib).includes(b)||(console.error("inputSettings video processor type invalid"),0)))&&(!a.config||"object"===eJ(a.config)&&!!function(a,b){var c,d=Object.keys(b);if(0===d.length)return!0;var e="invalid object in inputSettings -> video -> processor -> config";switch(a){case ib.BGBLUR:return d.length>1||"strength"!==d[0]?(console.error(e),!1):!("number"!=typeof b.strength||b.strength<=0||b.strength>1||isNaN(b.strength))||(console.error("".concat(e,"; expected: {0 < strength <= 1}, got: ").concat(b.strength)),!1);case ib.BGIMAGE:return!(void 0!==b.source&&!("default"===b.source?(b.type="default",!0):b.source instanceof ArrayBuffer||(fi(b.source)?(b.type="url",!!function(a){var b=new URL(a),c=b.pathname;if("data:"===b.protocol)try{var d=c.substring(c.indexOf(":")+1,c.indexOf(";")).split("/")[1];return ie.includes(d)}catch(a){return console.error("failed to deduce blob content type",a),!1}var e=c.split(".").at(-1).toLowerCase().trim();return ie.includes(e)}(b.source)||(console.error("invalid image type; supported types: [".concat(ie.join(", "),"]")),!1)):isNaN(c=Number(b.source))||!Number.isInteger(c)||c<=0||c>10?(console.error("invalid image selection; must be an int, > 0, <= ".concat(10)),!1):(b.type="daily-preselect",!0))));default:return!0}}(a.type,a.config))&&(Object.keys(a).filter(function(a){return!c.includes(a)}).forEach(function(b){console.warn("invalid key inputSettings -> video -> processor : ".concat(b)),delete a[b]}),!0)}(k))return!1;break;case"settings":if(!jQ(k))return!1;break;default:return!1}}break;case"audio":if("object"!==eJ(f))return!1;for(var l=0,m=Object.entries(f);l<m.length;l++){var n=eV(m[l],2),o=n[0],p=n[1];switch(o){case"processor":if(!function(a){if(ii())return console.warn("Video processing is not yet supported in React Native"),!1;var b,c=["type"];return!!a&&"object"===eJ(a)&&(Object.keys(a).filter(function(a){return!c.includes(a)}).forEach(function(b){console.warn("invalid key inputSettings -> audio -> processor : ".concat(b)),delete a[b]}),!!("string"==typeof(b=a.type)&&(Object.values(ic).includes(b)||(console.error("inputSettings audio processor type invalid"),0))))}(p))return!1;break;case"settings":if(!jQ(p))return!1;break;default:return!1}}break;default:return!1}}return!0}function jP(a,b,c){var d,e=[];a.video&&a.video.processor&&(im(null!=(d=null==b?void 0:b.useLegacyVideoProcessor)&&d)||(a.video.settings?delete a.video.processor:delete a.video,e.push("video"))),a.audio&&a.audio.processor&&(io()||(a.audio.settings?delete a.audio.processor:delete a.audio,e.push("audio"))),e.length>0&&console.error("Ignoring settings for browser- or platform-unsupported input processor(s): ".concat(e.join(", "))),a.audio&&a.audio.settings&&(a.audio.settings.customTrack?(c.audioTrack=a.audio.settings.customTrack,a.audio.settings={customTrack:ia}):delete c.audioTrack),a.video&&a.video.settings&&(a.video.settings.customTrack?(c.videoTrack=a.video.settings.customTrack,a.video.settings={customTrack:ia}):delete c.videoTrack)}function jQ(a){return"object"===eJ(a)&&(!a.customTrack||a.customTrack instanceof MediaStreamTrack)}function jR(){var a=Object.values(ib).join(" | "),b=Object.values(ic).join(" | ");return"inputSettings must be of the form: { video?: { processor?: { type: [ ".concat(a," ], config?: {} } }, audio?: { processor: {type: [ ").concat(b," ] } } }")}function jS(a){var b=a.allowAllParticipantsKey;return"receiveSettings must be of the form { [<remote participant id> | ".concat("base").concat(b?' | "'.concat("*",'"'):"","]: ")+'{ [video: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]], [screenVideo: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]] }}}'}function jT(){return"customIntegrations should be an object of type ".concat(JSON.stringify(jy),".")}function jU(a){if(a&&"object"!==eJ(a)||Array.isArray(a))return console.error("customTrayButtons should be an Object of the type ".concat(JSON.stringify(jx),".")),!1;if(a)for(var b=0,c=Object.entries(a);b<c.length;b++)for(var d=eV(c[b],1)[0],e=0,f=Object.entries(a[d]);e<f.length;e++){var g=eV(f[e],2),h=g[0],i=g[1],j=jx.id[h];if(!j)return console.error("customTrayButton does not support key ".concat(h)),!1;switch(h){case"iconPath":case"iconPathDarkMode":if(!fi(i))return console.error("customTrayButton ".concat(h," should be a url.")),!1;break;case"visualState":if(!["default","sidebar-open","active"].includes(i))return console.error("customTrayButton ".concat(h," should be ").concat(j,". Got: ").concat(i)),!1;break;default:if(eJ(i)!==j)return console.error("customTrayButton ".concat(h," should be a ").concat(j,".")),!1}}return!0}function jV(a){if(!a||a&&"object"!==eJ(a)||Array.isArray(a))return console.error(jT()),!1;for(var b=function(a){return"".concat(a," should be ").concat(jy.id[a])},c=function(a,b){return console.error("customIntegration ".concat(a,": ").concat(b))},d=0,e=Object.entries(a);d<e.length;d++){var f=eV(e[d],1)[0];if(!("label"in a[f]))return c(f,"label is required"),!1;if(!("location"in a[f]))return c(f,"location is required"),!1;if(!("src"in a[f])&&!("srcdoc"in a[f]))return c(f,"src or srcdoc is required"),!1;for(var g=0,h=Object.entries(a[f]);g<h.length;g++){var i=eV(h[g],2),j=i[0],k=i[1];switch(j){case"allow":case"csp":case"name":case"referrerPolicy":case"sandbox":if("string"!=typeof k)return c(f,b(j)),!1;break;case"iconURL":if(!fi(k))return c(f,"".concat(j," should be a url")),!1;break;case"src":if("srcdoc"in a[f])return c(f,"cannot have both src and srcdoc"),!1;if(!fi(k))return c(f,'src "'.concat(k,'" is not a valid URL')),!1;break;case"srcdoc":if("src"in a[f])return c(f,"cannot have both src and srcdoc"),!1;if("string"!=typeof k)return c(f,b(j)),!1;break;case"location":if(!["main","sidebar"].includes(k))return c(f,b(j)),!1;break;case"controlledBy":if("*"!==k&&"owners"!==k&&(!Array.isArray(k)||k.some(function(a){return"string"!=typeof a})))return c(f,b(j)),!1;break;case"shared":if((!Array.isArray(k)||k.some(function(a){return"string"!=typeof a}))&&"owners"!==k&&"boolean"!=typeof k)return c(f,b(j)),!1;break;default:if(!jy.id[j])return console.error("customIntegration does not support key ".concat(j)),!1}}}return!0}function jW(a,b){var c=a.sessionId,d=a.toEndPoint,e=a.callerId,f=a.useSipRefer;if(!c||!d)throw Error("".concat(b,"() requires a sessionId and toEndPoint"));if("string"!=typeof c||"string"!=typeof d)throw Error("Invalid paramater: sessionId and toEndPoint must be of type string");if(f&&!d.startsWith("sip:"))throw Error('"toEndPoint" must be a "sip" address');if(!d.startsWith("sip:")&&!d.startsWith("+"))throw Error("toEndPoint: ".concat(d,' must starts with either "sip:" or "+"'));if(e&&"string"!=typeof e)throw Error("callerId must be of type string");if(e&&!d.startsWith("+"))throw Error("callerId is only valid when transferring to a PSTN number")}function jX(a){if("object"!==eJ(a))throw Error('RemoteMediaPlayerSettings: must be "object" type');if(a.state&&!Object.values(id).includes(a.state))throw Error("Invalid value for RemoteMediaPlayerSettings.state, valid values are: "+JSON.stringify(id));if(a.volume){if("number"!=typeof a.volume)throw Error('RemoteMediaPlayerSettings.volume: must be "number" type');if(a.volume<0||a.volume>2)throw Error("RemoteMediaPlayerSettings.volume: must be between 0.0 - 2.0")}}function jY(a,b,c){return!("number"!=typeof a||a<b||a>c)}function jZ(a,b){return a&&!b&&delete a.data,a}function j$(){let a=(0,u.useParams)().sessionId;return(0,t.jsx)(eG,{sessionId:a})}Promise.any||(Promise.any=(r=eT(function*(a){return new Promise(function(b,c){var d=[];a.forEach(function(e){return Promise.resolve(e).then(function(a){b(a)}).catch(function(b){d.push(b),d.length===a.length&&c(d)})})})}),function(a){return r.apply(this,arguments)})),function(){var a,b,c,d,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M;function N(a){var b,c,d,e,f,g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(eI(this,N),e=eO(e=N),eR(d=eN(this,jm()?Reflect.construct(e,f||[],eO(this).constructor):e.apply(this,f)),"startListeningForDeviceChanges",function(){var a;a=d.handleDeviceChange,i5()?i0.has(a)||(i0.set(a,{}),navigator.mediaDevices.enumerateDevices().then(function(b){var c;i0.has(a)&&(i0.get(a).lastDevicesString=JSON.stringify(b),i1||(c=eT(function*(){var a,b=yield navigator.mediaDevices.enumerateDevices(),c=function(a,b){var c="u">typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!c){if(Array.isArray(a)||(c=function(a,b){if(a){if("string"==typeof a)return i_(a,void 0);var c=({}).toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?i_(a,void 0):void 0}}(a))){c&&(a=c);var d=0,e=function(){};return{s:e,n:function(){return d>=a.length?{done:!0}:{done:!1,value:a[d++]}},e:function(a){throw a},f:e}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var f,g=!0,h=!1;return{s:function(){c=c.call(a)},n:function(){var a=c.next();return g=a.done,a},e:function(a){h=!0,f=a},f:function(){try{g||null==c.return||c.return()}finally{if(h)throw f}}}}(i0.keys());try{for(c.s();!(a=c.n()).done;){var d=a.value,e=JSON.stringify(b);e!==i0.get(d).lastDevicesString&&(i0.get(d).lastDevicesString=e,d(b))}}catch(a){c.e(a)}finally{c.f()}}),i1=function(){return c.apply(this,arguments)},navigator.mediaDevices.addEventListener("devicechange",i1)))}).catch(function(){})):i3.has(a)||(i3.set(a,{}),navigator.mediaDevices.enumerateDevices().then(function(b){i3.has(a)&&(i3.get(a).lastDevicesString=JSON.stringify(b),i4||(i4=setInterval(eT(function*(){var a,b=yield navigator.mediaDevices.enumerateDevices(),c=function(a,b){var c="u">typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!c){if(Array.isArray(a)||(c=function(a,b){if(a){if("string"==typeof a)return i2(a,void 0);var c=({}).toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?i2(a,void 0):void 0}}(a))){c&&(a=c);var d=0,e=function(){};return{s:e,n:function(){return d>=a.length?{done:!0}:{done:!1,value:a[d++]}},e:function(a){throw a},f:e}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var f,g=!0,h=!1;return{s:function(){c=c.call(a)},n:function(){var a=c.next();return g=a.done,a},e:function(a){h=!0,f=a},f:function(){try{g||null==c.return||c.return()}finally{if(h)throw f}}}}(i3.keys());try{for(c.s();!(a=c.n()).done;){var d=a.value,e=JSON.stringify(b);e!==i3.get(d).lastDevicesString&&(i3.get(d).lastDevicesString=e,d(b))}}catch(a){c.e(a)}finally{c.f()}}),3e3)))}))}),eR(d,"stopListeningForDeviceChanges",function(){var a;a=d.handleDeviceChange,i5()?i0.has(a)&&(i0.delete(a),0===i0.size&&i1&&(navigator.mediaDevices.removeEventListener("devicechange",i1),i1=null)):i3.has(a)&&(i3.delete(a),0===i3.size&&i4&&(clearInterval(i4),i4=null))}),eR(d,"handleDeviceChange",function(a){a=a.map(function(a){return JSON.parse(JSON.stringify(a))}),d.emitDailyJSEvent({action:"available-devices-updated",availableDevices:a})}),eR(d,"handleNativeAppStateChange",(b=eT(function*(a){"destroyed"===a?(console.warn("App has been destroyed before leaving the meeting. Cleaning up all the resources!"),yield d.destroy()):d.disableReactNativeAutoDeviceManagement("video")||("active"===a?d.camUnmutedBeforeLosingNativeActiveState&&d.setLocalVideo(!0):(d.camUnmutedBeforeLosingNativeActiveState=d.localVideo(),d.camUnmutedBeforeLosingNativeActiveState&&d.setLocalVideo(!1)))}),function(a){return b.apply(this,arguments)})),eR(d,"handleNativeAudioFocusChange",function(a){d.disableReactNativeAutoDeviceManagement("audio")||(d._hasNativeAudioFocus=a,d.toggleParticipantAudioBasedOnNativeAudioFocus(),d._hasNativeAudioFocus?d.micUnmutedBeforeLosingNativeAudioFocus&&d.setLocalAudio(!0):(d.micUnmutedBeforeLosingNativeAudioFocus=d.localAudio(),d.setLocalAudio(!1)))}),eR(d,"handleNativeSystemScreenCaptureStop",function(){d.stopScreenShare()}),!ip()&&!ii())throw Error("WebRTC not supported or suppressed");if(d.strictMode=void 0===g.strictMode||g.strictMode,d.allowMultipleCallInstances=null!=(c=g.allowMultipleCallInstances)&&c,Object.keys(jp).length&&(d._logDuplicateInstanceAttempt(),!d.allowMultipleCallInstances)){if(d.strictMode)throw Error("Duplicate DailyIframe instances are not allowed");console.warn("Using strictMode: false to allow multiple call instances is now deprecated. Set `allowMultipleCallInstances: true`")}if(window._daily||(window._daily={pendings:[],instances:{}}),d.callClientId=fe(),jp[d.callClientId]=d,window._daily.instances[d.callClientId]={},d._sharedTracks={},window._daily.instances[d.callClientId].tracks=d._sharedTracks,g.dailyJsVersion=N.version(),d._iframe=a,d._callObjectMode="none"===g.layout&&!d._iframe,d._preloadCache={subscribeToTracksAutomatically:!0,outputDeviceId:null,inputSettings:null,sendSettings:null,videoTrackForNetworkConnectivityTest:null,videoTrackForConnectionQualityTest:null},void 0!==g.showLocalVideo?d._callObjectMode?console.error("showLocalVideo is not available in call object mode"):d._showLocalVideo=!!g.showLocalVideo:d._showLocalVideo=!0,void 0!==g.showParticipantsBar?d._callObjectMode?console.error("showParticipantsBar is not available in call object mode"):d._showParticipantsBar=!!g.showParticipantsBar:d._showParticipantsBar=!0,void 0!==g.customIntegrations?d._callObjectMode?console.error("customIntegrations is not available in call object mode"):d._customIntegrations=g.customIntegrations:d._customIntegrations={},void 0!==g.customTrayButtons?d._callObjectMode?console.error("customTrayButtons is not available in call object mode"):d._customTrayButtons=g.customTrayButtons:d._customTrayButtons={},void 0!==g.activeSpeakerMode?d._callObjectMode?console.error("activeSpeakerMode is not available in call object mode"):d._activeSpeakerMode=!!g.activeSpeakerMode:d._activeSpeakerMode=!1,g.receiveSettings?d._callObjectMode?d._receiveSettings=g.receiveSettings:console.error("receiveSettings is only available in call object mode"):d._receiveSettings={},d.validateProperties(g),d.properties=jl({},g),d._inputSettings||(d._inputSettings={}),d._callObjectLoader=d._callObjectMode?new iN(d.callClientId):null,d._callState="new",d._isPreparingToJoin=!1,d._accessState={access:hY},d._meetingSessionSummary={},d._finalSummaryOfPrevSession={},d._meetingSessionState=jZ(jr,d._callObjectMode),d._nativeInCallAudioMode=jq,d._participants={},d._isScreenSharing=!1,d._participantCounts=js,d._rmpPlayerState={},d._waitingParticipants={},d._network={threshold:"good",quality:100,networkState:"unknown",stats:{}},d._activeSpeaker={},d._localAudioLevel=0,d._isLocalAudioLevelObserverRunning=!1,d._remoteParticipantsAudioLevel={},d._isRemoteParticipantsAudioLevelObserverRunning=!1,d._maxAppMessageSize=4096,d._messageChannel=ii()?new iE:new iB,d._iframe&&(d._iframe.requestFullscreen?d._iframe.addEventListener("fullscreenchange",function(){document.fullscreenElement===d._iframe?(d.emitDailyJSEvent({action:h1}),d.sendMessageToCallMachine({action:h1})):(d.emitDailyJSEvent({action:h2}),d.sendMessageToCallMachine({action:h2}))}):d._iframe.webkitRequestFullscreen&&d._iframe.addEventListener("webkitfullscreenchange",function(){document.webkitFullscreenElement===d._iframe?(d.emitDailyJSEvent({action:h1}),d.sendMessageToCallMachine({action:h1})):(d.emitDailyJSEvent({action:h2}),d.sendMessageToCallMachine({action:h2}))})),ii()){var h=d.nativeUtils();h.addAudioFocusChangeListener&&h.removeAudioFocusChangeListener&&h.addAppStateChangeListener&&h.removeAppStateChangeListener&&h.addSystemScreenCaptureStopListener&&h.removeSystemScreenCaptureStopListener||console.warn("expected (add|remove)(AudioFocusChange|AppActiveStateChange|SystemScreenCaptureStop)Listener to be available in React Native"),d._hasNativeAudioFocus=!0,h.addAudioFocusChangeListener(d.handleNativeAudioFocusChange),h.addAppStateChangeListener(d.handleNativeAppStateChange),h.addSystemScreenCaptureStopListener(d.handleNativeSystemScreenCaptureStop)}return d._callObjectMode&&d.startListeningForDeviceChanges(),d._messageChannel.addListenerForMessagesFromCallMachine(d.handleMessageFromCallMachine,d.callClientId,d),d}eQ(N,eZ),eM(N,[{key:"destroy",value:(M=eT(function*(){try{yield this.leave()}catch(a){}var a,b=this._iframe;if(b){var c=b.parentElement;c&&c.removeChild(b)}if(this._messageChannel.removeListener(this.handleMessageFromCallMachine),ii()){var d=this.nativeUtils();d.removeAudioFocusChangeListener(this.handleNativeAudioFocusChange),d.removeAppStateChangeListener(this.handleNativeAppStateChange),d.removeSystemScreenCaptureStopListener(this.handleNativeSystemScreenCaptureStop)}this._callObjectMode&&this.stopListeningForDeviceChanges(),this.resetMeetingDependentVars(),this._destroyed=!0,this.emitDailyJSEvent({action:"call-instance-destroyed"}),delete jp[this.callClientId],(null==(a=window)||null==(a=a._daily)?void 0:a.instances)&&delete window._daily.instances[this.callClientId],this.strictMode&&(this.callClientId=void 0)}),function(){return M.apply(this,arguments)})},{key:"isDestroyed",value:function(){return!!this._destroyed}},{key:"loadCss",value:function(a){var b=a.bodyClass,c=a.cssFile,d=a.cssText;return jK(),this.sendMessageToCallMachine({action:"load-css",cssFile:this.absoluteUrl(c),bodyClass:b,cssText:d}),this}},{key:"iframe",value:function(){return jK(),this._iframe}},{key:"meetingState",value:function(){return this._callState}},{key:"accessState",value:function(){return jI(this._callObjectMode,"accessState()"),this._accessState}},{key:"participants",value:function(){return this._participants}},{key:"participantCounts",value:function(){return this._participantCounts}},{key:"waitingParticipants",value:function(){return jI(this._callObjectMode,"waitingParticipants()"),this._waitingParticipants}},{key:"validateParticipantProperties",value:function(a,b){for(var c in b){if(!jA[c])throw Error("unrecognized updateParticipant property ".concat(c));if(jA[c].validate&&!jA[c].validate(b[c],this,this._participants[a]))throw Error(jA[c].help)}}},{key:"updateParticipant",value:function(a,b){return this._participants.local&&this._participants.local.session_id===a&&(a="local"),a&&b&&(this.validateParticipantProperties(a,b),this.sendMessageToCallMachine({action:"update-participant",id:a,properties:b})),this}},{key:"updateParticipants",value:function(a){var b=this._participants.local&&this._participants.local.session_id;for(var c in a)c===b&&(c="local"),c&&a[c]&&this.validateParticipantProperties(c,a[c]);return this.sendMessageToCallMachine({action:"update-participants",participants:a}),this}},{key:"updateWaitingParticipant",value:(L=eT(function*(){var a=this,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(jI(this._callObjectMode,"updateWaitingParticipant()"),jD(this._callState,"updateWaitingParticipant()"),"string"!=typeof b||"object"!==eJ(c))throw Error("updateWaitingParticipant() must take an id string and a updates object");return new Promise(function(d,e){a.sendMessageToCallMachine({action:"daily-method-update-waiting-participant",id:b,updates:c},function(a){a.error&&e(a.error),a.id||e(Error("unknown error in updateWaitingParticipant()")),d({id:a.id})})})}),function(){return L.apply(this,arguments)})},{key:"updateWaitingParticipants",value:(K=eT(function*(){var a=this,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(jI(this._callObjectMode,"updateWaitingParticipants()"),jD(this._callState,"updateWaitingParticipants()"),"object"!==eJ(b))throw Error("updateWaitingParticipants() must take a mapping between ids and update objects");return new Promise(function(c,d){a.sendMessageToCallMachine({action:"daily-method-update-waiting-participants",updatesById:b},function(a){a.error&&d(a.error),a.ids||d(Error("unknown error in updateWaitingParticipants()")),c({ids:a.ids})})})}),function(){return K.apply(this,arguments)})},{key:"requestAccess",value:(J=eT(function*(){var a=this,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=b.access,d=void 0===c?{level:"full"}:c,e=b.name,f=void 0===e?"":e;return jI(this._callObjectMode,"requestAccess()"),jD(this._callState,"requestAccess()"),new Promise(function(b,c){a.sendMessageToCallMachine({action:"daily-method-request-access",access:d,name:f},function(a){a.error&&c(a.error),a.access||c(Error("unknown error in requestAccess()")),b({access:a.access,granted:a.granted})})})}),function(){return J.apply(this,arguments)})},{key:"localAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.audio.state):null}},{key:"localVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.video.state):null}},{key:"setLocalAudio",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"forceDiscardTrack"in b&&(ii()?(console.warn("forceDiscardTrack option not supported in React Native; ignoring"),b={}):a&&(console.warn("forceDiscardTrack option only supported when calling setLocalAudio(false); ignoring"),b={})),this.sendMessageToCallMachine({action:"local-audio",state:a,options:b}),this}},{key:"localScreenAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenAudio.state):null}},{key:"localScreenVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenVideo.state):null}},{key:"updateScreenShare",value:function(a){if(this._isScreenSharing)return this.sendMessageToCallMachine({action:"local-screen-update",options:a}),this;console.warn("There is no screen share in progress. Try calling startScreenShare first.")}},{key:"setLocalVideo",value:function(a){return this.sendMessageToCallMachine({action:"local-video",state:a}),this}},{key:"_setAllowLocalAudio",value:function(a){if(this._preloadCache.allowLocalAudio=a,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-audio",state:a}),this}},{key:"_setAllowLocalVideo",value:function(a){if(this._preloadCache.allowLocalVideo=a,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-video",state:a}),this}},{key:"getReceiveSettings",value:(I=eT(function*(a){var b=this,c=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).showInheritedValues,d=void 0!==c&&c;if(jI(this._callObjectMode,"getReceiveSettings()"),!this._callMachineInitialized)return this._receiveSettings;switch(eJ(a)){case"string":return new Promise(function(c){b.sendMessageToCallMachine({action:"get-single-participant-receive-settings",id:a,showInheritedValues:d},function(a){c(a.receiveSettings)})});case"undefined":return this._receiveSettings;default:throw Error('first argument to getReceiveSettings() must be a participant id (or "base"), or there should be no arguments')}}),function(a){return I.apply(this,arguments)})},{key:"updateReceiveSettings",value:(H=eT(function*(a){var b=this;if(jI(this._callObjectMode,"updateReceiveSettings()"),!jN(a,{allowAllParticipantsKey:!0}))throw Error(jS({allowAllParticipantsKey:!0}));return jD(this._callState,"updateReceiveSettings()","To specify receive settings earlier, use the receiveSettings config property."),new Promise(function(c){b.sendMessageToCallMachine({action:"update-receive-settings",receiveSettings:a},function(a){c({receiveSettings:a.receiveSettings})})})}),function(a){return H.apply(this,arguments)})},{key:"_prepInputSettingsForSharing",value:function(a,b){if(a){var c={};if(a.audio){a.audio.settings&&(!Object.keys(a.audio.settings).length&&b||(c.audio={settings:jl({},a.audio.settings)})),b&&null!=(d=c.audio)&&null!=(d=d.settings)&&d.customTrack&&(c.audio.settings={customTrack:this._sharedTracks.audioTrack});var d,e,f,g="none"===(null==(e=a.audio.processor)?void 0:e.type)&&(null==(f=a.audio.processor)?void 0:f._isDefaultWhenNone);if(a.audio.processor&&!g){var h=jl({},a.audio.processor);delete h._isDefaultWhenNone,c.audio=jl(jl({},c.audio),{},{processor:h})}}if(a.video){a.video.settings&&(!Object.keys(a.video.settings).length&&b||(c.video={settings:jl({},a.video.settings)})),b&&null!=(i=c.video)&&null!=(i=i.settings)&&i.customTrack&&(c.video.settings={customTrack:this._sharedTracks.videoTrack});var i,j,k,l="none"===(null==(j=a.video.processor)?void 0:j.type)&&(null==(k=a.video.processor)?void 0:k._isDefaultWhenNone);if(a.video.processor&&!l){var m=jl({},a.video.processor);delete m._isDefaultWhenNone,c.video=jl(jl({},c.video),{},{processor:m})}}return c}}},{key:"getInputSettings",value:function(){var a=this;return jK(),new Promise(function(b){b(a._getInputSettings())})}},{key:"_getInputSettings",value:function(){var a,b,c,d,e,f,g={processor:{type:"none",_isDefaultWhenNone:!0}};this._inputSettings?(a=(null==(c=this._inputSettings)?void 0:c.video)||g,b=(null==(d=this._inputSettings)?void 0:d.audio)||g):(a=(null==(e=this._preloadCache)||null==(e=e.inputSettings)?void 0:e.video)||g,b=(null==(f=this._preloadCache)||null==(f=f.inputSettings)?void 0:f.audio)||g);var h={audio:b,video:a};return this._prepInputSettingsForSharing(h,!0)}},{key:"_updatePreloadCacheInputSettings",value:function(a,b){var c,d,e,f,g,h,i=this._inputSettings||{},j={};a.video?((j.video={},a.video.settings)?(j.video.settings={},b||a.video.settings.customTrack||null==(e=i.video)||!e.settings?j.video.settings=a.video.settings:j.video.settings=jl(jl({},i.video.settings),a.video.settings),Object.keys(j.video.settings).length||delete j.video.settings):null!=(c=i.video)&&c.settings&&(j.video.settings=i.video.settings),a.video.processor?j.video.processor=a.video.processor:null!=(d=i.video)&&d.processor&&(j.video.processor=i.video.processor)):i.video&&(j.video=i.video),a.audio?((j.audio={},a.audio.settings)?(j.audio.settings={},b||a.audio.settings.customTrack||null==(h=i.audio)||!h.settings?j.audio.settings=a.audio.settings:j.audio.settings=jl(jl({},i.audio.settings),a.audio.settings),Object.keys(j.audio.settings).length||delete j.audio.settings):null!=(f=i.audio)&&f.settings&&(j.audio.settings=i.audio.settings),a.audio.processor?j.audio.processor=a.audio.processor:null!=(g=i.audio)&&g.processor&&(j.audio.processor=i.audio.processor)):i.audio&&(j.audio=i.audio),this._maybeUpdateInputSettings(j)}},{key:"_devicesFromInputSettings",value:function(a){var b,c,d=(null==a||null==(b=a.video)||null==(b=b.settings)?void 0:b.deviceId)||null,e=(null==a||null==(c=a.audio)||null==(c=c.settings)?void 0:c.deviceId)||null,f=this._preloadCache.outputDeviceId||null;return{camera:d?{deviceId:d}:{},mic:e?{deviceId:e}:{},speaker:f?{deviceId:f}:{}}}},{key:"updateInputSettings",value:(G=eT(function*(a){var b=this;return jK(),jO(a)?a.video||a.audio?(jP(a,this.properties.dailyConfig,this._sharedTracks),this._callObjectMode&&!this._callMachineInitialized?(this._updatePreloadCacheInputSettings(a,!0),this._getInputSettings()):new Promise(function(c,d){b.sendMessageToCallMachine({action:"update-input-settings",inputSettings:a},function(e){if(e.error)d(e.error);else{if(e.returnPreloadCache)return b._updatePreloadCacheInputSettings(a,!0),void c(b._getInputSettings());b._maybeUpdateInputSettings(e.inputSettings),c(b._prepInputSettingsForSharing(e.inputSettings,!0))}})})):this._getInputSettings():(console.error(jR()),Promise.reject(jR()))}),function(a){return G.apply(this,arguments)})},{key:"setBandwidth",value:function(a){var b=a.kbs,c=a.trackConstraints;if(jK(),this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-bandwidth",kbs:b,trackConstraints:c}),this}},{key:"getDailyLang",value:function(){var a=this;if(jK(),this._callMachineInitialized)return new Promise(function(b){a.sendMessageToCallMachine({action:"get-daily-lang"},function(a){delete a.action,delete a.callbackStamp,b(a)})})}},{key:"setDailyLang",value:function(a){return jK(),this.sendMessageToCallMachine({action:"set-daily-lang",lang:a}),this}},{key:"setProxyUrl",value:function(a){return this.sendMessageToCallMachine({action:"set-proxy-url",proxyUrl:a}),this}},{key:"setIceConfig",value:function(a){return this.sendMessageToCallMachine({action:"set-ice-config",iceConfig:a}),this}},{key:"meetingSessionSummary",value:function(){return[hW,hX].includes(this._callState)?this._finalSummaryOfPrevSession:this._meetingSessionSummary}},{key:"getMeetingSession",value:(F=eT(function*(){var a=this;return console.warn("getMeetingSession() is deprecated: use meetingSessionSummary(), which will return immediately"),jD(this._callState,"getMeetingSession()"),new Promise(function(b){a.sendMessageToCallMachine({action:"get-meeting-session"},function(a){delete a.action,delete a.callbackStamp,b(a)})})}),function(){return F.apply(this,arguments)})},{key:"meetingSessionState",value:function(){return jD(this._callState,"meetingSessionState"),this._meetingSessionState}},{key:"setMeetingSessionData",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"replace";jI(this._callObjectMode,"setMeetingSessionData()"),jD(this._callState,"setMeetingSessionData");try{new iI({data:a,mergeStrategy:b})}catch(a){throw console.error(a),a}try{this.sendMessageToCallMachine({action:"set-session-data",data:a,mergeStrategy:b})}catch(a){throw Error("Error setting meeting session data: ".concat(a))}}},{key:"setUserName",value:function(a,b){var c=this;return this.properties.userName=a,new Promise(function(d){c.sendMessageToCallMachine({action:"set-user-name",name:null!=a?a:"",thisMeetingOnly:ii()||!!b&&!!b.thisMeetingOnly},function(a){delete a.action,delete a.callbackStamp,d(a)})})}},{key:"setUserData",value:(E=eT(function*(a){var b=this;try{jM(a)}catch(a){throw console.error(a),a}if(this.properties.userData=a,this._callMachineInitialized)return new Promise(function(c){try{b.sendMessageToCallMachine({action:"set-user-data",userData:a},function(a){delete a.action,delete a.callbackStamp,c(a)})}catch(a){throw Error("Error setting user data: ".concat(a))}})}),function(a){return E.apply(this,arguments)})},{key:"validateAudioLevelInterval",value:function(a){if(a&&(a<100||"number"!=typeof a))throw Error("The interval must be a number greater than or equal to 100 milliseconds.")}},{key:"startLocalAudioLevelObserver",value:function(a){var b=this;if("u"<typeof AudioWorkletNode&&!ii())throw Error("startLocalAudioLevelObserver() is not supported on this browser");if(this.validateAudioLevelInterval(a),this._callMachineInitialized)return this._isLocalAudioLevelObserverRunning=!0,new Promise(function(c,d){b.sendMessageToCallMachine({action:"start-local-audio-level-observer",interval:a},function(a){b._isLocalAudioLevelObserverRunning=!a.error,a.error?d({error:a.error}):c()})});this._preloadCache.localAudioLevelObserver={enabled:!0,interval:a}}},{key:"isLocalAudioLevelObserverRunning",value:function(){return this._isLocalAudioLevelObserverRunning}},{key:"stopLocalAudioLevelObserver",value:function(){this._preloadCache.localAudioLevelObserver=null,this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-local-audio-level-observer"})}},{key:"startRemoteParticipantsAudioLevelObserver",value:function(a){var b=this;if(this.validateAudioLevelInterval(a),this._callMachineInitialized)return this._isRemoteParticipantsAudioLevelObserverRunning=!0,new Promise(function(c,d){b.sendMessageToCallMachine({action:"start-remote-participants-audio-level-observer",interval:a},function(a){b._isRemoteParticipantsAudioLevelObserverRunning=!a.error,a.error?d({error:a.error}):c()})});this._preloadCache.remoteParticipantsAudioLevelObserver={enabled:!0,interval:a}}},{key:"isRemoteParticipantsAudioLevelObserverRunning",value:function(){return this._isRemoteParticipantsAudioLevelObserverRunning}},{key:"stopRemoteParticipantsAudioLevelObserver",value:function(){this._preloadCache.remoteParticipantsAudioLevelObserver=null,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-remote-participants-audio-level-observer"})}},{key:"startCamera",value:(D=eT(function*(){var a=this,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(jI(this._callObjectMode,"startCamera()"),jF(this._callState,this._isPreparingToJoin,"startCamera()","Did you mean to use setLocalAudio() and/or setLocalVideo() instead?"),this.needsLoad())try{yield this.load(b)}catch(a){return Promise.reject(a)}else{if(this._didPreAuth){if(b.url&&b.url!==this.properties.url)return console.error("url in startCamera() is different than the one used in preAuth()"),Promise.reject();if(b.token&&b.token!==this.properties.token)return console.error("token in startCamera() is different than the one used in preAuth()"),Promise.reject()}this.validateProperties(b),this.properties=jl(jl({},this.properties),b)}return new Promise(function(b,c){a._preloadCache.inputSettings=a._prepInputSettingsForSharing(a._inputSettings,!1),a.sendMessageToCallMachine({action:"start-camera",properties:jC(a.properties,a.callClientId),preloadCache:jC(a._preloadCache,a.callClientId)},function(a){a.error?c(a.error):b({camera:a.camera,mic:a.mic,speaker:a.speaker})})})}),function(){return D.apply(this,arguments)})},{key:"validateCustomTrack",value:function(a,b,c){if(c&&c.length>50)throw Error("Custom track `trackName` must not be more than 50 characters");if(b&&"music"!==b&&"speech"!==b&&!(b instanceof Object))throw Error("Custom track `mode` must be either `music` | `speech` | `DailyMicAudioModeSettings` or `undefined`");if(c&&["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo","customVideoDefaults"].includes(c))throw Error("Custom track `trackName` must not match a track name already used by daily: cam-audio, cam-video, customVideoDefaults, screen-video, screen-audio, rmpAudio, rmpVideo");if(!(a instanceof MediaStreamTrack))throw Error("Custom tracks provided must be instances of MediaStreamTrack")}},{key:"startCustomTrack",value:function(){var a=this,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{track:track,mode:mode,trackName:trackName,ignoreAudioLevel:ignoreAudioLevel};return jK(),jD(this._callState,"startCustomTrack()"),this.validateCustomTrack(b.track,b.mode,b.trackName),new Promise(function(c,d){a._sharedTracks.customTrack=b.track,b.track=ia,a.sendMessageToCallMachine({action:"start-custom-track",properties:b},function(a){a.error?d({error:a.error}):c(a.mediaTag)})})}},{key:"stopCustomTrack",value:function(a){var b=this;return jK(),jD(this._callState,"stopCustomTrack()"),new Promise(function(c){b.sendMessageToCallMachine({action:"stop-custom-track",mediaTag:a},function(a){c(a.mediaTag)})})}},{key:"setCamera",value:function(a){var b=this;return jL(),jG(this._callMachineInitialized,"setCamera()"),new Promise(function(c){b.sendMessageToCallMachine({action:"set-camera",cameraDeviceId:a},function(a){c({device:a.device})})})}},{key:"setAudioDevice",value:(C=eT(function*(a){return jL(),this.nativeUtils().setAudioDevice(a),{deviceId:yield this.nativeUtils().getAudioDevice()}}),function(a){return C.apply(this,arguments)})},{key:"cycleCamera",value:function(){var a=this,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(c){a.sendMessageToCallMachine({action:"cycle-camera",properties:b},function(a){c({device:a.device})})})}},{key:"cycleMic",value:function(){var a=this;return jK(),new Promise(function(b){a.sendMessageToCallMachine({action:"cycle-mic"},function(a){b({device:a.device})})})}},{key:"getCameraFacingMode",value:function(){var a=this;return jL(),new Promise(function(b){a.sendMessageToCallMachine({action:"get-camera-facing-mode"},function(a){b(a.facingMode)})})}},{key:"setInputDevicesAsync",value:(B=eT(function*(a){var b=this,c=a.audioDeviceId,d=a.videoDeviceId,e=a.audioSource,f=a.videoSource;if(jK(),void 0!==e&&(c=e),void 0!==f&&(d=f),"boolean"==typeof c&&(this._setAllowLocalAudio(c),c=void 0),"boolean"==typeof d&&(this._setAllowLocalVideo(d),d=void 0),!c&&!d)return yield this.getInputDevices();var g={};return c&&(c instanceof MediaStreamTrack?(this._sharedTracks.audioTrack=c,g.audio={settings:{customTrack:c=ia}}):(delete this._sharedTracks.audioTrack,g.audio={settings:{deviceId:c}})),d&&(d instanceof MediaStreamTrack?(this._sharedTracks.videoTrack=d,g.video={settings:{customTrack:d=ia}}):(delete this._sharedTracks.videoTrack,g.video={settings:{deviceId:d}})),this._callObjectMode&&this.needsLoad()?(this._updatePreloadCacheInputSettings(g,!1),this._devicesFromInputSettings(this._inputSettings)):new Promise(function(a){b.sendMessageToCallMachine({action:"set-input-devices",audioDeviceId:c,videoDeviceId:d},function(c){(delete c.action,delete c.callbackStamp,c.returnPreloadCache)?(b._updatePreloadCacheInputSettings(g,!1),a(b._devicesFromInputSettings(b._inputSettings))):a(c)})})}),function(a){return B.apply(this,arguments)})},{key:"setOutputDeviceAsync",value:(A=eT(function*(a){var b=this,c=a.outputDeviceId;if(jK(),!c||"string"!=typeof c)throw Error("outputDeviceId must be provided and must be a valid device id");return this._preloadCache.outputDeviceId=c,this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise(function(a,d){b.sendMessageToCallMachine({action:"set-output-device",outputDeviceId:c},function(c){if(delete c.action,delete c.callbackStamp,c.error){var e=Error(c.error.message);return e.type=c.error.type,void d(e)}c.returnPreloadCache?a(b._devicesFromInputSettings(b._inputSettings)):a(c)})})}),function(a){return A.apply(this,arguments)})},{key:"getInputDevices",value:(z=eT(function*(){var a=this;return this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise(function(b){a.sendMessageToCallMachine({action:"get-input-devices"},function(c){c.returnPreloadCache?b(a._devicesFromInputSettings(a._inputSettings)):b({camera:c.camera,mic:c.mic,speaker:c.speaker})})})}),function(){return z.apply(this,arguments)})},{key:"nativeInCallAudioMode",value:function(){return jL(),this._nativeInCallAudioMode}},{key:"setNativeInCallAudioMode",value:function(a){if(jL(),[jq,"voice"].includes(a)){if(a!==this._nativeInCallAudioMode)return this._nativeInCallAudioMode=a,!this.disableReactNativeAutoDeviceManagement("audio")&&jE(this._callState,this._isPreparingToJoin)&&this.nativeUtils().setAudioMode(this._nativeInCallAudioMode),this}else console.error("invalid in-call audio mode specified: ",a)}},{key:"preAuth",value:(y=eT(function*(){var a=this,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(jI(this._callObjectMode,"preAuth()"),jF(this._callState,this._isPreparingToJoin,"preAuth()"),this.needsLoad()&&(yield this.load(b)),!b.url)throw Error("preAuth() requires at least a url to be provided");return this.validateProperties(b),this.properties=jl(jl({},this.properties),b),new Promise(function(b,c){a._preloadCache.inputSettings=a._prepInputSettingsForSharing(a._inputSettings,!1),a.sendMessageToCallMachine({action:"daily-method-preauth",properties:jC(a.properties,a.callClientId),preloadCache:jC(a._preloadCache,a.callClientId)},function(d){return d.error?c(d.error):d.access?(a._didPreAuth=!0,void b({access:d.access})):c(Error("unknown error in preAuth()"))})})}),function(){return y.apply(this,arguments)})},{key:"load",value:(x=eT(function*(a){var b=this;if(this.needsLoad()){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw Error("Use after destroy");if(a&&(this.validateProperties(a),this.properties=jl(jl({},this.properties),a)),!this._callObjectMode&&!this.properties.url)throw Error("can't load iframe meeting because url property isn't set");return this._updateCallState(hS),this.emitDailyJSEvent({action:"loading"}),this._callObjectMode?new Promise(function(a,c){b._callObjectLoader.cancel();var d=Date.now();b._callObjectLoader.load(b.properties.dailyConfig,function(c){b._bundleLoadTime=c?"no-op":Date.now()-d,b._updateCallState(hT),c&&b.emitDailyJSEvent({action:h$}),a()},function(a,d){if(b.emitDailyJSEvent({action:"load-attempt-failed"}),!d){b._updateCallState(hX),b.resetMeetingDependentVars();var e={action:h5,errorMsg:a.msg,error:{type:"connection-error",msg:"Failed to load call object bundle.",details:{on:"load",sourceError:a,bundleUrl:fh(b.properties.dailyConfig)}}};b._maybeSendToSentry(e),b.emitDailyJSEvent(e),c(a.msg)}})}):(this._iframe.src=fg(this.assembleMeetingUrl(),this.properties.dailyConfig),new Promise(function(a,c){b._loadedCallback=function(d){b._callState!==hX?(b._updateCallState(hT),(b.properties.cssFile||b.properties.cssText)&&b.loadCss(b.properties),a()):c(d)}}))}}),function(a){return x.apply(this,arguments)})},{key:"join",value:(w=eT(function*(){var a=this,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._testCallInProgress&&this.stopTestCallQuality(),!b.url&&!this.properties.url){var c="No room URL has been provided";return console.error(c),Promise.reject(Error(c))}var d=!1;if(this.needsLoad()){this.updateIsPreparingToJoin(!0);try{yield this.load(b)}catch(a){return this.updateIsPreparingToJoin(!1),Promise.reject(a)}}else{if(d=!(!this.properties.cssFile&&!this.properties.cssText),this._didPreAuth){if(b.url&&b.url!==this.properties.url)return console.error("url in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject();if(b.token&&b.token!==this.properties.token)return console.error("token in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject()}if(b.url&&!this._callObjectMode&&b.url&&b.url!==this.properties.url)return console.error("url in join() is different than the one used in load() (".concat(this.properties.url," -> ").concat(b.url,")")),this.updateIsPreparingToJoin(!1),Promise.reject();this.validateProperties(b),this.properties=jl(jl({},this.properties),b)}return void 0!==b.showLocalVideo&&(this._callObjectMode?console.error("showLocalVideo is not available in callObject mode"):this._showLocalVideo=!!b.showLocalVideo),void 0!==b.showParticipantsBar&&(this._callObjectMode?console.error("showParticipantsBar is not available in callObject mode"):this._showParticipantsBar=!!b.showParticipantsBar),this._callState===hV||this._callState===hU?(console.warn("already joined meeting, call leave() before joining again"),void this.updateIsPreparingToJoin(!1)):(this._updateCallState(hU,!1),this.emitDailyJSEvent({action:"joining-meeting"}),this._preloadCache.inputSettings=this._prepInputSettingsForSharing(this._inputSettings||{},!1),this.sendMessageToCallMachine({action:"join-meeting",properties:jC(this.properties,this.callClientId),preloadCache:jC(this._preloadCache,this.callClientId)},function(b){b.error&&a._joinedCallback&&(a._joinedCallback(null,b.error),a._joinedCallback=null)}),new Promise(function(b,c){a._joinedCallback=function(e,f){if(a._callState!==hX){if(f)return a._updateCallState(hW),void c(f);if(a._updateCallState(hV),e)for(var g in e){if(a._callObjectMode){var h=a._callMachine().store;iY(e[g],h),iZ(e[g],h),i$(e[g],a._participants[g],h)}a._participants[g]=jl({},e[g]),a.toggleParticipantAudioBasedOnNativeAudioFocus()}d&&a.loadCss(a.properties),b(e)}else c(f)}}))}),function(){return w.apply(this,arguments)})},{key:"leave",value:(v=eT(function*(){var a=this;return this._testCallInProgress&&this.stopTestCallQuality(),new Promise(function(b){a._callState===hW||a._callState===hX?b():a._callObjectLoader&&!a._callObjectLoader.loaded?(a._callObjectLoader.cancel(),a._updateCallState(hW),a.resetMeetingDependentVars(),a.emitDailyJSEvent({action:hW}),b()):(a._resolveLeave=b,a.sendMessageToCallMachine({action:"leave-meeting"}))})}),function(){return v.apply(this,arguments)})},{key:"startScreenShare",value:(u=eT(function*(){var a=this,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(jG(this._callMachineInitialized,"startScreenShare()"),b.screenVideoSendSettings&&this._validateVideoSendSettings("screenVideo",b.screenVideoSendSettings),b.mediaStream&&(this._sharedTracks.screenMediaStream=b.mediaStream,b.mediaStream=ia),"u">typeof DailyNativeUtils&&void 0!==DailyNativeUtils.isIOS&&DailyNativeUtils.isIOS){var c=this.nativeUtils();if(yield c.isScreenBeingCaptured())return void this.emitDailyJSEvent({action:h4,type:"screen-share-error",errorMsg:"Could not start the screen sharing. The screen is already been captured!"});c.setSystemScreenCaptureStartCallback(function(){c.setSystemScreenCaptureStartCallback(null),a.sendMessageToCallMachine({action:h7,captureOptions:b})}),c.presentSystemScreenCapturePrompt()}else this.sendMessageToCallMachine({action:h7,captureOptions:b})}),function(){return u.apply(this,arguments)})},{key:"stopScreenShare",value:function(){jG(this._callMachineInitialized,"stopScreenShare()"),this.sendMessageToCallMachine({action:"local-screen-stop"})}},{key:"startRecording",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.type;if(b&&"cloud"!==b&&"cloud-audio-only"!==b&&"raw-tracks"!==b&&"local"!==b)throw Error("invalid type: ".concat(b,", allowed values 'cloud', 'cloud-audio-only', 'raw-tracks', or 'local'"));this.sendMessageToCallMachine(jl({action:"local-recording-start"},a))}},{key:"updateRecording",value:function(a){var b=a.layout,c=a.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-recording",layout:void 0===b?{preset:"default"}:b,instanceId:c})}},{key:"stopRecording",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sendMessageToCallMachine(jl({action:"local-recording-stop"},a))}},{key:"startLiveStreaming",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sendMessageToCallMachine(jl({action:"daily-method-start-live-streaming"},a))}},{key:"updateLiveStreaming",value:function(a){var b=a.layout,c=a.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming",layout:void 0===b?{preset:"default"}:b,instanceId:c})}},{key:"addLiveStreamingEndpoints",value:function(a){var b=a.endpoints,c=a.instanceId;this.sendMessageToCallMachine({action:h8,endpointsOp:"add-endpoints",endpoints:b,instanceId:c})}},{key:"removeLiveStreamingEndpoints",value:function(a){var b=a.endpoints,c=a.instanceId;this.sendMessageToCallMachine({action:h8,endpointsOp:"remove-endpoints",endpoints:b,instanceId:c})}},{key:"stopLiveStreaming",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sendMessageToCallMachine(jl({action:"daily-method-stop-live-streaming"},a))}},{key:"validateDailyConfig",value:function(a){a.camSimulcastEncodings&&(console.warn("camSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide camera simulcast settings."),this.validateSimulcastEncodings(a.camSimulcastEncodings)),a.screenSimulcastEncodings&&console.warn("screenSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide screen simulcast settings."),iq()&&a.noAutoDefaultDeviceChange&&console.warn("noAutoDefaultDeviceChange is not supported on Android, and will be ignored.")}},{key:"validateSimulcastEncodings",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(a){if(!(a instanceof Array||Array.isArray(a)))throw Error("encodings must be an Array");if(!jY(a.length,1,3))throw Error("encodings must be an Array with between 1 to ".concat(3," layers"));for(var d=0;d<a.length;d++){var e=a[d];for(var f in this._validateEncodingLayerHasValidProperties(e),e)if(ju.includes(f)){if("number"!=typeof e[f])throw Error("".concat(f," must be a number"));if(b){var g=b[f],h=g.min,i=g.max;if(!jY(e[f],h,i))throw Error("".concat(f," value not in range. valid range: ").concat(h," to ").concat(i))}}else if(!["active","scalabilityMode"].includes(f))throw Error("Invalid key ".concat(f,", valid keys are:")+Object.values(ju));if(c&&!e.hasOwnProperty("maxBitrate"))throw Error("maxBitrate is not specified")}}}},{key:"startRemoteMediaPlayer",value:(t=eT(function*(a){var b=this,c=a.url,d=a.settings,e=void 0===d?{state:id.PLAY}:d;try{!function(a){if("string"!=typeof a)throw Error('url parameter must be "string" type')}(c),jX(e),function(a){for(var b in a)if(!jv.includes(b))throw Error("Invalid key ".concat(b,", valid keys are: ").concat(jv));a.simulcastEncodings&&this.validateSimulcastEncodings(a.simulcastEncodings,jt,!0)}(e)}catch(a){throw console.error("invalid argument Error: ".concat(a)),console.error('startRemoteMediaPlayer arguments must be of the form:\n  { url: "playback url",\n  settings?:\n  {state: "play"|"pause", simulcastEncodings?: [{}] } }'),a}return new Promise(function(a,d){b.sendMessageToCallMachine({action:"daily-method-start-remote-media-player",url:c,settings:e},function(b){b.error?d({error:b.error,errorMsg:b.errorMsg}):a({session_id:b.session_id,remoteMediaPlayerState:{state:b.state,settings:b.settings}})})})}),function(a){return t.apply(this,arguments)})},{key:"stopRemoteMediaPlayer",value:(s=eT(function*(a){var b=this;if("string"!=typeof a)throw Error(" remotePlayerID must be of type string");return new Promise(function(c,d){b.sendMessageToCallMachine({action:"daily-method-stop-remote-media-player",session_id:a},function(a){a.error?d({error:a.error,errorMsg:a.errorMsg}):c()})})}),function(a){return s.apply(this,arguments)})},{key:"updateRemoteMediaPlayer",value:(r=eT(function*(a){var b=this,c=a.session_id,d=a.settings;try{jX(d)}catch(a){throw console.error("invalid argument Error: ".concat(a)),console.error('updateRemoteMediaPlayer arguments must be of the form:\n  session_id: "participant session",\n  { settings?: {state: "play"|"pause"} }'),a}return new Promise(function(a,e){b.sendMessageToCallMachine({action:"daily-method-update-remote-media-player",session_id:c,settings:d},function(b){b.error?e({error:b.error,errorMsg:b.errorMsg}):a({session_id:b.session_id,remoteMediaPlayerState:{state:b.state,settings:b.settings}})})})}),function(a){return r.apply(this,arguments)})},{key:"startTranscription",value:function(a){jD(this._callState,"startTranscription()"),this.sendMessageToCallMachine(jl({action:"daily-method-start-transcription"},a))}},{key:"updateTranscription",value:function(a){if(jD(this._callState,"updateTranscription()"),!a)throw Error("updateTranscription Error: options is mandatory");if("object"!==eJ(a))throw Error("updateTranscription Error: options must be object type");if(a.participants&&!Array.isArray(a.participants))throw Error("updateTranscription Error: participants must be an array");this.sendMessageToCallMachine(jl({action:"daily-method-update-transcription"},a))}},{key:"stopTranscription",value:function(a){if(jD(this._callState,"stopTranscription()"),a&&"object"!==eJ(a))throw Error("stopTranscription Error: options must be object type");if(a&&!a.instanceId)throw Error('"instanceId" not provided');this.sendMessageToCallMachine(jl({action:"daily-method-stop-transcription"},a))}},{key:"startDialOut",value:(q=eT(function*(a){var b=this;jD(this._callState,"startDialOut()");var c=function(a){if(a){if(!Array.isArray(a))throw Error("Error starting dial out: audio codec must be an array");if(a.length<=0)throw Error("Error starting dial out: audio codec array specified but empty");a.forEach(function(a){if("string"!=typeof a)throw Error("Error starting dial out: audio codec must be a string");if("OPUS"!==a&&"PCMU"!==a&&"PCMA"!==a&&"G722"!==a)throw Error("Error starting dial out: audio codec must be one of OPUS, PCMU, PCMA, G722")})}};if(!a.sipUri&&!a.phoneNumber)throw Error("Error starting dial out: either a sip uri or phone number must be provided");if(a.sipUri&&a.phoneNumber)throw Error("Error starting dial out: only one of sip uri or phone number must be provided");if(a.sipUri){if("string"!=typeof a.sipUri)throw Error("Error starting dial out: sipUri must be a string");if(!a.sipUri.startsWith("sip:"))throw Error("Error starting dial out: Invalid SIP URI, must start with 'sip:'");if(a.video&&"boolean"!=typeof a.video)throw Error("Error starting dial out: video must be a boolean value");var d=a.codecs;if(d&&(c(d.audio),d.video)){if(!Array.isArray(d.video))throw Error("Error starting dial out: video codec must be an array");if(d.video.length<=0)throw Error("Error starting dial out: video codec array specified but empty");d.video.forEach(function(a){if("string"!=typeof a)throw Error("Error starting dial out: video codec must be a string");if("H264"!==a&&"VP8"!==a)throw Error("Error starting dial out: video codec must be H264 or VP8")})}}if(a.phoneNumber){if("string"!=typeof a.phoneNumber)throw Error("Error starting dial out: phoneNumber must be a string");if(!/^\+\d{1,}$/.test(a.phoneNumber))throw Error("Error starting dial out: Invalid phone number, must be valid phone number as per E.164");a.codecs&&c(a.codecs.audio)}if(a.callerId){if("string"!=typeof a.callerId)throw Error("Error starting dial out: callerId must be a string");if(a.sipUri)throw Error("Error starting dial out: callerId not allowed with sipUri")}if(a.displayName){if("string"!=typeof a.displayName)throw Error("Error starting dial out: displayName must be a string");if(a.displayName.length>=200)throw Error("Error starting dial out: displayName length must be less than 200")}if(a.userId){if("string"!=typeof a.userId)throw Error("Error starting dial out: userId must be a string");if(a.userId.length>36)throw Error("Error starting dial out: userId length must be less than or equal to 36")}if(jB(a),a.permissions&&a.permissions.canReceive){var e=eV(jg.validateJSONObject(a.permissions.canReceive),2),f=e[0],g=e[1];if(!f)throw Error(g)}if(a.provider){if("daily"!==a.provider)throw Error("Error: provider can be set only to 'daily', got: ".concat(a.provider));if(a.phoneNumber)throw Error("Error starting dial out: provider valid only for sipUri, not phoneNumber");console.warn("(pre-beta) provider=daily is currently in pre-beta, things might break!")}return new Promise(function(c,d){b.sendMessageToCallMachine(jl({action:"dialout-start"},a),function(a){a.error?d(a.error):c(a)})})}),function(a){return q.apply(this,arguments)})},{key:"stopDialOut",value:function(a){var b=this;return jD(this._callState,"stopDialOut()"),new Promise(function(c,d){b.sendMessageToCallMachine(jl({action:"dialout-stop"},a),function(a){a.error?d(a.error):c(a)})})}},{key:"sipCallTransfer",value:(p=eT(function*(a){var b=this;if(jD(this._callState,"sipCallTransfer()"),!a)throw Error("sipCallTransfer() requires a sessionId and toEndPoint");return a.useSipRefer=!1,jW(a,"sipCallTransfer"),jB(a),new Promise(function(c,d){b.sendMessageToCallMachine(jl({action:ig},a),function(a){a.error?d(a.error):c(a)})})}),function(a){return p.apply(this,arguments)})},{key:"sipRefer",value:(o=eT(function*(a){var b=this;if(jD(this._callState,"sipRefer()"),!a)throw Error("sessionId and toEndPoint are mandatory parameter");return a.useSipRefer=!0,jW(a,"sipRefer"),new Promise(function(c,d){b.sendMessageToCallMachine(jl({action:ig},a),function(a){a.error?d(a.error):c(a)})})}),function(a){return o.apply(this,arguments)})},{key:"sendDTMF",value:(n=eT(function*(a){var b=this;return jD(this._callState,"sendDTMF()"),function(a){var b=a.sessionId,c=a.tones;if(!b||!c)throw Error("sessionId and tones are mandatory parameter");if("string"!=typeof b||"string"!=typeof c)throw Error("sessionId and tones should be of string type");if(c.length>20)throw Error("tones string must be upto 20 characters");var d=c.match(/[^0-9A-D*#]/g);if(d&&d[0])throw Error("".concat(d[0]," is not valid DTMF tone"))}(a),new Promise(function(c,d){b.sendMessageToCallMachine(jl({action:"send-dtmf"},a),function(a){a.error?d(a.error):c(a)})})}),function(a){return n.apply(this,arguments)})},{key:"getNetworkStats",value:function(){var a=this;return this._callState!==hV?Promise.resolve(jl({stats:{latest:{}}},this._network)):new Promise(function(b){a.sendMessageToCallMachine({action:"get-calc-stats"},function(c){b(jl(jl({},a._network),{},{stats:c.stats}))})})}},{key:"testWebsocketConnectivity",value:(m=eT(function*(){var a=this;if(jH(this._testCallInProgress,"testWebsocketConnectivity()"),this.needsLoad())try{yield this.load()}catch(a){return Promise.reject(a)}return new Promise(function(b,c){a.sendMessageToCallMachine({action:"test-websocket-connectivity"},function(a){a.error?c(a.error):b(a.results)})})}),function(){return m.apply(this,arguments)})},{key:"abortTestWebsocketConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-websocket-connectivity"})}},{key:"_validateVideoTrackForNetworkTests",value:function(a){return a?a instanceof MediaStreamTrack?!!(a&&"live"===a.readyState&&(!a.muted||i6.has(a.id)))||(console.error("Video track is not playable. This test needs a live video track."),!1):(console.error("Video track needs to be of type `MediaStreamTrack`."),!1):(console.error("Missing video track. You must provide a video track in order to run this test."),!1)}},{key:"testCallQuality",value:(l=eT(function*(){var a=this;jK(),jI(this._callObjectMode,"testCallQuality()"),jG(this._callMachineInitialized,"testCallQuality()",null,!0),jF(this._callState,this._isPreparingToJoin,"testCallQuality()");var b=this._testCallAlreadyInProgress,c=function(c){b||(a._testCallInProgress=c)};if(c(!0),this.needsLoad())try{var d=this._callState;yield this.load(),this._callState=d}catch(a){return c(!1),Promise.reject(a)}return new Promise(function(b){a.sendMessageToCallMachine({action:"test-call-quality",dailyJsVersion:a.properties.dailyJsVersion},function(d){var e=d.results,f=e.result,g=eH(e,ji);if("failed"===f){var h,i=jl({},g);null!=(h=g.error)&&h.details?(g.error.details=JSON.parse(g.error.details),i.error=jl(jl({},i.error),{},{details:jl({},i.error.details)}),i.error.details.duringTest="testCallQuality"):(i.error=i.error?jl({},i.error):{},i.error.details={duringTest:"testCallQuality"}),a._maybeSendToSentry(i)}c(!1),b(jl({result:f},g))})})}),function(){return l.apply(this,arguments)})},{key:"stopTestCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-call-quality"})}},{key:"testConnectionQuality",value:(k=eT(function*(a){ii()?(console.warn("testConnectionQuality() is deprecated: use testPeerToPeerCallQuality() instead"),b=yield this.testPeerToPeerCallQuality(a)):(console.warn("testConnectionQuality() is deprecated: use testCallQuality() instead"),b=yield this.testCallQuality());var b,c={result:b.result,secondsElapsed:b.secondsElapsed};return b.data&&(c.data={maxRTT:b.data.maxRoundTripTime,packetLoss:b.data.avgRecvPacketLoss}),c}),function(a){return k.apply(this,arguments)})},{key:"testPeerToPeerCallQuality",value:(j=eT(function*(a){var b=this;if(jH(this._testCallInProgress,"testPeerToPeerCallQuality()"),this.needsLoad())try{yield this.load()}catch(a){return Promise.reject(a)}var c=a.videoTrack,d=a.duration;if(!this._validateVideoTrackForNetworkTests(c))throw Error("Video track error");return this._sharedTracks.videoTrackForConnectionQualityTest=c,new Promise(function(a,c){b.sendMessageToCallMachine({action:"test-p2p-call-quality",duration:d},function(b){b.error?c(b.error):a(b.results)})})}),function(a){return j.apply(this,arguments)})},{key:"stopTestConnectionQuality",value:function(){ii()?(console.warn("stopTestConnectionQuality() is deprecated: use testPeerToPeerCallQuality() and stopTestPeerToPeerCallQuality() instead"),this.stopTestPeerToPeerCallQuality()):(console.warn("stopTestConnectionQuality() is deprecated: use testCallQuality() and stopTestCallQuality() instead"),this.stopTestCallQuality())}},{key:"stopTestPeerToPeerCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-p2p-call-quality"})}},{key:"testNetworkConnectivity",value:(i=eT(function*(a){var b=this;if(jH(this._testCallInProgress,"testNetworkConnectivity()"),this.needsLoad())try{yield this.load()}catch(a){return Promise.reject(a)}if(!this._validateVideoTrackForNetworkTests(a))throw Error("Video track error");return this._sharedTracks.videoTrackForNetworkConnectivityTest=a,new Promise(function(a,c){b.sendMessageToCallMachine({action:"test-network-connectivity"},function(b){b.error?c(b.error):a(b.results)})})}),function(a){return i.apply(this,arguments)})},{key:"abortTestNetworkConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-network-connectivity"})}},{key:"getCpuLoadStats",value:function(){var a=this;return new Promise(function(b){a._callState===hV?a.sendMessageToCallMachine({action:"get-cpu-load-stats"},function(a){b(a.cpuStats)}):b({cpuLoadState:void 0,cpuLoadStateReason:void 0,stats:{}})})}},{key:"_validateEncodingLayerHasValidProperties",value:function(a){var b;if(!((null==(b=Object.keys(a))?void 0:b.length)>0))throw Error("Empty encoding is not allowed. At least one of these valid keys should be specified:"+Object.values(ju))}},{key:"_validateVideoSendSettings",value:function(a,b){var c="screenVideo"===a?["default-screen-video","detail-optimized","motion-optimized","motion-and-detail-balanced"]:["default-video","bandwidth-optimized","bandwidth-and-quality-balanced","quality-optimized","adaptive-2-layers","adaptive-3-layers"],d="Video send settings should be either an object or one of the supported presets: ".concat(c.join());if("string"==typeof b){if(!c.includes(b))throw Error(d)}else{if("object"!==eJ(b))throw Error(d);if(!b.maxQuality&&!b.encodings&&void 0===b.allowAdaptiveLayers)throw Error("Video send settings must contain at least maxQuality, allowAdaptiveLayers or encodings attribute");if(b.maxQuality&&-1===["low","medium","high"].indexOf(b.maxQuality))throw Error("maxQuality must be either low, medium or high");if(b.encodings){var e=!1;switch(Object.keys(b.encodings).length){case 1:e=!b.encodings.low;break;case 2:e=!b.encodings.low||!b.encodings.medium;break;case 3:e=!b.encodings.low||!b.encodings.medium||!b.encodings.high;break;default:e=!0}if(e)throw Error("Encodings must be defined as: low, low and medium, or low, medium and high.");b.encodings.low&&this._validateEncodingLayerHasValidProperties(b.encodings.low),b.encodings.medium&&this._validateEncodingLayerHasValidProperties(b.encodings.medium),b.encodings.high&&this._validateEncodingLayerHasValidProperties(b.encodings.high)}}}},{key:"validateUpdateSendSettings",value:function(a){var b=this;if(!a||0===Object.keys(a).length)throw Error("Send settings must contain at least information for one track!");Object.entries(a).forEach(function(a){var c=eV(a,2),d=c[0],e=c[1];b._validateVideoSendSettings(d,e)})}},{key:"updateSendSettings",value:function(a){var b=this;return this.validateUpdateSendSettings(a),this.needsLoad()?(this._preloadCache.sendSettings=a,{sendSettings:this._preloadCache.sendSettings}):new Promise(function(c,d){b.sendMessageToCallMachine({action:"update-send-settings",sendSettings:a},function(a){a.error?d(a.error):c(a.sendSettings)})})}},{key:"getSendSettings",value:function(){return this._sendSettings||this._preloadCache.sendSettings}},{key:"getLocalAudioLevel",value:function(){return this._localAudioLevel}},{key:"getRemoteParticipantsAudioLevel",value:function(){return this._remoteParticipantsAudioLevel}},{key:"getActiveSpeaker",value:function(){return jK(),this._activeSpeaker}},{key:"setActiveSpeakerMode",value:function(a){return jK(),this.sendMessageToCallMachine({action:"set-active-speaker-mode",enabled:a}),this}},{key:"activeSpeakerMode",value:function(){return jK(),this._activeSpeakerMode}},{key:"subscribeToTracksAutomatically",value:function(){return this._preloadCache.subscribeToTracksAutomatically}},{key:"setSubscribeToTracksAutomatically",value:function(a){return jD(this._callState,"setSubscribeToTracksAutomatically()","Use the subscribeToTracksAutomatically configuration property."),this._preloadCache.subscribeToTracksAutomatically=a,this.sendMessageToCallMachine({action:"daily-method-subscribe-to-tracks-automatically",enabled:a}),this}},{key:"enumerateDevices",value:(h=eT(function*(){var a=this;if(this._callObjectMode){var b=yield navigator.mediaDevices.enumerateDevices();return"Firefox"===is()&&it().major>115&&it().major<123&&(b=b.filter(function(a){return"audiooutput"!==a.kind})),{devices:b.map(function(a){var b=JSON.parse(JSON.stringify(a));if(!ii()&&"videoinput"===a.kind&&a.getCapabilities){var c,d=a.getCapabilities();b.facing=(null==d||null==(c=d.facingMode)?void 0:c.length)>=1?d.facingMode[0]:void 0}return b})}}return new Promise(function(b){a.sendMessageToCallMachine({action:"enumerate-devices"},function(a){b({devices:a.devices})})})}),function(){return h.apply(this,arguments)})},{key:"sendAppMessage",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*";if(jD(this._callState,"sendAppMessage()"),JSON.stringify(a).length>this._maxAppMessageSize)throw Error("Message data too large. Max size is "+this._maxAppMessageSize);return this.sendMessageToCallMachine({action:"app-msg",data:a,to:b}),this}},{key:"addFakeParticipant",value:function(a){return jK(),jD(this._callState,"addFakeParticipant()"),this.sendMessageToCallMachine(jl({action:"add-fake-participant"},a)),this}},{key:"setShowNamesMode",value:function(a){return jJ(this._callObjectMode,"setShowNamesMode()"),jK(),a&&"always"!==a&&"never"!==a?console.error('setShowNamesMode argument should be "always", "never", or false'):this.sendMessageToCallMachine({action:"set-show-names",mode:a}),this}},{key:"setShowLocalVideo",value:function(){var a=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return jJ(this._callObjectMode,"setShowLocalVideo()"),jK(),jD(this._callState,"setShowLocalVideo()"),"boolean"!=typeof a?console.error("setShowLocalVideo only accepts a boolean value"):(this.sendMessageToCallMachine({action:"set-show-local-video",show:a}),this._showLocalVideo=a),this}},{key:"showLocalVideo",value:function(){return jJ(this._callObjectMode,"showLocalVideo()"),jK(),this._showLocalVideo}},{key:"setShowParticipantsBar",value:function(){var a=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return jJ(this._callObjectMode,"setShowParticipantsBar()"),jK(),jD(this._callState,"setShowParticipantsBar()"),"boolean"!=typeof a?console.error("setShowParticipantsBar only accepts a boolean value"):(this.sendMessageToCallMachine({action:"set-show-participants-bar",show:a}),this._showParticipantsBar=a),this}},{key:"showParticipantsBar",value:function(){return jJ(this._callObjectMode,"showParticipantsBar()"),jK(),this._showParticipantsBar}},{key:"customIntegrations",value:function(){return jK(),jJ(this._callObjectMode,"customIntegrations()"),this._customIntegrations}},{key:"setCustomIntegrations",value:function(a){return jK(),jJ(this._callObjectMode,"setCustomIntegrations()"),jD(this._callState,"setCustomIntegrations()"),jV(a)&&(this.sendMessageToCallMachine({action:"set-custom-integrations",integrations:a}),this._customIntegrations=a),this}},{key:"startCustomIntegrations",value:function(a){var b=this;if(jK(),jJ(this._callObjectMode,"startCustomIntegrations()"),jD(this._callState,"startCustomIntegrations()"),Array.isArray(a)&&a.some(function(a){return"string"!=typeof a})||!Array.isArray(a)&&"string"!=typeof a)return console.error("startCustomIntegrations() only accepts string | string[]"),this;var c="string"==typeof a?[a]:a,d=c.filter(function(a){return!(a in b._customIntegrations)});return d.length?console.error("Can't find custom integration(s): \"".concat(d.join(", "),'"')):this.sendMessageToCallMachine({action:"start-custom-integrations",ids:c}),this}},{key:"stopCustomIntegrations",value:function(a){var b=this;if(jK(),jJ(this._callObjectMode,"stopCustomIntegrations()"),jD(this._callState,"stopCustomIntegrations()"),Array.isArray(a)&&a.some(function(a){return"string"!=typeof a})||!Array.isArray(a)&&"string"!=typeof a)return console.error("stopCustomIntegrations() only accepts string | string[]"),this;var c="string"==typeof a?[a]:a,d=c.filter(function(a){return!(a in b._customIntegrations)});return d.length?console.error("Can't find custom integration(s): \"".concat(d.join(", "),'"')):this.sendMessageToCallMachine({action:"stop-custom-integrations",ids:c}),this}},{key:"customTrayButtons",value:function(){return jJ(this._callObjectMode,"customTrayButtons()"),jK(),this._customTrayButtons}},{key:"updateCustomTrayButtons",value:function(a){return jJ(this._callObjectMode,"updateCustomTrayButtons()"),jK(),jD(this._callState,"updateCustomTrayButtons()"),jU(a)?(this.sendMessageToCallMachine({action:"update-custom-tray-buttons",btns:a}),this._customTrayButtons=a):console.error("updateCustomTrayButtons only accepts a dictionary of the type ".concat(JSON.stringify(jx))),this}},{key:"theme",value:function(){return jJ(this._callObjectMode,"theme()"),this.properties.theme}},{key:"setTheme",value:function(a){var b=this;return jJ(this._callObjectMode,"setTheme()"),new Promise(function(c,d){try{b.validateProperties({theme:a}),b.properties.theme=jl({},a),b.sendMessageToCallMachine({action:"set-theme",theme:b.properties.theme});try{b.emitDailyJSEvent({action:"theme-updated",theme:b.properties.theme})}catch(a){console.log("could not emit 'theme-updated'",a)}c(b.properties.theme)}catch(a){d(a)}})}},{key:"requestFullscreen",value:(f=eT(function*(){if(jK(),this._iframe&&!document.fullscreenElement&&ij())try{(yield this._iframe.requestFullscreen)?this._iframe.requestFullscreen():this._iframe.webkitRequestFullscreen()}catch(a){console.log("could not make video call fullscreen",a)}}),function(){return f.apply(this,arguments)})},{key:"exitFullscreen",value:function(){jK(),document.fullscreenElement?document.exitFullscreen():document.webkitFullscreenElement&&document.webkitExitFullscreen()}},{key:"getSidebarView",value:(e=eT(function*(){var a=this;return this._callObjectMode?(console.error("getSidebarView is not available in callObject mode"),Promise.resolve(null)):new Promise(function(b){a.sendMessageToCallMachine({action:"get-sidebar-view"},function(a){b(a.view)})})}),function(){return e.apply(this,arguments)})},{key:"setSidebarView",value:function(a){return this._callObjectMode?console.error("setSidebarView is not available in callObject mode"):this.sendMessageToCallMachine({action:"set-sidebar-view",view:a}),this}},{key:"room",value:(d=eT(function*(){var a=this,b=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeRoomConfigDefaults,c=void 0===b||b;return this._accessState.access===hY||this.needsLoad()?this.properties.url?{roomUrlPendingJoin:this.properties.url}:null:new Promise(function(b){a.sendMessageToCallMachine({action:"lib-room-info",includeRoomConfigDefaults:c},function(a){delete a.action,delete a.callbackStamp,b(a)})})}),function(){return d.apply(this,arguments)})},{key:"geo",value:(c=eT(function*(){try{var a=yield fetch("https://gs.daily.co/_ks_/x-swsl/:");return{current:(yield a.json()).geo}}catch(a){return console.error("geo lookup failed",a),{current:""}}}),function(){return c.apply(this,arguments)})},{key:"setNetworkTopology",value:(b=eT(function*(a){var b=this;return jK(),jD(this._callState,"setNetworkTopology()"),new Promise(function(c,d){b.sendMessageToCallMachine({action:"set-network-topology",opts:a},function(a){a.error?d({error:a.error}):c({workerId:a.workerId})})})}),function(a){return b.apply(this,arguments)})},{key:"getNetworkTopology",value:(a=eT(function*(){var a=this;return new Promise(function(b,c){a.needsLoad()&&b({topology:"none"}),a.sendMessageToCallMachine({action:"get-network-topology"},function(a){a.error?c({error:a.error}):b({topology:a.topology})})})}),function(){return a.apply(this,arguments)})},{key:"setPlayNewParticipantSound",value:function(a){if(jK(),"number"!=typeof a&&!0!==a&&!1!==a)throw Error("argument to setShouldPlayNewParticipantSound should be true, false, or a number, but is ".concat(a));this.sendMessageToCallMachine({action:"daily-method-set-play-ding",arg:a})}},{key:"on",value:function(a,b){return eZ.prototype.on.call(this,a,b)}},{key:"once",value:function(a,b){return eZ.prototype.once.call(this,a,b)}},{key:"off",value:function(a,b){return eZ.prototype.off.call(this,a,b)}},{key:"validateProperties",value:function(a){var b,c;if(null!=a&&null!=(b=a.dailyConfig)&&b.userMediaAudioConstraints){ii()||console.warn("userMediaAudioConstraints is deprecated. You can override constraints with inputSettings.audio.settings, found in DailyCallOptions.");var d,e,f=a.inputSettings||{};f.audio=(null==(d=a.inputSettings)?void 0:d.audio)||{},f.audio.settings=(null==(e=a.inputSettings)||null==(e=e.audio)?void 0:e.settings)||{},f.audio.settings=jl(jl({},f.audio.settings),a.dailyConfig.userMediaAudioConstraints),a.inputSettings=f,delete a.dailyConfig.userMediaAudioConstraints}if(null!=a&&null!=(c=a.dailyConfig)&&c.userMediaVideoConstraints){ii()||console.warn("userMediaVideoConstraints is deprecated. You can override constraints with inputSettings.video.settings, found in DailyCallOptions.");var g,h,i=a.inputSettings||{};i.video=(null==(g=a.inputSettings)?void 0:g.video)||{},i.video.settings=(null==(h=a.inputSettings)||null==(h=h.video)?void 0:h.settings)||{},i.video.settings=jl(jl({},i.video.settings),a.dailyConfig.userMediaVideoConstraints),a.inputSettings=i,delete a.dailyConfig.userMediaVideoConstraints}for(var j in a)if(jz[j]){if(jz[j].validate&&!jz[j].validate(a[j],this))throw Error("property '".concat(j,"': ").concat(jz[j].help))}else console.warn("Ignoring unrecognized property '".concat(j,"'")),delete a[j]}},{key:"assembleMeetingUrl",value:function(){var a,b,c=jl(jl({},this.properties),{},{emb:this.callClientId,embHref:encodeURIComponent(window.location.href),proxy:null!=(a=this.properties.dailyConfig)&&a.proxyUrl?encodeURIComponent(null==(b=this.properties.dailyConfig)?void 0:b.proxyUrl):void 0}),d=c.url.match(/\?/)?"&":"?";return c.url+d+Object.keys(jz).filter(function(a){return jz[a].queryString&&void 0!==c[a]}).map(function(a){return"".concat(jz[a].queryString,"=").concat(c[a])}).join("&")}},{key:"needsLoad",value:function(){return["new",hS,hW,hX].includes(this._callState)}},{key:"sendMessageToCallMachine",value:function(a,b){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw Error("Use after destroy");this._messageChannel.sendMessageToCallMachine(a,b,this.callClientId,this._iframe)}},{key:"forwardPackagedMessageToCallMachine",value:function(a){this._messageChannel.forwardPackagedMessageToCallMachine(a,this._iframe,this.callClientId)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(a){return this._messageChannel.addListenerForPackagedMessagesFromCallMachine(a,this.callClientId)}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(a){this._messageChannel.removeListenerForPackagedMessagesFromCallMachine(a)}},{key:"handleMessageFromCallMachine",value:function(a){switch(a.action){case"iframe-ready-for-launch-config":this.sendMessageToCallMachine(jl({action:"iframe-launch-config"},this.properties));break;case"call-machine-initialized":this._callMachineInitialized=!0;var b={action:h9,level:"log",code:1011,stats:{event:"bundle load",time:"no-op"===this._bundleLoadTime?0:this._bundleLoadTime,preLoaded:"no-op"===this._bundleLoadTime,url:fh(this.properties.dailyConfig)}};this.sendMessageToCallMachine(b),this._delayDuplicateInstanceLog&&this._logDuplicateInstanceAttempt();break;case h$:this._loadedCallback&&(this._loadedCallback(),this._loadedCallback=null),this.emitDailyJSEvent(a);break;case"joined-meeting":var c,d=jl({},a);delete d.internal,this._maxAppMessageSize=(null==(c=a.internal)?void 0:c._maxAppMessageSize)||4096,this._joinedCallback&&(this._joinedCallback(a.participants),this._joinedCallback=null),this.emitDailyJSEvent(d);break;case"participant-joined":case"participant-updated":if(this._callState===hW)return;if(a.participant&&a.participant.session_id){var e=a.participant.local?"local":a.participant.session_id;if(this._callObjectMode){var f=this._callMachine().store;iY(a.participant,f),iZ(a.participant,f),i$(a.participant,this._participants[e],f)}try{this.maybeParticipantTracksStopped(this._participants[e],a.participant),this.maybeParticipantTracksStarted(this._participants[e],a.participant),this.maybeEventRecordingStopped(this._participants[e],a.participant),this.maybeEventRecordingStarted(this._participants[e],a.participant)}catch(a){console.error("track events error",a)}this.compareEqualForParticipantUpdateEvent(a.participant,this._participants[e])||(this._participants[e]=jl({},a.participant),this.toggleParticipantAudioBasedOnNativeAudioFocus(),this.emitDailyJSEvent(a))}break;case"participant-left":if(a.participant&&a.participant.session_id){var g=this._participants[a.participant.session_id];g&&this.maybeParticipantTracksStopped(g,null),delete this._participants[a.participant.session_id],this.emitDailyJSEvent(a)}break;case"participant-counts-updated":e0(this._participantCounts,a.participantCounts)||(this._participantCounts=a.participantCounts,this.emitDailyJSEvent(a));break;case"access-state-updated":var h={access:a.access};a.awaitingAccess&&(h.awaitingAccess=a.awaitingAccess),e0(this._accessState,h)||(this._accessState=h,this.emitDailyJSEvent(a));break;case"meeting-session-summary-updated":if(a.meetingSession){this._meetingSessionSummary=a.meetingSession,this.emitDailyJSEvent(a);var i=jl(jl({},a),{},{action:"meeting-session-updated"});this.emitDailyJSEvent(i)}break;case h5:this._iframe&&!a.preserveIframe&&(this._iframe.src=""),this._updateCallState(hX),this.resetMeetingDependentVars(),this._loadedCallback&&(this._loadedCallback(a.errorMsg),this._loadedCallback=null),a.preserveIframe;var j,k=eH(a,jj);null!=k&&null!=(j=k.error)&&j.details&&(k.error.details=JSON.parse(k.error.details)),this._maybeSendToSentry(a),this._joinedCallback&&(this._joinedCallback(null,k),this._joinedCallback=null),this.emitDailyJSEvent(k);break;case"left-meeting":this._callState!==hX&&this._updateCallState(hW),this.resetMeetingDependentVars(),this._resolveLeave&&(this._resolveLeave(),this._resolveLeave=null),this.emitDailyJSEvent(a);break;case"selected-devices-updated":a.devices&&this.emitDailyJSEvent(a);break;case"network-quality-change":var l=a.state,m=a.threshold,n=a.quality,o=l.state,p=l.reasons;o===this._network.networkState&&e0(p,this._network.networkStateReasons)&&m===this._network.threshold&&n===this._network.quality||(this._network.networkState=o,this._network.networkStateReasons=p,this._network.quality=n,this._network.threshold=m,a.networkState=o,p.length&&(a.networkStateReasons=p),delete a.state,this.emitDailyJSEvent(a));break;case"cpu-load-change":a&&a.cpuLoadState&&this.emitDailyJSEvent(a);break;case"face-counts-updated":a&&void 0!==a.faceCounts&&this.emitDailyJSEvent(a);break;case"active-speaker-change":var q=a.activeSpeaker;this._activeSpeaker.peerId!==q.peerId&&(this._activeSpeaker.peerId=q.peerId,this.emitDailyJSEvent({action:a.action,activeSpeaker:this._activeSpeaker}));break;case"show-local-video-changed":if(this._callObjectMode)return;var r=a.show;this._showLocalVideo=r,this.emitDailyJSEvent({action:a.action,show:r});break;case"active-speaker-mode-change":var s=a.enabled;this._activeSpeakerMode!==s&&(this._activeSpeakerMode=s,this.emitDailyJSEvent({action:a.action,enabled:this._activeSpeakerMode}));break;case"waiting-participant-added":case"waiting-participant-updated":case"waiting-participant-removed":this._waitingParticipants=a.allWaitingParticipants,this.emitDailyJSEvent({action:a.action,participant:a.participant});break;case"receive-settings-updated":e0(this._receiveSettings,a.receiveSettings)||(this._receiveSettings=a.receiveSettings,this.emitDailyJSEvent({action:a.action,receiveSettings:a.receiveSettings}));break;case h3:this._maybeUpdateInputSettings(a.inputSettings);break;case"send-settings-updated":e0(this._sendSettings,a.sendSettings)||(this._sendSettings=a.sendSettings,this._preloadCache.sendSettings=null,this.emitDailyJSEvent({action:a.action,sendSettings:a.sendSettings}));break;case"local-audio-level":this._localAudioLevel=a.audioLevel,this._preloadCache.localAudioLevelObserver=null,this.emitDailyJSEvent(a);break;case"remote-participants-audio-level":this._remoteParticipantsAudioLevel=a.participantsAudioLevel,this._preloadCache.remoteParticipantsAudioLevelObserver=null,this.emitDailyJSEvent(a);break;case"remote-media-player-started":var t=a.session_id;this._rmpPlayerState[t]=a.playerState,this.emitDailyJSEvent(a);break;case"remote-media-player-stopped":delete this._rmpPlayerState[a.session_id],this.emitDailyJSEvent(a);break;case"remote-media-player-updated":var u=a.session_id,v=this._rmpPlayerState[u];v&&this.compareEqualForRMPUpdateEvent(v,a.remoteMediaPlayerState)||(this._rmpPlayerState[u]=a.remoteMediaPlayerState,this.emitDailyJSEvent(a));break;case"custom-button-click":case"sidebar-view-changed":case"pip-started":case"pip-stopped":this.emitDailyJSEvent(a);break;case"meeting-session-state-updated":var w=this._meetingSessionState.topology!==(a.meetingSessionState&&a.meetingSessionState.topology);this._meetingSessionState=jZ(a.meetingSessionState,this._callObjectMode),(this._callObjectMode||w)&&this.emitDailyJSEvent(a);break;case"local-screen-share-started":this._isScreenSharing=!0,this.emitDailyJSEvent(a);break;case"local-screen-share-stopped":case"local-screen-share-canceled":this._isScreenSharing=!1,this.emitDailyJSEvent(a);break;case h_:case h0:case"recording-stats":case"recording-error":case"recording-upload-completed":case"transcription-started":case"transcription-stopped":case"transcription-error":case"started-camera":case"camera-error":case"app-message":case"transcription-message":case"test-completed":case"network-connection":case"recording-data":case"live-streaming-started":case"live-streaming-updated":case"live-streaming-stopped":case"live-streaming-error":case h4:case"lang-updated":case"dialin-ready":case"dialin-connected":case"dialin-error":case"dialin-stopped":case"dialin-warning":case"dialout-connected":case"dialout-answered":case"dialout-error":case"dialout-stopped":case"dialout-warning":this.emitDailyJSEvent(a);break;case"request-fullscreen":this.requestFullscreen();break;case"request-exit-fullscreen":this.exitFullscreen()}}},{key:"maybeEventRecordingStopped",value:function(a,b){var c="record";a&&(b.local||!1!==b[c]||a[c]===b[c]||this.emitDailyJSEvent({action:h0}))}},{key:"maybeEventRecordingStarted",value:function(a,b){var c="record";a&&(b.local||!0!==b[c]||a[c]===b[c]||this.emitDailyJSEvent({action:h_}))}},{key:"_trackStatePlayable",value:function(a){return!(!a||"playable"!==a.state)}},{key:"_trackChanged",value:function(a,b){return(null==a?void 0:a.id)!==(null==b?void 0:b.id)}},{key:"maybeEventTrackStopped",value:function(a,b,c){var d,e,f=null!=(d=null==b?void 0:b.tracks[a])?d:null,g=null!=(e=null==c?void 0:c.tracks[a])?e:null,h=null==f?void 0:f.track;if(h){var i=this._trackStatePlayable(f),j=this._trackStatePlayable(g),k=this._trackChanged(h,null==g?void 0:g.track);i&&(j&&!k||this.emitDailyJSEvent({action:"track-stopped",track:h,participant:null!=c?c:b,type:a}))}}},{key:"maybeEventTrackStarted",value:function(a,b,c){var d,e,f=null!=(d=null==b?void 0:b.tracks[a])?d:null,g=null!=(e=null==c?void 0:c.tracks[a])?e:null,h=null==g?void 0:g.track;if(h){var i=this._trackStatePlayable(f),j=this._trackStatePlayable(g),k=this._trackChanged(null==f?void 0:f.track,h);j&&(i&&!k||this.emitDailyJSEvent({action:"track-started",track:h,participant:c,type:a}))}}},{key:"maybeParticipantTracksStopped",value:function(a,b){if(a)for(var c in a.tracks)this.maybeEventTrackStopped(c,a,b)}},{key:"maybeParticipantTracksStarted",value:function(a,b){if(b)for(var c in b.tracks)this.maybeEventTrackStarted(c,a,b)}},{key:"compareEqualForRMPUpdateEvent",value:function(a,b){var c,d;return a.state===b.state&&(null==(c=a.settings)?void 0:c.volume)===(null==(d=b.settings)?void 0:d.volume)}},{key:"emitDailyJSEvent",value:function(a){try{a.callClientId=this.callClientId,this.emit(a.action,a)}catch(b){console.log("could not emit",a,b)}}},{key:"compareEqualForParticipantUpdateEvent",value:function(a,b){return!!e0(a,b)&&(!a.videoTrack||!b.videoTrack||a.videoTrack.id===b.videoTrack.id&&a.videoTrack.muted===b.videoTrack.muted&&a.videoTrack.enabled===b.videoTrack.enabled)&&(!a.audioTrack||!b.audioTrack||a.audioTrack.id===b.audioTrack.id&&a.audioTrack.muted===b.audioTrack.muted&&a.audioTrack.enabled===b.audioTrack.enabled)}},{key:"nativeUtils",value:function(){return ii()?"u"<typeof DailyNativeUtils?(console.warn("in React Native, DailyNativeUtils is expected to be available"),null):DailyNativeUtils:null}},{key:"updateIsPreparingToJoin",value:function(a){this._updateCallState(this._callState,a)}},{key:"_updateCallState",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._isPreparingToJoin;if(a!==this._callState||b!==this._isPreparingToJoin){var c=this._callState,d=this._isPreparingToJoin;this._callState=a,this._isPreparingToJoin=b;var e=this._callState===hV;this.updateShowAndroidOngoingMeetingNotification(e);var f=jE(c,d),g=jE(this._callState,this._isPreparingToJoin);f!==g&&(this.updateKeepDeviceAwake(g),this.updateDeviceAudioMode(g),this.updateNoOpRecordingEnsuringBackgroundContinuity(g))}}},{key:"resetMeetingDependentVars",value:function(){this._participants={},this._participantCounts=js,this._waitingParticipants={},this._activeSpeaker={},this._activeSpeakerMode=!1,this._didPreAuth=!1,this._accessState={access:hY},this._finalSummaryOfPrevSession=this._meetingSessionSummary,this._meetingSessionSummary={},this._meetingSessionState=jZ(jr,this._callObjectMode),this._isScreenSharing=!1,this._receiveSettings={},this._inputSettings=void 0,this._sendSettings={},this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this._maxAppMessageSize=4096,this._callMachineInitialized=!1,this._bundleLoadTime=void 0,this._preloadCache}},{key:"updateKeepDeviceAwake",value:function(a){ii()&&this.nativeUtils().setKeepDeviceAwake(a,this.callClientId)}},{key:"updateDeviceAudioMode",value:function(a){if(ii()&&!this.disableReactNativeAutoDeviceManagement("audio")){var b=a?this._nativeInCallAudioMode:"idle";this.nativeUtils().setAudioMode(b)}}},{key:"updateShowAndroidOngoingMeetingNotification",value:function(a){if(ii()&&this.nativeUtils().setShowOngoingMeetingNotification){var b,c,d,e;if(this.properties.reactNativeConfig&&this.properties.reactNativeConfig.androidInCallNotification){var f=this.properties.reactNativeConfig.androidInCallNotification;b=f.title,c=f.subtitle,d=f.iconName,e=f.disableForCustomOverride}e&&(a=!1),this.nativeUtils().setShowOngoingMeetingNotification(a,b,c,d,this.callClientId)}}},{key:"updateNoOpRecordingEnsuringBackgroundContinuity",value:function(a){ii()&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity(a)}},{key:"toggleParticipantAudioBasedOnNativeAudioFocus",value:function(){var a;if(ii()){var b=null==(a=this._callMachine())||null==(a=a.store)?void 0:a.getState();for(var c in null==b?void 0:b.streams){var d=b.streams[c];d&&d.pendingTrack&&"audio"===d.pendingTrack.kind&&(d.pendingTrack.enabled=this._hasNativeAudioFocus)}}}},{key:"disableReactNativeAutoDeviceManagement",value:function(a){return this.properties.reactNativeConfig&&this.properties.reactNativeConfig.disableAutoDeviceManagement&&this.properties.reactNativeConfig.disableAutoDeviceManagement[a]}},{key:"absoluteUrl",value:function(a){if(void 0!==a){var b=document.createElement("a");return b.href=a,b.href}}},{key:"sayHello",value:function(){var a="hello, world.";return console.log(a),a}},{key:"_logUseAfterDestroy",value:function(){var a=Object.values(jp)[0];if(this.needsLoad())if(a&&!a.needsLoad()){var b={action:h9,level:"error",code:this.strictMode?9995:9997};a.sendMessageToCallMachine(b)}else this.strictMode||console.error("You are are attempting to use a call instance that was previously destroyed, which is unsupported. Please remove `strictMode: false` from your constructor properties to enable strict mode to track down and fix this unsupported usage.");else{var c={action:h9,level:"error",code:this.strictMode?9995:9997};this._messageChannel.sendMessageToCallMachine(c,null,this.callClientId,this._iframe)}}},{key:"_logDuplicateInstanceAttempt",value:function(){for(var a=0,b=Object.values(jp);a<b.length;a++){var c=b[a];c._callMachineInitialized?(c.sendMessageToCallMachine({action:h9,level:"warn",code:this.allowMultipleCallInstances?9993:9992}),c._delayDuplicateInstanceLog=!1):c._delayDuplicateInstanceLog=!0}}},{key:"_maybeSendToSentry",value:function(a){let b,c;if(!(null!=(h=a.error)&&h.type&&(!["connection-error","end-of-life",hZ].includes(a.error.type)||a.error.type===hZ&&a.error.msg.includes("deleted")))){var d=null!=(i=this.properties)&&i.url?new URL(this.properties.url):void 0,e="production";d&&d.host.includes(".staging.daily")&&(e="staging");var f,h,i,j,k,l,m,n,o,p,q=new ht({dsn:"https://f10f1c81e5d44a4098416c0867a8b740@o77906.ingest.sentry.io/168844",transport:hC,stackParser:hJ,integrations:(f={},c=[((a={})=>({name:"InboundFilters",processEvent:(b,c,d)=>!function(a,b){var c;return b.ignoreInternal&&function(a){try{return"SentryError"===a.exception.values[0].type}catch(a){}return!1}(a)?(fj&&fr.warn(`Event dropped due to being internal Sentry Error.
Event: ${ga(a)}`),!0):(c=b.ignoreErrors,!a.type&&c&&c.length&&(function(a){let b,c=[];a.message&&c.push(a.message);try{b=a.exception.values[a.exception.values.length-1]}catch(a){}return b&&b.value&&(c.push(b.value),b.type&&c.push(`${b.type}: ${b.value}`)),c})(a).some(a=>fZ(a,c)))?(fj&&fr.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${ga(a)}`),!0):a.type||!a.exception||!a.exception.values||0===a.exception.values.length||a.message||a.exception.values.some(a=>a.stacktrace||a.type&&"Error"!==a.type||a.value)?!function(a,b){if("transaction"!==a.type||!b||!b.length)return!1;let c=a.transaction;return!!c&&fZ(c,b)}(a,b.ignoreTransactions)?!function(a,b){if(!b||!b.length)return!1;let c=g7(a);return!!c&&fZ(c,b)}(a,b.denyUrls)?!function(a,b){if(!b||!b.length)return!0;let c=g7(a);return!c||fZ(c,b)}(a,b.allowUrls)&&(fj&&fr.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${ga(a)}.
Url: ${g7(a)}`),!0):(fj&&fr.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${ga(a)}.
Url: ${g7(a)}`),!0):(fj&&fr.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${ga(a)}`),!0):(fj&&fr.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${ga(a)}`),!0)}(b,function(a={},b={}){return{allowUrls:[...a.allowUrls||[],...b.allowUrls||[]],denyUrls:[...a.denyUrls||[],...b.denyUrls||[]],ignoreErrors:[...a.ignoreErrors||[],...b.ignoreErrors||[],...a.disableErrorDefaults?[]:g6],ignoreTransactions:[...a.ignoreTransactions||[],...b.ignoreTransactions||[]],ignoreInternal:void 0===a.ignoreInternal||a.ignoreInternal}}(a,d.getOptions()))?b:null}))(),{name:"FunctionToString",setupOnce(){g=Function.prototype.toString;try{Function.prototype.toString=function(...a){let b=f1(this),c=g5.has(gw())&&void 0!==b?b:this;return g.apply(c,a)}}catch(a){}},setup(a){g5.set(a,!0)}},((a={})=>{let b={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...a};return{name:"BrowserApiErrors",setupOnce(){b.setTimeout&&f$(fl,"setTimeout",hM),b.setInterval&&f$(fl,"setInterval",hM),b.requestAnimationFrame&&f$(fl,"requestAnimationFrame",hN),b.XMLHttpRequest&&"XMLHttpRequest"in fl&&f$(XMLHttpRequest.prototype,"send",hO);let a=b.eventTarget;a&&(Array.isArray(a)?a:hL).forEach(hP)}}})(),((a={})=>{let b={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...a};return{name:"Breadcrumbs",setup(a){var c;let d,e;b.console&&(fA(d="console",function(b){var c;if(gw()!==a)return;let d={category:"console",data:{arguments:b.args,logger:"console"},level:"warn"===(c=b.level)?"warning":["fatal","error","warning","log","info","debug"].includes(c)?c:"log",message:fY(b.args," ")};if("assert"===b.level){if(!1!==b.args[0])return;d.message=`Assertion failed: ${fY(b.args.slice(1)," ")||"console.assert"}`,d.data.arguments=b.args.slice(1)}g4(d,{input:b.args,level:b.level})}),fB(d,hb)),b.dom&&(c=b.dom,fA("dom",function(b){if(gw()!==a)return;let d,e,f="object"==typeof c?c.serializeAttribute:void 0,g="object"==typeof c&&"number"==typeof c.maxStringLength?c.maxStringLength:void 0;g&&g>1024&&(hl&&fr.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${g} was configured. Sentry will use 1024 instead.`),g=1024),"string"==typeof f&&(f=[f]);try{let a=b.event,c=a&&a.target?a.target:a;d=fW(c,{keyAttrs:f,maxStringLength:g}),e=function(a){if(!fl.HTMLElement)return null;let b=a;for(let a=0;a<5&&b;a++){if(b instanceof HTMLElement){if(b.dataset.sentryComponent)return b.dataset.sentryComponent;if(b.dataset.sentryElement)return b.dataset.sentryElement}b=b.parentNode}return null}(c)}catch(a){d="<unknown>"}if(0===d.length)return;let h={category:`ui.${b.name}`,message:d};e&&(h.data={"ui.component_name":e}),g4(h,{event:b.event,name:b.name,global:b.global})}),fB("dom",hv)),b.xhr&&(fA("xhr",function(b){if(gw()!==a)return;let{startTimestamp:c,endTimestamp:d}=b,e=b.xhr[hA];if(!c||!d||!e)return;let{method:f,url:g,status_code:h,body:i}=e,j={xhr:b.xhr,input:i,startTimestamp:c,endTimestamp:d};g4({category:"xhr",data:{method:f,url:g,status_code:h},type:"http",level:hf(h)},j)}),fB("xhr",hB)),b.fetch&&(fA(e="fetch",function(b){if(gw()!==a)return;let{startTimestamp:c,endTimestamp:d}=b;if(d&&(!b.fetchData.url.match(/sentry_key/)||"POST"!==b.fetchData.method))if(b.error)g4({category:"fetch",data:b.fetchData,level:"error",type:"http"},{data:b.error,input:b.args,startTimestamp:c,endTimestamp:d});else{let a=b.response,e={...b.fetchData,status_code:a&&a.status},f={input:b.args,response:a,startTimestamp:c,endTimestamp:d};g4({category:"fetch",data:e,type:"http",level:hf(e.status_code)},f)}}),fB(e,()=>(function(a,b=!1){(!b||function(){if("string"==typeof EdgeRuntime)return!0;if(!function(){if(!("fetch"in fl))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(a){return!1}}())return!1;if(hg(fl.fetch))return!0;let a=!1,b=fl.document;if(b&&"function"==typeof b.createElement)try{let c=b.createElement("iframe");c.hidden=!0,b.head.appendChild(c),c.contentWindow&&c.contentWindow.fetch&&(a=hg(c.contentWindow.fetch)),b.head.removeChild(c)}catch(a){fn&&fr.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",a)}return a}())&&f$(fl,"fetch",function(b){return function(...c){let d=Error(),{method:e,url:f}=function(a){if(0===a.length)return{method:"GET",url:""};if(2===a.length){let[b,c]=a;return{url:hi(b),method:hh(c,"method")?String(c.method).toUpperCase():"GET"}}let b=a[0];return{url:hi(b),method:hh(b,"method")?String(b.method).toUpperCase():"GET"}}(c),g={args:c,fetchData:{method:e,url:f},startTimestamp:1e3*f7(),virtualError:d};return a||fC("fetch",{...g}),b.apply(fl,c).then(async a=>(fC("fetch",{...g,endTimestamp:1e3*f7(),response:a}),a),a=>{throw fC("fetch",{...g,endTimestamp:1e3*f7(),error:a}),fK(a)&&void 0===a.stack&&(a.stack=d.stack,f_(a,"framesToPop",1)),a})}})})(void 0,void 0))),b.history&&hx(function(b){if(gw()!==a)return;let c=b.from,d=b.to,e=ha(fl.location.href),f=c?ha(c):void 0,g=ha(d);f&&f.path||(f=e),e.protocol===g.protocol&&e.host===g.host&&(d=g.relative),e.protocol===f.protocol&&e.host===f.host&&(c=f.relative),g4({category:"navigation",data:{from:c,to:d}})}),b.sentry&&a.on("beforeSendEvent",function(b){gw()===a&&g4({category:"sentry."+("transaction"===b.type?"transaction":"event"),event_id:b.event_id,level:b.level,message:ga(b)},{event:b})})}}})(),((a={})=>{let b={onerror:!0,onunhandledrejection:!0,...a};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(a){let c,d;b.onerror&&(fA(c="error",b=>{var c;let d,e,f,g,h,i,{stackParser:j,attachStacktrace:k}=hR();if(gw()!==a||hj>0)return;let{msg:l,url:m,line:n,column:o,error:p}=b,q=(c=hr(j,p||l,void 0,k,!1),h=(g=(f=(e=(d=c.exception=c.exception||{}).values=d.values||[])[0]=e[0]||{}).stacktrace=f.stacktrace||{}).frames=g.frames||[],i=fO(m)&&m.length>0?m:function(){try{return fl.document.location.href}catch(a){return""}}(),0===h.length&&h.push({colno:o,filename:i,function:"?",in_app:!0,lineno:n}),c);q.level="error",gS(q,{originalException:p,mechanism:{handled:!1,type:"onerror"}})}),fB(c,fE),hQ("onerror")),b.onunhandledrejection&&(fA(d="unhandledrejection",b=>{let{stackParser:c,attachStacktrace:d}=hR();if(gw()!==a||hj>0)return;let e=function(a){if(fQ(a))return a;try{if("reason"in a)return a.reason;if("detail"in a&&"reason"in a.detail)return a.detail.reason}catch(a){}return a}(b),f=fQ(e)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(e)}`}]}}:hr(c,e,void 0,d,!0);f.level="error",gS(f,{originalException:e,mechanism:{handled:!1,type:"onunhandledrejection"}})}),fB(d,fG),hQ("onunhandledrejection"))}}})(),((a={})=>{let b=a.limit||5,c=a.key||"cause";return{name:"LinkedErrors",preprocessEvent(a,d,e){let f=e.getOptions();!function(a,b,c=250,d,e,f,g){if(!(f.exception&&f.exception.values&&g&&fU(g.originalException,Error)))return;let h=f.exception.values.length>0?f.exception.values[f.exception.values.length-1]:void 0;h&&(f.exception.values=(function a(b,c,d,e,f,g,h,i){if(g.length>=d+1)return g;let j=[...g];if(fU(e[f],Error)){g8(h,i);let g=b(c,e[f]),k=j.length;g9(g,f,k,i),j=a(b,c,d,e[f],f,[g,...j],g,k)}return Array.isArray(e.errors)&&e.errors.forEach((e,g)=>{if(fU(e,Error)){g8(h,i);let k=b(c,e),l=j.length;g9(k,`errors[${g}]`,l,i),j=a(b,c,d,e,f,[k,...j],k,l)}}),j})(a,b,e,g.originalException,d,f.exception.values,h,0).map(a=>(a.value&&(a.value=fX(a.value,c)),a)))}(hm,f.stackParser,f.maxValueLength,c,b,a,d)}}})(),{name:"Dedupe",processEvent(a){if(a.type)return a;try{if(function(a,b){let c,d,e,f;return!!b&&(c=a.message,d=b.message,!!((c||d)&&(!c||d)&&(c||!d)&&c===d&&hd(a,b)&&hc(a,b))&&!!1||(e=he(b),f=he(a),!!(e&&f&&e.type===f.type&&e.value===f.value&&hd(a,b)&&hc(a,b))))}(a,b))return fj&&fr.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(a){}return b=a}},{name:"HttpContext",preprocessEvent(a){if(!fl.navigator&&!fl.location&&!fl.document)return;let b=a.request&&a.request.url||fl.location&&fl.location.href,{referrer:c}=fl.document||{},{userAgent:d}=fl.navigator||{},e={...a.request&&a.request.headers,...c&&{Referer:c},...d&&{"User-Agent":d}},f={...a.request,...b&&{url:b},headers:e};a.request=f}}],!1!==f.autoSessionTracking&&c.push({name:"BrowserSession",setupOnce(){void 0!==fl.document?(gT({ignoreDuration:!0}),gW(),hx(({from:a,to:b})=>{void 0!==a&&a!==b&&(gT({ignoreDuration:!0}),gW())})):hl&&fr.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.")}}),c).filter(function(a){return!["BrowserApiErrors","Breadcrumbs","GlobalHandlers"].includes(a.name)}),environment:e}),r=new gn;if(r.setClient(q),q.init(),this.session_id&&r.setExtra("sessionId",this.session_id),this.properties){var s=jl({},this.properties);s.userName=s.userName?"[Filtered]":void 0,s.userData=s.userData?"[Filtered]":void 0,s.token=s.token?"[Filtered]":void 0,r.setExtra("properties",s)}if(d){var t=d.searchParams.get("domain");if(!t){var u=d.host.match(/(.*?)\./);t=u&&u[1]||""}t&&r.setTag("domain",t)}a.error&&(r.setTag("fatalErrorType",a.error.type),r.setExtra("errorDetails",a.error.details),(null==(l=a.error.details)?void 0:l.uri)&&r.setTag("serverAddress",a.error.details.uri),(null==(m=a.error.details)?void 0:m.workerGroup)&&r.setTag("workerGroup",a.error.details.workerGroup),(null==(n=a.error.details)?void 0:n.geoGroup)&&r.setTag("geoGroup",a.error.details.geoGroup),(null==(o=a.error.details)?void 0:o.on)&&r.setTag("connectionAttempt",a.error.details.on),null!=(p=a.error.details)&&p.bundleUrl&&(r.setTag("bundleUrl",a.error.details.bundleUrl),r.setTag("bundleError",a.error.details.sourceError.type))),r.setTags({callMode:this._callObjectMode?ii()?"reactNative":null!=(j=this.properties)&&null!=(j=j.dailyConfig)&&null!=(j=j.callMode)&&j.includes("prebuilt")?this.properties.dailyConfig.callMode:"custom":"prebuilt-frame",version:N.version()});var v=(null==(k=a.error)?void 0:k.msg)||a.errorMsg;r.captureException(Error(v))}}},{key:"_callMachine",value:function(){var a;return null==(a=window._daily)||null==(a=a.instances)||null==(a=a[this.callClientId])?void 0:a.callMachine}},{key:"_maybeUpdateInputSettings",value:function(a){if(!e0(this._inputSettings,a)){var b=this._getInputSettings();this._inputSettings=a;var c=this._getInputSettings();e0(b,c)||this.emitDailyJSEvent({action:h3,inputSettings:c})}}}],[{key:"supportedBrowser",value:function(){if(ii())return{supported:!0,mobile:!0,name:"React Native",version:null,supportsScreenShare:!0,supportsSfu:!0,supportsVideoProcessing:!1,supportsAudioProcessing:!1};var a=fd.getParser(ih());return{supported:!!ip(),mobile:"mobile"===a.getPlatformType(),name:a.getBrowserName(),version:a.getBrowserVersion(),supportsFullscreen:!!ij(),supportsScreenShare:!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia&&(function(a,b){if(!a||!b)return!0;switch(a){case"Chrome":return b.major>=75;case"Safari":return RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection")&&(13!==b.major||0!==b.minor||0!==b.point);case"Firefox":return b.major>=67}return!0}(is(),it())||ii())),supportsSfu:!!ip(),supportsVideoProcessing:im(),supportsAudioProcessing:io()}}},{key:"version",value:function(){return"0.87.0"}},{key:"createCallObject",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.layout="none",new N(null,a)}},{key:"wrap",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(jK(),!a||!a.contentWindow||"string"!=typeof a.src)throw Error("DailyIframe::Wrap needs an iframe-like first argument");return b.layout||(b.customLayout?b.layout="custom-v1":b.layout="browser"),new N(a,b)}},{key:"createFrame",value:function(a,b){jK(),a&&b?(c=a,d=b):a&&a.append?(c=a,d={}):(c=document.body,d=a||{});var c,d,e=d.iframeStyle;e||(e=c===document.body?{position:"fixed",border:"1px solid black",backgroundColor:"white",width:"375px",height:"450px",right:"1em",bottom:"1em"}:{border:0,width:"100%",height:"100%"});var f=document.createElement("iframe");window.navigator&&window.navigator.userAgent.match(/Chrome\/61\./)?f.allow="microphone, camera":f.allow="microphone; camera; autoplay; display-capture; screen-wake-lock; compute-pressure;",f.style.visibility="hidden",c.appendChild(f),f.style.visibility=null,Object.keys(e).forEach(function(a){return f.style[a]=e[a]}),d.layout||(d.customLayout?d.layout="custom-v1":d.layout="browser");try{return new N(f,d)}catch(a){throw c.removeChild(f),a}}},{key:"createTransparentFrame",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};jK();var b=document.createElement("iframe");return b.allow="microphone; camera; autoplay",b.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      border: 0;\n      pointer-events: none;\n    ",document.body.appendChild(b),a.layout||(a.layout="custom-v1"),N.wrap(b,a)}},{key:"getCallInstance",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return a?jp[a]:Object.values(jp)[0]}}])}(),a.i(878677),a.i(384076),a.s(["default",()=>j$],98919)}];

//# debugId=86ae7f26-1193-03e1-f6ea-f1917544e80b
//# sourceMappingURL=ADK_WORKSPACE_TutorMekimi_tutorme-app_9f34ea94._.js.map