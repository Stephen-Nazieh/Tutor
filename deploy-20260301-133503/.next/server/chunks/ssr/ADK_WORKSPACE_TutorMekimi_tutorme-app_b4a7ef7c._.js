;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="c6888e2c-cda5-c107-0c30-48f2d1790440")}catch(e){}}();
module.exports=[113098,a=>{"use strict";var b=a.i(260576),c=a.i(741510),d=a.i(494176);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",a),...c}));g.displayName="CardTitle";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-muted-foreground",a),...c}));h.displayName="CardDescription";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));i.displayName="CardContent";let j=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c}));j.displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>i,"CardDescription",()=>h,"CardFooter",()=>j,"CardHeader",()=>f,"CardTitle",()=>g])},342621,a=>{"use strict";let b=(0,a.i(293357).default)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);a.s(["BookOpen",()=>b],342621)},479680,a=>{"use strict";let b=(0,a.i(293357).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],479680)},822133,a=>{"use strict";let b=(0,a.i(293357).default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);a.s(["CreditCard",()=>b],822133)},344246,a=>{"use strict";var b=a.i(260576),c=a.i(454069),d=a.i(741510),e=a.i(52028),f=a.i(113098),g=a.i(88684),h=a.i(414030),i=a.i(479680),j=a.i(342621),k=a.i(822133),l=a.i(846438);function m(){var a,m;let n=(0,c.useParams)(),o=(0,c.useRouter)(),p=(0,c.useSearchParams)(),q="string"==typeof n.subjectCode?n.subjectCode:"",r="string"==typeof n.curriculumId?n.curriculumId:"",s=p.get("batch"),[t,u]=(0,d.useState)(null),[v,w]=(0,d.useState)(!0),[x,y]=(0,d.useState)(!1),[z,A]=(0,d.useState)(!1),[B,C]=(0,d.useState)(null),D=`/student/subjects/${encodeURIComponent(q)}/courses`,E=null!=t&&(null==t.price||0===t.price);(0,d.useEffect)(()=>{if(!r)return;let a=!1;return w(!0),C(null),fetch(`/api/curriculums/${encodeURIComponent(r)}`,{credentials:"include"}).then(a=>{if(404===a.status)throw Error("Course not found");if(!a.ok)throw Error("Failed to load course");return a.json()}).then(b=>{a||u(b)}).catch(b=>{a||C(b instanceof Error?b.message:"Failed to load course")}).finally(()=>{a||w(!1)}),()=>{a=!0}},[r]);let F=async()=>{let a=await fetch("/api/csrf",{credentials:"include"}),b=await a.json().catch(()=>({}));return b?.token??null},G=async()=>{if(t&&E){y(!0);try{let a=await F(),b=await fetch(`/api/curriculum/${encodeURIComponent(r)}/enroll`,{method:"POST",headers:{"Content-Type":"application/json",...a&&{"X-CSRF-Token":a}},credentials:"include",body:JSON.stringify(s?{batchId:s}:{})}),c=await b.json().catch(()=>({}));if(!b.ok)return void l.toast.error(c?.message??"Enrollment failed");l.toast.success("Enrolled successfully"),o.push("/student/dashboard")}catch{l.toast.error("Enrollment failed")}finally{y(!1)}}},H=async()=>{if(t&&!E){A(!0);try{let a=await F(),b=await fetch("/api/payments/create",{method:"POST",headers:{"Content-Type":"application/json",...a&&{"X-CSRF-Token":a}},credentials:"include",body:JSON.stringify({curriculumId:r})}),c=await b.json().catch(()=>({}));if(!b.ok)return void l.toast.error(c?.message??c?.error??"Could not start payment");let d=c?.checkoutUrl;if(d){window.location.href=d;return}l.toast.error("No checkout URL received")}catch{l.toast.error("Could not start payment")}finally{A(!1)}}};return v?(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,b.jsx)(i.Loader2,{className:"w-8 h-8 animate-spin text-gray-400"})}):B||!t?(0,b.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,b.jsxs)("div",{className:"max-w-xl mx-auto p-4 sm:p-6",children:[(0,b.jsxs)(e.default,{href:D,className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900 mb-6",children:[(0,b.jsx)(h.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to courses"]}),(0,b.jsx)(f.Card,{className:"border-destructive/50",children:(0,b.jsxs)(f.CardContent,{className:"pt-6",children:[(0,b.jsx)("p",{className:"text-sm text-destructive",children:B??"Course not found"}),(0,b.jsx)(g.Button,{variant:"outline",asChild:!0,className:"mt-4",children:(0,b.jsx)(e.default,{href:D,children:"Back to courses"})})]})})]})}):(0,b.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,b.jsxs)("div",{className:"max-w-xl mx-auto p-4 sm:p-6",children:[(0,b.jsxs)(e.default,{href:D,className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900 mb-6",children:[(0,b.jsx)(h.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to courses"]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(j.BookOpen,{className:"w-5 h-5"}),t.name]}),(t.gradeLevel||t.difficulty)&&(0,b.jsxs)(f.CardDescription,{className:"flex flex-wrap gap-2",children:[t.gradeLevel&&(0,b.jsx)("span",{children:t.gradeLevel}),t.difficulty&&(0,b.jsx)("span",{className:"capitalize",children:t.difficulty})]})]}),(0,b.jsxs)(f.CardContent,{className:"space-y-4",children:[t.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:t.description}),(0,b.jsxs)("ul",{className:"text-sm text-muted-foreground space-y-1",children:[(0,b.jsxs)("li",{children:[t.estimatedHours,"h estimated"]}),(0,b.jsxs)("li",{children:[t.modulesCount," modules · ",t.lessonsCount," lessons"]}),(0,b.jsxs)("li",{className:"font-medium text-foreground",children:["Price: ",(a=t.price,m=t.currency,null==a||0===a?"Free":`${m??"SGD"} ${Number(a).toFixed(2)}`)]})]}),t.enrolled?(0,b.jsxs)("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"You're already enrolled in this course."}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)(g.Button,{asChild:!0,children:(0,b.jsx)(e.default,{href:"/student/dashboard",children:"Go to dashboard"})}),(0,b.jsx)(g.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(e.default,{href:"/student/scores",children:"My scores"})}),(0,b.jsx)(g.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(e.default,{href:`/student/subjects/${encodeURIComponent(q)}/courses/${encodeURIComponent(r)}/details`,children:"View course details"})})]})]}):E?(0,b.jsx)(g.Button,{className:"w-full sm:w-auto",onClick:G,disabled:x,children:x?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Enrolling…"]}):"Enroll"}):(0,b.jsxs)("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-2",children:[(0,b.jsxs)("p",{className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(k.CreditCard,{className:"w-4 h-4"}),"Pay & Enroll"]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"You will be redirected to our secure payment page. After payment, you will be enrolled automatically."}),(0,b.jsx)(g.Button,{className:"w-full sm:w-auto",onClick:H,disabled:z,children:z?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Redirecting…"]}):"Pay & Enroll"})]})]})]})]})})}a.s(["default",()=>m])}];

//# debugId=c6888e2c-cda5-c107-0c30-48f2d1790440
//# sourceMappingURL=ADK_WORKSPACE_TutorMekimi_tutorme-app_b4a7ef7c._.js.map