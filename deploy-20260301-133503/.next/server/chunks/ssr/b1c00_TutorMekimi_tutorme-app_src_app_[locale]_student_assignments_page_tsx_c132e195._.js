;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="062e121a-d079-8dc5-e42a-b7e9b71144ec")}catch(e){}}();
module.exports=[273913,a=>{"use strict";var b=a.i(260576),c=a.i(741510),d=a.i(113098),e=a.i(88684),f=a.i(333340),g=a.i(868606),h=a.i(79703),i=a.i(50730),j=a.i(748151),k=a.i(619886),l=a.i(141617),m=a.i(926388),n=a.i(479680),o=a.i(987386),p=a.i(660817),q=a.i(458563),r=a.i(342621),s=a.i(724403),t=a.i(560467),u=a.i(924846),v=a.i(226886),w=a.i(844194);function x({feedback:a,explanation:c,nextSteps:e=[],relatedStruggles:g=[],isPersonalized:h=!1,score:i,maxScore:j}){let k=i/j*100;return(0,b.jsxs)(d.Card,{className:"relative overflow-hidden border-blue-200/50 bg-gradient-to-br from-blue-50/50 to-purple-50/30",children:[h&&(0,b.jsx)("div",{className:"absolute top-3 right-3",children:(0,b.jsxs)(f.Badge,{variant:"outline",className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white border-0 gap-1",children:[(0,b.jsx)(v.Sparkles,{className:"w-3 h-3"}),"Personalized for You"]})}),(0,b.jsxs)(d.CardContent,{className:"pt-6 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(r.BookOpen,{className:"w-4 h-4 text-blue-600"}),(0,b.jsx)("h4",{className:"font-semibold text-sm text-gray-700",children:"Feedback"})]}),(0,b.jsx)("p",{className:"text-sm text-gray-800 leading-relaxed",children:a})]}),c&&(0,b.jsx)("div",{children:(0,b.jsx)("p",{className:"text-xs text-gray-600 leading-relaxed",children:c})}),e.length>0&&(0,b.jsxs)("div",{className:"pt-2 border-t border-blue-100",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(q.Target,{className:"w-4 h-4 text-purple-600"}),(0,b.jsx)("h4",{className:"font-semibold text-sm text-gray-700",children:"Next Steps"})]}),(0,b.jsx)("ul",{className:"space-y-1.5",children:e.map((a,c)=>(0,b.jsxs)("li",{className:"text-xs text-gray-700 flex items-start gap-2",children:[(0,b.jsx)("span",{className:"text-purple-500 font-bold mt-0.5",children:"â€¢"}),(0,b.jsx)("span",{children:a})]},c))})]}),g.length>0&&(0,b.jsxs)("div",{className:"pt-2 border-t border-blue-100",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(w.TrendingUp,{className:"w-4 h-4 text-amber-600"}),(0,b.jsx)("h4",{className:"font-semibold text-sm text-gray-700",children:"Related to Your Progress"})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1.5",children:g.map((a,c)=>(0,b.jsx)(f.Badge,{variant:"outline",className:"text-xs bg-amber-50 text-amber-700 border-amber-200",children:a},c))})]}),k>=85&&(0,b.jsx)("div",{className:"pt-2",children:(0,b.jsx)(f.Badge,{className:"bg-green-100 text-green-700 border-green-200",children:"ðŸŽ‰ Excellent Progress!"})}),k>=70&&k<85&&(0,b.jsx)("div",{className:"pt-2",children:(0,b.jsx)(f.Badge,{className:"bg-blue-100 text-blue-700 border-blue-200",children:"ðŸ‘ Good Work!"})}),k<70&&(0,b.jsx)("div",{className:"pt-2",children:(0,b.jsx)(f.Badge,{className:"bg-amber-100 text-amber-700 border-amber-200",children:"âš ï¸ Needs Review"})})]})]})}function y({questions:a,onComplete:f,onClose:g,studentId:h}){let[i,j]=(0,c.useState)(0),[l,m]=(0,c.useState)({}),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)({}),r=a[i],v=(i+1)/a.length*100,w=a=>{m(b=>({...b,[r.id]:a}))},y=async()=>{let b={},c=0;for(let d of a){let a=l[d.id];if("multiple_choice"===d.type){let e=a===d.correctAnswer;b[d.id]={correct:e,score:100*!!e},e&&c++}else if("short_answer"===d.type)try{let e=await fetch("/api/quiz/grade",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:d.question,rubric:d.rubric,studentAnswer:a,maxScore:100,studentId:h})}),f=await e.json();b[d.id]={correct:f.score>=70,feedback:f.feedback,explanation:f.explanation,nextSteps:f.nextSteps||[],relatedStruggles:f.relatedStruggles||[],isPersonalized:f.isPersonalized||!1,score:f.score},f.score>=70&&c++}catch{b[d.id]={correct:!1,feedback:"Could not grade answer",score:0}}}q(b),o(!0);let d=a.map(a=>({questionId:a.id,correct:b[a.id]?.correct??!1,pointsEarned:b[a.id]?.score??0,pointsMax:100,selectedAnswer:l[a.id]}));f({score:Math.round(c/a.length*100),answers:l,questionResults:d})};if(n){let c=Math.round(Object.values(p).filter(a=>a.correct).length/a.length*100);return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)(d.Card,{className:"max-w-lg w-full max-h-[90vh] overflow-auto",children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{className:"text-center",children:"Quiz Results"})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("div",{className:"text-center mb-6",children:[(0,b.jsx)("div",{className:"text-5xl font-bold mb-2",children:c>=80?(0,b.jsxs)("span",{className:"text-green-500",children:[c,"%"]}):c>=60?(0,b.jsxs)("span",{className:"text-yellow-500",children:[c,"%"]}):(0,b.jsxs)("span",{className:"text-red-500",children:[c,"%"]})}),(0,b.jsx)("p",{className:"text-gray-600",children:c>=80?"Excellent work!":c>=60?"Good effort! Keep practicing.":"Keep studying! You will improve."})]}),(0,b.jsx)("div",{className:"space-y-4",children:a.map((a,c)=>{let d=p[a.id],e=d?.isPersonalized&&(d.nextSteps?.length||d.relatedStruggles?.length);return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-start gap-2 mb-2",children:[d?.correct?(0,b.jsx)(t.CheckCircle,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}):(0,b.jsx)(u.XCircle,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("p",{className:"font-medium",children:["Question ",c+1]}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:a.question})]})]}),e?(0,b.jsx)(x,{feedback:d.feedback||"",explanation:d.explanation||"",nextSteps:d.nextSteps,relatedStruggles:d.relatedStruggles,isPersonalized:d.isPersonalized,score:d.score||0,maxScore:100}):d?.feedback&&(0,b.jsxs)("div",{className:"ml-7 mt-2 p-3 bg-gray-50 rounded-lg border",children:[(0,b.jsx)("p",{className:"text-sm text-gray-700",children:d.feedback}),d.explanation&&(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:d.explanation})]})]},a.id)})}),(0,b.jsx)(e.Button,{className:"w-full mt-6",onClick:g,children:"Continue Learning"})]})]})})}return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)(d.Card,{className:"max-w-lg w-full",children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("span",{className:"text-sm text-gray-500",children:["Question ",i+1," of ",a.length]}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:g,children:"Skip"})]}),(0,b.jsx)(s.Progress,{value:v}),(0,b.jsx)(d.CardTitle,{className:"mt-4",children:r.question})]}),(0,b.jsxs)(d.CardContent,{children:["multiple_choice"===r.type&&r.options&&(0,b.jsx)("div",{className:"space-y-2",children:r.options.map((a,c)=>(0,b.jsx)("button",{onClick:()=>w(a),className:`w-full p-4 text-left rounded-lg border transition-colors ${l[r.id]===a?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:a},c))}),"short_answer"===r.type&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("textarea",{value:l[r.id]||"",onChange:a=>w(a.target.value),placeholder:"Type your answer here...",className:"w-full h-32 p-4 border rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500"}),r.rubric&&(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:[(0,b.jsx)(k.AlertCircle,{className:"w-4 h-4 inline mr-1"}),"Grading criteria: ",r.rubric]})]}),(0,b.jsx)(e.Button,{className:"w-full mt-6",onClick:()=>{i<a.length-1?j(a=>a+1):y()},disabled:!l[r.id],children:i<a.length-1?"Next":"Submit"})]})]})})}var z=a.i(846438);function A(){let[a,s]=(0,c.useState)([]),[t,u]=(0,c.useState)({pending:0,submitted:0,overdue:0,total:0}),[v,w]=(0,c.useState)(!0),[x,A]=(0,c.useState)("all"),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(0),J=(0,c.useCallback)(async()=>{w(!0);try{let a=await fetch("/api/student/assignments",{credentials:"include"});if(a.ok){let b=await a.json();s(b.assignments??[]),u(b.stats??{pending:0,submitted:0,overdue:0,total:0})}}catch{z.toast.error("Failed to load assignments")}finally{w(!1)}},[]);(0,c.useEffect)(()=>{J()},[J]);let K=async a=>{try{let b=await fetch(`/api/student/assignments/${a}`,{credentials:"include"});if(!b.ok){let a=await b.json();z.toast.error(a.error??"Cannot start this task");return}let c=await b.json();if(c.alreadySubmitted)return void z.toast.info(`Already submitted. Score: ${c.existingScore??"N/A"}%`);C({id:a,title:c.task.title,questions:c.task.questions}),I(Date.now()),E(!0)}catch{z.toast.error("Failed to load task")}},L=async a=>{if(!B)return;G(!0);let b=Math.round((Date.now()-H)/1e3);try{let c=await fetch("/api/csrf",{credentials:"include"}),d=await c.json().catch(()=>({})),e=d?.token??null,f=await fetch(`/api/student/assignments/${B.id}/submit`,{method:"POST",headers:{"Content-Type":"application/json",...e&&{"X-CSRF-Token":e}},credentials:"include",body:JSON.stringify({answers:a.answers,timeSpent:b})});if(f.ok){let a=await f.json();z.toast.success(`Submitted! Score: ${Math.round(a.submission.score)}%`)}else 409===f.status?z.toast.info("Already submitted"):z.toast.error("Submission failed");B.questions.length>0&&((await fetch("/api/quiz/attempt",{method:"POST",headers:{"Content-Type":"application/json",...e&&{"X-CSRF-Token":e}},credentials:"include",body:JSON.stringify({quizId:B.id,score:a.score,maxScore:100,answers:a.answers,timeSpent:b,questionResults:a.questionResults})})).ok||console.warn("Quiz attempt recording failed (non-critical)"))}catch{z.toast.error("Failed to submit")}finally{G(!1),E(!1),C(null),J()}},M=a=>{if(!a)return null;try{return JSON.parse(a)}catch{return null}},N="all"===x?a:a.filter(a=>a.status===x);if(D&&B){let a=B.questions.map(a=>({id:a.id,type:"mcq"===a.type||"multiple_choice"===a.type?"multiple_choice":"short_answer",question:a.question,options:a.options,rubric:a.rubric?.join("; ")}));return(0,b.jsx)(y,{questions:a,onComplete:L,onClose:()=>{E(!1),C(null)}})}return(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[(0,b.jsx)(h.ClipboardList,{className:"h-6 w-6"}),"Assignments"]}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:"Track your homework, quizzes, and projects"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Total"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:t.total})]}),(0,b.jsx)(r.BookOpen,{className:"h-8 w-8 text-blue-500"})]})})}),(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Pending"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:t.pending})]}),(0,b.jsx)(q.Target,{className:"h-8 w-8 text-amber-500"})]})})}),(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Submitted"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:t.submitted})]}),(0,b.jsx)(p.Trophy,{className:"h-8 w-8 text-green-500"})]})})}),(0,b.jsx)(d.Card,{children:(0,b.jsx)(d.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Overdue"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:t.overdue})]}),(0,b.jsx)(k.AlertCircle,{className:"h-8 w-8 text-red-500"})]})})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"All Assignments"}),(0,b.jsx)(d.CardDescription,{children:"Your upcoming and completed work"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)(g.Tabs,{value:x,onValueChange:A,children:[(0,b.jsxs)(g.TabsList,{className:"mb-4",children:[(0,b.jsxs)(g.TabsTrigger,{value:"all",children:["All (",t.total,")"]}),(0,b.jsxs)(g.TabsTrigger,{value:"pending",children:["Pending (",t.pending,")"]}),(0,b.jsxs)(g.TabsTrigger,{value:"submitted",children:["Submitted (",t.submitted,")"]}),(0,b.jsxs)(g.TabsTrigger,{value:"overdue",children:["Overdue (",t.overdue,")"]})]}),(0,b.jsx)(g.TabsContent,{value:x,className:"space-y-3 mt-0",children:v?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)(n.Loader2,{className:"h-8 w-8 animate-spin text-blue-500"})}):0===N.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(m.FileQuestion,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-700",children:"No assignments"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"all"===x?"No tasks have been assigned yet":`No ${x} assignments`})]}):N.map(a=>{var c;let d;return(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(a=>{switch(a){case"submitted":return(0,b.jsx)(j.CheckCircle2,{className:"h-5 w-5 text-green-500"});case"overdue":return(0,b.jsx)(k.AlertCircle,{className:"h-5 w-5 text-red-500"});default:return(0,b.jsx)(i.Clock,{className:"h-5 w-5 text-amber-500"})}})(a.status),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium text-gray-900",children:a.title}),(0,b.jsx)("p",{className:"text-sm text-gray-500 line-clamp-1",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-1.5 flex-wrap",children:[(d="quiz"===(c=a.type)?"bg-blue-100 text-blue-700":"assignment"===c||"homework"===c?"bg-purple-100 text-purple-700":"project"===c?"bg-teal-100 text-teal-700":"bg-gray-100 text-gray-700",(0,b.jsx)(f.Badge,{className:`${d} border-0 capitalize`,children:c})),(0,b.jsx)(f.Badge,{variant:"outline",className:"capitalize text-xs",children:a.difficulty}),a.questionCount>0&&(0,b.jsxs)("span",{className:"text-xs text-gray-400",children:[a.questionCount," questions"]}),M(a.documentSource)?.fileName&&(0,b.jsxs)(f.Badge,{variant:"outline",className:"text-xs",children:["Source file: ",M(a.documentSource)?.fileName]}),a.dueDate&&(0,b.jsxs)("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[(0,b.jsx)(l.Calendar,{className:"h-3 w-3"}),new Date(a.dueDate).toLocaleDateString()]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 ml-4",children:[M(a.documentSource)?.fileUrl&&(0,b.jsx)(e.Button,{variant:"default",size:"sm",onClick:()=>{let b=M(a.documentSource);if(!b?.fileUrl)return;let c=`assignment-doc-${a.id}`,d=`/student/pdf-tutoring?room=${encodeURIComponent(c)}&doc=${encodeURIComponent(b.fileUrl)}`;window.open(d,"_blank","noopener,noreferrer")},children:"Work on Document"}),M(a.documentSource)?.fileUrl&&(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>window.open(M(a.documentSource)?.fileUrl,"_blank"),children:"Open Source"}),"submitted"===a.status&&null!==a.score&&(0,b.jsxs)("span",{className:`font-bold text-lg ${a.score>=80?"text-green-600":a.score>=60?"text-amber-600":"text-red-600"}`,children:[Math.round(a.score),"%"]}),(a=>{switch(a){case"submitted":return(0,b.jsx)(f.Badge,{className:"bg-green-100 text-green-700 border-green-200",children:"Submitted"});case"overdue":return(0,b.jsx)(f.Badge,{variant:"destructive",children:"Overdue"});default:return(0,b.jsx)(f.Badge,{className:"bg-amber-100 text-amber-700 border-amber-200",children:"Pending"})}})(a.status),"pending"===a.status&&(0,b.jsxs)(e.Button,{size:"sm",onClick:()=>K(a.id),className:"gap-1",children:["Start ",(0,b.jsx)(o.ArrowRight,{className:"h-3 w-3"})]}),"overdue"===a.status&&(0,b.jsxs)(e.Button,{size:"sm",variant:"outline",onClick:()=>K(a.id),className:"gap-1",children:["Submit Late ",(0,b.jsx)(o.ArrowRight,{className:"h-3 w-3"})]})]})]},a.id)})})]})})]})]})}a.s(["default",()=>A],273913)}];

//# debugId=062e121a-d079-8dc5-e42a-b7e9b71144ec
//# sourceMappingURL=b1c00_TutorMekimi_tutorme-app_src_app_%5Blocale%5D_student_assignments_page_tsx_c132e195._.js.map